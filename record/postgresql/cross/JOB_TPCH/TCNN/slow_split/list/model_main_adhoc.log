all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:02.106269, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690527| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694760| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699448| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704352| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710190| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719726| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.745572| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.779995| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790688| train set 0.824x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791215| train set 0.827x speedup, test set 4.894x speedup, val set 0.458x speedup, step: 15
Epoch 20/200 |loss: -0.793068| train set 0.821x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 16
Epoch 21/200 |loss: -0.799397| train set 0.861x speedup, test set 5.046x speedup, val set 0.384x speedup, step: 17
Epoch 22/200 |loss: -0.806939| train set 0.762x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812322| train set 0.788x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 19
Epoch 24/200 |loss: -0.816382| train set 0.812x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821779| train set 0.643x speedup, test set 4.997x speedup, val set 0.374x speedup, step: 21
Epoch 26/200 |loss: -0.827112| train set 0.600x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831663| train set 0.562x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.835997| train set 0.562x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 24
Epoch 29/200 |loss: -0.839632| train set 0.561x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 25
Epoch 30/200 |loss: -0.842446| train set 0.558x speedup, test set 4.782x speedup, val set 0.453x speedup, step: 26
Epoch 31/200 |loss: -0.845241| train set 0.559x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 27
Epoch 32/200 |loss: -0.847603| train set 0.559x speedup, test set 4.931x speedup, val set 0.455x speedup, step: 28
Epoch 33/200 |loss: -0.849600| train set 0.558x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 29
Epoch 34/200 |loss: -0.851891| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 30
Epoch 35/200 |loss: -0.853899| train set 0.558x speedup, test set 4.782x speedup, val set 0.831x speedup, step: 31
Epoch 36/200 |loss: -0.855538| train set 0.557x speedup, test set 4.782x speedup, val set 0.831x speedup, step: 32
Epoch 37/200 |loss: -0.857080| train set 0.554x speedup, test set 4.782x speedup, val set 0.823x speedup, step: 33
Epoch 38/200 |loss: -0.858227| train set 0.554x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 34
Epoch 39/200 |loss: -0.859373| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 35
Epoch 40/200 |loss: -0.860573| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 36
Epoch 41/200 |loss: -0.861788| train set 0.558x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 37
Epoch 42/200 |loss: -0.863158| train set 0.560x speedup, test set 5.046x speedup, val set 0.836x speedup, step: 38
Epoch 43/200 |loss: -0.864498| train set 0.561x speedup, test set 4.866x speedup, val set 0.841x speedup, step: 39
Epoch 44/200 |loss: -0.866084| train set 0.569x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.868328| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.870739| train set 0.569x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.872509| train set 0.623x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 43
Epoch 48/200 |loss: -0.873793| train set 0.641x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 44
Epoch 49/200 |loss: -0.875281| train set 0.642x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 45
Epoch 50/200 |loss: -0.876643| train set 0.642x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 46
Epoch 51/200 |loss: -0.877963| train set 0.642x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 47
Epoch 52/200 |loss: -0.879300| train set 0.641x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 48
Epoch 53/200 |loss: -0.880453| train set 0.645x speedup, test set 4.346x speedup, val set 0.847x speedup, step: 49
Epoch 54/200 |loss: -0.882097| train set 0.646x speedup, test set 1.526x speedup, val set 0.847x speedup, step: 50
Epoch 55/200 |loss: -0.883221| train set 0.646x speedup, test set 1.526x speedup, val set 0.853x speedup, step: 51
Epoch 56/200 |loss: -0.884662| train set 0.647x speedup, test set 3.172x speedup, val set 0.847x speedup, step: 52
Epoch 57/200 |loss: -0.886811| train set 0.647x speedup, test set 4.346x speedup, val set 0.847x speedup, step: 53
Epoch 58/200 |loss: -0.888453| train set 0.647x speedup, test set 4.346x speedup, val set 0.847x speedup, step: 54
Epoch 59/200 |loss: -0.889262| train set 0.678x speedup, test set 4.346x speedup, val set 0.853x speedup, step: 55
Epoch 60/200 |loss: -0.883979| train set 0.695x speedup, test set 2.192x speedup, val set 0.525x speedup, step: 56
Epoch 61/200 |loss: -0.867467| train set 0.695x speedup, test set 1.502x speedup, val set 0.468x speedup, step: 57
Epoch 62/200 |loss: -0.878047| train set 0.696x speedup, test set 1.502x speedup, val set 0.468x speedup, step: 58
early stopping at epoch 62
Training per epoch cost 0.683 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 7, train speedup 0.911, test speedup 4.047, val speedup 0.746
best test speedup epoch: 20, train speedup 0.821, test speedup 5.046, val speedup 0.453
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 62, train speedup 0.696, test speedup 1.502, val speedup 0.468
execution cost 0:02:16.325677
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:01.288998, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690527| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694760| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699446| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704356| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710218| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719681| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.745797| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.780374| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790508| train set 0.823x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791148| train set 0.827x speedup, test set 4.894x speedup, val set 0.459x speedup, step: 15
Epoch 20/200 |loss: -0.793290| train set 0.822x speedup, test set 5.046x speedup, val set 0.456x speedup, step: 16
Epoch 21/200 |loss: -0.799537| train set 0.838x speedup, test set 5.046x speedup, val set 0.384x speedup, step: 17
Epoch 22/200 |loss: -0.807094| train set 0.761x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812327| train set 0.789x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 19
Epoch 24/200 |loss: -0.816270| train set 0.812x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821572| train set 0.646x speedup, test set 5.046x speedup, val set 0.442x speedup, step: 21
Epoch 26/200 |loss: -0.827053| train set 0.616x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831574| train set 0.616x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.835908| train set 0.564x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 24
Epoch 29/200 |loss: -0.839709| train set 0.562x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 25
Epoch 30/200 |loss: -0.842509| train set 0.558x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 26
Epoch 31/200 |loss: -0.845193| train set 0.558x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 27
Epoch 32/200 |loss: -0.847550| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 28
Epoch 33/200 |loss: -0.849336| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 29
Epoch 34/200 |loss: -0.851363| train set 0.559x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 30
Epoch 35/200 |loss: -0.853649| train set 0.559x speedup, test set 4.782x speedup, val set 0.837x speedup, step: 31
Epoch 36/200 |loss: -0.855351| train set 0.560x speedup, test set 4.782x speedup, val set 0.837x speedup, step: 32
Epoch 37/200 |loss: -0.856971| train set 0.560x speedup, test set 4.782x speedup, val set 0.837x speedup, step: 33
Epoch 38/200 |loss: -0.858210| train set 0.555x speedup, test set 5.046x speedup, val set 0.835x speedup, step: 34
Epoch 39/200 |loss: -0.859209| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 35
Epoch 40/200 |loss: -0.860501| train set 0.558x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 36
Epoch 41/200 |loss: -0.861728| train set 0.560x speedup, test set 5.046x speedup, val set 0.847x speedup, step: 37
Epoch 42/200 |loss: -0.862974| train set 0.560x speedup, test set 5.046x speedup, val set 0.847x speedup, step: 38
Epoch 43/200 |loss: -0.864152| train set 0.560x speedup, test set 5.046x speedup, val set 0.847x speedup, step: 39
Epoch 44/200 |loss: -0.865341| train set 0.569x speedup, test set 4.866x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.866580| train set 0.565x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.868122| train set 0.565x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.869952| train set 0.584x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 43
Epoch 48/200 |loss: -0.872169| train set 0.584x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 44
Epoch 49/200 |loss: -0.874623| train set 0.584x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 45
Epoch 50/200 |loss: -0.876329| train set 0.642x speedup, test set 4.157x speedup, val set 0.814x speedup, step: 46
Epoch 51/200 |loss: -0.877560| train set 0.642x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 47
Epoch 52/200 |loss: -0.879168| train set 0.647x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 48
Epoch 53/200 |loss: -0.880423| train set 0.646x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 49
Epoch 54/200 |loss: -0.881629| train set 0.646x speedup, test set 1.502x speedup, val set 0.546x speedup, step: 50
Epoch 55/200 |loss: -0.882862| train set 0.676x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 51
Epoch 56/200 |loss: -0.884325| train set 0.677x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 52
Epoch 57/200 |loss: -0.885872| train set 0.677x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 53
Epoch 58/200 |loss: -0.887387| train set 0.676x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 54
Epoch 59/200 |loss: -0.888666| train set 0.646x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 55
Epoch 60/200 |loss: -0.887589| train set 0.675x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 56
Epoch 61/200 |loss: -0.841339| train set 0.646x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 57
Epoch 62/200 |loss: -0.888295| train set 0.695x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 58
Epoch 63/200 |loss: -0.876963| train set 0.695x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 59
Epoch 64/200 |loss: -0.885801| train set 0.664x speedup, test set 1.604x speedup, val set 0.814x speedup, step: 60
Epoch 65/200 |loss: -0.886437| train set 0.666x speedup, test set 1.604x speedup, val set 0.814x speedup, step: 61
Epoch 66/200 |loss: -0.888437| train set 0.736x speedup, test set 1.604x speedup, val set 0.853x speedup, step: 62
Epoch 67/200 |loss: -0.889815| train set 0.736x speedup, test set 1.604x speedup, val set 0.853x speedup, step: 63
Epoch 68/200 |loss: -0.887873| train set 0.735x speedup, test set 1.604x speedup, val set 0.853x speedup, step: 64
Epoch 69/200 |loss: -0.894896| train set 0.733x speedup, test set 1.176x speedup, val set 0.814x speedup, step: 65
Epoch 70/200 |loss: -0.895625| train set 0.734x speedup, test set 1.171x speedup, val set 0.814x speedup, step: 66
Epoch 71/200 |loss: -0.902910| train set 0.732x speedup, test set 1.171x speedup, val set 0.814x speedup, step: 67
Epoch 72/200 |loss: -0.902632| train set 0.676x speedup, test set 1.171x speedup, val set 0.814x speedup, step: 68
Epoch 73/200 |loss: -0.905196| train set 0.676x speedup, test set 1.171x speedup, val set 0.814x speedup, step: 69
Epoch 74/200 |loss: -0.909196| train set 0.676x speedup, test set 1.594x speedup, val set 0.814x speedup, step: 70
Epoch 75/200 |loss: -0.910527| train set 0.676x speedup, test set 1.594x speedup, val set 0.814x speedup, step: 71
Epoch 76/200 |loss: -0.911419| train set 0.677x speedup, test set 1.594x speedup, val set 0.814x speedup, step: 72
Epoch 77/200 |loss: -0.911422| train set 0.685x speedup, test set 1.576x speedup, val set 0.814x speedup, step: 73
Epoch 78/200 |loss: -0.913047| train set 0.691x speedup, test set 1.576x speedup, val set 0.814x speedup, step: 74
Epoch 79/200 |loss: -0.914263| train set 0.691x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 75
Epoch 80/200 |loss: -0.915277| train set 0.749x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 76
Epoch 81/200 |loss: -0.915907| train set 0.749x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 77
Epoch 82/200 |loss: -0.916269| train set 0.750x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 78
Epoch 83/200 |loss: -0.917160| train set 0.749x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 79
Epoch 84/200 |loss: -0.917842| train set 0.749x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 80
Epoch 85/200 |loss: -0.918300| train set 0.749x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 81
Epoch 86/200 |loss: -0.919078| train set 0.749x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 82
Epoch 87/200 |loss: -0.919162| train set 0.749x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 83
Epoch 88/200 |loss: -0.919762| train set 0.751x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 84
Epoch 89/200 |loss: -0.920026| train set 0.751x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 85
Epoch 90/200 |loss: -0.920510| train set 0.751x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 86
Epoch 91/200 |loss: -0.920928| train set 0.751x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 87
Epoch 92/200 |loss: -0.921169| train set 0.751x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 88
Epoch 93/200 |loss: -0.921588| train set 0.751x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 89
Epoch 94/200 |loss: -0.921850| train set 0.751x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 90
Epoch 95/200 |loss: -0.922141| train set 0.751x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 91
Epoch 96/200 |loss: -0.922440| train set 0.751x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 92
Epoch 97/200 |loss: -0.922778| train set 0.753x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 93
Epoch 98/200 |loss: -0.923076| train set 0.755x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 94
Epoch 99/200 |loss: -0.923286| train set 0.755x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 95
Epoch 100/200 |loss: -0.923524| train set 0.755x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 96
Epoch 101/200 |loss: -0.923742| train set 0.755x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 97
Epoch 102/200 |loss: -0.923934| train set 0.755x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 98
Epoch 103/200 |loss: -0.924011| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 99
Epoch 104/200 |loss: -0.923888| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 100
Epoch 105/200 |loss: -0.923313| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 101
Epoch 106/200 |loss: -0.924403| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 102
Epoch 107/200 |loss: -0.925315| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 103
Epoch 108/200 |loss: -0.925299| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 104
Epoch 109/200 |loss: -0.924857| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 105
Epoch 110/200 |loss: -0.924934| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 106
Epoch 111/200 |loss: -0.926115| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 107
Epoch 112/200 |loss: -0.925785| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 108
Epoch 113/200 |loss: -0.925962| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 109
Epoch 114/200 |loss: -0.926654| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 110
Epoch 115/200 |loss: -0.926459| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 111
Epoch 116/200 |loss: -0.926687| train set 1.060x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 112
Epoch 117/200 |loss: -0.927137| train set 1.060x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 113
Epoch 118/200 |loss: -0.927046| train set 1.114x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 114
Epoch 119/200 |loss: -0.927315| train set 1.114x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 115
Epoch 120/200 |loss: -0.927591| train set 1.114x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 116
Epoch 121/200 |loss: -0.927497| train set 1.127x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 117
Epoch 122/200 |loss: -0.927677| train set 1.125x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 118
Epoch 123/200 |loss: -0.928106| train set 1.125x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 119
Epoch 124/200 |loss: -0.928150| train set 1.069x speedup, test set 1.176x speedup, val set 0.853x speedup, step: 120
Epoch 125/200 |loss: -0.928019| train set 1.141x speedup, test set 1.176x speedup, val set 0.853x speedup, step: 121
Epoch 126/200 |loss: -0.928247| train set 1.084x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 122
Epoch 127/200 |loss: -0.928576| train set 1.124x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 123
Epoch 128/200 |loss: -0.928921| train set 1.124x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 124
Epoch 129/200 |loss: -0.929049| train set 1.069x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 125
Epoch 130/200 |loss: -0.929006| train set 1.123x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 126
Epoch 131/200 |loss: -0.928928| train set 1.068x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 127
Epoch 132/200 |loss: -0.928755| train set 1.123x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 128
Epoch 133/200 |loss: -0.929062| train set 1.068x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 129
Epoch 134/200 |loss: -0.929397| train set 1.068x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 130
Epoch 135/200 |loss: -0.929784| train set 1.068x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 131
Epoch 136/200 |loss: -0.929740| train set 1.068x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 132
Epoch 137/200 |loss: -0.929751| train set 1.063x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 133
Epoch 138/200 |loss: -0.930073| train set 1.063x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 134
Epoch 139/200 |loss: -0.930093| train set 1.068x speedup, test set 1.186x speedup, val set 0.853x speedup, step: 135
Epoch 140/200 |loss: -0.930047| train set 1.063x speedup, test set 1.186x speedup, val set 0.803x speedup, step: 136
Epoch 141/200 |loss: -0.930405| train set 1.063x speedup, test set 1.186x speedup, val set 0.803x speedup, step: 137
Epoch 142/200 |loss: -0.930541| train set 1.063x speedup, test set 1.171x speedup, val set 0.803x speedup, step: 138
Epoch 143/200 |loss: -0.930307| train set 1.063x speedup, test set 1.171x speedup, val set 0.803x speedup, step: 139
Epoch 144/200 |loss: -0.930117| train set 1.063x speedup, test set 1.171x speedup, val set 0.803x speedup, step: 140
Epoch 145/200 |loss: -0.928200| train set 1.117x speedup, test set 1.171x speedup, val set 0.803x speedup, step: 141
Epoch 146/200 |loss: -0.930471| train set 1.118x speedup, test set 1.171x speedup, val set 0.803x speedup, step: 142
Epoch 147/200 |loss: -0.928456| train set 1.063x speedup, test set 1.186x speedup, val set 0.803x speedup, step: 143
Epoch 148/200 |loss: -0.927484| train set 1.117x speedup, test set 1.186x speedup, val set 0.803x speedup, step: 144
early stopping at epoch 148
Training per epoch cost 0.609 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 125, train speedup 1.141, test speedup 1.176, val speedup 0.853
best test speedup epoch: 20, train speedup 0.822, test speedup 5.046, val speedup 0.456
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 148, train speedup 1.117, test speedup 1.186, val speedup 0.803
execution cost 0:04:40.517450
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:01.623608, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690527| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694760| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699448| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704352| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710190| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719726| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.745572| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.779995| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790688| train set 0.824x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791215| train set 0.827x speedup, test set 4.894x speedup, val set 0.458x speedup, step: 15
Epoch 20/200 |loss: -0.793068| train set 0.821x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 16
Epoch 21/200 |loss: -0.799397| train set 0.861x speedup, test set 5.046x speedup, val set 0.384x speedup, step: 17
Epoch 22/200 |loss: -0.806939| train set 0.762x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812322| train set 0.788x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 19
Epoch 24/200 |loss: -0.816379| train set 0.825x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821777| train set 0.643x speedup, test set 4.997x speedup, val set 0.374x speedup, step: 21
Epoch 26/200 |loss: -0.827111| train set 0.600x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831659| train set 0.562x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.835994| train set 0.562x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 24
Epoch 29/200 |loss: -0.839632| train set 0.561x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 25
Epoch 30/200 |loss: -0.842440| train set 0.558x speedup, test set 4.782x speedup, val set 0.453x speedup, step: 26
Epoch 31/200 |loss: -0.845239| train set 0.559x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 27
Epoch 32/200 |loss: -0.847600| train set 0.559x speedup, test set 4.957x speedup, val set 0.455x speedup, step: 28
Epoch 33/200 |loss: -0.849588| train set 0.558x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 29
Epoch 34/200 |loss: -0.851880| train set 0.559x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 30
Epoch 35/200 |loss: -0.853894| train set 0.558x speedup, test set 4.782x speedup, val set 0.837x speedup, step: 31
Epoch 36/200 |loss: -0.855539| train set 0.558x speedup, test set 4.782x speedup, val set 0.831x speedup, step: 32
Epoch 37/200 |loss: -0.857090| train set 0.554x speedup, test set 4.782x speedup, val set 0.823x speedup, step: 33
Epoch 38/200 |loss: -0.858225| train set 0.554x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 34
Epoch 39/200 |loss: -0.859363| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 35
Epoch 40/200 |loss: -0.860557| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 36
Epoch 41/200 |loss: -0.861765| train set 0.558x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 37
Epoch 42/200 |loss: -0.863122| train set 0.560x speedup, test set 5.046x speedup, val set 0.836x speedup, step: 38
Epoch 43/200 |loss: -0.864470| train set 0.561x speedup, test set 4.866x speedup, val set 0.847x speedup, step: 39
Epoch 44/200 |loss: -0.865998| train set 0.569x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.868177| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.870587| train set 0.569x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.872427| train set 0.623x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 43
Epoch 48/200 |loss: -0.873728| train set 0.624x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 44
Epoch 49/200 |loss: -0.875179| train set 0.642x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 45
Epoch 50/200 |loss: -0.876454| train set 0.640x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 46
Epoch 51/200 |loss: -0.877538| train set 0.643x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 47
Epoch 52/200 |loss: -0.878994| train set 0.641x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 48
Epoch 53/200 |loss: -0.880530| train set 0.645x speedup, test set 1.526x speedup, val set 0.847x speedup, step: 49
Epoch 54/200 |loss: -0.882047| train set 0.646x speedup, test set 1.526x speedup, val set 0.847x speedup, step: 50
Epoch 55/200 |loss: -0.883011| train set 0.645x speedup, test set 1.526x speedup, val set 0.847x speedup, step: 51
Epoch 56/200 |loss: -0.884613| train set 0.645x speedup, test set 1.526x speedup, val set 0.809x speedup, step: 52
Epoch 57/200 |loss: -0.886310| train set 0.646x speedup, test set 4.346x speedup, val set 0.523x speedup, step: 53
Epoch 58/200 |loss: -0.884811| train set 0.678x speedup, test set 4.346x speedup, val set 0.853x speedup, step: 54
Epoch 59/200 |loss: -0.883084| train set 0.644x speedup, test set 1.754x speedup, val set 0.523x speedup, step: 55
Epoch 60/200 |loss: -0.880786| train set 0.644x speedup, test set 1.526x speedup, val set 0.523x speedup, step: 56
Epoch 61/200 |loss: -0.886501| train set 0.676x speedup, test set 1.502x speedup, val set 0.816x speedup, step: 57
Epoch 62/200 |loss: -0.883217| train set 0.677x speedup, test set 1.502x speedup, val set 0.821x speedup, step: 58
Epoch 63/200 |loss: -0.890670| train set 0.646x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 59
Epoch 64/200 |loss: -0.889504| train set 0.646x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 60
Epoch 65/200 |loss: -0.891344| train set 0.678x speedup, test set 1.502x speedup, val set 0.853x speedup, step: 61
Epoch 66/200 |loss: -0.893860| train set 0.678x speedup, test set 1.502x speedup, val set 0.853x speedup, step: 62
Epoch 67/200 |loss: -0.893369| train set 0.734x speedup, test set 1.502x speedup, val set 0.853x speedup, step: 63
Epoch 68/200 |loss: -0.896232| train set 0.734x speedup, test set 1.502x speedup, val set 0.853x speedup, step: 64
Epoch 69/200 |loss: -0.897346| train set 0.677x speedup, test set 1.478x speedup, val set 0.814x speedup, step: 65
Epoch 70/200 |loss: -0.902839| train set 0.676x speedup, test set 1.478x speedup, val set 0.814x speedup, step: 66
Epoch 71/200 |loss: -0.906012| train set 0.678x speedup, test set 1.478x speedup, val set 0.814x speedup, step: 67
Epoch 72/200 |loss: -0.908481| train set 0.735x speedup, test set 1.478x speedup, val set 0.814x speedup, step: 68
Epoch 73/200 |loss: -0.909398| train set 0.736x speedup, test set 1.478x speedup, val set 0.865x speedup, step: 69
Epoch 74/200 |loss: -0.910495| train set 0.734x speedup, test set 1.478x speedup, val set 0.865x speedup, step: 70
Epoch 75/200 |loss: -0.907669| train set 0.734x speedup, test set 1.121x speedup, val set 0.865x speedup, step: 71
Epoch 76/200 |loss: -0.879486| train set 0.734x speedup, test set 1.505x speedup, val set 0.865x speedup, step: 72
Epoch 77/200 |loss: -0.900539| train set 0.614x speedup, test set 1.505x speedup, val set 0.853x speedup, step: 73
Epoch 78/200 |loss: -0.898091| train set 0.735x speedup, test set 1.702x speedup, val set 0.853x speedup, step: 74
Epoch 79/200 |loss: -0.906000| train set 0.736x speedup, test set 1.161x speedup, val set 0.853x speedup, step: 75
Epoch 80/200 |loss: -0.906617| train set 0.696x speedup, test set 1.136x speedup, val set 0.814x speedup, step: 76
Epoch 81/200 |loss: -0.901438| train set 0.696x speedup, test set 1.136x speedup, val set 0.814x speedup, step: 77
early stopping at epoch 81
Training per epoch cost 0.639 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 7, train speedup 0.911, test speedup 4.047, val speedup 0.746
best test speedup epoch: 20, train speedup 0.821, test speedup 5.046, val speedup 0.453
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 81, train speedup 0.696, test speedup 1.136, val speedup 0.814
execution cost 0:02:43.067718
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:02.135730, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690527| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694760| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699448| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704352| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710191| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719731| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.745556| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.780033| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790649| train set 0.823x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791227| train set 0.827x speedup, test set 4.894x speedup, val set 0.458x speedup, step: 15
Epoch 20/200 |loss: -0.793182| train set 0.821x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 16
Epoch 21/200 |loss: -0.799391| train set 0.861x speedup, test set 5.046x speedup, val set 0.382x speedup, step: 17
Epoch 22/200 |loss: -0.806894| train set 0.762x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812367| train set 0.788x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 19
Epoch 24/200 |loss: -0.816409| train set 0.812x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821725| train set 0.599x speedup, test set 5.046x speedup, val set 0.442x speedup, step: 21
Epoch 26/200 |loss: -0.827166| train set 0.613x speedup, test set 4.963x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831688| train set 0.562x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.836029| train set 0.563x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 24
Epoch 29/200 |loss: -0.839718| train set 0.560x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 25
Epoch 30/200 |loss: -0.842471| train set 0.558x speedup, test set 4.782x speedup, val set 0.453x speedup, step: 26
Epoch 31/200 |loss: -0.845222| train set 0.559x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 27
Epoch 32/200 |loss: -0.847613| train set 0.559x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 28
Epoch 33/200 |loss: -0.849495| train set 0.559x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 29
Epoch 34/200 |loss: -0.851760| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 30
Epoch 35/200 |loss: -0.853857| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 31
Epoch 36/200 |loss: -0.855481| train set 0.558x speedup, test set 4.782x speedup, val set 0.831x speedup, step: 32
Epoch 37/200 |loss: -0.857046| train set 0.554x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 33
Epoch 38/200 |loss: -0.858207| train set 0.554x speedup, test set 5.046x speedup, val set 0.835x speedup, step: 34
Epoch 39/200 |loss: -0.859350| train set 0.556x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 35
Epoch 40/200 |loss: -0.860565| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 36
Epoch 41/200 |loss: -0.861809| train set 0.558x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 37
Epoch 42/200 |loss: -0.863113| train set 0.560x speedup, test set 5.046x speedup, val set 0.836x speedup, step: 38
Epoch 43/200 |loss: -0.864378| train set 0.561x speedup, test set 4.866x speedup, val set 0.841x speedup, step: 39
Epoch 44/200 |loss: -0.865756| train set 0.559x speedup, test set 4.866x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.867631| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.870012| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.872366| train set 0.569x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 43
Epoch 48/200 |loss: -0.873896| train set 0.583x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 44
Epoch 49/200 |loss: -0.875103| train set 0.642x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 45
Epoch 50/200 |loss: -0.876531| train set 0.642x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 46
Epoch 51/200 |loss: -0.877722| train set 0.643x speedup, test set 4.157x speedup, val set 0.865x speedup, step: 47
Epoch 52/200 |loss: -0.879274| train set 0.646x speedup, test set 4.157x speedup, val set 0.859x speedup, step: 48
Epoch 53/200 |loss: -0.880759| train set 0.646x speedup, test set 4.157x speedup, val set 0.859x speedup, step: 49
Epoch 54/200 |loss: -0.882010| train set 0.646x speedup, test set 1.526x speedup, val set 0.809x speedup, step: 50
Epoch 55/200 |loss: -0.883199| train set 0.644x speedup, test set 1.526x speedup, val set 0.809x speedup, step: 51
Epoch 56/200 |loss: -0.884613| train set 0.646x speedup, test set 1.526x speedup, val set 0.523x speedup, step: 52
Epoch 57/200 |loss: -0.886171| train set 0.645x speedup, test set 1.526x speedup, val set 0.809x speedup, step: 53
Epoch 58/200 |loss: -0.886897| train set 0.644x speedup, test set 1.526x speedup, val set 0.523x speedup, step: 54
Epoch 59/200 |loss: -0.885549| train set 0.678x speedup, test set 1.526x speedup, val set 0.854x speedup, step: 55
Epoch 60/200 |loss: -0.880776| train set 0.644x speedup, test set 1.526x speedup, val set 0.523x speedup, step: 56
Epoch 61/200 |loss: -0.881048| train set 0.644x speedup, test set 1.502x speedup, val set 0.523x speedup, step: 57
Epoch 62/200 |loss: -0.885308| train set 0.676x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 58
Epoch 63/200 |loss: -0.889518| train set 0.677x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 59
Epoch 64/200 |loss: -0.884046| train set 0.645x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 60
Epoch 65/200 |loss: -0.889627| train set 0.695x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 61
Epoch 66/200 |loss: -0.886319| train set 0.696x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 62
Epoch 67/200 |loss: -0.887206| train set 0.645x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 63
Epoch 68/200 |loss: -0.893042| train set 0.678x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 64
Epoch 69/200 |loss: -0.893979| train set 0.677x speedup, test set 4.157x speedup, val set 0.814x speedup, step: 65
Epoch 70/200 |loss: -0.893516| train set 0.677x speedup, test set 4.157x speedup, val set 0.814x speedup, step: 66
Epoch 71/200 |loss: -0.899654| train set 0.696x speedup, test set 2.192x speedup, val set 0.525x speedup, step: 67
Epoch 72/200 |loss: -0.898155| train set 0.733x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 68
Epoch 73/200 |loss: -0.904024| train set 0.735x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 69
Epoch 74/200 |loss: -0.904457| train set 0.735x speedup, test set 4.157x speedup, val set 0.865x speedup, step: 70
Epoch 75/200 |loss: -0.903635| train set 0.734x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 71
Epoch 76/200 |loss: -0.907980| train set 0.732x speedup, test set 1.121x speedup, val set 0.525x speedup, step: 72
Epoch 77/200 |loss: -0.905750| train set 0.732x speedup, test set 1.478x speedup, val set 0.525x speedup, step: 73
Epoch 78/200 |loss: -0.911737| train set 0.732x speedup, test set 1.478x speedup, val set 0.814x speedup, step: 74
Epoch 79/200 |loss: -0.902359| train set 0.734x speedup, test set 1.121x speedup, val set 0.546x speedup, step: 75
Epoch 80/200 |loss: -0.911186| train set 0.732x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 76
Epoch 81/200 |loss: -0.903892| train set 0.732x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 77
Epoch 82/200 |loss: -0.915596| train set 0.731x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 78
Epoch 83/200 |loss: -0.906167| train set 0.730x speedup, test set 1.502x speedup, val set 0.810x speedup, step: 79
Epoch 84/200 |loss: -0.915003| train set 0.732x speedup, test set 1.505x speedup, val set 0.546x speedup, step: 80
Epoch 85/200 |loss: -0.914592| train set 0.732x speedup, test set 1.136x speedup, val set 0.541x speedup, step: 81
Epoch 86/200 |loss: -0.912693| train set 0.732x speedup, test set 1.136x speedup, val set 0.541x speedup, step: 82
Epoch 87/200 |loss: -0.918362| train set 0.730x speedup, test set 1.136x speedup, val set 0.814x speedup, step: 83
Epoch 88/200 |loss: -0.917503| train set 0.723x speedup, test set 1.505x speedup, val set 0.814x speedup, step: 84
Epoch 89/200 |loss: -0.911437| train set 0.732x speedup, test set 1.136x speedup, val set 0.853x speedup, step: 85
Epoch 90/200 |loss: -0.920617| train set 0.732x speedup, test set 1.136x speedup, val set 0.853x speedup, step: 86
Epoch 91/200 |loss: -0.906667| train set 0.732x speedup, test set 1.136x speedup, val set 0.853x speedup, step: 87
Epoch 92/200 |loss: -0.909545| train set 0.730x speedup, test set 1.505x speedup, val set 0.803x speedup, step: 88
Epoch 93/200 |loss: -0.920602| train set 0.731x speedup, test set 1.505x speedup, val set 0.803x speedup, step: 89
Epoch 94/200 |loss: -0.911800| train set 0.731x speedup, test set 1.505x speedup, val set 0.803x speedup, step: 90
Epoch 95/200 |loss: -0.910220| train set 0.740x speedup, test set 1.502x speedup, val set 0.803x speedup, step: 91
early stopping at epoch 95
Training per epoch cost 0.748 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 7, train speedup 0.911, test speedup 4.047, val speedup 0.746
best test speedup epoch: 20, train speedup 0.821, test speedup 5.046, val speedup 0.453
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 95, train speedup 0.740, test speedup 1.502, val speedup 0.803
execution cost 0:03:40.389892
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:01.938731, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690527| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694760| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699448| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704352| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710190| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719726| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.745572| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.779995| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790688| train set 0.824x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791215| train set 0.827x speedup, test set 4.894x speedup, val set 0.458x speedup, step: 15
Epoch 20/200 |loss: -0.793068| train set 0.821x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 16
Epoch 21/200 |loss: -0.799397| train set 0.861x speedup, test set 5.046x speedup, val set 0.384x speedup, step: 17
Epoch 22/200 |loss: -0.806939| train set 0.762x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812322| train set 0.788x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 19
Epoch 24/200 |loss: -0.816382| train set 0.812x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821780| train set 0.643x speedup, test set 4.997x speedup, val set 0.374x speedup, step: 21
Epoch 26/200 |loss: -0.827116| train set 0.600x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831668| train set 0.562x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.835999| train set 0.562x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 24
Epoch 29/200 |loss: -0.839635| train set 0.561x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 25
Epoch 30/200 |loss: -0.842451| train set 0.558x speedup, test set 4.782x speedup, val set 0.453x speedup, step: 26
Epoch 31/200 |loss: -0.845246| train set 0.559x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 27
Epoch 32/200 |loss: -0.847612| train set 0.559x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 28
Epoch 33/200 |loss: -0.849613| train set 0.558x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 29
Epoch 34/200 |loss: -0.851900| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 30
Epoch 35/200 |loss: -0.853898| train set 0.558x speedup, test set 4.782x speedup, val set 0.831x speedup, step: 31
Epoch 36/200 |loss: -0.855540| train set 0.558x speedup, test set 4.782x speedup, val set 0.831x speedup, step: 32
Epoch 37/200 |loss: -0.857076| train set 0.554x speedup, test set 4.782x speedup, val set 0.823x speedup, step: 33
Epoch 38/200 |loss: -0.858213| train set 0.554x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 34
Epoch 39/200 |loss: -0.859348| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 35
Epoch 40/200 |loss: -0.860547| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 36
Epoch 41/200 |loss: -0.861754| train set 0.558x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 37
Epoch 42/200 |loss: -0.863102| train set 0.560x speedup, test set 5.046x speedup, val set 0.836x speedup, step: 38
Epoch 43/200 |loss: -0.864406| train set 0.561x speedup, test set 4.866x speedup, val set 0.841x speedup, step: 39
Epoch 44/200 |loss: -0.865923| train set 0.569x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.868088| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.870482| train set 0.623x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.872342| train set 0.624x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 43
Epoch 48/200 |loss: -0.873643| train set 0.641x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 44
Epoch 49/200 |loss: -0.875038| train set 0.642x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 45
Epoch 50/200 |loss: -0.876337| train set 0.642x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 46
Epoch 51/200 |loss: -0.877625| train set 0.642x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 47
Epoch 52/200 |loss: -0.879173| train set 0.644x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 48
Epoch 53/200 |loss: -0.880662| train set 0.645x speedup, test set 1.526x speedup, val set 0.853x speedup, step: 49
Epoch 54/200 |loss: -0.882036| train set 0.646x speedup, test set 1.526x speedup, val set 0.853x speedup, step: 50
Epoch 55/200 |loss: -0.883158| train set 0.646x speedup, test set 1.526x speedup, val set 0.853x speedup, step: 51
Epoch 56/200 |loss: -0.884598| train set 0.647x speedup, test set 1.526x speedup, val set 0.853x speedup, step: 52
Epoch 57/200 |loss: -0.886581| train set 0.646x speedup, test set 4.346x speedup, val set 0.809x speedup, step: 53
Epoch 58/200 |loss: -0.887557| train set 0.678x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 54
Epoch 59/200 |loss: -0.882473| train set 0.647x speedup, test set 4.346x speedup, val set 0.541x speedup, step: 55
Epoch 60/200 |loss: -0.870979| train set 0.696x speedup, test set 1.502x speedup, val set 0.481x speedup, step: 56
Epoch 61/200 |loss: -0.876993| train set 0.695x speedup, test set 1.502x speedup, val set 0.468x speedup, step: 57
early stopping at epoch 61
Training per epoch cost 0.765 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 7, train speedup 0.911, test speedup 4.047, val speedup 0.746
best test speedup epoch: 20, train speedup 0.821, test speedup 5.046, val speedup 0.453
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 61, train speedup 0.695, test speedup 1.502, val speedup 0.468
execution cost 0:02:25.844681
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:02.189548, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690527| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694760| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699448| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704352| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710191| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719731| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.745556| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.780033| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790649| train set 0.823x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791227| train set 0.827x speedup, test set 4.894x speedup, val set 0.458x speedup, step: 15
Epoch 20/200 |loss: -0.793182| train set 0.821x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 16
Epoch 21/200 |loss: -0.799391| train set 0.861x speedup, test set 5.046x speedup, val set 0.382x speedup, step: 17
Epoch 22/200 |loss: -0.806894| train set 0.762x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812367| train set 0.788x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 19
Epoch 24/200 |loss: -0.816408| train set 0.812x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821722| train set 0.599x speedup, test set 5.046x speedup, val set 0.442x speedup, step: 21
Epoch 26/200 |loss: -0.827160| train set 0.613x speedup, test set 4.963x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831682| train set 0.562x speedup, test set 5.011x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.836024| train set 0.564x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 24
Epoch 29/200 |loss: -0.839712| train set 0.560x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 25
Epoch 30/200 |loss: -0.842461| train set 0.558x speedup, test set 4.782x speedup, val set 0.453x speedup, step: 26
Epoch 31/200 |loss: -0.845219| train set 0.559x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 27
Epoch 32/200 |loss: -0.847610| train set 0.559x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 28
Epoch 33/200 |loss: -0.849493| train set 0.559x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 29
Epoch 34/200 |loss: -0.851751| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 30
Epoch 35/200 |loss: -0.853860| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 31
Epoch 36/200 |loss: -0.855483| train set 0.558x speedup, test set 4.782x speedup, val set 0.831x speedup, step: 32
Epoch 37/200 |loss: -0.857057| train set 0.554x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 33
Epoch 38/200 |loss: -0.858217| train set 0.554x speedup, test set 5.046x speedup, val set 0.835x speedup, step: 34
Epoch 39/200 |loss: -0.859348| train set 0.556x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 35
Epoch 40/200 |loss: -0.860562| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 36
Epoch 41/200 |loss: -0.861796| train set 0.558x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 37
Epoch 42/200 |loss: -0.863099| train set 0.560x speedup, test set 5.046x speedup, val set 0.836x speedup, step: 38
Epoch 43/200 |loss: -0.864343| train set 0.561x speedup, test set 4.866x speedup, val set 0.841x speedup, step: 39
Epoch 44/200 |loss: -0.865625| train set 0.559x speedup, test set 4.866x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.867363| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.869596| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.872122| train set 0.569x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 43
Epoch 48/200 |loss: -0.873924| train set 0.608x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 44
Epoch 49/200 |loss: -0.874957| train set 0.583x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 45
Epoch 50/200 |loss: -0.876354| train set 0.642x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 46
Epoch 51/200 |loss: -0.877635| train set 0.640x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 47
Epoch 52/200 |loss: -0.878981| train set 0.645x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 48
Epoch 53/200 |loss: -0.880041| train set 0.643x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 49
Epoch 54/200 |loss: -0.881254| train set 0.642x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 50
Epoch 55/200 |loss: -0.883618| train set 0.645x speedup, test set 1.526x speedup, val set 0.523x speedup, step: 51
Epoch 56/200 |loss: -0.884537| train set 0.673x speedup, test set 1.526x speedup, val set 0.809x speedup, step: 52
Epoch 57/200 |loss: -0.884518| train set 0.646x speedup, test set 1.526x speedup, val set 0.523x speedup, step: 53
Epoch 58/200 |loss: -0.882073| train set 0.646x speedup, test set 1.526x speedup, val set 0.809x speedup, step: 54
Epoch 59/200 |loss: -0.889345| train set 0.674x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 55
Epoch 60/200 |loss: -0.875760| train set 0.646x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 56
Epoch 61/200 |loss: -0.886843| train set 0.646x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 57
Epoch 62/200 |loss: -0.889269| train set 0.677x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 58
Epoch 63/200 |loss: -0.894321| train set 0.677x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 59
Epoch 64/200 |loss: -0.897940| train set 0.696x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 60
Epoch 65/200 |loss: -0.894115| train set 0.732x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 61
Epoch 66/200 |loss: -0.896016| train set 0.677x speedup, test set 1.502x speedup, val set 0.810x speedup, step: 62
Epoch 67/200 |loss: -0.906023| train set 0.677x speedup, test set 1.502x speedup, val set 0.810x speedup, step: 63
Epoch 68/200 |loss: -0.901939| train set 0.698x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 64
Epoch 69/200 |loss: -0.904427| train set 0.735x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 65
Epoch 70/200 |loss: -0.907365| train set 0.735x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 66
Epoch 71/200 |loss: -0.909779| train set 0.734x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 67
Epoch 72/200 |loss: -0.906386| train set 0.695x speedup, test set 1.135x speedup, val set 0.546x speedup, step: 68
Epoch 73/200 |loss: -0.909809| train set 0.698x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 69
Epoch 74/200 |loss: -0.905800| train set 0.734x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 70
Epoch 75/200 |loss: -0.911575| train set 0.734x speedup, test set 1.135x speedup, val set 0.810x speedup, step: 71
Epoch 76/200 |loss: -0.903829| train set 0.733x speedup, test set 1.135x speedup, val set 0.848x speedup, step: 72
Epoch 77/200 |loss: -0.914359| train set 0.733x speedup, test set 1.135x speedup, val set 0.541x speedup, step: 73
Epoch 78/200 |loss: -0.914058| train set 0.735x speedup, test set 1.135x speedup, val set 0.546x speedup, step: 74
Epoch 79/200 |loss: -0.914651| train set 0.735x speedup, test set 1.135x speedup, val set 0.546x speedup, step: 75
Epoch 80/200 |loss: -0.916021| train set 0.733x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 76
Epoch 81/200 |loss: -0.917677| train set 0.733x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 77
Epoch 82/200 |loss: -0.917082| train set 0.735x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 78
Epoch 83/200 |loss: -0.918766| train set 0.735x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 79
Epoch 84/200 |loss: -0.919353| train set 0.735x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 80
Epoch 85/200 |loss: -0.917945| train set 0.736x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 81
Epoch 86/200 |loss: -0.918979| train set 0.736x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 82
Epoch 87/200 |loss: -0.920712| train set 0.736x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 83
Epoch 88/200 |loss: -0.919654| train set 0.733x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 84
Epoch 89/200 |loss: -0.918905| train set 0.741x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 85
Epoch 90/200 |loss: -0.921454| train set 0.752x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 86
Epoch 91/200 |loss: -0.919779| train set 0.753x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 87
Epoch 92/200 |loss: -0.922062| train set 0.753x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 88
Epoch 93/200 |loss: -0.922198| train set 0.753x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 89
Epoch 94/200 |loss: -0.920943| train set 0.753x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 90
Epoch 95/200 |loss: -0.923722| train set 0.752x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 91
Epoch 96/200 |loss: -0.922695| train set 0.751x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 92
Epoch 97/200 |loss: -0.922317| train set 0.753x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 93
Epoch 98/200 |loss: -0.924487| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 94
Epoch 99/200 |loss: -0.921940| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 95
Epoch 100/200 |loss: -0.925046| train set 0.754x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 96
Epoch 101/200 |loss: -0.924712| train set 0.753x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 97
Epoch 102/200 |loss: -0.919829| train set 0.758x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 98
Epoch 103/200 |loss: -0.921867| train set 0.759x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 99
Epoch 104/200 |loss: -0.924674| train set 0.758x speedup, test set 1.135x speedup, val set 0.803x speedup, step: 100
Epoch 105/200 |loss: -0.920096| train set 0.752x speedup, test set 1.135x speedup, val set 0.803x speedup, step: 101
Epoch 106/200 |loss: -0.924766| train set 0.754x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 102
Epoch 107/200 |loss: -0.923267| train set 0.754x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 103
Epoch 108/200 |loss: -0.923089| train set 0.754x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 104
Epoch 109/200 |loss: -0.923073| train set 0.760x speedup, test set 1.136x speedup, val set 0.853x speedup, step: 105
early stopping at epoch 109
Training per epoch cost 0.747 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 7, train speedup 0.911, test speedup 4.047, val speedup 0.746
best test speedup epoch: 20, train speedup 0.821, test speedup 5.046, val speedup 0.453
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 109, train speedup 0.760, test speedup 1.136, val speedup 0.853
execution cost 0:04:11.244965
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:02.116398, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690527| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694760| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699448| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704352| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710191| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719728| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.745574| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.779904| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790739| train set 0.824x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791232| train set 0.829x speedup, test set 4.894x speedup, val set 0.458x speedup, step: 15
Epoch 20/200 |loss: -0.793033| train set 0.821x speedup, test set 5.046x speedup, val set 0.456x speedup, step: 16
Epoch 21/200 |loss: -0.799298| train set 0.861x speedup, test set 5.046x speedup, val set 0.382x speedup, step: 17
Epoch 22/200 |loss: -0.806788| train set 0.761x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812251| train set 0.788x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 19
Epoch 24/200 |loss: -0.816452| train set 0.819x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821786| train set 0.777x speedup, test set 4.950x speedup, val set 0.374x speedup, step: 21
Epoch 26/200 |loss: -0.827165| train set 0.600x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831758| train set 0.562x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.836024| train set 0.562x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 24
Epoch 29/200 |loss: -0.839669| train set 0.560x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 25
Epoch 30/200 |loss: -0.842528| train set 0.596x speedup, test set 4.782x speedup, val set 0.453x speedup, step: 26
Epoch 31/200 |loss: -0.845265| train set 0.559x speedup, test set 4.803x speedup, val set 0.455x speedup, step: 27
Epoch 32/200 |loss: -0.847590| train set 0.559x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 28
Epoch 33/200 |loss: -0.849487| train set 0.559x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 29
Epoch 34/200 |loss: -0.851677| train set 0.559x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 30
Epoch 35/200 |loss: -0.853841| train set 0.559x speedup, test set 4.782x speedup, val set 0.837x speedup, step: 31
Epoch 36/200 |loss: -0.855500| train set 0.558x speedup, test set 4.782x speedup, val set 0.837x speedup, step: 32
Epoch 37/200 |loss: -0.857079| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 33
Epoch 38/200 |loss: -0.858226| train set 0.554x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 34
Epoch 39/200 |loss: -0.859385| train set 0.554x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 35
Epoch 40/200 |loss: -0.860634| train set 0.556x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 36
Epoch 41/200 |loss: -0.861834| train set 0.556x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 37
Epoch 42/200 |loss: -0.863094| train set 0.559x speedup, test set 5.046x speedup, val set 0.842x speedup, step: 38
Epoch 43/200 |loss: -0.864280| train set 0.560x speedup, test set 4.866x speedup, val set 0.847x speedup, step: 39
Epoch 44/200 |loss: -0.865509| train set 0.559x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.867118| train set 0.605x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.869345| train set 0.606x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.871776| train set 0.608x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 43
Epoch 48/200 |loss: -0.873611| train set 0.608x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 44
Epoch 49/200 |loss: -0.874918| train set 0.641x speedup, test set 4.157x speedup, val set 0.814x speedup, step: 45
Epoch 50/200 |loss: -0.876055| train set 0.641x speedup, test set 4.157x speedup, val set 0.814x speedup, step: 46
Epoch 51/200 |loss: -0.877525| train set 0.644x speedup, test set 4.157x speedup, val set 0.865x speedup, step: 47
Epoch 52/200 |loss: -0.878979| train set 0.646x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 48
Epoch 53/200 |loss: -0.880403| train set 0.644x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 49
Epoch 54/200 |loss: -0.881822| train set 0.644x speedup, test set 1.526x speedup, val set 0.814x speedup, step: 50
Epoch 55/200 |loss: -0.882874| train set 0.644x speedup, test set 1.526x speedup, val set 0.814x speedup, step: 51
Epoch 56/200 |loss: -0.884125| train set 0.676x speedup, test set 1.526x speedup, val set 0.814x speedup, step: 52
Epoch 57/200 |loss: -0.885798| train set 0.646x speedup, test set 1.526x speedup, val set 0.525x speedup, step: 53
Epoch 58/200 |loss: -0.885396| train set 0.674x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 54
Epoch 59/200 |loss: -0.870850| train set 0.646x speedup, test set 1.526x speedup, val set 0.525x speedup, step: 55
Epoch 60/200 |loss: -0.876864| train set 0.646x speedup, test set 1.526x speedup, val set 0.525x speedup, step: 56
early stopping at epoch 60
Training per epoch cost 0.742 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 7, train speedup 0.911, test speedup 4.047, val speedup 0.746
best test speedup epoch: 20, train speedup 0.821, test speedup 5.046, val speedup 0.456
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 60, train speedup 0.646, test speedup 1.526, val speedup 0.525
execution cost 0:02:19.084616
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:02.157255, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690527| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694760| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699448| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704352| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710191| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719728| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.745578| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.779999| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790676| train set 0.824x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791198| train set 0.827x speedup, test set 4.894x speedup, val set 0.458x speedup, step: 15
Epoch 20/200 |loss: -0.793049| train set 0.821x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 16
Epoch 21/200 |loss: -0.799348| train set 0.861x speedup, test set 5.046x speedup, val set 0.382x speedup, step: 17
Epoch 22/200 |loss: -0.806858| train set 0.762x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812294| train set 0.788x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 19
Epoch 24/200 |loss: -0.816416| train set 0.825x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821736| train set 0.852x speedup, test set 4.973x speedup, val set 0.374x speedup, step: 21
Epoch 26/200 |loss: -0.827081| train set 0.600x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831720| train set 0.562x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.836029| train set 0.562x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 24
Epoch 29/200 |loss: -0.839624| train set 0.560x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 25
Epoch 30/200 |loss: -0.842445| train set 0.558x speedup, test set 4.803x speedup, val set 0.453x speedup, step: 26
Epoch 31/200 |loss: -0.845215| train set 0.559x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 27
Epoch 32/200 |loss: -0.847540| train set 0.559x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 28
Epoch 33/200 |loss: -0.849440| train set 0.559x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 29
Epoch 34/200 |loss: -0.851682| train set 0.558x speedup, test set 4.782x speedup, val set 0.829x speedup, step: 30
Epoch 35/200 |loss: -0.853795| train set 0.557x speedup, test set 4.782x speedup, val set 0.829x speedup, step: 31
Epoch 36/200 |loss: -0.855434| train set 0.558x speedup, test set 4.782x speedup, val set 0.831x speedup, step: 32
Epoch 37/200 |loss: -0.857025| train set 0.554x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 33
Epoch 38/200 |loss: -0.858164| train set 0.554x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 34
Epoch 39/200 |loss: -0.859314| train set 0.554x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 35
Epoch 40/200 |loss: -0.860550| train set 0.556x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 36
Epoch 41/200 |loss: -0.861700| train set 0.556x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 37
Epoch 42/200 |loss: -0.862949| train set 0.560x speedup, test set 5.046x speedup, val set 0.836x speedup, step: 38
Epoch 43/200 |loss: -0.864223| train set 0.561x speedup, test set 4.866x speedup, val set 0.841x speedup, step: 39
Epoch 44/200 |loss: -0.865513| train set 0.562x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.867288| train set 0.566x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.869563| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.872034| train set 0.569x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 43
Epoch 48/200 |loss: -0.873577| train set 0.641x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 44
Epoch 49/200 |loss: -0.874927| train set 0.642x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 45
Epoch 50/200 |loss: -0.876327| train set 0.642x speedup, test set 4.157x speedup, val set 0.859x speedup, step: 46
Epoch 51/200 |loss: -0.877628| train set 0.642x speedup, test set 4.157x speedup, val set 0.859x speedup, step: 47
Epoch 52/200 |loss: -0.878820| train set 0.640x speedup, test set 4.157x speedup, val set 0.865x speedup, step: 48
Epoch 53/200 |loss: -0.880061| train set 0.644x speedup, test set 4.157x speedup, val set 0.865x speedup, step: 49
Epoch 54/200 |loss: -0.881818| train set 0.643x speedup, test set 4.157x speedup, val set 0.865x speedup, step: 50
Epoch 55/200 |loss: -0.883131| train set 0.643x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 51
Epoch 56/200 |loss: -0.883580| train set 0.644x speedup, test set 1.526x speedup, val set 0.809x speedup, step: 52
Epoch 57/200 |loss: -0.885499| train set 0.642x speedup, test set 1.502x speedup, val set 0.809x speedup, step: 53
Epoch 58/200 |loss: -0.886812| train set 0.646x speedup, test set 1.502x speedup, val set 0.523x speedup, step: 54
Epoch 59/200 |loss: -0.887942| train set 0.677x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 55
Epoch 60/200 |loss: -0.889485| train set 0.646x speedup, test set 1.502x speedup, val set 0.523x speedup, step: 56
Epoch 61/200 |loss: -0.886928| train set 0.677x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 57
Epoch 62/200 |loss: -0.892212| train set 0.674x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 58
Epoch 63/200 |loss: -0.884227| train set 0.646x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 59
Epoch 64/200 |loss: -0.874494| train set 0.697x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 60
Epoch 65/200 |loss: -0.878606| train set 0.646x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 61
early stopping at epoch 65
Training per epoch cost 0.665 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 7, train speedup 0.911, test speedup 4.047, val speedup 0.746
best test speedup epoch: 20, train speedup 0.821, test speedup 5.046, val speedup 0.453
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 65, train speedup 0.646, test speedup 1.135, val speedup 0.525
execution cost 0:02:22.264054
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:02.125194, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690527| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694760| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699448| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704352| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710190| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719726| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.745572| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.779995| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790688| train set 0.824x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791213| train set 0.827x speedup, test set 4.894x speedup, val set 0.458x speedup, step: 15
Epoch 20/200 |loss: -0.793073| train set 0.821x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 16
Epoch 21/200 |loss: -0.799400| train set 0.861x speedup, test set 5.046x speedup, val set 0.384x speedup, step: 17
Epoch 22/200 |loss: -0.806948| train set 0.762x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812351| train set 0.788x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 19
Epoch 24/200 |loss: -0.816429| train set 0.812x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821813| train set 0.643x speedup, test set 4.973x speedup, val set 0.374x speedup, step: 21
Epoch 26/200 |loss: -0.827129| train set 0.600x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831694| train set 0.562x speedup, test set 4.950x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.836024| train set 0.562x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 24
Epoch 29/200 |loss: -0.839656| train set 0.560x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 25
Epoch 30/200 |loss: -0.842469| train set 0.558x speedup, test set 4.782x speedup, val set 0.453x speedup, step: 26
Epoch 31/200 |loss: -0.845279| train set 0.559x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 27
Epoch 32/200 |loss: -0.847614| train set 0.559x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 28
Epoch 33/200 |loss: -0.849596| train set 0.559x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 29
Epoch 34/200 |loss: -0.851850| train set 0.558x speedup, test set 4.782x speedup, val set 0.835x speedup, step: 30
Epoch 35/200 |loss: -0.853901| train set 0.558x speedup, test set 4.782x speedup, val set 0.829x speedup, step: 31
Epoch 36/200 |loss: -0.855558| train set 0.557x speedup, test set 4.782x speedup, val set 0.831x speedup, step: 32
Epoch 37/200 |loss: -0.857074| train set 0.554x speedup, test set 4.782x speedup, val set 0.823x speedup, step: 33
Epoch 38/200 |loss: -0.858220| train set 0.554x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 34
Epoch 39/200 |loss: -0.859381| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 35
Epoch 40/200 |loss: -0.860592| train set 0.557x speedup, test set 5.046x speedup, val set 0.823x speedup, step: 36
Epoch 41/200 |loss: -0.861834| train set 0.559x speedup, test set 5.046x speedup, val set 0.836x speedup, step: 37
Epoch 42/200 |loss: -0.863138| train set 0.560x speedup, test set 4.866x speedup, val set 0.836x speedup, step: 38
Epoch 43/200 |loss: -0.864382| train set 0.562x speedup, test set 4.866x speedup, val set 0.847x speedup, step: 39
Epoch 44/200 |loss: -0.865804| train set 0.566x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.867885| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.870353| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.872440| train set 0.624x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 43
Epoch 48/200 |loss: -0.873741| train set 0.641x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 44
Epoch 49/200 |loss: -0.875155| train set 0.642x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 45
Epoch 50/200 |loss: -0.876490| train set 0.640x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 46
Epoch 51/200 |loss: -0.877728| train set 0.642x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 47
Epoch 52/200 |loss: -0.879059| train set 0.641x speedup, test set 4.157x speedup, val set 0.853x speedup, step: 48
Epoch 53/200 |loss: -0.880419| train set 0.643x speedup, test set 1.526x speedup, val set 0.853x speedup, step: 49
Epoch 54/200 |loss: -0.881991| train set 0.646x speedup, test set 1.526x speedup, val set 0.853x speedup, step: 50
Epoch 55/200 |loss: -0.882903| train set 0.646x speedup, test set 1.526x speedup, val set 0.853x speedup, step: 51
Epoch 56/200 |loss: -0.884648| train set 0.647x speedup, test set 1.526x speedup, val set 0.853x speedup, step: 52
Epoch 57/200 |loss: -0.886519| train set 0.646x speedup, test set 1.526x speedup, val set 0.525x speedup, step: 53
Epoch 58/200 |loss: -0.885454| train set 0.675x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 54
Epoch 59/200 |loss: -0.873311| train set 0.646x speedup, test set 1.526x speedup, val set 0.525x speedup, step: 55
Epoch 60/200 |loss: -0.881714| train set 0.645x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 56
Epoch 61/200 |loss: -0.885883| train set 0.676x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 57
Epoch 62/200 |loss: -0.888799| train set 0.678x speedup, test set 1.502x speedup, val set 0.853x speedup, step: 58
Epoch 63/200 |loss: -0.885964| train set 0.647x speedup, test set 1.135x speedup, val set 0.541x speedup, step: 59
Epoch 64/200 |loss: -0.890940| train set 0.646x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 60
Epoch 65/200 |loss: -0.889863| train set 0.677x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 61
Epoch 66/200 |loss: -0.897498| train set 0.677x speedup, test set 1.121x speedup, val set 0.814x speedup, step: 62
Epoch 67/200 |loss: -0.897301| train set 0.677x speedup, test set 1.121x speedup, val set 0.814x speedup, step: 63
Epoch 68/200 |loss: -0.903344| train set 0.677x speedup, test set 1.121x speedup, val set 0.814x speedup, step: 64
Epoch 69/200 |loss: -0.905796| train set 0.733x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 65
Epoch 70/200 |loss: -0.906470| train set 0.678x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 66
Epoch 71/200 |loss: -0.898363| train set 0.696x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 67
Epoch 72/200 |loss: -0.891643| train set 0.698x speedup, test set 1.135x speedup, val set 0.865x speedup, step: 68
Epoch 73/200 |loss: -0.904939| train set 0.733x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 69
Epoch 74/200 |loss: -0.888586| train set 0.734x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 70
Epoch 75/200 |loss: -0.911611| train set 0.696x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 71
Epoch 76/200 |loss: -0.904074| train set 0.686x speedup, test set 1.135x speedup, val set 0.430x speedup, step: 72
Epoch 77/200 |loss: -0.906900| train set 0.687x speedup, test set 1.135x speedup, val set 0.430x speedup, step: 73
Epoch 78/200 |loss: -0.907863| train set 0.697x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 74
Epoch 79/200 |loss: -0.909697| train set 0.733x speedup, test set 1.135x speedup, val set 0.814x speedup, step: 75
Epoch 80/200 |loss: -0.911498| train set 0.736x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 76
Epoch 81/200 |loss: -0.913666| train set 0.736x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 77
Epoch 82/200 |loss: -0.915363| train set 0.736x speedup, test set 1.121x speedup, val set 0.853x speedup, step: 78
Epoch 83/200 |loss: -0.916987| train set 0.734x speedup, test set 1.121x speedup, val set 0.853x speedup, step: 79
Epoch 84/200 |loss: -0.917836| train set 0.734x speedup, test set 1.121x speedup, val set 0.853x speedup, step: 80
Epoch 85/200 |loss: -0.918451| train set 0.733x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 81
Epoch 86/200 |loss: -0.918813| train set 0.733x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 82
Epoch 87/200 |loss: -0.918957| train set 0.733x speedup, test set 1.135x speedup, val set 0.853x speedup, step: 83
Epoch 88/200 |loss: -0.919733| train set 0.735x speedup, test set 1.136x speedup, val set 0.853x speedup, step: 84
Epoch 89/200 |loss: -0.920129| train set 0.735x speedup, test set 1.136x speedup, val set 0.853x speedup, step: 85
Epoch 90/200 |loss: -0.920911| train set 0.746x speedup, test set 1.136x speedup, val set 0.853x speedup, step: 86
Epoch 91/200 |loss: -0.920920| train set 0.753x speedup, test set 1.136x speedup, val set 0.853x speedup, step: 87
Epoch 92/200 |loss: -0.921805| train set 0.753x speedup, test set 1.136x speedup, val set 0.853x speedup, step: 88
Epoch 93/200 |loss: -0.921971| train set 0.753x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 89
Epoch 94/200 |loss: -0.922537| train set 0.754x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 90
Epoch 95/200 |loss: -0.922924| train set 0.754x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 91
Epoch 96/200 |loss: -0.923265| train set 0.754x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 92
Epoch 97/200 |loss: -0.923826| train set 0.754x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 93
Epoch 98/200 |loss: -0.924091| train set 0.756x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 94
Epoch 99/200 |loss: -0.924470| train set 0.756x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 95
Epoch 100/200 |loss: -0.924991| train set 0.756x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 96
Epoch 101/200 |loss: -0.925234| train set 0.754x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 97
Epoch 102/200 |loss: -0.925669| train set 0.753x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 98
Epoch 103/200 |loss: -0.926150| train set 0.753x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 99
Epoch 104/200 |loss: -0.926535| train set 0.753x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 100
Epoch 105/200 |loss: -0.927050| train set 0.753x speedup, test set 1.136x speedup, val set 0.865x speedup, step: 101
Epoch 106/200 |loss: -0.927404| train set 0.754x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 102
Epoch 107/200 |loss: -0.927909| train set 0.752x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 103
Epoch 108/200 |loss: -0.928252| train set 0.752x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 104
Epoch 109/200 |loss: -0.928774| train set 0.757x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 105
Epoch 110/200 |loss: -0.928989| train set 0.757x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 106
Epoch 111/200 |loss: -0.929280| train set 0.757x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 107
Epoch 112/200 |loss: -0.929467| train set 0.757x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 108
Epoch 113/200 |loss: -0.929725| train set 0.757x speedup, test set 1.136x speedup, val set 0.943x speedup, step: 109
Epoch 114/200 |loss: -0.929682| train set 0.757x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 110
Epoch 115/200 |loss: -0.928846| train set 0.755x speedup, test set 1.136x speedup, val set 0.943x speedup, step: 111
Epoch 116/200 |loss: -0.927780| train set 0.757x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 112
Epoch 117/200 |loss: -0.930483| train set 0.757x speedup, test set 1.136x speedup, val set 0.803x speedup, step: 113
Epoch 118/200 |loss: -0.927920| train set 0.753x speedup, test set 1.136x speedup, val set 0.943x speedup, step: 114
Epoch 119/200 |loss: -0.928198| train set 0.753x speedup, test set 1.136x speedup, val set 0.943x speedup, step: 115
early stopping at epoch 119
Training per epoch cost 0.665 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 7, train speedup 0.911, test speedup 4.047, val speedup 0.746
best test speedup epoch: 20, train speedup 0.821, test speedup 5.046, val speedup 0.453
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 119, train speedup 0.753, test speedup 1.136, val speedup 0.943
execution cost 0:04:03.621896
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
3.274369245575696
-2.1647477445042287
construct training samples cost 0:00:01.783108, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: -0.499925| train set 0.422x speedup, test set 1.475x speedup, val set 0.325x speedup, step: 1
Epoch 1/200 |loss: -0.516243| train set 0.724x speedup, test set 1.480x speedup, val set 0.485x speedup, step: 1
Epoch 2/200 |loss: -0.545616| train set 0.722x speedup, test set 1.475x speedup, val set 1.030x speedup, step: 1
Epoch 3/200 |loss: -0.582212| train set 0.716x speedup, test set 2.162x speedup, val set 0.485x speedup, step: 2
Epoch 4/200 |loss: -0.612078| train set 0.725x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 5/200 |loss: -0.633040| train set 0.689x speedup, test set 4.620x speedup, val set 1.030x speedup, step: 1
Epoch 6/200 |loss: -0.650124| train set 0.656x speedup, test set 4.742x speedup, val set 1.000x speedup, step: 2
Epoch 7/200 |loss: -0.665797| train set 0.911x speedup, test set 4.047x speedup, val set 0.746x speedup, step: 3
Epoch 8/200 |loss: -0.678878| train set 0.903x speedup, test set 4.047x speedup, val set 0.754x speedup, step: 4
Epoch 9/200 |loss: -0.685921| train set 0.841x speedup, test set 4.047x speedup, val set 0.412x speedup, step: 5
Epoch 10/200 |loss: -0.690526| train set 0.651x speedup, test set 4.716x speedup, val set 0.412x speedup, step: 6
Epoch 11/200 |loss: -0.694757| train set 0.665x speedup, test set 4.716x speedup, val set 0.475x speedup, step: 7
Epoch 12/200 |loss: -0.699443| train set 0.660x speedup, test set 4.716x speedup, val set 0.455x speedup, step: 8
Epoch 13/200 |loss: -0.704355| train set 0.659x speedup, test set 4.047x speedup, val set 0.455x speedup, step: 9
Epoch 14/200 |loss: -0.710208| train set 0.658x speedup, test set 4.063x speedup, val set 0.455x speedup, step: 10
Epoch 15/200 |loss: -0.719657| train set 0.629x speedup, test set 4.738x speedup, val set 0.455x speedup, step: 11
Epoch 16/200 |loss: -0.744995| train set 0.633x speedup, test set 2.340x speedup, val set 0.451x speedup, step: 12
Epoch 17/200 |loss: -0.779498| train set 0.823x speedup, test set 2.320x speedup, val set 0.455x speedup, step: 13
Epoch 18/200 |loss: -0.790808| train set 0.824x speedup, test set 4.646x speedup, val set 0.455x speedup, step: 14
Epoch 19/200 |loss: -0.791516| train set 0.828x speedup, test set 4.894x speedup, val set 0.459x speedup, step: 15
Epoch 20/200 |loss: -0.793491| train set 0.823x speedup, test set 5.046x speedup, val set 0.456x speedup, step: 16
Epoch 21/200 |loss: -0.799673| train set 0.801x speedup, test set 5.046x speedup, val set 0.398x speedup, step: 17
Epoch 22/200 |loss: -0.807278| train set 0.761x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 18
Epoch 23/200 |loss: -0.812660| train set 0.789x speedup, test set 5.046x speedup, val set 0.387x speedup, step: 19
Epoch 24/200 |loss: -0.816515| train set 0.825x speedup, test set 5.046x speedup, val set 0.374x speedup, step: 20
Epoch 25/200 |loss: -0.821793| train set 0.601x speedup, test set 5.046x speedup, val set 0.442x speedup, step: 21
Epoch 26/200 |loss: -0.827306| train set 0.616x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 22
Epoch 27/200 |loss: -0.831782| train set 0.564x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 23
Epoch 28/200 |loss: -0.835984| train set 0.562x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 24
Epoch 29/200 |loss: -0.839788| train set 0.561x speedup, test set 5.046x speedup, val set 0.453x speedup, step: 25
Epoch 30/200 |loss: -0.842608| train set 0.560x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 26
Epoch 31/200 |loss: -0.845165| train set 0.559x speedup, test set 4.957x speedup, val set 0.455x speedup, step: 27
Epoch 32/200 |loss: -0.847506| train set 0.560x speedup, test set 5.046x speedup, val set 0.455x speedup, step: 28
Epoch 33/200 |loss: -0.849500| train set 0.559x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 29
Epoch 34/200 |loss: -0.851597| train set 0.559x speedup, test set 4.782x speedup, val set 0.455x speedup, step: 30
Epoch 35/200 |loss: -0.853863| train set 0.559x speedup, test set 4.782x speedup, val set 0.837x speedup, step: 31
Epoch 36/200 |loss: -0.855585| train set 0.560x speedup, test set 4.782x speedup, val set 0.837x speedup, step: 32
Epoch 37/200 |loss: -0.857128| train set 0.559x speedup, test set 4.782x speedup, val set 0.840x speedup, step: 33
Epoch 38/200 |loss: -0.858422| train set 0.554x speedup, test set 5.046x speedup, val set 0.835x speedup, step: 34
Epoch 39/200 |loss: -0.859494| train set 0.558x speedup, test set 5.046x speedup, val set 0.835x speedup, step: 35
Epoch 40/200 |loss: -0.860721| train set 0.558x speedup, test set 5.046x speedup, val set 0.835x speedup, step: 36
Epoch 41/200 |loss: -0.861977| train set 0.560x speedup, test set 5.046x speedup, val set 0.859x speedup, step: 37
Epoch 42/200 |loss: -0.863253| train set 0.562x speedup, test set 5.046x speedup, val set 0.847x speedup, step: 38
Epoch 43/200 |loss: -0.864336| train set 0.562x speedup, test set 5.046x speedup, val set 0.847x speedup, step: 39
Epoch 44/200 |loss: -0.865562| train set 0.570x speedup, test set 4.866x speedup, val set 0.847x speedup, step: 40
Epoch 45/200 |loss: -0.866753| train set 0.567x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 41
Epoch 46/200 |loss: -0.868006| train set 0.583x speedup, test set 4.157x speedup, val set 0.847x speedup, step: 42
Epoch 47/200 |loss: -0.869376| train set 0.581x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 43
Epoch 48/200 |loss: -0.870632| train set 0.582x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 44
Epoch 49/200 |loss: -0.871891| train set 0.583x speedup, test set 4.157x speedup, val set 0.809x speedup, step: 45
Epoch 50/200 |loss: -0.873759| train set 0.584x speedup, test set 4.157x speedup, val set 0.814x speedup, step: 46
Epoch 51/200 |loss: -0.876022| train set 0.586x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 47
Epoch 52/200 |loss: -0.878474| train set 0.586x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 48
Epoch 53/200 |loss: -0.880168| train set 0.644x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 49
Epoch 54/200 |loss: -0.881549| train set 0.642x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 50
Epoch 55/200 |loss: -0.882710| train set 0.586x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 51
Epoch 56/200 |loss: -0.883938| train set 0.612x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 52
Epoch 57/200 |loss: -0.885909| train set 0.676x speedup, test set 1.526x speedup, val set 0.865x speedup, step: 53
Epoch 58/200 |loss: -0.886657| train set 0.612x speedup, test set 1.502x speedup, val set 0.865x speedup, step: 54
Epoch 59/200 |loss: -0.882688| train set 0.646x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 55
Epoch 60/200 |loss: -0.870952| train set 0.646x speedup, test set 1.502x speedup, val set 0.525x speedup, step: 56
Epoch 61/200 |loss: -0.880463| train set 0.677x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 57
Epoch 62/200 |loss: -0.889027| train set 0.612x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 58
Epoch 63/200 |loss: -0.870341| train set 0.677x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 59
Epoch 64/200 |loss: -0.893650| train set 0.696x speedup, test set 1.502x speedup, val set 0.468x speedup, step: 60
Epoch 65/200 |loss: -0.883115| train set 0.696x speedup, test set 1.135x speedup, val set 0.525x speedup, step: 61
Epoch 66/200 |loss: -0.885658| train set 0.697x speedup, test set 1.502x speedup, val set 0.814x speedup, step: 62
early stopping at epoch 66
Training per epoch cost 0.769 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 7, train speedup 0.911, test speedup 4.047, val speedup 0.746
best test speedup epoch: 20, train speedup 0.823, test speedup 5.046, val speedup 0.456
best validation speedup epoch: 5, train speedup 0.689, test speedup 4.620, val speedup 1.030
last model at epoch 66, train speedup 0.697, test speedup 1.502, val speedup 0.814
execution cost 0:02:40.344714
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.211107, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159264| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091822| train set 1.161x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809992| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.532793| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.279057| train set 1.151x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.017925| train set 1.153x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.786221| train set 1.155x speedup, test set 6.106x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.562792| train set 1.187x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.402122| train set 1.238x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.221434| train set 1.218x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.971560| train set 1.200x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.675610| train set 1.207x speedup, test set 8.158x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.542444| train set 1.204x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.406393| train set 1.223x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.063341| train set 1.204x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.855230| train set 1.177x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.773453| train set 1.206x speedup, test set 8.197x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.526289| train set 1.205x speedup, test set 9.145x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.241438| train set 1.206x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 28
Epoch 28/200 |loss: 25.036858| train set 1.197x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 29
Epoch 29/200 |loss: 25.019495| train set 1.156x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 25.374664| train set 1.163x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 25.293505| train set 1.197x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 32
Epoch 32/200 |loss: 24.443409| train set 1.217x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 25.150269| train set 1.226x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.105703| train set 1.197x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 35
Epoch 35/200 |loss: 24.516333| train set 1.209x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 36
Epoch 36/200 |loss: 23.775602| train set 1.239x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 24.049128| train set 1.227x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.541050| train set 1.227x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 39
Epoch 39/200 |loss: 23.579893| train set 1.242x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.281054| train set 1.250x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.221458| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 23.333927| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.356050| train set 1.254x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 23.477945| train set 1.232x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.398943| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.957445| train set 1.319x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.786661| train set 1.300x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.344059| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.427488| train set 1.305x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.518440| train set 1.318x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.663643| train set 1.322x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 22.067190| train set 1.317x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.722216| train set 1.307x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.271534| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.598656| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.043106| train set 1.325x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.943596| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 20.919603| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 20.566568| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.475044| train set 1.378x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.192368| train set 1.391x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.246098| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.352171| train set 1.343x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.037790| train set 1.330x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 19.978905| train set 1.391x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.439886| train set 1.251x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 20.691345| train set 1.358x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.861588| train set 1.345x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.937134| train set 1.388x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.555485| train set 1.380x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.580025| train set 1.345x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.581329| train set 1.374x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.044201| train set 1.390x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 18.846201| train set 1.345x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 18.899469| train set 1.461x speedup, test set 4.641x speedup, val set 0.739x speedup, step: 76
Epoch 76/200 |loss: 18.289570| train set 1.432x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.683964| train set 1.399x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.403543| train set 1.345x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 19.429049| train set 1.364x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 19.665901| train set 1.488x speedup, test set 5.702x speedup, val set 0.738x speedup, step: 81
Epoch 81/200 |loss: 20.069757| train set 1.333x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.743433| train set 1.319x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 20.196350| train set 1.471x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 19.024706| train set 1.419x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 19.315210| train set 1.489x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.966394| train set 1.401x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 19.118259| train set 1.350x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 18.729290| train set 1.401x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.114487| train set 1.404x speedup, test set 4.641x speedup, val set 0.738x speedup, step: 90
Epoch 90/200 |loss: 19.056046| train set 1.391x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.635406| train set 1.344x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 18.053741| train set 1.400x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.335035| train set 1.404x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 94
Epoch 94/200 |loss: 17.780102| train set 1.394x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 16.984591| train set 1.395x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.408253| train set 1.389x speedup, test set 4.675x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.843330| train set 1.380x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.807428| train set 1.427x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.691858| train set 1.397x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.411850| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.444822| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.216850| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.129988| train set 1.402x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.312325| train set 1.501x speedup, test set 4.700x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.235907| train set 1.412x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.514612| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.983841| train set 1.382x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.173447| train set 1.411x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.462437| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.919700| train set 1.397x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 16.175331| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 16.522520| train set 1.522x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.445341| train set 1.517x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.948017| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 16.736549| train set 1.360x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 16.052057| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 16.131622| train set 1.401x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 118/200 |loss: 16.658648| train set 1.392x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 16.338158| train set 1.412x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 16.095783| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 16.009163| train set 1.383x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 16.131273| train set 1.420x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 15.416915| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 16.585594| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 15.208297| train set 1.448x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 15.755594| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 15.807420| train set 1.406x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 15.081067| train set 1.446x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 129/200 |loss: 15.346769| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 14.989927| train set 1.476x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 14.486477| train set 1.402x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 14.745408| train set 1.421x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 14.753475| train set 1.476x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 134/200 |loss: 14.135996| train set 1.405x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 14.850364| train set 1.479x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 14.844098| train set 1.533x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 137/200 |loss: 14.188867| train set 1.495x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 138/200 |loss: 14.710070| train set 1.421x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 15.478575| train set 1.490x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 140/200 |loss: 14.021581| train set 1.440x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 141/200 |loss: 15.539258| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 142/200 |loss: 14.723787| train set 1.472x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 143/200 |loss: 14.237427| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 144/200 |loss: 15.135209| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 145/200 |loss: 13.857165| train set 1.471x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 146/200 |loss: 14.122169| train set 1.464x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 147/200 |loss: 13.497778| train set 1.461x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 148/200 |loss: 13.807109| train set 1.515x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 149/200 |loss: 13.580496| train set 1.509x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 150/200 |loss: 13.517231| train set 1.544x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 151/200 |loss: 13.589400| train set 1.472x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 152/200 |loss: 13.114631| train set 1.503x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 153/200 |loss: 13.166646| train set 1.511x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 154/200 |loss: 12.933860| train set 1.509x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 155/200 |loss: 12.916111| train set 1.509x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 156/200 |loss: 12.840955| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 157/200 |loss: 12.794913| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 158/200 |loss: 13.112386| train set 1.533x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 159/200 |loss: 13.647119| train set 1.449x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 160/200 |loss: 14.458179| train set 1.533x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 161/200 |loss: 14.366094| train set 1.488x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 162/200 |loss: 12.981702| train set 1.461x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 163/200 |loss: 13.657800| train set 1.453x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 164/200 |loss: 13.367914| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 165/200 |loss: 13.064208| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 166/200 |loss: 12.875871| train set 1.563x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 167/200 |loss: 12.836173| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 168/200 |loss: 12.988732| train set 1.525x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 169/200 |loss: 12.446037| train set 1.511x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 170/200 |loss: 12.830223| train set 1.482x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 171/200 |loss: 12.479596| train set 1.542x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 172/200 |loss: 12.578499| train set 1.553x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 173/200 |loss: 12.590490| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 174/200 |loss: 12.295023| train set 1.554x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 175/200 |loss: 12.454782| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 176/200 |loss: 11.919441| train set 1.525x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 177/200 |loss: 11.955025| train set 1.547x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 178/200 |loss: 11.887362| train set 1.522x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 179/200 |loss: 11.865197| train set 1.551x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 180/200 |loss: 11.985662| train set 1.541x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 181/200 |loss: 12.063675| train set 1.539x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 182/200 |loss: 12.436950| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 183/200 |loss: 13.932614| train set 1.479x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 184/200 |loss: 12.690355| train set 1.544x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 185/200 |loss: 12.910933| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 186/200 |loss: 13.022344| train set 1.529x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 187/200 |loss: 12.697136| train set 1.474x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 188/200 |loss: 12.137927| train set 1.539x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 189/200 |loss: 12.350153| train set 1.564x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 190/200 |loss: 12.788040| train set 1.528x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 191/200 |loss: 11.542694| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 192/200 |loss: 12.181489| train set 1.557x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 193/200 |loss: 12.354070| train set 1.520x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 194/200 |loss: 11.976592| train set 1.520x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 3
Epoch 195/200 |loss: 11.909595| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 196/200 |loss: 12.094513| train set 1.479x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 197/200 |loss: 11.745710| train set 1.526x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 3
Epoch 198/200 |loss: 11.569835| train set 1.543x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 199/200 |loss: 11.850245| train set 1.554x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Training per epoch cost 0.329 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 189, train speedup 1.564, test speedup 4.652, val speedup 0.997
best test speedup epoch: 16, train speedup 1.187, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 198, train speedup 1.543, test speedup 4.652, val speedup 0.997
last model at epoch 199, train speedup 1.554, test speedup 4.652, val speedup 0.994
execution cost 0:03:04.209126
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.157245, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787601| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695999| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379667| train set 1.115x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083689| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800642| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.531853| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.289938| train set 1.166x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.019501| train set 1.169x speedup, test set 6.345x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.764673| train set 1.154x speedup, test set 6.921x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.515310| train set 1.211x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.303631| train set 1.236x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.177002| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 27.194017| train set 1.235x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.722305| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.474764| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.431934| train set 1.224x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.033546| train set 1.212x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.944489| train set 1.179x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.830435| train set 1.206x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.419596| train set 1.215x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.394291| train set 1.180x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.283934| train set 1.203x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 29
Epoch 29/200 |loss: 24.863420| train set 1.228x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 24.906658| train set 1.198x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 25.004393| train set 1.165x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 32
Epoch 32/200 |loss: 24.767258| train set 1.218x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 33
Epoch 33/200 |loss: 24.580616| train set 1.204x speedup, test set 8.197x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.427429| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 24.123848| train set 1.231x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.306721| train set 1.226x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.806540| train set 1.231x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 38
Epoch 38/200 |loss: 23.728050| train set 1.232x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 39
Epoch 39/200 |loss: 23.633333| train set 1.278x speedup, test set 5.905x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.185688| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.379143| train set 1.305x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 22.815327| train set 1.264x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.823355| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.775303| train set 1.317x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.299356| train set 1.305x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.429474| train set 1.317x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.302456| train set 1.311x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 21.975431| train set 1.339x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 49
Epoch 49/200 |loss: 22.288328| train set 1.237x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 50
Epoch 50/200 |loss: 22.716028| train set 1.325x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.980663| train set 1.331x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 52
Epoch 52/200 |loss: 21.898262| train set 1.326x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.714025| train set 1.328x speedup, test set 4.641x speedup, val set 0.931x speedup, step: 54
Epoch 54/200 |loss: 22.362068| train set 1.306x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 21.341072| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 21.494867| train set 1.338x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 57
Epoch 57/200 |loss: 21.885578| train set 1.329x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 20.824890| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 21.876476| train set 1.328x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 60
Epoch 60/200 |loss: 21.410240| train set 1.300x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 21.272696| train set 1.295x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.750847| train set 1.372x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.818684| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.289145| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.423428| train set 1.335x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 19.868301| train set 1.338x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.207470| train set 1.329x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.646559| train set 1.307x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.633718| train set 1.392x speedup, test set 4.641x speedup, val set 0.701x speedup, step: 70
Epoch 70/200 |loss: 19.479750| train set 1.331x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 19.292324| train set 1.331x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.380110| train set 1.330x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.131786| train set 1.448x speedup, test set 4.641x speedup, val set 0.701x speedup, step: 74
Epoch 74/200 |loss: 19.376993| train set 1.330x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.588772| train set 1.385x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 19.101170| train set 1.385x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.493673| train set 1.377x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 18.663612| train set 1.380x speedup, test set 4.641x speedup, val set 0.739x speedup, step: 79
Epoch 79/200 |loss: 18.491121| train set 1.333x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.326080| train set 1.333x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 17.850634| train set 1.359x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 18.652863| train set 1.357x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 21.264013| train set 1.403x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 24.017952| train set 1.318x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 21.304762| train set 1.273x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 22.238684| train set 1.401x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 21.263914| train set 1.334x speedup, test set 4.641x speedup, val set 0.739x speedup, step: 88
Epoch 88/200 |loss: 21.084059| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 20.501648| train set 1.247x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 90
Epoch 90/200 |loss: 20.368093| train set 1.362x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 19.816576| train set 1.382x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 19.959332| train set 1.367x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 93
Epoch 93/200 |loss: 19.165241| train set 1.364x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 94
Epoch 94/200 |loss: 19.347515| train set 1.337x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 18.641762| train set 1.319x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 18.950573| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 97
Epoch 97/200 |loss: 18.326851| train set 1.322x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 98
Epoch 98/200 |loss: 18.388884| train set 1.435x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 99
Epoch 99/200 |loss: 18.001612| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 100
Epoch 100/200 |loss: 17.810795| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 101/200 |loss: 17.795904| train set 1.397x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 102/200 |loss: 17.460119| train set 1.415x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 103/200 |loss: 17.373325| train set 1.436x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 104/200 |loss: 17.158339| train set 1.419x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 105/200 |loss: 17.064287| train set 1.415x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 2
Epoch 106/200 |loss: 16.836594| train set 1.416x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 3
Epoch 107/200 |loss: 16.746994| train set 1.415x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 4
Epoch 108/200 |loss: 16.555479| train set 1.416x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 109/200 |loss: 16.357265| train set 1.415x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 110/200 |loss: 16.327219| train set 1.412x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 111/200 |loss: 16.245661| train set 1.448x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 1
Epoch 112/200 |loss: 16.404596| train set 1.469x speedup, test set 4.641x speedup, val set 0.738x speedup, step: 2
Epoch 113/200 |loss: 17.142273| train set 1.352x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 1
Epoch 114/200 |loss: 18.331175| train set 1.412x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 2
Epoch 115/200 |loss: 16.247568| train set 1.464x speedup, test set 4.641x speedup, val set 0.738x speedup, step: 3
Epoch 116/200 |loss: 16.360594| train set 1.409x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 4
Epoch 117/200 |loss: 17.182579| train set 1.415x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 5
Epoch 118/200 |loss: 15.744295| train set 1.415x speedup, test set 4.641x speedup, val set 0.994x speedup, step: 6
Epoch 119/200 |loss: 16.365219| train set 1.416x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 7
Epoch 120/200 |loss: 16.137201| train set 1.415x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 8
Epoch 121/200 |loss: 15.464748| train set 1.517x speedup, test set 4.641x speedup, val set 0.737x speedup, step: 9
Epoch 122/200 |loss: 16.068424| train set 1.416x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 10
Epoch 123/200 |loss: 15.233692| train set 1.450x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 11
Epoch 124/200 |loss: 15.467449| train set 1.475x speedup, test set 4.641x speedup, val set 0.994x speedup, step: 12
Epoch 125/200 |loss: 15.325789| train set 1.422x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 13
Epoch 126/200 |loss: 15.345267| train set 1.397x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 14
Epoch 127/200 |loss: 16.676382| train set 1.415x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 15
Epoch 128/200 |loss: 18.824148| train set 1.430x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 16
Epoch 129/200 |loss: 15.128711| train set 1.397x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 17
Epoch 130/200 |loss: 19.279192| train set 1.500x speedup, test set 4.642x speedup, val set 0.997x speedup, step: 18
Epoch 131/200 |loss: 18.866209| train set 1.414x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 132/200 |loss: 18.428143| train set 1.361x speedup, test set 4.641x speedup, val set 0.994x speedup, step: 20
Epoch 133/200 |loss: 16.824726| train set 1.397x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 21
Epoch 134/200 |loss: 17.234903| train set 1.363x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 22
Epoch 135/200 |loss: 16.849554| train set 1.393x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 136/200 |loss: 16.193882| train set 1.410x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 137/200 |loss: 16.253246| train set 1.413x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 25
Epoch 138/200 |loss: 15.945407| train set 1.417x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 26
Epoch 139/200 |loss: 15.558927| train set 1.440x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 140/200 |loss: 15.728460| train set 1.417x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 141/200 |loss: 15.095549| train set 1.417x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 29
Epoch 142/200 |loss: 15.104853| train set 1.447x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 30
Epoch 143/200 |loss: 14.955628| train set 1.448x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 31
Epoch 144/200 |loss: 14.599469| train set 1.457x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 32
Epoch 145/200 |loss: 14.695314| train set 1.452x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 33
Epoch 146/200 |loss: 14.369291| train set 1.415x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 34
Epoch 147/200 |loss: 14.271933| train set 1.455x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 35
Epoch 148/200 |loss: 14.153957| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 36
Epoch 149/200 |loss: 14.037739| train set 1.475x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 37
Epoch 150/200 |loss: 13.814545| train set 1.392x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 38
Epoch 151/200 |loss: 13.823942| train set 1.405x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 39
Epoch 152/200 |loss: 13.677049| train set 1.452x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 40
Epoch 153/200 |loss: 13.589360| train set 1.499x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 41
Epoch 154/200 |loss: 13.666142| train set 1.538x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 42
Epoch 155/200 |loss: 13.737869| train set 1.494x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 43
Epoch 156/200 |loss: 13.694176| train set 1.447x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 44
Epoch 157/200 |loss: 13.615573| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 45
Epoch 158/200 |loss: 13.423753| train set 1.506x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 46
Epoch 159/200 |loss: 13.091966| train set 1.475x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 47
Epoch 160/200 |loss: 12.913365| train set 1.508x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 48
Epoch 161/200 |loss: 12.888263| train set 1.539x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 49
Epoch 162/200 |loss: 12.989850| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 50
Epoch 163/200 |loss: 13.204757| train set 1.447x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 164/200 |loss: 13.452751| train set 1.507x speedup, test set 4.641x speedup, val set 0.994x speedup, step: 52
Epoch 165/200 |loss: 13.188409| train set 1.507x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 53
Epoch 166/200 |loss: 13.311913| train set 1.392x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 167/200 |loss: 13.213448| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 55
Epoch 168/200 |loss: 12.930592| train set 1.536x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 56
Epoch 169/200 |loss: 12.748144| train set 1.512x speedup, test set 4.641x speedup, val set 0.994x speedup, step: 57
Epoch 170/200 |loss: 12.579204| train set 1.539x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 58
Epoch 171/200 |loss: 12.528981| train set 1.545x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 59
Epoch 172/200 |loss: 12.703993| train set 1.537x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 173/200 |loss: 13.343333| train set 1.423x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 61
Epoch 174/200 |loss: 12.613761| train set 1.523x speedup, test set 4.641x speedup, val set 0.994x speedup, step: 62
Epoch 175/200 |loss: 12.360304| train set 1.514x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 63
Epoch 176/200 |loss: 12.941384| train set 1.546x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 64
Epoch 177/200 |loss: 12.656417| train set 1.538x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 65
Epoch 178/200 |loss: 12.382862| train set 1.520x speedup, test set 4.642x speedup, val set 0.997x speedup, step: 66
Epoch 179/200 |loss: 12.205835| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 67
Epoch 180/200 |loss: 12.013269| train set 1.519x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 68
Epoch 181/200 |loss: 12.079068| train set 1.512x speedup, test set 4.641x speedup, val set 0.994x speedup, step: 69
Epoch 182/200 |loss: 12.203363| train set 1.538x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 70
Epoch 183/200 |loss: 12.677002| train set 1.507x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 71
Epoch 184/200 |loss: 12.398255| train set 1.507x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 72
Epoch 185/200 |loss: 12.085176| train set 1.513x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 73
Epoch 186/200 |loss: 11.876340| train set 1.515x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 74
Epoch 187/200 |loss: 11.910403| train set 1.556x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 75
Epoch 188/200 |loss: 11.640481| train set 1.559x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 76
Epoch 189/200 |loss: 11.816594| train set 1.502x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 77
Epoch 190/200 |loss: 12.462288| train set 1.536x speedup, test set 4.642x speedup, val set 0.997x speedup, step: 78
Epoch 191/200 |loss: 11.950024| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 79
Epoch 192/200 |loss: 11.830693| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 80
Epoch 193/200 |loss: 11.770831| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 81
Epoch 194/200 |loss: 11.715260| train set 1.539x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 82
Epoch 195/200 |loss: 12.179042| train set 1.467x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 83
Epoch 196/200 |loss: 13.052704| train set 1.506x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 84
Epoch 197/200 |loss: 13.332222| train set 1.493x speedup, test set 4.642x speedup, val set 0.997x speedup, step: 85
Epoch 198/200 |loss: 11.917694| train set 1.501x speedup, test set 4.641x speedup, val set 0.994x speedup, step: 86
Epoch 199/200 |loss: 12.151823| train set 1.535x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 87
Training per epoch cost 0.338 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 188, train speedup 1.559, test speedup 4.652, val speedup 0.997
best test speedup epoch: 18, train speedup 1.216, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 113, train speedup 1.352, test speedup 4.641, val speedup 1.008
last model at epoch 199, train speedup 1.535, test speedup 4.641, val speedup 1.008
execution cost 0:03:04.746896
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.234629, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695995| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379642| train set 1.115x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083645| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800293| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.530991| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.289431| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.016975| train set 1.173x speedup, test set 6.345x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.761539| train set 1.155x speedup, test set 6.921x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.498508| train set 1.211x speedup, test set 6.410x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.269325| train set 1.236x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.037382| train set 1.216x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.818727| train set 1.204x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.707733| train set 1.216x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 21
Epoch 21/200 |loss: 27.024174| train set 1.199x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.353336| train set 1.224x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.143394| train set 1.184x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 24
Epoch 24/200 |loss: 26.200211| train set 1.206x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 25
Epoch 25/200 |loss: 25.635286| train set 1.214x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.893133| train set 1.186x speedup, test set 5.905x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.428726| train set 1.202x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 28
Epoch 28/200 |loss: 25.384203| train set 1.227x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 29
Epoch 29/200 |loss: 25.196199| train set 1.208x speedup, test set 6.129x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 24.837412| train set 1.202x speedup, test set 8.197x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.881971| train set 1.200x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.463663| train set 1.190x speedup, test set 5.871x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.572483| train set 1.228x speedup, test set 4.641x speedup, val set 0.932x speedup, step: 34
Epoch 34/200 |loss: 24.417599| train set 1.276x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.221870| train set 1.229x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 36
Epoch 36/200 |loss: 24.235863| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.679661| train set 1.244x speedup, test set 8.197x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.733299| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 39
Epoch 39/200 |loss: 23.802822| train set 1.299x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.160513| train set 1.318x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.280905| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.960150| train set 1.264x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.770020| train set 1.275x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.766296| train set 1.232x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.437963| train set 1.317x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.246996| train set 1.315x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.077555| train set 1.311x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 21.852036| train set 1.299x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 49
Epoch 49/200 |loss: 21.892780| train set 1.237x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.303387| train set 1.380x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 51
Epoch 51/200 |loss: 21.807463| train set 1.313x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.467575| train set 1.326x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.705402| train set 1.295x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 54
Epoch 54/200 |loss: 21.747869| train set 1.236x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.742195| train set 1.326x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.263706| train set 1.343x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.634417| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 21.100716| train set 1.391x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.757509| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.177624| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.347170| train set 1.392x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.141794| train set 1.329x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 19.962034| train set 1.331x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 19.573362| train set 1.344x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 19.501175| train set 1.330x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 19.474850| train set 1.398x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 19.952431| train set 1.330x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 20.382761| train set 1.323x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 21.823891| train set 1.337x speedup, test set 5.685x speedup, val set 0.701x speedup, step: 70
Epoch 70/200 |loss: 20.336098| train set 1.303x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 21.218960| train set 1.320x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 21.002026| train set 1.417x speedup, test set 4.641x speedup, val set 0.701x speedup, step: 73
Epoch 73/200 |loss: 20.577415| train set 1.281x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 21.487072| train set 1.322x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.540886| train set 1.400x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 20.079592| train set 1.321x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.191664| train set 1.309x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 19.836578| train set 1.399x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.824282| train set 1.470x speedup, test set 4.641x speedup, val set 0.739x speedup, step: 80
Epoch 80/200 |loss: 19.217400| train set 1.384x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 18.605148| train set 1.331x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 18.823639| train set 1.398x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 18.249203| train set 1.400x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 18.387171| train set 1.350x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 18.088499| train set 1.350x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 17.978783| train set 1.350x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 17.712177| train set 1.398x speedup, test set 4.641x speedup, val set 0.739x speedup, step: 88
Epoch 88/200 |loss: 17.652424| train set 1.398x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 17.443115| train set 1.349x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 90
Epoch 90/200 |loss: 17.408844| train set 1.349x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 17.275650| train set 1.414x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 17.052032| train set 1.414x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 93
Epoch 93/200 |loss: 16.775656| train set 1.401x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 94
Epoch 94/200 |loss: 16.785570| train set 1.432x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 16.538689| train set 1.430x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 16.371386| train set 1.389x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 97
Epoch 97/200 |loss: 16.374413| train set 1.402x speedup, test set 4.663x speedup, val set 0.998x speedup, step: 98
Epoch 98/200 |loss: 16.882526| train set 1.357x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 99
Epoch 99/200 |loss: 19.077682| train set 1.402x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 100
Epoch 100/200 |loss: 19.295664| train set 1.416x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 101/200 |loss: 17.202572| train set 1.347x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 102/200 |loss: 17.325300| train set 1.415x speedup, test set 4.652x speedup, val set 0.993x speedup, step: 2
Epoch 103/200 |loss: 17.625931| train set 1.373x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 104/200 |loss: 16.134069| train set 1.388x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 105/200 |loss: 16.813967| train set 1.454x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 106/200 |loss: 16.309397| train set 1.421x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 107/200 |loss: 15.795395| train set 1.428x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 108/200 |loss: 16.294771| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 109/200 |loss: 15.510114| train set 1.406x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 110/200 |loss: 15.739799| train set 1.416x speedup, test set 4.700x speedup, val set 0.997x speedup, step: 2
Epoch 111/200 |loss: 15.969656| train set 1.403x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 112/200 |loss: 16.085651| train set 1.518x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 2
Epoch 113/200 |loss: 17.806469| train set 1.340x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 114/200 |loss: 16.639986| train set 1.388x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 115/200 |loss: 15.490518| train set 1.471x speedup, test set 4.848x speedup, val set 0.739x speedup, step: 2
Epoch 116/200 |loss: 16.782354| train set 1.427x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 117/200 |loss: 16.079609| train set 1.446x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 118/200 |loss: 15.483727| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 119/200 |loss: 15.878993| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 120/200 |loss: 15.781909| train set 1.425x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 121/200 |loss: 14.952768| train set 1.501x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 122/200 |loss: 16.263638| train set 1.387x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 123/200 |loss: 15.664817| train set 1.406x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 124/200 |loss: 15.366582| train set 1.478x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 3
Epoch 125/200 |loss: 16.007792| train set 1.415x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 126/200 |loss: 14.864147| train set 1.420x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 127/200 |loss: 15.367656| train set 1.448x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 128/200 |loss: 14.469540| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 129/200 |loss: 14.678798| train set 1.436x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 130/200 |loss: 14.711137| train set 1.419x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 131/200 |loss: 14.184827| train set 1.489x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 132/200 |loss: 14.420108| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 133/200 |loss: 14.221680| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 134/200 |loss: 13.831084| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 135/200 |loss: 13.851501| train set 1.419x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 136/200 |loss: 13.868214| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 137/200 |loss: 13.556038| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 138/200 |loss: 13.586633| train set 1.423x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 139/200 |loss: 13.801483| train set 1.421x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 140/200 |loss: 14.368514| train set 1.466x speedup, test set 4.775x speedup, val set 0.996x speedup, step: 16
Epoch 141/200 |loss: 14.790277| train set 1.447x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 142/200 |loss: 15.804654| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 143/200 |loss: 13.903447| train set 1.496x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 144/200 |loss: 14.083082| train set 1.441x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 145/200 |loss: 15.302667| train set 1.437x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 146/200 |loss: 13.808292| train set 1.484x speedup, test set 4.775x speedup, val set 0.996x speedup, step: 6
Epoch 147/200 |loss: 15.242063| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 148/200 |loss: 15.593197| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 149/200 |loss: 14.395626| train set 1.395x speedup, test set 4.652x speedup, val set 0.992x speedup, step: 9
Epoch 150/200 |loss: 15.114204| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 151/200 |loss: 14.163260| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 152/200 |loss: 14.148559| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 153/200 |loss: 13.666180| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 154/200 |loss: 13.958093| train set 1.550x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 155/200 |loss: 13.155590| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 156/200 |loss: 13.588351| train set 1.499x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 157/200 |loss: 13.049054| train set 1.560x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 158/200 |loss: 13.224080| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 159/200 |loss: 12.959824| train set 1.487x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 160/200 |loss: 12.797475| train set 1.531x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 161/200 |loss: 12.851031| train set 1.557x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 162/200 |loss: 12.584478| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 163/200 |loss: 12.582750| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 23
Epoch 164/200 |loss: 12.513593| train set 1.563x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 165/200 |loss: 12.310916| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 25
Epoch 166/200 |loss: 12.369781| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 26
Epoch 167/200 |loss: 12.228571| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 168/200 |loss: 12.111901| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 169/200 |loss: 12.224149| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 29
Epoch 170/200 |loss: 12.195120| train set 1.542x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 171/200 |loss: 12.339831| train set 1.481x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 172/200 |loss: 12.742943| train set 1.538x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 173/200 |loss: 12.486792| train set 1.512x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 174/200 |loss: 11.938319| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 175/200 |loss: 11.864567| train set 1.562x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 176/200 |loss: 12.034908| train set 1.542x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 177/200 |loss: 12.227530| train set 1.551x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 178/200 |loss: 12.974682| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 179/200 |loss: 13.792126| train set 1.556x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 180/200 |loss: 13.034758| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 181/200 |loss: 12.664002| train set 1.525x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 182/200 |loss: 12.433534| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 183/200 |loss: 13.488993| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 184/200 |loss: 13.065155| train set 1.481x speedup, test set 4.652x speedup, val set 0.996x speedup, step: 15
Epoch 185/200 |loss: 12.426674| train set 1.528x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 186/200 |loss: 13.779451| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 187/200 |loss: 12.124934| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 188/200 |loss: 12.788712| train set 1.559x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 189/200 |loss: 12.963827| train set 1.524x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 190/200 |loss: 12.608151| train set 1.513x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 191/200 |loss: 12.824693| train set 1.487x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 192/200 |loss: 12.167275| train set 1.528x speedup, test set 4.775x speedup, val set 0.991x speedup, step: 5
Epoch 193/200 |loss: 12.865956| train set 1.513x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 194/200 |loss: 12.513762| train set 1.475x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 195/200 |loss: 12.543468| train set 1.529x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 196/200 |loss: 12.175065| train set 1.556x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 197/200 |loss: 12.755843| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 198/200 |loss: 12.124774| train set 1.563x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 199/200 |loss: 11.990652| train set 1.559x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Training per epoch cost 0.345 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 198, train speedup 1.563, test speedup 4.652, val speedup 0.997
best test speedup epoch: 20, train speedup 1.216, test speedup 9.635, val speedup 0.932
best validation speedup epoch: 188, train speedup 1.559, test speedup 4.775, val speedup 1.008
last model at epoch 199, train speedup 1.559, test speedup 4.652, val speedup 0.997
execution cost 0:03:06.095609
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.190613, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787601| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079838| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695999| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379642| train set 1.115x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083824| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.799490| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.530720| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.289526| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.019733| train set 1.178x speedup, test set 6.345x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.766167| train set 1.155x speedup, test set 5.072x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.505817| train set 1.210x speedup, test set 6.410x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.280083| train set 1.236x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.090252| train set 1.216x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 27.092699| train set 1.219x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.891401| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.450054| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.290998| train set 1.207x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.161514| train set 1.186x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.822025| train set 1.187x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.670414| train set 1.196x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.558224| train set 1.208x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 27
Epoch 27/200 |loss: 25.293306| train set 1.226x speedup, test set 6.106x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.072823| train set 1.190x speedup, test set 9.635x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.202690| train set 1.205x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.179956| train set 1.203x speedup, test set 9.635x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.526207| train set 1.199x speedup, test set 9.635x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.713228| train set 1.229x speedup, test set 6.345x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.404627| train set 1.229x speedup, test set 5.871x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.086834| train set 1.189x speedup, test set 9.635x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.163637| train set 1.232x speedup, test set 5.871x speedup, val set 0.997x speedup, step: 36
Epoch 36/200 |loss: 23.676783| train set 1.231x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.636934| train set 1.213x speedup, test set 8.636x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.588753| train set 1.264x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.143276| train set 1.232x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.285900| train set 1.267x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.519619| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 24.257128| train set 1.318x speedup, test set 8.197x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.925409| train set 1.258x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 23.088652| train set 1.232x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 24.030178| train set 1.311x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.547361| train set 1.280x speedup, test set 9.145x speedup, val set 0.931x speedup, step: 47
Epoch 47/200 |loss: 23.367577| train set 1.232x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 48
Epoch 48/200 |loss: 22.168871| train set 1.232x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 49
Epoch 49/200 |loss: 22.947468| train set 1.324x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 50
Epoch 50/200 |loss: 21.877930| train set 1.336x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 51
Epoch 51/200 |loss: 22.461411| train set 1.326x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 52
Epoch 52/200 |loss: 21.559244| train set 1.245x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 21.995075| train set 1.313x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 21.361595| train set 1.343x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 55
Epoch 55/200 |loss: 21.542145| train set 1.330x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 21.052053| train set 1.328x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.053701| train set 1.343x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 20.824547| train set 1.343x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 20.568472| train set 1.329x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.600561| train set 1.343x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.144770| train set 1.343x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.255386| train set 1.343x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 19.990198| train set 1.329x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 19.818699| train set 1.344x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 65
Epoch 65/200 |loss: 20.381704| train set 1.221x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 21.581232| train set 1.330x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 67
Epoch 67/200 |loss: 20.518236| train set 1.288x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 20.034048| train set 1.316x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 20.551344| train set 1.332x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.498743| train set 1.409x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 71
Epoch 71/200 |loss: 20.194624| train set 1.338x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.885187| train set 1.345x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 19.912556| train set 1.408x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 19.631147| train set 1.345x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 19.265867| train set 1.331x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 19.186256| train set 1.393x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.799828| train set 1.321x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 18.811771| train set 1.345x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 18.600525| train set 1.400x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.166430| train set 1.348x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 18.529182| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 17.844049| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 17.980274| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 18.173170| train set 1.390x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 18.991776| train set 1.424x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 22.615759| train set 1.318x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 19.125656| train set 1.270x speedup, test set 4.641x speedup, val set 0.993x speedup, step: 88
Epoch 88/200 |loss: 21.606422| train set 1.398x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 19.508902| train set 1.399x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 90
Epoch 90/200 |loss: 19.664459| train set 1.373x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 18.537916| train set 1.355x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 19.495865| train set 1.373x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 93
Epoch 93/200 |loss: 17.974529| train set 1.399x speedup, test set 5.702x speedup, val set 0.998x speedup, step: 94
Epoch 94/200 |loss: 18.695541| train set 1.399x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 17.649607| train set 1.390x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 18.412092| train set 1.399x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 97
Epoch 97/200 |loss: 17.359808| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 98
Epoch 98/200 |loss: 17.807394| train set 1.400x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 99
Epoch 99/200 |loss: 17.176414| train set 1.400x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 100
Epoch 100/200 |loss: 17.377546| train set 1.398x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 101/200 |loss: 16.860092| train set 1.389x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 102/200 |loss: 16.922766| train set 1.374x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 103/200 |loss: 16.631985| train set 1.374x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 104/200 |loss: 16.557293| train set 1.400x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 105/200 |loss: 16.373587| train set 1.415x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 106/200 |loss: 16.190748| train set 1.431x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 107/200 |loss: 16.139063| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 108/200 |loss: 15.926298| train set 1.401x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 109/200 |loss: 15.939659| train set 1.502x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 110/200 |loss: 15.887652| train set 1.448x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 111/200 |loss: 15.936978| train set 1.420x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 112/200 |loss: 16.367226| train set 1.411x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 113/200 |loss: 16.371208| train set 1.520x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 114/200 |loss: 15.532816| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 115/200 |loss: 15.183545| train set 1.415x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 116/200 |loss: 15.201632| train set 1.520x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 117/200 |loss: 15.235986| train set 1.418x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 118/200 |loss: 15.179635| train set 1.415x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 119/200 |loss: 15.427390| train set 1.505x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 120/200 |loss: 15.076986| train set 1.410x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 121/200 |loss: 15.372520| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 122/200 |loss: 14.796326| train set 1.415x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 123/200 |loss: 14.436459| train set 1.502x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 124/200 |loss: 14.456655| train set 1.419x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 125/200 |loss: 14.642774| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 126/200 |loss: 15.384717| train set 1.392x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 127/200 |loss: 14.658698| train set 1.502x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 128/200 |loss: 14.340436| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 129/200 |loss: 14.288610| train set 1.477x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 130/200 |loss: 14.410697| train set 1.523x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 131/200 |loss: 15.262411| train set 1.461x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 132/200 |loss: 15.084278| train set 1.423x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 133/200 |loss: 14.563585| train set 1.520x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 134/200 |loss: 14.911495| train set 1.380x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 135/200 |loss: 15.079473| train set 1.502x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 136/200 |loss: 14.705168| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 137/200 |loss: 13.967147| train set 1.497x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 138/200 |loss: 14.434547| train set 1.539x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 139/200 |loss: 14.819463| train set 1.489x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 140/200 |loss: 13.577230| train set 1.436x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 141/200 |loss: 14.234509| train set 1.502x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 142/200 |loss: 15.734329| train set 1.428x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 143/200 |loss: 13.769217| train set 1.475x speedup, test set 4.652x speedup, val set 0.989x speedup, step: 2
Epoch 144/200 |loss: 15.952957| train set 1.499x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 145/200 |loss: 16.308672| train set 1.429x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 146/200 |loss: 14.470735| train set 1.393x speedup, test set 4.652x speedup, val set 0.988x speedup, step: 2
Epoch 147/200 |loss: 16.656069| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 148/200 |loss: 13.752947| train set 1.503x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 149/200 |loss: 15.047500| train set 1.507x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 150/200 |loss: 13.717362| train set 1.421x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 151/200 |loss: 14.276867| train set 1.427x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 152/200 |loss: 13.986988| train set 1.508x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 153/200 |loss: 13.713732| train set 1.475x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 154/200 |loss: 13.690116| train set 1.507x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 155/200 |loss: 13.300467| train set 1.537x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 156/200 |loss: 13.480560| train set 1.502x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 157/200 |loss: 13.002714| train set 1.505x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 158/200 |loss: 13.253223| train set 1.504x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 159/200 |loss: 13.132959| train set 1.537x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 160/200 |loss: 13.095015| train set 1.564x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 161/200 |loss: 13.108138| train set 1.507x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 162/200 |loss: 12.579943| train set 1.472x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 163/200 |loss: 12.806774| train set 1.493x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 164/200 |loss: 12.364656| train set 1.565x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 165/200 |loss: 12.416203| train set 1.520x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 166/200 |loss: 12.523384| train set 1.525x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 167/200 |loss: 12.395261| train set 1.538x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 168/200 |loss: 12.631633| train set 1.419x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 169/200 |loss: 13.602746| train set 1.497x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 2
Epoch 170/200 |loss: 14.498276| train set 1.407x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 171/200 |loss: 14.654441| train set 1.541x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 172/200 |loss: 13.084470| train set 1.548x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 173/200 |loss: 13.117276| train set 1.430x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 174/200 |loss: 14.876838| train set 1.502x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 175/200 |loss: 13.605576| train set 1.520x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 176/200 |loss: 14.098840| train set 1.434x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 177/200 |loss: 14.914491| train set 1.502x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 178/200 |loss: 12.738297| train set 1.496x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 179/200 |loss: 14.606771| train set 1.445x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 180/200 |loss: 12.904520| train set 1.440x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 2
Epoch 181/200 |loss: 13.581837| train set 1.541x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 182/200 |loss: 12.840208| train set 1.520x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 183/200 |loss: 12.865875| train set 1.442x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 184/200 |loss: 12.635653| train set 1.526x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 185/200 |loss: 12.360789| train set 1.559x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 186/200 |loss: 12.612971| train set 1.564x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 187/200 |loss: 12.077759| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 188/200 |loss: 12.620458| train set 1.496x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 189/200 |loss: 11.889838| train set 1.539x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 190/200 |loss: 12.268679| train set 1.520x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 191/200 |loss: 11.757451| train set 1.520x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 192/200 |loss: 11.825055| train set 1.561x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 193/200 |loss: 11.755648| train set 1.559x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 194/200 |loss: 11.537983| train set 1.492x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 195/200 |loss: 11.661428| train set 1.492x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 196/200 |loss: 11.427431| train set 1.520x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 197/200 |loss: 11.428897| train set 1.559x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 198/200 |loss: 11.415518| train set 1.564x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 199/200 |loss: 11.255468| train set 1.545x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Training per epoch cost 0.324 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 164, train speedup 1.565, test speedup 4.652, val speedup 0.998
best test speedup epoch: 19, train speedup 1.219, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 198, train speedup 1.564, test speedup 4.652, val speedup 0.998
last model at epoch 199, train speedup 1.545, test speedup 4.652, val speedup 0.997
execution cost 0:03:03.614699
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.176085, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786835| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091705| train set 1.161x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809982| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533426| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.277563| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.014877| train set 1.153x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.783501| train set 1.155x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.558807| train set 1.192x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.387245| train set 1.239x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.178684| train set 1.218x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.933020| train set 1.200x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.653812| train set 1.207x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.459944| train set 1.207x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.310417| train set 1.224x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.088484| train set 1.182x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.851830| train set 1.186x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.665821| train set 1.200x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.575951| train set 1.188x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.328503| train set 1.193x speedup, test set 8.197x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.122208| train set 1.178x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 25.127798| train set 1.170x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.997198| train set 1.179x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.593384| train set 1.179x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.323431| train set 1.169x speedup, test set 8.197x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.370047| train set 1.199x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.212856| train set 1.227x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 35
Epoch 35/200 |loss: 24.051407| train set 1.232x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.127472| train set 1.227x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.831978| train set 1.228x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.415487| train set 1.243x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.474356| train set 1.229x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.088747| train set 1.229x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.106537| train set 1.280x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.139765| train set 1.284x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.686394| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.844107| train set 1.251x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.357979| train set 1.272x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.034393| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.167555| train set 1.264x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 21.873827| train set 1.306x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 21.930285| train set 1.326x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 23.048817| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.689426| train set 1.380x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 52
Epoch 52/200 |loss: 21.509085| train set 1.326x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.388973| train set 1.306x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.066641| train set 1.345x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.154327| train set 1.312x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.126913| train set 1.328x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.472542| train set 1.319x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.723251| train set 1.325x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.374989| train set 1.392x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.208759| train set 1.391x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.203672| train set 1.250x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.278688| train set 1.392x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.261555| train set 1.375x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 21.441422| train set 1.286x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 23.064493| train set 1.270x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.582716| train set 1.292x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 22.777016| train set 1.377x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 20.815186| train set 1.342x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 21.764013| train set 1.319x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 20.151257| train set 1.374x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 20.579695| train set 1.388x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 20.409185| train set 1.397x speedup, test set 5.136x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.714514| train set 1.400x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.901516| train set 1.344x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.435127| train set 1.389x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.411806| train set 1.340x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.191584| train set 1.320x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.943893| train set 1.493x speedup, test set 5.871x speedup, val set 0.738x speedup, step: 79
Epoch 79/200 |loss: 18.841234| train set 1.394x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.660339| train set 1.399x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.567308| train set 1.390x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.159527| train set 1.420x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.256330| train set 1.470x speedup, test set 5.688x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.091257| train set 1.342x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.155888| train set 1.396x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.039988| train set 1.398x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.106623| train set 1.367x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.876633| train set 1.399x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 17.524658| train set 1.423x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.393692| train set 1.394x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.223715| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.601162| train set 1.455x speedup, test set 5.702x speedup, val set 0.738x speedup, step: 93
Epoch 93/200 |loss: 17.338837| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.014908| train set 1.374x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 16.886518| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.407583| train set 1.487x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 20.238232| train set 1.262x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 19.337738| train set 1.363x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.585903| train set 1.458x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 100
Epoch 100/200 |loss: 20.701460| train set 1.368x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.098307| train set 1.365x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 20.032690| train set 1.373x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.821924| train set 1.543x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 18.678406| train set 1.420x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.686115| train set 1.339x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 17.616684| train set 1.342x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.918022| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.761400| train set 1.490x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 109/200 |loss: 16.880589| train set 1.478x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 110/200 |loss: 16.114262| train set 1.395x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 111/200 |loss: 16.524141| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 112/200 |loss: 15.803869| train set 1.495x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 113/200 |loss: 16.154531| train set 1.447x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 114/200 |loss: 15.742932| train set 1.388x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 115/200 |loss: 15.750501| train set 1.420x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 116/200 |loss: 15.492383| train set 1.502x speedup, test set 4.759x speedup, val set 0.997x speedup, step: 9
Epoch 117/200 |loss: 15.597065| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 118/200 |loss: 15.074134| train set 1.397x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 119/200 |loss: 15.161618| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 120/200 |loss: 15.024825| train set 1.503x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 121/200 |loss: 14.920614| train set 1.449x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 14
Epoch 122/200 |loss: 14.715605| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 123/200 |loss: 14.664627| train set 1.451x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 124/200 |loss: 15.044724| train set 1.433x speedup, test set 5.702x speedup, val set 0.738x speedup, step: 17
Epoch 125/200 |loss: 16.672665| train set 1.287x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 126/200 |loss: 18.487497| train set 1.373x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 127/200 |loss: 16.468512| train set 1.431x speedup, test set 4.775x speedup, val set 0.737x speedup, step: 3
Epoch 128/200 |loss: 15.857308| train set 1.424x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 129/200 |loss: 17.685560| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 130/200 |loss: 16.112629| train set 1.427x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 6
Epoch 131/200 |loss: 16.949800| train set 1.350x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 132/200 |loss: 15.530935| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 133/200 |loss: 16.229530| train set 1.470x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 134/200 |loss: 15.026477| train set 1.512x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 135/200 |loss: 15.593784| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 136/200 |loss: 14.713872| train set 1.535x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 137/200 |loss: 14.946087| train set 1.505x speedup, test set 4.801x speedup, val set 0.997x speedup, step: 13
Epoch 138/200 |loss: 14.625844| train set 1.494x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 139/200 |loss: 14.428453| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 140/200 |loss: 14.353532| train set 1.446x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 141/200 |loss: 14.186420| train set 1.475x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 142/200 |loss: 14.071438| train set 1.410x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 143/200 |loss: 14.048242| train set 1.448x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 144/200 |loss: 13.540753| train set 1.477x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 145/200 |loss: 13.924288| train set 1.504x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 146/200 |loss: 13.383759| train set 1.431x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 147/200 |loss: 13.837362| train set 1.529x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 148/200 |loss: 13.336958| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 149/200 |loss: 13.476761| train set 1.540x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 25
Epoch 150/200 |loss: 13.199661| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 26
Epoch 151/200 |loss: 13.296900| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 152/200 |loss: 13.041750| train set 1.551x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 153/200 |loss: 13.172098| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 29
Epoch 154/200 |loss: 13.252366| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 30
Epoch 155/200 |loss: 13.736758| train set 1.494x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 31
Epoch 156/200 |loss: 13.540449| train set 1.507x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 32
Epoch 157/200 |loss: 13.810579| train set 1.494x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 33
Epoch 158/200 |loss: 12.815346| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 34
Epoch 159/200 |loss: 12.864589| train set 1.514x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 35
Epoch 160/200 |loss: 13.666580| train set 1.431x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 36
Epoch 161/200 |loss: 13.243089| train set 1.561x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 37
Epoch 162/200 |loss: 12.494300| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 38
Epoch 163/200 |loss: 12.790597| train set 1.531x speedup, test set 4.686x speedup, val set 0.997x speedup, step: 39
Epoch 164/200 |loss: 13.213154| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 40
Epoch 165/200 |loss: 13.149017| train set 1.556x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 41
Epoch 166/200 |loss: 12.365595| train set 1.563x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 42
Epoch 167/200 |loss: 12.602747| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 43
Epoch 168/200 |loss: 13.411954| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 44
Epoch 169/200 |loss: 12.539644| train set 1.510x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 45
Epoch 170/200 |loss: 12.403157| train set 1.559x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 46
Epoch 171/200 |loss: 13.669919| train set 1.519x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 47
Epoch 172/200 |loss: 12.597324| train set 1.561x speedup, test set 4.751x speedup, val set 0.997x speedup, step: 48
Epoch 173/200 |loss: 12.466207| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 49
Epoch 174/200 |loss: 12.690796| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 50
Epoch 175/200 |loss: 12.599786| train set 1.512x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 51
Epoch 176/200 |loss: 12.122962| train set 1.533x speedup, test set 4.686x speedup, val set 0.997x speedup, step: 52
Epoch 177/200 |loss: 11.940481| train set 1.564x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 53
Epoch 178/200 |loss: 12.082257| train set 1.556x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 54
Epoch 179/200 |loss: 12.345702| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 55
Epoch 180/200 |loss: 12.133840| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 56
Epoch 181/200 |loss: 12.454908| train set 1.507x speedup, test set 4.801x speedup, val set 0.994x speedup, step: 57
Epoch 182/200 |loss: 12.409640| train set 1.538x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 183/200 |loss: 13.067383| train set 1.487x speedup, test set 4.801x speedup, val set 0.994x speedup, step: 2
Epoch 184/200 |loss: 13.080877| train set 1.491x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 185/200 |loss: 12.251131| train set 1.556x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 186/200 |loss: 12.311844| train set 1.507x speedup, test set 4.801x speedup, val set 0.994x speedup, step: 5
Epoch 187/200 |loss: 12.982232| train set 1.538x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 188/200 |loss: 12.824678| train set 1.542x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 189/200 |loss: 11.955375| train set 1.449x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 8
Epoch 190/200 |loss: 12.506245| train set 1.513x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 191/200 |loss: 11.972272| train set 1.559x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 192/200 |loss: 11.835428| train set 1.526x speedup, test set 4.801x speedup, val set 0.997x speedup, step: 11
Epoch 193/200 |loss: 12.128297| train set 1.538x speedup, test set 4.801x speedup, val set 0.997x speedup, step: 12
Epoch 194/200 |loss: 12.333614| train set 1.513x speedup, test set 4.801x speedup, val set 0.997x speedup, step: 13
Epoch 195/200 |loss: 12.561954| train set 1.520x speedup, test set 4.801x speedup, val set 0.997x speedup, step: 14
Epoch 196/200 |loss: 12.132921| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 197/200 |loss: 12.416876| train set 1.525x speedup, test set 4.801x speedup, val set 0.994x speedup, step: 16
Epoch 198/200 |loss: 11.697623| train set 1.536x speedup, test set 4.801x speedup, val set 0.997x speedup, step: 17
Epoch 199/200 |loss: 11.549173| train set 1.501x speedup, test set 4.801x speedup, val set 0.997x speedup, step: 18
Training per epoch cost 0.340 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 177, train speedup 1.564, test speedup 4.775, val speedup 0.997
best test speedup epoch: 16, train speedup 1.192, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 182, train speedup 1.538, test speedup 4.775, val speedup 1.008
last model at epoch 199, train speedup 1.501, test speedup 4.801, val speedup 0.997
execution cost 0:03:04.189173
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.150510, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.696198| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379522| train set 1.119x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.084578| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.802246| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.531517| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.294088| train set 1.152x speedup, test set 6.345x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.024113| train set 1.138x speedup, test set 7.264x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.763283| train set 1.192x speedup, test set 5.072x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.512848| train set 1.213x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.278030| train set 1.214x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.046959| train set 1.200x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.820759| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.672306| train set 1.207x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.886061| train set 1.216x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 22
Epoch 22/200 |loss: 26.856062| train set 1.224x speedup, test set 6.106x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.106045| train set 1.212x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 26.537500| train set 1.201x speedup, test set 5.871x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.698549| train set 1.177x speedup, test set 8.197x speedup, val set 0.932x speedup, step: 26
Epoch 26/200 |loss: 26.018154| train set 1.225x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.347145| train set 1.215x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.623672| train set 1.219x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.071825| train set 1.202x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 25.155224| train set 1.228x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.737173| train set 1.230x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.715158| train set 1.221x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.484301| train set 1.228x speedup, test set 4.764x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.298803| train set 1.231x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 24.182590| train set 1.223x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.911201| train set 1.223x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.780256| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.624376| train set 1.244x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.635696| train set 1.226x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 40
Epoch 40/200 |loss: 23.856794| train set 1.297x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.322102| train set 1.303x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.093138| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 22.902168| train set 1.262x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.933872| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.451309| train set 1.305x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.513611| train set 1.301x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.406492| train set 1.319x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.195166| train set 1.311x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 21.809998| train set 1.324x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 21.883121| train set 1.305x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.869677| train set 1.316x speedup, test set 4.641x speedup, val set 0.931x speedup, step: 52
Epoch 52/200 |loss: 21.703766| train set 1.237x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 22.284529| train set 1.321x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 22.873266| train set 1.322x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.771921| train set 1.326x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.989037| train set 1.392x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 57
Epoch 57/200 |loss: 21.845613| train set 1.362x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 21.341063| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 21.463614| train set 1.343x speedup, test set 5.448x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 21.398769| train set 1.397x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.563442| train set 1.327x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 21.113592| train set 1.313x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.442789| train set 1.345x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.490021| train set 1.308x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.360691| train set 1.392x speedup, test set 4.641x speedup, val set 0.739x speedup, step: 66
Epoch 66/200 |loss: 20.179220| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 20.316568| train set 1.336x speedup, test set 4.712x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.826542| train set 1.336x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.627163| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.608425| train set 1.358x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 19.371708| train set 1.329x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.287354| train set 1.399x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.013723| train set 1.398x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.122093| train set 1.398x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 18.610943| train set 1.398x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 18.755758| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.999016| train set 1.469x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 78
Epoch 78/200 |loss: 18.601318| train set 1.341x speedup, test set 4.642x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 18.678638| train set 1.399x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.576519| train set 1.400x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 17.947208| train set 1.400x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 17.754082| train set 1.400x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 17.651472| train set 1.394x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 17.458412| train set 1.431x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.452597| train set 1.315x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.232063| train set 1.420x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 87
Epoch 87/200 |loss: 19.256870| train set 1.326x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 19.561520| train set 1.395x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 17.830179| train set 1.472x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 90
Epoch 90/200 |loss: 19.319054| train set 1.297x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 20.212076| train set 1.370x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 17.991774| train set 1.390x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 93
Epoch 93/200 |loss: 18.975597| train set 1.417x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.626534| train set 1.314x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.883301| train set 1.414x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.172319| train set 1.405x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 97
Epoch 97/200 |loss: 17.603775| train set 1.397x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.848526| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.350126| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.363930| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.006172| train set 1.374x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.482079| train set 1.402x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.957790| train set 1.393x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.649464| train set 1.414x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 17.251287| train set 1.369x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.293087| train set 1.373x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 15.830312| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.293707| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 16.122126| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 16.321997| train set 1.438x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 2
Epoch 111/200 |loss: 15.524371| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.341874| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.408207| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.363254| train set 1.510x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 15.243651| train set 1.495x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 14.786751| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 14.652225| train set 1.428x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 14.485067| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 14.550278| train set 1.449x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 14.657512| train set 1.506x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 14.856328| train set 1.429x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 15.968797| train set 1.360x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 17.035835| train set 1.513x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 19.081863| train set 1.423x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 125/200 |loss: 16.776911| train set 1.406x speedup, test set 4.652x speedup, val set 0.988x speedup, step: 2
Epoch 126/200 |loss: 20.982866| train set 1.463x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 127/200 |loss: 17.076855| train set 1.409x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 128/200 |loss: 18.240334| train set 1.393x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 129/200 |loss: 15.876095| train set 1.354x speedup, test set 4.652x speedup, val set 0.993x speedup, step: 6
Epoch 130/200 |loss: 17.395279| train set 1.509x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 131/200 |loss: 15.660962| train set 1.449x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 132/200 |loss: 16.521881| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 133/200 |loss: 15.589943| train set 1.505x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 134/200 |loss: 15.903217| train set 1.451x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 135/200 |loss: 15.101681| train set 1.426x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 136/200 |loss: 15.370943| train set 1.390x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 137/200 |loss: 14.834651| train set 1.477x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 138/200 |loss: 14.841510| train set 1.426x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 139/200 |loss: 14.555444| train set 1.398x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 140/200 |loss: 14.376893| train set 1.499x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 141/200 |loss: 14.357802| train set 1.457x speedup, test set 4.739x speedup, val set 0.997x speedup, step: 18
Epoch 142/200 |loss: 14.137050| train set 1.458x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 143/200 |loss: 13.982929| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 144/200 |loss: 13.844937| train set 1.544x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 145/200 |loss: 13.643422| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 146/200 |loss: 13.634299| train set 1.421x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 147/200 |loss: 13.531457| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 148/200 |loss: 13.313249| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 25
Epoch 149/200 |loss: 13.286016| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 26
Epoch 150/200 |loss: 13.108677| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 151/200 |loss: 13.091565| train set 1.561x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 152/200 |loss: 13.030403| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 29
Epoch 153/200 |loss: 13.090623| train set 1.564x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 30
Epoch 154/200 |loss: 13.322124| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 31
Epoch 155/200 |loss: 14.262804| train set 1.461x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 156/200 |loss: 14.137663| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 157/200 |loss: 13.520329| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 158/200 |loss: 12.945458| train set 1.440x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 159/200 |loss: 13.080904| train set 1.496x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 160/200 |loss: 13.389397| train set 1.561x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 161/200 |loss: 12.717594| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 162/200 |loss: 12.673034| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 163/200 |loss: 12.764196| train set 1.469x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 164/200 |loss: 12.509162| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 165/200 |loss: 12.343790| train set 1.564x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 166/200 |loss: 12.595137| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 167/200 |loss: 12.730932| train set 1.536x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 168/200 |loss: 12.496638| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 169/200 |loss: 12.928280| train set 1.499x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 170/200 |loss: 12.919530| train set 1.559x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 171/200 |loss: 12.417736| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 172/200 |loss: 12.238269| train set 1.545x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 173/200 |loss: 12.142712| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 174/200 |loss: 11.813256| train set 1.562x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 175/200 |loss: 12.041805| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 176/200 |loss: 12.627901| train set 1.560x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 177/200 |loss: 12.564886| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 178/200 |loss: 12.827335| train set 1.509x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 179/200 |loss: 12.509109| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 180/200 |loss: 11.667640| train set 1.512x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 181/200 |loss: 12.215688| train set 1.458x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 182/200 |loss: 12.706069| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 183/200 |loss: 11.851382| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 184/200 |loss: 11.819220| train set 1.553x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 185/200 |loss: 12.139290| train set 1.563x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 186/200 |loss: 11.794145| train set 1.564x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 187/200 |loss: 12.064159| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 188/200 |loss: 11.732579| train set 1.561x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 189/200 |loss: 11.798419| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 190/200 |loss: 12.033395| train set 1.559x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 191/200 |loss: 11.833368| train set 1.497x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 192/200 |loss: 12.872982| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 193/200 |loss: 16.113295| train set 1.550x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 194/200 |loss: 11.804754| train set 1.527x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 195/200 |loss: 14.334702| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 196/200 |loss: 16.869799| train set 1.403x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 197/200 |loss: 14.440492| train set 1.495x speedup, test set 4.652x speedup, val set 0.991x speedup, step: 4
Epoch 198/200 |loss: 15.379491| train set 1.498x speedup, test set 4.652x speedup, val set 0.736x speedup, step: 5
Epoch 199/200 |loss: 14.196054| train set 1.504x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Training per epoch cost 0.341 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 186, train speedup 1.564, test speedup 4.652, val speedup 0.997
best test speedup epoch: 19, train speedup 1.216, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 194, train speedup 1.527, test speedup 4.652, val speedup 1.008
last model at epoch 199, train speedup 1.504, test speedup 4.652, val speedup 0.997
execution cost 0:03:05.403816
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.167897, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.696209| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379444| train set 1.115x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.084700| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.802778| train set 1.147x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.531956| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.291592| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.024254| train set 1.154x speedup, test set 6.106x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.766562| train set 1.192x speedup, test set 6.921x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.511343| train set 1.211x speedup, test set 6.410x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.279575| train set 1.231x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.048119| train set 1.238x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.842897| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.813162| train set 1.207x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.948551| train set 1.204x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.471081| train set 1.204x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 23
Epoch 23/200 |loss: 26.220898| train set 1.211x speedup, test set 6.345x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 26.201668| train set 1.223x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 25
Epoch 25/200 |loss: 25.666317| train set 1.179x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 26
Epoch 26/200 |loss: 25.800894| train set 1.202x speedup, test set 6.106x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.334276| train set 1.215x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.411367| train set 1.178x speedup, test set 8.197x speedup, val set 0.932x speedup, step: 29
Epoch 29/200 |loss: 25.077038| train set 1.203x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.909582| train set 1.228x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.845119| train set 1.223x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.451260| train set 1.221x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.401688| train set 1.229x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.189520| train set 1.229x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 23.968620| train set 1.207x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.883966| train set 1.229x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 37
Epoch 37/200 |loss: 24.068701| train set 1.244x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.742588| train set 1.227x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.291971| train set 1.229x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.235298| train set 1.257x speedup, test set 6.129x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.175926| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.809738| train set 1.231x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.475176| train set 1.279x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.583738| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.585497| train set 1.318x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.456375| train set 1.266x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.400812| train set 1.237x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.366953| train set 1.311x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 49
Epoch 49/200 |loss: 22.095726| train set 1.307x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 50
Epoch 50/200 |loss: 22.137205| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.480602| train set 1.301x speedup, test set 5.448x speedup, val set 0.930x speedup, step: 52
Epoch 52/200 |loss: 21.749035| train set 1.311x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.634136| train set 1.323x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 21.276621| train set 1.327x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 21.369980| train set 1.301x speedup, test set 4.641x speedup, val set 0.931x speedup, step: 56
Epoch 56/200 |loss: 21.172363| train set 1.338x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.144806| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 20.589312| train set 1.327x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 20.459650| train set 1.357x speedup, test set 4.641x speedup, val set 0.701x speedup, step: 60
Epoch 60/200 |loss: 20.269108| train set 1.343x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.126781| train set 1.331x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 19.944977| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 19.900232| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 19.966604| train set 1.320x speedup, test set 5.702x speedup, val set 0.701x speedup, step: 65
Epoch 65/200 |loss: 21.876797| train set 1.252x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 21.784521| train set 1.322x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.214470| train set 1.394x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 20.142813| train set 1.392x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 20.153261| train set 1.395x speedup, test set 4.641x speedup, val set 0.739x speedup, step: 70
Epoch 70/200 |loss: 19.711863| train set 1.327x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 20.297812| train set 1.314x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.204897| train set 1.333x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 19.872473| train set 1.329x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.764452| train set 1.364x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 19.174843| train set 1.322x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 19.523256| train set 1.332x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.786980| train set 1.322x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 78
Epoch 78/200 |loss: 19.062643| train set 1.323x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 18.929068| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 17.983915| train set 1.409x speedup, test set 4.642x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 18.690733| train set 1.345x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 17.993507| train set 1.370x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.026217| train set 1.488x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 84
Epoch 84/200 |loss: 18.264118| train set 1.341x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 17.723728| train set 1.384x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 18.034706| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.507849| train set 1.397x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.091324| train set 1.324x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 18.193396| train set 1.325x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 18.808941| train set 1.425x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.775442| train set 1.321x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 19.022091| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.546291| train set 1.511x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 94
Epoch 94/200 |loss: 18.099724| train set 1.341x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 17.710682| train set 1.341x speedup, test set 4.642x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 17.170908| train set 1.455x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 97
Epoch 97/200 |loss: 17.677998| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.756481| train set 1.314x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 99
Epoch 99/200 |loss: 17.252943| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.258718| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.750463| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.095636| train set 1.401x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.214602| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 15.953573| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 15.801974| train set 1.419x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 15.992045| train set 1.389x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 15.619165| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.403910| train set 1.448x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.482456| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.292626| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 14.988935| train set 1.384x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.115558| train set 1.471x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.202268| train set 1.408x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 114/200 |loss: 15.752025| train set 1.455x speedup, test set 4.652x speedup, val set 0.996x speedup, step: 2
Epoch 115/200 |loss: 17.536726| train set 1.428x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 116/200 |loss: 18.722126| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 117/200 |loss: 16.068106| train set 1.414x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 3
Epoch 118/200 |loss: 17.362637| train set 1.343x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 119/200 |loss: 16.813448| train set 1.422x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 120/200 |loss: 15.336086| train set 1.472x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 6
Epoch 121/200 |loss: 16.861361| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 122/200 |loss: 15.021384| train set 1.403x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 123/200 |loss: 15.805760| train set 1.437x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 9
Epoch 124/200 |loss: 15.006454| train set 1.491x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 125/200 |loss: 15.224573| train set 1.428x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 126/200 |loss: 15.282156| train set 1.433x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 127/200 |loss: 14.736310| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 128/200 |loss: 15.021506| train set 1.422x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 129/200 |loss: 14.454918| train set 1.429x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 130/200 |loss: 14.558591| train set 1.476x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 131/200 |loss: 14.281008| train set 1.476x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 132/200 |loss: 14.003582| train set 1.456x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 133/200 |loss: 14.131783| train set 1.431x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 134/200 |loss: 13.808322| train set 1.437x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 135/200 |loss: 13.731392| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 136/200 |loss: 13.666722| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 137/200 |loss: 13.463194| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 138/200 |loss: 13.578867| train set 1.435x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 139/200 |loss: 13.758243| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 25
Epoch 140/200 |loss: 14.285206| train set 1.356x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 26
Epoch 141/200 |loss: 16.458406| train set 1.512x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 142/200 |loss: 20.197411| train set 1.411x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 143/200 |loss: 15.900492| train set 1.351x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 29
Epoch 144/200 |loss: 20.146946| train set 1.454x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 30
Epoch 145/200 |loss: 16.135920| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 31
Epoch 146/200 |loss: 16.592520| train set 1.389x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 32
Epoch 147/200 |loss: 16.010113| train set 1.387x speedup, test set 4.642x speedup, val set 0.997x speedup, step: 33
Epoch 148/200 |loss: 15.894792| train set 1.475x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 149/200 |loss: 15.974093| train set 1.464x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 150/200 |loss: 14.933304| train set 1.378x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 151/200 |loss: 15.376485| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 152/200 |loss: 14.784797| train set 1.531x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 153/200 |loss: 14.852788| train set 1.496x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 154/200 |loss: 14.227067| train set 1.421x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 155/200 |loss: 14.399795| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 156/200 |loss: 13.783846| train set 1.506x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 157/200 |loss: 14.024655| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 158/200 |loss: 13.574292| train set 1.437x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 159/200 |loss: 13.771554| train set 1.472x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 160/200 |loss: 13.269204| train set 1.545x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 161/200 |loss: 13.409341| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 162/200 |loss: 13.039630| train set 1.485x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 163/200 |loss: 13.070337| train set 1.490x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 164/200 |loss: 12.882812| train set 1.545x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 165/200 |loss: 12.800230| train set 1.506x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 166/200 |loss: 12.722590| train set 1.470x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 167/200 |loss: 12.645040| train set 1.526x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 168/200 |loss: 12.559836| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 169/200 |loss: 12.499944| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 170/200 |loss: 12.394249| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 171/200 |loss: 12.253959| train set 1.561x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 172/200 |loss: 12.289259| train set 1.487x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 173/200 |loss: 12.418231| train set 1.525x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 174/200 |loss: 12.552047| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 175/200 |loss: 13.160050| train set 1.499x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 176/200 |loss: 13.727447| train set 1.508x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 177/200 |loss: 12.510413| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 178/200 |loss: 12.289079| train set 1.557x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 179/200 |loss: 12.900287| train set 1.502x speedup, test set 4.775x speedup, val set 0.996x speedup, step: 5
Epoch 180/200 |loss: 12.248290| train set 1.513x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 181/200 |loss: 12.171860| train set 1.536x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 182/200 |loss: 12.515185| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 183/200 |loss: 11.950299| train set 1.555x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 184/200 |loss: 12.097831| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 185/200 |loss: 12.761411| train set 1.525x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 186/200 |loss: 11.928775| train set 1.513x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 187/200 |loss: 12.073148| train set 1.534x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 188/200 |loss: 12.296880| train set 1.560x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 189/200 |loss: 11.622401| train set 1.524x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 190/200 |loss: 11.711388| train set 1.559x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 191/200 |loss: 12.010279| train set 1.564x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 192/200 |loss: 11.429419| train set 1.520x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 193/200 |loss: 11.537414| train set 1.515x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 194/200 |loss: 11.926269| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 20
Epoch 195/200 |loss: 11.489851| train set 1.520x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 196/200 |loss: 11.708223| train set 1.563x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 197/200 |loss: 12.371113| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 198/200 |loss: 12.705659| train set 1.544x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 199/200 |loss: 13.654875| train set 1.477x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Training per epoch cost 0.337 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 191, train speedup 1.564, test speedup 4.652, val speedup 0.997
best test speedup epoch: 19, train speedup 1.216, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 198, train speedup 1.544, test speedup 4.775, val speedup 1.008
last model at epoch 199, train speedup 1.477, test speedup 4.652, val speedup 0.997
execution cost 0:03:03.868981
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.267393, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083914| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091707| train set 1.161x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809984| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533445| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.277777| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.015928| train set 1.153x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.783073| train set 1.155x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.556530| train set 1.173x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.383284| train set 1.207x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.180256| train set 1.218x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.936466| train set 1.188x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.653389| train set 1.226x speedup, test set 9.295x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.464275| train set 1.207x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.332514| train set 1.205x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.092634| train set 1.182x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.823990| train set 1.187x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.664829| train set 1.201x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.638746| train set 1.188x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.401001| train set 1.206x speedup, test set 6.129x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.096901| train set 1.178x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 25.040369| train set 1.168x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 25.012003| train set 1.198x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.588503| train set 1.197x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.336676| train set 1.161x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.363451| train set 1.227x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.029776| train set 1.227x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 23.732906| train set 1.242x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.777180| train set 1.227x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.612776| train set 1.273x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.165688| train set 1.275x speedup, test set 8.197x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.066576| train set 1.227x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.205378| train set 1.222x speedup, test set 8.197x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.402407| train set 1.225x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 25.049002| train set 1.199x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 43
Epoch 43/200 |loss: 24.892757| train set 1.229x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 44
Epoch 44/200 |loss: 23.412851| train set 1.283x speedup, test set 6.982x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 23.962133| train set 1.310x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 23.157719| train set 1.304x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 23.385504| train set 1.232x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.772346| train set 1.281x speedup, test set 4.917x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.653458| train set 1.312x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.527397| train set 1.302x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 22.267797| train set 1.303x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 22.117294| train set 1.295x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.874266| train set 1.280x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.678083| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.682261| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.346277| train set 1.308x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.224142| train set 1.315x speedup, test set 4.836x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 20.971947| train set 1.339x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.892351| train set 1.319x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.622305| train set 1.336x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.545576| train set 1.341x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.285181| train set 1.343x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.140245| train set 1.337x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.029167| train set 1.328x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 19.916927| train set 1.344x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.185148| train set 1.347x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 22.190575| train set 1.303x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 24.116550| train set 1.325x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 20.559589| train set 1.336x speedup, test set 4.665x speedup, val set 0.992x speedup, step: 70
Epoch 70/200 |loss: 23.865963| train set 1.402x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 20.125608| train set 1.317x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 21.981123| train set 1.298x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 20.459976| train set 1.305x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 20.445328| train set 1.382x speedup, test set 4.764x speedup, val set 0.738x speedup, step: 75
Epoch 75/200 |loss: 20.653957| train set 1.399x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.579227| train set 1.301x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 20.340916| train set 1.345x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 19.320206| train set 1.377x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 19.661757| train set 1.373x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 19.168299| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 19.177782| train set 1.375x speedup, test set 4.642x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 18.934088| train set 1.399x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 18.753359| train set 1.380x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.517063| train set 1.394x speedup, test set 4.675x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.510015| train set 1.394x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.207914| train set 1.399x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.136101| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.868866| train set 1.394x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 17.820873| train set 1.368x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.525990| train set 1.449x speedup, test set 5.888x speedup, val set 0.739x speedup, step: 91
Epoch 91/200 |loss: 17.549986| train set 1.413x speedup, test set 5.888x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 17.240122| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.110725| train set 1.495x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.070833| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 16.747639| train set 1.400x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 16.777805| train set 1.494x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.928246| train set 1.317x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 18.181412| train set 1.464x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 19.374716| train set 1.338x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 19.597874| train set 1.373x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 19.889702| train set 1.399x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 102/200 |loss: 19.425892| train set 1.449x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 2
Epoch 103/200 |loss: 19.674572| train set 1.361x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 104/200 |loss: 18.029951| train set 1.368x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 105/200 |loss: 18.631641| train set 1.482x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 5
Epoch 106/200 |loss: 17.296818| train set 1.441x speedup, test set 5.888x speedup, val set 0.994x speedup, step: 6
Epoch 107/200 |loss: 18.125658| train set 1.414x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 108/200 |loss: 17.050177| train set 1.345x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 109/200 |loss: 17.437016| train set 1.398x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 110/200 |loss: 16.834566| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 111/200 |loss: 16.773241| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 112/200 |loss: 16.714266| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 113/200 |loss: 16.278099| train set 1.445x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 114/200 |loss: 16.202995| train set 1.499x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 115/200 |loss: 15.988790| train set 1.380x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 15
Epoch 116/200 |loss: 15.955021| train set 1.400x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 16
Epoch 117/200 |loss: 15.689784| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 118/200 |loss: 15.613234| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 119/200 |loss: 15.335746| train set 1.379x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 120/200 |loss: 15.406972| train set 1.491x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 20
Epoch 121/200 |loss: 15.155248| train set 1.529x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 122/200 |loss: 15.083626| train set 1.491x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 22
Epoch 123/200 |loss: 15.117721| train set 1.418x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 23
Epoch 124/200 |loss: 15.235518| train set 1.500x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 24
Epoch 125/200 |loss: 15.667395| train set 1.425x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 25
Epoch 126/200 |loss: 16.048050| train set 1.477x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 26
Epoch 127/200 |loss: 16.061075| train set 1.380x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 27
Epoch 128/200 |loss: 14.761484| train set 1.531x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 28
Epoch 129/200 |loss: 14.513858| train set 1.479x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 29
Epoch 130/200 |loss: 15.455875| train set 1.422x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 30
Epoch 131/200 |loss: 15.497523| train set 1.405x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 31
Epoch 132/200 |loss: 14.307068| train set 1.532x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 32
Epoch 133/200 |loss: 14.827307| train set 1.437x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 33
Epoch 134/200 |loss: 15.234170| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 34
Epoch 135/200 |loss: 15.008161| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 35
Epoch 136/200 |loss: 13.955080| train set 1.430x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 36
Epoch 137/200 |loss: 15.382787| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 37
Epoch 138/200 |loss: 15.592344| train set 1.421x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 38
Epoch 139/200 |loss: 14.152432| train set 1.486x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 39
Epoch 140/200 |loss: 15.709514| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 40
Epoch 141/200 |loss: 15.429639| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 41
Epoch 142/200 |loss: 14.665407| train set 1.409x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 42
Epoch 143/200 |loss: 14.920776| train set 1.516x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 43
Epoch 144/200 |loss: 14.263859| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 44
Epoch 145/200 |loss: 14.362561| train set 1.395x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 45
Epoch 146/200 |loss: 14.367120| train set 1.512x speedup, test set 4.775x speedup, val set 0.996x speedup, step: 46
Epoch 147/200 |loss: 13.893583| train set 1.505x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 47
Epoch 148/200 |loss: 14.504222| train set 1.474x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 48
Epoch 149/200 |loss: 13.593812| train set 1.413x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 49
Epoch 150/200 |loss: 13.992932| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 50
Epoch 151/200 |loss: 13.504795| train set 1.441x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 51
Epoch 152/200 |loss: 13.562448| train set 1.487x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 52
Epoch 153/200 |loss: 13.818157| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 53
Epoch 154/200 |loss: 13.160445| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 54
Epoch 155/200 |loss: 13.256320| train set 1.541x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 55
Epoch 156/200 |loss: 13.069475| train set 1.541x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 56
Epoch 157/200 |loss: 13.043349| train set 1.531x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 57
Epoch 158/200 |loss: 13.288265| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 58
Epoch 159/200 |loss: 13.085376| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 59
Epoch 160/200 |loss: 12.894504| train set 1.481x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 60
Epoch 161/200 |loss: 12.897950| train set 1.514x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 61
Epoch 162/200 |loss: 12.831777| train set 1.492x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 62
Epoch 163/200 |loss: 12.650931| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 63
Epoch 164/200 |loss: 12.794591| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 64
Epoch 165/200 |loss: 12.599619| train set 1.556x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 65
Epoch 166/200 |loss: 12.638030| train set 1.512x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 66
Epoch 167/200 |loss: 12.723971| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 67
Epoch 168/200 |loss: 13.133944| train set 1.487x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 68
Epoch 169/200 |loss: 13.478719| train set 1.505x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 69
Epoch 170/200 |loss: 13.418088| train set 1.490x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 70
Epoch 171/200 |loss: 12.527177| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 71
Epoch 172/200 |loss: 12.718779| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 72
Epoch 173/200 |loss: 12.874076| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 73
Epoch 174/200 |loss: 12.971066| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 74
Epoch 175/200 |loss: 12.372299| train set 1.561x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 176/200 |loss: 12.401763| train set 1.529x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 177/200 |loss: 12.703493| train set 1.494x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 178/200 |loss: 12.685651| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 179/200 |loss: 12.230145| train set 1.477x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 180/200 |loss: 12.537909| train set 1.530x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 181/200 |loss: 13.191101| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 182/200 |loss: 12.958416| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 183/200 |loss: 13.354821| train set 1.436x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 184/200 |loss: 13.195659| train set 1.448x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 185/200 |loss: 12.359810| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 186/200 |loss: 12.075957| train set 1.463x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 187/200 |loss: 13.054481| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 188/200 |loss: 12.515007| train set 1.527x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 189/200 |loss: 12.051599| train set 1.560x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 190/200 |loss: 11.996636| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 16
Epoch 191/200 |loss: 12.053051| train set 1.477x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 192/200 |loss: 12.008936| train set 1.515x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 193/200 |loss: 12.090699| train set 1.545x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 194/200 |loss: 11.585212| train set 1.564x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 20
Epoch 195/200 |loss: 11.599677| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 196/200 |loss: 12.103732| train set 1.524x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 22
Epoch 197/200 |loss: 11.599781| train set 1.559x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 23
Epoch 198/200 |loss: 11.389441| train set 1.533x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 24
Epoch 199/200 |loss: 11.391205| train set 1.559x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 25
Training per epoch cost 0.342 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 194, train speedup 1.564, test speedup 4.775, val speedup 0.997
best test speedup epoch: 16, train speedup 1.173, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 175, train speedup 1.561, test speedup 4.775, val speedup 1.008
last model at epoch 199, train speedup 1.559, test speedup 4.775, val speedup 0.997
execution cost 0:03:07.209612
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.212980, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786835| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091707| train set 1.161x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809984| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533422| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.277561| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.014875| train set 1.153x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.783537| train set 1.155x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.558928| train set 1.192x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.386484| train set 1.239x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.179293| train set 1.218x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.934963| train set 1.200x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.655874| train set 1.226x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.462938| train set 1.205x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.315763| train set 1.224x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.095766| train set 1.182x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.862146| train set 1.186x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.674580| train set 1.201x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.559895| train set 1.188x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.345730| train set 1.193x speedup, test set 8.197x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.167805| train set 1.179x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 25.137888| train set 1.168x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.899157| train set 1.178x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.563745| train set 1.178x speedup, test set 8.197x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.429750| train set 1.168x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.493366| train set 1.173x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.334879| train set 1.198x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 23.799467| train set 1.207x speedup, test set 8.197x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.887665| train set 1.209x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.783951| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.321243| train set 1.246x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.388113| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.361866| train set 1.278x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 22.773153| train set 1.306x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 22.822695| train set 1.307x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 22.973547| train set 1.232x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.522949| train set 1.311x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.817528| train set 1.232x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 46
Epoch 46/200 |loss: 22.970865| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.156183| train set 1.339x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.378986| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.045609| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.093620| train set 1.355x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.918312| train set 1.322x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.265091| train set 1.318x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.391542| train set 1.337x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 54
Epoch 54/200 |loss: 20.885952| train set 1.345x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 55
Epoch 55/200 |loss: 21.022959| train set 1.238x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.150755| train set 1.321x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.815220| train set 1.346x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 21.054531| train set 1.376x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 21.079275| train set 1.289x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.960737| train set 1.407x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.435678| train set 1.392x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 19.850584| train set 1.330x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.049036| train set 1.408x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.203554| train set 1.330x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.004620| train set 1.345x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.235037| train set 1.331x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 20.004059| train set 1.345x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.560692| train set 1.394x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.099852| train set 1.395x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 19.291252| train set 1.345x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.188250| train set 1.340x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 18.804920| train set 1.367x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.122356| train set 1.339x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.291510| train set 1.368x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.496592| train set 1.390x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 18.709036| train set 1.412x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.747232| train set 1.374x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.278681| train set 1.394x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 17.903732| train set 1.400x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 17.987213| train set 1.397x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.119081| train set 1.470x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.762735| train set 1.383x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.516411| train set 1.350x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 19.570328| train set 1.367x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.990973| train set 1.368x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.898611| train set 1.426x speedup, test set 5.702x speedup, val set 0.738x speedup, step: 87
Epoch 87/200 |loss: 18.705307| train set 1.420x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.786238| train set 1.396x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.362734| train set 1.513x speedup, test set 4.848x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 19.198351| train set 1.420x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.221827| train set 1.377x speedup, test set 4.764x speedup, val set 0.994x speedup, step: 92
Epoch 92/200 |loss: 20.391943| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 18.558596| train set 1.394x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 19.669230| train set 1.379x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.606386| train set 1.367x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 18.989964| train set 1.412x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.396927| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 18.098408| train set 1.393x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.150290| train set 1.436x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 17.655128| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.782698| train set 1.388x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 17.056627| train set 1.373x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.607607| train set 1.411x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.614227| train set 1.381x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.369076| train set 1.446x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.213814| train set 1.491x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.064495| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.960722| train set 1.412x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.780793| train set 1.412x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.615232| train set 1.443x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.517316| train set 1.430x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.351306| train set 1.502x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.467182| train set 1.427x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.419622| train set 1.502x speedup, test set 5.888x speedup, val set 0.994x speedup, step: 2
Epoch 115/200 |loss: 15.512037| train set 1.412x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 116/200 |loss: 16.122906| train set 1.472x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 2
Epoch 117/200 |loss: 16.104771| train set 1.422x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 118/200 |loss: 16.022833| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 119/200 |loss: 15.210002| train set 1.484x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 120/200 |loss: 14.960255| train set 1.435x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 121/200 |loss: 15.712851| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 122/200 |loss: 15.014368| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 123/200 |loss: 14.598587| train set 1.514x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 124/200 |loss: 14.950650| train set 1.520x speedup, test set 5.281x speedup, val set 0.994x speedup, step: 10
Epoch 125/200 |loss: 14.892533| train set 1.508x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 126/200 |loss: 14.689254| train set 1.464x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 127/200 |loss: 14.480475| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 128/200 |loss: 14.743529| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 129/200 |loss: 14.646545| train set 1.465x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 130/200 |loss: 14.684017| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 16
Epoch 131/200 |loss: 13.956326| train set 1.426x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 132/200 |loss: 13.791643| train set 1.522x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 133/200 |loss: 14.267175| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 134/200 |loss: 13.791821| train set 1.472x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 20
Epoch 135/200 |loss: 13.728924| train set 1.516x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 136/200 |loss: 13.926367| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 22
Epoch 137/200 |loss: 14.021769| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 23
Epoch 138/200 |loss: 14.104126| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 24
Epoch 139/200 |loss: 15.106305| train set 1.484x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 25
Epoch 140/200 |loss: 16.275688| train set 1.395x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 26
Epoch 141/200 |loss: 16.703472| train set 1.520x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 27
Epoch 142/200 |loss: 14.256093| train set 1.387x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 28
Epoch 143/200 |loss: 18.523172| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 29
Epoch 144/200 |loss: 17.291269| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 30
Epoch 145/200 |loss: 17.466566| train set 1.370x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 31
Epoch 146/200 |loss: 15.787350| train set 1.459x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 32
Epoch 147/200 |loss: 16.628635| train set 1.418x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 33
Epoch 148/200 |loss: 16.097914| train set 1.404x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 34
Epoch 149/200 |loss: 15.528333| train set 1.385x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 35
Epoch 150/200 |loss: 15.501689| train set 1.443x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 36
Epoch 151/200 |loss: 14.770851| train set 1.416x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 152/200 |loss: 15.045460| train set 1.496x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 2
Epoch 153/200 |loss: 14.774461| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 154/200 |loss: 14.467945| train set 1.514x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 155/200 |loss: 14.234031| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 156/200 |loss: 14.235490| train set 1.541x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 157/200 |loss: 13.705508| train set 1.436x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 158/200 |loss: 13.880136| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 159/200 |loss: 13.546568| train set 1.508x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 160/200 |loss: 13.417002| train set 1.531x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 161/200 |loss: 13.366919| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 162/200 |loss: 13.124840| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 163/200 |loss: 13.096436| train set 1.533x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 164/200 |loss: 12.987277| train set 1.563x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 165/200 |loss: 12.864929| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 166/200 |loss: 12.735454| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 16
Epoch 167/200 |loss: 12.709791| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 168/200 |loss: 12.514123| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 169/200 |loss: 12.484897| train set 1.532x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 170/200 |loss: 12.392822| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 20
Epoch 171/200 |loss: 12.284067| train set 1.506x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 172/200 |loss: 12.227694| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 22
Epoch 173/200 |loss: 12.115469| train set 1.532x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 23
Epoch 174/200 |loss: 12.065533| train set 1.557x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 24
Epoch 175/200 |loss: 11.983851| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 25
Epoch 176/200 |loss: 12.058581| train set 1.532x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 177/200 |loss: 12.640161| train set 1.512x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 2
Epoch 178/200 |loss: 15.218181| train set 1.347x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 179/200 |loss: 16.323950| train set 1.471x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 180/200 |loss: 13.250119| train set 1.512x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 3
Epoch 181/200 |loss: 14.187126| train set 1.385x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 182/200 |loss: 14.406636| train set 1.420x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 183/200 |loss: 12.770860| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 184/200 |loss: 13.905183| train set 1.503x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 185/200 |loss: 12.572303| train set 1.438x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 186/200 |loss: 13.131701| train set 1.495x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 2
Epoch 187/200 |loss: 12.819804| train set 1.487x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 188/200 |loss: 12.267164| train set 1.486x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 189/200 |loss: 12.698689| train set 1.538x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 190/200 |loss: 11.982649| train set 1.512x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 191/200 |loss: 12.426454| train set 1.542x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 192/200 |loss: 11.918587| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 193/200 |loss: 11.977459| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 194/200 |loss: 11.941692| train set 1.557x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 195/200 |loss: 11.713932| train set 1.556x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 196/200 |loss: 11.930216| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 197/200 |loss: 12.171371| train set 1.513x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 198/200 |loss: 12.563462| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 199/200 |loss: 14.557926| train set 1.463x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Training per epoch cost 0.340 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 164, train speedup 1.563, test speedup 4.775, val speedup 0.997
best test speedup epoch: 16, train speedup 1.192, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 195, train speedup 1.556, test speedup 4.775, val speedup 1.008
last model at epoch 199, train speedup 1.463, test speedup 4.775, val speedup 0.997
execution cost 0:03:10.191792
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.133484, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091705| train set 1.161x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809984| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533407| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.277573| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.014862| train set 1.153x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.782682| train set 1.155x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.556450| train set 1.194x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.382877| train set 1.238x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.188150| train set 1.218x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.943972| train set 1.200x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.660343| train set 1.226x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.476084| train set 1.205x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.350599| train set 1.205x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.112921| train set 1.182x speedup, test set 6.921x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.854897| train set 1.186x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.675135| train set 1.201x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.570507| train set 1.200x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.344612| train set 1.167x speedup, test set 8.197x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.085842| train set 1.196x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 24.945925| train set 1.163x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.894272| train set 1.163x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.720499| train set 1.180x speedup, test set 8.636x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.292315| train set 1.170x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.322798| train set 1.198x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.441946| train set 1.227x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.151423| train set 1.243x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.361904| train set 1.199x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 37
Epoch 37/200 |loss: 24.174805| train set 1.201x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.529564| train set 1.257x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.965185| train set 1.224x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.228628| train set 1.231x speedup, test set 5.136x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.192122| train set 1.250x speedup, test set 6.129x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 23.036798| train set 1.232x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 22.781752| train set 1.305x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.687897| train set 1.266x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.364536| train set 1.297x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.361586| train set 1.242x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.347670| train set 1.232x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.095240| train set 1.302x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 49
Epoch 49/200 |loss: 22.357286| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.166769| train set 1.326x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.893471| train set 1.322x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.588722| train set 1.312x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.389048| train set 1.326x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 54
Epoch 54/200 |loss: 21.260130| train set 1.250x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.756136| train set 1.334x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 20.911507| train set 1.393x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.792105| train set 1.328x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.881393| train set 1.397x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.599468| train set 1.324x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.894972| train set 1.361x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.494095| train set 1.392x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 21.249878| train set 1.326x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 21.514990| train set 1.337x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 21.049456| train set 1.229x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.574358| train set 1.309x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.844782| train set 1.351x speedup, test set 5.685x speedup, val set 0.701x speedup, step: 67
Epoch 67/200 |loss: 20.851660| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.759781| train set 1.303x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 20.564743| train set 1.344x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 19.368704| train set 1.471x speedup, test set 5.685x speedup, val set 0.701x speedup, step: 71
Epoch 71/200 |loss: 19.941536| train set 1.359x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.423513| train set 1.304x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.333242| train set 1.398x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 18.943417| train set 1.400x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.054903| train set 1.398x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 18.571762| train set 1.393x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.621971| train set 1.392x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.376749| train set 1.398x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.119480| train set 1.400x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.137083| train set 1.399x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 17.955839| train set 1.373x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.291128| train set 1.460x speedup, test set 5.685x speedup, val set 0.738x speedup, step: 83
Epoch 83/200 |loss: 18.843620| train set 1.334x speedup, test set 2.172x speedup, val set 1.008x speedup, step: 84
Epoch 84/200 |loss: 20.327564| train set 1.479x speedup, test set 5.685x speedup, val set 0.738x speedup, step: 85
Epoch 85/200 |loss: 18.693188| train set 1.361x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.515112| train set 1.368x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 20.109415| train set 1.373x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.884420| train set 1.370x speedup, test set 4.933x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.822289| train set 1.399x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 18.494858| train set 1.383x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 18.111094| train set 1.475x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 18.183052| train set 1.471x speedup, test set 5.702x speedup, val set 0.738x speedup, step: 93
Epoch 93/200 |loss: 18.406399| train set 1.236x speedup, test set 2.172x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 18.938097| train set 1.338x speedup, test set 2.172x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.799486| train set 1.383x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 18.013580| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.718225| train set 1.396x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 17.094587| train set 1.384x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.252539| train set 1.369x speedup, test set 5.871x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.860653| train set 1.445x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.945787| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.510906| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.449318| train set 1.416x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.366116| train set 1.431x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.263542| train set 1.471x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 15.922639| train set 1.411x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.002510| train set 1.374x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.679541| train set 1.512x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.539425| train set 1.447x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.497204| train set 1.415x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.865295| train set 1.430x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 16.497272| train set 1.511x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 19.660250| train set 1.339x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 16.500437| train set 1.372x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 16.808504| train set 1.454x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 2
Epoch 116/200 |loss: 18.959953| train set 1.413x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 16.242788| train set 1.380x speedup, test set 4.676x speedup, val set 0.994x speedup, step: 2
Epoch 118/200 |loss: 19.369164| train set 1.398x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 16.893824| train set 1.477x speedup, test set 5.888x speedup, val set 0.738x speedup, step: 2
Epoch 120/200 |loss: 18.158831| train set 1.340x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 16.062859| train set 1.338x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 17.274942| train set 1.421x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 16.078371| train set 1.421x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 16.424212| train set 1.411x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 15.490737| train set 1.480x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 16.280861| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 15.210780| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 15.683540| train set 1.389x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 129/200 |loss: 14.915487| train set 1.422x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 15.297878| train set 1.392x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 14.624703| train set 1.388x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 14.957642| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 14.395345| train set 1.459x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 134/200 |loss: 14.624370| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 14.156878| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 14.243869| train set 1.532x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 137/200 |loss: 14.028957| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 138/200 |loss: 14.075823| train set 1.451x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 14.383634| train set 1.495x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 140/200 |loss: 14.560096| train set 1.432x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 141/200 |loss: 15.566042| train set 1.462x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 142/200 |loss: 14.599788| train set 1.388x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 143/200 |loss: 13.727030| train set 1.447x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 144/200 |loss: 14.258263| train set 1.461x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 145/200 |loss: 13.809382| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 146/200 |loss: 13.477487| train set 1.451x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 147/200 |loss: 13.653522| train set 1.505x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 148/200 |loss: 13.332531| train set 1.513x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 149/200 |loss: 13.385177| train set 1.540x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 150/200 |loss: 13.210135| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 151/200 |loss: 13.144917| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 152/200 |loss: 13.465708| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 153/200 |loss: 13.209552| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 154/200 |loss: 13.263803| train set 1.531x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 155/200 |loss: 14.376048| train set 1.511x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 156/200 |loss: 13.542385| train set 1.537x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 157/200 |loss: 13.411022| train set 1.470x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 158/200 |loss: 12.808904| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 159/200 |loss: 12.653347| train set 1.537x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 160/200 |loss: 13.090357| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 161/200 |loss: 13.314960| train set 1.517x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 162/200 |loss: 12.946793| train set 1.561x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 163/200 |loss: 12.470663| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 164/200 |loss: 12.750525| train set 1.448x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 165/200 |loss: 12.985469| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 166/200 |loss: 12.489840| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 167/200 |loss: 12.241063| train set 1.557x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 168/200 |loss: 12.534368| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 169/200 |loss: 12.409968| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 170/200 |loss: 12.196525| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 171/200 |loss: 12.466655| train set 1.408x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 172/200 |loss: 14.077708| train set 1.541x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 173/200 |loss: 15.402697| train set 1.424x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 174/200 |loss: 13.073252| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 175/200 |loss: 12.498645| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 176/200 |loss: 13.033417| train set 1.505x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 177/200 |loss: 12.545828| train set 1.487x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 178/200 |loss: 12.299279| train set 1.509x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 179/200 |loss: 12.442557| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 180/200 |loss: 12.588602| train set 1.541x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 181/200 |loss: 13.192428| train set 1.528x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 182/200 |loss: 12.196403| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 183/200 |loss: 12.649592| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 184/200 |loss: 13.874988| train set 1.545x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 185/200 |loss: 12.051801| train set 1.534x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 186/200 |loss: 13.788230| train set 1.514x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 187/200 |loss: 14.821423| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 188/200 |loss: 13.632401| train set 1.506x speedup, test set 4.775x speedup, val set 0.992x speedup, step: 11
Epoch 189/200 |loss: 14.273815| train set 1.544x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 190/200 |loss: 13.524714| train set 1.471x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 191/200 |loss: 13.654439| train set 1.436x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 192/200 |loss: 12.719485| train set 1.525x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 193/200 |loss: 13.206649| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 194/200 |loss: 13.006039| train set 1.559x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 195/200 |loss: 12.505469| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 196/200 |loss: 12.862242| train set 1.559x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 197/200 |loss: 12.112448| train set 1.475x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 198/200 |loss: 12.482184| train set 1.511x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 199/200 |loss: 11.845594| train set 1.531x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Training per epoch cost 0.333 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 162, train speedup 1.561, test speedup 4.775, val speedup 0.997
best test speedup epoch: 16, train speedup 1.194, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 198, train speedup 1.511, test speedup 4.775, val speedup 1.008
last model at epoch 199, train speedup 1.531, test speedup 4.775, val speedup 0.997
execution cost 0:03:02.944551
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.169309, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091705| train set 1.161x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809982| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533436| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.277740| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.015829| train set 1.153x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.785583| train set 1.212x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.561806| train set 1.173x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.387396| train set 1.238x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.175367| train set 1.219x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.921705| train set 1.206x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.652239| train set 1.226x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.458595| train set 1.207x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.310204| train set 1.224x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.096439| train set 1.183x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.848087| train set 1.193x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.628073| train set 1.201x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.565355| train set 1.183x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.485664| train set 1.196x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.234764| train set 1.180x speedup, test set 8.197x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 24.983965| train set 1.163x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 25.077171| train set 1.148x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.650236| train set 1.180x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.362392| train set 1.161x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.417076| train set 1.207x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.021936| train set 1.199x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 24.105822| train set 1.238x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.133743| train set 1.201x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 24.078756| train set 1.201x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 24.112358| train set 1.244x speedup, test set 6.129x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.269232| train set 1.237x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.841051| train set 1.311x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.466715| train set 1.229x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.901062| train set 1.225x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.299950| train set 1.283x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.526480| train set 1.318x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.779345| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.245409| train set 1.297x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.307795| train set 1.231x speedup, test set 4.747x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.164047| train set 1.319x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 21.723640| train set 1.285x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 50
Epoch 50/200 |loss: 21.776381| train set 1.304x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.519938| train set 1.321x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.389469| train set 1.321x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.460724| train set 1.280x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 54
Epoch 54/200 |loss: 21.608267| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.944365| train set 1.327x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.315388| train set 1.338x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.784159| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 21.435213| train set 1.380x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.820103| train set 1.322x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.531290| train set 1.317x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.476282| train set 1.349x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.319744| train set 1.397x speedup, test set 5.501x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.274910| train set 1.246x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.448317| train set 1.397x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 19.875992| train set 1.392x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 19.610331| train set 1.326x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 20.053263| train set 1.391x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 20.069042| train set 1.331x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.385283| train set 1.397x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 19.857309| train set 1.383x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.562336| train set 1.400x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 20.020969| train set 1.342x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.256907| train set 1.399x speedup, test set 5.162x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 18.887022| train set 1.399x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.602945| train set 1.304x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.625134| train set 1.393x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.380157| train set 1.443x speedup, test set 5.871x speedup, val set 0.738x speedup, step: 78
Epoch 78/200 |loss: 19.519491| train set 1.343x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.808363| train set 1.343x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 19.488768| train set 1.339x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 19.013557| train set 1.452x speedup, test set 4.764x speedup, val set 0.738x speedup, step: 82
Epoch 82/200 |loss: 18.419497| train set 1.426x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.736109| train set 1.368x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 17.905836| train set 1.399x speedup, test set 4.970x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 18.105822| train set 1.373x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.505337| train set 1.369x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.709349| train set 1.400x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.271761| train set 1.414x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 17.353584| train set 1.398x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 16.893984| train set 1.396x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.148165| train set 1.399x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 16.839069| train set 1.400x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.651220| train set 1.430x speedup, test set 5.871x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 20.674650| train set 1.315x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.501997| train set 1.334x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 19.426641| train set 1.507x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 20.759920| train set 1.373x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 18.531040| train set 1.343x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 20.102663| train set 1.495x speedup, test set 4.764x speedup, val set 0.738x speedup, step: 100
Epoch 100/200 |loss: 17.181087| train set 1.440x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 101/200 |loss: 18.899508| train set 1.398x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 102/200 |loss: 17.170584| train set 1.397x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 103/200 |loss: 18.282583| train set 1.401x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 4
Epoch 104/200 |loss: 16.866087| train set 1.430x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 5
Epoch 105/200 |loss: 17.476149| train set 1.388x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 106/200 |loss: 16.692337| train set 1.400x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 7
Epoch 107/200 |loss: 16.945286| train set 1.400x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 8
Epoch 108/200 |loss: 16.406513| train set 1.415x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 9
Epoch 109/200 |loss: 16.377522| train set 1.419x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 110/200 |loss: 16.284801| train set 1.412x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 11
Epoch 111/200 |loss: 15.977038| train set 1.502x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 12
Epoch 112/200 |loss: 16.043127| train set 1.443x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 113/200 |loss: 15.617932| train set 1.432x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 114/200 |loss: 15.749593| train set 1.385x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 115/200 |loss: 15.475875| train set 1.471x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 16
Epoch 116/200 |loss: 15.461955| train set 1.422x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 117/200 |loss: 15.438065| train set 1.520x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 118/200 |loss: 15.306474| train set 1.450x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 19
Epoch 119/200 |loss: 15.551408| train set 1.502x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 20
Epoch 120/200 |loss: 15.627992| train set 1.429x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 121/200 |loss: 16.097401| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 122/200 |loss: 15.542021| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 123/200 |loss: 15.028066| train set 1.422x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 124/200 |loss: 14.487538| train set 1.466x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 125/200 |loss: 14.597307| train set 1.451x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 126/200 |loss: 14.825404| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 127/200 |loss: 15.348369| train set 1.405x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 128/200 |loss: 15.092781| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 129/200 |loss: 14.313354| train set 1.505x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 130/200 |loss: 14.184467| train set 1.499x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 131/200 |loss: 14.126086| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 132/200 |loss: 14.375273| train set 1.452x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 133/200 |loss: 13.969415| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 134/200 |loss: 13.933007| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 135/200 |loss: 14.069812| train set 1.505x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 16
Epoch 136/200 |loss: 14.170198| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 137/200 |loss: 14.395913| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 138/200 |loss: 13.606318| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 139/200 |loss: 13.506878| train set 1.428x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 20
Epoch 140/200 |loss: 13.970700| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 141/200 |loss: 14.096285| train set 1.451x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 142/200 |loss: 14.310290| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 143/200 |loss: 14.505921| train set 1.512x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 144/200 |loss: 13.753258| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 145/200 |loss: 13.612280| train set 1.490x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 146/200 |loss: 13.450312| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 147/200 |loss: 13.784968| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 148/200 |loss: 13.872587| train set 1.561x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 149/200 |loss: 12.815207| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 150/200 |loss: 13.104801| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 151/200 |loss: 13.465003| train set 1.505x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 152/200 |loss: 13.071892| train set 1.509x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 153/200 |loss: 12.988021| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 154/200 |loss: 13.157039| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 155/200 |loss: 13.015669| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 156/200 |loss: 13.236690| train set 1.493x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 16
Epoch 157/200 |loss: 12.487042| train set 1.542x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 158/200 |loss: 12.685911| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 159/200 |loss: 12.890174| train set 1.534x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 160/200 |loss: 12.665252| train set 1.533x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 20
Epoch 161/200 |loss: 13.182707| train set 1.540x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 162/200 |loss: 15.193815| train set 1.410x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 22
Epoch 163/200 |loss: 14.865308| train set 1.483x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 23
Epoch 164/200 |loss: 15.229223| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 24
Epoch 165/200 |loss: 12.950319| train set 1.490x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 25
Epoch 166/200 |loss: 15.331006| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 26
Epoch 167/200 |loss: 15.583957| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 168/200 |loss: 14.970459| train set 1.514x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 28
Epoch 169/200 |loss: 15.225169| train set 1.487x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 29
Epoch 170/200 |loss: 14.146111| train set 1.472x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 30
Epoch 171/200 |loss: 14.300457| train set 1.476x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 31
Epoch 172/200 |loss: 13.574724| train set 1.515x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 32
Epoch 173/200 |loss: 13.824821| train set 1.532x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 33
Epoch 174/200 |loss: 13.309246| train set 1.551x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 34
Epoch 175/200 |loss: 13.340914| train set 1.542x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 35
Epoch 176/200 |loss: 13.034566| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 36
Epoch 177/200 |loss: 12.893963| train set 1.388x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 37
Epoch 178/200 |loss: 12.786401| train set 1.567x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 38
Epoch 179/200 |loss: 12.667891| train set 1.560x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 39
Epoch 180/200 |loss: 12.413154| train set 1.521x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 40
Epoch 181/200 |loss: 12.427767| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 41
Epoch 182/200 |loss: 12.189269| train set 1.546x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 42
Epoch 183/200 |loss: 12.226104| train set 1.531x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 43
Epoch 184/200 |loss: 11.973227| train set 1.514x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 44
Epoch 185/200 |loss: 12.011873| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 45
Epoch 186/200 |loss: 11.821603| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 46
Epoch 187/200 |loss: 11.955847| train set 1.487x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 47
Epoch 188/200 |loss: 11.969722| train set 1.543x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 48
Epoch 189/200 |loss: 12.760426| train set 1.517x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 49
Epoch 190/200 |loss: 14.200616| train set 1.356x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 50
Epoch 191/200 |loss: 15.313197| train set 1.488x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 51
Epoch 192/200 |loss: 12.964669| train set 1.512x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 52
Epoch 193/200 |loss: 12.404722| train set 1.423x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 53
Epoch 194/200 |loss: 13.017366| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 54
Epoch 195/200 |loss: 12.533587| train set 1.507x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 55
Epoch 196/200 |loss: 12.509270| train set 1.539x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 56
Epoch 197/200 |loss: 12.415861| train set 1.533x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 57
Epoch 198/200 |loss: 12.547316| train set 1.530x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 58
Epoch 199/200 |loss: 12.143571| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 59
Training per epoch cost 0.331 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 178, train speedup 1.567, test speedup 4.775, val speedup 0.997
best test speedup epoch: 16, train speedup 1.173, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 141, train speedup 1.451, test speedup 4.775, val speedup 1.008
last model at epoch 199, train speedup 1.558, test speedup 4.775, val speedup 0.997
execution cost 0:02:52.321996
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.135204, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786835| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091705| train set 1.161x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809973| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533352| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.277740| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.015640| train set 1.153x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.783880| train set 1.192x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.557287| train set 1.214x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.379692| train set 1.238x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.182526| train set 1.218x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.939791| train set 1.219x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.652283| train set 1.227x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.469048| train set 1.204x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.346947| train set 1.204x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.109518| train set 1.182x speedup, test set 8.636x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.842634| train set 1.186x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.660978| train set 1.201x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.610470| train set 1.188x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.450214| train set 1.178x speedup, test set 8.197x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.177563| train set 1.178x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 24.979498| train set 1.163x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.982040| train set 1.197x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.725819| train set 1.205x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.320496| train set 1.190x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.497683| train set 1.206x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.226007| train set 1.226x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 23.991398| train set 1.237x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.063726| train set 1.202x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.781538| train set 1.208x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.687710| train set 1.244x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.522709| train set 1.231x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.040457| train set 1.305x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.125055| train set 1.213x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.926586| train set 1.281x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.975698| train set 1.305x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.992088| train set 1.254x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.756231| train set 1.204x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.823723| train set 1.305x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 21.999506| train set 1.297x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.368603| train set 1.237x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.464731| train set 1.312x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.146130| train set 1.319x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.833803| train set 1.311x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.606821| train set 1.384x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 53
Epoch 53/200 |loss: 21.899387| train set 1.325x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.249298| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.252123| train set 1.386x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 20.840879| train set 1.311x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 21.092892| train set 1.385x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 58
Epoch 58/200 |loss: 20.675446| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.657873| train set 1.304x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.458332| train set 1.386x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.635069| train set 1.326x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.579674| train set 1.392x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.295317| train set 1.330x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 19.983414| train set 1.390x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 19.497887| train set 1.432x speedup, test set 5.685x speedup, val set 0.701x speedup, step: 66
Epoch 66/200 |loss: 19.847742| train set 1.276x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 20.504562| train set 1.378x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 20.000284| train set 1.398x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.327114| train set 1.339x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 19.488785| train set 1.399x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.201038| train set 1.394x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.159332| train set 1.390x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 18.761936| train set 1.487x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 20.503939| train set 1.337x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 20.270647| train set 1.394x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 20.363689| train set 1.415x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.258266| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 20.187433| train set 1.477x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.985676| train set 1.398x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 19.103067| train set 1.262x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.728407| train set 1.345x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.386274| train set 1.399x speedup, test set 5.702x speedup, val set 0.701x speedup, step: 83
Epoch 83/200 |loss: 18.911278| train set 1.341x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.109365| train set 1.341x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.019604| train set 1.415x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.086191| train set 1.401x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.350063| train set 1.385x speedup, test set 4.642x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.767210| train set 1.400x speedup, test set 5.871x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 17.315645| train set 1.400x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.124504| train set 1.396x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.083469| train set 1.495x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 16.826803| train set 1.479x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 16.670168| train set 1.392x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 16.618740| train set 1.400x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 16.434286| train set 1.399x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 16.500137| train set 1.529x speedup, test set 4.642x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.375305| train set 1.381x speedup, test set 4.970x speedup, val set 0.993x speedup, step: 98
Epoch 98/200 |loss: 19.740797| train set 1.413x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 24.222401| train set 1.425x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 19.664534| train set 1.302x speedup, test set 4.641x speedup, val set 0.992x speedup, step: 1
Epoch 101/200 |loss: 23.308893| train set 1.341x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 18.465714| train set 1.416x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 103/200 |loss: 19.905905| train set 1.373x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 18.893822| train set 1.303x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 2
Epoch 105/200 |loss: 18.788069| train set 1.412x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 3
Epoch 106/200 |loss: 18.833002| train set 1.483x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 4
Epoch 107/200 |loss: 17.845535| train set 1.478x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 18.260557| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 17.592428| train set 1.399x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 17.292120| train set 1.447x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 17.557343| train set 1.418x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 16.797533| train set 1.385x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 17.058828| train set 1.367x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 16.502012| train set 1.392x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 16.623896| train set 1.414x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 16.105455| train set 1.410x speedup, test set 5.702x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 16.262285| train set 1.538x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 15.760843| train set 1.526x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 15.862992| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 15.544335| train set 1.414x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 15.458920| train set 1.454x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 15.345410| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 15.166364| train set 1.401x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 15.067315| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 14.967635| train set 1.503x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 15.000981| train set 1.518x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 15.214108| train set 1.397x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 128/200 |loss: 16.115782| train set 1.489x speedup, test set 5.888x speedup, val set 0.994x speedup, step: 2
Epoch 129/200 |loss: 15.878870| train set 1.524x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 130/200 |loss: 14.925947| train set 1.526x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 131/200 |loss: 14.520221| train set 1.456x speedup, test set 5.888x speedup, val set 0.997x speedup, step: 5
Epoch 132/200 |loss: 14.863214| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 133/200 |loss: 14.737391| train set 1.503x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 134/200 |loss: 14.149055| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 135/200 |loss: 14.482969| train set 1.422x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 136/200 |loss: 14.953657| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 137/200 |loss: 14.868958| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 138/200 |loss: 14.520343| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 139/200 |loss: 14.621891| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 140/200 |loss: 13.709213| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 141/200 |loss: 13.560414| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 142/200 |loss: 14.143078| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 143/200 |loss: 13.889363| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 144/200 |loss: 14.138975| train set 1.446x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 145/200 |loss: 13.821736| train set 1.511x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 146/200 |loss: 13.892659| train set 1.526x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 147/200 |loss: 13.807967| train set 1.507x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 148/200 |loss: 13.056149| train set 1.525x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 149/200 |loss: 13.273583| train set 1.432x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 150/200 |loss: 14.066682| train set 1.507x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 151/200 |loss: 14.075088| train set 1.546x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 25
Epoch 152/200 |loss: 13.712789| train set 1.535x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 26
Epoch 153/200 |loss: 14.371688| train set 1.448x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 154/200 |loss: 13.370399| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 155/200 |loss: 12.933494| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 29
Epoch 156/200 |loss: 13.497685| train set 1.507x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 30
Epoch 157/200 |loss: 13.295512| train set 1.556x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 31
Epoch 158/200 |loss: 13.086948| train set 1.536x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 32
Epoch 159/200 |loss: 12.630142| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 33
Epoch 160/200 |loss: 12.751473| train set 1.470x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 34
Epoch 161/200 |loss: 13.583543| train set 1.499x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 35
Epoch 162/200 |loss: 12.686383| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 36
Epoch 163/200 |loss: 12.787966| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 37
Epoch 164/200 |loss: 13.187786| train set 1.523x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 38
Epoch 165/200 |loss: 12.437011| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 39
Epoch 166/200 |loss: 12.482048| train set 1.513x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 40
Epoch 167/200 |loss: 12.730098| train set 1.556x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 41
Epoch 168/200 |loss: 12.351555| train set 1.523x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 42
Epoch 169/200 |loss: 12.078260| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 43
Epoch 170/200 |loss: 12.678933| train set 1.561x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 44
Epoch 171/200 |loss: 12.439697| train set 1.554x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 45
Epoch 172/200 |loss: 12.346660| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 46
Epoch 173/200 |loss: 12.859914| train set 1.557x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 47
Epoch 174/200 |loss: 13.504424| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 48
Epoch 175/200 |loss: 14.240454| train set 1.555x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 49
Epoch 176/200 |loss: 12.792671| train set 1.506x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 50
Epoch 177/200 |loss: 13.488214| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 51
Epoch 178/200 |loss: 14.479987| train set 1.430x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 52
Epoch 179/200 |loss: 13.879511| train set 1.498x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 53
Epoch 180/200 |loss: 14.377052| train set 1.478x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 54
Epoch 181/200 |loss: 16.336040| train set 1.297x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 55
Epoch 182/200 |loss: 15.323515| train set 1.423x speedup, test set 4.652x speedup, val set 0.993x speedup, step: 56
Epoch 183/200 |loss: 15.155669| train set 1.411x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 57
Epoch 184/200 |loss: 15.339798| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 58
Epoch 185/200 |loss: 13.742146| train set 1.460x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 59
Epoch 186/200 |loss: 14.481771| train set 1.467x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 60
Epoch 187/200 |loss: 13.413880| train set 1.523x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 61
Epoch 188/200 |loss: 13.574198| train set 1.398x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 62
Epoch 189/200 |loss: 13.291727| train set 1.548x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 63
Epoch 190/200 |loss: 12.905631| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 64
Epoch 191/200 |loss: 12.912343| train set 1.543x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 192/200 |loss: 12.672823| train set 1.456x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 66
Epoch 193/200 |loss: 12.536205| train set 1.506x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 67
Epoch 194/200 |loss: 12.446764| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 68
Epoch 195/200 |loss: 12.230467| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 69
Epoch 196/200 |loss: 12.125471| train set 1.526x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 70
Epoch 197/200 |loss: 11.984028| train set 1.496x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 71
Epoch 198/200 |loss: 11.991983| train set 1.477x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 72
Epoch 199/200 |loss: 11.750492| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 73
Training per epoch cost 0.320 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 170, train speedup 1.561, test speedup 4.652, val speedup 0.997
best test speedup epoch: 16, train speedup 1.214, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 127, train speedup 1.397, test speedup 4.775, val speedup 1.008
last model at epoch 199, train speedup 1.518, test speedup 4.652, val speedup 0.997
execution cost 0:02:51.744659
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.127021, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159273| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787605| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442108| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079727| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.696587| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.380135| train set 1.119x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.084961| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.802206| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.532499| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.285904| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.023209| train set 1.178x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.762909| train set 1.169x speedup, test set 7.264x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.506460| train set 1.219x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.266430| train set 1.239x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.044916| train set 1.217x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.910450| train set 1.219x speedup, test set 6.410x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 27.008251| train set 1.216x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.865721| train set 1.218x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.303804| train set 1.199x speedup, test set 6.345x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.563341| train set 1.206x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.894672| train set 1.196x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 25
Epoch 25/200 |loss: 26.077007| train set 1.227x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.555084| train set 1.214x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.624548| train set 1.206x speedup, test set 8.197x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.303068| train set 1.200x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.155094| train set 1.227x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.035421| train set 1.227x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.696608| train set 1.198x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.728519| train set 1.228x speedup, test set 5.685x speedup, val set 0.932x speedup, step: 33
Epoch 33/200 |loss: 24.350725| train set 1.225x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.497517| train set 1.207x speedup, test set 4.641x speedup, val set 0.932x speedup, step: 35
Epoch 35/200 |loss: 24.437841| train set 1.297x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.985050| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 24.092558| train set 1.231x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.605417| train set 1.256x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.703346| train set 1.230x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 40
Epoch 40/200 |loss: 23.719580| train set 1.232x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.046085| train set 1.291x speedup, test set 6.129x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.253210| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.134296| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.591764| train set 1.259x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.868956| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.379244| train set 1.305x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.212622| train set 1.299x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.401646| train set 1.305x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 21.896351| train set 1.305x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 21.624660| train set 1.330x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 51
Epoch 51/200 |loss: 21.793245| train set 1.237x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.605751| train set 1.323x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.290287| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.806850| train set 1.330x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 55
Epoch 55/200 |loss: 21.888514| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.323599| train set 1.337x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.937279| train set 1.329x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 21.079559| train set 1.342x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.488884| train set 1.336x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 60
Epoch 60/200 |loss: 20.746412| train set 1.236x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.947035| train set 1.343x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.126577| train set 1.347x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.785652| train set 1.330x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 19.956200| train set 1.343x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.119831| train set 1.343x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 19.831762| train set 1.343x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 19.786556| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 20.019716| train set 1.343x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.644245| train set 1.397x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 70
Epoch 70/200 |loss: 19.708910| train set 1.340x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.611929| train set 1.345x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.933050| train set 1.345x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.378736| train set 1.399x speedup, test set 4.652x speedup, val set 0.930x speedup, step: 74
Epoch 74/200 |loss: 18.991356| train set 1.320x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.017389| train set 1.318x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 18.699106| train set 1.364x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.713793| train set 1.386x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.538383| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.989321| train set 1.349x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.546572| train set 1.345x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 17.986958| train set 1.394x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.007229| train set 1.395x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 17.801517| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.223921| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.508570| train set 1.413x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.387526| train set 1.395x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.034307| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 16.872574| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 16.993448| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.022665| train set 1.431x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 18.171894| train set 1.385x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 18.014503| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.628712| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 16.552614| train set 1.365x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 18.267258| train set 1.431x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 18.972971| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.949080| train set 1.394x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 20.189651| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 18.032558| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 18.161776| train set 1.356x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.371178| train set 1.360x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 17.465729| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 17.131363| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.969574| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.460375| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.575129| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.401022| train set 1.395x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.570969| train set 1.420x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 16.026386| train set 1.459x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.959186| train set 1.419x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.822173| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.742929| train set 1.450x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.462761| train set 1.473x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.435779| train set 1.422x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 15.056029| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 15.047148| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 14.871907| train set 1.457x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 14.875736| train set 1.422x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 14.637535| train set 1.417x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 14.747058| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 14.918499| train set 1.405x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 122/200 |loss: 15.784375| train set 1.440x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 123/200 |loss: 16.287184| train set 1.391x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 124/200 |loss: 15.608520| train set 1.422x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 125/200 |loss: 14.340075| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 126/200 |loss: 15.051468| train set 1.453x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 127/200 |loss: 15.225859| train set 1.422x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 128/200 |loss: 14.270874| train set 1.513x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 129/200 |loss: 14.526399| train set 1.424x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 130/200 |loss: 14.685287| train set 1.395x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 131/200 |loss: 13.868492| train set 1.506x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 132/200 |loss: 14.179064| train set 1.449x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 133/200 |loss: 14.262498| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 134/200 |loss: 13.577657| train set 1.512x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 14
Epoch 135/200 |loss: 13.759670| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 136/200 |loss: 13.915923| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 137/200 |loss: 13.703581| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 138/200 |loss: 15.295995| train set 1.402x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 139/200 |loss: 16.460455| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 140/200 |loss: 15.254336| train set 1.507x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 141/200 |loss: 15.465910| train set 1.450x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 142/200 |loss: 15.360075| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 143/200 |loss: 15.067903| train set 1.414x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 23
Epoch 144/200 |loss: 15.661957| train set 1.419x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 24
Epoch 145/200 |loss: 14.348698| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 25
Epoch 146/200 |loss: 15.387174| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 26
Epoch 147/200 |loss: 14.203670| train set 1.394x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 148/200 |loss: 14.439432| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 149/200 |loss: 14.815773| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 29
Epoch 150/200 |loss: 13.473244| train set 1.524x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 30
Epoch 151/200 |loss: 14.688396| train set 1.421x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 31
Epoch 152/200 |loss: 13.622483| train set 1.562x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 32
Epoch 153/200 |loss: 13.743940| train set 1.494x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 33
Epoch 154/200 |loss: 13.888178| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 34
Epoch 155/200 |loss: 13.054099| train set 1.533x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 35
Epoch 156/200 |loss: 13.523889| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 36
Epoch 157/200 |loss: 12.891864| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 37
Epoch 158/200 |loss: 13.029384| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 38
Epoch 159/200 |loss: 12.714789| train set 1.542x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 39
Epoch 160/200 |loss: 12.713689| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 40
Epoch 161/200 |loss: 12.600863| train set 1.563x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 41
Epoch 162/200 |loss: 12.484140| train set 1.542x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 42
Epoch 163/200 |loss: 12.470355| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 43
Epoch 164/200 |loss: 12.280724| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 44
Epoch 165/200 |loss: 12.255325| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 45
Epoch 166/200 |loss: 12.099605| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 46
Epoch 167/200 |loss: 12.113545| train set 1.530x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 47
Epoch 168/200 |loss: 12.089530| train set 1.531x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 48
Epoch 169/200 |loss: 11.932007| train set 1.517x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 49
Epoch 170/200 |loss: 11.877848| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 50
Epoch 171/200 |loss: 11.932910| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 51
Epoch 172/200 |loss: 11.789699| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 52
Epoch 173/200 |loss: 12.031690| train set 1.528x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 53
Epoch 174/200 |loss: 12.369968| train set 1.469x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 54
Epoch 175/200 |loss: 13.910863| train set 1.533x speedup, test set 4.652x speedup, val set 0.993x speedup, step: 55
Epoch 176/200 |loss: 12.784871| train set 1.537x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 177/200 |loss: 12.487613| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 178/200 |loss: 12.923005| train set 1.514x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 179/200 |loss: 12.697682| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 180/200 |loss: 12.723687| train set 1.497x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 5
Epoch 181/200 |loss: 12.475647| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 182/200 |loss: 12.821806| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 183/200 |loss: 13.063696| train set 1.507x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 184/200 |loss: 12.349800| train set 1.539x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 185/200 |loss: 12.406781| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 186/200 |loss: 13.059099| train set 1.469x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 187/200 |loss: 12.146881| train set 1.545x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 188/200 |loss: 12.828278| train set 1.577x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 189/200 |loss: 12.713049| train set 1.514x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 190/200 |loss: 12.437387| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 191/200 |loss: 12.929986| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 192/200 |loss: 12.546004| train set 1.517x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 17
Epoch 193/200 |loss: 12.739607| train set 1.520x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 18
Epoch 194/200 |loss: 12.226242| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 195/200 |loss: 12.769589| train set 1.511x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 196/200 |loss: 12.823905| train set 1.518x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 21
Epoch 197/200 |loss: 11.991635| train set 1.506x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 198/200 |loss: 12.943155| train set 1.453x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 199/200 |loss: 12.054367| train set 1.517x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Training per epoch cost 0.324 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 188, train speedup 1.577, test speedup 4.652, val speedup 0.997
best test speedup epoch: 16, train speedup 1.219, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 197, train speedup 1.506, test speedup 4.652, val speedup 1.008
last model at epoch 199, train speedup 1.517, test speedup 4.652, val speedup 0.997
execution cost 0:02:52.711494
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.183184, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159264| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.696198| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379524| train set 1.119x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.084557| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.802408| train set 1.147x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.531387| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.292549| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.023714| train set 1.137x speedup, test set 7.264x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.765724| train set 1.192x speedup, test set 7.264x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.509764| train set 1.195x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.284952| train set 1.234x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.096891| train set 1.216x speedup, test set 8.410x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 27.119001| train set 1.220x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.961061| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.484608| train set 1.218x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.393456| train set 1.226x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.184082| train set 1.223x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.849329| train set 1.200x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.809898| train set 1.225x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.527592| train set 1.193x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.325106| train set 1.202x speedup, test set 4.747x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.311773| train set 1.203x speedup, test set 9.635x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.021168| train set 1.197x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 24.769878| train set 1.201x speedup, test set 8.589x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.716858| train set 1.228x speedup, test set 5.871x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.535809| train set 1.210x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.226202| train set 1.230x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.060713| train set 1.213x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 23.915945| train set 1.224x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.996403| train set 1.208x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.874868| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.503262| train set 1.215x speedup, test set 6.129x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.253653| train set 1.231x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.588564| train set 1.254x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.634073| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 23.358706| train set 1.306x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.908251| train set 1.313x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 23.293076| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.704664| train set 1.246x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.603251| train set 1.312x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.893494| train set 1.319x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 21.876694| train set 1.251x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.522196| train set 1.325x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 21.977642| train set 1.310x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 51
Epoch 51/200 |loss: 22.028271| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 22.053400| train set 1.342x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.748020| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.286585| train set 1.309x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 55
Epoch 55/200 |loss: 21.285753| train set 1.322x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 56
Epoch 56/200 |loss: 20.900120| train set 1.326x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.930809| train set 1.391x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 21.020237| train set 1.326x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 21.003347| train set 1.314x speedup, test set 4.641x speedup, val set 0.931x speedup, step: 60
Epoch 60/200 |loss: 21.016954| train set 1.313x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.803595| train set 1.343x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.455151| train set 1.343x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.323595| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.540037| train set 1.392x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.274672| train set 1.343x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 19.712938| train set 1.343x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 19.636368| train set 1.357x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 68
Epoch 68/200 |loss: 20.017946| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.781446| train set 1.348x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 19.271946| train set 1.348x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.110033| train set 1.331x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.330448| train set 1.372x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.323153| train set 1.379x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 18.894903| train set 1.398x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 18.471369| train set 1.350x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 18.694050| train set 1.385x speedup, test set 4.665x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.884150| train set 1.356x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 19.835184| train set 1.427x speedup, test set 4.665x speedup, val set 0.739x speedup, step: 79
Epoch 79/200 |loss: 20.502565| train set 1.307x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 19.683487| train set 1.310x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 19.641970| train set 1.333x speedup, test set 4.801x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 19.389189| train set 1.376x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 19.422092| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 20.415497| train set 1.345x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.937820| train set 1.362x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 19.641552| train set 1.418x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.819904| train set 1.325x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 18.599054| train set 1.373x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.313055| train set 1.387x speedup, test set 4.801x speedup, val set 0.738x speedup, step: 90
Epoch 90/200 |loss: 18.226828| train set 1.411x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.892050| train set 1.341x speedup, test set 4.686x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.787813| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.591581| train set 1.404x speedup, test set 4.665x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.449551| train set 1.434x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.235714| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.064861| train set 1.397x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.943249| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.783218| train set 1.399x speedup, test set 4.686x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.612993| train set 1.374x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.582146| train set 1.387x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.255112| train set 1.446x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.327545| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.066744| train set 1.416x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 15.985159| train set 1.453x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.060614| train set 1.502x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 106/200 |loss: 16.186768| train set 1.428x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 17.418131| train set 1.495x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 108/200 |loss: 19.296465| train set 1.319x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 16.471510| train set 1.468x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 17.218561| train set 1.434x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 111/200 |loss: 19.060854| train set 1.292x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 17.898262| train set 1.324x speedup, test set 4.665x speedup, val set 0.993x speedup, step: 2
Epoch 113/200 |loss: 19.767826| train set 1.409x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 16.526180| train set 1.465x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 115/200 |loss: 18.030874| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 16.321596| train set 1.415x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 2
Epoch 117/200 |loss: 17.424782| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 16.228685| train set 1.433x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 16.687090| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 15.696574| train set 1.504x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 2
Epoch 121/200 |loss: 16.419371| train set 1.446x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 15.550896| train set 1.428x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 15.846600| train set 1.416x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 15.335735| train set 1.393x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 15.358893| train set 1.417x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 15.158293| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 14.970129| train set 1.420x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 14.904682| train set 1.414x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 129/200 |loss: 14.659879| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 14.697164| train set 1.506x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 14.441147| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 14.308585| train set 1.411x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 14.264613| train set 1.476x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 134/200 |loss: 14.053297| train set 1.476x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 14.055731| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 13.941198| train set 1.451x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 137/200 |loss: 13.948443| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 138/200 |loss: 14.206169| train set 1.434x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 14.825730| train set 1.479x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 140/200 |loss: 15.472018| train set 1.437x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 141/200 |loss: 15.149052| train set 1.503x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 142/200 |loss: 13.856549| train set 1.496x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 143/200 |loss: 13.875081| train set 1.455x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 144/200 |loss: 14.257284| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 145/200 |loss: 13.869424| train set 1.442x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 146/200 |loss: 13.885616| train set 1.449x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 147/200 |loss: 13.692408| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 148/200 |loss: 13.236128| train set 1.486x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 149/200 |loss: 13.438428| train set 1.503x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 150/200 |loss: 13.147573| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 151/200 |loss: 13.058349| train set 1.540x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 152/200 |loss: 13.508866| train set 1.415x speedup, test set 4.766x speedup, val set 0.997x speedup, step: 2
Epoch 153/200 |loss: 13.318144| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 154/200 |loss: 13.464572| train set 1.435x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 155/200 |loss: 14.026369| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 156/200 |loss: 13.981221| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 157/200 |loss: 13.448994| train set 1.448x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 158/200 |loss: 13.098403| train set 1.514x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 159/200 |loss: 12.845410| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 160/200 |loss: 13.158568| train set 1.448x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 161/200 |loss: 13.594004| train set 1.544x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 162/200 |loss: 12.651148| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 163/200 |loss: 13.061481| train set 1.514x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 164/200 |loss: 13.350882| train set 1.484x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 165/200 |loss: 12.670903| train set 1.555x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 166/200 |loss: 12.911591| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 167/200 |loss: 12.958187| train set 1.546x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 168/200 |loss: 12.512251| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 169/200 |loss: 12.527154| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 170/200 |loss: 12.372215| train set 1.556x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 171/200 |loss: 12.532961| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 172/200 |loss: 12.090810| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 173/200 |loss: 12.067654| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 174/200 |loss: 12.265393| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 175/200 |loss: 12.105853| train set 1.541x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 22
Epoch 176/200 |loss: 12.239452| train set 1.531x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 177/200 |loss: 13.229602| train set 1.417x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 178/200 |loss: 15.855145| train set 1.525x speedup, test set 4.652x speedup, val set 0.996x speedup, step: 2
Epoch 179/200 |loss: 15.511499| train set 1.543x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 180/200 |loss: 12.843334| train set 1.444x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 181/200 |loss: 13.243538| train set 1.525x speedup, test set 4.652x speedup, val set 0.988x speedup, step: 5
Epoch 182/200 |loss: 14.024421| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 183/200 |loss: 12.711695| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 184/200 |loss: 12.758469| train set 1.489x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 185/200 |loss: 12.653569| train set 1.545x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 186/200 |loss: 12.200701| train set 1.459x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 187/200 |loss: 12.643744| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 188/200 |loss: 12.489610| train set 1.555x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 189/200 |loss: 12.786917| train set 1.500x speedup, test set 1.559x speedup, val set 0.997x speedup, step: 13
Epoch 190/200 |loss: 13.173292| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 191/200 |loss: 12.553621| train set 1.536x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 192/200 |loss: 12.409887| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 193/200 |loss: 12.163411| train set 1.514x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 194/200 |loss: 12.468786| train set 1.539x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 195/200 |loss: 11.997594| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 196/200 |loss: 11.947450| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 197/200 |loss: 11.676865| train set 1.526x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 198/200 |loss: 11.738862| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 199/200 |loss: 11.772443| train set 1.471x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Training per epoch cost 0.321 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 170, train speedup 1.556, test speedup 4.652, val speedup 0.997
best test speedup epoch: 19, train speedup 1.220, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 177, train speedup 1.417, test speedup 4.652, val speedup 1.008
last model at epoch 199, train speedup 1.471, test speedup 4.652, val speedup 0.997
execution cost 0:02:52.905818
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.217183, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159269| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787605| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442133| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079819| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695820| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.380230| train set 1.126x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.084398| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.801464| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.530392| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.286745| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.020660| train set 1.154x speedup, test set 6.106x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.765217| train set 1.192x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.509241| train set 1.211x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.280243| train set 1.237x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.065014| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.980793| train set 1.220x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 27.026152| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.695028| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.305313| train set 1.227x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.393229| train set 1.205x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.863529| train set 1.199x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.881124| train set 1.224x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.571976| train set 1.225x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.336653| train set 1.200x speedup, test set 8.589x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.293400| train set 1.228x speedup, test set 9.072x speedup, val set 0.999x speedup, step: 29
Epoch 29/200 |loss: 24.923775| train set 1.228x speedup, test set 7.264x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 24.863663| train set 1.203x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.759016| train set 1.200x speedup, test set 5.871x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.404755| train set 1.230x speedup, test set 5.871x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.281433| train set 1.221x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.256359| train set 1.231x speedup, test set 6.982x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 23.991209| train set 1.229x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 36
Epoch 36/200 |loss: 23.985065| train set 1.250x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 24.628881| train set 1.230x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 38
Epoch 38/200 |loss: 24.620619| train set 1.231x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 39
Epoch 39/200 |loss: 23.618996| train set 1.266x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 24.152798| train set 1.306x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.249010| train set 1.230x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 23.638405| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 22.867895| train set 1.255x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 23.202856| train set 1.303x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.491894| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.825060| train set 1.303x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.194914| train set 1.273x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 48
Epoch 48/200 |loss: 22.391291| train set 1.304x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 49
Epoch 49/200 |loss: 21.924671| train set 1.303x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 50
Epoch 50/200 |loss: 21.991215| train set 1.319x speedup, test set 4.641x speedup, val set 0.931x speedup, step: 51
Epoch 51/200 |loss: 21.715910| train set 1.286x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 52
Epoch 52/200 |loss: 21.870092| train set 1.232x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 22.021597| train set 1.319x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 21.709972| train set 1.386x speedup, test set 5.235x speedup, val set 0.931x speedup, step: 55
Epoch 55/200 |loss: 21.346630| train set 1.327x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 21.006376| train set 1.324x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.494974| train set 1.321x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 20.789997| train set 1.393x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 20.496403| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.583031| train set 1.329x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.237888| train set 1.338x speedup, test set 4.641x speedup, val set 0.931x speedup, step: 62
Epoch 62/200 |loss: 20.434103| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.480743| train set 1.343x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.304165| train set 1.378x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.111204| train set 1.342x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 19.699818| train set 1.391x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 19.288828| train set 1.382x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.672234| train set 1.327x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.759684| train set 1.307x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.197449| train set 1.392x speedup, test set 4.641x speedup, val set 0.739x speedup, step: 71
Epoch 71/200 |loss: 19.105309| train set 1.341x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.977955| train set 1.397x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 20.368521| train set 1.370x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 19.052954| train set 1.396x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 19.200851| train set 1.398x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 18.767895| train set 1.350x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.509222| train set 1.345x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 18.747915| train set 1.395x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 18.648144| train set 1.407x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.299816| train set 1.332x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 18.962091| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 18.281872| train set 1.371x speedup, test set 4.651x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 17.882847| train set 1.400x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 17.933723| train set 1.409x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 17.686842| train set 1.383x speedup, test set 4.675x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 17.769371| train set 1.414x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 18.678541| train set 1.389x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 18.560982| train set 1.415x speedup, test set 4.712x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 18.869064| train set 1.345x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.437241| train set 1.351x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 19.101097| train set 1.410x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 18.904158| train set 1.388x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 93
Epoch 93/200 |loss: 17.725370| train set 1.381x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 94
Epoch 94/200 |loss: 18.702749| train set 1.424x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 17.457960| train set 1.372x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.649698| train set 1.414x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 97
Epoch 97/200 |loss: 17.463327| train set 1.410x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 98
Epoch 98/200 |loss: 16.936052| train set 1.425x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.075499| train set 1.504x speedup, test set 4.775x speedup, val set 0.739x speedup, step: 100
Epoch 100/200 |loss: 16.792728| train set 1.399x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 101/200 |loss: 16.834606| train set 1.415x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 102/200 |loss: 16.891653| train set 1.416x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 103/200 |loss: 16.471674| train set 1.436x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 104/200 |loss: 16.689951| train set 1.421x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 105/200 |loss: 16.278545| train set 1.369x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 106/200 |loss: 16.718487| train set 1.388x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 107/200 |loss: 15.792786| train set 1.392x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 108/200 |loss: 15.948181| train set 1.401x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 109/200 |loss: 15.982065| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 110/200 |loss: 15.446144| train set 1.451x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 111/200 |loss: 15.697786| train set 1.412x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 112/200 |loss: 15.360059| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 113/200 |loss: 15.342928| train set 1.426x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 114/200 |loss: 15.468435| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 115/200 |loss: 15.301003| train set 1.472x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 116/200 |loss: 15.427250| train set 1.432x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 117/200 |loss: 15.847070| train set 1.495x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 118/200 |loss: 15.760106| train set 1.388x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 15
Epoch 119/200 |loss: 16.016804| train set 1.503x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 16
Epoch 120/200 |loss: 15.805542| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 121/200 |loss: 14.720079| train set 1.420x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 122/200 |loss: 14.523129| train set 1.520x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 123/200 |loss: 14.945044| train set 1.389x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 20
Epoch 124/200 |loss: 15.022132| train set 1.422x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 125/200 |loss: 14.519629| train set 1.459x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 22
Epoch 126/200 |loss: 14.216553| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 23
Epoch 127/200 |loss: 14.258210| train set 1.422x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 24
Epoch 128/200 |loss: 14.665813| train set 1.475x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 25
Epoch 129/200 |loss: 14.142946| train set 1.450x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 26
Epoch 130/200 |loss: 14.033845| train set 1.520x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 27
Epoch 131/200 |loss: 14.621203| train set 1.401x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 132/200 |loss: 16.180515| train set 1.428x speedup, test set 4.775x speedup, val set 0.737x speedup, step: 2
Epoch 133/200 |loss: 15.543989| train set 1.412x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 134/200 |loss: 13.964872| train set 1.457x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 135/200 |loss: 14.316206| train set 1.520x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 136/200 |loss: 15.138223| train set 1.343x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 6
Epoch 137/200 |loss: 15.040038| train set 1.444x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 138/200 |loss: 14.139591| train set 1.434x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 8
Epoch 139/200 |loss: 15.189590| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 140/200 |loss: 14.868112| train set 1.417x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 141/200 |loss: 13.943913| train set 1.503x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 142/200 |loss: 15.353976| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 143/200 |loss: 14.450780| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 144/200 |loss: 14.386337| train set 1.517x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 145/200 |loss: 15.094299| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 146/200 |loss: 13.589397| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 16
Epoch 147/200 |loss: 14.692980| train set 1.411x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 148/200 |loss: 14.163995| train set 1.449x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 149/200 |loss: 14.367454| train set 1.389x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 150/200 |loss: 15.989487| train set 1.473x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 20
Epoch 151/200 |loss: 14.012515| train set 1.494x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 21
Epoch 152/200 |loss: 14.757528| train set 1.451x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 22
Epoch 153/200 |loss: 13.613943| train set 1.395x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 23
Epoch 154/200 |loss: 14.278648| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 24
Epoch 155/200 |loss: 13.812696| train set 1.517x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 25
Epoch 156/200 |loss: 13.638265| train set 1.459x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 26
Epoch 157/200 |loss: 13.552945| train set 1.471x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 27
Epoch 158/200 |loss: 13.782491| train set 1.542x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 28
Epoch 159/200 |loss: 13.087783| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 29
Epoch 160/200 |loss: 13.530586| train set 1.421x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 30
Epoch 161/200 |loss: 13.892495| train set 1.501x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 31
Epoch 162/200 |loss: 13.063134| train set 1.491x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 32
Epoch 163/200 |loss: 13.820597| train set 1.472x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 33
Epoch 164/200 |loss: 14.014473| train set 1.410x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 34
Epoch 165/200 |loss: 13.617862| train set 1.541x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 35
Epoch 166/200 |loss: 13.767909| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 36
Epoch 167/200 |loss: 13.615842| train set 1.520x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 37
Epoch 168/200 |loss: 13.332891| train set 1.422x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 38
Epoch 169/200 |loss: 12.998397| train set 1.538x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 39
Epoch 170/200 |loss: 13.012824| train set 1.524x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 40
Epoch 171/200 |loss: 13.133805| train set 1.472x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 41
Epoch 172/200 |loss: 12.589347| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 42
Epoch 173/200 |loss: 12.727745| train set 1.563x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 43
Epoch 174/200 |loss: 12.671143| train set 1.565x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 44
Epoch 175/200 |loss: 12.181404| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 45
Epoch 176/200 |loss: 12.358864| train set 1.524x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 46
Epoch 177/200 |loss: 12.224206| train set 1.563x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 47
Epoch 178/200 |loss: 12.030722| train set 1.541x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 48
Epoch 179/200 |loss: 11.982428| train set 1.503x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 49
Epoch 180/200 |loss: 11.929254| train set 1.509x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 50
Epoch 181/200 |loss: 11.863713| train set 1.489x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 51
Epoch 182/200 |loss: 11.702064| train set 1.520x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 52
Epoch 183/200 |loss: 11.711217| train set 1.563x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 53
Epoch 184/200 |loss: 11.690713| train set 1.503x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 54
Epoch 185/200 |loss: 11.483844| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 55
Epoch 186/200 |loss: 11.484639| train set 1.561x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 56
Epoch 187/200 |loss: 11.497499| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 57
Epoch 188/200 |loss: 11.393138| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 58
Epoch 189/200 |loss: 11.315678| train set 1.557x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 59
Epoch 190/200 |loss: 11.451872| train set 1.526x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 60
Epoch 191/200 |loss: 11.969722| train set 1.494x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 61
Epoch 192/200 |loss: 12.772304| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 62
Epoch 193/200 |loss: 16.245230| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 63
Epoch 194/200 |loss: 12.631320| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 64
Epoch 195/200 |loss: 15.624845| train set 1.528x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 65
Epoch 196/200 |loss: 15.972780| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 66
Epoch 197/200 |loss: 15.475979| train set 1.426x speedup, test set 4.775x speedup, val set 0.992x speedup, step: 67
Epoch 198/200 |loss: 15.327826| train set 1.525x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 68
Epoch 199/200 |loss: 15.326299| train set 1.471x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 69
Training per epoch cost 0.324 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 174, train speedup 1.565, test speedup 4.775, val speedup 0.997
best test speedup epoch: 18, train speedup 1.216, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 131, train speedup 1.401, test speedup 4.775, val speedup 1.008
last model at epoch 199, train speedup 1.471, test speedup 4.652, val speedup 0.997
execution cost 0:02:53.170117
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.178803, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.696198| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379522| train set 1.119x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.084578| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.802246| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.531513| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.294113| train set 1.152x speedup, test set 6.345x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.023750| train set 1.138x speedup, test set 6.921x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.764200| train set 1.192x speedup, test set 5.072x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.509888| train set 1.195x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.275106| train set 1.214x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.040337| train set 1.200x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.816196| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.669359| train set 1.207x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.912945| train set 1.210x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 22
Epoch 22/200 |loss: 26.943682| train set 1.204x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.147932| train set 1.193x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 26.586409| train set 1.203x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.734375| train set 1.176x speedup, test set 8.197x speedup, val set 0.932x speedup, step: 26
Epoch 26/200 |loss: 26.066610| train set 1.206x speedup, test set 9.387x speedup, val set 0.932x speedup, step: 27
Epoch 27/200 |loss: 25.438503| train set 1.188x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.692635| train set 1.212x speedup, test set 8.197x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.097492| train set 1.200x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 25.228491| train set 1.206x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.759575| train set 1.198x speedup, test set 5.871x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.907778| train set 1.200x speedup, test set 4.764x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.460171| train set 1.226x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.480829| train set 1.209x speedup, test set 5.871x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.101999| train set 1.204x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.048347| train set 1.223x speedup, test set 5.136x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.827204| train set 1.229x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.622711| train set 1.229x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.546127| train set 1.296x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.227007| train set 1.228x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.285887| train set 1.265x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.077780| train set 1.229x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.318531| train set 1.243x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 23.472576| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.847897| train set 1.305x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.590250| train set 1.261x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.478214| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.291281| train set 1.319x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 49
Epoch 49/200 |loss: 21.947031| train set 1.324x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 50
Epoch 50/200 |loss: 22.037867| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.801092| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.403318| train set 1.311x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 53
Epoch 53/200 |loss: 21.549688| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.408354| train set 1.312x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 20.984161| train set 1.342x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 56
Epoch 56/200 |loss: 21.174706| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.935047| train set 1.328x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.727308| train set 1.343x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.641670| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 21.029068| train set 1.367x speedup, test set 5.702x speedup, val set 0.701x speedup, step: 61
Epoch 61/200 |loss: 22.217995| train set 1.238x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 21.176455| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.268053| train set 1.388x speedup, test set 5.685x speedup, val set 0.701x speedup, step: 64
Epoch 64/200 |loss: 20.853058| train set 1.330x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.165266| train set 1.343x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 19.958435| train set 1.348x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.440813| train set 1.307x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.804754| train set 1.330x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.593126| train set 1.407x speedup, test set 4.652x speedup, val set 0.701x speedup, step: 70
Epoch 70/200 |loss: 19.802879| train set 1.330x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.679380| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.110750| train set 1.408x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 19.531794| train set 1.319x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 18.980577| train set 1.321x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 18.675770| train set 1.385x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 18.911716| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.522205| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.965893| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.585306| train set 1.394x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.986605| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.978546| train set 1.373x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.155598| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 17.822752| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.395824| train set 1.360x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.940975| train set 1.430x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.515697| train set 1.394x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 87
Epoch 87/200 |loss: 17.634920| train set 1.339x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 18.269611| train set 1.401x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 17.458103| train set 1.401x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.240746| train set 1.376x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.427450| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 18.240606| train set 1.397x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.315365| train set 1.373x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 16.604919| train set 1.472x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 95
Epoch 95/200 |loss: 17.748262| train set 1.371x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.430180| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.361095| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 17.302219| train set 1.424x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 99
Epoch 99/200 |loss: 17.882753| train set 1.427x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 17.563103| train set 1.395x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.636169| train set 1.374x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.308107| train set 1.494x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 2
Epoch 103/200 |loss: 17.011871| train set 1.431x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 15.895988| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 15.968172| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.136747| train set 1.418x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 15.732062| train set 1.413x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.452016| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.334338| train set 1.401x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.422726| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.406439| train set 1.499x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.224455| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.165010| train set 1.430x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 14.905286| train set 1.445x speedup, test set 4.775x speedup, val set 1.008x speedup, step: 1
Epoch 115/200 |loss: 15.131340| train set 1.439x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 2
Epoch 116/200 |loss: 15.894072| train set 1.425x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 117/200 |loss: 16.511745| train set 1.482x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 118/200 |loss: 15.137739| train set 1.419x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 119/200 |loss: 15.376517| train set 1.435x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 120/200 |loss: 17.580442| train set 1.379x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 121/200 |loss: 14.779675| train set 1.396x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 122/200 |loss: 15.032882| train set 1.387x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 123/200 |loss: 16.394167| train set 1.373x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 124/200 |loss: 14.778661| train set 1.476x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 9
Epoch 125/200 |loss: 15.542087| train set 1.447x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 126/200 |loss: 15.113680| train set 1.426x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 127/200 |loss: 14.502254| train set 1.427x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 12
Epoch 128/200 |loss: 15.254134| train set 1.405x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 129/200 |loss: 13.985702| train set 1.457x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 130/200 |loss: 14.676468| train set 1.525x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 131/200 |loss: 14.144661| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 132/200 |loss: 13.828719| train set 1.526x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 133/200 |loss: 14.103241| train set 1.490x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 134/200 |loss: 13.542147| train set 1.483x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 135/200 |loss: 13.589982| train set 1.533x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 20
Epoch 136/200 |loss: 13.605052| train set 1.499x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 137/200 |loss: 13.621567| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 22
Epoch 138/200 |loss: 14.156442| train set 1.419x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 23
Epoch 139/200 |loss: 16.250338| train set 1.478x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 140/200 |loss: 18.475655| train set 1.410x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 25
Epoch 141/200 |loss: 14.415524| train set 1.372x speedup, test set 4.652x speedup, val set 0.996x speedup, step: 26
Epoch 142/200 |loss: 18.489803| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 143/200 |loss: 19.121540| train set 1.410x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 144/200 |loss: 17.200006| train set 1.377x speedup, test set 4.652x speedup, val set 0.991x speedup, step: 29
Epoch 145/200 |loss: 16.287163| train set 1.476x speedup, test set 4.652x speedup, val set 0.992x speedup, step: 30
Epoch 146/200 |loss: 16.100750| train set 1.494x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 31
Epoch 147/200 |loss: 16.130951| train set 1.409x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 32
Epoch 148/200 |loss: 15.772924| train set 1.430x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 33
Epoch 149/200 |loss: 15.350812| train set 1.441x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 34
Epoch 150/200 |loss: 15.095092| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 35
Epoch 151/200 |loss: 14.800748| train set 1.496x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 36
Epoch 152/200 |loss: 14.874849| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 37
Epoch 153/200 |loss: 14.208697| train set 1.409x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 38
Epoch 154/200 |loss: 14.434241| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 39
Epoch 155/200 |loss: 13.906063| train set 1.470x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 40
Epoch 156/200 |loss: 14.011934| train set 1.511x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 41
Epoch 157/200 |loss: 13.651009| train set 1.470x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 42
Epoch 158/200 |loss: 13.746332| train set 1.526x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 43
Epoch 159/200 |loss: 13.350832| train set 1.452x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 44
Epoch 160/200 |loss: 13.359658| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 45
Epoch 161/200 |loss: 13.079335| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 46
Epoch 162/200 |loss: 13.103926| train set 1.437x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 47
Epoch 163/200 |loss: 12.937656| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 48
Epoch 164/200 |loss: 12.859587| train set 1.513x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 49
Epoch 165/200 |loss: 12.711956| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 50
Epoch 166/200 |loss: 12.638961| train set 1.545x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 51
Epoch 167/200 |loss: 12.477680| train set 1.564x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 52
Epoch 168/200 |loss: 12.439226| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 53
Epoch 169/200 |loss: 12.324275| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 54
Epoch 170/200 |loss: 12.286031| train set 1.526x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 55
Epoch 171/200 |loss: 12.181659| train set 1.526x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 56
Epoch 172/200 |loss: 12.121285| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 57
Epoch 173/200 |loss: 12.094477| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 58
Epoch 174/200 |loss: 12.071130| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 59
Epoch 175/200 |loss: 12.276292| train set 1.449x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 176/200 |loss: 12.925018| train set 1.525x speedup, test set 4.652x speedup, val set 0.996x speedup, step: 2
Epoch 177/200 |loss: 13.060118| train set 1.536x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 178/200 |loss: 12.896490| train set 1.507x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 179/200 |loss: 12.023637| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 180/200 |loss: 11.930930| train set 1.554x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 181/200 |loss: 12.297061| train set 1.542x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 182/200 |loss: 12.025108| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 183/200 |loss: 11.654181| train set 1.552x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 184/200 |loss: 11.760237| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 185/200 |loss: 11.925189| train set 1.564x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 186/200 |loss: 11.876228| train set 1.526x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 187/200 |loss: 12.221529| train set 1.490x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 188/200 |loss: 13.425567| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 189/200 |loss: 16.764963| train set 1.472x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 190/200 |loss: 13.422421| train set 1.512x speedup, test set 4.652x speedup, val set 0.996x speedup, step: 14
Epoch 191/200 |loss: 16.231684| train set 1.502x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 192/200 |loss: 15.866817| train set 1.375x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 193/200 |loss: 16.382736| train set 1.549x speedup, test set 4.652x speedup, val set 0.992x speedup, step: 17
Epoch 194/200 |loss: 14.279782| train set 1.481x speedup, test set 4.652x speedup, val set 0.744x speedup, step: 18
Epoch 195/200 |loss: 15.086760| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 196/200 |loss: 13.921478| train set 1.471x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 197/200 |loss: 14.175352| train set 1.484x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 198/200 |loss: 13.632612| train set 1.550x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 199/200 |loss: 13.124895| train set 1.485x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Training per epoch cost 0.330 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 185, train speedup 1.564, test speedup 4.652, val speedup 0.997
best test speedup epoch: 19, train speedup 1.216, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 177, train speedup 1.536, test speedup 4.652, val speedup 1.008
last model at epoch 199, train speedup 1.485, test speedup 4.652, val speedup 0.997
execution cost 0:02:52.625416
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.177378, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091705| train set 1.161x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809984| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533436| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.277758| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.015848| train set 1.153x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.785658| train set 1.192x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.561914| train set 1.173x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.388575| train set 1.238x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.177359| train set 1.219x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.922197| train set 1.219x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.651875| train set 1.207x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.465311| train set 1.205x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.309349| train set 1.204x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.083984| train set 1.183x speedup, test set 8.391x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.862427| train set 1.187x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.707520| train set 1.201x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.615187| train set 1.188x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.333172| train set 1.168x speedup, test set 8.636x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.197824| train set 1.145x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 25.276859| train set 1.168x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.810820| train set 1.180x speedup, test set 6.982x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.517540| train set 1.179x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.608978| train set 1.181x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.273958| train set 1.239x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.024544| train set 1.199x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 23.970001| train set 1.242x speedup, test set 5.905x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.770258| train set 1.227x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.439543| train set 1.223x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.310286| train set 1.305x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.302103| train set 1.255x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.166927| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.426138| train set 1.234x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.821985| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.260183| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.855154| train set 1.259x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 23.025251| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.342386| train set 1.245x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.682617| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.122198| train set 1.319x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.412292| train set 1.324x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 50
Epoch 50/200 |loss: 21.813082| train set 1.312x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 22.190573| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.315001| train set 1.287x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.610363| train set 1.325x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.198715| train set 1.328x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 21.219934| train set 1.326x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 20.929710| train set 1.366x speedup, test set 4.641x speedup, val set 0.931x speedup, step: 57
Epoch 57/200 |loss: 21.061087| train set 1.327x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.992775| train set 1.391x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 20.882694| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.418360| train set 1.352x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.180323| train set 1.342x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.308367| train set 1.384x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.165407| train set 1.393x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.048693| train set 1.307x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 19.924765| train set 1.379x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 19.246906| train set 1.399x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 19.393639| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.613132| train set 1.486x speedup, test set 4.836x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 20.267139| train set 1.354x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 20.870436| train set 1.410x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 20.377560| train set 1.344x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.773169| train set 1.344x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.598835| train set 1.448x speedup, test set 4.641x speedup, val set 0.739x speedup, step: 74
Epoch 74/200 |loss: 19.305462| train set 1.388x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.105331| train set 1.340x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 18.762127| train set 1.456x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.303270| train set 1.336x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.877895| train set 1.390x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.886318| train set 1.494x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.751261| train set 1.410x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.487152| train set 1.397x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 17.773853| train set 1.382x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.097752| train set 1.394x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 17.749941| train set 1.389x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.921284| train set 1.495x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.530960| train set 1.390x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.764704| train set 1.400x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.571487| train set 1.477x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 17.483093| train set 1.429x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.732893| train set 1.374x speedup, test set 4.665x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 18.012608| train set 1.415x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.411989| train set 1.428x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 16.959806| train set 1.385x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 16.496237| train set 1.448x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 16.660694| train set 1.501x speedup, test set 4.665x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 16.853762| train set 1.419x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.993736| train set 1.499x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.225628| train set 1.501x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.561417| train set 1.368x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 17.149206| train set 1.479x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.848927| train set 1.423x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 17.034317| train set 1.388x speedup, test set 4.751x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.558298| train set 1.495x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 15.716122| train set 1.534x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.273224| train set 1.465x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.136002| train set 1.385x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 15.574080| train set 1.520x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.021734| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.793303| train set 1.413x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.633440| train set 1.504x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.576458| train set 1.416x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.059440| train set 1.491x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 14.812963| train set 1.465x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 2
Epoch 114/200 |loss: 15.101353| train set 1.427x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 14.737797| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 14.613560| train set 1.539x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 14.595322| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 14.642631| train set 1.447x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 15.171931| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 19.441027| train set 1.359x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 18.215416| train set 1.427x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 15.546764| train set 1.384x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 123/200 |loss: 19.522509| train set 1.283x speedup, test set 1.573x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 17.402941| train set 1.266x speedup, test set 4.801x speedup, val set 0.842x speedup, step: 2
Epoch 125/200 |loss: 20.001070| train set 1.487x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 17.580711| train set 1.479x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 127/200 |loss: 18.048037| train set 1.517x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 16.659508| train set 1.394x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 129/200 |loss: 17.194677| train set 1.409x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 16.244690| train set 1.462x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 16.553576| train set 1.529x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 15.552355| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 16.023741| train set 1.370x speedup, test set 4.676x speedup, val set 0.997x speedup, step: 1
Epoch 134/200 |loss: 15.283630| train set 1.539x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 15.314074| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 15.000998| train set 1.481x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 137/200 |loss: 14.980790| train set 1.411x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 138/200 |loss: 14.705755| train set 1.505x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 14.433187| train set 1.462x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 140/200 |loss: 14.367333| train set 1.446x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 141/200 |loss: 14.246504| train set 1.492x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 142/200 |loss: 13.995343| train set 1.514x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 143/200 |loss: 13.907326| train set 1.531x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 144/200 |loss: 13.786346| train set 1.506x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 145/200 |loss: 13.640953| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 146/200 |loss: 13.578076| train set 1.505x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 147/200 |loss: 13.440958| train set 1.543x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 148/200 |loss: 13.308257| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 149/200 |loss: 13.250931| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 150/200 |loss: 13.197228| train set 1.541x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 151/200 |loss: 13.147988| train set 1.492x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 152/200 |loss: 13.289619| train set 1.492x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 153/200 |loss: 13.401896| train set 1.504x speedup, test set 1.578x speedup, val set 1.008x speedup, step: 1
Epoch 154/200 |loss: 13.875134| train set 1.536x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 2
Epoch 155/200 |loss: 13.910317| train set 1.541x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 3
Epoch 156/200 |loss: 13.246975| train set 1.501x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 4
Epoch 157/200 |loss: 12.724233| train set 1.518x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 5
Epoch 158/200 |loss: 13.151052| train set 1.443x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 6
Epoch 159/200 |loss: 14.586060| train set 1.506x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 160/200 |loss: 13.399117| train set 1.471x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 8
Epoch 161/200 |loss: 13.355787| train set 1.541x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 9
Epoch 162/200 |loss: 13.062574| train set 1.477x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 163/200 |loss: 13.093976| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 11
Epoch 164/200 |loss: 13.230060| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 165/200 |loss: 12.796835| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 166/200 |loss: 12.840805| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 167/200 |loss: 12.741283| train set 1.535x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 15
Epoch 168/200 |loss: 12.309269| train set 1.487x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 16
Epoch 169/200 |loss: 12.598067| train set 1.543x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 170/200 |loss: 12.555235| train set 1.506x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 171/200 |loss: 12.053859| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 172/200 |loss: 11.977783| train set 1.538x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 20
Epoch 173/200 |loss: 12.155502| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 174/200 |loss: 12.179380| train set 1.559x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 22
Epoch 175/200 |loss: 12.084839| train set 1.540x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 23
Epoch 176/200 |loss: 12.395601| train set 1.540x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 24
Epoch 177/200 |loss: 12.593248| train set 1.527x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 25
Epoch 178/200 |loss: 13.837903| train set 1.524x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 26
Epoch 179/200 |loss: 11.802073| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 180/200 |loss: 12.845010| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 181/200 |loss: 15.657854| train set 1.563x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 29
Epoch 182/200 |loss: 12.385978| train set 1.496x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 30
Epoch 183/200 |loss: 16.655149| train set 1.505x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 31
Epoch 184/200 |loss: 15.994364| train set 1.499x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 32
Epoch 185/200 |loss: 15.368968| train set 1.482x speedup, test set 4.676x speedup, val set 0.992x speedup, step: 33
Epoch 186/200 |loss: 15.436951| train set 1.497x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 34
Epoch 187/200 |loss: 14.329154| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 35
Epoch 188/200 |loss: 14.717220| train set 1.472x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 36
Epoch 189/200 |loss: 13.693261| train set 1.532x speedup, test set 4.686x speedup, val set 0.997x speedup, step: 37
Epoch 190/200 |loss: 14.139840| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 38
Epoch 191/200 |loss: 13.079629| train set 1.536x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 39
Epoch 192/200 |loss: 13.569522| train set 1.539x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 40
Epoch 193/200 |loss: 12.780949| train set 1.563x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 41
Epoch 194/200 |loss: 13.129797| train set 1.563x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 42
Epoch 195/200 |loss: 12.479096| train set 1.525x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 43
Epoch 196/200 |loss: 12.732808| train set 1.556x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 44
Epoch 197/200 |loss: 12.393306| train set 1.563x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 45
Epoch 198/200 |loss: 12.448244| train set 1.520x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 46
Epoch 199/200 |loss: 12.076268| train set 1.546x speedup, test set 1.578x speedup, val set 0.997x speedup, step: 47
Training per epoch cost 0.315 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 591.328s, pg runtime 601.866s, speedup 1.018x
22, opt runtime 24.079s, model runtime 593.507s, pg runtime 608.707s, speedup 1.026x
23, opt runtime 24.662s, model runtime 615.484s, pg runtime 613.999s, speedup 0.998x
24, opt runtime 24.459s, model runtime 600.619s, pg runtime 608.717s, speedup 1.013x
25, opt runtime 25.236s, model runtime 598.639s, pg runtime 601.756s, speedup 1.005x
26, opt runtime 25.363s, model runtime 582.756s, pg runtime 611.327s, speedup 1.049x
27, opt runtime 24.706s, model runtime 591.577s, pg runtime 610.808s, speedup 1.033x
28, opt runtime 25.075s, model runtime 581.600s, pg runtime 612.430s, speedup 1.053x
29, opt runtime 24.840s, model runtime 605.138s, pg runtime 626.529s, speedup 1.035x
30, opt runtime 24.920s, model runtime 585.852s, pg runtime 610.993s, speedup 1.043x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 194, train speedup 1.563, test speedup 1.578, val speedup 0.997
best test speedup epoch: 16, train speedup 1.173, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 153, train speedup 1.504, test speedup 1.578, val speedup 1.008
last model at epoch 199, train speedup 1.546, test speedup 1.578, val speedup 0.997
execution cost 0:02:51.847722
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.111783, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787601| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079838| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695999| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379662| train set 1.115x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083626| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800457| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.531763| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.288736| train set 1.152x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.017035| train set 1.173x speedup, test set 6.106x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.760929| train set 1.155x speedup, test set 7.264x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.507746| train set 1.210x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.280088| train set 1.237x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.074284| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 27.041264| train set 1.217x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.968521| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.540522| train set 1.204x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.292778| train set 1.224x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.236629| train set 1.201x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.830103| train set 1.178x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.782066| train set 1.225x speedup, test set 6.921x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.600159| train set 1.195x speedup, test set 9.145x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.300207| train set 1.183x speedup, test set 8.636x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.283939| train set 1.196x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 29
Epoch 29/200 |loss: 25.013313| train set 1.227x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 24.732166| train set 1.222x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.651791| train set 1.200x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 32
Epoch 32/200 |loss: 24.525444| train set 1.205x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.305601| train set 1.227x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 34
Epoch 34/200 |loss: 24.263201| train set 1.182x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.419701| train set 1.206x speedup, test set 5.685x speedup, val set 0.932x speedup, step: 36
Epoch 36/200 |loss: 24.144474| train set 1.231x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 37
Epoch 37/200 |loss: 23.645803| train set 1.241x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.771145| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 39
Epoch 39/200 |loss: 23.302513| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.132347| train set 1.259x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.148438| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.761354| train set 1.305x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 22.708529| train set 1.305x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.886673| train set 1.280x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.743288| train set 1.231x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.895086| train set 1.313x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 47
Epoch 47/200 |loss: 22.253424| train set 1.319x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 48
Epoch 48/200 |loss: 22.081247| train set 1.311x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 49
Epoch 49/200 |loss: 22.114685| train set 1.280x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 50
Epoch 50/200 |loss: 21.802589| train set 1.307x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 51
Epoch 51/200 |loss: 21.764139| train set 1.324x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 52
Epoch 52/200 |loss: 21.476677| train set 1.338x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 21.303385| train set 1.328x speedup, test set 4.836x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 21.250969| train set 1.314x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 20.793222| train set 1.306x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 20.807941| train set 1.342x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 20.810894| train set 1.306x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 20.682995| train set 1.328x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 22.081491| train set 1.328x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 21.095955| train set 1.391x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 61
Epoch 61/200 |loss: 20.401596| train set 1.343x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.727495| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.324572| train set 1.344x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.148861| train set 1.342x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.007463| train set 1.391x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 19.889557| train set 1.345x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 19.823853| train set 1.306x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.599190| train set 1.393x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.394836| train set 1.356x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.773382| train set 1.392x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 19.301821| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 18.984798| train set 1.343x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 18.715172| train set 1.392x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 18.754601| train set 1.346x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 18.915461| train set 1.350x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 18.443922| train set 1.393x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.692232| train set 1.317x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 20.835793| train set 1.409x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 21.883343| train set 1.345x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 19.344093| train set 1.270x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 22.043068| train set 1.374x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 19.444868| train set 1.385x speedup, test set 4.641x speedup, val set 0.701x speedup, step: 83
Epoch 83/200 |loss: 20.668411| train set 1.264x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 19.085329| train set 1.260x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 20.379980| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 18.175900| train set 1.338x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 19.688084| train set 1.350x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 18.242992| train set 1.346x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 19.051741| train set 1.393x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 90
Epoch 90/200 |loss: 18.191338| train set 1.415x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 18.131693| train set 1.416x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 17.797867| train set 1.403x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.909550| train set 1.398x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.415697| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 17.702078| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 17.070347| train set 1.410x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 97
Epoch 97/200 |loss: 17.154762| train set 1.501x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 98
Epoch 98/200 |loss: 16.897848| train set 1.350x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 99
Epoch 99/200 |loss: 16.850271| train set 1.400x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.670948| train set 1.413x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.455095| train set 1.416x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.317398| train set 1.415x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.140514| train set 1.416x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.065096| train set 1.416x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 15.977095| train set 1.447x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.067053| train set 1.507x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.718210| train set 1.399x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 18.194742| train set 1.485x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 16.639284| train set 1.501x speedup, test set 4.675x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 16.114267| train set 1.410x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 16.901686| train set 1.405x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.631246| train set 1.501x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 16.142715| train set 1.411x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 16.472685| train set 1.416x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 15.685096| train set 1.496x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 16.360243| train set 1.432x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 15.180872| train set 1.388x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 15.652186| train set 1.474x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 15.394354| train set 1.415x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 15.185382| train set 1.414x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 15.336599| train set 1.420x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 14.602555| train set 1.502x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 14.920536| train set 1.416x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 14.526762| train set 1.417x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 14.947612| train set 1.471x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 15.315514| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 17.577415| train set 1.405x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 15.209640| train set 1.421x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 129/200 |loss: 16.279619| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 18.670647| train set 1.394x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 16.431580| train set 1.339x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 132/200 |loss: 17.426472| train set 1.482x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 133/200 |loss: 15.840575| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 134/200 |loss: 16.094725| train set 1.344x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 3
Epoch 135/200 |loss: 15.786368| train set 1.412x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 4
Epoch 136/200 |loss: 15.698246| train set 1.467x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 137/200 |loss: 15.241175| train set 1.438x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 138/200 |loss: 14.961370| train set 1.401x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 7
Epoch 139/200 |loss: 14.844068| train set 1.401x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 8
Epoch 140/200 |loss: 14.779810| train set 1.417x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 9
Epoch 141/200 |loss: 14.141948| train set 1.525x speedup, test set 4.773x speedup, val set 0.997x speedup, step: 10
Epoch 142/200 |loss: 14.478757| train set 1.542x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 11
Epoch 143/200 |loss: 14.097748| train set 1.416x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 12
Epoch 144/200 |loss: 14.218613| train set 1.451x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 13
Epoch 145/200 |loss: 13.805729| train set 1.500x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 14
Epoch 146/200 |loss: 13.903362| train set 1.500x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 15
Epoch 147/200 |loss: 13.660716| train set 1.503x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 16
Epoch 148/200 |loss: 13.452816| train set 1.544x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 17
Epoch 149/200 |loss: 13.426715| train set 1.514x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 150/200 |loss: 13.324828| train set 1.470x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 151/200 |loss: 13.084986| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 152/200 |loss: 13.187337| train set 1.451x speedup, test set 4.650x speedup, val set 0.997x speedup, step: 21
Epoch 153/200 |loss: 12.949480| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 154/200 |loss: 13.005637| train set 1.534x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 23
Epoch 155/200 |loss: 13.122366| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 156/200 |loss: 13.994305| train set 1.442x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 1
Epoch 157/200 |loss: 15.166555| train set 1.482x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 158/200 |loss: 14.571812| train set 1.541x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 3
Epoch 159/200 |loss: 13.345444| train set 1.448x speedup, test set 4.641x speedup, val set 1.008x speedup, step: 1
Epoch 160/200 |loss: 13.446858| train set 1.521x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 2
Epoch 161/200 |loss: 14.082973| train set 1.505x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 3
Epoch 162/200 |loss: 13.090417| train set 1.503x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 4
Epoch 163/200 |loss: 13.092922| train set 1.509x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 5
Epoch 164/200 |loss: 13.185863| train set 1.503x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 6
Epoch 165/200 |loss: 12.478032| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 166/200 |loss: 12.738131| train set 1.489x speedup, test set 4.650x speedup, val set 0.997x speedup, step: 8
Epoch 167/200 |loss: 12.782632| train set 1.541x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 168/200 |loss: 12.485965| train set 1.544x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 169/200 |loss: 12.731783| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 170/200 |loss: 13.226445| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 171/200 |loss: 12.464192| train set 1.544x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 172/200 |loss: 12.282927| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 173/200 |loss: 12.266664| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 174/200 |loss: 12.211706| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 175/200 |loss: 12.178487| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 176/200 |loss: 12.470217| train set 1.541x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 177/200 |loss: 13.388587| train set 1.493x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 178/200 |loss: 12.256430| train set 1.565x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 179/200 |loss: 11.874930| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 180/200 |loss: 11.899976| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 181/200 |loss: 12.043914| train set 1.541x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 182/200 |loss: 12.256298| train set 1.559x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 183/200 |loss: 12.199413| train set 1.489x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 25
Epoch 184/200 |loss: 12.393347| train set 1.544x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 26
Epoch 185/200 |loss: 11.855533| train set 1.525x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 186/200 |loss: 11.689416| train set 1.503x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 28
Epoch 187/200 |loss: 12.126787| train set 1.563x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 29
Epoch 188/200 |loss: 11.831165| train set 1.521x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 30
Epoch 189/200 |loss: 11.648572| train set 1.534x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 31
Epoch 190/200 |loss: 11.464620| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 32
Epoch 191/200 |loss: 11.551780| train set 1.560x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 33
Epoch 192/200 |loss: 12.044936| train set 1.566x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 34
Epoch 193/200 |loss: 11.525621| train set 1.565x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 35
Epoch 194/200 |loss: 11.241024| train set 1.561x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 36
Epoch 195/200 |loss: 11.110371| train set 1.525x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 37
Epoch 196/200 |loss: 11.232654| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 38
Epoch 197/200 |loss: 11.704538| train set 1.525x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 39
Epoch 198/200 |loss: 11.696583| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 40
Epoch 199/200 |loss: 11.927913| train set 1.493x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 41
Training per epoch cost 0.322 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 192, train speedup 1.566, test speedup 4.652, val speedup 0.997
best test speedup epoch: 18, train speedup 1.216, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 159, train speedup 1.448, test speedup 4.641, val speedup 1.008
last model at epoch 199, train speedup 1.493, test speedup 4.652, val speedup 0.997
execution cost 0:02:54.347789
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.165426, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159269| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787601| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695995| train set 1.089x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379738| train set 1.115x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.084053| train set 1.161x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800257| train set 1.148x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.532270| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.290142| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.021618| train set 1.169x speedup, test set 6.345x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.765923| train set 1.155x speedup, test set 7.264x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.510796| train set 1.192x speedup, test set 6.675x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.288643| train set 1.236x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.106588| train set 1.216x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 27.088417| train set 1.207x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.855104| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.444927| train set 1.216x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.281021| train set 1.224x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.151361| train set 1.204x speedup, test set 9.635x speedup, val set 0.932x speedup, step: 24
Epoch 24/200 |loss: 25.820848| train set 1.179x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 25
Epoch 25/200 |loss: 25.611515| train set 1.187x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.523878| train set 1.208x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.322378| train set 1.207x speedup, test set 8.197x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.010847| train set 1.227x speedup, test set 5.685x speedup, val set 0.932x speedup, step: 29
Epoch 29/200 |loss: 24.818542| train set 1.198x speedup, test set 8.197x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.772264| train set 1.200x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.849142| train set 1.220x speedup, test set 9.145x speedup, val set 0.931x speedup, step: 32
Epoch 32/200 |loss: 25.166798| train set 1.207x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 33
Epoch 33/200 |loss: 25.014061| train set 1.228x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 34
Epoch 34/200 |loss: 24.535515| train set 1.235x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.636938| train set 1.231x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 36
Epoch 36/200 |loss: 23.840805| train set 1.229x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 37
Epoch 37/200 |loss: 24.234612| train set 1.230x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.545225| train set 1.243x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.829189| train set 1.232x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.166939| train set 1.230x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.417614| train set 1.305x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 22.808462| train set 1.245x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 23.051702| train set 1.304x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.528822| train set 1.230x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.585487| train set 1.306x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.260387| train set 1.299x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 47
Epoch 47/200 |loss: 22.090000| train set 1.311x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 48
Epoch 48/200 |loss: 22.027828| train set 1.312x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 49
Epoch 49/200 |loss: 21.734396| train set 1.330x speedup, test set 5.685x speedup, val set 0.931x speedup, step: 50
Epoch 50/200 |loss: 22.001806| train set 1.323x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 23.095778| train set 1.245x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 52
Epoch 52/200 |loss: 22.531868| train set 1.332x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 21.683050| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 21.370750| train set 1.327x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 21.738586| train set 1.340x speedup, test set 5.685x speedup, val set 0.701x speedup, step: 56
Epoch 56/200 |loss: 21.276423| train set 1.326x speedup, test set 4.747x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 20.788214| train set 1.327x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 21.031841| train set 1.344x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 20.806444| train set 1.344x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.229630| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.675760| train set 1.392x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.278719| train set 1.392x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 19.848364| train set 1.328x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.145149| train set 1.387x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.172327| train set 1.306x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 19.448509| train set 1.326x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 19.784248| train set 1.391x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.634726| train set 1.330x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.219545| train set 1.398x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.504923| train set 1.340x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 20.012613| train set 1.439x speedup, test set 5.685x speedup, val set 0.736x speedup, step: 72
Epoch 72/200 |loss: 20.108196| train set 1.309x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 20.667747| train set 1.394x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 18.579262| train set 1.429x speedup, test set 5.685x speedup, val set 0.739x speedup, step: 75
Epoch 75/200 |loss: 19.781511| train set 1.339x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 19.199535| train set 1.394x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.819324| train set 1.399x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 19.027933| train set 1.400x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 18.306091| train set 1.394x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.485840| train set 1.354x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 18.291994| train set 1.430x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 17.864033| train set 1.398x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 18.256870| train set 1.400x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 18.301199| train set 1.342x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 19.118223| train set 1.415x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 18.762051| train set 1.399x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.492701| train set 1.378x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 18.928276| train set 1.500x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 89
Epoch 89/200 |loss: 19.214365| train set 1.340x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 90
Epoch 90/200 |loss: 18.312628| train set 1.359x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 19.133642| train set 1.425x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 92
Epoch 92/200 |loss: 18.077871| train set 1.400x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 18.733770| train set 1.398x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.840542| train set 1.408x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 17.854548| train set 1.414x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 17.604774| train set 1.399x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.223038| train set 1.512x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 17.504620| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.805107| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 17.264786| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.334030| train set 1.404x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 17.186789| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.831039| train set 1.414x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.421740| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.272655| train set 1.502x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 106/200 |loss: 16.032625| train set 1.397x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 107/200 |loss: 16.390116| train set 1.400x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 108/200 |loss: 15.739264| train set 1.506x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 109/200 |loss: 15.758423| train set 1.414x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 110/200 |loss: 15.779217| train set 1.416x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 111/200 |loss: 15.384015| train set 1.419x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 112/200 |loss: 15.645694| train set 1.416x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 113/200 |loss: 15.295253| train set 1.387x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 114/200 |loss: 15.132092| train set 1.499x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 115/200 |loss: 15.044820| train set 1.415x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 116/200 |loss: 14.945539| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 117/200 |loss: 14.790840| train set 1.526x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 118/200 |loss: 14.871541| train set 1.468x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 119/200 |loss: 15.278568| train set 1.429x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 120/200 |loss: 15.732239| train set 1.434x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 4
Epoch 121/200 |loss: 18.211763| train set 1.270x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 122/200 |loss: 19.773781| train set 1.389x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 123/200 |loss: 15.620011| train set 1.394x speedup, test set 4.652x speedup, val set 0.738x speedup, step: 2
Epoch 124/200 |loss: 20.388577| train set 1.343x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 125/200 |loss: 16.360048| train set 1.402x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 126/200 |loss: 17.905945| train set 1.446x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 127/200 |loss: 16.027414| train set 1.478x speedup, test set 4.652x speedup, val set 0.739x speedup, step: 2
Epoch 128/200 |loss: 16.991770| train set 1.516x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 129/200 |loss: 16.313889| train set 1.401x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 130/200 |loss: 15.640425| train set 1.410x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 131/200 |loss: 15.739011| train set 1.424x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 1
Epoch 132/200 |loss: 15.314311| train set 1.498x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 1
Epoch 133/200 |loss: 15.092975| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 134/200 |loss: 15.110332| train set 1.499x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 135/200 |loss: 14.656977| train set 1.448x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 136/200 |loss: 14.621323| train set 1.438x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 5
Epoch 137/200 |loss: 14.621334| train set 1.480x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 138/200 |loss: 14.196323| train set 1.480x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 139/200 |loss: 14.138686| train set 1.464x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 140/200 |loss: 14.097587| train set 1.471x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 141/200 |loss: 13.818621| train set 1.475x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 142/200 |loss: 13.856779| train set 1.495x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 143/200 |loss: 13.599936| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 144/200 |loss: 13.667054| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 145/200 |loss: 13.596280| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 146/200 |loss: 13.904129| train set 1.449x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 147/200 |loss: 15.062054| train set 1.487x speedup, test set 4.652x speedup, val set 0.994x speedup, step: 16
Epoch 148/200 |loss: 14.638586| train set 1.536x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 149/200 |loss: 14.173481| train set 1.500x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 150/200 |loss: 13.206401| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 151/200 |loss: 13.674085| train set 1.539x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 152/200 |loss: 14.546027| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 153/200 |loss: 13.095130| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 154/200 |loss: 13.904438| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 155/200 |loss: 15.376051| train set 1.403x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Epoch 156/200 |loss: 13.252695| train set 1.501x speedup, test set 4.652x speedup, val set 0.982x speedup, step: 25
Epoch 157/200 |loss: 15.901306| train set 1.495x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 26
Epoch 158/200 |loss: 15.193790| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 27
Epoch 159/200 |loss: 14.587085| train set 1.413x speedup, test set 4.652x speedup, val set 0.992x speedup, step: 28
Epoch 160/200 |loss: 15.097397| train set 1.509x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 29
Epoch 161/200 |loss: 13.409361| train set 1.518x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 30
Epoch 162/200 |loss: 14.332048| train set 1.469x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 31
Epoch 163/200 |loss: 13.349422| train set 1.470x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 32
Epoch 164/200 |loss: 13.780766| train set 1.468x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 33
Epoch 165/200 |loss: 13.250597| train set 1.523x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 34
Epoch 166/200 |loss: 13.430937| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 35
Epoch 167/200 |loss: 13.155348| train set 1.530x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 36
Epoch 168/200 |loss: 12.928934| train set 1.494x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 37
Epoch 169/200 |loss: 12.900567| train set 1.537x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 38
Epoch 170/200 |loss: 12.584517| train set 1.523x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 39
Epoch 171/200 |loss: 12.640814| train set 1.488x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 40
Epoch 172/200 |loss: 12.513916| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 41
Epoch 173/200 |loss: 12.336652| train set 1.523x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 42
Epoch 174/200 |loss: 12.499187| train set 1.538x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 43
Epoch 175/200 |loss: 12.488029| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 44
Epoch 176/200 |loss: 12.811763| train set 1.534x speedup, test set 4.652x speedup, val set 1.008x speedup, step: 1
Epoch 177/200 |loss: 13.433146| train set 1.487x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 2
Epoch 178/200 |loss: 13.532060| train set 1.418x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 3
Epoch 179/200 |loss: 12.702613| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 4
Epoch 180/200 |loss: 12.092568| train set 1.537x speedup, test set 4.652x speedup, val set 0.998x speedup, step: 5
Epoch 181/200 |loss: 12.813927| train set 1.531x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 6
Epoch 182/200 |loss: 12.824041| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 7
Epoch 183/200 |loss: 11.953263| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 8
Epoch 184/200 |loss: 12.183367| train set 1.505x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 9
Epoch 185/200 |loss: 12.486674| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 10
Epoch 186/200 |loss: 11.793868| train set 1.523x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 187/200 |loss: 11.909308| train set 1.545x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 12
Epoch 188/200 |loss: 11.973300| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 13
Epoch 189/200 |loss: 11.609976| train set 1.487x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 14
Epoch 190/200 |loss: 11.714975| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 15
Epoch 191/200 |loss: 11.603655| train set 1.519x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 16
Epoch 192/200 |loss: 11.501967| train set 1.557x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 17
Epoch 193/200 |loss: 11.473185| train set 1.532x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 18
Epoch 194/200 |loss: 11.334793| train set 1.520x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 19
Epoch 195/200 |loss: 11.301245| train set 1.558x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 20
Epoch 196/200 |loss: 11.312438| train set 1.525x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 21
Epoch 197/200 |loss: 11.274850| train set 1.501x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 22
Epoch 198/200 |loss: 11.463100| train set 1.540x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 23
Epoch 199/200 |loss: 12.433345| train set 1.508x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 24
Training per epoch cost 0.324 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 179, train speedup 1.558, test speedup 4.652, val speedup 0.997
best test speedup epoch: 19, train speedup 1.207, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 176, train speedup 1.534, test speedup 4.652, val speedup 1.008
last model at epoch 199, train speedup 1.508, test speedup 4.652, val speedup 0.997
execution cost 0:02:52.076346
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.116140, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 4.764x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 1.478x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 4.764x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 4.764x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083914| train set 0.788x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 4.764x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091705| train set 1.161x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809984| train set 1.148x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533661| train set 1.131x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.276472| train set 1.151x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.014822| train set 1.136x speedup, test set 5.871x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.785595| train set 1.155x speedup, test set 6.106x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.560661| train set 1.192x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.390823| train set 1.239x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.187572| train set 1.218x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.932228| train set 1.206x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.655750| train set 1.207x speedup, test set 6.975x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.470005| train set 1.205x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.336124| train set 1.205x speedup, test set 9.635x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.094580| train set 1.182x speedup, test set 8.589x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.829880| train set 1.199x speedup, test set 9.145x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.627007| train set 1.201x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.581623| train set 1.183x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.556007| train set 1.196x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.335993| train set 1.179x speedup, test set 5.685x speedup, val set 0.999x speedup, step: 29
Epoch 29/200 |loss: 24.904419| train set 1.160x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 25.005783| train set 1.164x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.852076| train set 1.179x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.329847| train set 1.162x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.580654| train set 1.199x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.079222| train set 1.225x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 23.994772| train set 1.241x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.899731| train set 1.210x speedup, test set 5.235x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.422955| train set 1.201x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.455353| train set 1.281x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.222849| train set 1.244x speedup, test set 5.685x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.244333| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 25.066902| train set 1.240x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 25.185957| train set 1.257x speedup, test set 5.685x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.864599| train set 1.230x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 24.355167| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 23.552633| train set 1.255x speedup, test set 6.982x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 23.448292| train set 1.249x speedup, test set 9.145x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 23.265257| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.706211| train set 1.231x speedup, test set 4.641x speedup, val set 0.999x speedup, step: 49
Epoch 49/200 |loss: 23.163706| train set 1.232x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.246012| train set 1.324x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 51
Epoch 51/200 |loss: 22.738768| train set 1.319x speedup, test set 4.641x speedup, val set 0.930x speedup, step: 52
Epoch 52/200 |loss: 21.999193| train set 1.305x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 22.262569| train set 1.306x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.678478| train set 1.298x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 21.878828| train set 1.307x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 21.390284| train set 1.306x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.514343| train set 1.325x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 21.083176| train set 1.328x speedup, test set 4.641x speedup, val set 0.931x speedup, step: 59
Epoch 59/200 |loss: 21.191479| train set 1.313x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.796715| train set 1.313x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.763485| train set 1.329x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.515726| train set 1.344x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.279736| train set 1.327x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.249846| train set 1.329x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.021109| train set 1.391x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 20.413759| train set 1.279x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 21.929667| train set 1.376x speedup, test set 4.764x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 20.887472| train set 1.393x speedup, test set 4.764x speedup, val set 0.739x speedup, step: 69
Epoch 69/200 |loss: 20.353294| train set 1.311x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 20.712996| train set 1.336x speedup, test set 4.641x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 19.955233| train set 1.352x speedup, test set 5.685x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 20.866783| train set 1.328x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.501171| train set 1.326x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 20.247297| train set 1.470x speedup, test set 4.641x speedup, val set 0.701x speedup, step: 75
Epoch 75/200 |loss: 19.509562| train set 1.389x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.397036| train set 1.324x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.512209| train set 1.332x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.736147| train set 1.393x speedup, test set 4.641x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 19.226074| train set 1.399x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.482193| train set 1.340x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.682852| train set 1.398x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.387789| train set 1.399x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.137699| train set 1.411x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.277443| train set 1.398x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.836231| train set 1.395x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.045849| train set 1.405x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.113102| train set 1.397x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 18.045244| train set 1.414x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.491121| train set 1.391x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.485575| train set 1.400x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.139448| train set 1.414x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.533157| train set 1.391x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.373468| train set 1.416x speedup, test set 4.764x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.310892| train set 1.374x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.561144| train set 1.420x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 16.857880| train set 1.410x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.994978| train set 1.365x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 17.368361| train set 1.502x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.939796| train set 1.395x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.269375| train set 1.410x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.632383| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.301228| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 15.932652| train set 1.379x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.632101| train set 1.390x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.850668| train set 1.476x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 2
Epoch 106/200 |loss: 18.255461| train set 1.374x speedup, test set 4.801x speedup, val set 0.994x speedup, step: 3
Epoch 107/200 |loss: 18.151751| train set 1.418x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.670868| train set 1.425x speedup, test set 4.775x speedup, val set 0.738x speedup, step: 2
Epoch 109/200 |loss: 17.880749| train set 1.311x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 17.603235| train set 1.401x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 16.165949| train set 1.460x speedup, test set 4.801x speedup, val set 0.737x speedup, step: 2
Epoch 112/200 |loss: 17.637411| train set 1.441x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.759636| train set 1.363x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 16.360332| train set 1.390x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 115/200 |loss: 15.510756| train set 1.423x speedup, test set 4.775x speedup, val set 0.998x speedup, step: 1
Epoch 116/200 |loss: 16.096947| train set 1.448x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 2
Epoch 117/200 |loss: 15.337407| train set 1.415x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 3
Epoch 118/200 |loss: 15.660931| train set 1.505x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 4
Epoch 119/200 |loss: 15.150064| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 5
Epoch 120/200 |loss: 15.253858| train set 1.437x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 6
Epoch 121/200 |loss: 15.000751| train set 1.399x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 7
Epoch 122/200 |loss: 15.164851| train set 1.472x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 8
Epoch 123/200 |loss: 15.157082| train set 1.387x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 9
Epoch 124/200 |loss: 15.925357| train set 1.403x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 10
Epoch 125/200 |loss: 15.537565| train set 1.447x speedup, test set 4.652x speedup, val set 0.997x speedup, step: 11
Epoch 126/200 |loss: 15.327787| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 12
Epoch 127/200 |loss: 14.610791| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 13
Epoch 128/200 |loss: 14.525470| train set 1.388x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 14
Epoch 129/200 |loss: 14.973914| train set 1.409x speedup, test set 4.775x speedup, val set 0.996x speedup, step: 15
Epoch 130/200 |loss: 14.496851| train set 1.447x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 16
Epoch 131/200 |loss: 14.405380| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 17
Epoch 132/200 |loss: 14.075650| train set 1.505x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 18
Epoch 133/200 |loss: 13.902229| train set 1.526x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 19
Epoch 134/200 |loss: 13.903092| train set 1.512x speedup, test set 4.775x speedup, val set 0.996x speedup, step: 20
Epoch 135/200 |loss: 14.159062| train set 1.447x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 21
Epoch 136/200 |loss: 14.648599| train set 1.529x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 22
Epoch 137/200 |loss: 14.414199| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 23
Epoch 138/200 |loss: 14.150439| train set 1.468x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 24
Epoch 139/200 |loss: 13.718007| train set 1.470x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 25
Epoch 140/200 |loss: 13.575894| train set 1.542x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 26
Epoch 141/200 |loss: 13.824777| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 27
Epoch 142/200 |loss: 13.435019| train set 1.526x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 28
Epoch 143/200 |loss: 13.099150| train set 1.542x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 29
Epoch 144/200 |loss: 13.231313| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 30
Epoch 145/200 |loss: 13.760181| train set 1.511x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 31
Epoch 146/200 |loss: 14.320162| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 32
Epoch 147/200 |loss: 15.196495| train set 1.429x speedup, test set 4.775x speedup, val set 0.996x speedup, step: 33
Epoch 148/200 |loss: 13.705334| train set 1.535x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 34
Epoch 149/200 |loss: 13.820125| train set 1.518x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 35
Epoch 150/200 |loss: 14.198515| train set 1.408x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 36
Epoch 151/200 |loss: 13.492757| train set 1.535x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 37
Epoch 152/200 |loss: 13.853089| train set 1.525x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 38
Epoch 153/200 |loss: 14.074068| train set 1.414x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 39
Epoch 154/200 |loss: 13.971671| train set 1.545x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 40
Epoch 155/200 |loss: 13.443860| train set 1.523x speedup, test set 4.775x speedup, val set 0.994x speedup, step: 41
Epoch 156/200 |loss: 13.636992| train set 1.448x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 42
Epoch 157/200 |loss: 13.360568| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 43
Epoch 158/200 |loss: 13.071866| train set 1.487x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 44
Epoch 159/200 |loss: 13.255716| train set 1.512x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 45
Epoch 160/200 |loss: 13.017680| train set 1.527x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 46
Epoch 161/200 |loss: 13.265883| train set 1.448x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 47
Epoch 162/200 |loss: 13.516963| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 48
Epoch 163/200 |loss: 13.304782| train set 1.500x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 49
Epoch 164/200 |loss: 12.959908| train set 1.545x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 50
Epoch 165/200 |loss: 12.698389| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 51
Epoch 166/200 |loss: 12.325362| train set 1.523x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 52
Epoch 167/200 |loss: 12.585696| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 53
Epoch 168/200 |loss: 12.425282| train set 1.549x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 54
Epoch 169/200 |loss: 12.407382| train set 1.556x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 55
Epoch 170/200 |loss: 12.732168| train set 1.526x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 56
Epoch 171/200 |loss: 12.511940| train set 1.501x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 57
Epoch 172/200 |loss: 12.728092| train set 1.533x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 58
Epoch 173/200 |loss: 12.422968| train set 1.558x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 59
Epoch 174/200 |loss: 12.014519| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 60
Epoch 175/200 |loss: 12.013666| train set 1.544x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 61
Epoch 176/200 |loss: 11.883007| train set 1.470x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 62
Epoch 177/200 |loss: 12.016936| train set 1.545x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 63
Epoch 178/200 |loss: 12.188010| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 64
Epoch 179/200 |loss: 13.009025| train set 1.507x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 65
Epoch 180/200 |loss: 12.713550| train set 1.537x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 66
Epoch 181/200 |loss: 12.580434| train set 1.499x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 67
Epoch 182/200 |loss: 12.080213| train set 1.562x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 68
Epoch 183/200 |loss: 12.093346| train set 1.513x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 69
Epoch 184/200 |loss: 12.555547| train set 1.545x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 70
Epoch 185/200 |loss: 11.968366| train set 1.540x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 71
Epoch 186/200 |loss: 11.592534| train set 1.545x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 72
Epoch 187/200 |loss: 11.706079| train set 1.540x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 73
Epoch 188/200 |loss: 11.824750| train set 1.545x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 74
Epoch 189/200 |loss: 11.728689| train set 1.557x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 75
Epoch 190/200 |loss: 11.646003| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 76
Epoch 191/200 |loss: 11.604760| train set 1.561x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 77
Epoch 192/200 |loss: 11.481796| train set 1.519x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 78
Epoch 193/200 |loss: 11.276362| train set 1.557x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 79
Epoch 194/200 |loss: 11.450508| train set 1.534x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 80
Epoch 195/200 |loss: 11.433883| train set 1.538x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 81
Epoch 196/200 |loss: 11.854177| train set 1.511x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 82
Epoch 197/200 |loss: 12.631386| train set 1.538x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 83
Epoch 198/200 |loss: 15.026167| train set 1.492x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 84
Epoch 199/200 |loss: 12.112683| train set 1.526x speedup, test set 4.775x speedup, val set 0.997x speedup, step: 85
Training per epoch cost 0.318 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 24.391s, pg runtime 601.866s, speedup 24.676x
22, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
23, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
24, opt runtime 24.459s, model runtime 24.459s, pg runtime 608.717s, speedup 24.887x
25, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
26, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
27, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
28, opt runtime 25.075s, model runtime 25.075s, pg runtime 612.430s, speedup 24.424x
29, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
30, opt runtime 24.920s, model runtime 24.920s, pg runtime 610.993s, speedup 24.518x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 182, train speedup 1.562, test speedup 4.775, val speedup 0.997
best test speedup epoch: 16, train speedup 1.192, test speedup 9.635, val speedup 0.999
best validation speedup epoch: 115, train speedup 1.423, test speedup 4.775, val speedup 0.998
last model at epoch 199, train speedup 1.526, test speedup 4.775, val speedup 0.997
execution cost 0:02:51.359463
==================================================
