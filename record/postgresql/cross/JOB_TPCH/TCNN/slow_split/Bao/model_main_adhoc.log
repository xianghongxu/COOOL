all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.337470, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006674| train set 0.555x speedup, test set 1.559x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006507| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006048| train set 1.119x speedup, test set 2.187x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006079| train set 0.552x speedup, test set 2.136x speedup, val set 0.789x speedup, step: 7
Epoch 8/300 |loss: 0.005356| train set 0.978x speedup, test set 2.131x speedup, val set 0.800x speedup, step: 8
Epoch 9/300 |loss: 0.004870| train set 1.116x speedup, test set 2.131x speedup, val set 0.942x speedup, step: 9
Epoch 10/300 |loss: 0.004699| train set 1.138x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004497| train set 1.254x speedup, test set 1.510x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004258| train set 1.130x speedup, test set 1.510x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.004099| train set 1.323x speedup, test set 1.467x speedup, val set 0.525x speedup, step: 13
Epoch 14/300 |loss: 0.003951| train set 1.266x speedup, test set 4.397x speedup, val set 0.518x speedup, step: 14
Epoch 15/300 |loss: 0.003590| train set 1.119x speedup, test set 5.189x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003623| train set 1.237x speedup, test set 1.491x speedup, val set 0.532x speedup, step: 16
Epoch 17/300 |loss: 0.003620| train set 1.293x speedup, test set 1.491x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003609| train set 1.271x speedup, test set 1.591x speedup, val set 0.946x speedup, step: 18
Epoch 19/300 |loss: 0.003507| train set 1.220x speedup, test set 4.225x speedup, val set 0.512x speedup, step: 19
Epoch 20/300 |loss: 0.003281| train set 1.380x speedup, test set 4.429x speedup, val set 0.535x speedup, step: 20
Epoch 21/300 |loss: 0.003097| train set 1.368x speedup, test set 1.044x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003117| train set 1.112x speedup, test set 1.877x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003070| train set 1.337x speedup, test set 1.877x speedup, val set 0.529x speedup, step: 23
Epoch 24/300 |loss: 0.002894| train set 1.366x speedup, test set 1.877x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002823| train set 1.367x speedup, test set 0.904x speedup, val set 0.538x speedup, step: 25
Epoch 26/300 |loss: 0.002694| train set 1.358x speedup, test set 0.940x speedup, val set 0.534x speedup, step: 26
Epoch 27/300 |loss: 0.002890| train set 1.332x speedup, test set 1.493x speedup, val set 0.530x speedup, step: 27
Epoch 28/300 |loss: 0.002522| train set 1.345x speedup, test set 1.060x speedup, val set 0.535x speedup, step: 28
Epoch 29/300 |loss: 0.002287| train set 1.356x speedup, test set 1.485x speedup, val set 0.535x speedup, step: 29
Epoch 30/300 |loss: 0.002151| train set 1.342x speedup, test set 1.040x speedup, val set 0.530x speedup, step: 30
Epoch 31/300 |loss: 0.002203| train set 1.414x speedup, test set 1.406x speedup, val set 0.530x speedup, step: 31
Epoch 32/300 |loss: 0.002283| train set 1.257x speedup, test set 1.883x speedup, val set 0.526x speedup, step: 32
Epoch 33/300 |loss: 0.003260| train set 1.308x speedup, test set 1.865x speedup, val set 0.526x speedup, step: 33
Epoch 34/300 |loss: 0.002125| train set 1.385x speedup, test set 1.951x speedup, val set 0.526x speedup, step: 34
Epoch 35/300 |loss: 0.002028| train set 1.331x speedup, test set 1.918x speedup, val set 0.530x speedup, step: 35
Epoch 36/300 |loss: 0.001903| train set 1.270x speedup, test set 2.008x speedup, val set 0.535x speedup, step: 36
Epoch 37/300 |loss: 0.002104| train set 1.385x speedup, test set 2.052x speedup, val set 0.530x speedup, step: 37
Epoch 38/300 |loss: 0.001988| train set 1.286x speedup, test set 1.112x speedup, val set 0.535x speedup, step: 38
Epoch 39/300 |loss: 0.001869| train set 1.342x speedup, test set 1.977x speedup, val set 0.535x speedup, step: 39
Epoch 40/300 |loss: 0.001834| train set 1.269x speedup, test set 1.936x speedup, val set 0.483x speedup, step: 40
Epoch 41/300 |loss: 0.002046| train set 1.363x speedup, test set 1.609x speedup, val set 0.535x speedup, step: 41
Epoch 42/300 |loss: 0.001889| train set 1.301x speedup, test set 1.040x speedup, val set 0.533x speedup, step: 42
Epoch 43/300 |loss: 0.002079| train set 1.355x speedup, test set 1.051x speedup, val set 0.540x speedup, step: 43
Epoch 44/300 |loss: 0.001920| train set 1.329x speedup, test set 0.960x speedup, val set 0.967x speedup, step: 44
Epoch 45/300 |loss: 0.001834| train set 1.323x speedup, test set 1.923x speedup, val set 0.524x speedup, step: 45
Epoch 46/300 |loss: 0.001930| train set 1.426x speedup, test set 1.856x speedup, val set 0.530x speedup, step: 46
Epoch 47/300 |loss: 0.001829| train set 1.397x speedup, test set 1.469x speedup, val set 0.530x speedup, step: 47
Epoch 48/300 |loss: 0.001641| train set 1.388x speedup, test set 0.895x speedup, val set 0.521x speedup, step: 48
Epoch 49/300 |loss: 0.001745| train set 1.417x speedup, test set 1.385x speedup, val set 0.530x speedup, step: 49
Epoch 50/300 |loss: 0.001496| train set 1.383x speedup, test set 1.448x speedup, val set 0.533x speedup, step: 50
Epoch 51/300 |loss: 0.001591| train set 1.342x speedup, test set 1.385x speedup, val set 0.540x speedup, step: 51
Epoch 52/300 |loss: 0.001411| train set 1.392x speedup, test set 1.967x speedup, val set 0.530x speedup, step: 52
Epoch 53/300 |loss: 0.001352| train set 1.380x speedup, test set 1.967x speedup, val set 0.530x speedup, step: 53
Epoch 54/300 |loss: 0.001307| train set 1.361x speedup, test set 1.967x speedup, val set 0.538x speedup, step: 54
Epoch 55/300 |loss: 0.001249| train set 1.367x speedup, test set 1.967x speedup, val set 0.543x speedup, step: 55
Epoch 56/300 |loss: 0.001152| train set 1.404x speedup, test set 1.981x speedup, val set 0.540x speedup, step: 56
Epoch 57/300 |loss: 0.001517| train set 1.308x speedup, test set 1.829x speedup, val set 0.838x speedup, step: 57
Epoch 58/300 |loss: 0.001788| train set 1.363x speedup, test set 1.529x speedup, val set 0.823x speedup, step: 58
Epoch 59/300 |loss: 0.001566| train set 1.410x speedup, test set 2.042x speedup, val set 0.535x speedup, step: 59
early stopping at epoch 59
Training per epoch cost 2.534 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 46, train speedup 1.426, test speedup 1.856, val speedup 0.530
best test speedup epoch: 15, train speedup 1.119, test speedup 5.189, val speedup 0.518
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 59, train speedup 1.410, test speedup 2.042, val speedup 0.535
execution cost 0:04:11.654387
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.361893, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 0.979x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 1.085x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005303| train set 0.941x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004851| train set 1.114x speedup, test set 2.131x speedup, val set 0.808x speedup, step: 9
Epoch 10/300 |loss: 0.004619| train set 1.079x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004475| train set 1.221x speedup, test set 1.561x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004280| train set 1.137x speedup, test set 1.491x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004002| train set 1.272x speedup, test set 1.467x speedup, val set 0.507x speedup, step: 13
Epoch 14/300 |loss: 0.003838| train set 1.275x speedup, test set 4.884x speedup, val set 0.518x speedup, step: 14
Epoch 15/300 |loss: 0.003563| train set 1.104x speedup, test set 4.176x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003704| train set 1.325x speedup, test set 1.559x speedup, val set 0.532x speedup, step: 16
Epoch 17/300 |loss: 0.003404| train set 1.273x speedup, test set 1.467x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003549| train set 1.287x speedup, test set 1.492x speedup, val set 0.530x speedup, step: 18
Epoch 19/300 |loss: 0.003351| train set 1.290x speedup, test set 0.885x speedup, val set 0.508x speedup, step: 19
Epoch 20/300 |loss: 0.003157| train set 1.362x speedup, test set 1.031x speedup, val set 0.539x speedup, step: 20
Epoch 21/300 |loss: 0.003226| train set 1.316x speedup, test set 1.031x speedup, val set 0.526x speedup, step: 21
Epoch 22/300 |loss: 0.003317| train set 1.137x speedup, test set 1.775x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003341| train set 1.250x speedup, test set 1.835x speedup, val set 0.522x speedup, step: 23
Epoch 24/300 |loss: 0.002920| train set 1.296x speedup, test set 1.835x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002611| train set 1.355x speedup, test set 1.038x speedup, val set 0.534x speedup, step: 25
Epoch 26/300 |loss: 0.002835| train set 1.334x speedup, test set 1.047x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.003024| train set 1.331x speedup, test set 1.237x speedup, val set 0.519x speedup, step: 27
Epoch 28/300 |loss: 0.002922| train set 1.317x speedup, test set 1.043x speedup, val set 0.530x speedup, step: 28
Epoch 29/300 |loss: 0.002382| train set 1.371x speedup, test set 1.047x speedup, val set 0.519x speedup, step: 29
Epoch 30/300 |loss: 0.002240| train set 1.300x speedup, test set 1.058x speedup, val set 0.529x speedup, step: 30
Epoch 31/300 |loss: 0.002195| train set 1.357x speedup, test set 1.034x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002344| train set 1.306x speedup, test set 1.044x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002990| train set 1.357x speedup, test set 1.824x speedup, val set 0.518x speedup, step: 33
Epoch 34/300 |loss: 0.002170| train set 1.397x speedup, test set 1.044x speedup, val set 0.519x speedup, step: 34
Epoch 35/300 |loss: 0.002042| train set 1.398x speedup, test set 1.308x speedup, val set 0.527x speedup, step: 35
Epoch 36/300 |loss: 0.001964| train set 1.376x speedup, test set 1.308x speedup, val set 0.526x speedup, step: 36
Epoch 37/300 |loss: 0.002268| train set 1.381x speedup, test set 1.051x speedup, val set 0.529x speedup, step: 37
Epoch 38/300 |loss: 0.002038| train set 1.337x speedup, test set 1.308x speedup, val set 0.510x speedup, step: 38
Epoch 39/300 |loss: 0.002073| train set 1.392x speedup, test set 0.856x speedup, val set 0.526x speedup, step: 39
Epoch 40/300 |loss: 0.001850| train set 1.371x speedup, test set 1.038x speedup, val set 0.534x speedup, step: 40
Epoch 41/300 |loss: 0.002079| train set 1.378x speedup, test set 1.066x speedup, val set 0.508x speedup, step: 41
Epoch 42/300 |loss: 0.001846| train set 1.312x speedup, test set 0.865x speedup, val set 0.515x speedup, step: 42
Epoch 43/300 |loss: 0.002135| train set 1.367x speedup, test set 0.863x speedup, val set 0.539x speedup, step: 43
Epoch 44/300 |loss: 0.002053| train set 1.390x speedup, test set 1.066x speedup, val set 0.519x speedup, step: 44
early stopping at epoch 44
Training per epoch cost 2.513 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 35, train speedup 1.398, test speedup 1.308, val speedup 0.527
best test speedup epoch: 14, train speedup 1.275, test speedup 4.884, val speedup 0.518
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 44, train speedup 1.390, test speedup 1.066, val speedup 0.519
execution cost 0:03:10.428921
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.807852, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 0.979x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 1.085x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005307| train set 0.940x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004853| train set 1.148x speedup, test set 2.154x speedup, val set 0.808x speedup, step: 9
Epoch 10/300 |loss: 0.004635| train set 1.133x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004464| train set 1.229x speedup, test set 1.486x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004268| train set 1.085x speedup, test set 1.477x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004023| train set 1.321x speedup, test set 1.467x speedup, val set 0.507x speedup, step: 13
Epoch 14/300 |loss: 0.003844| train set 1.285x speedup, test set 4.884x speedup, val set 0.503x speedup, step: 14
Epoch 15/300 |loss: 0.003583| train set 1.219x speedup, test set 4.884x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003697| train set 1.239x speedup, test set 3.685x speedup, val set 0.530x speedup, step: 16
Epoch 17/300 |loss: 0.003308| train set 1.264x speedup, test set 4.756x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003614| train set 1.294x speedup, test set 1.634x speedup, val set 0.522x speedup, step: 18
Epoch 19/300 |loss: 0.003392| train set 1.237x speedup, test set 1.462x speedup, val set 0.511x speedup, step: 19
Epoch 20/300 |loss: 0.003210| train set 1.358x speedup, test set 4.696x speedup, val set 0.520x speedup, step: 20
Epoch 21/300 |loss: 0.003030| train set 1.241x speedup, test set 3.940x speedup, val set 0.530x speedup, step: 21
Epoch 22/300 |loss: 0.003180| train set 1.160x speedup, test set 1.830x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003149| train set 1.277x speedup, test set 1.835x speedup, val set 0.521x speedup, step: 23
Epoch 24/300 |loss: 0.002917| train set 1.327x speedup, test set 1.788x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002705| train set 1.372x speedup, test set 1.386x speedup, val set 0.527x speedup, step: 25
Epoch 26/300 |loss: 0.002744| train set 1.286x speedup, test set 1.429x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.002966| train set 1.332x speedup, test set 1.050x speedup, val set 0.519x speedup, step: 27
Epoch 28/300 |loss: 0.002844| train set 1.336x speedup, test set 1.951x speedup, val set 0.519x speedup, step: 28
Epoch 29/300 |loss: 0.002280| train set 1.388x speedup, test set 1.429x speedup, val set 0.519x speedup, step: 29
Epoch 30/300 |loss: 0.002212| train set 1.366x speedup, test set 0.883x speedup, val set 0.518x speedup, step: 30
Epoch 31/300 |loss: 0.002122| train set 1.383x speedup, test set 1.465x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002272| train set 1.311x speedup, test set 0.883x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002926| train set 1.354x speedup, test set 1.411x speedup, val set 0.518x speedup, step: 33
Epoch 34/300 |loss: 0.002104| train set 1.339x speedup, test set 1.484x speedup, val set 0.501x speedup, step: 34
Epoch 35/300 |loss: 0.002064| train set 1.359x speedup, test set 1.465x speedup, val set 0.527x speedup, step: 35
Epoch 36/300 |loss: 0.002006| train set 1.349x speedup, test set 1.106x speedup, val set 0.511x speedup, step: 36
Epoch 37/300 |loss: 0.002332| train set 1.352x speedup, test set 1.454x speedup, val set 0.518x speedup, step: 37
Epoch 38/300 |loss: 0.002178| train set 1.365x speedup, test set 1.907x speedup, val set 0.528x speedup, step: 38
Epoch 39/300 |loss: 0.001934| train set 1.395x speedup, test set 1.492x speedup, val set 0.519x speedup, step: 39
Epoch 40/300 |loss: 0.001754| train set 1.382x speedup, test set 1.064x speedup, val set 0.537x speedup, step: 40
Epoch 41/300 |loss: 0.001930| train set 1.417x speedup, test set 1.366x speedup, val set 0.518x speedup, step: 41
Epoch 42/300 |loss: 0.001824| train set 1.294x speedup, test set 1.951x speedup, val set 0.518x speedup, step: 42
Epoch 43/300 |loss: 0.001941| train set 1.344x speedup, test set 1.393x speedup, val set 0.535x speedup, step: 43
Epoch 44/300 |loss: 0.001973| train set 1.436x speedup, test set 1.426x speedup, val set 0.527x speedup, step: 44
Epoch 45/300 |loss: 0.001923| train set 1.381x speedup, test set 1.432x speedup, val set 0.518x speedup, step: 45
Epoch 46/300 |loss: 0.001953| train set 1.382x speedup, test set 1.492x speedup, val set 0.518x speedup, step: 46
Epoch 47/300 |loss: 0.001789| train set 1.416x speedup, test set 1.426x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001653| train set 1.390x speedup, test set 1.445x speedup, val set 0.515x speedup, step: 48
Epoch 49/300 |loss: 0.001837| train set 1.418x speedup, test set 1.445x speedup, val set 0.519x speedup, step: 49
Epoch 50/300 |loss: 0.001621| train set 1.435x speedup, test set 1.525x speedup, val set 0.519x speedup, step: 50
Epoch 51/300 |loss: 0.001744| train set 1.392x speedup, test set 1.460x speedup, val set 0.532x speedup, step: 51
Epoch 52/300 |loss: 0.001463| train set 1.372x speedup, test set 1.462x speedup, val set 0.515x speedup, step: 52
Epoch 53/300 |loss: 0.001430| train set 1.423x speedup, test set 1.965x speedup, val set 0.518x speedup, step: 53
Epoch 54/300 |loss: 0.001551| train set 1.374x speedup, test set 1.492x speedup, val set 0.602x speedup, step: 54
Epoch 55/300 |loss: 0.001280| train set 1.417x speedup, test set 1.411x speedup, val set 0.526x speedup, step: 55
Epoch 56/300 |loss: 0.001255| train set 1.422x speedup, test set 2.021x speedup, val set 0.612x speedup, step: 56
Epoch 57/300 |loss: 0.001539| train set 1.337x speedup, test set 2.021x speedup, val set 0.600x speedup, step: 57
Epoch 58/300 |loss: 0.001604| train set 1.387x speedup, test set 1.462x speedup, val set 0.600x speedup, step: 58
Epoch 59/300 |loss: 0.001607| train set 1.453x speedup, test set 1.965x speedup, val set 0.606x speedup, step: 59
Epoch 60/300 |loss: 0.001303| train set 1.370x speedup, test set 1.971x speedup, val set 0.531x speedup, step: 60
Epoch 61/300 |loss: 0.001375| train set 1.422x speedup, test set 2.015x speedup, val set 0.527x speedup, step: 61
Epoch 62/300 |loss: 0.001387| train set 1.365x speedup, test set 1.961x speedup, val set 0.571x speedup, step: 62
Epoch 63/300 |loss: 0.001463| train set 1.436x speedup, test set 2.015x speedup, val set 0.616x speedup, step: 63
Epoch 64/300 |loss: 0.001287| train set 1.326x speedup, test set 2.015x speedup, val set 0.605x speedup, step: 64
early stopping at epoch 64
Training per epoch cost 2.398 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.453, test speedup 1.965, val speedup 0.606
best test speedup epoch: 14, train speedup 1.285, test speedup 4.884, val speedup 0.503
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 64, train speedup 1.326, test speedup 2.015, val speedup 0.605
execution cost 0:04:04.574082
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.376933, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006059| train set 1.096x speedup, test set 2.163x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006124| train set 1.085x speedup, test set 2.154x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005284| train set 0.984x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004905| train set 1.109x speedup, test set 2.131x speedup, val set 0.759x speedup, step: 9
Epoch 10/300 |loss: 0.004619| train set 1.148x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004460| train set 1.243x speedup, test set 1.477x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004239| train set 1.141x speedup, test set 1.524x speedup, val set 0.524x speedup, step: 12
Epoch 13/300 |loss: 0.004002| train set 1.320x speedup, test set 1.491x speedup, val set 0.511x speedup, step: 13
Epoch 14/300 |loss: 0.003845| train set 1.306x speedup, test set 5.189x speedup, val set 0.797x speedup, step: 14
Epoch 15/300 |loss: 0.003580| train set 1.026x speedup, test set 1.571x speedup, val set 0.797x speedup, step: 15
Epoch 16/300 |loss: 0.003689| train set 1.342x speedup, test set 4.429x speedup, val set 0.533x speedup, step: 16
Epoch 17/300 |loss: 0.003505| train set 1.240x speedup, test set 1.605x speedup, val set 0.960x speedup, step: 17
Epoch 18/300 |loss: 0.003906| train set 1.287x speedup, test set 1.600x speedup, val set 0.948x speedup, step: 18
Epoch 19/300 |loss: 0.004461| train set 1.209x speedup, test set 4.604x speedup, val set 0.911x speedup, step: 19
Epoch 20/300 |loss: 0.003754| train set 1.341x speedup, test set 4.738x speedup, val set 0.530x speedup, step: 20
Epoch 21/300 |loss: 0.003292| train set 1.350x speedup, test set 4.696x speedup, val set 0.530x speedup, step: 21
Epoch 22/300 |loss: 0.003081| train set 1.397x speedup, test set 3.839x speedup, val set 0.519x speedup, step: 22
Epoch 23/300 |loss: 0.002945| train set 1.330x speedup, test set 1.862x speedup, val set 0.533x speedup, step: 23
Epoch 24/300 |loss: 0.002718| train set 1.373x speedup, test set 1.788x speedup, val set 0.530x speedup, step: 24
Epoch 25/300 |loss: 0.002650| train set 1.436x speedup, test set 1.512x speedup, val set 0.528x speedup, step: 25
Epoch 26/300 |loss: 0.002793| train set 1.412x speedup, test set 1.007x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.002917| train set 1.423x speedup, test set 1.861x speedup, val set 0.535x speedup, step: 27
Epoch 28/300 |loss: 0.003275| train set 1.336x speedup, test set 1.883x speedup, val set 0.953x speedup, step: 28
Epoch 29/300 |loss: 0.002291| train set 1.374x speedup, test set 1.069x speedup, val set 0.535x speedup, step: 29
Epoch 30/300 |loss: 0.002251| train set 1.364x speedup, test set 2.021x speedup, val set 0.529x speedup, step: 30
Epoch 31/300 |loss: 0.002194| train set 1.425x speedup, test set 2.008x speedup, val set 0.535x speedup, step: 31
Epoch 32/300 |loss: 0.002343| train set 1.257x speedup, test set 1.044x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002449| train set 1.359x speedup, test set 1.965x speedup, val set 0.975x speedup, step: 33
Epoch 34/300 |loss: 0.002028| train set 1.417x speedup, test set 1.069x speedup, val set 0.535x speedup, step: 34
Epoch 35/300 |loss: 0.002059| train set 1.348x speedup, test set 1.069x speedup, val set 0.530x speedup, step: 35
Epoch 36/300 |loss: 0.001941| train set 1.406x speedup, test set 1.883x speedup, val set 0.515x speedup, step: 36
Epoch 37/300 |loss: 0.002323| train set 1.395x speedup, test set 1.069x speedup, val set 0.530x speedup, step: 37
Epoch 38/300 |loss: 0.002112| train set 1.351x speedup, test set 1.883x speedup, val set 0.535x speedup, step: 38
Epoch 39/300 |loss: 0.001908| train set 1.397x speedup, test set 1.060x speedup, val set 0.530x speedup, step: 39
Epoch 40/300 |loss: 0.001838| train set 1.354x speedup, test set 1.044x speedup, val set 0.486x speedup, step: 40
Epoch 41/300 |loss: 0.001940| train set 1.414x speedup, test set 1.078x speedup, val set 0.616x speedup, step: 41
Epoch 42/300 |loss: 0.001898| train set 1.318x speedup, test set 1.068x speedup, val set 0.823x speedup, step: 42
Epoch 43/300 |loss: 0.001981| train set 1.359x speedup, test set 1.445x speedup, val set 0.530x speedup, step: 43
Epoch 44/300 |loss: 0.001809| train set 1.445x speedup, test set 1.085x speedup, val set 0.529x speedup, step: 44
Epoch 45/300 |loss: 0.001906| train set 1.345x speedup, test set 1.883x speedup, val set 0.780x speedup, step: 45
Epoch 46/300 |loss: 0.001906| train set 1.443x speedup, test set 1.085x speedup, val set 0.530x speedup, step: 46
Epoch 47/300 |loss: 0.001761| train set 1.456x speedup, test set 1.883x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001624| train set 1.388x speedup, test set 1.934x speedup, val set 0.470x speedup, step: 48
Epoch 49/300 |loss: 0.001656| train set 1.445x speedup, test set 1.044x speedup, val set 0.823x speedup, step: 49
Epoch 50/300 |loss: 0.001662| train set 1.387x speedup, test set 0.947x speedup, val set 0.690x speedup, step: 50
Epoch 51/300 |loss: 0.001650| train set 1.445x speedup, test set 1.044x speedup, val set 0.435x speedup, step: 51
Epoch 52/300 |loss: 0.001477| train set 1.432x speedup, test set 1.085x speedup, val set 0.717x speedup, step: 52
Epoch 53/300 |loss: 0.001369| train set 1.456x speedup, test set 1.074x speedup, val set 0.615x speedup, step: 53
Epoch 54/300 |loss: 0.001478| train set 1.424x speedup, test set 2.036x speedup, val set 0.492x speedup, step: 54
Epoch 55/300 |loss: 0.001315| train set 1.446x speedup, test set 1.035x speedup, val set 0.493x speedup, step: 55
Epoch 56/300 |loss: 0.001223| train set 1.464x speedup, test set 1.090x speedup, val set 0.439x speedup, step: 56
Epoch 57/300 |loss: 0.001393| train set 1.408x speedup, test set 1.069x speedup, val set 0.471x speedup, step: 57
Epoch 58/300 |loss: 0.001499| train set 1.415x speedup, test set 1.997x speedup, val set 0.491x speedup, step: 58
Epoch 59/300 |loss: 0.001565| train set 1.459x speedup, test set 1.072x speedup, val set 0.522x speedup, step: 59
Epoch 60/300 |loss: 0.001265| train set 1.399x speedup, test set 1.074x speedup, val set 0.623x speedup, step: 60
Epoch 61/300 |loss: 0.001280| train set 1.458x speedup, test set 1.075x speedup, val set 0.616x speedup, step: 61
Epoch 62/300 |loss: 0.001222| train set 1.381x speedup, test set 1.074x speedup, val set 0.491x speedup, step: 62
Epoch 63/300 |loss: 0.001436| train set 1.364x speedup, test set 2.040x speedup, val set 0.556x speedup, step: 63
Epoch 64/300 |loss: 0.001281| train set 1.475x speedup, test set 1.074x speedup, val set 0.800x speedup, step: 64
Epoch 65/300 |loss: 0.001230| train set 1.481x speedup, test set 2.149x speedup, val set 0.553x speedup, step: 65
early stopping at epoch 65
Training per epoch cost 2.523 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 65, train speedup 1.481, test speedup 2.149, val speedup 0.553
best test speedup epoch: 14, train speedup 1.306, test speedup 5.189, val speedup 0.797
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 65, train speedup 1.481, test speedup 2.149, val speedup 0.553
execution cost 0:04:32.507145
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.266721, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006059| train set 1.095x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006101| train set 1.082x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005288| train set 0.938x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004877| train set 0.984x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004673| train set 1.087x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004474| train set 1.252x speedup, test set 1.510x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004175| train set 1.127x speedup, test set 1.524x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004038| train set 1.311x speedup, test set 1.491x speedup, val set 0.503x speedup, step: 13
Epoch 14/300 |loss: 0.003918| train set 1.269x speedup, test set 4.176x speedup, val set 0.518x speedup, step: 14
Epoch 15/300 |loss: 0.003567| train set 1.105x speedup, test set 5.189x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003677| train set 1.342x speedup, test set 4.738x speedup, val set 0.524x speedup, step: 16
Epoch 17/300 |loss: 0.003462| train set 1.258x speedup, test set 1.563x speedup, val set 0.517x speedup, step: 17
Epoch 18/300 |loss: 0.003659| train set 1.356x speedup, test set 1.524x speedup, val set 0.522x speedup, step: 18
Epoch 19/300 |loss: 0.003950| train set 1.250x speedup, test set 0.939x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003257| train set 1.296x speedup, test set 1.520x speedup, val set 0.541x speedup, step: 20
Epoch 21/300 |loss: 0.003063| train set 1.303x speedup, test set 1.044x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003112| train set 1.169x speedup, test set 1.765x speedup, val set 0.525x speedup, step: 22
Epoch 23/300 |loss: 0.003236| train set 1.267x speedup, test set 1.028x speedup, val set 0.535x speedup, step: 23
Epoch 24/300 |loss: 0.002816| train set 1.369x speedup, test set 1.788x speedup, val set 0.530x speedup, step: 24
Epoch 25/300 |loss: 0.002690| train set 1.380x speedup, test set 1.397x speedup, val set 0.539x speedup, step: 25
Epoch 26/300 |loss: 0.002728| train set 1.315x speedup, test set 1.019x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.002871| train set 1.330x speedup, test set 1.799x speedup, val set 0.535x speedup, step: 27
Epoch 28/300 |loss: 0.002629| train set 1.350x speedup, test set 1.883x speedup, val set 0.533x speedup, step: 28
Epoch 29/300 |loss: 0.002398| train set 1.345x speedup, test set 1.883x speedup, val set 0.535x speedup, step: 29
Epoch 30/300 |loss: 0.002226| train set 1.352x speedup, test set 1.803x speedup, val set 0.530x speedup, step: 30
Epoch 31/300 |loss: 0.002214| train set 1.359x speedup, test set 1.849x speedup, val set 0.517x speedup, step: 31
Epoch 32/300 |loss: 0.002287| train set 1.304x speedup, test set 1.883x speedup, val set 0.970x speedup, step: 32
Epoch 33/300 |loss: 0.003010| train set 1.368x speedup, test set 1.846x speedup, val set 0.815x speedup, step: 33
Epoch 34/300 |loss: 0.002136| train set 1.370x speedup, test set 1.883x speedup, val set 0.530x speedup, step: 34
Epoch 35/300 |loss: 0.002151| train set 1.354x speedup, test set 1.803x speedup, val set 0.532x speedup, step: 35
Epoch 36/300 |loss: 0.002009| train set 1.388x speedup, test set 1.416x speedup, val set 0.529x speedup, step: 36
Epoch 37/300 |loss: 0.002304| train set 1.331x speedup, test set 1.044x speedup, val set 0.528x speedup, step: 37
Epoch 38/300 |loss: 0.002059| train set 1.333x speedup, test set 1.811x speedup, val set 0.820x speedup, step: 38
Epoch 39/300 |loss: 0.001891| train set 1.355x speedup, test set 1.348x speedup, val set 0.515x speedup, step: 39
Epoch 40/300 |loss: 0.002019| train set 1.171x speedup, test set 1.348x speedup, val set 0.490x speedup, step: 40
Epoch 41/300 |loss: 0.002117| train set 1.371x speedup, test set 1.849x speedup, val set 0.477x speedup, step: 41
Epoch 42/300 |loss: 0.001832| train set 1.300x speedup, test set 0.880x speedup, val set 0.487x speedup, step: 42
Epoch 43/300 |loss: 0.002183| train set 1.371x speedup, test set 1.348x speedup, val set 0.531x speedup, step: 43
Epoch 44/300 |loss: 0.002032| train set 1.372x speedup, test set 1.849x speedup, val set 0.477x speedup, step: 44
Epoch 45/300 |loss: 0.001827| train set 1.358x speedup, test set 1.348x speedup, val set 0.519x speedup, step: 45
Epoch 46/300 |loss: 0.001978| train set 1.435x speedup, test set 1.849x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001883| train set 1.416x speedup, test set 1.397x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001628| train set 1.389x speedup, test set 1.397x speedup, val set 0.477x speedup, step: 48
Epoch 49/300 |loss: 0.001738| train set 1.387x speedup, test set 1.375x speedup, val set 0.519x speedup, step: 49
Epoch 50/300 |loss: 0.001549| train set 1.424x speedup, test set 1.512x speedup, val set 0.476x speedup, step: 50
Epoch 51/300 |loss: 0.001670| train set 1.375x speedup, test set 1.397x speedup, val set 0.519x speedup, step: 51
Epoch 52/300 |loss: 0.001518| train set 1.451x speedup, test set 1.803x speedup, val set 0.425x speedup, step: 52
Epoch 53/300 |loss: 0.001437| train set 1.409x speedup, test set 1.803x speedup, val set 0.602x speedup, step: 53
Epoch 54/300 |loss: 0.001389| train set 1.424x speedup, test set 1.849x speedup, val set 0.428x speedup, step: 54
Epoch 55/300 |loss: 0.001310| train set 1.406x speedup, test set 1.765x speedup, val set 0.430x speedup, step: 55
Epoch 56/300 |loss: 0.001198| train set 1.374x speedup, test set 1.811x speedup, val set 0.431x speedup, step: 56
Epoch 57/300 |loss: 0.001446| train set 1.385x speedup, test set 1.803x speedup, val set 0.428x speedup, step: 57
Epoch 58/300 |loss: 0.001663| train set 1.330x speedup, test set 1.803x speedup, val set 0.428x speedup, step: 58
Epoch 59/300 |loss: 0.001659| train set 1.459x speedup, test set 1.861x speedup, val set 0.523x speedup, step: 59
early stopping at epoch 59
Training per epoch cost 2.536 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.459, test speedup 1.861, val speedup 0.523
best test speedup epoch: 15, train speedup 1.105, test speedup 5.189, val speedup 0.518
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 59, train speedup 1.459, test speedup 1.861, val speedup 0.523
execution cost 0:04:11.067952
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.116218, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006674| train set 0.555x speedup, test set 1.559x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006507| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006048| train set 1.119x speedup, test set 2.187x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006079| train set 0.552x speedup, test set 2.136x speedup, val set 0.789x speedup, step: 7
Epoch 8/300 |loss: 0.005358| train set 0.978x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004882| train set 1.110x speedup, test set 2.131x speedup, val set 0.808x speedup, step: 9
Epoch 10/300 |loss: 0.004663| train set 1.142x speedup, test set 1.486x speedup, val set 0.797x speedup, step: 10
Epoch 11/300 |loss: 0.004501| train set 1.231x speedup, test set 1.510x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004331| train set 1.118x speedup, test set 1.510x speedup, val set 0.524x speedup, step: 12
Epoch 13/300 |loss: 0.004082| train set 1.311x speedup, test set 1.454x speedup, val set 0.512x speedup, step: 13
Epoch 14/300 |loss: 0.003912| train set 1.253x speedup, test set 5.065x speedup, val set 0.797x speedup, step: 14
Epoch 15/300 |loss: 0.003570| train set 1.151x speedup, test set 5.189x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003686| train set 1.288x speedup, test set 4.429x speedup, val set 0.533x speedup, step: 16
Epoch 17/300 |loss: 0.003516| train set 1.256x speedup, test set 1.491x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003643| train set 1.317x speedup, test set 1.600x speedup, val set 0.530x speedup, step: 18
Epoch 19/300 |loss: 0.003623| train set 1.282x speedup, test set 4.225x speedup, val set 0.500x speedup, step: 19
Epoch 20/300 |loss: 0.003284| train set 1.334x speedup, test set 1.573x speedup, val set 0.543x speedup, step: 20
Epoch 21/300 |loss: 0.003136| train set 1.283x speedup, test set 1.060x speedup, val set 0.526x speedup, step: 21
Epoch 22/300 |loss: 0.003077| train set 1.145x speedup, test set 1.752x speedup, val set 0.522x speedup, step: 22
Epoch 23/300 |loss: 0.003276| train set 1.326x speedup, test set 1.884x speedup, val set 0.530x speedup, step: 23
Epoch 24/300 |loss: 0.002935| train set 1.367x speedup, test set 1.905x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002612| train set 1.386x speedup, test set 1.446x speedup, val set 0.527x speedup, step: 25
Epoch 26/300 |loss: 0.002724| train set 1.398x speedup, test set 1.019x speedup, val set 0.500x speedup, step: 26
Epoch 27/300 |loss: 0.002797| train set 1.357x speedup, test set 1.019x speedup, val set 0.529x speedup, step: 27
Epoch 28/300 |loss: 0.002584| train set 1.346x speedup, test set 1.069x speedup, val set 0.529x speedup, step: 28
Epoch 29/300 |loss: 0.002296| train set 1.356x speedup, test set 1.031x speedup, val set 0.539x speedup, step: 29
Epoch 30/300 |loss: 0.002158| train set 1.336x speedup, test set 1.843x speedup, val set 0.530x speedup, step: 30
Epoch 31/300 |loss: 0.002200| train set 1.415x speedup, test set 1.407x speedup, val set 0.515x speedup, step: 31
Epoch 32/300 |loss: 0.002249| train set 1.210x speedup, test set 4.558x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.003218| train set 1.352x speedup, test set 1.803x speedup, val set 0.515x speedup, step: 33
Epoch 34/300 |loss: 0.002132| train set 1.358x speedup, test set 2.040x speedup, val set 0.530x speedup, step: 34
Epoch 35/300 |loss: 0.002086| train set 1.347x speedup, test set 1.803x speedup, val set 0.522x speedup, step: 35
Epoch 36/300 |loss: 0.001929| train set 1.229x speedup, test set 1.803x speedup, val set 0.529x speedup, step: 36
Epoch 37/300 |loss: 0.002331| train set 1.319x speedup, test set 1.970x speedup, val set 0.529x speedup, step: 37
Epoch 38/300 |loss: 0.001943| train set 1.354x speedup, test set 1.843x speedup, val set 0.534x speedup, step: 38
Epoch 39/300 |loss: 0.001957| train set 1.427x speedup, test set 1.370x speedup, val set 0.529x speedup, step: 39
Epoch 40/300 |loss: 0.001763| train set 1.291x speedup, test set 1.446x speedup, val set 0.526x speedup, step: 40
Epoch 41/300 |loss: 0.001868| train set 1.346x speedup, test set 1.820x speedup, val set 0.526x speedup, step: 41
Epoch 42/300 |loss: 0.001885| train set 1.106x speedup, test set 0.901x speedup, val set 0.524x speedup, step: 42
Epoch 43/300 |loss: 0.002085| train set 1.352x speedup, test set 1.370x speedup, val set 0.530x speedup, step: 43
Epoch 44/300 |loss: 0.001998| train set 1.381x speedup, test set 0.902x speedup, val set 0.524x speedup, step: 44
Epoch 45/300 |loss: 0.001769| train set 1.273x speedup, test set 1.947x speedup, val set 0.524x speedup, step: 45
Epoch 46/300 |loss: 0.002035| train set 1.395x speedup, test set 1.976x speedup, val set 0.526x speedup, step: 46
Epoch 47/300 |loss: 0.001911| train set 1.413x speedup, test set 1.398x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001600| train set 1.389x speedup, test set 0.942x speedup, val set 0.529x speedup, step: 48
Epoch 49/300 |loss: 0.001626| train set 1.412x speedup, test set 1.966x speedup, val set 0.529x speedup, step: 49
Epoch 50/300 |loss: 0.001600| train set 1.370x speedup, test set 1.055x speedup, val set 0.526x speedup, step: 50
Epoch 51/300 |loss: 0.001608| train set 1.394x speedup, test set 1.443x speedup, val set 0.537x speedup, step: 51
Epoch 52/300 |loss: 0.001413| train set 1.426x speedup, test set 1.638x speedup, val set 0.515x speedup, step: 52
Epoch 53/300 |loss: 0.001353| train set 1.395x speedup, test set 1.976x speedup, val set 0.518x speedup, step: 53
Epoch 54/300 |loss: 0.001348| train set 1.454x speedup, test set 0.950x speedup, val set 0.530x speedup, step: 54
Epoch 55/300 |loss: 0.001308| train set 1.401x speedup, test set 1.865x speedup, val set 0.522x speedup, step: 55
Epoch 56/300 |loss: 0.001223| train set 1.417x speedup, test set 1.644x speedup, val set 0.540x speedup, step: 56
Epoch 57/300 |loss: 0.001357| train set 1.333x speedup, test set 1.624x speedup, val set 0.539x speedup, step: 57
Epoch 58/300 |loss: 0.001477| train set 1.385x speedup, test set 1.525x speedup, val set 0.525x speedup, step: 58
Epoch 59/300 |loss: 0.001598| train set 1.451x speedup, test set 2.051x speedup, val set 0.522x speedup, step: 59
Epoch 60/300 |loss: 0.001295| train set 1.404x speedup, test set 2.051x speedup, val set 0.535x speedup, step: 60
Epoch 61/300 |loss: 0.001218| train set 1.379x speedup, test set 1.509x speedup, val set 0.529x speedup, step: 61
Epoch 62/300 |loss: 0.001197| train set 1.400x speedup, test set 1.954x speedup, val set 0.441x speedup, step: 62
Epoch 63/300 |loss: 0.001512| train set 1.361x speedup, test set 1.510x speedup, val set 0.430x speedup, step: 63
Epoch 64/300 |loss: 0.001324| train set 1.402x speedup, test set 2.093x speedup, val set 0.526x speedup, step: 64
early stopping at epoch 64
Training per epoch cost 2.517 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 54, train speedup 1.454, test speedup 0.950, val speedup 0.530
best test speedup epoch: 15, train speedup 1.151, test speedup 5.189, val speedup 0.518
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 64, train speedup 1.402, test speedup 2.093, val speedup 0.526
execution cost 0:04:27.947401
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.333808, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 0.979x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006062| train set 1.084x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005318| train set 0.984x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004848| train set 1.116x speedup, test set 2.154x speedup, val set 0.808x speedup, step: 9
Epoch 10/300 |loss: 0.004633| train set 1.134x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004463| train set 1.246x speedup, test set 4.882x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004235| train set 1.151x speedup, test set 1.477x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004020| train set 1.307x speedup, test set 1.467x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003877| train set 1.291x speedup, test set 4.884x speedup, val set 0.802x speedup, step: 14
Epoch 15/300 |loss: 0.003615| train set 1.109x speedup, test set 1.573x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003644| train set 1.310x speedup, test set 4.225x speedup, val set 0.522x speedup, step: 16
Epoch 17/300 |loss: 0.003431| train set 1.261x speedup, test set 1.467x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003543| train set 1.325x speedup, test set 1.605x speedup, val set 0.520x speedup, step: 18
Epoch 19/300 |loss: 0.003403| train set 1.262x speedup, test set 1.605x speedup, val set 0.511x speedup, step: 19
Epoch 20/300 |loss: 0.003212| train set 1.349x speedup, test set 5.242x speedup, val set 0.533x speedup, step: 20
Epoch 21/300 |loss: 0.003104| train set 1.293x speedup, test set 1.520x speedup, val set 0.531x speedup, step: 21
Epoch 22/300 |loss: 0.003223| train set 1.102x speedup, test set 1.830x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003155| train set 1.266x speedup, test set 1.583x speedup, val set 0.518x speedup, step: 23
Epoch 24/300 |loss: 0.002913| train set 1.327x speedup, test set 5.595x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002777| train set 1.360x speedup, test set 1.459x speedup, val set 0.531x speedup, step: 25
Epoch 26/300 |loss: 0.002749| train set 1.369x speedup, test set 1.591x speedup, val set 0.528x speedup, step: 26
Epoch 27/300 |loss: 0.003007| train set 1.356x speedup, test set 4.011x speedup, val set 0.533x speedup, step: 27
Epoch 28/300 |loss: 0.002816| train set 1.324x speedup, test set 2.040x speedup, val set 0.518x speedup, step: 28
Epoch 29/300 |loss: 0.002348| train set 1.335x speedup, test set 1.069x speedup, val set 0.505x speedup, step: 29
Epoch 30/300 |loss: 0.002270| train set 1.365x speedup, test set 1.065x speedup, val set 0.526x speedup, step: 30
Epoch 31/300 |loss: 0.002192| train set 1.372x speedup, test set 1.436x speedup, val set 0.518x speedup, step: 31
Epoch 32/300 |loss: 0.002249| train set 1.191x speedup, test set 1.883x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.003005| train set 1.343x speedup, test set 1.985x speedup, val set 0.530x speedup, step: 33
Epoch 34/300 |loss: 0.002169| train set 1.360x speedup, test set 1.951x speedup, val set 0.530x speedup, step: 34
Epoch 35/300 |loss: 0.002178| train set 1.357x speedup, test set 1.019x speedup, val set 0.530x speedup, step: 35
Epoch 36/300 |loss: 0.002010| train set 1.343x speedup, test set 1.951x speedup, val set 0.529x speedup, step: 36
Epoch 37/300 |loss: 0.002246| train set 1.364x speedup, test set 1.069x speedup, val set 0.530x speedup, step: 37
Epoch 38/300 |loss: 0.002143| train set 1.353x speedup, test set 1.069x speedup, val set 0.530x speedup, step: 38
Epoch 39/300 |loss: 0.002074| train set 1.356x speedup, test set 1.069x speedup, val set 0.518x speedup, step: 39
Epoch 40/300 |loss: 0.001882| train set 1.244x speedup, test set 1.462x speedup, val set 0.529x speedup, step: 40
Epoch 41/300 |loss: 0.002007| train set 1.412x speedup, test set 1.965x speedup, val set 0.519x speedup, step: 41
Epoch 42/300 |loss: 0.001797| train set 1.281x speedup, test set 1.063x speedup, val set 0.519x speedup, step: 42
Epoch 43/300 |loss: 0.002082| train set 1.293x speedup, test set 1.009x speedup, val set 0.519x speedup, step: 43
Epoch 44/300 |loss: 0.002113| train set 1.371x speedup, test set 1.624x speedup, val set 0.527x speedup, step: 44
Epoch 45/300 |loss: 0.002021| train set 1.346x speedup, test set 1.454x speedup, val set 0.519x speedup, step: 45
early stopping at epoch 45
Training per epoch cost 2.504 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 41, train speedup 1.412, test speedup 1.965, val speedup 0.519
best test speedup epoch: 24, train speedup 1.327, test speedup 5.595, val speedup 0.500
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 45, train speedup 1.346, test speedup 1.454, val speedup 0.519
execution cost 0:03:13.411974
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.988036, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006668| train set 0.557x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006492| train set 0.966x speedup, test set 1.499x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006025| train set 1.092x speedup, test set 1.218x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.005864| train set 1.080x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005562| train set 0.979x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004789| train set 0.979x speedup, test set 1.123x speedup, val set 0.759x speedup, step: 9
Epoch 10/300 |loss: 0.004724| train set 1.257x speedup, test set 1.486x speedup, val set 0.797x speedup, step: 10
Epoch 11/300 |loss: 0.004498| train set 1.263x speedup, test set 1.615x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004224| train set 1.129x speedup, test set 1.486x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.004067| train set 1.337x speedup, test set 1.467x speedup, val set 0.503x speedup, step: 13
Epoch 14/300 |loss: 0.003877| train set 1.297x speedup, test set 5.189x speedup, val set 0.757x speedup, step: 14
Epoch 15/300 |loss: 0.003571| train set 1.001x speedup, test set 1.568x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003742| train set 1.365x speedup, test set 1.477x speedup, val set 0.524x speedup, step: 16
Epoch 17/300 |loss: 0.003520| train set 1.263x speedup, test set 1.467x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003667| train set 1.310x speedup, test set 1.493x speedup, val set 0.939x speedup, step: 18
Epoch 19/300 |loss: 0.003757| train set 1.234x speedup, test set 4.118x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003180| train set 1.343x speedup, test set 1.035x speedup, val set 0.541x speedup, step: 20
Epoch 21/300 |loss: 0.003074| train set 1.325x speedup, test set 1.534x speedup, val set 0.530x speedup, step: 21
Epoch 22/300 |loss: 0.003241| train set 1.174x speedup, test set 3.766x speedup, val set 0.522x speedup, step: 22
Epoch 23/300 |loss: 0.003237| train set 1.265x speedup, test set 1.568x speedup, val set 0.523x speedup, step: 23
Epoch 24/300 |loss: 0.002870| train set 1.382x speedup, test set 3.766x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002696| train set 1.412x speedup, test set 1.481x speedup, val set 0.527x speedup, step: 25
Epoch 26/300 |loss: 0.002622| train set 1.289x speedup, test set 1.480x speedup, val set 0.523x speedup, step: 26
Epoch 27/300 |loss: 0.002853| train set 1.296x speedup, test set 1.019x speedup, val set 0.519x speedup, step: 27
Epoch 28/300 |loss: 0.002507| train set 1.302x speedup, test set 1.587x speedup, val set 0.530x speedup, step: 28
Epoch 29/300 |loss: 0.002374| train set 1.335x speedup, test set 0.901x speedup, val set 0.504x speedup, step: 29
Epoch 30/300 |loss: 0.002183| train set 1.358x speedup, test set 0.947x speedup, val set 0.530x speedup, step: 30
Epoch 31/300 |loss: 0.002207| train set 1.363x speedup, test set 0.865x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002216| train set 1.235x speedup, test set 1.050x speedup, val set 0.975x speedup, step: 32
Epoch 33/300 |loss: 0.003053| train set 1.336x speedup, test set 1.406x speedup, val set 0.939x speedup, step: 33
Epoch 34/300 |loss: 0.002112| train set 1.325x speedup, test set 0.865x speedup, val set 0.505x speedup, step: 34
Epoch 35/300 |loss: 0.002085| train set 1.356x speedup, test set 0.865x speedup, val set 0.523x speedup, step: 35
Epoch 36/300 |loss: 0.001957| train set 1.349x speedup, test set 1.370x speedup, val set 0.935x speedup, step: 36
Epoch 37/300 |loss: 0.002356| train set 1.333x speedup, test set 0.877x speedup, val set 0.534x speedup, step: 37
Epoch 38/300 |loss: 0.002188| train set 1.314x speedup, test set 0.865x speedup, val set 0.500x speedup, step: 38
Epoch 39/300 |loss: 0.001846| train set 1.378x speedup, test set 0.866x speedup, val set 0.501x speedup, step: 39
Epoch 40/300 |loss: 0.001787| train set 1.333x speedup, test set 1.066x speedup, val set 0.526x speedup, step: 40
Epoch 41/300 |loss: 0.001901| train set 1.384x speedup, test set 1.069x speedup, val set 0.902x speedup, step: 41
Epoch 42/300 |loss: 0.001765| train set 1.266x speedup, test set 0.866x speedup, val set 0.939x speedup, step: 42
Epoch 43/300 |loss: 0.002217| train set 1.322x speedup, test set 0.865x speedup, val set 0.524x speedup, step: 43
Epoch 44/300 |loss: 0.001968| train set 1.385x speedup, test set 0.875x speedup, val set 0.519x speedup, step: 44
Epoch 45/300 |loss: 0.001791| train set 1.334x speedup, test set 0.900x speedup, val set 0.501x speedup, step: 45
Epoch 46/300 |loss: 0.001864| train set 1.346x speedup, test set 0.877x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001619| train set 1.388x speedup, test set 0.875x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001535| train set 1.364x speedup, test set 0.877x speedup, val set 0.515x speedup, step: 48
Epoch 49/300 |loss: 0.001961| train set 1.375x speedup, test set 0.900x speedup, val set 0.519x speedup, step: 49
Epoch 50/300 |loss: 0.001625| train set 1.390x speedup, test set 0.877x speedup, val set 0.924x speedup, step: 50
Epoch 51/300 |loss: 0.001647| train set 1.364x speedup, test set 0.865x speedup, val set 0.519x speedup, step: 51
Epoch 52/300 |loss: 0.001431| train set 1.399x speedup, test set 0.904x speedup, val set 0.516x speedup, step: 52
Epoch 53/300 |loss: 0.001458| train set 1.403x speedup, test set 0.889x speedup, val set 0.603x speedup, step: 53
Epoch 54/300 |loss: 0.001399| train set 1.383x speedup, test set 1.090x speedup, val set 0.603x speedup, step: 54
Epoch 55/300 |loss: 0.001238| train set 1.369x speedup, test set 0.904x speedup, val set 0.524x speedup, step: 55
Epoch 56/300 |loss: 0.001150| train set 1.348x speedup, test set 0.904x speedup, val set 0.943x speedup, step: 56
Epoch 57/300 |loss: 0.001358| train set 1.318x speedup, test set 0.875x speedup, val set 0.939x speedup, step: 57
Epoch 58/300 |loss: 0.001648| train set 1.376x speedup, test set 0.913x speedup, val set 0.935x speedup, step: 58
Epoch 59/300 |loss: 0.001594| train set 1.444x speedup, test set 0.904x speedup, val set 0.515x speedup, step: 59
Epoch 60/300 |loss: 0.001323| train set 1.364x speedup, test set 0.874x speedup, val set 0.516x speedup, step: 60
Epoch 61/300 |loss: 0.001266| train set 1.400x speedup, test set 0.904x speedup, val set 0.530x speedup, step: 61
Epoch 62/300 |loss: 0.001227| train set 1.404x speedup, test set 0.884x speedup, val set 0.518x speedup, step: 62
Epoch 63/300 |loss: 0.001491| train set 1.326x speedup, test set 0.904x speedup, val set 0.935x speedup, step: 63
Epoch 64/300 |loss: 0.001368| train set 1.425x speedup, test set 1.074x speedup, val set 0.938x speedup, step: 64
early stopping at epoch 64
Training per epoch cost 2.522 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.444, test speedup 0.904, val speedup 0.515
best test speedup epoch: 14, train speedup 1.297, test speedup 5.189, val speedup 0.757
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 64, train speedup 1.425, test speedup 1.074, val speedup 0.938
execution cost 0:04:29.020877
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.338089, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 0.979x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006062| train set 1.084x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005318| train set 0.984x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004848| train set 1.116x speedup, test set 2.154x speedup, val set 0.808x speedup, step: 9
Epoch 10/300 |loss: 0.004642| train set 1.199x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004457| train set 1.256x speedup, test set 1.510x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004245| train set 1.150x speedup, test set 1.524x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004017| train set 1.307x speedup, test set 1.491x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003852| train set 1.325x speedup, test set 4.884x speedup, val set 0.802x speedup, step: 14
Epoch 15/300 |loss: 0.003562| train set 1.115x speedup, test set 1.568x speedup, val set 0.520x speedup, step: 15
Epoch 16/300 |loss: 0.003582| train set 1.320x speedup, test set 4.429x speedup, val set 0.521x speedup, step: 16
Epoch 17/300 |loss: 0.003553| train set 1.254x speedup, test set 1.491x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003741| train set 1.320x speedup, test set 0.946x speedup, val set 0.522x speedup, step: 18
Epoch 19/300 |loss: 0.004229| train set 1.244x speedup, test set 1.459x speedup, val set 0.511x speedup, step: 19
Epoch 20/300 |loss: 0.003886| train set 1.278x speedup, test set 4.505x speedup, val set 0.522x speedup, step: 20
Epoch 21/300 |loss: 0.003345| train set 1.366x speedup, test set 1.389x speedup, val set 0.519x speedup, step: 21
Epoch 22/300 |loss: 0.003166| train set 1.208x speedup, test set 2.043x speedup, val set 0.517x speedup, step: 22
Epoch 23/300 |loss: 0.002994| train set 1.293x speedup, test set 1.080x speedup, val set 0.531x speedup, step: 23
Epoch 24/300 |loss: 0.002745| train set 1.345x speedup, test set 1.044x speedup, val set 0.513x speedup, step: 24
Epoch 25/300 |loss: 0.002642| train set 1.401x speedup, test set 1.348x speedup, val set 0.531x speedup, step: 25
Epoch 26/300 |loss: 0.002881| train set 1.312x speedup, test set 1.467x speedup, val set 0.528x speedup, step: 26
Epoch 27/300 |loss: 0.003015| train set 1.304x speedup, test set 1.706x speedup, val set 0.533x speedup, step: 27
Epoch 28/300 |loss: 0.003358| train set 1.367x speedup, test set 1.069x speedup, val set 0.535x speedup, step: 28
Epoch 29/300 |loss: 0.002391| train set 1.384x speedup, test set 1.462x speedup, val set 0.515x speedup, step: 29
Epoch 30/300 |loss: 0.002279| train set 1.345x speedup, test set 1.988x speedup, val set 0.533x speedup, step: 30
Epoch 31/300 |loss: 0.002331| train set 1.393x speedup, test set 1.462x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002408| train set 1.325x speedup, test set 1.883x speedup, val set 0.533x speedup, step: 32
Epoch 33/300 |loss: 0.002479| train set 1.374x speedup, test set 1.370x speedup, val set 0.530x speedup, step: 33
Epoch 34/300 |loss: 0.002201| train set 1.346x speedup, test set 1.883x speedup, val set 0.523x speedup, step: 34
Epoch 35/300 |loss: 0.002219| train set 1.362x speedup, test set 1.920x speedup, val set 0.523x speedup, step: 35
Epoch 36/300 |loss: 0.002146| train set 1.359x speedup, test set 2.015x speedup, val set 0.533x speedup, step: 36
Epoch 37/300 |loss: 0.002124| train set 1.378x speedup, test set 2.015x speedup, val set 0.532x speedup, step: 37
Epoch 38/300 |loss: 0.002054| train set 1.329x speedup, test set 2.015x speedup, val set 0.530x speedup, step: 38
Epoch 39/300 |loss: 0.002066| train set 1.328x speedup, test set 2.073x speedup, val set 0.533x speedup, step: 39
Epoch 40/300 |loss: 0.002022| train set 1.268x speedup, test set 2.015x speedup, val set 0.530x speedup, step: 40
Epoch 41/300 |loss: 0.002118| train set 1.412x speedup, test set 2.008x speedup, val set 0.523x speedup, step: 41
Epoch 42/300 |loss: 0.001995| train set 1.340x speedup, test set 2.015x speedup, val set 0.535x speedup, step: 42
Epoch 43/300 |loss: 0.001922| train set 1.260x speedup, test set 1.463x speedup, val set 0.535x speedup, step: 43
Epoch 44/300 |loss: 0.001967| train set 1.401x speedup, test set 2.073x speedup, val set 0.534x speedup, step: 44
Epoch 45/300 |loss: 0.002092| train set 1.391x speedup, test set 2.015x speedup, val set 0.526x speedup, step: 45
Epoch 46/300 |loss: 0.002045| train set 1.389x speedup, test set 2.045x speedup, val set 0.523x speedup, step: 46
Epoch 47/300 |loss: 0.001833| train set 1.427x speedup, test set 1.809x speedup, val set 0.523x speedup, step: 47
Epoch 48/300 |loss: 0.001870| train set 1.420x speedup, test set 1.492x speedup, val set 0.454x speedup, step: 48
Epoch 49/300 |loss: 0.001879| train set 1.453x speedup, test set 2.015x speedup, val set 0.529x speedup, step: 49
Epoch 50/300 |loss: 0.001728| train set 1.414x speedup, test set 2.107x speedup, val set 0.503x speedup, step: 50
Epoch 51/300 |loss: 0.001825| train set 1.382x speedup, test set 1.492x speedup, val set 0.519x speedup, step: 51
Epoch 52/300 |loss: 0.001811| train set 1.402x speedup, test set 2.860x speedup, val set 0.517x speedup, step: 52
Epoch 53/300 |loss: 0.001534| train set 1.428x speedup, test set 2.014x speedup, val set 0.518x speedup, step: 53
Epoch 54/300 |loss: 0.001488| train set 1.392x speedup, test set 2.073x speedup, val set 0.616x speedup, step: 54
Epoch 55/300 |loss: 0.001350| train set 1.416x speedup, test set 1.965x speedup, val set 0.492x speedup, step: 55
Epoch 56/300 |loss: 0.001282| train set 1.325x speedup, test set 2.073x speedup, val set 0.491x speedup, step: 56
Epoch 57/300 |loss: 0.001552| train set 1.379x speedup, test set 2.015x speedup, val set 0.488x speedup, step: 57
Epoch 58/300 |loss: 0.001591| train set 1.397x speedup, test set 2.015x speedup, val set 0.477x speedup, step: 58
Epoch 59/300 |loss: 0.001462| train set 1.383x speedup, test set 2.015x speedup, val set 0.479x speedup, step: 59
Epoch 60/300 |loss: 0.001391| train set 1.374x speedup, test set 1.965x speedup, val set 0.521x speedup, step: 60
Epoch 61/300 |loss: 0.001446| train set 1.435x speedup, test set 2.015x speedup, val set 0.517x speedup, step: 61
Epoch 62/300 |loss: 0.001451| train set 1.416x speedup, test set 1.982x speedup, val set 0.488x speedup, step: 62
Epoch 63/300 |loss: 0.001340| train set 1.388x speedup, test set 2.015x speedup, val set 0.528x speedup, step: 63
Epoch 64/300 |loss: 0.001187| train set 1.272x speedup, test set 2.015x speedup, val set 0.519x speedup, step: 64
Epoch 65/300 |loss: 0.001276| train set 1.442x speedup, test set 1.982x speedup, val set 0.477x speedup, step: 65
Epoch 66/300 |loss: 0.001266| train set 1.406x speedup, test set 1.982x speedup, val set 0.521x speedup, step: 66
Epoch 67/300 |loss: 0.001223| train set 1.397x speedup, test set 2.015x speedup, val set 0.477x speedup, step: 67
Epoch 68/300 |loss: 0.001468| train set 1.383x speedup, test set 2.073x speedup, val set 0.605x speedup, step: 68
Epoch 69/300 |loss: 0.001418| train set 1.333x speedup, test set 1.982x speedup, val set 0.506x speedup, step: 69
early stopping at epoch 69
Training per epoch cost 2.507 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 49, train speedup 1.453, test speedup 2.015, val speedup 0.529
best test speedup epoch: 14, train speedup 1.325, test speedup 4.884, val speedup 0.802
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 69, train speedup 1.333, test speedup 1.982, val speedup 0.506
execution cost 0:04:49.645766
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.353274, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 1.100x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 0.551x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005302| train set 0.933x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004862| train set 1.113x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004658| train set 1.078x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004502| train set 1.221x speedup, test set 1.486x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004182| train set 1.155x speedup, test set 1.524x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.004014| train set 1.326x speedup, test set 1.567x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003879| train set 1.293x speedup, test set 4.884x speedup, val set 0.797x speedup, step: 14
Epoch 15/300 |loss: 0.003600| train set 1.158x speedup, test set 1.568x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003547| train set 1.265x speedup, test set 1.595x speedup, val set 0.519x speedup, step: 16
Epoch 17/300 |loss: 0.003420| train set 1.303x speedup, test set 1.607x speedup, val set 0.521x speedup, step: 17
Epoch 18/300 |loss: 0.003407| train set 1.324x speedup, test set 1.603x speedup, val set 0.519x speedup, step: 18
Epoch 19/300 |loss: 0.003177| train set 1.244x speedup, test set 1.587x speedup, val set 0.504x speedup, step: 19
Epoch 20/300 |loss: 0.003127| train set 1.303x speedup, test set 1.044x speedup, val set 0.528x speedup, step: 20
Epoch 21/300 |loss: 0.003387| train set 1.322x speedup, test set 1.044x speedup, val set 0.530x speedup, step: 21
Epoch 22/300 |loss: 0.003221| train set 1.184x speedup, test set 1.886x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003044| train set 1.268x speedup, test set 1.044x speedup, val set 0.530x speedup, step: 23
Epoch 24/300 |loss: 0.002848| train set 1.332x speedup, test set 1.883x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002874| train set 1.393x speedup, test set 1.566x speedup, val set 0.505x speedup, step: 25
Epoch 26/300 |loss: 0.002861| train set 1.322x speedup, test set 1.051x speedup, val set 0.529x speedup, step: 26
Epoch 27/300 |loss: 0.003097| train set 1.325x speedup, test set 1.044x speedup, val set 0.535x speedup, step: 27
Epoch 28/300 |loss: 0.003025| train set 1.363x speedup, test set 1.922x speedup, val set 0.518x speedup, step: 28
Epoch 29/300 |loss: 0.002378| train set 1.389x speedup, test set 1.883x speedup, val set 0.511x speedup, step: 29
Epoch 30/300 |loss: 0.002278| train set 1.373x speedup, test set 1.883x speedup, val set 0.526x speedup, step: 30
Epoch 31/300 |loss: 0.002199| train set 1.370x speedup, test set 1.883x speedup, val set 0.523x speedup, step: 31
Epoch 32/300 |loss: 0.002233| train set 1.349x speedup, test set 1.883x speedup, val set 0.533x speedup, step: 32
Epoch 33/300 |loss: 0.002932| train set 1.350x speedup, test set 1.883x speedup, val set 0.797x speedup, step: 33
Epoch 34/300 |loss: 0.002148| train set 1.386x speedup, test set 1.883x speedup, val set 0.504x speedup, step: 34
Epoch 35/300 |loss: 0.002129| train set 1.418x speedup, test set 1.883x speedup, val set 0.518x speedup, step: 35
Epoch 36/300 |loss: 0.002100| train set 1.361x speedup, test set 1.883x speedup, val set 0.526x speedup, step: 36
Epoch 37/300 |loss: 0.002301| train set 1.386x speedup, test set 1.883x speedup, val set 0.532x speedup, step: 37
Epoch 38/300 |loss: 0.002058| train set 1.416x speedup, test set 1.883x speedup, val set 0.515x speedup, step: 38
Epoch 39/300 |loss: 0.001989| train set 1.334x speedup, test set 1.462x speedup, val set 0.535x speedup, step: 39
Epoch 40/300 |loss: 0.001989| train set 1.341x speedup, test set 1.416x speedup, val set 0.474x speedup, step: 40
Epoch 41/300 |loss: 0.002190| train set 1.348x speedup, test set 1.851x speedup, val set 0.500x speedup, step: 41
Epoch 42/300 |loss: 0.001990| train set 1.346x speedup, test set 0.883x speedup, val set 0.523x speedup, step: 42
Epoch 43/300 |loss: 0.001881| train set 1.270x speedup, test set 1.416x speedup, val set 0.523x speedup, step: 43
Epoch 44/300 |loss: 0.001930| train set 1.346x speedup, test set 1.437x speedup, val set 0.535x speedup, step: 44
Epoch 45/300 |loss: 0.001902| train set 1.341x speedup, test set 1.883x speedup, val set 0.519x speedup, step: 45
Epoch 46/300 |loss: 0.001925| train set 1.460x speedup, test set 1.416x speedup, val set 0.523x speedup, step: 46
Epoch 47/300 |loss: 0.001632| train set 1.433x speedup, test set 1.416x speedup, val set 0.523x speedup, step: 47
Epoch 48/300 |loss: 0.001829| train set 1.324x speedup, test set 1.883x speedup, val set 0.397x speedup, step: 48
Epoch 49/300 |loss: 0.001769| train set 1.388x speedup, test set 1.883x speedup, val set 0.535x speedup, step: 49
Epoch 50/300 |loss: 0.001995| train set 1.353x speedup, test set 1.928x speedup, val set 0.463x speedup, step: 50
Epoch 51/300 |loss: 0.001783| train set 1.357x speedup, test set 1.462x speedup, val set 0.523x speedup, step: 51
Epoch 52/300 |loss: 0.001617| train set 1.367x speedup, test set 1.965x speedup, val set 0.474x speedup, step: 52
Epoch 53/300 |loss: 0.001494| train set 1.458x speedup, test set 1.965x speedup, val set 0.523x speedup, step: 53
Epoch 54/300 |loss: 0.001576| train set 1.423x speedup, test set 1.965x speedup, val set 0.477x speedup, step: 54
Epoch 55/300 |loss: 0.001370| train set 1.469x speedup, test set 2.023x speedup, val set 0.482x speedup, step: 55
Epoch 56/300 |loss: 0.001266| train set 1.379x speedup, test set 2.023x speedup, val set 0.489x speedup, step: 56
Epoch 57/300 |loss: 0.001520| train set 1.302x speedup, test set 1.883x speedup, val set 0.520x speedup, step: 57
Epoch 58/300 |loss: 0.001666| train set 1.371x speedup, test set 2.023x speedup, val set 0.518x speedup, step: 58
Epoch 59/300 |loss: 0.001620| train set 1.417x speedup, test set 1.951x speedup, val set 0.479x speedup, step: 59
Epoch 60/300 |loss: 0.001361| train set 1.367x speedup, test set 1.347x speedup, val set 0.529x speedup, step: 60
Epoch 61/300 |loss: 0.001447| train set 1.396x speedup, test set 2.040x speedup, val set 0.475x speedup, step: 61
Epoch 62/300 |loss: 0.001408| train set 1.393x speedup, test set 1.999x speedup, val set 0.564x speedup, step: 62
Epoch 63/300 |loss: 0.001459| train set 1.461x speedup, test set 2.040x speedup, val set 0.521x speedup, step: 63
Epoch 64/300 |loss: 0.001265| train set 1.378x speedup, test set 2.040x speedup, val set 0.521x speedup, step: 64
Epoch 65/300 |loss: 0.001273| train set 1.444x speedup, test set 1.965x speedup, val set 0.519x speedup, step: 65
Epoch 66/300 |loss: 0.001323| train set 1.371x speedup, test set 2.093x speedup, val set 0.552x speedup, step: 66
Epoch 67/300 |loss: 0.001239| train set 1.385x speedup, test set 2.040x speedup, val set 0.553x speedup, step: 67
Epoch 68/300 |loss: 0.001279| train set 1.379x speedup, test set 2.015x speedup, val set 0.548x speedup, step: 68
Epoch 69/300 |loss: 0.001208| train set 1.375x speedup, test set 1.995x speedup, val set 0.529x speedup, step: 69
Epoch 70/300 |loss: 0.001204| train set 1.482x speedup, test set 2.093x speedup, val set 0.603x speedup, step: 70
Epoch 71/300 |loss: 0.001285| train set 1.377x speedup, test set 2.015x speedup, val set 0.521x speedup, step: 71
Epoch 72/300 |loss: 0.001226| train set 1.353x speedup, test set 2.064x speedup, val set 0.521x speedup, step: 72
Epoch 73/300 |loss: 0.001182| train set 1.366x speedup, test set 2.040x speedup, val set 0.580x speedup, step: 73
Epoch 74/300 |loss: 0.001207| train set 1.439x speedup, test set 2.040x speedup, val set 0.539x speedup, step: 74
Epoch 75/300 |loss: 0.001626| train set 1.465x speedup, test set 2.040x speedup, val set 0.547x speedup, step: 75
Epoch 76/300 |loss: 0.001132| train set 1.488x speedup, test set 2.093x speedup, val set 0.554x speedup, step: 76
Epoch 77/300 |loss: 0.001379| train set 1.380x speedup, test set 2.040x speedup, val set 0.484x speedup, step: 77
Epoch 78/300 |loss: 0.001139| train set 1.441x speedup, test set 2.155x speedup, val set 0.477x speedup, step: 78
Epoch 79/300 |loss: 0.001166| train set 1.380x speedup, test set 2.093x speedup, val set 0.474x speedup, step: 79
Epoch 80/300 |loss: 0.001269| train set 1.395x speedup, test set 2.093x speedup, val set 0.616x speedup, step: 80
Epoch 81/300 |loss: 0.001481| train set 1.389x speedup, test set 2.093x speedup, val set 0.546x speedup, step: 81
early stopping at epoch 81
Training per epoch cost 2.502 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 76, train speedup 1.488, test speedup 2.093, val speedup 0.554
best test speedup epoch: 14, train speedup 1.293, test speedup 4.884, val speedup 0.797
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 81, train speedup 1.389, test speedup 2.093, val speedup 0.546
execution cost 0:05:34.668018
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.769351, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006066| train set 1.133x speedup, test set 1.256x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006113| train set 1.073x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005338| train set 0.999x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004921| train set 0.964x speedup, test set 2.131x speedup, val set 0.759x speedup, step: 9
Epoch 10/300 |loss: 0.004666| train set 1.198x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004497| train set 1.237x speedup, test set 1.572x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004235| train set 1.175x speedup, test set 1.477x speedup, val set 0.524x speedup, step: 12
Epoch 13/300 |loss: 0.003979| train set 1.318x speedup, test set 1.491x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003833| train set 1.313x speedup, test set 4.176x speedup, val set 0.797x speedup, step: 14
Epoch 15/300 |loss: 0.003573| train set 1.217x speedup, test set 5.189x speedup, val set 0.757x speedup, step: 15
Epoch 16/300 |loss: 0.003680| train set 1.281x speedup, test set 1.491x speedup, val set 0.532x speedup, step: 16
Epoch 17/300 |loss: 0.003527| train set 1.254x speedup, test set 1.610x speedup, val set 0.538x speedup, step: 17
Epoch 18/300 |loss: 0.004020| train set 1.316x speedup, test set 0.907x speedup, val set 0.522x speedup, step: 18
Epoch 19/300 |loss: 0.004568| train set 1.231x speedup, test set 0.912x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003580| train set 1.275x speedup, test set 4.374x speedup, val set 0.529x speedup, step: 20
Epoch 21/300 |loss: 0.003259| train set 1.370x speedup, test set 1.635x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003098| train set 1.234x speedup, test set 3.603x speedup, val set 0.522x speedup, step: 22
Epoch 23/300 |loss: 0.002943| train set 1.283x speedup, test set 1.480x speedup, val set 0.532x speedup, step: 23
Epoch 24/300 |loss: 0.002740| train set 1.347x speedup, test set 1.492x speedup, val set 0.522x speedup, step: 24
Epoch 25/300 |loss: 0.002655| train set 1.321x speedup, test set 0.907x speedup, val set 0.527x speedup, step: 25
Epoch 26/300 |loss: 0.002754| train set 1.277x speedup, test set 1.019x speedup, val set 0.526x speedup, step: 26
Epoch 27/300 |loss: 0.003031| train set 1.313x speedup, test set 1.018x speedup, val set 0.518x speedup, step: 27
Epoch 28/300 |loss: 0.003074| train set 1.326x speedup, test set 1.019x speedup, val set 0.519x speedup, step: 28
Epoch 29/300 |loss: 0.002260| train set 1.337x speedup, test set 1.019x speedup, val set 0.530x speedup, step: 29
Epoch 30/300 |loss: 0.002283| train set 1.337x speedup, test set 1.019x speedup, val set 0.530x speedup, step: 30
Epoch 31/300 |loss: 0.002168| train set 1.377x speedup, test set 0.856x speedup, val set 0.528x speedup, step: 31
Epoch 32/300 |loss: 0.002287| train set 1.301x speedup, test set 1.288x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002798| train set 1.323x speedup, test set 0.856x speedup, val set 0.950x speedup, step: 33
Epoch 34/300 |loss: 0.002121| train set 1.344x speedup, test set 1.019x speedup, val set 0.511x speedup, step: 34
Epoch 35/300 |loss: 0.002155| train set 1.335x speedup, test set 1.268x speedup, val set 0.539x speedup, step: 35
Epoch 36/300 |loss: 0.001998| train set 1.360x speedup, test set 1.051x speedup, val set 0.526x speedup, step: 36
Epoch 37/300 |loss: 0.002172| train set 1.350x speedup, test set 0.865x speedup, val set 0.539x speedup, step: 37
Epoch 38/300 |loss: 0.002087| train set 1.255x speedup, test set 1.019x speedup, val set 0.534x speedup, step: 38
Epoch 39/300 |loss: 0.001994| train set 1.392x speedup, test set 1.397x speedup, val set 0.530x speedup, step: 39
Epoch 40/300 |loss: 0.001886| train set 1.356x speedup, test set 1.051x speedup, val set 0.483x speedup, step: 40
Epoch 41/300 |loss: 0.002077| train set 1.361x speedup, test set 1.077x speedup, val set 0.519x speedup, step: 41
Epoch 42/300 |loss: 0.001860| train set 1.300x speedup, test set 1.803x speedup, val set 0.823x speedup, step: 42
Epoch 43/300 |loss: 0.001944| train set 1.302x speedup, test set 1.348x speedup, val set 0.537x speedup, step: 43
Epoch 44/300 |loss: 0.001923| train set 1.360x speedup, test set 1.400x speedup, val set 0.518x speedup, step: 44
Epoch 45/300 |loss: 0.001864| train set 1.360x speedup, test set 1.809x speedup, val set 0.518x speedup, step: 45
Epoch 46/300 |loss: 0.001968| train set 1.390x speedup, test set 0.915x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001830| train set 1.441x speedup, test set 1.372x speedup, val set 0.500x speedup, step: 47
Epoch 48/300 |loss: 0.001697| train set 1.396x speedup, test set 1.410x speedup, val set 0.477x speedup, step: 48
Epoch 49/300 |loss: 0.001781| train set 1.311x speedup, test set 1.368x speedup, val set 0.519x speedup, step: 49
Epoch 50/300 |loss: 0.001749| train set 1.419x speedup, test set 1.503x speedup, val set 0.519x speedup, step: 50
Epoch 51/300 |loss: 0.001704| train set 1.373x speedup, test set 1.372x speedup, val set 0.519x speedup, step: 51
Epoch 52/300 |loss: 0.001625| train set 1.392x speedup, test set 1.370x speedup, val set 0.427x speedup, step: 52
Epoch 53/300 |loss: 0.001334| train set 1.424x speedup, test set 1.372x speedup, val set 0.520x speedup, step: 53
Epoch 54/300 |loss: 0.001436| train set 1.439x speedup, test set 1.372x speedup, val set 0.520x speedup, step: 54
Epoch 55/300 |loss: 0.001304| train set 1.385x speedup, test set 1.370x speedup, val set 0.480x speedup, step: 55
Epoch 56/300 |loss: 0.001214| train set 1.376x speedup, test set 1.805x speedup, val set 0.526x speedup, step: 56
Epoch 57/300 |loss: 0.001489| train set 1.314x speedup, test set 1.476x speedup, val set 0.697x speedup, step: 57
Epoch 58/300 |loss: 0.001646| train set 1.391x speedup, test set 1.374x speedup, val set 0.427x speedup, step: 58
Epoch 59/300 |loss: 0.001480| train set 1.453x speedup, test set 1.478x speedup, val set 0.478x speedup, step: 59
Epoch 60/300 |loss: 0.001264| train set 1.334x speedup, test set 1.374x speedup, val set 0.927x speedup, step: 60
Epoch 61/300 |loss: 0.001278| train set 1.457x speedup, test set 1.471x speedup, val set 0.516x speedup, step: 61
Epoch 62/300 |loss: 0.001364| train set 1.372x speedup, test set 1.809x speedup, val set 0.827x speedup, step: 62
Epoch 63/300 |loss: 0.001416| train set 1.364x speedup, test set 1.421x speedup, val set 0.685x speedup, step: 63
Epoch 64/300 |loss: 0.001323| train set 1.421x speedup, test set 1.631x speedup, val set 0.518x speedup, step: 64
early stopping at epoch 64
Training per epoch cost 1.405 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 61, train speedup 1.457, test speedup 1.471, val speedup 0.516
best test speedup epoch: 15, train speedup 1.217, test speedup 5.189, val speedup 0.757
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 64, train speedup 1.421, test speedup 1.631, val speedup 0.518
execution cost 0:02:12.808795
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.750277, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 0.979x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 1.085x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005303| train set 0.941x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004851| train set 1.114x speedup, test set 2.131x speedup, val set 0.808x speedup, step: 9
Epoch 10/300 |loss: 0.004619| train set 1.079x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004473| train set 1.220x speedup, test set 1.615x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004272| train set 1.114x speedup, test set 1.491x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004007| train set 1.303x speedup, test set 1.467x speedup, val set 0.507x speedup, step: 13
Epoch 14/300 |loss: 0.003838| train set 1.305x speedup, test set 4.884x speedup, val set 0.520x speedup, step: 14
Epoch 15/300 |loss: 0.003537| train set 1.103x speedup, test set 4.884x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003735| train set 1.241x speedup, test set 1.467x speedup, val set 0.533x speedup, step: 16
Epoch 17/300 |loss: 0.003390| train set 1.260x speedup, test set 1.467x speedup, val set 0.522x speedup, step: 17
Epoch 18/300 |loss: 0.003505| train set 1.353x speedup, test set 0.936x speedup, val set 0.522x speedup, step: 18
Epoch 19/300 |loss: 0.003269| train set 1.250x speedup, test set 1.585x speedup, val set 0.511x speedup, step: 19
Epoch 20/300 |loss: 0.003104| train set 1.315x speedup, test set 1.031x speedup, val set 0.534x speedup, step: 20
Epoch 21/300 |loss: 0.003301| train set 1.243x speedup, test set 1.788x speedup, val set 0.526x speedup, step: 21
Epoch 22/300 |loss: 0.003205| train set 1.129x speedup, test set 3.896x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003159| train set 1.278x speedup, test set 1.332x speedup, val set 0.522x speedup, step: 23
Epoch 24/300 |loss: 0.002933| train set 1.344x speedup, test set 1.317x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002661| train set 1.419x speedup, test set 1.115x speedup, val set 0.523x speedup, step: 25
Epoch 26/300 |loss: 0.002758| train set 1.284x speedup, test set 1.047x speedup, val set 0.525x speedup, step: 26
Epoch 27/300 |loss: 0.002910| train set 1.337x speedup, test set 1.467x speedup, val set 0.518x speedup, step: 27
Epoch 28/300 |loss: 0.002733| train set 1.351x speedup, test set 1.044x speedup, val set 0.518x speedup, step: 28
Epoch 29/300 |loss: 0.002446| train set 1.338x speedup, test set 0.874x speedup, val set 0.518x speedup, step: 29
Epoch 30/300 |loss: 0.002205| train set 1.342x speedup, test set 1.044x speedup, val set 0.519x speedup, step: 30
Epoch 31/300 |loss: 0.002190| train set 1.378x speedup, test set 0.867x speedup, val set 0.520x speedup, step: 31
Epoch 32/300 |loss: 0.002249| train set 1.293x speedup, test set 1.548x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.003086| train set 1.322x speedup, test set 1.273x speedup, val set 0.518x speedup, step: 33
Epoch 34/300 |loss: 0.002228| train set 1.333x speedup, test set 1.048x speedup, val set 0.519x speedup, step: 34
Epoch 35/300 |loss: 0.002056| train set 1.365x speedup, test set 1.007x speedup, val set 0.527x speedup, step: 35
Epoch 36/300 |loss: 0.002004| train set 1.356x speedup, test set 1.308x speedup, val set 0.511x speedup, step: 36
Epoch 37/300 |loss: 0.002223| train set 1.349x speedup, test set 0.874x speedup, val set 0.526x speedup, step: 37
Epoch 38/300 |loss: 0.002176| train set 1.317x speedup, test set 1.308x speedup, val set 0.518x speedup, step: 38
Epoch 39/300 |loss: 0.002016| train set 1.324x speedup, test set 0.856x speedup, val set 0.518x speedup, step: 39
Epoch 40/300 |loss: 0.001812| train set 1.354x speedup, test set 0.874x speedup, val set 0.529x speedup, step: 40
Epoch 41/300 |loss: 0.001948| train set 1.415x speedup, test set 1.064x speedup, val set 0.515x speedup, step: 41
Epoch 42/300 |loss: 0.001897| train set 1.264x speedup, test set 1.044x speedup, val set 0.518x speedup, step: 42
Epoch 43/300 |loss: 0.002141| train set 1.348x speedup, test set 1.064x speedup, val set 0.529x speedup, step: 43
Epoch 44/300 |loss: 0.001962| train set 1.376x speedup, test set 0.875x speedup, val set 0.519x speedup, step: 44
Epoch 45/300 |loss: 0.001977| train set 1.421x speedup, test set 1.538x speedup, val set 0.518x speedup, step: 45
Epoch 46/300 |loss: 0.001892| train set 1.396x speedup, test set 1.520x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001673| train set 1.429x speedup, test set 0.894x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001687| train set 1.420x speedup, test set 1.145x speedup, val set 0.474x speedup, step: 48
Epoch 49/300 |loss: 0.001804| train set 1.431x speedup, test set 0.879x speedup, val set 0.518x speedup, step: 49
Epoch 50/300 |loss: 0.001570| train set 1.424x speedup, test set 1.129x speedup, val set 0.515x speedup, step: 50
Epoch 51/300 |loss: 0.001711| train set 1.434x speedup, test set 0.874x speedup, val set 0.518x speedup, step: 51
Epoch 52/300 |loss: 0.001509| train set 1.401x speedup, test set 1.658x speedup, val set 0.515x speedup, step: 52
Epoch 53/300 |loss: 0.001403| train set 1.434x speedup, test set 0.912x speedup, val set 0.600x speedup, step: 53
Epoch 54/300 |loss: 0.001517| train set 1.430x speedup, test set 1.550x speedup, val set 0.519x speedup, step: 54
Epoch 55/300 |loss: 0.001359| train set 1.419x speedup, test set 1.573x speedup, val set 0.432x speedup, step: 55
Epoch 56/300 |loss: 0.001227| train set 1.393x speedup, test set 0.943x speedup, val set 0.428x speedup, step: 56
Epoch 57/300 |loss: 0.001510| train set 1.296x speedup, test set 1.587x speedup, val set 0.603x speedup, step: 57
Epoch 58/300 |loss: 0.001640| train set 1.427x speedup, test set 1.604x speedup, val set 0.476x speedup, step: 58
Epoch 59/300 |loss: 0.001493| train set 1.485x speedup, test set 1.604x speedup, val set 0.607x speedup, step: 59
Epoch 60/300 |loss: 0.001271| train set 1.327x speedup, test set 1.573x speedup, val set 0.542x speedup, step: 60
Epoch 61/300 |loss: 0.001356| train set 1.425x speedup, test set 2.453x speedup, val set 0.427x speedup, step: 61
Epoch 62/300 |loss: 0.001441| train set 1.333x speedup, test set 1.070x speedup, val set 0.488x speedup, step: 62
Epoch 63/300 |loss: 0.001336| train set 1.437x speedup, test set 5.083x speedup, val set 0.432x speedup, step: 63
Epoch 64/300 |loss: 0.001219| train set 1.409x speedup, test set 3.097x speedup, val set 0.601x speedup, step: 64
Epoch 65/300 |loss: 0.001308| train set 1.392x speedup, test set 1.370x speedup, val set 0.526x speedup, step: 65
Epoch 66/300 |loss: 0.001308| train set 1.379x speedup, test set 2.015x speedup, val set 0.434x speedup, step: 66
Epoch 67/300 |loss: 0.001276| train set 1.408x speedup, test set 0.971x speedup, val set 0.490x speedup, step: 67
Epoch 68/300 |loss: 0.001384| train set 1.361x speedup, test set 1.082x speedup, val set 0.614x speedup, step: 68
Epoch 69/300 |loss: 0.001227| train set 1.379x speedup, test set 1.100x speedup, val set 0.614x speedup, step: 69
Epoch 70/300 |loss: 0.001162| train set 1.478x speedup, test set 1.682x speedup, val set 0.620x speedup, step: 70
Epoch 71/300 |loss: 0.001252| train set 1.414x speedup, test set 1.082x speedup, val set 0.615x speedup, step: 71
Epoch 72/300 |loss: 0.001257| train set 1.341x speedup, test set 1.532x speedup, val set 0.488x speedup, step: 72
Epoch 73/300 |loss: 0.001294| train set 1.421x speedup, test set 1.393x speedup, val set 0.612x speedup, step: 73
early stopping at epoch 73
Training per epoch cost 1.421 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.485, test speedup 1.604, val speedup 0.607
best test speedup epoch: 63, train speedup 1.437, test speedup 5.083, val speedup 0.432
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 73, train speedup 1.421, test speedup 1.393, val speedup 0.612
execution cost 0:02:31.068794
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.741321, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 1.100x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 0.551x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005305| train set 0.941x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004873| train set 1.088x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004691| train set 1.138x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004516| train set 1.235x speedup, test set 1.510x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004274| train set 1.188x speedup, test set 1.524x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004006| train set 1.296x speedup, test set 1.528x speedup, val set 0.503x speedup, step: 13
Epoch 14/300 |loss: 0.003887| train set 1.269x speedup, test set 4.884x speedup, val set 0.797x speedup, step: 14
Epoch 15/300 |loss: 0.003580| train set 1.181x speedup, test set 1.568x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003684| train set 1.308x speedup, test set 2.965x speedup, val set 0.531x speedup, step: 16
Epoch 17/300 |loss: 0.003458| train set 1.336x speedup, test set 1.557x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003688| train set 1.328x speedup, test set 1.603x speedup, val set 0.519x speedup, step: 18
Epoch 19/300 |loss: 0.003862| train set 1.276x speedup, test set 1.631x speedup, val set 0.779x speedup, step: 19
Epoch 20/300 |loss: 0.003163| train set 1.285x speedup, test set 1.520x speedup, val set 0.526x speedup, step: 20
Epoch 21/300 |loss: 0.003052| train set 1.299x speedup, test set 1.031x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003178| train set 1.186x speedup, test set 1.877x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003161| train set 1.313x speedup, test set 1.892x speedup, val set 0.520x speedup, step: 23
Epoch 24/300 |loss: 0.002859| train set 1.362x speedup, test set 1.936x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002724| train set 1.390x speedup, test set 0.875x speedup, val set 0.505x speedup, step: 25
Epoch 26/300 |loss: 0.002885| train set 1.252x speedup, test set 1.069x speedup, val set 0.523x speedup, step: 26
Epoch 27/300 |loss: 0.003082| train set 1.375x speedup, test set 1.492x speedup, val set 0.523x speedup, step: 27
Epoch 28/300 |loss: 0.003200| train set 1.342x speedup, test set 1.965x speedup, val set 0.523x speedup, step: 28
Epoch 29/300 |loss: 0.002323| train set 1.347x speedup, test set 0.901x speedup, val set 0.504x speedup, step: 29
Epoch 30/300 |loss: 0.002244| train set 1.357x speedup, test set 1.965x speedup, val set 0.515x speedup, step: 30
Epoch 31/300 |loss: 0.002246| train set 1.422x speedup, test set 1.462x speedup, val set 0.520x speedup, step: 31
Epoch 32/300 |loss: 0.002326| train set 1.318x speedup, test set 1.965x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002721| train set 1.369x speedup, test set 1.965x speedup, val set 0.519x speedup, step: 33
Epoch 34/300 |loss: 0.002118| train set 1.395x speedup, test set 1.076x speedup, val set 0.523x speedup, step: 34
Epoch 35/300 |loss: 0.001995| train set 1.323x speedup, test set 1.069x speedup, val set 0.521x speedup, step: 35
Epoch 36/300 |loss: 0.001939| train set 1.285x speedup, test set 1.965x speedup, val set 0.533x speedup, step: 36
Epoch 37/300 |loss: 0.002298| train set 1.373x speedup, test set 1.084x speedup, val set 0.524x speedup, step: 37
Epoch 38/300 |loss: 0.002081| train set 1.400x speedup, test set 1.084x speedup, val set 0.531x speedup, step: 38
Epoch 39/300 |loss: 0.002008| train set 1.386x speedup, test set 2.021x speedup, val set 0.520x speedup, step: 39
Epoch 40/300 |loss: 0.001993| train set 1.293x speedup, test set 1.462x speedup, val set 0.539x speedup, step: 40
Epoch 41/300 |loss: 0.001972| train set 1.407x speedup, test set 1.965x speedup, val set 0.475x speedup, step: 41
Epoch 42/300 |loss: 0.001968| train set 1.275x speedup, test set 1.044x speedup, val set 0.476x speedup, step: 42
Epoch 43/300 |loss: 0.001979| train set 1.336x speedup, test set 1.456x speedup, val set 0.533x speedup, step: 43
Epoch 44/300 |loss: 0.001861| train set 1.349x speedup, test set 1.085x speedup, val set 0.518x speedup, step: 44
Epoch 45/300 |loss: 0.001937| train set 1.377x speedup, test set 1.965x speedup, val set 0.518x speedup, step: 45
Epoch 46/300 |loss: 0.001886| train set 1.413x speedup, test set 1.069x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001627| train set 1.480x speedup, test set 1.069x speedup, val set 0.524x speedup, step: 47
Epoch 48/300 |loss: 0.001589| train set 1.380x speedup, test set 1.044x speedup, val set 0.463x speedup, step: 48
Epoch 49/300 |loss: 0.001733| train set 1.402x speedup, test set 2.023x speedup, val set 0.520x speedup, step: 49
Epoch 50/300 |loss: 0.001589| train set 1.401x speedup, test set 2.081x speedup, val set 0.579x speedup, step: 50
Epoch 51/300 |loss: 0.001869| train set 1.437x speedup, test set 1.860x speedup, val set 0.521x speedup, step: 51
Epoch 52/300 |loss: 0.001570| train set 1.377x speedup, test set 2.023x speedup, val set 0.474x speedup, step: 52
Epoch 53/300 |loss: 0.001415| train set 1.459x speedup, test set 1.069x speedup, val set 0.518x speedup, step: 53
Epoch 54/300 |loss: 0.001416| train set 1.374x speedup, test set 2.023x speedup, val set 0.518x speedup, step: 54
Epoch 55/300 |loss: 0.001348| train set 1.422x speedup, test set 2.023x speedup, val set 0.482x speedup, step: 55
Epoch 56/300 |loss: 0.001210| train set 1.446x speedup, test set 2.023x speedup, val set 0.523x speedup, step: 56
Epoch 57/300 |loss: 0.001389| train set 1.299x speedup, test set 1.965x speedup, val set 0.518x speedup, step: 57
Epoch 58/300 |loss: 0.001532| train set 1.356x speedup, test set 2.023x speedup, val set 0.476x speedup, step: 58
Epoch 59/300 |loss: 0.001580| train set 1.440x speedup, test set 2.040x speedup, val set 0.520x speedup, step: 59
Epoch 60/300 |loss: 0.001207| train set 1.323x speedup, test set 1.904x speedup, val set 0.520x speedup, step: 60
Epoch 61/300 |loss: 0.001369| train set 1.382x speedup, test set 1.069x speedup, val set 0.516x speedup, step: 61
Epoch 62/300 |loss: 0.001270| train set 1.394x speedup, test set 1.074x speedup, val set 0.476x speedup, step: 62
Epoch 63/300 |loss: 0.001434| train set 1.455x speedup, test set 2.057x speedup, val set 0.515x speedup, step: 63
Epoch 64/300 |loss: 0.001180| train set 1.422x speedup, test set 2.047x speedup, val set 0.476x speedup, step: 64
Epoch 65/300 |loss: 0.001246| train set 1.483x speedup, test set 1.074x speedup, val set 0.519x speedup, step: 65
Epoch 66/300 |loss: 0.001276| train set 1.394x speedup, test set 2.023x speedup, val set 0.476x speedup, step: 66
Epoch 67/300 |loss: 0.001279| train set 1.402x speedup, test set 1.069x speedup, val set 0.546x speedup, step: 67
Epoch 68/300 |loss: 0.001207| train set 1.395x speedup, test set 2.023x speedup, val set 0.555x speedup, step: 68
Epoch 69/300 |loss: 0.001204| train set 1.412x speedup, test set 2.023x speedup, val set 0.603x speedup, step: 69
Epoch 70/300 |loss: 0.001202| train set 1.452x speedup, test set 2.062x speedup, val set 0.546x speedup, step: 70
Epoch 71/300 |loss: 0.001243| train set 1.454x speedup, test set 1.084x speedup, val set 0.603x speedup, step: 71
Epoch 72/300 |loss: 0.001202| train set 1.399x speedup, test set 1.084x speedup, val set 0.546x speedup, step: 72
Epoch 73/300 |loss: 0.001214| train set 1.455x speedup, test set 1.150x speedup, val set 0.671x speedup, step: 73
early stopping at epoch 73
Training per epoch cost 1.425 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 65, train speedup 1.483, test speedup 1.074, val speedup 0.519
best test speedup epoch: 14, train speedup 1.269, test speedup 4.884, val speedup 0.797
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 73, train speedup 1.455, test speedup 1.150, val speedup 0.671
execution cost 0:02:30.622325
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.730084, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006059| train set 1.096x speedup, test set 2.163x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006124| train set 1.085x speedup, test set 2.154x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005281| train set 0.987x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004909| train set 1.142x speedup, test set 2.131x speedup, val set 0.759x speedup, step: 9
Epoch 10/300 |loss: 0.004636| train set 1.148x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004427| train set 1.236x speedup, test set 1.588x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004213| train set 1.106x speedup, test set 1.524x speedup, val set 0.520x speedup, step: 12
Epoch 13/300 |loss: 0.004025| train set 1.320x speedup, test set 3.985x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003845| train set 1.343x speedup, test set 4.375x speedup, val set 0.802x speedup, step: 14
Epoch 15/300 |loss: 0.003545| train set 1.165x speedup, test set 5.189x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003619| train set 1.307x speedup, test set 3.898x speedup, val set 0.523x speedup, step: 16
Epoch 17/300 |loss: 0.003582| train set 1.253x speedup, test set 1.491x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003567| train set 1.318x speedup, test set 1.657x speedup, val set 0.980x speedup, step: 18
Epoch 19/300 |loss: 0.003558| train set 1.261x speedup, test set 1.093x speedup, val set 0.511x speedup, step: 19
Epoch 20/300 |loss: 0.003215| train set 1.366x speedup, test set 4.224x speedup, val set 0.530x speedup, step: 20
Epoch 21/300 |loss: 0.003037| train set 1.329x speedup, test set 4.080x speedup, val set 0.526x speedup, step: 21
Epoch 22/300 |loss: 0.003215| train set 1.104x speedup, test set 4.069x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003163| train set 1.265x speedup, test set 1.788x speedup, val set 0.529x speedup, step: 23
Epoch 24/300 |loss: 0.002859| train set 1.372x speedup, test set 2.432x speedup, val set 0.527x speedup, step: 24
Epoch 25/300 |loss: 0.002794| train set 1.388x speedup, test set 0.875x speedup, val set 0.527x speedup, step: 25
Epoch 26/300 |loss: 0.002695| train set 1.332x speedup, test set 1.022x speedup, val set 0.525x speedup, step: 26
Epoch 27/300 |loss: 0.002910| train set 1.358x speedup, test set 4.094x speedup, val set 0.530x speedup, step: 27
Epoch 28/300 |loss: 0.002747| train set 1.344x speedup, test set 1.883x speedup, val set 0.529x speedup, step: 28
Epoch 29/300 |loss: 0.002351| train set 1.357x speedup, test set 1.414x speedup, val set 0.527x speedup, step: 29
Epoch 30/300 |loss: 0.002219| train set 1.308x speedup, test set 1.416x speedup, val set 0.515x speedup, step: 30
Epoch 31/300 |loss: 0.002143| train set 1.400x speedup, test set 1.406x speedup, val set 0.525x speedup, step: 31
Epoch 32/300 |loss: 0.002210| train set 1.310x speedup, test set 1.883x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002959| train set 1.351x speedup, test set 1.044x speedup, val set 0.515x speedup, step: 33
Epoch 34/300 |loss: 0.002100| train set 1.345x speedup, test set 1.060x speedup, val set 0.519x speedup, step: 34
Epoch 35/300 |loss: 0.002022| train set 1.330x speedup, test set 1.060x speedup, val set 0.541x speedup, step: 35
Epoch 36/300 |loss: 0.001948| train set 1.347x speedup, test set 1.416x speedup, val set 0.540x speedup, step: 36
Epoch 37/300 |loss: 0.002181| train set 1.388x speedup, test set 1.044x speedup, val set 0.522x speedup, step: 37
Epoch 38/300 |loss: 0.002008| train set 1.300x speedup, test set 1.044x speedup, val set 0.541x speedup, step: 38
Epoch 39/300 |loss: 0.001950| train set 1.350x speedup, test set 1.040x speedup, val set 0.541x speedup, step: 39
Epoch 40/300 |loss: 0.001911| train set 1.309x speedup, test set 1.019x speedup, val set 0.494x speedup, step: 40
Epoch 41/300 |loss: 0.002017| train set 1.349x speedup, test set 1.043x speedup, val set 0.519x speedup, step: 41
Epoch 42/300 |loss: 0.002005| train set 1.291x speedup, test set 1.044x speedup, val set 0.481x speedup, step: 42
Epoch 43/300 |loss: 0.002035| train set 1.291x speedup, test set 1.044x speedup, val set 0.526x speedup, step: 43
Epoch 44/300 |loss: 0.001961| train set 1.384x speedup, test set 1.073x speedup, val set 0.523x speedup, step: 44
Epoch 45/300 |loss: 0.002004| train set 1.350x speedup, test set 1.044x speedup, val set 0.519x speedup, step: 45
early stopping at epoch 45
Training per epoch cost 1.403 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 31, train speedup 1.400, test speedup 1.406, val speedup 0.525
best test speedup epoch: 15, train speedup 1.165, test speedup 5.189, val speedup 0.518
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 45, train speedup 1.350, test speedup 1.044, val speedup 0.519
execution cost 0:01:36.606762
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.758251, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006523| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006066| train set 1.133x speedup, test set 0.990x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006113| train set 1.048x speedup, test set 2.154x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005302| train set 0.942x speedup, test set 2.131x speedup, val set 0.800x speedup, step: 8
Epoch 9/300 |loss: 0.004896| train set 1.149x speedup, test set 1.123x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004662| train set 1.117x speedup, test set 1.169x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004461| train set 1.212x speedup, test set 1.644x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004296| train set 1.191x speedup, test set 1.524x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.003992| train set 1.308x speedup, test set 1.491x speedup, val set 0.503x speedup, step: 13
Epoch 14/300 |loss: 0.003827| train set 1.267x speedup, test set 4.496x speedup, val set 0.797x speedup, step: 14
Epoch 15/300 |loss: 0.003532| train set 1.173x speedup, test set 5.089x speedup, val set 0.797x speedup, step: 15
Epoch 16/300 |loss: 0.003730| train set 1.293x speedup, test set 1.524x speedup, val set 0.530x speedup, step: 16
Epoch 17/300 |loss: 0.003688| train set 1.241x speedup, test set 1.491x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003943| train set 1.327x speedup, test set 1.610x speedup, val set 0.521x speedup, step: 18
Epoch 19/300 |loss: 0.004313| train set 1.223x speedup, test set 1.554x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003709| train set 1.339x speedup, test set 3.896x speedup, val set 0.522x speedup, step: 20
Epoch 21/300 |loss: 0.003317| train set 1.305x speedup, test set 1.548x speedup, val set 0.519x speedup, step: 21
Epoch 22/300 |loss: 0.003031| train set 1.239x speedup, test set 3.896x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.002906| train set 1.264x speedup, test set 1.788x speedup, val set 0.519x speedup, step: 23
Epoch 24/300 |loss: 0.002739| train set 1.351x speedup, test set 1.788x speedup, val set 0.519x speedup, step: 24
Epoch 25/300 |loss: 0.002569| train set 1.307x speedup, test set 1.438x speedup, val set 0.525x speedup, step: 25
Epoch 26/300 |loss: 0.002723| train set 1.331x speedup, test set 1.063x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.002895| train set 1.407x speedup, test set 1.063x speedup, val set 0.519x speedup, step: 27
Epoch 28/300 |loss: 0.002991| train set 1.360x speedup, test set 1.043x speedup, val set 0.530x speedup, step: 28
Epoch 29/300 |loss: 0.002306| train set 1.359x speedup, test set 1.176x speedup, val set 0.530x speedup, step: 29
Epoch 30/300 |loss: 0.002276| train set 1.339x speedup, test set 1.532x speedup, val set 0.515x speedup, step: 30
Epoch 31/300 |loss: 0.002212| train set 1.406x speedup, test set 0.947x speedup, val set 0.530x speedup, step: 31
Epoch 32/300 |loss: 0.002288| train set 1.329x speedup, test set 1.545x speedup, val set 0.823x speedup, step: 32
Epoch 33/300 |loss: 0.002806| train set 1.381x speedup, test set 1.044x speedup, val set 0.939x speedup, step: 33
Epoch 34/300 |loss: 0.002119| train set 1.367x speedup, test set 1.060x speedup, val set 0.519x speedup, step: 34
Epoch 35/300 |loss: 0.002027| train set 1.420x speedup, test set 1.060x speedup, val set 0.519x speedup, step: 35
Epoch 36/300 |loss: 0.001973| train set 1.381x speedup, test set 1.060x speedup, val set 0.823x speedup, step: 36
Epoch 37/300 |loss: 0.002316| train set 1.408x speedup, test set 0.894x speedup, val set 0.800x speedup, step: 37
Epoch 38/300 |loss: 0.002069| train set 1.331x speedup, test set 1.347x speedup, val set 0.539x speedup, step: 38
Epoch 39/300 |loss: 0.002035| train set 1.384x speedup, test set 1.849x speedup, val set 0.519x speedup, step: 39
Epoch 40/300 |loss: 0.001891| train set 1.280x speedup, test set 1.311x speedup, val set 0.855x speedup, step: 40
Epoch 41/300 |loss: 0.002134| train set 1.401x speedup, test set 1.849x speedup, val set 0.527x speedup, step: 41
Epoch 42/300 |loss: 0.001850| train set 1.317x speedup, test set 1.934x speedup, val set 0.726x speedup, step: 42
Epoch 43/300 |loss: 0.001987| train set 1.290x speedup, test set 1.934x speedup, val set 0.847x speedup, step: 43
Epoch 44/300 |loss: 0.001873| train set 1.402x speedup, test set 1.901x speedup, val set 0.827x speedup, step: 44
Epoch 45/300 |loss: 0.001880| train set 1.365x speedup, test set 1.842x speedup, val set 0.800x speedup, step: 45
Epoch 46/300 |loss: 0.001790| train set 1.400x speedup, test set 1.934x speedup, val set 0.705x speedup, step: 46
Epoch 47/300 |loss: 0.001570| train set 1.463x speedup, test set 1.901x speedup, val set 0.800x speedup, step: 47
Epoch 48/300 |loss: 0.001688| train set 1.422x speedup, test set 1.934x speedup, val set 0.658x speedup, step: 48
Epoch 49/300 |loss: 0.001807| train set 1.385x speedup, test set 1.811x speedup, val set 0.717x speedup, step: 49
Epoch 50/300 |loss: 0.001737| train set 1.378x speedup, test set 1.849x speedup, val set 0.646x speedup, step: 50
Epoch 51/300 |loss: 0.001871| train set 1.330x speedup, test set 1.842x speedup, val set 0.800x speedup, step: 51
Epoch 52/300 |loss: 0.001623| train set 1.335x speedup, test set 1.765x speedup, val set 0.597x speedup, step: 52
Epoch 53/300 |loss: 0.001408| train set 1.428x speedup, test set 1.803x speedup, val set 0.819x speedup, step: 53
Epoch 54/300 |loss: 0.001454| train set 1.456x speedup, test set 1.901x speedup, val set 0.678x speedup, step: 54
Epoch 55/300 |loss: 0.001299| train set 1.458x speedup, test set 1.765x speedup, val set 0.949x speedup, step: 55
Epoch 56/300 |loss: 0.001199| train set 1.390x speedup, test set 1.901x speedup, val set 0.957x speedup, step: 56
Epoch 57/300 |loss: 0.001350| train set 1.372x speedup, test set 1.849x speedup, val set 0.743x speedup, step: 57
Epoch 58/300 |loss: 0.001666| train set 1.329x speedup, test set 1.965x speedup, val set 0.676x speedup, step: 58
Epoch 59/300 |loss: 0.001782| train set 1.444x speedup, test set 1.920x speedup, val set 0.555x speedup, step: 59
Epoch 60/300 |loss: 0.001356| train set 1.421x speedup, test set 1.811x speedup, val set 0.961x speedup, step: 60
Epoch 61/300 |loss: 0.001301| train set 1.461x speedup, test set 2.021x speedup, val set 0.924x speedup, step: 61
Epoch 62/300 |loss: 0.001258| train set 1.350x speedup, test set 1.811x speedup, val set 0.668x speedup, step: 62
Epoch 63/300 |loss: 0.001623| train set 1.296x speedup, test set 1.965x speedup, val set 0.819x speedup, step: 63
Epoch 64/300 |loss: 0.001315| train set 1.462x speedup, test set 1.920x speedup, val set 0.966x speedup, step: 64
early stopping at epoch 64
Training per epoch cost 1.416 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 47, train speedup 1.463, test speedup 1.901, val speedup 0.800
best test speedup epoch: 15, train speedup 1.173, test speedup 5.089, val speedup 0.797
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 64, train speedup 1.462, test speedup 1.920, val speedup 0.966
execution cost 0:02:13.009000
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.792874, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006523| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006070| train set 1.096x speedup, test set 2.136x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006147| train set 0.551x speedup, test set 2.154x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005250| train set 0.982x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004892| train set 1.161x speedup, test set 2.131x speedup, val set 0.759x speedup, step: 9
Epoch 10/300 |loss: 0.004678| train set 1.195x speedup, test set 1.185x speedup, val set 0.802x speedup, step: 10
Epoch 11/300 |loss: 0.004479| train set 1.256x speedup, test set 1.477x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004188| train set 1.144x speedup, test set 1.618x speedup, val set 0.521x speedup, step: 12
Epoch 13/300 |loss: 0.003973| train set 1.324x speedup, test set 1.491x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003843| train set 1.330x speedup, test set 4.375x speedup, val set 0.761x speedup, step: 14
Epoch 15/300 |loss: 0.003571| train set 1.229x speedup, test set 4.397x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003569| train set 1.308x speedup, test set 3.839x speedup, val set 0.523x speedup, step: 16
Epoch 17/300 |loss: 0.003513| train set 1.230x speedup, test set 1.491x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003598| train set 1.343x speedup, test set 0.907x speedup, val set 0.934x speedup, step: 18
Epoch 19/300 |loss: 0.003725| train set 1.267x speedup, test set 0.903x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003149| train set 1.280x speedup, test set 1.043x speedup, val set 0.522x speedup, step: 20
Epoch 21/300 |loss: 0.002995| train set 1.261x speedup, test set 4.136x speedup, val set 0.531x speedup, step: 21
Epoch 22/300 |loss: 0.003119| train set 1.253x speedup, test set 1.748x speedup, val set 0.519x speedup, step: 22
Epoch 23/300 |loss: 0.003187| train set 1.305x speedup, test set 1.864x speedup, val set 0.520x speedup, step: 23
Epoch 24/300 |loss: 0.002873| train set 1.324x speedup, test set 1.828x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002674| train set 1.333x speedup, test set 1.748x speedup, val set 0.525x speedup, step: 25
Epoch 26/300 |loss: 0.002648| train set 1.310x speedup, test set 1.019x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.002865| train set 1.315x speedup, test set 1.799x speedup, val set 0.533x speedup, step: 27
Epoch 28/300 |loss: 0.002544| train set 1.319x speedup, test set 1.837x speedup, val set 0.530x speedup, step: 28
Epoch 29/300 |loss: 0.002365| train set 1.324x speedup, test set 1.803x speedup, val set 0.535x speedup, step: 29
Epoch 30/300 |loss: 0.002207| train set 1.338x speedup, test set 1.803x speedup, val set 0.529x speedup, step: 30
Epoch 31/300 |loss: 0.002232| train set 1.386x speedup, test set 1.803x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002311| train set 1.328x speedup, test set 1.883x speedup, val set 0.823x speedup, step: 32
Epoch 33/300 |loss: 0.003063| train set 1.348x speedup, test set 1.803x speedup, val set 0.924x speedup, step: 33
Epoch 34/300 |loss: 0.002189| train set 1.319x speedup, test set 1.813x speedup, val set 0.524x speedup, step: 34
Epoch 35/300 |loss: 0.002098| train set 1.335x speedup, test set 1.803x speedup, val set 0.530x speedup, step: 35
Epoch 36/300 |loss: 0.001997| train set 1.360x speedup, test set 1.803x speedup, val set 0.511x speedup, step: 36
Epoch 37/300 |loss: 0.002355| train set 1.385x speedup, test set 1.370x speedup, val set 0.541x speedup, step: 37
Epoch 38/300 |loss: 0.001998| train set 1.332x speedup, test set 1.803x speedup, val set 0.530x speedup, step: 38
Epoch 39/300 |loss: 0.001913| train set 1.322x speedup, test set 1.426x speedup, val set 0.529x speedup, step: 39
Epoch 40/300 |loss: 0.001916| train set 1.341x speedup, test set 1.370x speedup, val set 0.859x speedup, step: 40
Epoch 41/300 |loss: 0.001964| train set 1.415x speedup, test set 1.370x speedup, val set 0.519x speedup, step: 41
Epoch 42/300 |loss: 0.001902| train set 1.292x speedup, test set 1.883x speedup, val set 0.726x speedup, step: 42
Epoch 43/300 |loss: 0.002350| train set 1.324x speedup, test set 1.438x speedup, val set 0.535x speedup, step: 43
Epoch 44/300 |loss: 0.002015| train set 1.325x speedup, test set 1.370x speedup, val set 0.797x speedup, step: 44
Epoch 45/300 |loss: 0.001887| train set 1.352x speedup, test set 1.416x speedup, val set 0.800x speedup, step: 45
Epoch 46/300 |loss: 0.001972| train set 1.327x speedup, test set 1.370x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001869| train set 1.411x speedup, test set 1.374x speedup, val set 0.800x speedup, step: 47
Epoch 48/300 |loss: 0.001798| train set 1.314x speedup, test set 1.462x speedup, val set 0.697x speedup, step: 48
Epoch 49/300 |loss: 0.001749| train set 1.325x speedup, test set 1.416x speedup, val set 0.717x speedup, step: 49
Epoch 50/300 |loss: 0.001629| train set 1.364x speedup, test set 1.462x speedup, val set 0.706x speedup, step: 50
Epoch 51/300 |loss: 0.001621| train set 1.391x speedup, test set 1.472x speedup, val set 0.797x speedup, step: 51
Epoch 52/300 |loss: 0.001471| train set 1.407x speedup, test set 1.609x speedup, val set 0.697x speedup, step: 52
Epoch 53/300 |loss: 0.001474| train set 1.383x speedup, test set 1.579x speedup, val set 0.827x speedup, step: 53
Epoch 54/300 |loss: 0.001551| train set 1.446x speedup, test set 1.611x speedup, val set 0.491x speedup, step: 54
Epoch 55/300 |loss: 0.001288| train set 1.450x speedup, test set 1.462x speedup, val set 0.477x speedup, step: 55
Epoch 56/300 |loss: 0.001247| train set 1.430x speedup, test set 1.579x speedup, val set 0.491x speedup, step: 56
Epoch 57/300 |loss: 0.001543| train set 1.284x speedup, test set 1.611x speedup, val set 0.701x speedup, step: 57
Epoch 58/300 |loss: 0.001721| train set 1.309x speedup, test set 1.489x speedup, val set 0.476x speedup, step: 58
Epoch 59/300 |loss: 0.001741| train set 1.446x speedup, test set 1.489x speedup, val set 0.474x speedup, step: 59
early stopping at epoch 59
Training per epoch cost 1.412 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 55, train speedup 1.450, test speedup 1.462, val speedup 0.477
best test speedup epoch: 3, train speedup 0.717, test speedup 4.752, val speedup 0.963
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 59, train speedup 1.446, test speedup 1.489, val speedup 0.474
execution cost 0:02:05.433614
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.738815, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006059| train set 1.096x speedup, test set 2.163x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006124| train set 1.085x speedup, test set 2.154x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005281| train set 0.987x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004909| train set 1.142x speedup, test set 2.131x speedup, val set 0.759x speedup, step: 9
Epoch 10/300 |loss: 0.004628| train set 1.198x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004426| train set 1.240x speedup, test set 1.477x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004231| train set 1.162x speedup, test set 1.524x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004003| train set 1.343x speedup, test set 1.524x speedup, val set 0.507x speedup, step: 13
Epoch 14/300 |loss: 0.003870| train set 1.284x speedup, test set 5.159x speedup, val set 0.797x speedup, step: 14
Epoch 15/300 |loss: 0.003553| train set 1.125x speedup, test set 4.965x speedup, val set 0.797x speedup, step: 15
Epoch 16/300 |loss: 0.003665| train set 1.327x speedup, test set 4.738x speedup, val set 0.522x speedup, step: 16
Epoch 17/300 |loss: 0.003514| train set 1.290x speedup, test set 1.491x speedup, val set 0.526x speedup, step: 17
Epoch 18/300 |loss: 0.003723| train set 1.361x speedup, test set 1.600x speedup, val set 0.948x speedup, step: 18
Epoch 19/300 |loss: 0.004263| train set 1.252x speedup, test set 1.492x speedup, val set 0.909x speedup, step: 19
Epoch 20/300 |loss: 0.003985| train set 1.287x speedup, test set 4.738x speedup, val set 0.530x speedup, step: 20
Epoch 21/300 |loss: 0.003529| train set 1.293x speedup, test set 2.261x speedup, val set 0.518x speedup, step: 21
Epoch 22/300 |loss: 0.003211| train set 1.368x speedup, test set 2.146x speedup, val set 0.527x speedup, step: 22
Epoch 23/300 |loss: 0.002996| train set 1.243x speedup, test set 1.951x speedup, val set 0.530x speedup, step: 23
Epoch 24/300 |loss: 0.002798| train set 1.285x speedup, test set 1.883x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002614| train set 1.262x speedup, test set 1.348x speedup, val set 0.510x speedup, step: 25
Epoch 26/300 |loss: 0.002753| train set 1.345x speedup, test set 1.803x speedup, val set 0.510x speedup, step: 26
Epoch 27/300 |loss: 0.002818| train set 1.389x speedup, test set 1.883x speedup, val set 0.535x speedup, step: 27
Epoch 28/300 |loss: 0.002908| train set 1.347x speedup, test set 1.883x speedup, val set 0.924x speedup, step: 28
Epoch 29/300 |loss: 0.002199| train set 1.387x speedup, test set 1.883x speedup, val set 0.543x speedup, step: 29
Epoch 30/300 |loss: 0.002182| train set 1.390x speedup, test set 1.883x speedup, val set 0.529x speedup, step: 30
Epoch 31/300 |loss: 0.002150| train set 1.392x speedup, test set 1.934x speedup, val set 0.527x speedup, step: 31
Epoch 32/300 |loss: 0.002238| train set 1.252x speedup, test set 1.883x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002590| train set 1.390x speedup, test set 1.883x speedup, val set 0.959x speedup, step: 33
Epoch 34/300 |loss: 0.002074| train set 1.396x speedup, test set 1.934x speedup, val set 0.515x speedup, step: 34
Epoch 35/300 |loss: 0.002031| train set 1.371x speedup, test set 1.353x speedup, val set 0.528x speedup, step: 35
Epoch 36/300 |loss: 0.001976| train set 1.314x speedup, test set 1.328x speedup, val set 0.918x speedup, step: 36
Epoch 37/300 |loss: 0.002137| train set 1.386x speedup, test set 1.328x speedup, val set 0.528x speedup, step: 37
Epoch 38/300 |loss: 0.001896| train set 1.281x speedup, test set 1.883x speedup, val set 0.536x speedup, step: 38
Epoch 39/300 |loss: 0.001905| train set 1.404x speedup, test set 1.353x speedup, val set 0.528x speedup, step: 39
Epoch 40/300 |loss: 0.001868| train set 1.323x speedup, test set 1.312x speedup, val set 0.492x speedup, step: 40
Epoch 41/300 |loss: 0.001942| train set 1.402x speedup, test set 1.934x speedup, val set 0.879x speedup, step: 41
Epoch 42/300 |loss: 0.001754| train set 1.317x speedup, test set 1.883x speedup, val set 0.834x speedup, step: 42
Epoch 43/300 |loss: 0.001901| train set 1.303x speedup, test set 1.883x speedup, val set 0.488x speedup, step: 43
Epoch 44/300 |loss: 0.001790| train set 1.471x speedup, test set 1.934x speedup, val set 0.541x speedup, step: 44
Epoch 45/300 |loss: 0.001789| train set 1.325x speedup, test set 1.883x speedup, val set 0.931x speedup, step: 45
Epoch 46/300 |loss: 0.001712| train set 1.421x speedup, test set 1.934x speedup, val set 0.946x speedup, step: 46
Epoch 47/300 |loss: 0.001576| train set 1.441x speedup, test set 1.934x speedup, val set 0.946x speedup, step: 47
Epoch 48/300 |loss: 0.001540| train set 1.432x speedup, test set 1.883x speedup, val set 0.771x speedup, step: 48
Epoch 49/300 |loss: 0.001743| train set 1.369x speedup, test set 1.934x speedup, val set 0.994x speedup, step: 49
Epoch 50/300 |loss: 0.001669| train set 1.447x speedup, test set 1.934x speedup, val set 0.919x speedup, step: 50
Epoch 51/300 |loss: 0.001749| train set 1.424x speedup, test set 1.901x speedup, val set 0.541x speedup, step: 51
Epoch 52/300 |loss: 0.001658| train set 1.404x speedup, test set 1.883x speedup, val set 0.521x speedup, step: 52
Epoch 53/300 |loss: 0.001436| train set 1.374x speedup, test set 1.883x speedup, val set 0.532x speedup, step: 53
Epoch 54/300 |loss: 0.001347| train set 1.468x speedup, test set 1.934x speedup, val set 0.625x speedup, step: 54
Epoch 55/300 |loss: 0.001241| train set 1.435x speedup, test set 1.883x speedup, val set 0.958x speedup, step: 55
Epoch 56/300 |loss: 0.001169| train set 1.415x speedup, test set 1.901x speedup, val set 1.014x speedup, step: 1
Epoch 57/300 |loss: 0.001414| train set 1.381x speedup, test set 1.852x speedup, val set 0.832x speedup, step: 2
Epoch 58/300 |loss: 0.001549| train set 1.379x speedup, test set 1.883x speedup, val set 0.805x speedup, step: 3
Epoch 59/300 |loss: 0.001487| train set 1.439x speedup, test set 1.852x speedup, val set 0.541x speedup, step: 4
Epoch 60/300 |loss: 0.001258| train set 1.399x speedup, test set 1.852x speedup, val set 1.013x speedup, step: 5
Epoch 61/300 |loss: 0.001327| train set 1.419x speedup, test set 1.852x speedup, val set 1.011x speedup, step: 6
Epoch 62/300 |loss: 0.001309| train set 1.398x speedup, test set 1.883x speedup, val set 1.008x speedup, step: 7
Epoch 63/300 |loss: 0.001366| train set 1.369x speedup, test set 1.852x speedup, val set 0.814x speedup, step: 8
Epoch 64/300 |loss: 0.001249| train set 1.369x speedup, test set 1.901x speedup, val set 0.821x speedup, step: 9
early stopping at epoch 64
Training per epoch cost 1.417 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 76.639s, pg runtime 91.784s, speedup 1.198x
02, opt runtime 29.763s, model runtime 79.095s, pg runtime 91.648s, speedup 1.159x
03, opt runtime 30.267s, model runtime 83.433s, pg runtime 100.885s, speedup 1.209x
04, opt runtime 29.286s, model runtime 72.350s, pg runtime 92.131s, speedup 1.273x
05, opt runtime 29.269s, model runtime 71.760s, pg runtime 91.296s, speedup 1.272x
06, opt runtime 29.502s, model runtime 76.631s, pg runtime 112.305s, speedup 1.466x
07, opt runtime 27.886s, model runtime 72.064s, pg runtime 97.629s, speedup 1.355x
08, opt runtime 30.705s, model runtime 70.870s, pg runtime 89.698s, speedup 1.266x
09, opt runtime 27.651s, model runtime 72.517s, pg runtime 91.255s, speedup 1.258x
10, opt runtime 33.637s, model runtime 72.204s, pg runtime 90.618s, speedup 1.255x
11, opt runtime 53.298s, model runtime 180.921s, pg runtime 148.707s, speedup 0.822x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 165.749s, pg runtime 140.742s, speedup 0.849x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 500.041s, pg runtime 601.866s, speedup 1.204x
22, opt runtime 24.079s, model runtime 319.497s, pg runtime 608.707s, speedup 1.905x
23, opt runtime 24.662s, model runtime 510.305s, pg runtime 613.999s, speedup 1.203x
24, opt runtime 24.459s, model runtime 564.126s, pg runtime 608.717s, speedup 1.079x
25, opt runtime 25.236s, model runtime 391.425s, pg runtime 601.756s, speedup 1.537x
26, opt runtime 25.363s, model runtime 412.017s, pg runtime 611.327s, speedup 1.484x
27, opt runtime 24.706s, model runtime 517.819s, pg runtime 610.808s, speedup 1.180x
28, opt runtime 25.075s, model runtime 449.868s, pg runtime 612.430s, speedup 1.361x
29, opt runtime 24.840s, model runtime 446.886s, pg runtime 626.529s, speedup 1.402x
30, opt runtime 24.920s, model runtime 321.831s, pg runtime 610.993s, speedup 1.898x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 44, train speedup 1.471, test speedup 1.934, val speedup 0.541
best test speedup epoch: 14, train speedup 1.284, test speedup 5.159, val speedup 0.797
best validation speedup epoch: 56, train speedup 1.415, test speedup 1.901, val speedup 1.014
last model at epoch 64, train speedup 1.369, test speedup 1.901, val speedup 0.821
execution cost 0:02:12.950067
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.749594, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006523| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006065| train set 0.995x speedup, test set 2.187x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006109| train set 1.086x speedup, test set 2.136x speedup, val set 0.949x speedup, step: 7
Epoch 8/300 |loss: 0.005268| train set 0.973x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004860| train set 1.134x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004625| train set 1.134x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004463| train set 1.194x speedup, test set 1.491x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004226| train set 1.116x speedup, test set 1.524x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004019| train set 1.338x speedup, test set 1.467x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003802| train set 1.279x speedup, test set 4.884x speedup, val set 0.500x speedup, step: 14
Epoch 15/300 |loss: 0.003552| train set 1.162x speedup, test set 5.189x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003659| train set 1.332x speedup, test set 1.524x speedup, val set 0.524x speedup, step: 16
Epoch 17/300 |loss: 0.003524| train set 1.268x speedup, test set 1.467x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003707| train set 1.335x speedup, test set 1.467x speedup, val set 0.953x speedup, step: 18
Epoch 19/300 |loss: 0.003936| train set 1.287x speedup, test set 1.553x speedup, val set 0.512x speedup, step: 19
Epoch 20/300 |loss: 0.003181| train set 1.302x speedup, test set 4.803x speedup, val set 0.534x speedup, step: 20
Epoch 21/300 |loss: 0.003072| train set 1.295x speedup, test set 1.534x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003040| train set 1.161x speedup, test set 3.726x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003172| train set 1.307x speedup, test set 1.558x speedup, val set 0.530x speedup, step: 23
Epoch 24/300 |loss: 0.002832| train set 1.375x speedup, test set 4.830x speedup, val set 0.511x speedup, step: 24
Epoch 25/300 |loss: 0.002591| train set 1.345x speedup, test set 0.856x speedup, val set 0.539x speedup, step: 25
Epoch 26/300 |loss: 0.002755| train set 1.319x speedup, test set 4.333x speedup, val set 0.528x speedup, step: 26
Epoch 27/300 |loss: 0.002928| train set 1.334x speedup, test set 1.496x speedup, val set 0.519x speedup, step: 27
Epoch 28/300 |loss: 0.002947| train set 1.313x speedup, test set 1.412x speedup, val set 0.530x speedup, step: 28
Epoch 29/300 |loss: 0.002377| train set 1.356x speedup, test set 1.406x speedup, val set 0.523x speedup, step: 29
Epoch 30/300 |loss: 0.002232| train set 1.324x speedup, test set 1.435x speedup, val set 0.518x speedup, step: 30
Epoch 31/300 |loss: 0.002177| train set 1.411x speedup, test set 1.434x speedup, val set 0.530x speedup, step: 31
Epoch 32/300 |loss: 0.002289| train set 1.349x speedup, test set 0.883x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002927| train set 1.361x speedup, test set 1.382x speedup, val set 0.518x speedup, step: 33
Epoch 34/300 |loss: 0.002092| train set 1.366x speedup, test set 1.951x speedup, val set 0.523x speedup, step: 34
Epoch 35/300 |loss: 0.002056| train set 1.330x speedup, test set 1.382x speedup, val set 0.530x speedup, step: 35
Epoch 36/300 |loss: 0.001959| train set 1.345x speedup, test set 1.429x speedup, val set 0.505x speedup, step: 36
Epoch 37/300 |loss: 0.002211| train set 1.353x speedup, test set 1.535x speedup, val set 0.530x speedup, step: 37
Epoch 38/300 |loss: 0.002220| train set 1.336x speedup, test set 1.865x speedup, val set 0.500x speedup, step: 38
Epoch 39/300 |loss: 0.001920| train set 1.352x speedup, test set 1.434x speedup, val set 0.520x speedup, step: 39
Epoch 40/300 |loss: 0.001849| train set 1.326x speedup, test set 0.856x speedup, val set 0.485x speedup, step: 40
Epoch 41/300 |loss: 0.002111| train set 1.367x speedup, test set 1.370x speedup, val set 0.520x speedup, step: 41
Epoch 42/300 |loss: 0.001769| train set 1.298x speedup, test set 1.368x speedup, val set 0.477x speedup, step: 42
Epoch 43/300 |loss: 0.001781| train set 1.333x speedup, test set 1.348x speedup, val set 0.478x speedup, step: 43
Epoch 44/300 |loss: 0.001831| train set 1.351x speedup, test set 0.875x speedup, val set 0.519x speedup, step: 44
Epoch 45/300 |loss: 0.001895| train set 1.328x speedup, test set 1.416x speedup, val set 0.476x speedup, step: 45
Epoch 46/300 |loss: 0.001877| train set 1.388x speedup, test set 1.849x speedup, val set 0.477x speedup, step: 46
Epoch 47/300 |loss: 0.001698| train set 1.367x speedup, test set 1.497x speedup, val set 0.520x speedup, step: 47
Epoch 48/300 |loss: 0.001612| train set 1.429x speedup, test set 1.485x speedup, val set 0.541x speedup, step: 48
Epoch 49/300 |loss: 0.001678| train set 1.374x speedup, test set 1.535x speedup, val set 0.519x speedup, step: 49
Epoch 50/300 |loss: 0.001704| train set 1.402x speedup, test set 1.535x speedup, val set 0.482x speedup, step: 50
Epoch 51/300 |loss: 0.001777| train set 1.352x speedup, test set 1.460x speedup, val set 0.434x speedup, step: 51
Epoch 52/300 |loss: 0.001531| train set 1.300x speedup, test set 1.501x speedup, val set 0.425x speedup, step: 52
Epoch 53/300 |loss: 0.001348| train set 1.370x speedup, test set 0.901x speedup, val set 0.603x speedup, step: 53
Epoch 54/300 |loss: 0.001319| train set 1.408x speedup, test set 1.536x speedup, val set 0.483x speedup, step: 54
Epoch 55/300 |loss: 0.001217| train set 1.392x speedup, test set 1.544x speedup, val set 0.488x speedup, step: 55
Epoch 56/300 |loss: 0.001148| train set 1.395x speedup, test set 1.447x speedup, val set 0.613x speedup, step: 56
Epoch 57/300 |loss: 0.001432| train set 1.332x speedup, test set 1.920x speedup, val set 0.479x speedup, step: 57
Epoch 58/300 |loss: 0.001607| train set 1.448x speedup, test set 1.460x speedup, val set 0.482x speedup, step: 58
Epoch 59/300 |loss: 0.001410| train set 1.459x speedup, test set 1.505x speedup, val set 0.492x speedup, step: 59
Epoch 60/300 |loss: 0.001283| train set 1.359x speedup, test set 2.101x speedup, val set 0.617x speedup, step: 60
Epoch 61/300 |loss: 0.001247| train set 1.421x speedup, test set 2.093x speedup, val set 0.479x speedup, step: 61
Epoch 62/300 |loss: 0.001263| train set 1.362x speedup, test set 1.930x speedup, val set 0.492x speedup, step: 62
Epoch 63/300 |loss: 0.001426| train set 1.274x speedup, test set 2.088x speedup, val set 0.486x speedup, step: 63
Epoch 64/300 |loss: 0.001242| train set 1.468x speedup, test set 2.011x speedup, val set 0.482x speedup, step: 64
early stopping at epoch 64
Training per epoch cost 1.425 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 64, train speedup 1.468, test speedup 2.011, val speedup 0.482
best test speedup epoch: 15, train speedup 1.162, test speedup 5.189, val speedup 0.518
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 64, train speedup 1.468, test speedup 2.011, val speedup 0.482
execution cost 0:02:14.306382
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.729202, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 0.979x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 1.085x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005303| train set 0.941x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004854| train set 1.148x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004619| train set 1.120x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004455| train set 1.266x speedup, test set 1.510x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004209| train set 1.083x speedup, test set 1.582x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.004014| train set 1.329x speedup, test set 1.467x speedup, val set 0.507x speedup, step: 13
Epoch 14/300 |loss: 0.003841| train set 1.252x speedup, test set 5.035x speedup, val set 0.518x speedup, step: 14
Epoch 15/300 |loss: 0.003557| train set 1.146x speedup, test set 4.884x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003671| train set 1.355x speedup, test set 1.467x speedup, val set 0.531x speedup, step: 16
Epoch 17/300 |loss: 0.003493| train set 1.262x speedup, test set 1.467x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003697| train set 1.278x speedup, test set 1.605x speedup, val set 0.522x speedup, step: 18
Epoch 19/300 |loss: 0.003816| train set 1.251x speedup, test set 1.626x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003127| train set 1.303x speedup, test set 4.435x speedup, val set 0.541x speedup, step: 20
Epoch 21/300 |loss: 0.003090| train set 1.292x speedup, test set 4.265x speedup, val set 0.530x speedup, step: 21
Epoch 22/300 |loss: 0.003095| train set 1.138x speedup, test set 1.715x speedup, val set 0.525x speedup, step: 22
Epoch 23/300 |loss: 0.003172| train set 1.310x speedup, test set 1.835x speedup, val set 0.519x speedup, step: 23
Epoch 24/300 |loss: 0.002795| train set 1.352x speedup, test set 4.136x speedup, val set 0.518x speedup, step: 24
Epoch 25/300 |loss: 0.002615| train set 1.336x speedup, test set 0.945x speedup, val set 0.527x speedup, step: 25
Epoch 26/300 |loss: 0.002813| train set 1.319x speedup, test set 4.195x speedup, val set 0.540x speedup, step: 26
Epoch 27/300 |loss: 0.003008| train set 1.312x speedup, test set 1.120x speedup, val set 0.522x speedup, step: 27
Epoch 28/300 |loss: 0.002828| train set 1.356x speedup, test set 1.044x speedup, val set 0.519x speedup, step: 28
Epoch 29/300 |loss: 0.002297| train set 1.336x speedup, test set 0.888x speedup, val set 0.519x speedup, step: 29
Epoch 30/300 |loss: 0.002229| train set 1.329x speedup, test set 1.022x speedup, val set 0.518x speedup, step: 30
Epoch 31/300 |loss: 0.002101| train set 1.395x speedup, test set 0.894x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002243| train set 1.227x speedup, test set 1.078x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002891| train set 1.340x speedup, test set 1.429x speedup, val set 0.529x speedup, step: 33
Epoch 34/300 |loss: 0.002027| train set 1.387x speedup, test set 1.044x speedup, val set 0.505x speedup, step: 34
Epoch 35/300 |loss: 0.002001| train set 1.334x speedup, test set 0.883x speedup, val set 0.530x speedup, step: 35
Epoch 36/300 |loss: 0.001944| train set 1.354x speedup, test set 1.060x speedup, val set 0.511x speedup, step: 36
Epoch 37/300 |loss: 0.002164| train set 1.368x speedup, test set 1.085x speedup, val set 0.530x speedup, step: 37
Epoch 38/300 |loss: 0.002059| train set 1.239x speedup, test set 1.328x speedup, val set 0.539x speedup, step: 38
Epoch 39/300 |loss: 0.002024| train set 1.308x speedup, test set 1.311x speedup, val set 0.519x speedup, step: 39
Epoch 40/300 |loss: 0.001821| train set 1.349x speedup, test set 1.094x speedup, val set 0.533x speedup, step: 40
Epoch 41/300 |loss: 0.001897| train set 1.361x speedup, test set 1.426x speedup, val set 0.526x speedup, step: 41
Epoch 42/300 |loss: 0.001781| train set 1.301x speedup, test set 1.044x speedup, val set 0.827x speedup, step: 42
Epoch 43/300 |loss: 0.002019| train set 1.353x speedup, test set 1.078x speedup, val set 0.530x speedup, step: 43
Epoch 44/300 |loss: 0.001902| train set 1.362x speedup, test set 1.426x speedup, val set 0.529x speedup, step: 44
Epoch 45/300 |loss: 0.001901| train set 1.318x speedup, test set 1.416x speedup, val set 0.519x speedup, step: 45
Epoch 46/300 |loss: 0.001850| train set 1.392x speedup, test set 1.849x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001691| train set 1.421x speedup, test set 1.405x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001682| train set 1.374x speedup, test set 1.454x speedup, val set 0.477x speedup, step: 48
Epoch 49/300 |loss: 0.001693| train set 1.396x speedup, test set 1.076x speedup, val set 0.529x speedup, step: 49
Epoch 50/300 |loss: 0.001662| train set 1.363x speedup, test set 1.368x speedup, val set 0.500x speedup, step: 50
Epoch 51/300 |loss: 0.001752| train set 1.370x speedup, test set 1.588x speedup, val set 0.519x speedup, step: 51
Epoch 52/300 |loss: 0.001503| train set 1.395x speedup, test set 1.848x speedup, val set 0.519x speedup, step: 52
Epoch 53/300 |loss: 0.001424| train set 1.389x speedup, test set 1.396x speedup, val set 0.519x speedup, step: 53
Epoch 54/300 |loss: 0.001508| train set 1.373x speedup, test set 1.874x speedup, val set 0.519x speedup, step: 54
Epoch 55/300 |loss: 0.001350| train set 1.404x speedup, test set 1.486x speedup, val set 0.486x speedup, step: 55
Epoch 56/300 |loss: 0.001213| train set 1.413x speedup, test set 1.511x speedup, val set 0.523x speedup, step: 56
Epoch 57/300 |loss: 0.001455| train set 1.369x speedup, test set 1.852x speedup, val set 0.478x speedup, step: 57
Epoch 58/300 |loss: 0.001511| train set 1.427x speedup, test set 1.398x speedup, val set 0.484x speedup, step: 58
Epoch 59/300 |loss: 0.001578| train set 1.445x speedup, test set 1.970x speedup, val set 0.530x speedup, step: 59
Epoch 60/300 |loss: 0.001291| train set 1.348x speedup, test set 1.086x speedup, val set 0.526x speedup, step: 60
Epoch 61/300 |loss: 0.001378| train set 1.443x speedup, test set 1.503x speedup, val set 0.480x speedup, step: 61
Epoch 62/300 |loss: 0.001409| train set 1.356x speedup, test set 1.913x speedup, val set 0.485x speedup, step: 62
Epoch 63/300 |loss: 0.001505| train set 1.419x speedup, test set 1.462x speedup, val set 0.482x speedup, step: 63
Epoch 64/300 |loss: 0.001182| train set 1.389x speedup, test set 1.890x speedup, val set 0.523x speedup, step: 64
Epoch 65/300 |loss: 0.001241| train set 1.387x speedup, test set 1.975x speedup, val set 0.480x speedup, step: 65
Epoch 66/300 |loss: 0.001285| train set 1.378x speedup, test set 2.056x speedup, val set 0.486x speedup, step: 66
Epoch 67/300 |loss: 0.001255| train set 1.424x speedup, test set 1.980x speedup, val set 0.481x speedup, step: 67
Epoch 68/300 |loss: 0.001323| train set 1.366x speedup, test set 2.103x speedup, val set 0.482x speedup, step: 68
Epoch 69/300 |loss: 0.001268| train set 1.323x speedup, test set 2.040x speedup, val set 0.486x speedup, step: 69
Epoch 70/300 |loss: 0.001188| train set 1.422x speedup, test set 2.076x speedup, val set 0.533x speedup, step: 70
Epoch 71/300 |loss: 0.001325| train set 1.412x speedup, test set 2.051x speedup, val set 0.530x speedup, step: 71
Epoch 72/300 |loss: 0.001240| train set 1.357x speedup, test set 1.965x speedup, val set 0.486x speedup, step: 72
Epoch 73/300 |loss: 0.001262| train set 1.392x speedup, test set 2.044x speedup, val set 0.522x speedup, step: 73
early stopping at epoch 73
Training per epoch cost 1.413 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.445, test speedup 1.970, val speedup 0.530
best test speedup epoch: 14, train speedup 1.252, test speedup 5.035, val speedup 0.518
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 73, train speedup 1.392, test speedup 2.044, val speedup 0.522
execution cost 0:02:31.561528
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.753655, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 1.100x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 0.551x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005302| train set 0.933x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004862| train set 1.113x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004661| train set 1.079x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004483| train set 1.206x speedup, test set 1.514x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004200| train set 1.126x speedup, test set 1.491x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004027| train set 1.349x speedup, test set 1.491x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003871| train set 1.320x speedup, test set 4.884x speedup, val set 0.518x speedup, step: 14
Epoch 15/300 |loss: 0.003585| train set 1.267x speedup, test set 5.189x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003700| train set 1.329x speedup, test set 1.467x speedup, val set 0.530x speedup, step: 16
Epoch 17/300 |loss: 0.003428| train set 1.259x speedup, test set 1.467x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003600| train set 1.294x speedup, test set 1.475x speedup, val set 0.519x speedup, step: 18
Epoch 19/300 |loss: 0.003536| train set 1.249x speedup, test set 4.225x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003286| train set 1.328x speedup, test set 1.520x speedup, val set 0.521x speedup, step: 20
Epoch 21/300 |loss: 0.003117| train set 1.314x speedup, test set 1.520x speedup, val set 0.530x speedup, step: 21
Epoch 22/300 |loss: 0.003196| train set 1.135x speedup, test set 3.898x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003157| train set 1.267x speedup, test set 4.286x speedup, val set 0.523x speedup, step: 23
Epoch 24/300 |loss: 0.002869| train set 1.402x speedup, test set 1.818x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002735| train set 1.397x speedup, test set 0.875x speedup, val set 0.544x speedup, step: 25
Epoch 26/300 |loss: 0.002693| train set 1.334x speedup, test set 0.856x speedup, val set 0.528x speedup, step: 26
Epoch 27/300 |loss: 0.002949| train set 1.381x speedup, test set 1.803x speedup, val set 0.523x speedup, step: 27
Epoch 28/300 |loss: 0.002728| train set 1.338x speedup, test set 1.907x speedup, val set 0.519x speedup, step: 28
Epoch 29/300 |loss: 0.002401| train set 1.376x speedup, test set 0.867x speedup, val set 0.535x speedup, step: 29
Epoch 30/300 |loss: 0.002240| train set 1.373x speedup, test set 1.370x speedup, val set 0.491x speedup, step: 30
Epoch 31/300 |loss: 0.002202| train set 1.378x speedup, test set 1.348x speedup, val set 0.524x speedup, step: 31
Epoch 32/300 |loss: 0.002260| train set 1.300x speedup, test set 1.393x speedup, val set 0.504x speedup, step: 32
Epoch 33/300 |loss: 0.002979| train set 1.353x speedup, test set 1.865x speedup, val set 0.515x speedup, step: 33
Epoch 34/300 |loss: 0.002084| train set 1.381x speedup, test set 1.917x speedup, val set 0.523x speedup, step: 34
Epoch 35/300 |loss: 0.002278| train set 1.348x speedup, test set 1.765x speedup, val set 0.521x speedup, step: 35
Epoch 36/300 |loss: 0.002030| train set 1.371x speedup, test set 1.883x speedup, val set 0.530x speedup, step: 36
Epoch 37/300 |loss: 0.002140| train set 1.363x speedup, test set 1.435x speedup, val set 0.521x speedup, step: 37
Epoch 38/300 |loss: 0.001981| train set 1.328x speedup, test set 1.031x speedup, val set 0.532x speedup, step: 38
Epoch 39/300 |loss: 0.001913| train set 1.371x speedup, test set 1.370x speedup, val set 0.520x speedup, step: 39
Epoch 40/300 |loss: 0.001929| train set 1.326x speedup, test set 0.856x speedup, val set 0.483x speedup, step: 40
Epoch 41/300 |loss: 0.001858| train set 1.396x speedup, test set 1.370x speedup, val set 0.525x speedup, step: 41
Epoch 42/300 |loss: 0.001890| train set 1.285x speedup, test set 0.883x speedup, val set 0.518x speedup, step: 42
Epoch 43/300 |loss: 0.001918| train set 1.328x speedup, test set 1.408x speedup, val set 0.520x speedup, step: 43
Epoch 44/300 |loss: 0.001846| train set 1.414x speedup, test set 0.865x speedup, val set 0.518x speedup, step: 44
Epoch 45/300 |loss: 0.001907| train set 1.391x speedup, test set 1.446x speedup, val set 0.518x speedup, step: 45
Epoch 46/300 |loss: 0.001936| train set 1.381x speedup, test set 0.893x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001677| train set 1.430x speedup, test set 1.398x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001596| train set 1.406x speedup, test set 1.416x speedup, val set 0.475x speedup, step: 48
Epoch 49/300 |loss: 0.001768| train set 1.396x speedup, test set 0.883x speedup, val set 0.519x speedup, step: 49
Epoch 50/300 |loss: 0.001645| train set 1.402x speedup, test set 1.470x speedup, val set 0.545x speedup, step: 50
Epoch 51/300 |loss: 0.001750| train set 1.453x speedup, test set 1.470x speedup, val set 0.519x speedup, step: 51
Epoch 52/300 |loss: 0.001457| train set 1.422x speedup, test set 1.470x speedup, val set 0.479x speedup, step: 52
Epoch 53/300 |loss: 0.001404| train set 1.410x speedup, test set 1.470x speedup, val set 0.602x speedup, step: 53
Epoch 54/300 |loss: 0.001442| train set 1.453x speedup, test set 1.470x speedup, val set 0.476x speedup, step: 54
Epoch 55/300 |loss: 0.001439| train set 1.435x speedup, test set 1.470x speedup, val set 0.430x speedup, step: 55
Epoch 56/300 |loss: 0.001310| train set 1.359x speedup, test set 1.470x speedup, val set 0.428x speedup, step: 56
Epoch 57/300 |loss: 0.001451| train set 1.367x speedup, test set 1.439x speedup, val set 0.483x speedup, step: 57
Epoch 58/300 |loss: 0.001649| train set 1.406x speedup, test set 1.470x speedup, val set 0.482x speedup, step: 58
Epoch 59/300 |loss: 0.001676| train set 1.473x speedup, test set 1.445x speedup, val set 0.485x speedup, step: 59
early stopping at epoch 59
Training per epoch cost 1.416 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.473, test speedup 1.445, val speedup 0.485
best test speedup epoch: 15, train speedup 1.267, test speedup 5.189, val speedup 0.500
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 59, train speedup 1.473, test speedup 1.445, val speedup 0.485
execution cost 0:02:03.684397
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.731216, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006059| train set 1.096x speedup, test set 2.163x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006121| train set 1.084x speedup, test set 2.154x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005271| train set 0.938x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004890| train set 1.016x speedup, test set 2.131x speedup, val set 0.759x speedup, step: 9
Epoch 10/300 |loss: 0.004601| train set 1.252x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004428| train set 1.249x speedup, test set 1.496x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004204| train set 1.152x speedup, test set 1.510x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.003984| train set 1.321x speedup, test set 1.491x speedup, val set 0.511x speedup, step: 13
Epoch 14/300 |loss: 0.003869| train set 1.306x speedup, test set 4.046x speedup, val set 0.520x speedup, step: 14
Epoch 15/300 |loss: 0.003535| train set 1.162x speedup, test set 4.365x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003695| train set 1.300x speedup, test set 0.903x speedup, val set 0.522x speedup, step: 16
Epoch 17/300 |loss: 0.003416| train set 1.251x speedup, test set 1.491x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003565| train set 1.340x speedup, test set 0.927x speedup, val set 0.518x speedup, step: 18
Epoch 19/300 |loss: 0.003508| train set 1.242x speedup, test set 0.856x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003261| train set 1.354x speedup, test set 0.934x speedup, val set 0.530x speedup, step: 20
Epoch 21/300 |loss: 0.003105| train set 1.303x speedup, test set 1.044x speedup, val set 0.970x speedup, step: 21
Epoch 22/300 |loss: 0.003187| train set 1.207x speedup, test set 1.346x speedup, val set 0.521x speedup, step: 22
Epoch 23/300 |loss: 0.003082| train set 1.287x speedup, test set 1.531x speedup, val set 0.521x speedup, step: 23
Epoch 24/300 |loss: 0.002874| train set 1.386x speedup, test set 1.043x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002666| train set 1.380x speedup, test set 0.864x speedup, val set 0.536x speedup, step: 25
Epoch 26/300 |loss: 0.002721| train set 1.280x speedup, test set 0.882x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.003024| train set 1.376x speedup, test set 1.368x speedup, val set 0.532x speedup, step: 27
Epoch 28/300 |loss: 0.002854| train set 1.352x speedup, test set 1.448x speedup, val set 0.530x speedup, step: 28
Epoch 29/300 |loss: 0.002297| train set 1.353x speedup, test set 1.416x speedup, val set 0.533x speedup, step: 29
Epoch 30/300 |loss: 0.002204| train set 1.323x speedup, test set 1.462x speedup, val set 0.536x speedup, step: 30
Epoch 31/300 |loss: 0.002156| train set 1.436x speedup, test set 1.492x speedup, val set 0.525x speedup, step: 31
Epoch 32/300 |loss: 0.002216| train set 1.282x speedup, test set 1.416x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002852| train set 1.393x speedup, test set 1.462x speedup, val set 0.521x speedup, step: 33
Epoch 34/300 |loss: 0.002089| train set 1.429x speedup, test set 1.492x speedup, val set 0.535x speedup, step: 34
Epoch 35/300 |loss: 0.002017| train set 1.333x speedup, test set 1.492x speedup, val set 0.530x speedup, step: 35
Epoch 36/300 |loss: 0.002014| train set 1.281x speedup, test set 1.439x speedup, val set 0.536x speedup, step: 36
Epoch 37/300 |loss: 0.002181| train set 1.333x speedup, test set 1.475x speedup, val set 0.536x speedup, step: 37
Epoch 38/300 |loss: 0.001962| train set 1.266x speedup, test set 1.988x speedup, val set 0.536x speedup, step: 38
Epoch 39/300 |loss: 0.001916| train set 1.429x speedup, test set 1.492x speedup, val set 0.528x speedup, step: 39
Epoch 40/300 |loss: 0.001939| train set 1.299x speedup, test set 1.462x speedup, val set 0.528x speedup, step: 40
Epoch 41/300 |loss: 0.001961| train set 1.433x speedup, test set 1.462x speedup, val set 0.530x speedup, step: 41
Epoch 42/300 |loss: 0.001960| train set 1.349x speedup, test set 2.015x speedup, val set 0.487x speedup, step: 42
Epoch 43/300 |loss: 0.001884| train set 1.282x speedup, test set 1.475x speedup, val set 0.541x speedup, step: 43
Epoch 44/300 |loss: 0.001940| train set 1.406x speedup, test set 1.521x speedup, val set 0.543x speedup, step: 44
Epoch 45/300 |loss: 0.001929| train set 1.321x speedup, test set 1.988x speedup, val set 0.519x speedup, step: 45
Epoch 46/300 |loss: 0.001816| train set 1.460x speedup, test set 1.460x speedup, val set 0.523x speedup, step: 46
Epoch 47/300 |loss: 0.001609| train set 1.432x speedup, test set 1.460x speedup, val set 0.523x speedup, step: 47
Epoch 48/300 |loss: 0.001600| train set 1.462x speedup, test set 2.073x speedup, val set 0.454x speedup, step: 48
Epoch 49/300 |loss: 0.001756| train set 1.392x speedup, test set 1.674x speedup, val set 0.530x speedup, step: 49
Epoch 50/300 |loss: 0.001739| train set 1.420x speedup, test set 2.021x speedup, val set 0.510x speedup, step: 50
Epoch 51/300 |loss: 0.001802| train set 1.416x speedup, test set 1.521x speedup, val set 0.859x speedup, step: 51
Epoch 52/300 |loss: 0.001630| train set 1.349x speedup, test set 1.487x speedup, val set 0.477x speedup, step: 52
Epoch 53/300 |loss: 0.001431| train set 1.434x speedup, test set 1.487x speedup, val set 0.523x speedup, step: 53
Epoch 54/300 |loss: 0.001491| train set 1.361x speedup, test set 2.015x speedup, val set 0.515x speedup, step: 54
Epoch 55/300 |loss: 0.001321| train set 1.448x speedup, test set 2.015x speedup, val set 0.486x speedup, step: 55
Epoch 56/300 |loss: 0.001263| train set 1.397x speedup, test set 1.967x speedup, val set 0.496x speedup, step: 56
Epoch 57/300 |loss: 0.001649| train set 1.330x speedup, test set 1.967x speedup, val set 0.737x speedup, step: 57
Epoch 58/300 |loss: 0.001736| train set 1.327x speedup, test set 2.015x speedup, val set 0.713x speedup, step: 58
Epoch 59/300 |loss: 0.001541| train set 1.444x speedup, test set 2.015x speedup, val set 0.482x speedup, step: 59
Epoch 60/300 |loss: 0.001319| train set 1.426x speedup, test set 2.015x speedup, val set 0.537x speedup, step: 60
Epoch 61/300 |loss: 0.001292| train set 1.359x speedup, test set 2.015x speedup, val set 0.482x speedup, step: 61
Epoch 62/300 |loss: 0.001363| train set 1.410x speedup, test set 2.015x speedup, val set 0.716x speedup, step: 62
Epoch 63/300 |loss: 0.001416| train set 1.352x speedup, test set 2.015x speedup, val set 0.716x speedup, step: 63
Epoch 64/300 |loss: 0.001300| train set 1.423x speedup, test set 2.015x speedup, val set 0.953x speedup, step: 64
Epoch 65/300 |loss: 0.001199| train set 1.454x speedup, test set 2.015x speedup, val set 0.724x speedup, step: 65
Epoch 66/300 |loss: 0.001256| train set 1.409x speedup, test set 2.015x speedup, val set 0.821x speedup, step: 66
Epoch 67/300 |loss: 0.001205| train set 1.402x speedup, test set 2.015x speedup, val set 0.723x speedup, step: 67
Epoch 68/300 |loss: 0.001253| train set 1.404x speedup, test set 2.015x speedup, val set 0.716x speedup, step: 68
Epoch 69/300 |loss: 0.001207| train set 1.425x speedup, test set 2.015x speedup, val set 0.801x speedup, step: 69
Epoch 70/300 |loss: 0.001134| train set 1.483x speedup, test set 2.015x speedup, val set 0.825x speedup, step: 70
Epoch 71/300 |loss: 0.001242| train set 1.433x speedup, test set 2.015x speedup, val set 0.520x speedup, step: 71
Epoch 72/300 |loss: 0.001264| train set 1.411x speedup, test set 2.015x speedup, val set 0.716x speedup, step: 72
Epoch 73/300 |loss: 0.001341| train set 1.438x speedup, test set 2.015x speedup, val set 0.827x speedup, step: 73
Epoch 74/300 |loss: 0.001093| train set 1.426x speedup, test set 2.015x speedup, val set 0.522x speedup, step: 74
Epoch 75/300 |loss: 0.001503| train set 1.407x speedup, test set 2.015x speedup, val set 0.606x speedup, step: 75
Epoch 76/300 |loss: 0.001083| train set 1.426x speedup, test set 2.015x speedup, val set 0.522x speedup, step: 76
Epoch 77/300 |loss: 0.001204| train set 1.446x speedup, test set 2.015x speedup, val set 0.485x speedup, step: 77
Epoch 78/300 |loss: 0.001115| train set 1.440x speedup, test set 2.015x speedup, val set 0.486x speedup, step: 78
Epoch 79/300 |loss: 0.001040| train set 1.394x speedup, test set 2.015x speedup, val set 0.707x speedup, step: 79
Epoch 80/300 |loss: 0.001204| train set 1.437x speedup, test set 2.015x speedup, val set 0.940x speedup, step: 80
Epoch 81/300 |loss: 0.001430| train set 1.471x speedup, test set 2.015x speedup, val set 0.825x speedup, step: 81
Epoch 82/300 |loss: 0.001161| train set 1.459x speedup, test set 2.015x speedup, val set 0.949x speedup, step: 82
Epoch 83/300 |loss: 0.000938| train set 1.464x speedup, test set 2.015x speedup, val set 0.600x speedup, step: 83
Epoch 84/300 |loss: 0.000912| train set 1.495x speedup, test set 2.015x speedup, val set 0.805x speedup, step: 84
Epoch 85/300 |loss: 0.000996| train set 1.482x speedup, test set 2.015x speedup, val set 0.977x speedup, step: 85
Epoch 86/300 |loss: 0.001041| train set 1.436x speedup, test set 2.015x speedup, val set 0.811x speedup, step: 86
Epoch 87/300 |loss: 0.000892| train set 1.371x speedup, test set 2.015x speedup, val set 0.549x speedup, step: 87
Epoch 88/300 |loss: 0.000952| train set 1.391x speedup, test set 2.015x speedup, val set 0.937x speedup, step: 88
Epoch 89/300 |loss: 0.001160| train set 1.417x speedup, test set 2.015x speedup, val set 0.949x speedup, step: 89
Epoch 90/300 |loss: 0.000833| train set 1.467x speedup, test set 2.015x speedup, val set 0.960x speedup, step: 90
Epoch 91/300 |loss: 0.000745| train set 1.491x speedup, test set 1.967x speedup, val set 0.971x speedup, step: 91
Epoch 92/300 |loss: 0.000753| train set 1.501x speedup, test set 1.967x speedup, val set 0.934x speedup, step: 92
Epoch 93/300 |loss: 0.000848| train set 1.415x speedup, test set 1.967x speedup, val set 0.949x speedup, step: 93
Epoch 94/300 |loss: 0.000782| train set 1.475x speedup, test set 1.967x speedup, val set 0.945x speedup, step: 94
Epoch 95/300 |loss: 0.000750| train set 1.429x speedup, test set 2.015x speedup, val set 0.934x speedup, step: 95
Epoch 96/300 |loss: 0.000697| train set 1.405x speedup, test set 2.015x speedup, val set 0.934x speedup, step: 96
Epoch 97/300 |loss: 0.000774| train set 1.429x speedup, test set 1.967x speedup, val set 0.934x speedup, step: 97
Epoch 98/300 |loss: 0.000837| train set 1.446x speedup, test set 1.136x speedup, val set 0.463x speedup, step: 98
Epoch 99/300 |loss: 0.000771| train set 1.510x speedup, test set 2.015x speedup, val set 0.927x speedup, step: 99
Epoch 100/300 |loss: 0.000758| train set 1.384x speedup, test set 1.967x speedup, val set 0.934x speedup, step: 100
early stopping at epoch 100
Training per epoch cost 1.356 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 99, train speedup 1.510, test speedup 2.015, val speedup 0.927
best test speedup epoch: 3, train speedup 0.717, test speedup 4.752, val speedup 0.963
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 100, train speedup 1.384, test speedup 1.967, val speedup 0.934
execution cost 0:03:13.377418
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.716160, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006059| train set 1.095x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006070| train set 1.085x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005282| train set 0.935x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004828| train set 0.969x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004646| train set 1.181x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004466| train set 1.270x speedup, test set 1.486x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004205| train set 1.148x speedup, test set 1.524x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004015| train set 1.273x speedup, test set 1.588x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003874| train set 1.309x speedup, test set 5.035x speedup, val set 0.518x speedup, step: 14
Epoch 15/300 |loss: 0.003575| train set 1.195x speedup, test set 5.360x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003631| train set 1.307x speedup, test set 4.225x speedup, val set 0.530x speedup, step: 16
Epoch 17/300 |loss: 0.003466| train set 1.307x speedup, test set 1.588x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003490| train set 1.280x speedup, test set 1.582x speedup, val set 0.521x speedup, step: 18
Epoch 19/300 |loss: 0.003417| train set 1.255x speedup, test set 1.470x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003190| train set 1.370x speedup, test set 5.242x speedup, val set 0.534x speedup, step: 20
Epoch 21/300 |loss: 0.003239| train set 1.290x speedup, test set 1.031x speedup, val set 0.526x speedup, step: 21
Epoch 22/300 |loss: 0.003328| train set 1.100x speedup, test set 4.606x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003205| train set 1.284x speedup, test set 1.047x speedup, val set 0.521x speedup, step: 23
Epoch 24/300 |loss: 0.002756| train set 1.325x speedup, test set 1.842x speedup, val set 0.526x speedup, step: 24
Epoch 25/300 |loss: 0.002689| train set 1.327x speedup, test set 0.856x speedup, val set 0.536x speedup, step: 25
Epoch 26/300 |loss: 0.002789| train set 1.309x speedup, test set 1.047x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.003106| train set 1.345x speedup, test set 1.824x speedup, val set 0.524x speedup, step: 27
Epoch 28/300 |loss: 0.003193| train set 1.344x speedup, test set 1.960x speedup, val set 0.519x speedup, step: 28
Epoch 29/300 |loss: 0.002288| train set 1.335x speedup, test set 0.891x speedup, val set 0.539x speedup, step: 29
Epoch 30/300 |loss: 0.002237| train set 1.327x speedup, test set 1.056x speedup, val set 0.526x speedup, step: 30
Epoch 31/300 |loss: 0.002233| train set 1.365x speedup, test set 0.898x speedup, val set 0.525x speedup, step: 31
Epoch 32/300 |loss: 0.002272| train set 1.311x speedup, test set 1.842x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002674| train set 1.355x speedup, test set 1.883x speedup, val set 0.515x speedup, step: 33
Epoch 34/300 |loss: 0.002124| train set 1.373x speedup, test set 1.044x speedup, val set 0.508x speedup, step: 34
Epoch 35/300 |loss: 0.002081| train set 1.351x speedup, test set 1.074x speedup, val set 0.527x speedup, step: 35
Epoch 36/300 |loss: 0.002064| train set 1.370x speedup, test set 1.883x speedup, val set 0.526x speedup, step: 36
Epoch 37/300 |loss: 0.002182| train set 1.367x speedup, test set 1.052x speedup, val set 0.519x speedup, step: 37
Epoch 38/300 |loss: 0.002140| train set 1.351x speedup, test set 1.044x speedup, val set 0.526x speedup, step: 38
Epoch 39/300 |loss: 0.001998| train set 1.288x speedup, test set 1.445x speedup, val set 0.530x speedup, step: 39
Epoch 40/300 |loss: 0.001982| train set 1.295x speedup, test set 1.901x speedup, val set 0.534x speedup, step: 40
Epoch 41/300 |loss: 0.002166| train set 1.373x speedup, test set 1.872x speedup, val set 0.520x speedup, step: 41
Epoch 42/300 |loss: 0.001920| train set 1.361x speedup, test set 1.883x speedup, val set 0.519x speedup, step: 42
Epoch 43/300 |loss: 0.001980| train set 1.348x speedup, test set 1.883x speedup, val set 0.524x speedup, step: 43
Epoch 44/300 |loss: 0.001966| train set 1.368x speedup, test set 0.875x speedup, val set 0.524x speedup, step: 44
Epoch 45/300 |loss: 0.002005| train set 1.324x speedup, test set 1.911x speedup, val set 0.500x speedup, step: 45
Epoch 46/300 |loss: 0.001960| train set 1.431x speedup, test set 1.849x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001751| train set 1.415x speedup, test set 1.989x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001723| train set 1.405x speedup, test set 1.989x speedup, val set 0.462x speedup, step: 48
Epoch 49/300 |loss: 0.001801| train set 1.351x speedup, test set 1.883x speedup, val set 0.524x speedup, step: 49
Epoch 50/300 |loss: 0.001799| train set 1.437x speedup, test set 1.997x speedup, val set 0.500x speedup, step: 50
Epoch 51/300 |loss: 0.001720| train set 1.360x speedup, test set 1.971x speedup, val set 0.519x speedup, step: 51
Epoch 52/300 |loss: 0.001718| train set 1.388x speedup, test set 1.958x speedup, val set 0.519x speedup, step: 52
Epoch 53/300 |loss: 0.001535| train set 1.381x speedup, test set 1.900x speedup, val set 0.519x speedup, step: 53
Epoch 54/300 |loss: 0.001635| train set 1.396x speedup, test set 1.985x speedup, val set 0.519x speedup, step: 54
Epoch 55/300 |loss: 0.001323| train set 1.371x speedup, test set 1.936x speedup, val set 0.525x speedup, step: 55
Epoch 56/300 |loss: 0.001253| train set 1.348x speedup, test set 1.903x speedup, val set 0.529x speedup, step: 56
Epoch 57/300 |loss: 0.001561| train set 1.287x speedup, test set 1.883x speedup, val set 0.515x speedup, step: 57
Epoch 58/300 |loss: 0.001632| train set 1.376x speedup, test set 1.883x speedup, val set 0.482x speedup, step: 58
Epoch 59/300 |loss: 0.001631| train set 1.442x speedup, test set 1.943x speedup, val set 0.527x speedup, step: 59
Epoch 60/300 |loss: 0.001422| train set 1.379x speedup, test set 1.803x speedup, val set 0.523x speedup, step: 60
Epoch 61/300 |loss: 0.001340| train set 1.406x speedup, test set 2.068x speedup, val set 0.480x speedup, step: 61
Epoch 62/300 |loss: 0.001408| train set 1.386x speedup, test set 1.991x speedup, val set 0.494x speedup, step: 62
Epoch 63/300 |loss: 0.001387| train set 1.460x speedup, test set 2.045x speedup, val set 0.524x speedup, step: 63
Epoch 64/300 |loss: 0.001301| train set 1.376x speedup, test set 2.023x speedup, val set 0.515x speedup, step: 64
Epoch 65/300 |loss: 0.001267| train set 1.421x speedup, test set 1.985x speedup, val set 0.522x speedup, step: 65
early stopping at epoch 65
Training per epoch cost 1.356 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 63, train speedup 1.460, test speedup 2.045, val speedup 0.524
best test speedup epoch: 15, train speedup 1.195, test speedup 5.360, val speedup 0.500
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 65, train speedup 1.421, test speedup 1.985, val speedup 0.522
execution cost 0:02:07.749742
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.721990, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006059| train set 1.095x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006101| train set 1.082x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005263| train set 0.932x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004853| train set 0.995x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004611| train set 1.185x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004464| train set 1.262x speedup, test set 1.486x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004297| train set 1.085x speedup, test set 1.524x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.004018| train set 1.341x speedup, test set 1.491x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003860| train set 1.266x speedup, test set 4.176x speedup, val set 0.500x speedup, step: 14
Epoch 15/300 |loss: 0.003606| train set 1.158x speedup, test set 4.462x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003670| train set 1.361x speedup, test set 1.524x speedup, val set 0.532x speedup, step: 16
Epoch 17/300 |loss: 0.003374| train set 1.275x speedup, test set 1.467x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003672| train set 1.292x speedup, test set 1.600x speedup, val set 0.518x speedup, step: 18
Epoch 19/300 |loss: 0.003589| train set 1.246x speedup, test set 1.038x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003225| train set 1.340x speedup, test set 1.520x speedup, val set 0.541x speedup, step: 20
Epoch 21/300 |loss: 0.003050| train set 1.276x speedup, test set 1.308x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003211| train set 1.181x speedup, test set 1.842x speedup, val set 0.517x speedup, step: 22
Epoch 23/300 |loss: 0.003148| train set 1.345x speedup, test set 1.793x speedup, val set 0.523x speedup, step: 23
Epoch 24/300 |loss: 0.002831| train set 1.374x speedup, test set 1.788x speedup, val set 0.519x speedup, step: 24
Epoch 25/300 |loss: 0.002799| train set 1.367x speedup, test set 1.368x speedup, val set 0.525x speedup, step: 25
Epoch 26/300 |loss: 0.002722| train set 1.293x speedup, test set 1.007x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.003046| train set 1.365x speedup, test set 1.799x speedup, val set 0.522x speedup, step: 27
Epoch 28/300 |loss: 0.002882| train set 1.340x speedup, test set 1.841x speedup, val set 0.519x speedup, step: 28
Epoch 29/300 |loss: 0.002292| train set 1.410x speedup, test set 0.874x speedup, val set 0.523x speedup, step: 29
Epoch 30/300 |loss: 0.002212| train set 1.361x speedup, test set 1.069x speedup, val set 0.519x speedup, step: 30
Epoch 31/300 |loss: 0.002163| train set 1.406x speedup, test set 0.869x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002294| train set 1.261x speedup, test set 1.044x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002883| train set 1.359x speedup, test set 1.069x speedup, val set 0.515x speedup, step: 33
Epoch 34/300 |loss: 0.002089| train set 1.423x speedup, test set 1.044x speedup, val set 0.523x speedup, step: 34
Epoch 35/300 |loss: 0.002054| train set 1.348x speedup, test set 1.007x speedup, val set 0.519x speedup, step: 35
Epoch 36/300 |loss: 0.001947| train set 1.348x speedup, test set 1.416x speedup, val set 0.534x speedup, step: 36
Epoch 37/300 |loss: 0.002187| train set 1.362x speedup, test set 1.069x speedup, val set 0.529x speedup, step: 37
Epoch 38/300 |loss: 0.002101| train set 1.322x speedup, test set 1.044x speedup, val set 0.539x speedup, step: 38
Epoch 39/300 |loss: 0.001893| train set 1.384x speedup, test set 1.765x speedup, val set 0.520x speedup, step: 39
Epoch 40/300 |loss: 0.001921| train set 1.317x speedup, test set 1.268x speedup, val set 0.534x speedup, step: 40
Epoch 41/300 |loss: 0.001910| train set 1.419x speedup, test set 1.883x speedup, val set 0.518x speedup, step: 41
Epoch 42/300 |loss: 0.001961| train set 1.251x speedup, test set 1.044x speedup, val set 0.529x speedup, step: 42
Epoch 43/300 |loss: 0.001958| train set 1.318x speedup, test set 1.825x speedup, val set 0.530x speedup, step: 43
Epoch 44/300 |loss: 0.001943| train set 1.367x speedup, test set 1.676x speedup, val set 0.518x speedup, step: 44
Epoch 45/300 |loss: 0.001801| train set 1.370x speedup, test set 1.883x speedup, val set 0.518x speedup, step: 45
Epoch 46/300 |loss: 0.001810| train set 1.429x speedup, test set 1.803x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001625| train set 1.446x speedup, test set 1.021x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001555| train set 1.420x speedup, test set 1.044x speedup, val set 0.476x speedup, step: 48
Epoch 49/300 |loss: 0.001635| train set 1.356x speedup, test set 1.852x speedup, val set 0.518x speedup, step: 49
Epoch 50/300 |loss: 0.001615| train set 1.409x speedup, test set 1.799x speedup, val set 0.508x speedup, step: 50
Epoch 51/300 |loss: 0.001800| train set 1.405x speedup, test set 1.799x speedup, val set 0.519x speedup, step: 51
Epoch 52/300 |loss: 0.001589| train set 1.383x speedup, test set 1.965x speedup, val set 0.474x speedup, step: 52
Epoch 53/300 |loss: 0.001380| train set 1.393x speedup, test set 1.961x speedup, val set 0.518x speedup, step: 53
Epoch 54/300 |loss: 0.001457| train set 1.384x speedup, test set 1.069x speedup, val set 0.519x speedup, step: 54
Epoch 55/300 |loss: 0.001270| train set 1.387x speedup, test set 1.311x speedup, val set 0.480x speedup, step: 55
Epoch 56/300 |loss: 0.001236| train set 1.401x speedup, test set 1.033x speedup, val set 0.607x speedup, step: 56
Epoch 57/300 |loss: 0.001410| train set 1.343x speedup, test set 1.069x speedup, val set 0.601x speedup, step: 57
Epoch 58/300 |loss: 0.001539| train set 1.360x speedup, test set 1.069x speedup, val set 0.545x speedup, step: 58
Epoch 59/300 |loss: 0.001500| train set 1.405x speedup, test set 2.023x speedup, val set 0.524x speedup, step: 59
Epoch 60/300 |loss: 0.001261| train set 1.359x speedup, test set 1.068x speedup, val set 0.601x speedup, step: 60
Epoch 61/300 |loss: 0.001259| train set 1.427x speedup, test set 1.035x speedup, val set 0.516x speedup, step: 61
Epoch 62/300 |loss: 0.001214| train set 1.390x speedup, test set 2.017x speedup, val set 0.545x speedup, step: 62
Epoch 63/300 |loss: 0.001313| train set 1.427x speedup, test set 2.017x speedup, val set 0.480x speedup, step: 63
Epoch 64/300 |loss: 0.001189| train set 1.358x speedup, test set 1.069x speedup, val set 0.596x speedup, step: 64
Epoch 65/300 |loss: 0.001193| train set 1.420x speedup, test set 1.069x speedup, val set 0.603x speedup, step: 65
Epoch 66/300 |loss: 0.001306| train set 1.414x speedup, test set 1.069x speedup, val set 0.555x speedup, step: 66
Epoch 67/300 |loss: 0.001207| train set 1.403x speedup, test set 1.084x speedup, val set 0.545x speedup, step: 67
Epoch 68/300 |loss: 0.001290| train set 1.378x speedup, test set 1.984x speedup, val set 0.558x speedup, step: 68
Epoch 69/300 |loss: 0.001233| train set 1.401x speedup, test set 1.068x speedup, val set 0.520x speedup, step: 69
Epoch 70/300 |loss: 0.001212| train set 1.428x speedup, test set 2.018x speedup, val set 0.603x speedup, step: 70
Epoch 71/300 |loss: 0.001432| train set 1.347x speedup, test set 1.040x speedup, val set 0.597x speedup, step: 71
Epoch 72/300 |loss: 0.001143| train set 1.404x speedup, test set 1.065x speedup, val set 0.476x speedup, step: 72
Epoch 73/300 |loss: 0.001221| train set 1.392x speedup, test set 1.035x speedup, val set 0.602x speedup, step: 73
Epoch 74/300 |loss: 0.001188| train set 1.431x speedup, test set 2.023x speedup, val set 0.545x speedup, step: 74
Epoch 75/300 |loss: 0.001522| train set 1.414x speedup, test set 2.018x speedup, val set 0.545x speedup, step: 75
Epoch 76/300 |loss: 0.001147| train set 1.484x speedup, test set 2.076x speedup, val set 0.545x speedup, step: 76
Epoch 77/300 |loss: 0.001119| train set 1.390x speedup, test set 2.076x speedup, val set 0.545x speedup, step: 77
Epoch 78/300 |loss: 0.001045| train set 1.343x speedup, test set 1.904x speedup, val set 0.546x speedup, step: 78
Epoch 79/300 |loss: 0.000999| train set 1.344x speedup, test set 1.069x speedup, val set 0.476x speedup, step: 79
Epoch 80/300 |loss: 0.001178| train set 1.465x speedup, test set 1.069x speedup, val set 0.603x speedup, step: 80
Epoch 81/300 |loss: 0.001436| train set 1.366x speedup, test set 1.047x speedup, val set 0.541x speedup, step: 81
early stopping at epoch 81
Training per epoch cost 1.348 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 76, train speedup 1.484, test speedup 2.076, val speedup 0.545
best test speedup epoch: 3, train speedup 0.717, test speedup 4.752, val speedup 0.963
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 81, train speedup 1.366, test speedup 1.047, val speedup 0.541
execution cost 0:02:36.431159
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.735666, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006059| train set 1.096x speedup, test set 2.163x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006121| train set 1.084x speedup, test set 2.154x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005271| train set 0.938x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004890| train set 1.016x speedup, test set 2.131x speedup, val set 0.759x speedup, step: 9
Epoch 10/300 |loss: 0.004601| train set 1.252x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004428| train set 1.249x speedup, test set 1.496x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004202| train set 1.138x speedup, test set 1.516x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.003997| train set 1.299x speedup, test set 1.491x speedup, val set 0.511x speedup, step: 13
Epoch 14/300 |loss: 0.003869| train set 1.320x speedup, test set 4.375x speedup, val set 0.520x speedup, step: 14
Epoch 15/300 |loss: 0.003594| train set 1.102x speedup, test set 1.539x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003628| train set 1.299x speedup, test set 3.839x speedup, val set 0.524x speedup, step: 16
Epoch 17/300 |loss: 0.003375| train set 1.259x speedup, test set 1.491x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003447| train set 1.337x speedup, test set 0.927x speedup, val set 0.518x speedup, step: 18
Epoch 19/300 |loss: 0.003342| train set 1.258x speedup, test set 1.452x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003124| train set 1.323x speedup, test set 1.545x speedup, val set 0.541x speedup, step: 20
Epoch 21/300 |loss: 0.003284| train set 1.313x speedup, test set 1.520x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003216| train set 1.263x speedup, test set 1.513x speedup, val set 0.521x speedup, step: 22
Epoch 23/300 |loss: 0.003016| train set 1.266x speedup, test set 0.933x speedup, val set 0.519x speedup, step: 23
Epoch 24/300 |loss: 0.002818| train set 1.376x speedup, test set 1.545x speedup, val set 0.519x speedup, step: 24
Epoch 25/300 |loss: 0.002860| train set 1.398x speedup, test set 0.875x speedup, val set 0.530x speedup, step: 25
Epoch 26/300 |loss: 0.002773| train set 1.296x speedup, test set 0.927x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.002994| train set 1.392x speedup, test set 0.900x speedup, val set 0.524x speedup, step: 27
Epoch 28/300 |loss: 0.003014| train set 1.336x speedup, test set 0.900x speedup, val set 0.530x speedup, step: 28
Epoch 29/300 |loss: 0.002304| train set 1.367x speedup, test set 0.900x speedup, val set 0.539x speedup, step: 29
Epoch 30/300 |loss: 0.002248| train set 1.357x speedup, test set 0.912x speedup, val set 0.491x speedup, step: 30
Epoch 31/300 |loss: 0.002186| train set 1.450x speedup, test set 0.915x speedup, val set 0.525x speedup, step: 31
Epoch 32/300 |loss: 0.002244| train set 1.217x speedup, test set 1.907x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002756| train set 1.368x speedup, test set 1.432x speedup, val set 0.515x speedup, step: 33
Epoch 34/300 |loss: 0.002090| train set 1.356x speedup, test set 1.072x speedup, val set 0.523x speedup, step: 34
Epoch 35/300 |loss: 0.002055| train set 1.402x speedup, test set 0.899x speedup, val set 0.523x speedup, step: 35
Epoch 36/300 |loss: 0.001955| train set 1.356x speedup, test set 1.461x speedup, val set 0.531x speedup, step: 36
Epoch 37/300 |loss: 0.002184| train set 1.383x speedup, test set 1.100x speedup, val set 0.525x speedup, step: 37
Epoch 38/300 |loss: 0.002131| train set 1.278x speedup, test set 1.952x speedup, val set 0.526x speedup, step: 38
Epoch 39/300 |loss: 0.001987| train set 1.390x speedup, test set 0.922x speedup, val set 0.532x speedup, step: 39
Epoch 40/300 |loss: 0.001855| train set 1.294x speedup, test set 1.460x speedup, val set 0.526x speedup, step: 40
Epoch 41/300 |loss: 0.001938| train set 1.399x speedup, test set 1.805x speedup, val set 0.519x speedup, step: 41
Epoch 42/300 |loss: 0.001975| train set 1.334x speedup, test set 1.907x speedup, val set 0.518x speedup, step: 42
Epoch 43/300 |loss: 0.001938| train set 1.344x speedup, test set 1.948x speedup, val set 0.523x speedup, step: 43
Epoch 44/300 |loss: 0.001920| train set 1.396x speedup, test set 1.805x speedup, val set 0.523x speedup, step: 44
Epoch 45/300 |loss: 0.001984| train set 1.351x speedup, test set 1.911x speedup, val set 0.519x speedup, step: 45
Epoch 46/300 |loss: 0.001924| train set 1.415x speedup, test set 1.836x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001600| train set 1.483x speedup, test set 1.805x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001787| train set 1.420x speedup, test set 1.856x speedup, val set 0.462x speedup, step: 48
Epoch 49/300 |loss: 0.001803| train set 1.412x speedup, test set 1.907x speedup, val set 0.529x speedup, step: 49
Epoch 50/300 |loss: 0.001799| train set 1.382x speedup, test set 1.072x speedup, val set 0.519x speedup, step: 50
Epoch 51/300 |loss: 0.001742| train set 1.384x speedup, test set 1.070x speedup, val set 0.515x speedup, step: 51
Epoch 52/300 |loss: 0.001801| train set 1.380x speedup, test set 1.992x speedup, val set 0.474x speedup, step: 52
Epoch 53/300 |loss: 0.001498| train set 1.439x speedup, test set 1.805x speedup, val set 0.519x speedup, step: 53
Epoch 54/300 |loss: 0.001484| train set 1.363x speedup, test set 2.015x speedup, val set 0.519x speedup, step: 54
Epoch 55/300 |loss: 0.001279| train set 1.425x speedup, test set 1.770x speedup, val set 0.486x speedup, step: 55
Epoch 56/300 |loss: 0.001330| train set 1.385x speedup, test set 1.968x speedup, val set 0.493x speedup, step: 56
Epoch 57/300 |loss: 0.001647| train set 1.352x speedup, test set 1.994x speedup, val set 0.476x speedup, step: 57
Epoch 58/300 |loss: 0.001556| train set 1.438x speedup, test set 1.973x speedup, val set 0.480x speedup, step: 58
Epoch 59/300 |loss: 0.001736| train set 1.380x speedup, test set 2.071x speedup, val set 0.484x speedup, step: 59
Epoch 60/300 |loss: 0.001361| train set 1.410x speedup, test set 1.947x speedup, val set 0.530x speedup, step: 60
Epoch 61/300 |loss: 0.001416| train set 1.471x speedup, test set 2.076x speedup, val set 0.515x speedup, step: 61
Epoch 62/300 |loss: 0.001321| train set 1.383x speedup, test set 1.857x speedup, val set 0.489x speedup, step: 62
Epoch 63/300 |loss: 0.001325| train set 1.415x speedup, test set 1.071x speedup, val set 0.525x speedup, step: 63
Epoch 64/300 |loss: 0.001233| train set 1.371x speedup, test set 2.076x speedup, val set 0.602x speedup, step: 64
Epoch 65/300 |loss: 0.001304| train set 1.413x speedup, test set 1.078x speedup, val set 0.545x speedup, step: 65
Epoch 66/300 |loss: 0.001323| train set 1.449x speedup, test set 1.828x speedup, val set 0.557x speedup, step: 66
Epoch 67/300 |loss: 0.001266| train set 1.413x speedup, test set 1.084x speedup, val set 0.560x speedup, step: 67
Epoch 68/300 |loss: 0.001314| train set 1.460x speedup, test set 2.015x speedup, val set 0.550x speedup, step: 68
Epoch 69/300 |loss: 0.001178| train set 1.376x speedup, test set 1.084x speedup, val set 0.809x speedup, step: 69
Epoch 70/300 |loss: 0.001130| train set 1.452x speedup, test set 2.040x speedup, val set 0.551x speedup, step: 70
Epoch 71/300 |loss: 0.001354| train set 1.449x speedup, test set 2.011x speedup, val set 0.596x speedup, step: 71
Epoch 72/300 |loss: 0.001342| train set 1.434x speedup, test set 1.393x speedup, val set 0.551x speedup, step: 72
early stopping at epoch 72
Training per epoch cost 1.360 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 47, train speedup 1.483, test speedup 1.805, val speedup 0.519
best test speedup epoch: 3, train speedup 0.717, test speedup 4.752, val speedup 0.963
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 72, train speedup 1.434, test speedup 1.393, val speedup 0.551
execution cost 0:02:21.768171
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.714635, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006059| train set 1.095x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006101| train set 1.082x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005288| train set 0.938x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004877| train set 0.984x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004670| train set 1.087x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004484| train set 1.246x speedup, test set 1.644x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004239| train set 1.155x speedup, test set 1.524x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.004004| train set 1.310x speedup, test set 1.491x speedup, val set 0.517x speedup, step: 13
Epoch 14/300 |loss: 0.003869| train set 1.283x speedup, test set 4.884x speedup, val set 0.518x speedup, step: 14
Epoch 15/300 |loss: 0.003549| train set 1.113x speedup, test set 5.089x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003715| train set 1.357x speedup, test set 4.429x speedup, val set 0.524x speedup, step: 16
Epoch 17/300 |loss: 0.003342| train set 1.285x speedup, test set 1.582x speedup, val set 0.531x speedup, step: 17
Epoch 18/300 |loss: 0.003656| train set 1.335x speedup, test set 0.946x speedup, val set 0.522x speedup, step: 18
Epoch 19/300 |loss: 0.003624| train set 1.239x speedup, test set 1.485x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003196| train set 1.294x speedup, test set 5.242x speedup, val set 0.541x speedup, step: 20
Epoch 21/300 |loss: 0.003059| train set 1.330x speedup, test set 1.506x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003154| train set 1.174x speedup, test set 1.715x speedup, val set 0.517x speedup, step: 22
Epoch 23/300 |loss: 0.003182| train set 1.281x speedup, test set 1.031x speedup, val set 0.530x speedup, step: 23
Epoch 24/300 |loss: 0.002926| train set 1.342x speedup, test set 1.907x speedup, val set 0.511x speedup, step: 24
Epoch 25/300 |loss: 0.002749| train set 1.331x speedup, test set 1.382x speedup, val set 0.537x speedup, step: 25
Epoch 26/300 |loss: 0.002755| train set 1.296x speedup, test set 1.476x speedup, val set 0.529x speedup, step: 26
Epoch 27/300 |loss: 0.002847| train set 1.340x speedup, test set 1.500x speedup, val set 0.533x speedup, step: 27
Epoch 28/300 |loss: 0.002552| train set 1.328x speedup, test set 1.429x speedup, val set 0.526x speedup, step: 28
Epoch 29/300 |loss: 0.002337| train set 1.368x speedup, test set 1.476x speedup, val set 0.530x speedup, step: 29
Epoch 30/300 |loss: 0.002261| train set 1.354x speedup, test set 1.031x speedup, val set 0.515x speedup, step: 30
Epoch 31/300 |loss: 0.002169| train set 1.386x speedup, test set 1.429x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002207| train set 1.229x speedup, test set 0.874x speedup, val set 0.504x speedup, step: 32
Epoch 33/300 |loss: 0.003124| train set 1.349x speedup, test set 1.406x speedup, val set 0.515x speedup, step: 33
Epoch 34/300 |loss: 0.002098| train set 1.377x speedup, test set 1.951x speedup, val set 0.519x speedup, step: 34
Epoch 35/300 |loss: 0.002090| train set 1.378x speedup, test set 1.382x speedup, val set 0.527x speedup, step: 35
Epoch 36/300 |loss: 0.001997| train set 1.334x speedup, test set 1.907x speedup, val set 0.529x speedup, step: 36
Epoch 37/300 |loss: 0.002220| train set 1.327x speedup, test set 1.503x speedup, val set 0.524x speedup, step: 37
Epoch 38/300 |loss: 0.002075| train set 1.379x speedup, test set 1.454x speedup, val set 0.537x speedup, step: 38
Epoch 39/300 |loss: 0.002003| train set 1.382x speedup, test set 1.348x speedup, val set 0.515x speedup, step: 39
Epoch 40/300 |loss: 0.001882| train set 1.349x speedup, test set 1.051x speedup, val set 0.474x speedup, step: 40
Epoch 41/300 |loss: 0.002117| train set 1.435x speedup, test set 1.397x speedup, val set 0.522x speedup, step: 41
Epoch 42/300 |loss: 0.001863| train set 1.335x speedup, test set 1.400x speedup, val set 0.477x speedup, step: 42
Epoch 43/300 |loss: 0.001834| train set 1.273x speedup, test set 1.348x speedup, val set 0.519x speedup, step: 43
Epoch 44/300 |loss: 0.001917| train set 1.460x speedup, test set 1.501x speedup, val set 0.520x speedup, step: 44
Epoch 45/300 |loss: 0.001855| train set 1.402x speedup, test set 1.454x speedup, val set 0.519x speedup, step: 45
Epoch 46/300 |loss: 0.001889| train set 1.433x speedup, test set 1.446x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001701| train set 1.431x speedup, test set 1.509x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001622| train set 1.396x speedup, test set 1.484x speedup, val set 0.474x speedup, step: 48
Epoch 49/300 |loss: 0.001728| train set 1.327x speedup, test set 1.445x speedup, val set 0.515x speedup, step: 49
Epoch 50/300 |loss: 0.001578| train set 1.458x speedup, test set 1.422x speedup, val set 0.927x speedup, step: 50
Epoch 51/300 |loss: 0.001690| train set 1.379x speedup, test set 1.468x speedup, val set 0.525x speedup, step: 51
Epoch 52/300 |loss: 0.001506| train set 1.340x speedup, test set 1.509x speedup, val set 0.477x speedup, step: 52
Epoch 53/300 |loss: 0.001415| train set 1.350x speedup, test set 1.500x speedup, val set 0.520x speedup, step: 53
Epoch 54/300 |loss: 0.001559| train set 1.435x speedup, test set 1.468x speedup, val set 0.520x speedup, step: 54
Epoch 55/300 |loss: 0.001275| train set 1.415x speedup, test set 1.499x speedup, val set 0.480x speedup, step: 55
Epoch 56/300 |loss: 0.001197| train set 1.379x speedup, test set 1.500x speedup, val set 0.959x speedup, step: 56
Epoch 57/300 |loss: 0.001433| train set 1.317x speedup, test set 1.476x speedup, val set 0.939x speedup, step: 57
Epoch 58/300 |loss: 0.001575| train set 1.307x speedup, test set 1.494x speedup, val set 0.476x speedup, step: 58
Epoch 59/300 |loss: 0.001730| train set 1.426x speedup, test set 1.500x speedup, val set 0.516x speedup, step: 59
Epoch 60/300 |loss: 0.001293| train set 1.307x speedup, test set 1.476x speedup, val set 0.528x speedup, step: 60
Epoch 61/300 |loss: 0.001221| train set 1.406x speedup, test set 1.509x speedup, val set 0.939x speedup, step: 61
Epoch 62/300 |loss: 0.001254| train set 1.313x speedup, test set 1.918x speedup, val set 0.612x speedup, step: 62
Epoch 63/300 |loss: 0.001560| train set 1.320x speedup, test set 1.524x speedup, val set 0.479x speedup, step: 63
Epoch 64/300 |loss: 0.001360| train set 1.462x speedup, test set 1.541x speedup, val set 0.516x speedup, step: 64
early stopping at epoch 64
Training per epoch cost 1.422 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 64, train speedup 1.462, test speedup 1.541, val speedup 0.516
best test speedup epoch: 20, train speedup 1.294, test speedup 5.242, val speedup 0.541
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 64, train speedup 1.462, test speedup 1.541, val speedup 0.516
execution cost 0:02:13.048335
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.760311, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006523| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006069| train set 1.096x speedup, test set 1.196x speedup, val set 0.949x speedup, step: 6
Epoch 7/300 |loss: 0.006084| train set 1.090x speedup, test set 2.136x speedup, val set 0.937x speedup, step: 7
Epoch 8/300 |loss: 0.005290| train set 0.979x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004865| train set 1.014x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004699| train set 1.063x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004458| train set 1.253x speedup, test set 1.510x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004158| train set 1.089x speedup, test set 1.510x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.004024| train set 1.308x speedup, test set 1.467x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003856| train set 1.279x speedup, test set 4.884x speedup, val set 0.757x speedup, step: 14
Epoch 15/300 |loss: 0.003586| train set 1.126x speedup, test set 5.089x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003688| train set 1.374x speedup, test set 1.491x speedup, val set 0.524x speedup, step: 16
Epoch 17/300 |loss: 0.003505| train set 1.260x speedup, test set 1.491x speedup, val set 0.519x speedup, step: 17
Epoch 18/300 |loss: 0.003984| train set 1.246x speedup, test set 1.600x speedup, val set 0.523x speedup, step: 18
Epoch 19/300 |loss: 0.004453| train set 1.277x speedup, test set 1.467x speedup, val set 0.511x speedup, step: 19
Epoch 20/300 |loss: 0.003615| train set 1.329x speedup, test set 3.819x speedup, val set 0.530x speedup, step: 20
Epoch 21/300 |loss: 0.003303| train set 1.339x speedup, test set 1.534x speedup, val set 0.519x speedup, step: 21
Epoch 22/300 |loss: 0.003233| train set 1.243x speedup, test set 3.685x speedup, val set 0.522x speedup, step: 22
Epoch 23/300 |loss: 0.002994| train set 1.283x speedup, test set 0.874x speedup, val set 0.439x speedup, step: 23
Epoch 24/300 |loss: 0.002717| train set 1.389x speedup, test set 3.766x speedup, val set 0.527x speedup, step: 24
Epoch 25/300 |loss: 0.002547| train set 1.391x speedup, test set 0.864x speedup, val set 0.527x speedup, step: 25
Epoch 26/300 |loss: 0.002734| train set 1.316x speedup, test set 1.019x speedup, val set 0.528x speedup, step: 26
Epoch 27/300 |loss: 0.002946| train set 1.353x speedup, test set 1.018x speedup, val set 0.518x speedup, step: 27
Epoch 28/300 |loss: 0.003126| train set 1.366x speedup, test set 1.541x speedup, val set 0.500x speedup, step: 28
Epoch 29/300 |loss: 0.002246| train set 1.351x speedup, test set 0.876x speedup, val set 0.500x speedup, step: 29
Epoch 30/300 |loss: 0.002216| train set 1.358x speedup, test set 0.865x speedup, val set 0.518x speedup, step: 30
Epoch 31/300 |loss: 0.002156| train set 1.406x speedup, test set 0.870x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002237| train set 1.327x speedup, test set 1.044x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002761| train set 1.371x speedup, test set 0.865x speedup, val set 0.519x speedup, step: 33
Epoch 34/300 |loss: 0.002089| train set 1.348x speedup, test set 0.865x speedup, val set 0.521x speedup, step: 34
Epoch 35/300 |loss: 0.002015| train set 1.367x speedup, test set 0.865x speedup, val set 0.527x speedup, step: 35
Epoch 36/300 |loss: 0.001977| train set 1.363x speedup, test set 1.395x speedup, val set 0.511x speedup, step: 36
Epoch 37/300 |loss: 0.002176| train set 1.359x speedup, test set 1.406x speedup, val set 0.522x speedup, step: 37
Epoch 38/300 |loss: 0.002046| train set 1.319x speedup, test set 1.454x speedup, val set 0.517x speedup, step: 38
Epoch 39/300 |loss: 0.001992| train set 1.385x speedup, test set 0.875x speedup, val set 0.518x speedup, step: 39
Epoch 40/300 |loss: 0.001835| train set 1.373x speedup, test set 0.865x speedup, val set 0.485x speedup, step: 40
Epoch 41/300 |loss: 0.002136| train set 1.404x speedup, test set 1.434x speedup, val set 0.482x speedup, step: 41
Epoch 42/300 |loss: 0.001823| train set 1.349x speedup, test set 1.434x speedup, val set 0.476x speedup, step: 42
Epoch 43/300 |loss: 0.001933| train set 1.338x speedup, test set 1.434x speedup, val set 0.485x speedup, step: 43
Epoch 44/300 |loss: 0.002006| train set 1.454x speedup, test set 1.434x speedup, val set 0.501x speedup, step: 44
Epoch 45/300 |loss: 0.001750| train set 1.371x speedup, test set 1.865x speedup, val set 0.477x speedup, step: 45
Epoch 46/300 |loss: 0.001888| train set 1.408x speedup, test set 1.434x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001772| train set 1.425x speedup, test set 1.434x speedup, val set 0.477x speedup, step: 47
Epoch 48/300 |loss: 0.001692| train set 1.428x speedup, test set 1.406x speedup, val set 0.463x speedup, step: 48
Epoch 49/300 |loss: 0.001711| train set 1.476x speedup, test set 1.970x speedup, val set 0.519x speedup, step: 49
Epoch 50/300 |loss: 0.001686| train set 1.428x speedup, test set 1.397x speedup, val set 0.536x speedup, step: 50
Epoch 51/300 |loss: 0.001623| train set 1.430x speedup, test set 1.471x speedup, val set 0.615x speedup, step: 51
Epoch 52/300 |loss: 0.001421| train set 1.441x speedup, test set 1.447x speedup, val set 0.548x speedup, step: 52
Epoch 53/300 |loss: 0.001372| train set 1.460x speedup, test set 1.451x speedup, val set 0.549x speedup, step: 53
Epoch 54/300 |loss: 0.001449| train set 1.406x speedup, test set 2.021x speedup, val set 0.606x speedup, step: 54
Epoch 55/300 |loss: 0.001283| train set 1.370x speedup, test set 1.852x speedup, val set 0.552x speedup, step: 55
Epoch 56/300 |loss: 0.001182| train set 1.379x speedup, test set 1.970x speedup, val set 0.485x speedup, step: 56
Epoch 57/300 |loss: 0.001370| train set 1.313x speedup, test set 2.021x speedup, val set 0.481x speedup, step: 57
Epoch 58/300 |loss: 0.001472| train set 1.405x speedup, test set 1.918x speedup, val set 0.547x speedup, step: 58
Epoch 59/300 |loss: 0.001448| train set 1.484x speedup, test set 1.852x speedup, val set 0.553x speedup, step: 59
Epoch 60/300 |loss: 0.001299| train set 1.355x speedup, test set 1.501x speedup, val set 0.606x speedup, step: 60
Epoch 61/300 |loss: 0.001267| train set 1.443x speedup, test set 1.980x speedup, val set 0.545x speedup, step: 61
Epoch 62/300 |loss: 0.001304| train set 1.379x speedup, test set 1.918x speedup, val set 0.556x speedup, step: 62
Epoch 63/300 |loss: 0.001384| train set 1.370x speedup, test set 1.446x speedup, val set 0.481x speedup, step: 63
Epoch 64/300 |loss: 0.001243| train set 1.462x speedup, test set 2.056x speedup, val set 0.545x speedup, step: 64
Epoch 65/300 |loss: 0.001284| train set 1.472x speedup, test set 1.852x speedup, val set 0.546x speedup, step: 65
early stopping at epoch 65
Training per epoch cost 1.383 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.484, test speedup 1.852, val speedup 0.553
best test speedup epoch: 15, train speedup 1.126, test speedup 5.089, val speedup 0.518
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 65, train speedup 1.472, test speedup 1.852, val speedup 0.546
execution cost 0:02:11.344356
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.762205, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 0.979x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 1.085x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005307| train set 0.940x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004853| train set 1.148x speedup, test set 2.154x speedup, val set 0.808x speedup, step: 9
Epoch 10/300 |loss: 0.004635| train set 1.133x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004450| train set 1.229x speedup, test set 1.486x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004209| train set 1.093x speedup, test set 1.515x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.004049| train set 1.333x speedup, test set 1.467x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003834| train set 1.262x speedup, test set 4.176x speedup, val set 0.518x speedup, step: 14
Epoch 15/300 |loss: 0.003584| train set 1.242x speedup, test set 4.884x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003664| train set 1.341x speedup, test set 3.839x speedup, val set 0.524x speedup, step: 16
Epoch 17/300 |loss: 0.003484| train set 1.258x speedup, test set 1.573x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003560| train set 1.316x speedup, test set 5.560x speedup, val set 0.522x speedup, step: 18
Epoch 19/300 |loss: 0.003511| train set 1.245x speedup, test set 5.064x speedup, val set 0.513x speedup, step: 19
Epoch 20/300 |loss: 0.003336| train set 1.317x speedup, test set 5.242x speedup, val set 0.533x speedup, step: 20
Epoch 21/300 |loss: 0.003073| train set 1.290x speedup, test set 1.362x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003144| train set 1.122x speedup, test set 1.451x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003164| train set 1.298x speedup, test set 1.389x speedup, val set 0.520x speedup, step: 23
Epoch 24/300 |loss: 0.002840| train set 1.394x speedup, test set 1.379x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002706| train set 1.427x speedup, test set 0.864x speedup, val set 0.532x speedup, step: 25
Epoch 26/300 |loss: 0.002695| train set 1.331x speedup, test set 1.490x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.003118| train set 1.354x speedup, test set 1.299x speedup, val set 0.524x speedup, step: 27
Epoch 28/300 |loss: 0.003124| train set 1.409x speedup, test set 1.454x speedup, val set 0.519x speedup, step: 28
Epoch 29/300 |loss: 0.002303| train set 1.389x speedup, test set 1.503x speedup, val set 0.519x speedup, step: 29
Epoch 30/300 |loss: 0.002204| train set 1.366x speedup, test set 0.901x speedup, val set 0.515x speedup, step: 30
Epoch 31/300 |loss: 0.002193| train set 1.414x speedup, test set 1.503x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002329| train set 1.311x speedup, test set 0.901x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002952| train set 1.372x speedup, test set 1.503x speedup, val set 0.518x speedup, step: 33
Epoch 34/300 |loss: 0.002133| train set 1.373x speedup, test set 1.462x speedup, val set 0.500x speedup, step: 34
Epoch 35/300 |loss: 0.002184| train set 1.340x speedup, test set 1.503x speedup, val set 0.519x speedup, step: 35
Epoch 36/300 |loss: 0.001982| train set 1.358x speedup, test set 1.454x speedup, val set 0.522x speedup, step: 36
Epoch 37/300 |loss: 0.002190| train set 1.430x speedup, test set 1.532x speedup, val set 0.518x speedup, step: 37
Epoch 38/300 |loss: 0.002022| train set 1.348x speedup, test set 0.891x speedup, val set 0.518x speedup, step: 38
Epoch 39/300 |loss: 0.001925| train set 1.400x speedup, test set 0.891x speedup, val set 0.518x speedup, step: 39
Epoch 40/300 |loss: 0.001971| train set 1.328x speedup, test set 1.462x speedup, val set 0.529x speedup, step: 40
Epoch 41/300 |loss: 0.002128| train set 1.424x speedup, test set 1.469x speedup, val set 0.519x speedup, step: 41
Epoch 42/300 |loss: 0.001989| train set 1.297x speedup, test set 0.911x speedup, val set 0.518x speedup, step: 42
Epoch 43/300 |loss: 0.002096| train set 1.393x speedup, test set 0.911x speedup, val set 0.519x speedup, step: 43
Epoch 44/300 |loss: 0.001944| train set 1.438x speedup, test set 1.565x speedup, val set 0.518x speedup, step: 44
Epoch 45/300 |loss: 0.002023| train set 1.374x speedup, test set 1.449x speedup, val set 0.519x speedup, step: 45
Epoch 46/300 |loss: 0.001986| train set 1.435x speedup, test set 1.492x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001759| train set 1.422x speedup, test set 1.492x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001703| train set 1.399x speedup, test set 0.894x speedup, val set 0.476x speedup, step: 48
Epoch 49/300 |loss: 0.001833| train set 1.423x speedup, test set 1.393x speedup, val set 0.518x speedup, step: 49
Epoch 50/300 |loss: 0.001753| train set 1.401x speedup, test set 1.509x speedup, val set 0.515x speedup, step: 50
Epoch 51/300 |loss: 0.001617| train set 1.377x speedup, test set 1.456x speedup, val set 0.518x speedup, step: 51
Epoch 52/300 |loss: 0.001719| train set 1.385x speedup, test set 1.462x speedup, val set 0.474x speedup, step: 52
Epoch 53/300 |loss: 0.001416| train set 1.440x speedup, test set 1.462x speedup, val set 0.518x speedup, step: 53
Epoch 54/300 |loss: 0.001509| train set 1.398x speedup, test set 1.489x speedup, val set 0.519x speedup, step: 54
Epoch 55/300 |loss: 0.001289| train set 1.383x speedup, test set 1.348x speedup, val set 0.527x speedup, step: 55
Epoch 56/300 |loss: 0.001279| train set 1.408x speedup, test set 1.584x speedup, val set 0.477x speedup, step: 56
Epoch 57/300 |loss: 0.001548| train set 1.277x speedup, test set 1.942x speedup, val set 0.518x speedup, step: 57
Epoch 58/300 |loss: 0.001718| train set 1.400x speedup, test set 1.489x speedup, val set 0.476x speedup, step: 58
Epoch 59/300 |loss: 0.001651| train set 1.436x speedup, test set 1.532x speedup, val set 0.520x speedup, step: 59
Epoch 60/300 |loss: 0.001339| train set 1.345x speedup, test set 1.991x speedup, val set 0.526x speedup, step: 60
Epoch 61/300 |loss: 0.001360| train set 1.403x speedup, test set 2.093x speedup, val set 0.518x speedup, step: 61
Epoch 62/300 |loss: 0.001265| train set 1.367x speedup, test set 2.015x speedup, val set 0.483x speedup, step: 62
Epoch 63/300 |loss: 0.001489| train set 1.448x speedup, test set 1.920x speedup, val set 0.523x speedup, step: 63
Epoch 64/300 |loss: 0.001427| train set 1.418x speedup, test set 1.998x speedup, val set 0.607x speedup, step: 64
early stopping at epoch 64
Training per epoch cost 1.358 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 63, train speedup 1.448, test speedup 1.920, val speedup 0.523
best test speedup epoch: 18, train speedup 1.316, test speedup 5.560, val speedup 0.522
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 64, train speedup 1.418, test speedup 1.998, val speedup 0.607
execution cost 0:02:06.049531
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.703960, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 1.100x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 0.551x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005305| train set 0.941x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004875| train set 1.089x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004685| train set 1.255x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004483| train set 1.233x speedup, test set 1.486x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004246| train set 1.158x speedup, test set 1.524x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.004045| train set 1.333x speedup, test set 1.467x speedup, val set 0.510x speedup, step: 13
Epoch 14/300 |loss: 0.003902| train set 1.248x speedup, test set 4.176x speedup, val set 0.797x speedup, step: 14
Epoch 15/300 |loss: 0.003589| train set 1.146x speedup, test set 1.568x speedup, val set 0.518x speedup, step: 15
Epoch 16/300 |loss: 0.003627| train set 1.313x speedup, test set 1.491x speedup, val set 0.523x speedup, step: 16
Epoch 17/300 |loss: 0.003474| train set 1.269x speedup, test set 1.519x speedup, val set 0.530x speedup, step: 17
Epoch 18/300 |loss: 0.003596| train set 1.350x speedup, test set 4.918x speedup, val set 0.518x speedup, step: 18
Epoch 19/300 |loss: 0.003604| train set 1.280x speedup, test set 0.894x speedup, val set 0.510x speedup, step: 19
Epoch 20/300 |loss: 0.003290| train set 1.326x speedup, test set 1.610x speedup, val set 0.533x speedup, step: 20
Epoch 21/300 |loss: 0.003103| train set 1.332x speedup, test set 1.573x speedup, val set 0.529x speedup, step: 21
Epoch 22/300 |loss: 0.003200| train set 1.209x speedup, test set 3.685x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003116| train set 1.309x speedup, test set 1.559x speedup, val set 0.518x speedup, step: 23
Epoch 24/300 |loss: 0.002839| train set 1.375x speedup, test set 1.883x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002788| train set 1.414x speedup, test set 0.856x speedup, val set 0.525x speedup, step: 25
Epoch 26/300 |loss: 0.002937| train set 1.314x speedup, test set 0.907x speedup, val set 0.528x speedup, step: 26
Epoch 27/300 |loss: 0.003043| train set 1.357x speedup, test set 1.799x speedup, val set 0.522x speedup, step: 27
Epoch 28/300 |loss: 0.002965| train set 1.360x speedup, test set 1.416x speedup, val set 0.523x speedup, step: 28
Epoch 29/300 |loss: 0.002330| train set 1.367x speedup, test set 0.901x speedup, val set 0.523x speedup, step: 29
Epoch 30/300 |loss: 0.002265| train set 1.344x speedup, test set 1.462x speedup, val set 0.526x speedup, step: 30
Epoch 31/300 |loss: 0.002211| train set 1.371x speedup, test set 1.370x speedup, val set 0.519x speedup, step: 31
Epoch 32/300 |loss: 0.002224| train set 1.299x speedup, test set 1.416x speedup, val set 0.529x speedup, step: 32
Epoch 33/300 |loss: 0.002660| train set 1.342x speedup, test set 1.416x speedup, val set 0.518x speedup, step: 33
Epoch 34/300 |loss: 0.002068| train set 1.347x speedup, test set 1.416x speedup, val set 0.505x speedup, step: 34
Epoch 35/300 |loss: 0.002131| train set 1.350x speedup, test set 1.370x speedup, val set 0.524x speedup, step: 35
Epoch 36/300 |loss: 0.001966| train set 1.355x speedup, test set 1.416x speedup, val set 0.513x speedup, step: 36
Epoch 37/300 |loss: 0.002373| train set 1.301x speedup, test set 1.462x speedup, val set 0.522x speedup, step: 37
Epoch 38/300 |loss: 0.002049| train set 1.348x speedup, test set 1.416x speedup, val set 0.532x speedup, step: 38
Epoch 39/300 |loss: 0.001968| train set 1.395x speedup, test set 1.365x speedup, val set 0.523x speedup, step: 39
Epoch 40/300 |loss: 0.001923| train set 1.278x speedup, test set 1.462x speedup, val set 0.487x speedup, step: 40
Epoch 41/300 |loss: 0.001934| train set 1.365x speedup, test set 1.462x speedup, val set 0.517x speedup, step: 41
Epoch 42/300 |loss: 0.001941| train set 1.301x speedup, test set 1.462x speedup, val set 0.476x speedup, step: 42
Epoch 43/300 |loss: 0.002167| train set 1.368x speedup, test set 1.359x speedup, val set 0.525x speedup, step: 43
Epoch 44/300 |loss: 0.001866| train set 1.357x speedup, test set 1.462x speedup, val set 0.519x speedup, step: 44
Epoch 45/300 |loss: 0.001928| train set 1.377x speedup, test set 1.416x speedup, val set 0.500x speedup, step: 45
Epoch 46/300 |loss: 0.001918| train set 1.372x speedup, test set 1.370x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001713| train set 1.418x speedup, test set 1.416x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001597| train set 1.367x speedup, test set 1.416x speedup, val set 0.475x speedup, step: 48
Epoch 49/300 |loss: 0.001765| train set 1.389x speedup, test set 1.416x speedup, val set 0.519x speedup, step: 49
Epoch 50/300 |loss: 0.001762| train set 1.465x speedup, test set 0.900x speedup, val set 0.601x speedup, step: 50
Epoch 51/300 |loss: 0.001689| train set 1.369x speedup, test set 1.416x speedup, val set 0.478x speedup, step: 51
Epoch 52/300 |loss: 0.001431| train set 1.409x speedup, test set 1.462x speedup, val set 0.475x speedup, step: 52
Epoch 53/300 |loss: 0.001414| train set 1.397x speedup, test set 1.462x speedup, val set 0.600x speedup, step: 53
Epoch 54/300 |loss: 0.001412| train set 1.415x speedup, test set 1.462x speedup, val set 0.482x speedup, step: 54
Epoch 55/300 |loss: 0.001315| train set 1.390x speedup, test set 1.441x speedup, val set 0.552x speedup, step: 55
Epoch 56/300 |loss: 0.001296| train set 1.347x speedup, test set 1.470x speedup, val set 0.477x speedup, step: 56
Epoch 57/300 |loss: 0.001462| train set 1.319x speedup, test set 1.492x speedup, val set 0.546x speedup, step: 57
Epoch 58/300 |loss: 0.001708| train set 1.355x speedup, test set 1.464x speedup, val set 0.482x speedup, step: 58
Epoch 59/300 |loss: 0.001425| train set 1.470x speedup, test set 1.462x speedup, val set 0.544x speedup, step: 59
Epoch 60/300 |loss: 0.001254| train set 1.351x speedup, test set 1.512x speedup, val set 0.606x speedup, step: 60
Epoch 61/300 |loss: 0.001271| train set 1.432x speedup, test set 1.980x speedup, val set 0.541x speedup, step: 61
Epoch 62/300 |loss: 0.001303| train set 1.407x speedup, test set 2.039x speedup, val set 0.482x speedup, step: 62
Epoch 63/300 |loss: 0.001452| train set 1.381x speedup, test set 1.462x speedup, val set 0.541x speedup, step: 63
Epoch 64/300 |loss: 0.001160| train set 1.449x speedup, test set 1.494x speedup, val set 0.482x speedup, step: 64
Epoch 65/300 |loss: 0.001201| train set 1.442x speedup, test set 1.494x speedup, val set 0.479x speedup, step: 65
Epoch 66/300 |loss: 0.001270| train set 1.403x speedup, test set 1.462x speedup, val set 0.558x speedup, step: 66
Epoch 67/300 |loss: 0.001115| train set 1.366x speedup, test set 1.462x speedup, val set 0.541x speedup, step: 67
Epoch 68/300 |loss: 0.001190| train set 1.431x speedup, test set 1.965x speedup, val set 0.550x speedup, step: 68
Epoch 69/300 |loss: 0.001286| train set 1.411x speedup, test set 1.965x speedup, val set 0.479x speedup, step: 69
Epoch 70/300 |loss: 0.001123| train set 1.442x speedup, test set 1.470x speedup, val set 0.546x speedup, step: 70
Epoch 71/300 |loss: 0.001260| train set 1.361x speedup, test set 1.636x speedup, val set 0.546x speedup, step: 71
Epoch 72/300 |loss: 0.001240| train set 1.347x speedup, test set 1.965x speedup, val set 0.546x speedup, step: 72
Epoch 73/300 |loss: 0.001168| train set 1.380x speedup, test set 2.015x speedup, val set 0.546x speedup, step: 73
early stopping at epoch 73
Training per epoch cost 1.358 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.470, test speedup 1.462, val speedup 0.544
best test speedup epoch: 18, train speedup 1.350, test speedup 4.918, val speedup 0.518
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 73, train speedup 1.380, test speedup 2.015, val speedup 0.546
execution cost 0:02:22.958876
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.721454, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006522| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006058| train set 0.979x speedup, test set 1.196x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006059| train set 1.085x speedup, test set 2.136x speedup, val set 0.930x speedup, step: 7
Epoch 8/300 |loss: 0.005306| train set 0.937x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004859| train set 1.146x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004683| train set 1.256x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004458| train set 1.267x speedup, test set 1.545x speedup, val set 0.500x speedup, step: 11
Epoch 12/300 |loss: 0.004184| train set 1.141x speedup, test set 1.467x speedup, val set 0.522x speedup, step: 12
Epoch 13/300 |loss: 0.003999| train set 1.320x speedup, test set 1.467x speedup, val set 0.511x speedup, step: 13
Epoch 14/300 |loss: 0.003866| train set 1.277x speedup, test set 4.176x speedup, val set 0.518x speedup, step: 14
Epoch 15/300 |loss: 0.003563| train set 1.123x speedup, test set 1.568x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003773| train set 1.287x speedup, test set 3.839x speedup, val set 0.524x speedup, step: 16
Epoch 17/300 |loss: 0.003320| train set 1.261x speedup, test set 4.225x speedup, val set 0.525x speedup, step: 17
Epoch 18/300 |loss: 0.003498| train set 1.331x speedup, test set 4.374x speedup, val set 0.520x speedup, step: 18
Epoch 19/300 |loss: 0.003173| train set 1.244x speedup, test set 5.238x speedup, val set 0.503x speedup, step: 19
Epoch 20/300 |loss: 0.003066| train set 1.361x speedup, test set 1.653x speedup, val set 0.536x speedup, step: 20
Epoch 21/300 |loss: 0.003439| train set 1.288x speedup, test set 1.907x speedup, val set 0.526x speedup, step: 21
Epoch 22/300 |loss: 0.003269| train set 1.112x speedup, test set 4.286x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003192| train set 1.321x speedup, test set 4.286x speedup, val set 0.518x speedup, step: 23
Epoch 24/300 |loss: 0.002933| train set 1.359x speedup, test set 4.244x speedup, val set 0.500x speedup, step: 24
Epoch 25/300 |loss: 0.002591| train set 1.342x speedup, test set 0.862x speedup, val set 0.538x speedup, step: 25
Epoch 26/300 |loss: 0.002787| train set 1.370x speedup, test set 1.436x speedup, val set 0.530x speedup, step: 26
Epoch 27/300 |loss: 0.002892| train set 1.348x speedup, test set 1.803x speedup, val set 0.519x speedup, step: 27
Epoch 28/300 |loss: 0.002699| train set 1.345x speedup, test set 1.951x speedup, val set 0.530x speedup, step: 28
Epoch 29/300 |loss: 0.002341| train set 1.364x speedup, test set 1.951x speedup, val set 0.519x speedup, step: 29
Epoch 30/300 |loss: 0.002188| train set 1.378x speedup, test set 1.951x speedup, val set 0.519x speedup, step: 30
Epoch 31/300 |loss: 0.002156| train set 1.373x speedup, test set 1.452x speedup, val set 0.515x speedup, step: 31
Epoch 32/300 |loss: 0.002207| train set 1.237x speedup, test set 1.044x speedup, val set 0.526x speedup, step: 32
Epoch 33/300 |loss: 0.003040| train set 1.341x speedup, test set 1.406x speedup, val set 0.515x speedup, step: 33
Epoch 34/300 |loss: 0.002165| train set 1.382x speedup, test set 1.951x speedup, val set 0.519x speedup, step: 34
Epoch 35/300 |loss: 0.002047| train set 1.391x speedup, test set 1.382x speedup, val set 0.527x speedup, step: 35
Epoch 36/300 |loss: 0.001955| train set 1.355x speedup, test set 1.501x speedup, val set 0.530x speedup, step: 36
Epoch 37/300 |loss: 0.002188| train set 1.330x speedup, test set 1.517x speedup, val set 0.517x speedup, step: 37
Epoch 38/300 |loss: 0.002038| train set 1.323x speedup, test set 1.454x speedup, val set 0.528x speedup, step: 38
Epoch 39/300 |loss: 0.001931| train set 1.407x speedup, test set 1.434x speedup, val set 0.518x speedup, step: 39
Epoch 40/300 |loss: 0.001916| train set 1.294x speedup, test set 1.080x speedup, val set 0.483x speedup, step: 40
Epoch 41/300 |loss: 0.002064| train set 1.368x speedup, test set 1.278x speedup, val set 0.515x speedup, step: 41
Epoch 42/300 |loss: 0.001834| train set 1.329x speedup, test set 1.435x speedup, val set 0.476x speedup, step: 42
Epoch 43/300 |loss: 0.001992| train set 1.296x speedup, test set 1.080x speedup, val set 0.519x speedup, step: 43
Epoch 44/300 |loss: 0.001865| train set 1.400x speedup, test set 1.465x speedup, val set 0.496x speedup, step: 44
Epoch 45/300 |loss: 0.001907| train set 1.434x speedup, test set 1.416x speedup, val set 0.500x speedup, step: 45
Epoch 46/300 |loss: 0.001993| train set 1.382x speedup, test set 1.434x speedup, val set 0.519x speedup, step: 46
Epoch 47/300 |loss: 0.001780| train set 1.394x speedup, test set 1.426x speedup, val set 0.519x speedup, step: 47
Epoch 48/300 |loss: 0.001655| train set 1.424x speedup, test set 1.513x speedup, val set 0.454x speedup, step: 48
Epoch 49/300 |loss: 0.001776| train set 1.419x speedup, test set 1.411x speedup, val set 0.518x speedup, step: 49
Epoch 50/300 |loss: 0.001578| train set 1.385x speedup, test set 1.063x speedup, val set 0.483x speedup, step: 50
Epoch 51/300 |loss: 0.001689| train set 1.384x speedup, test set 1.426x speedup, val set 0.477x speedup, step: 51
Epoch 52/300 |loss: 0.001488| train set 1.415x speedup, test set 1.396x speedup, val set 0.476x speedup, step: 52
Epoch 53/300 |loss: 0.001391| train set 1.392x speedup, test set 1.396x speedup, val set 0.519x speedup, step: 53
Epoch 54/300 |loss: 0.001525| train set 1.427x speedup, test set 1.396x speedup, val set 0.476x speedup, step: 54
Epoch 55/300 |loss: 0.001346| train set 1.414x speedup, test set 1.447x speedup, val set 0.482x speedup, step: 55
Epoch 56/300 |loss: 0.001209| train set 1.365x speedup, test set 1.134x speedup, val set 0.531x speedup, step: 56
Epoch 57/300 |loss: 0.001394| train set 1.321x speedup, test set 1.113x speedup, val set 0.476x speedup, step: 57
Epoch 58/300 |loss: 0.001726| train set 1.437x speedup, test set 1.460x speedup, val set 0.476x speedup, step: 58
Epoch 59/300 |loss: 0.001561| train set 1.441x speedup, test set 1.396x speedup, val set 0.476x speedup, step: 59
Epoch 60/300 |loss: 0.001412| train set 1.326x speedup, test set 1.090x speedup, val set 0.525x speedup, step: 60
Epoch 61/300 |loss: 0.001273| train set 1.419x speedup, test set 1.460x speedup, val set 0.474x speedup, step: 61
Epoch 62/300 |loss: 0.001271| train set 1.407x speedup, test set 1.396x speedup, val set 0.465x speedup, step: 62
Epoch 63/300 |loss: 0.001429| train set 1.328x speedup, test set 1.437x speedup, val set 0.483x speedup, step: 63
Epoch 64/300 |loss: 0.001315| train set 1.396x speedup, test set 1.463x speedup, val set 0.519x speedup, step: 64
Epoch 65/300 |loss: 0.001283| train set 1.433x speedup, test set 1.375x speedup, val set 0.481x speedup, step: 65
early stopping at epoch 65
Training per epoch cost 1.354 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.441, test speedup 1.396, val speedup 0.476
best test speedup epoch: 19, train speedup 1.244, test speedup 5.238, val speedup 0.503
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 65, train speedup 1.433, test speedup 1.375, val speedup 0.481
execution cost 0:02:09.022787
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (79, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.728797, and there are 3871 training samples
in channel 9
Epoch 0/300 |loss: 0.026479| train set 0.740x speedup, test set 2.213x speedup, val set 0.958x speedup, step: 1
Epoch 1/300 |loss: 0.010169| train set 0.767x speedup, test set 1.560x speedup, val set 1.013x speedup, step: 1
Epoch 2/300 |loss: 0.008435| train set 0.718x speedup, test set 2.343x speedup, val set 0.932x speedup, step: 2
Epoch 3/300 |loss: 0.007631| train set 0.717x speedup, test set 4.752x speedup, val set 0.963x speedup, step: 3
Epoch 4/300 |loss: 0.006675| train set 0.554x speedup, test set 1.560x speedup, val set 0.949x speedup, step: 4
Epoch 5/300 |loss: 0.006523| train set 0.963x speedup, test set 2.213x speedup, val set 0.800x speedup, step: 5
Epoch 6/300 |loss: 0.006060| train set 1.125x speedup, test set 2.136x speedup, val set 0.937x speedup, step: 6
Epoch 7/300 |loss: 0.006095| train set 1.086x speedup, test set 2.136x speedup, val set 0.949x speedup, step: 7
Epoch 8/300 |loss: 0.005285| train set 0.976x speedup, test set 2.131x speedup, val set 0.757x speedup, step: 8
Epoch 9/300 |loss: 0.004886| train set 1.145x speedup, test set 2.131x speedup, val set 0.803x speedup, step: 9
Epoch 10/300 |loss: 0.004628| train set 1.084x speedup, test set 1.486x speedup, val set 0.800x speedup, step: 10
Epoch 11/300 |loss: 0.004460| train set 1.215x speedup, test set 1.477x speedup, val set 0.757x speedup, step: 11
Epoch 12/300 |loss: 0.004258| train set 1.144x speedup, test set 1.575x speedup, val set 0.519x speedup, step: 12
Epoch 13/300 |loss: 0.004002| train set 1.310x speedup, test set 1.505x speedup, val set 0.503x speedup, step: 13
Epoch 14/300 |loss: 0.003848| train set 1.283x speedup, test set 4.884x speedup, val set 0.797x speedup, step: 14
Epoch 15/300 |loss: 0.003583| train set 1.225x speedup, test set 1.568x speedup, val set 0.500x speedup, step: 15
Epoch 16/300 |loss: 0.003676| train set 1.324x speedup, test set 1.467x speedup, val set 0.524x speedup, step: 16
Epoch 17/300 |loss: 0.003399| train set 1.262x speedup, test set 1.467x speedup, val set 0.515x speedup, step: 17
Epoch 18/300 |loss: 0.003463| train set 1.295x speedup, test set 1.467x speedup, val set 0.519x speedup, step: 18
Epoch 19/300 |loss: 0.003219| train set 1.295x speedup, test set 4.225x speedup, val set 0.503x speedup, step: 19
Epoch 20/300 |loss: 0.003029| train set 1.281x speedup, test set 1.031x speedup, val set 0.517x speedup, step: 20
Epoch 21/300 |loss: 0.003354| train set 1.343x speedup, test set 1.907x speedup, val set 0.526x speedup, step: 21
Epoch 22/300 |loss: 0.003163| train set 1.154x speedup, test set 1.715x speedup, val set 0.515x speedup, step: 22
Epoch 23/300 |loss: 0.003004| train set 1.303x speedup, test set 1.835x speedup, val set 0.515x speedup, step: 23
Epoch 24/300 |loss: 0.002918| train set 1.309x speedup, test set 1.798x speedup, val set 0.503x speedup, step: 24
Epoch 25/300 |loss: 0.002711| train set 1.361x speedup, test set 1.467x speedup, val set 0.519x speedup, step: 25
Epoch 26/300 |loss: 0.002630| train set 1.294x speedup, test set 1.019x speedup, val set 0.523x speedup, step: 26
Epoch 27/300 |loss: 0.002905| train set 1.299x speedup, test set 1.499x speedup, val set 0.519x speedup, step: 27
Epoch 28/300 |loss: 0.002468| train set 1.326x speedup, test set 1.883x speedup, val set 0.800x speedup, step: 28
Epoch 29/300 |loss: 0.002335| train set 1.342x speedup, test set 1.044x speedup, val set 0.810x speedup, step: 29
Epoch 30/300 |loss: 0.002227| train set 1.317x speedup, test set 1.803x speedup, val set 0.519x speedup, step: 30
Epoch 31/300 |loss: 0.002170| train set 1.332x speedup, test set 1.397x speedup, val set 0.524x speedup, step: 31
Epoch 32/300 |loss: 0.002356| train set 1.335x speedup, test set 1.883x speedup, val set 0.823x speedup, step: 32
Epoch 33/300 |loss: 0.003128| train set 1.345x speedup, test set 1.018x speedup, val set 0.797x speedup, step: 33
Epoch 34/300 |loss: 0.002114| train set 1.400x speedup, test set 1.019x speedup, val set 0.766x speedup, step: 34
Epoch 35/300 |loss: 0.002006| train set 1.327x speedup, test set 1.007x speedup, val set 0.806x speedup, step: 35
Epoch 36/300 |loss: 0.001957| train set 1.345x speedup, test set 1.883x speedup, val set 0.834x speedup, step: 36
Epoch 37/300 |loss: 0.002306| train set 1.360x speedup, test set 1.019x speedup, val set 0.813x speedup, step: 37
Epoch 38/300 |loss: 0.002035| train set 1.336x speedup, test set 1.803x speedup, val set 0.757x speedup, step: 38
Epoch 39/300 |loss: 0.001927| train set 1.385x speedup, test set 1.765x speedup, val set 0.518x speedup, step: 39
Epoch 40/300 |loss: 0.001898| train set 1.319x speedup, test set 1.765x speedup, val set 0.474x speedup, step: 40
Epoch 41/300 |loss: 0.001958| train set 1.343x speedup, test set 1.851x speedup, val set 0.519x speedup, step: 41
Epoch 42/300 |loss: 0.001889| train set 1.239x speedup, test set 1.007x speedup, val set 0.705x speedup, step: 42
Epoch 43/300 |loss: 0.001955| train set 1.326x speedup, test set 1.765x speedup, val set 0.801x speedup, step: 43
Epoch 44/300 |loss: 0.001840| train set 1.358x speedup, test set 1.849x speedup, val set 0.801x speedup, step: 44
Epoch 45/300 |loss: 0.001772| train set 1.335x speedup, test set 1.765x speedup, val set 0.757x speedup, step: 45
Epoch 46/300 |loss: 0.001739| train set 1.376x speedup, test set 1.765x speedup, val set 0.477x speedup, step: 46
Epoch 47/300 |loss: 0.001570| train set 1.367x speedup, test set 1.805x speedup, val set 0.520x speedup, step: 47
Epoch 48/300 |loss: 0.001570| train set 1.381x speedup, test set 4.293x speedup, val set 0.541x speedup, step: 48
Epoch 49/300 |loss: 0.001633| train set 1.362x speedup, test set 1.765x speedup, val set 0.706x speedup, step: 49
Epoch 50/300 |loss: 0.001719| train set 1.431x speedup, test set 1.516x speedup, val set 0.526x speedup, step: 50
Epoch 51/300 |loss: 0.001850| train set 1.389x speedup, test set 1.496x speedup, val set 0.519x speedup, step: 51
Epoch 52/300 |loss: 0.001567| train set 1.391x speedup, test set 1.856x speedup, val set 0.541x speedup, step: 52
Epoch 53/300 |loss: 0.001397| train set 1.415x speedup, test set 0.915x speedup, val set 0.546x speedup, step: 53
Epoch 54/300 |loss: 0.001533| train set 1.400x speedup, test set 1.805x speedup, val set 0.483x speedup, step: 54
Epoch 55/300 |loss: 0.001349| train set 1.394x speedup, test set 1.707x speedup, val set 0.604x speedup, step: 55
Epoch 56/300 |loss: 0.001165| train set 1.405x speedup, test set 1.799x speedup, val set 0.605x speedup, step: 56
Epoch 57/300 |loss: 0.001337| train set 1.344x speedup, test set 1.799x speedup, val set 0.706x speedup, step: 57
Epoch 58/300 |loss: 0.001583| train set 1.355x speedup, test set 1.805x speedup, val set 0.546x speedup, step: 58
Epoch 59/300 |loss: 0.001407| train set 1.451x speedup, test set 1.372x speedup, val set 0.555x speedup, step: 59
Epoch 60/300 |loss: 0.001229| train set 1.393x speedup, test set 1.856x speedup, val set 0.603x speedup, step: 60
Epoch 61/300 |loss: 0.001281| train set 1.431x speedup, test set 1.020x speedup, val set 0.607x speedup, step: 61
Epoch 62/300 |loss: 0.001257| train set 1.356x speedup, test set 1.860x speedup, val set 0.555x speedup, step: 62
Epoch 63/300 |loss: 0.001557| train set 1.345x speedup, test set 1.372x speedup, val set 0.550x speedup, step: 63
Epoch 64/300 |loss: 0.001270| train set 1.429x speedup, test set 2.001x speedup, val set 0.606x speedup, step: 64
Epoch 65/300 |loss: 0.001213| train set 1.384x speedup, test set 1.866x speedup, val set 0.603x speedup, step: 65
early stopping at epoch 65
Training per epoch cost 1.372 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 59, train speedup 1.451, test speedup 1.372, val speedup 0.555
best test speedup epoch: 14, train speedup 1.283, test speedup 4.884, val speedup 0.797
best validation speedup epoch: 1, train speedup 0.767, test speedup 1.560, val speedup 1.013
last model at epoch 65, train speedup 1.384, test speedup 1.866, val speedup 0.603
execution cost 0:02:11.222972
==================================================
