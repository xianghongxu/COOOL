all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.128306, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008262| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007591| train set 1.475x speedup, test set 1.372x speedup, val set 1.110x speedup, step: 3
Epoch 7/300 |loss: 0.007026| train set 0.971x speedup, test set 1.361x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006528| train set 1.482x speedup, test set 1.137x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006199| train set 0.982x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005968| train set 0.997x speedup, test set 1.126x speedup, val set 1.124x speedup, step: 7
Epoch 11/300 |loss: 0.005823| train set 1.020x speedup, test set 1.352x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005320| train set 1.024x speedup, test set 1.125x speedup, val set 1.104x speedup, step: 9
Epoch 13/300 |loss: 0.005204| train set 1.065x speedup, test set 1.354x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005047| train set 1.061x speedup, test set 1.352x speedup, val set 1.071x speedup, step: 11
Epoch 15/300 |loss: 0.005142| train set 1.025x speedup, test set 1.352x speedup, val set 1.070x speedup, step: 12
Epoch 16/300 |loss: 0.004777| train set 1.236x speedup, test set 1.456x speedup, val set 1.247x speedup, step: 1
Epoch 17/300 |loss: 0.004927| train set 1.011x speedup, test set 1.339x speedup, val set 1.087x speedup, step: 2
Epoch 18/300 |loss: 0.004143| train set 1.280x speedup, test set 1.351x speedup, val set 1.008x speedup, step: 3
Epoch 19/300 |loss: 0.004307| train set 1.255x speedup, test set 1.413x speedup, val set 1.032x speedup, step: 4
Epoch 20/300 |loss: 0.003722| train set 1.274x speedup, test set 1.333x speedup, val set 1.008x speedup, step: 5
Epoch 21/300 |loss: 0.003432| train set 1.127x speedup, test set 1.323x speedup, val set 0.962x speedup, step: 6
Epoch 22/300 |loss: 0.003286| train set 2.530x speedup, test set 1.323x speedup, val set 0.817x speedup, step: 7
Epoch 23/300 |loss: 0.003355| train set 2.301x speedup, test set 1.330x speedup, val set 0.949x speedup, step: 8
Epoch 24/300 |loss: 0.004292| train set 2.721x speedup, test set 1.340x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003418| train set 2.640x speedup, test set 1.330x speedup, val set 0.997x speedup, step: 10
Epoch 26/300 |loss: 0.003211| train set 2.346x speedup, test set 1.334x speedup, val set 0.948x speedup, step: 11
Epoch 27/300 |loss: 0.003102| train set 2.755x speedup, test set 1.355x speedup, val set 0.951x speedup, step: 12
Epoch 28/300 |loss: 0.002702| train set 2.680x speedup, test set 1.355x speedup, val set 0.839x speedup, step: 13
Epoch 29/300 |loss: 0.002704| train set 2.715x speedup, test set 1.347x speedup, val set 0.829x speedup, step: 14
Epoch 30/300 |loss: 0.002483| train set 2.445x speedup, test set 1.356x speedup, val set 0.822x speedup, step: 15
Epoch 31/300 |loss: 0.002361| train set 2.672x speedup, test set 1.380x speedup, val set 0.842x speedup, step: 16
Epoch 32/300 |loss: 0.002583| train set 2.733x speedup, test set 1.348x speedup, val set 0.908x speedup, step: 17
Epoch 33/300 |loss: 0.002441| train set 2.764x speedup, test set 1.342x speedup, val set 0.985x speedup, step: 18
Epoch 34/300 |loss: 0.002119| train set 2.905x speedup, test set 1.424x speedup, val set 0.821x speedup, step: 19
Epoch 35/300 |loss: 0.002068| train set 2.853x speedup, test set 1.355x speedup, val set 0.933x speedup, step: 20
Epoch 36/300 |loss: 0.002270| train set 2.535x speedup, test set 1.417x speedup, val set 0.823x speedup, step: 21
Epoch 37/300 |loss: 0.001961| train set 2.834x speedup, test set 1.417x speedup, val set 0.822x speedup, step: 22
Epoch 38/300 |loss: 0.001943| train set 2.905x speedup, test set 1.356x speedup, val set 0.825x speedup, step: 23
Epoch 39/300 |loss: 0.002001| train set 2.909x speedup, test set 1.425x speedup, val set 0.842x speedup, step: 24
Epoch 40/300 |loss: 0.001985| train set 2.806x speedup, test set 1.417x speedup, val set 0.822x speedup, step: 25
Epoch 41/300 |loss: 0.001876| train set 2.866x speedup, test set 1.239x speedup, val set 0.912x speedup, step: 26
Epoch 42/300 |loss: 0.001726| train set 2.819x speedup, test set 1.364x speedup, val set 0.823x speedup, step: 27
Epoch 43/300 |loss: 0.001857| train set 2.880x speedup, test set 1.126x speedup, val set 0.823x speedup, step: 28
Epoch 44/300 |loss: 0.001675| train set 2.817x speedup, test set 1.377x speedup, val set 0.825x speedup, step: 29
Epoch 45/300 |loss: 0.001588| train set 2.844x speedup, test set 1.141x speedup, val set 0.842x speedup, step: 30
Epoch 46/300 |loss: 0.001558| train set 2.886x speedup, test set 1.301x speedup, val set 0.842x speedup, step: 31
Epoch 47/300 |loss: 0.001694| train set 2.847x speedup, test set 1.377x speedup, val set 0.838x speedup, step: 32
Epoch 48/300 |loss: 0.001774| train set 2.787x speedup, test set 1.377x speedup, val set 0.838x speedup, step: 33
Epoch 49/300 |loss: 0.001687| train set 2.888x speedup, test set 1.140x speedup, val set 0.825x speedup, step: 34
Epoch 50/300 |loss: 0.001427| train set 2.505x speedup, test set 1.380x speedup, val set 0.825x speedup, step: 35
Epoch 51/300 |loss: 0.001468| train set 2.920x speedup, test set 1.376x speedup, val set 0.825x speedup, step: 36
Epoch 52/300 |loss: 0.001262| train set 2.819x speedup, test set 1.140x speedup, val set 0.838x speedup, step: 37
Epoch 53/300 |loss: 0.001359| train set 2.901x speedup, test set 2.489x speedup, val set 0.839x speedup, step: 38
Epoch 54/300 |loss: 0.001390| train set 2.889x speedup, test set 1.380x speedup, val set 0.822x speedup, step: 39
Epoch 55/300 |loss: 0.001332| train set 2.850x speedup, test set 1.390x speedup, val set 0.825x speedup, step: 40
Epoch 56/300 |loss: 0.001193| train set 2.831x speedup, test set 1.376x speedup, val set 0.947x speedup, step: 41
Epoch 57/300 |loss: 0.001095| train set 2.962x speedup, test set 1.376x speedup, val set 0.842x speedup, step: 42
Epoch 58/300 |loss: 0.001719| train set 2.478x speedup, test set 1.453x speedup, val set 0.913x speedup, step: 43
Epoch 59/300 |loss: 0.001257| train set 2.799x speedup, test set 1.376x speedup, val set 0.823x speedup, step: 44
Epoch 60/300 |loss: 0.001215| train set 2.832x speedup, test set 1.376x speedup, val set 0.930x speedup, step: 45
Epoch 61/300 |loss: 0.001109| train set 2.931x speedup, test set 1.390x speedup, val set 0.825x speedup, step: 46
Epoch 62/300 |loss: 0.001150| train set 2.892x speedup, test set 1.376x speedup, val set 0.835x speedup, step: 47
Epoch 63/300 |loss: 0.000863| train set 2.811x speedup, test set 1.390x speedup, val set 0.833x speedup, step: 48
Epoch 64/300 |loss: 0.000898| train set 2.737x speedup, test set 1.376x speedup, val set 0.926x speedup, step: 49
Epoch 65/300 |loss: 0.001379| train set 2.744x speedup, test set 1.376x speedup, val set 0.585x speedup, step: 50
Epoch 66/300 |loss: 0.001182| train set 2.813x speedup, test set 1.390x speedup, val set 0.841x speedup, step: 51
early stopping at epoch 66
Training per epoch cost 2.163 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 34.379s, pg runtime 21.298s, speedup 0.620x
14, opt runtime 3.258s, model runtime 30.464s, pg runtime 18.141s, speedup 0.595x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 57, train speedup 2.962, test speedup 1.376, val speedup 0.842
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.236, test speedup 1.456, val speedup 1.247
last model at epoch 66, train speedup 2.813, test speedup 1.390, val speedup 0.841
execution cost 0:04:01.395127
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.155475, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010257| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009665| train set 1.488x speedup, test set 2.643x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009258| train set 0.978x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008262| train set 1.454x speedup, test set 2.614x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007578| train set 1.476x speedup, test set 1.372x speedup, val set 1.104x speedup, step: 3
Epoch 7/300 |loss: 0.007030| train set 0.966x speedup, test set 2.402x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006542| train set 1.474x speedup, test set 1.332x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006215| train set 0.964x speedup, test set 1.126x speedup, val set 1.063x speedup, step: 6
Epoch 10/300 |loss: 0.005941| train set 1.003x speedup, test set 1.355x speedup, val set 1.128x speedup, step: 1
Epoch 11/300 |loss: 0.005871| train set 1.007x speedup, test set 1.353x speedup, val set 1.077x speedup, step: 2
Epoch 12/300 |loss: 0.005264| train set 1.010x speedup, test set 1.121x speedup, val set 1.086x speedup, step: 3
Epoch 13/300 |loss: 0.005181| train set 1.062x speedup, test set 1.348x speedup, val set 1.036x speedup, step: 4
Epoch 14/300 |loss: 0.005140| train set 1.119x speedup, test set 1.360x speedup, val set 1.091x speedup, step: 5
Epoch 15/300 |loss: 0.005057| train set 1.012x speedup, test set 1.348x speedup, val set 1.108x speedup, step: 6
Epoch 16/300 |loss: 0.004745| train set 1.250x speedup, test set 1.358x speedup, val set 1.170x speedup, step: 1
Epoch 17/300 |loss: 0.004832| train set 1.015x speedup, test set 1.342x speedup, val set 1.115x speedup, step: 2
Epoch 18/300 |loss: 0.004197| train set 1.295x speedup, test set 1.344x speedup, val set 1.115x speedup, step: 3
Epoch 19/300 |loss: 0.004475| train set 1.186x speedup, test set 1.345x speedup, val set 1.023x speedup, step: 4
Epoch 20/300 |loss: 0.003882| train set 1.285x speedup, test set 1.317x speedup, val set 0.979x speedup, step: 5
Epoch 21/300 |loss: 0.003577| train set 1.288x speedup, test set 1.380x speedup, val set 0.971x speedup, step: 6
Epoch 22/300 |loss: 0.003498| train set 2.709x speedup, test set 1.397x speedup, val set 1.133x speedup, step: 7
Epoch 23/300 |loss: 0.003305| train set 2.330x speedup, test set 1.344x speedup, val set 1.032x speedup, step: 8
Epoch 24/300 |loss: 0.004458| train set 2.633x speedup, test set 1.345x speedup, val set 0.991x speedup, step: 9
Epoch 25/300 |loss: 0.003608| train set 2.399x speedup, test set 1.346x speedup, val set 0.968x speedup, step: 10
Epoch 26/300 |loss: 0.003494| train set 2.537x speedup, test set 1.351x speedup, val set 0.859x speedup, step: 11
Epoch 27/300 |loss: 0.002978| train set 2.747x speedup, test set 1.330x speedup, val set 0.832x speedup, step: 12
Epoch 28/300 |loss: 0.002781| train set 2.672x speedup, test set 1.330x speedup, val set 0.839x speedup, step: 13
Epoch 29/300 |loss: 0.002730| train set 2.723x speedup, test set 1.323x speedup, val set 0.825x speedup, step: 14
Epoch 30/300 |loss: 0.002592| train set 2.418x speedup, test set 1.331x speedup, val set 0.856x speedup, step: 15
Epoch 31/300 |loss: 0.002512| train set 2.641x speedup, test set 1.320x speedup, val set 0.839x speedup, step: 16
Epoch 32/300 |loss: 0.002798| train set 2.461x speedup, test set 1.330x speedup, val set 0.806x speedup, step: 17
Epoch 33/300 |loss: 0.002702| train set 2.668x speedup, test set 1.376x speedup, val set 0.838x speedup, step: 18
Epoch 34/300 |loss: 0.002298| train set 2.847x speedup, test set 1.376x speedup, val set 0.834x speedup, step: 19
Epoch 35/300 |loss: 0.002476| train set 2.881x speedup, test set 1.302x speedup, val set 0.838x speedup, step: 20
Epoch 36/300 |loss: 0.002237| train set 2.490x speedup, test set 1.347x speedup, val set 0.831x speedup, step: 21
Epoch 37/300 |loss: 0.002078| train set 2.690x speedup, test set 1.328x speedup, val set 0.970x speedup, step: 22
Epoch 38/300 |loss: 0.002112| train set 2.863x speedup, test set 1.371x speedup, val set 0.831x speedup, step: 23
Epoch 39/300 |loss: 0.002073| train set 2.766x speedup, test set 1.376x speedup, val set 0.839x speedup, step: 24
Epoch 40/300 |loss: 0.002210| train set 2.871x speedup, test set 1.376x speedup, val set 0.956x speedup, step: 25
Epoch 41/300 |loss: 0.001949| train set 2.823x speedup, test set 1.356x speedup, val set 0.834x speedup, step: 26
Epoch 42/300 |loss: 0.002084| train set 2.856x speedup, test set 1.387x speedup, val set 0.842x speedup, step: 27
Epoch 43/300 |loss: 0.002201| train set 2.498x speedup, test set 1.376x speedup, val set 0.832x speedup, step: 28
Epoch 44/300 |loss: 0.001935| train set 2.806x speedup, test set 1.374x speedup, val set 0.834x speedup, step: 29
Epoch 45/300 |loss: 0.001927| train set 2.835x speedup, test set 1.366x speedup, val set 0.839x speedup, step: 30
Epoch 46/300 |loss: 0.001795| train set 2.840x speedup, test set 1.377x speedup, val set 0.835x speedup, step: 31
Epoch 47/300 |loss: 0.001786| train set 2.862x speedup, test set 1.358x speedup, val set 0.841x speedup, step: 32
Epoch 48/300 |loss: 0.001631| train set 2.780x speedup, test set 1.368x speedup, val set 0.835x speedup, step: 33
Epoch 49/300 |loss: 0.001774| train set 2.810x speedup, test set 1.358x speedup, val set 0.975x speedup, step: 34
Epoch 50/300 |loss: 0.001479| train set 2.842x speedup, test set 1.368x speedup, val set 0.983x speedup, step: 35
Epoch 51/300 |loss: 0.001338| train set 2.832x speedup, test set 1.368x speedup, val set 0.980x speedup, step: 36
Epoch 52/300 |loss: 0.001253| train set 2.887x speedup, test set 1.368x speedup, val set 0.924x speedup, step: 37
Epoch 53/300 |loss: 0.001351| train set 2.769x speedup, test set 1.368x speedup, val set 0.981x speedup, step: 38
Epoch 54/300 |loss: 0.001420| train set 2.917x speedup, test set 1.368x speedup, val set 0.974x speedup, step: 39
Epoch 55/300 |loss: 0.001195| train set 2.815x speedup, test set 1.374x speedup, val set 0.970x speedup, step: 40
Epoch 56/300 |loss: 0.001163| train set 2.846x speedup, test set 1.368x speedup, val set 0.955x speedup, step: 41
Epoch 57/300 |loss: 0.001187| train set 2.893x speedup, test set 1.368x speedup, val set 0.961x speedup, step: 42
Epoch 58/300 |loss: 0.001494| train set 2.812x speedup, test set 1.358x speedup, val set 0.975x speedup, step: 43
Epoch 59/300 |loss: 0.001142| train set 2.817x speedup, test set 1.348x speedup, val set 0.969x speedup, step: 44
Epoch 60/300 |loss: 0.001345| train set 2.825x speedup, test set 1.348x speedup, val set 0.975x speedup, step: 45
Epoch 61/300 |loss: 0.001109| train set 2.893x speedup, test set 1.348x speedup, val set 0.971x speedup, step: 46
Epoch 62/300 |loss: 0.001091| train set 2.855x speedup, test set 1.374x speedup, val set 0.979x speedup, step: 47
Epoch 63/300 |loss: 0.001077| train set 2.759x speedup, test set 1.353x speedup, val set 0.983x speedup, step: 48
Epoch 64/300 |loss: 0.001074| train set 2.801x speedup, test set 1.348x speedup, val set 0.978x speedup, step: 49
Epoch 65/300 |loss: 0.001125| train set 2.837x speedup, test set 1.353x speedup, val set 0.972x speedup, step: 50
Epoch 66/300 |loss: 0.001053| train set 2.836x speedup, test set 1.345x speedup, val set 0.985x speedup, step: 51
Epoch 67/300 |loss: 0.001197| train set 2.737x speedup, test set 1.351x speedup, val set 0.980x speedup, step: 52
Epoch 68/300 |loss: 0.001448| train set 2.943x speedup, test set 1.376x speedup, val set 0.984x speedup, step: 53
early stopping at epoch 68
Training per epoch cost 2.216 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 100.428s, pg runtime 87.340s, speedup 0.870x
12, opt runtime 26.602s, model runtime 100.512s, pg runtime 85.447s, speedup 0.850x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 68, train speedup 2.943, test speedup 1.376, val speedup 0.984
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.250, test speedup 1.358, val speedup 1.170
last model at epoch 68, train speedup 2.943, test speedup 1.376, val speedup 0.984
execution cost 0:04:18.846406
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.044477, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007034| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006542| train set 1.481x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006197| train set 0.962x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005967| train set 0.974x speedup, test set 1.128x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005725| train set 1.036x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005406| train set 1.029x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 9
Epoch 13/300 |loss: 0.005155| train set 1.071x speedup, test set 1.391x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005067| train set 1.138x speedup, test set 1.356x speedup, val set 1.093x speedup, step: 11
Epoch 15/300 |loss: 0.005103| train set 1.032x speedup, test set 1.350x speedup, val set 0.990x speedup, step: 12
Epoch 16/300 |loss: 0.004746| train set 1.235x speedup, test set 1.472x speedup, val set 1.177x speedup, step: 1
Epoch 17/300 |loss: 0.004884| train set 0.983x speedup, test set 1.331x speedup, val set 0.979x speedup, step: 2
Epoch 18/300 |loss: 0.004082| train set 1.300x speedup, test set 1.362x speedup, val set 1.025x speedup, step: 3
Epoch 19/300 |loss: 0.004288| train set 1.277x speedup, test set 1.368x speedup, val set 0.991x speedup, step: 4
Epoch 20/300 |loss: 0.003762| train set 1.287x speedup, test set 1.389x speedup, val set 1.001x speedup, step: 5
Epoch 21/300 |loss: 0.003406| train set 1.156x speedup, test set 1.356x speedup, val set 0.917x speedup, step: 6
Epoch 22/300 |loss: 0.003505| train set 2.225x speedup, test set 1.348x speedup, val set 1.133x speedup, step: 7
Epoch 23/300 |loss: 0.003308| train set 2.346x speedup, test set 1.381x speedup, val set 0.938x speedup, step: 8
Epoch 24/300 |loss: 0.003791| train set 2.685x speedup, test set 1.406x speedup, val set 1.118x speedup, step: 9
Epoch 25/300 |loss: 0.003386| train set 2.403x speedup, test set 1.381x speedup, val set 1.001x speedup, step: 10
Epoch 26/300 |loss: 0.002994| train set 2.637x speedup, test set 1.356x speedup, val set 1.000x speedup, step: 11
Epoch 27/300 |loss: 0.003176| train set 2.626x speedup, test set 1.348x speedup, val set 0.877x speedup, step: 12
Epoch 28/300 |loss: 0.002742| train set 2.684x speedup, test set 1.381x speedup, val set 0.839x speedup, step: 13
Epoch 29/300 |loss: 0.002718| train set 2.400x speedup, test set 1.417x speedup, val set 0.871x speedup, step: 14
Epoch 30/300 |loss: 0.002485| train set 2.457x speedup, test set 1.490x speedup, val set 0.869x speedup, step: 15
Epoch 31/300 |loss: 0.002449| train set 2.652x speedup, test set 1.415x speedup, val set 0.875x speedup, step: 16
Epoch 32/300 |loss: 0.002794| train set 2.486x speedup, test set 1.453x speedup, val set 0.931x speedup, step: 17
Epoch 33/300 |loss: 0.002474| train set 2.769x speedup, test set 1.389x speedup, val set 0.885x speedup, step: 18
Epoch 34/300 |loss: 0.002193| train set 2.922x speedup, test set 1.394x speedup, val set 0.842x speedup, step: 19
Epoch 35/300 |loss: 0.002171| train set 2.794x speedup, test set 1.429x speedup, val set 0.933x speedup, step: 20
Epoch 36/300 |loss: 0.002263| train set 2.577x speedup, test set 1.398x speedup, val set 0.885x speedup, step: 21
Epoch 37/300 |loss: 0.002034| train set 2.851x speedup, test set 1.425x speedup, val set 0.975x speedup, step: 22
Epoch 38/300 |loss: 0.001913| train set 2.896x speedup, test set 1.475x speedup, val set 0.885x speedup, step: 23
Epoch 39/300 |loss: 0.001906| train set 2.755x speedup, test set 1.448x speedup, val set 0.885x speedup, step: 24
Epoch 40/300 |loss: 0.002110| train set 2.755x speedup, test set 1.462x speedup, val set 0.837x speedup, step: 25
Epoch 41/300 |loss: 0.002038| train set 2.857x speedup, test set 1.425x speedup, val set 0.938x speedup, step: 26
Epoch 42/300 |loss: 0.001892| train set 2.781x speedup, test set 1.475x speedup, val set 0.927x speedup, step: 27
Epoch 43/300 |loss: 0.001859| train set 2.838x speedup, test set 1.475x speedup, val set 0.938x speedup, step: 28
Epoch 44/300 |loss: 0.001821| train set 2.714x speedup, test set 1.475x speedup, val set 0.885x speedup, step: 29
Epoch 45/300 |loss: 0.002003| train set 2.738x speedup, test set 1.475x speedup, val set 0.919x speedup, step: 30
Epoch 46/300 |loss: 0.001828| train set 2.796x speedup, test set 1.448x speedup, val set 0.921x speedup, step: 31
Epoch 47/300 |loss: 0.001755| train set 2.891x speedup, test set 1.475x speedup, val set 0.921x speedup, step: 32
Epoch 48/300 |loss: 0.001684| train set 2.718x speedup, test set 1.475x speedup, val set 0.879x speedup, step: 33
Epoch 49/300 |loss: 0.001642| train set 2.921x speedup, test set 1.462x speedup, val set 0.932x speedup, step: 34
Epoch 50/300 |loss: 0.001457| train set 2.498x speedup, test set 1.475x speedup, val set 0.923x speedup, step: 35
Epoch 51/300 |loss: 0.001505| train set 2.894x speedup, test set 1.448x speedup, val set 0.921x speedup, step: 36
Epoch 52/300 |loss: 0.001305| train set 2.849x speedup, test set 1.448x speedup, val set 0.923x speedup, step: 37
Epoch 53/300 |loss: 0.001406| train set 2.821x speedup, test set 1.439x speedup, val set 0.879x speedup, step: 38
Epoch 54/300 |loss: 0.001362| train set 2.372x speedup, test set 1.439x speedup, val set 0.846x speedup, step: 39
Epoch 55/300 |loss: 0.001697| train set 2.808x speedup, test set 1.439x speedup, val set 0.918x speedup, step: 40
Epoch 56/300 |loss: 0.001393| train set 2.831x speedup, test set 1.439x speedup, val set 0.843x speedup, step: 41
Epoch 57/300 |loss: 0.001342| train set 2.910x speedup, test set 1.505x speedup, val set 0.852x speedup, step: 42
Epoch 58/300 |loss: 0.001383| train set 2.783x speedup, test set 1.439x speedup, val set 0.852x speedup, step: 43
Epoch 59/300 |loss: 0.001287| train set 2.802x speedup, test set 1.439x speedup, val set 0.863x speedup, step: 44
Epoch 60/300 |loss: 0.001443| train set 2.844x speedup, test set 1.368x speedup, val set 0.865x speedup, step: 45
Epoch 61/300 |loss: 0.001315| train set 2.821x speedup, test set 1.505x speedup, val set 0.927x speedup, step: 46
early stopping at epoch 61
Training per epoch cost 2.198 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 34, train speedup 2.922, test speedup 1.394, val speedup 0.842
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.235, test speedup 1.472, val speedup 1.177
last model at epoch 61, train speedup 2.821, test speedup 1.505, val speedup 0.927
execution cost 0:03:52.479332
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.783888, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007034| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006543| train set 1.481x speedup, test set 1.344x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006196| train set 0.962x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005957| train set 1.003x speedup, test set 1.125x speedup, val set 1.085x speedup, step: 7
Epoch 11/300 |loss: 0.005760| train set 1.026x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005406| train set 1.017x speedup, test set 1.125x speedup, val set 1.020x speedup, step: 9
Epoch 13/300 |loss: 0.005226| train set 1.045x speedup, test set 1.352x speedup, val set 1.085x speedup, step: 10
Epoch 14/300 |loss: 0.005135| train set 1.047x speedup, test set 1.365x speedup, val set 1.070x speedup, step: 11
Epoch 15/300 |loss: 0.005013| train set 1.032x speedup, test set 1.348x speedup, val set 0.978x speedup, step: 12
Epoch 16/300 |loss: 0.004760| train set 1.254x speedup, test set 1.459x speedup, val set 1.177x speedup, step: 1
Epoch 17/300 |loss: 0.004870| train set 1.036x speedup, test set 1.323x speedup, val set 1.089x speedup, step: 2
Epoch 18/300 |loss: 0.004081| train set 1.268x speedup, test set 1.356x speedup, val set 1.020x speedup, step: 3
Epoch 19/300 |loss: 0.004406| train set 1.206x speedup, test set 1.307x speedup, val set 1.030x speedup, step: 4
Epoch 20/300 |loss: 0.003803| train set 1.284x speedup, test set 1.386x speedup, val set 0.989x speedup, step: 5
Epoch 21/300 |loss: 0.003472| train set 1.209x speedup, test set 1.381x speedup, val set 0.984x speedup, step: 6
Epoch 22/300 |loss: 0.003532| train set 2.416x speedup, test set 1.374x speedup, val set 1.001x speedup, step: 7
Epoch 23/300 |loss: 0.003203| train set 2.269x speedup, test set 1.318x speedup, val set 1.001x speedup, step: 8
Epoch 24/300 |loss: 0.004079| train set 2.726x speedup, test set 1.340x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003485| train set 2.683x speedup, test set 1.382x speedup, val set 1.001x speedup, step: 10
Epoch 26/300 |loss: 0.003413| train set 2.610x speedup, test set 1.382x speedup, val set 1.000x speedup, step: 11
Epoch 27/300 |loss: 0.002922| train set 2.509x speedup, test set 1.382x speedup, val set 0.839x speedup, step: 12
Epoch 28/300 |loss: 0.002609| train set 2.732x speedup, test set 1.382x speedup, val set 0.839x speedup, step: 13
Epoch 29/300 |loss: 0.002541| train set 2.771x speedup, test set 1.382x speedup, val set 0.837x speedup, step: 14
Epoch 30/300 |loss: 0.002468| train set 2.472x speedup, test set 1.389x speedup, val set 0.832x speedup, step: 15
Epoch 31/300 |loss: 0.002362| train set 2.363x speedup, test set 1.415x speedup, val set 0.941x speedup, step: 16
Epoch 32/300 |loss: 0.002816| train set 2.421x speedup, test set 1.389x speedup, val set 0.947x speedup, step: 17
Epoch 33/300 |loss: 0.002357| train set 2.699x speedup, test set 1.374x speedup, val set 0.839x speedup, step: 18
Epoch 34/300 |loss: 0.002115| train set 2.879x speedup, test set 1.381x speedup, val set 0.841x speedup, step: 19
Epoch 35/300 |loss: 0.002178| train set 2.844x speedup, test set 1.374x speedup, val set 0.840x speedup, step: 20
Epoch 36/300 |loss: 0.002213| train set 2.427x speedup, test set 1.381x speedup, val set 0.834x speedup, step: 21
Epoch 37/300 |loss: 0.001968| train set 2.859x speedup, test set 1.381x speedup, val set 0.841x speedup, step: 22
Epoch 38/300 |loss: 0.001882| train set 2.849x speedup, test set 1.381x speedup, val set 0.839x speedup, step: 23
Epoch 39/300 |loss: 0.002002| train set 2.781x speedup, test set 1.376x speedup, val set 0.945x speedup, step: 24
Epoch 40/300 |loss: 0.002049| train set 2.833x speedup, test set 1.443x speedup, val set 0.948x speedup, step: 25
Epoch 41/300 |loss: 0.001796| train set 2.823x speedup, test set 1.356x speedup, val set 0.816x speedup, step: 26
Epoch 42/300 |loss: 0.001659| train set 2.779x speedup, test set 1.344x speedup, val set 0.840x speedup, step: 27
Epoch 43/300 |loss: 0.001785| train set 2.915x speedup, test set 1.389x speedup, val set 0.948x speedup, step: 28
Epoch 44/300 |loss: 0.001643| train set 2.699x speedup, test set 1.376x speedup, val set 0.843x speedup, step: 29
Epoch 45/300 |loss: 0.001602| train set 2.774x speedup, test set 1.389x speedup, val set 0.840x speedup, step: 30
Epoch 46/300 |loss: 0.001529| train set 2.874x speedup, test set 1.458x speedup, val set 0.952x speedup, step: 31
Epoch 47/300 |loss: 0.001667| train set 2.824x speedup, test set 1.401x speedup, val set 0.948x speedup, step: 32
Epoch 48/300 |loss: 0.001530| train set 2.757x speedup, test set 1.470x speedup, val set 0.942x speedup, step: 33
Epoch 49/300 |loss: 0.001453| train set 2.851x speedup, test set 1.484x speedup, val set 0.934x speedup, step: 34
Epoch 50/300 |loss: 0.001350| train set 2.858x speedup, test set 1.459x speedup, val set 0.952x speedup, step: 35
Epoch 51/300 |loss: 0.001331| train set 2.885x speedup, test set 1.466x speedup, val set 0.945x speedup, step: 36
Epoch 52/300 |loss: 0.001280| train set 2.756x speedup, test set 1.401x speedup, val set 0.936x speedup, step: 37
Epoch 53/300 |loss: 0.001354| train set 2.711x speedup, test set 1.479x speedup, val set 0.940x speedup, step: 38
Epoch 54/300 |loss: 0.001270| train set 2.471x speedup, test set 1.467x speedup, val set 0.942x speedup, step: 39
Epoch 55/300 |loss: 0.001295| train set 2.655x speedup, test set 1.467x speedup, val set 0.915x speedup, step: 40
Epoch 56/300 |loss: 0.001186| train set 2.825x speedup, test set 1.476x speedup, val set 0.937x speedup, step: 41
Epoch 57/300 |loss: 0.001207| train set 2.752x speedup, test set 1.459x speedup, val set 0.937x speedup, step: 42
Epoch 58/300 |loss: 0.001348| train set 2.891x speedup, test set 1.467x speedup, val set 0.952x speedup, step: 43
Epoch 59/300 |loss: 0.001052| train set 2.774x speedup, test set 1.485x speedup, val set 0.926x speedup, step: 44
Epoch 60/300 |loss: 0.001516| train set 2.887x speedup, test set 1.384x speedup, val set 0.785x speedup, step: 45
Epoch 61/300 |loss: 0.001061| train set 2.859x speedup, test set 1.476x speedup, val set 0.937x speedup, step: 46
Epoch 62/300 |loss: 0.001179| train set 2.825x speedup, test set 1.459x speedup, val set 0.933x speedup, step: 47
Epoch 63/300 |loss: 0.000937| train set 2.741x speedup, test set 1.410x speedup, val set 0.952x speedup, step: 48
Epoch 64/300 |loss: 0.001168| train set 2.636x speedup, test set 1.386x speedup, val set 0.933x speedup, step: 49
Epoch 65/300 |loss: 0.001569| train set 2.773x speedup, test set 1.460x speedup, val set 0.925x speedup, step: 50
Epoch 66/300 |loss: 0.001178| train set 2.819x speedup, test set 1.466x speedup, val set 0.937x speedup, step: 51
Epoch 67/300 |loss: 0.000919| train set 2.811x speedup, test set 1.386x speedup, val set 0.948x speedup, step: 52
Epoch 68/300 |loss: 0.001070| train set 2.932x speedup, test set 1.460x speedup, val set 0.952x speedup, step: 53
Epoch 69/300 |loss: 0.001108| train set 2.750x speedup, test set 1.504x speedup, val set 0.928x speedup, step: 54
Epoch 70/300 |loss: 0.001057| train set 2.864x speedup, test set 1.395x speedup, val set 0.926x speedup, step: 55
Epoch 71/300 |loss: 0.000921| train set 2.857x speedup, test set 1.486x speedup, val set 0.928x speedup, step: 56
Epoch 72/300 |loss: 0.000715| train set 2.830x speedup, test set 1.395x speedup, val set 0.933x speedup, step: 57
Epoch 73/300 |loss: 0.000686| train set 2.810x speedup, test set 1.399x speedup, val set 0.924x speedup, step: 58
Epoch 74/300 |loss: 0.000651| train set 2.731x speedup, test set 1.440x speedup, val set 0.933x speedup, step: 59
Epoch 75/300 |loss: 0.000683| train set 2.849x speedup, test set 1.334x speedup, val set 0.937x speedup, step: 60
Epoch 76/300 |loss: 0.000587| train set 2.889x speedup, test set 1.381x speedup, val set 0.933x speedup, step: 61
Epoch 77/300 |loss: 0.000597| train set 2.916x speedup, test set 1.432x speedup, val set 0.937x speedup, step: 62
Epoch 78/300 |loss: 0.000534| train set 2.879x speedup, test set 1.402x speedup, val set 0.563x speedup, step: 63
Epoch 79/300 |loss: 0.000455| train set 2.885x speedup, test set 1.452x speedup, val set 0.925x speedup, step: 64
Epoch 80/300 |loss: 0.000460| train set 2.882x speedup, test set 1.439x speedup, val set 0.925x speedup, step: 65
Epoch 81/300 |loss: 0.000433| train set 2.812x speedup, test set 1.407x speedup, val set 0.933x speedup, step: 66
Epoch 82/300 |loss: 0.000735| train set 2.909x speedup, test set 1.385x speedup, val set 0.924x speedup, step: 67
Epoch 83/300 |loss: 0.000603| train set 2.470x speedup, test set 1.408x speedup, val set 0.925x speedup, step: 68
Epoch 84/300 |loss: 0.000664| train set 2.935x speedup, test set 1.369x speedup, val set 0.925x speedup, step: 69
Epoch 85/300 |loss: 0.000552| train set 2.950x speedup, test set 1.348x speedup, val set 0.925x speedup, step: 70
Epoch 86/300 |loss: 0.000459| train set 2.912x speedup, test set 1.407x speedup, val set 0.938x speedup, step: 71
Epoch 87/300 |loss: 0.000441| train set 2.906x speedup, test set 1.416x speedup, val set 0.928x speedup, step: 72
Epoch 88/300 |loss: 0.000479| train set 2.941x speedup, test set 1.384x speedup, val set 0.964x speedup, step: 73
Epoch 89/300 |loss: 0.000423| train set 2.872x speedup, test set 1.431x speedup, val set 0.933x speedup, step: 74
Epoch 90/300 |loss: 0.000450| train set 2.869x speedup, test set 1.406x speedup, val set 0.925x speedup, step: 75
Epoch 91/300 |loss: 0.000452| train set 2.933x speedup, test set 1.422x speedup, val set 0.937x speedup, step: 76
Epoch 92/300 |loss: 0.000639| train set 2.849x speedup, test set 1.388x speedup, val set 0.933x speedup, step: 77
Epoch 93/300 |loss: 0.000852| train set 2.872x speedup, test set 1.378x speedup, val set 0.937x speedup, step: 78
Epoch 94/300 |loss: 0.000967| train set 2.732x speedup, test set 1.448x speedup, val set 0.937x speedup, step: 79
early stopping at epoch 94
Training per epoch cost 2.077 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.457s, pg runtime 1.438s, speedup 0.987x
20, opt runtime 1.428s, model runtime 1.528s, pg runtime 1.428s, speedup 0.934x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 85, train speedup 2.950, test speedup 1.348, val speedup 0.925
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.254, test speedup 1.459, val speedup 1.177
last model at epoch 94, train speedup 2.732, test speedup 1.448, val speedup 0.937
execution cost 0:05:17.438581
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.240306, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007031| train set 0.971x speedup, test set 1.364x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006536| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006193| train set 0.964x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005999| train set 0.995x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005731| train set 1.036x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005384| train set 1.031x speedup, test set 1.125x speedup, val set 1.083x speedup, step: 9
Epoch 13/300 |loss: 0.005238| train set 1.061x speedup, test set 1.431x speedup, val set 1.023x speedup, step: 10
Epoch 14/300 |loss: 0.005027| train set 1.139x speedup, test set 1.366x speedup, val set 1.265x speedup, step: 1
Epoch 15/300 |loss: 0.005084| train set 0.978x speedup, test set 1.350x speedup, val set 0.980x speedup, step: 2
Epoch 16/300 |loss: 0.005040| train set 1.245x speedup, test set 1.442x speedup, val set 1.178x speedup, step: 3
Epoch 17/300 |loss: 0.004998| train set 0.992x speedup, test set 1.416x speedup, val set 0.994x speedup, step: 4
Epoch 18/300 |loss: 0.004084| train set 1.276x speedup, test set 1.352x speedup, val set 1.127x speedup, step: 5
Epoch 19/300 |loss: 0.004199| train set 1.280x speedup, test set 1.347x speedup, val set 1.133x speedup, step: 6
Epoch 20/300 |loss: 0.003733| train set 2.427x speedup, test set 1.356x speedup, val set 0.991x speedup, step: 7
Epoch 21/300 |loss: 0.003407| train set 1.267x speedup, test set 1.388x speedup, val set 0.987x speedup, step: 8
Epoch 22/300 |loss: 0.003481| train set 2.723x speedup, test set 1.381x speedup, val set 1.133x speedup, step: 9
Epoch 23/300 |loss: 0.003171| train set 2.299x speedup, test set 1.430x speedup, val set 1.066x speedup, step: 10
Epoch 24/300 |loss: 0.004074| train set 2.674x speedup, test set 1.300x speedup, val set 1.133x speedup, step: 11
Epoch 25/300 |loss: 0.003317| train set 2.702x speedup, test set 1.381x speedup, val set 1.066x speedup, step: 12
Epoch 26/300 |loss: 0.003102| train set 2.588x speedup, test set 1.328x speedup, val set 0.931x speedup, step: 13
Epoch 27/300 |loss: 0.002949| train set 2.807x speedup, test set 1.415x speedup, val set 1.052x speedup, step: 14
Epoch 28/300 |loss: 0.002734| train set 2.688x speedup, test set 1.389x speedup, val set 0.934x speedup, step: 15
Epoch 29/300 |loss: 0.002619| train set 2.657x speedup, test set 1.348x speedup, val set 1.041x speedup, step: 16
Epoch 30/300 |loss: 0.002432| train set 2.424x speedup, test set 1.145x speedup, val set 1.047x speedup, step: 17
Epoch 31/300 |loss: 0.002426| train set 2.684x speedup, test set 1.380x speedup, val set 0.883x speedup, step: 18
Epoch 32/300 |loss: 0.002562| train set 2.587x speedup, test set 1.350x speedup, val set 1.041x speedup, step: 19
Epoch 33/300 |loss: 0.002612| train set 2.761x speedup, test set 1.123x speedup, val set 1.052x speedup, step: 20
Epoch 34/300 |loss: 0.002088| train set 2.851x speedup, test set 1.375x speedup, val set 1.053x speedup, step: 21
Epoch 35/300 |loss: 0.002244| train set 2.683x speedup, test set 1.123x speedup, val set 0.934x speedup, step: 22
Epoch 36/300 |loss: 0.002195| train set 2.552x speedup, test set 1.138x speedup, val set 0.934x speedup, step: 23
Epoch 37/300 |loss: 0.001972| train set 2.758x speedup, test set 1.221x speedup, val set 1.046x speedup, step: 24
Epoch 38/300 |loss: 0.002078| train set 2.832x speedup, test set 1.371x speedup, val set 1.046x speedup, step: 25
Epoch 39/300 |loss: 0.001989| train set 2.827x speedup, test set 1.356x speedup, val set 1.052x speedup, step: 26
Epoch 40/300 |loss: 0.002230| train set 2.853x speedup, test set 1.123x speedup, val set 1.048x speedup, step: 27
Epoch 41/300 |loss: 0.001756| train set 2.901x speedup, test set 1.126x speedup, val set 1.052x speedup, step: 28
Epoch 42/300 |loss: 0.001717| train set 2.825x speedup, test set 1.389x speedup, val set 1.039x speedup, step: 29
Epoch 43/300 |loss: 0.001756| train set 2.919x speedup, test set 1.455x speedup, val set 1.052x speedup, step: 30
Epoch 44/300 |loss: 0.001710| train set 2.746x speedup, test set 1.117x speedup, val set 0.931x speedup, step: 31
Epoch 45/300 |loss: 0.001777| train set 2.735x speedup, test set 1.140x speedup, val set 0.934x speedup, step: 32
Epoch 46/300 |loss: 0.001819| train set 2.797x speedup, test set 1.351x speedup, val set 1.052x speedup, step: 33
Epoch 47/300 |loss: 0.001604| train set 2.732x speedup, test set 1.174x speedup, val set 1.048x speedup, step: 34
Epoch 48/300 |loss: 0.001571| train set 2.849x speedup, test set 1.179x speedup, val set 1.044x speedup, step: 35
Epoch 49/300 |loss: 0.001493| train set 2.839x speedup, test set 1.455x speedup, val set 1.044x speedup, step: 36
Epoch 50/300 |loss: 0.001271| train set 2.877x speedup, test set 1.183x speedup, val set 0.931x speedup, step: 37
Epoch 51/300 |loss: 0.001339| train set 2.854x speedup, test set 1.132x speedup, val set 1.040x speedup, step: 38
Epoch 52/300 |loss: 0.001160| train set 2.781x speedup, test set 1.164x speedup, val set 1.039x speedup, step: 39
Epoch 53/300 |loss: 0.001429| train set 2.501x speedup, test set 1.118x speedup, val set 1.047x speedup, step: 40
Epoch 54/300 |loss: 0.001421| train set 2.771x speedup, test set 1.175x speedup, val set 1.052x speedup, step: 41
Epoch 55/300 |loss: 0.001198| train set 2.809x speedup, test set 1.136x speedup, val set 0.883x speedup, step: 42
Epoch 56/300 |loss: 0.001087| train set 2.875x speedup, test set 1.123x speedup, val set 1.052x speedup, step: 43
Epoch 57/300 |loss: 0.000987| train set 2.938x speedup, test set 1.126x speedup, val set 1.052x speedup, step: 44
Epoch 58/300 |loss: 0.001598| train set 2.781x speedup, test set 1.116x speedup, val set 1.034x speedup, step: 45
Epoch 59/300 |loss: 0.001125| train set 2.835x speedup, test set 1.123x speedup, val set 1.052x speedup, step: 46
Epoch 60/300 |loss: 0.001266| train set 2.900x speedup, test set 1.123x speedup, val set 1.044x speedup, step: 47
Epoch 61/300 |loss: 0.001220| train set 2.854x speedup, test set 1.123x speedup, val set 1.048x speedup, step: 48
early stopping at epoch 61
Training per epoch cost 2.156 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 100.428s, pg runtime 87.340s, speedup 0.870x
12, opt runtime 26.602s, model runtime 100.512s, pg runtime 85.447s, speedup 0.850x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.457s, pg runtime 1.438s, speedup 0.987x
20, opt runtime 1.428s, model runtime 1.528s, pg runtime 1.428s, speedup 0.934x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
34, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 57, train speedup 2.938, test speedup 1.126, val speedup 1.052
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 14, train speedup 1.139, test speedup 1.366, val speedup 1.265
last model at epoch 61, train speedup 2.854, test speedup 1.123, val speedup 1.048
execution cost 0:03:46.455085
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.224470, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007033| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006538| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006177| train set 0.964x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.006006| train set 0.992x speedup, test set 1.128x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005738| train set 1.009x speedup, test set 1.357x speedup, val set 1.076x speedup, step: 8
Epoch 12/300 |loss: 0.005376| train set 1.032x speedup, test set 1.125x speedup, val set 1.102x speedup, step: 9
Epoch 13/300 |loss: 0.005190| train set 1.060x speedup, test set 1.354x speedup, val set 1.023x speedup, step: 10
Epoch 14/300 |loss: 0.005021| train set 1.050x speedup, test set 1.366x speedup, val set 1.040x speedup, step: 11
Epoch 15/300 |loss: 0.005184| train set 1.025x speedup, test set 0.951x speedup, val set 1.099x speedup, step: 12
Epoch 16/300 |loss: 0.004894| train set 1.257x speedup, test set 1.442x speedup, val set 1.288x speedup, step: 1
Epoch 17/300 |loss: 0.005053| train set 1.046x speedup, test set 1.340x speedup, val set 1.083x speedup, step: 2
Epoch 18/300 |loss: 0.004082| train set 1.300x speedup, test set 1.352x speedup, val set 1.020x speedup, step: 3
Epoch 19/300 |loss: 0.004051| train set 1.272x speedup, test set 1.350x speedup, val set 1.043x speedup, step: 4
Epoch 20/300 |loss: 0.003797| train set 2.453x speedup, test set 1.382x speedup, val set 1.001x speedup, step: 5
Epoch 21/300 |loss: 0.003366| train set 1.269x speedup, test set 1.356x speedup, val set 0.978x speedup, step: 6
Epoch 22/300 |loss: 0.003423| train set 2.616x speedup, test set 1.389x speedup, val set 1.133x speedup, step: 7
Epoch 23/300 |loss: 0.003102| train set 2.391x speedup, test set 1.382x speedup, val set 1.066x speedup, step: 8
Epoch 24/300 |loss: 0.003597| train set 2.589x speedup, test set 1.348x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003118| train set 2.390x speedup, test set 1.389x speedup, val set 1.066x speedup, step: 10
Epoch 26/300 |loss: 0.002875| train set 2.753x speedup, test set 1.348x speedup, val set 0.934x speedup, step: 11
Epoch 27/300 |loss: 0.002870| train set 2.696x speedup, test set 1.356x speedup, val set 0.840x speedup, step: 12
Epoch 28/300 |loss: 0.002776| train set 2.680x speedup, test set 1.349x speedup, val set 0.842x speedup, step: 13
Epoch 29/300 |loss: 0.002611| train set 2.751x speedup, test set 1.348x speedup, val set 0.921x speedup, step: 14
Epoch 30/300 |loss: 0.002679| train set 2.335x speedup, test set 1.126x speedup, val set 0.831x speedup, step: 15
Epoch 31/300 |loss: 0.002513| train set 2.743x speedup, test set 1.380x speedup, val set 0.833x speedup, step: 16
Epoch 32/300 |loss: 0.002862| train set 2.564x speedup, test set 1.374x speedup, val set 0.842x speedup, step: 17
Epoch 33/300 |loss: 0.002657| train set 2.834x speedup, test set 1.341x speedup, val set 0.842x speedup, step: 18
Epoch 34/300 |loss: 0.002158| train set 2.803x speedup, test set 1.348x speedup, val set 0.934x speedup, step: 19
Epoch 35/300 |loss: 0.002384| train set 2.730x speedup, test set 1.121x speedup, val set 0.839x speedup, step: 20
Epoch 36/300 |loss: 0.002108| train set 2.530x speedup, test set 1.341x speedup, val set 0.838x speedup, step: 21
Epoch 37/300 |loss: 0.002042| train set 2.815x speedup, test set 1.341x speedup, val set 0.842x speedup, step: 22
Epoch 38/300 |loss: 0.001943| train set 2.873x speedup, test set 1.365x speedup, val set 0.838x speedup, step: 23
Epoch 39/300 |loss: 0.001884| train set 2.829x speedup, test set 1.354x speedup, val set 0.913x speedup, step: 24
Epoch 40/300 |loss: 0.002176| train set 2.758x speedup, test set 1.341x speedup, val set 0.824x speedup, step: 25
Epoch 41/300 |loss: 0.001981| train set 2.833x speedup, test set 1.341x speedup, val set 1.053x speedup, step: 26
Epoch 42/300 |loss: 0.001785| train set 2.872x speedup, test set 1.341x speedup, val set 0.839x speedup, step: 27
Epoch 43/300 |loss: 0.001803| train set 2.882x speedup, test set 1.128x speedup, val set 0.934x speedup, step: 28
Epoch 44/300 |loss: 0.001680| train set 2.708x speedup, test set 1.341x speedup, val set 0.938x speedup, step: 29
Epoch 45/300 |loss: 0.001910| train set 2.820x speedup, test set 1.128x speedup, val set 1.047x speedup, step: 30
Epoch 46/300 |loss: 0.001764| train set 2.807x speedup, test set 1.348x speedup, val set 1.052x speedup, step: 31
Epoch 47/300 |loss: 0.001620| train set 2.920x speedup, test set 1.351x speedup, val set 1.048x speedup, step: 32
Epoch 48/300 |loss: 0.001583| train set 2.763x speedup, test set 1.341x speedup, val set 1.052x speedup, step: 33
Epoch 49/300 |loss: 0.001511| train set 2.831x speedup, test set 1.351x speedup, val set 1.054x speedup, step: 34
Epoch 50/300 |loss: 0.001447| train set 2.557x speedup, test set 1.341x speedup, val set 0.917x speedup, step: 35
Epoch 51/300 |loss: 0.001321| train set 2.808x speedup, test set 1.341x speedup, val set 0.936x speedup, step: 36
Epoch 52/300 |loss: 0.001203| train set 2.881x speedup, test set 1.131x speedup, val set 1.046x speedup, step: 37
Epoch 53/300 |loss: 0.001560| train set 2.573x speedup, test set 1.123x speedup, val set 0.934x speedup, step: 38
Epoch 54/300 |loss: 0.001577| train set 2.827x speedup, test set 1.124x speedup, val set 1.022x speedup, step: 39
Epoch 55/300 |loss: 0.001344| train set 2.833x speedup, test set 1.351x speedup, val set 0.917x speedup, step: 40
Epoch 56/300 |loss: 0.001184| train set 2.847x speedup, test set 1.350x speedup, val set 1.052x speedup, step: 41
Epoch 57/300 |loss: 0.001146| train set 2.855x speedup, test set 1.359x speedup, val set 1.052x speedup, step: 42
Epoch 58/300 |loss: 0.001416| train set 2.789x speedup, test set 1.366x speedup, val set 0.929x speedup, step: 43
Epoch 59/300 |loss: 0.001098| train set 2.828x speedup, test set 1.351x speedup, val set 0.907x speedup, step: 44
Epoch 60/300 |loss: 0.001253| train set 2.773x speedup, test set 1.357x speedup, val set 1.044x speedup, step: 45
Epoch 61/300 |loss: 0.001091| train set 2.821x speedup, test set 1.366x speedup, val set 1.052x speedup, step: 46
Epoch 62/300 |loss: 0.001097| train set 2.715x speedup, test set 1.352x speedup, val set 0.938x speedup, step: 47
Epoch 63/300 |loss: 0.000933| train set 2.827x speedup, test set 1.366x speedup, val set 0.938x speedup, step: 48
Epoch 64/300 |loss: 0.001184| train set 2.667x speedup, test set 1.359x speedup, val set 1.030x speedup, step: 49
Epoch 65/300 |loss: 0.001481| train set 2.844x speedup, test set 1.351x speedup, val set 1.048x speedup, step: 50
early stopping at epoch 65
Training per epoch cost 2.175 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 34.379s, pg runtime 21.298s, speedup 0.620x
14, opt runtime 3.258s, model runtime 30.464s, pg runtime 18.141s, speedup 0.595x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 47, train speedup 2.920, test speedup 1.351, val speedup 1.048
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.257, test speedup 1.442, val speedup 1.288
last model at epoch 65, train speedup 2.844, test speedup 1.351, val speedup 1.048
execution cost 0:04:05.311149
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.712793, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007034| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006543| train set 1.481x speedup, test set 1.344x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006196| train set 0.962x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005955| train set 1.004x speedup, test set 1.125x speedup, val set 1.101x speedup, step: 7
Epoch 11/300 |loss: 0.005767| train set 1.025x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005397| train set 1.017x speedup, test set 1.125x speedup, val set 1.087x speedup, step: 9
Epoch 13/300 |loss: 0.005211| train set 1.004x speedup, test set 1.352x speedup, val set 1.085x speedup, step: 10
Epoch 14/300 |loss: 0.004989| train set 1.050x speedup, test set 1.352x speedup, val set 1.041x speedup, step: 11
Epoch 15/300 |loss: 0.005198| train set 1.029x speedup, test set 0.955x speedup, val set 1.110x speedup, step: 12
Epoch 16/300 |loss: 0.004905| train set 1.254x speedup, test set 1.442x speedup, val set 1.247x speedup, step: 1
Epoch 17/300 |loss: 0.005073| train set 0.984x speedup, test set 1.334x speedup, val set 1.083x speedup, step: 2
Epoch 18/300 |loss: 0.004096| train set 1.277x speedup, test set 1.340x speedup, val set 1.007x speedup, step: 3
Epoch 19/300 |loss: 0.004276| train set 1.219x speedup, test set 1.338x speedup, val set 1.043x speedup, step: 4
Epoch 20/300 |loss: 0.003819| train set 1.285x speedup, test set 1.329x speedup, val set 0.966x speedup, step: 5
Epoch 21/300 |loss: 0.003447| train set 1.205x speedup, test set 1.396x speedup, val set 0.984x speedup, step: 6
Epoch 22/300 |loss: 0.003455| train set 2.652x speedup, test set 1.353x speedup, val set 1.001x speedup, step: 7
Epoch 23/300 |loss: 0.003196| train set 2.309x speedup, test set 1.325x speedup, val set 0.945x speedup, step: 8
Epoch 24/300 |loss: 0.003987| train set 2.693x speedup, test set 1.301x speedup, val set 1.187x speedup, step: 9
Epoch 25/300 |loss: 0.003547| train set 2.670x speedup, test set 1.331x speedup, val set 0.949x speedup, step: 10
Epoch 26/300 |loss: 0.003531| train set 2.593x speedup, test set 1.330x speedup, val set 0.997x speedup, step: 11
Epoch 27/300 |loss: 0.003045| train set 2.677x speedup, test set 1.328x speedup, val set 0.839x speedup, step: 12
Epoch 28/300 |loss: 0.002734| train set 2.709x speedup, test set 1.389x speedup, val set 0.839x speedup, step: 13
Epoch 29/300 |loss: 0.002677| train set 2.757x speedup, test set 1.328x speedup, val set 0.840x speedup, step: 14
Epoch 30/300 |loss: 0.002498| train set 2.453x speedup, test set 1.331x speedup, val set 0.835x speedup, step: 15
Epoch 31/300 |loss: 0.002414| train set 2.657x speedup, test set 1.415x speedup, val set 0.798x speedup, step: 16
Epoch 32/300 |loss: 0.002769| train set 2.888x speedup, test set 1.328x speedup, val set 0.840x speedup, step: 17
Epoch 33/300 |loss: 0.002693| train set 2.780x speedup, test set 1.301x speedup, val set 0.842x speedup, step: 18
Epoch 34/300 |loss: 0.002207| train set 2.760x speedup, test set 1.356x speedup, val set 0.841x speedup, step: 19
Epoch 35/300 |loss: 0.002307| train set 2.775x speedup, test set 1.302x speedup, val set 0.838x speedup, step: 20
Epoch 36/300 |loss: 0.002216| train set 2.487x speedup, test set 1.331x speedup, val set 0.838x speedup, step: 21
Epoch 37/300 |loss: 0.001973| train set 2.799x speedup, test set 1.357x speedup, val set 0.838x speedup, step: 22
Epoch 38/300 |loss: 0.001982| train set 2.853x speedup, test set 1.424x speedup, val set 0.838x speedup, step: 23
Epoch 39/300 |loss: 0.001840| train set 2.863x speedup, test set 1.417x speedup, val set 0.834x speedup, step: 24
Epoch 40/300 |loss: 0.002106| train set 2.815x speedup, test set 1.127x speedup, val set 0.837x speedup, step: 25
Epoch 41/300 |loss: 0.001954| train set 2.862x speedup, test set 1.417x speedup, val set 0.841x speedup, step: 26
Epoch 42/300 |loss: 0.001712| train set 2.842x speedup, test set 1.460x speedup, val set 0.839x speedup, step: 27
Epoch 43/300 |loss: 0.001938| train set 2.860x speedup, test set 1.301x speedup, val set 0.838x speedup, step: 28
Epoch 44/300 |loss: 0.001687| train set 2.815x speedup, test set 1.475x speedup, val set 0.842x speedup, step: 29
Epoch 45/300 |loss: 0.001824| train set 2.726x speedup, test set 1.452x speedup, val set 0.839x speedup, step: 30
Epoch 46/300 |loss: 0.001935| train set 2.763x speedup, test set 1.360x speedup, val set 0.839x speedup, step: 31
Epoch 47/300 |loss: 0.001655| train set 2.779x speedup, test set 1.442x speedup, val set 0.838x speedup, step: 32
Epoch 48/300 |loss: 0.001599| train set 2.865x speedup, test set 1.463x speedup, val set 0.830x speedup, step: 33
Epoch 49/300 |loss: 0.001473| train set 2.838x speedup, test set 1.417x speedup, val set 0.842x speedup, step: 34
Epoch 50/300 |loss: 0.001322| train set 2.531x speedup, test set 1.475x speedup, val set 0.911x speedup, step: 35
Epoch 51/300 |loss: 0.001463| train set 2.818x speedup, test set 1.490x speedup, val set 0.934x speedup, step: 36
Epoch 52/300 |loss: 0.001279| train set 2.873x speedup, test set 1.425x speedup, val set 0.839x speedup, step: 37
Epoch 53/300 |loss: 0.001398| train set 2.847x speedup, test set 1.425x speedup, val set 0.839x speedup, step: 38
Epoch 54/300 |loss: 0.001448| train set 2.511x speedup, test set 1.418x speedup, val set 0.832x speedup, step: 39
Epoch 55/300 |loss: 0.001439| train set 2.342x speedup, test set 1.388x speedup, val set 0.827x speedup, step: 40
Epoch 56/300 |loss: 0.001337| train set 2.800x speedup, test set 1.320x speedup, val set 0.826x speedup, step: 41
Epoch 57/300 |loss: 0.001311| train set 2.853x speedup, test set 1.410x speedup, val set 0.842x speedup, step: 42
Epoch 58/300 |loss: 0.001441| train set 2.813x speedup, test set 1.413x speedup, val set 0.893x speedup, step: 43
Epoch 59/300 |loss: 0.001120| train set 2.854x speedup, test set 1.430x speedup, val set 0.824x speedup, step: 44
Epoch 60/300 |loss: 0.001139| train set 2.901x speedup, test set 1.359x speedup, val set 0.919x speedup, step: 45
Epoch 61/300 |loss: 0.001169| train set 2.901x speedup, test set 1.405x speedup, val set 0.806x speedup, step: 46
Epoch 62/300 |loss: 0.001091| train set 2.787x speedup, test set 1.435x speedup, val set 0.835x speedup, step: 47
Epoch 63/300 |loss: 0.000987| train set 2.826x speedup, test set 1.360x speedup, val set 0.833x speedup, step: 48
Epoch 64/300 |loss: 0.001244| train set 2.617x speedup, test set 1.360x speedup, val set 0.787x speedup, step: 49
Epoch 65/300 |loss: 0.001321| train set 2.483x speedup, test set 1.405x speedup, val set 0.799x speedup, step: 50
Epoch 66/300 |loss: 0.001116| train set 2.863x speedup, test set 1.357x speedup, val set 0.803x speedup, step: 51
Epoch 67/300 |loss: 0.001172| train set 2.756x speedup, test set 1.338x speedup, val set 0.833x speedup, step: 52
Epoch 68/300 |loss: 0.001264| train set 2.881x speedup, test set 1.405x speedup, val set 0.806x speedup, step: 53
early stopping at epoch 68
Training per epoch cost 2.114 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 34.379s, pg runtime 21.298s, speedup 0.620x
14, opt runtime 3.258s, model runtime 30.464s, pg runtime 18.141s, speedup 0.595x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 61, train speedup 2.901, test speedup 1.405, val speedup 0.806
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.254, test speedup 1.442, val speedup 1.247
last model at epoch 68, train speedup 2.881, test speedup 1.405, val speedup 0.806
execution cost 0:03:58.014101
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.880171, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008263| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007590| train set 1.473x speedup, test set 1.378x speedup, val set 1.107x speedup, step: 3
Epoch 7/300 |loss: 0.007025| train set 0.951x speedup, test set 1.361x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006529| train set 1.479x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006209| train set 0.962x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005956| train set 0.999x speedup, test set 1.126x speedup, val set 1.101x speedup, step: 7
Epoch 11/300 |loss: 0.005833| train set 1.027x speedup, test set 1.348x speedup, val set 1.092x speedup, step: 8
Epoch 12/300 |loss: 0.005342| train set 1.028x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 9
Epoch 13/300 |loss: 0.005176| train set 1.062x speedup, test set 1.323x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005042| train set 1.073x speedup, test set 1.350x speedup, val set 1.072x speedup, step: 11
Epoch 15/300 |loss: 0.005206| train set 1.014x speedup, test set 1.122x speedup, val set 1.078x speedup, step: 12
Epoch 16/300 |loss: 0.004935| train set 1.226x speedup, test set 1.474x speedup, val set 1.168x speedup, step: 1
Epoch 17/300 |loss: 0.005062| train set 1.053x speedup, test set 1.352x speedup, val set 1.101x speedup, step: 2
Epoch 18/300 |loss: 0.004077| train set 1.279x speedup, test set 1.369x speedup, val set 1.025x speedup, step: 3
Epoch 19/300 |loss: 0.004307| train set 1.272x speedup, test set 1.411x speedup, val set 1.118x speedup, step: 4
Epoch 20/300 |loss: 0.003706| train set 1.252x speedup, test set 1.332x speedup, val set 0.966x speedup, step: 5
Epoch 21/300 |loss: 0.003510| train set 1.268x speedup, test set 1.337x speedup, val set 0.929x speedup, step: 6
Epoch 22/300 |loss: 0.003448| train set 2.561x speedup, test set 1.388x speedup, val set 1.001x speedup, step: 7
Epoch 23/300 |loss: 0.003124| train set 2.325x speedup, test set 1.359x speedup, val set 0.949x speedup, step: 8
Epoch 24/300 |loss: 0.004015| train set 2.670x speedup, test set 1.439x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003431| train set 2.671x speedup, test set 1.330x speedup, val set 0.949x speedup, step: 10
Epoch 26/300 |loss: 0.002945| train set 2.743x speedup, test set 1.381x speedup, val set 0.949x speedup, step: 11
Epoch 27/300 |loss: 0.002936| train set 2.667x speedup, test set 1.389x speedup, val set 0.842x speedup, step: 12
Epoch 28/300 |loss: 0.002639| train set 2.732x speedup, test set 1.388x speedup, val set 0.938x speedup, step: 13
Epoch 29/300 |loss: 0.002743| train set 2.689x speedup, test set 1.381x speedup, val set 1.051x speedup, step: 14
Epoch 30/300 |loss: 0.002541| train set 2.368x speedup, test set 1.388x speedup, val set 0.929x speedup, step: 15
Epoch 31/300 |loss: 0.002443| train set 2.658x speedup, test set 1.389x speedup, val set 0.940x speedup, step: 16
Epoch 32/300 |loss: 0.002907| train set 2.790x speedup, test set 1.381x speedup, val set 0.933x speedup, step: 17
Epoch 33/300 |loss: 0.002676| train set 2.746x speedup, test set 1.348x speedup, val set 1.000x speedup, step: 18
Epoch 34/300 |loss: 0.002174| train set 2.881x speedup, test set 1.348x speedup, val set 0.938x speedup, step: 19
Epoch 35/300 |loss: 0.002330| train set 2.504x speedup, test set 1.348x speedup, val set 0.934x speedup, step: 20
Epoch 36/300 |loss: 0.002139| train set 2.593x speedup, test set 1.381x speedup, val set 0.839x speedup, step: 21
Epoch 37/300 |loss: 0.002048| train set 2.834x speedup, test set 1.348x speedup, val set 0.841x speedup, step: 22
Epoch 38/300 |loss: 0.002113| train set 2.872x speedup, test set 1.381x speedup, val set 0.832x speedup, step: 23
Epoch 39/300 |loss: 0.001972| train set 2.910x speedup, test set 1.368x speedup, val set 0.842x speedup, step: 24
Epoch 40/300 |loss: 0.002000| train set 2.870x speedup, test set 1.416x speedup, val set 0.838x speedup, step: 25
Epoch 41/300 |loss: 0.001803| train set 2.804x speedup, test set 1.368x speedup, val set 0.929x speedup, step: 26
Epoch 42/300 |loss: 0.001685| train set 2.919x speedup, test set 1.368x speedup, val set 0.839x speedup, step: 27
Epoch 43/300 |loss: 0.001812| train set 2.881x speedup, test set 1.381x speedup, val set 0.947x speedup, step: 28
Epoch 44/300 |loss: 0.001625| train set 2.760x speedup, test set 1.368x speedup, val set 0.842x speedup, step: 29
Epoch 45/300 |loss: 0.001953| train set 2.759x speedup, test set 1.369x speedup, val set 0.925x speedup, step: 30
Epoch 46/300 |loss: 0.001810| train set 2.813x speedup, test set 1.367x speedup, val set 0.750x speedup, step: 31
Epoch 47/300 |loss: 0.001612| train set 2.867x speedup, test set 1.445x speedup, val set 0.839x speedup, step: 32
Epoch 48/300 |loss: 0.001573| train set 2.893x speedup, test set 1.369x speedup, val set 0.849x speedup, step: 33
Epoch 49/300 |loss: 0.001480| train set 2.913x speedup, test set 1.439x speedup, val set 0.842x speedup, step: 34
Epoch 50/300 |loss: 0.001294| train set 2.538x speedup, test set 1.444x speedup, val set 0.841x speedup, step: 35
Epoch 51/300 |loss: 0.001475| train set 2.871x speedup, test set 1.444x speedup, val set 0.832x speedup, step: 36
Epoch 52/300 |loss: 0.001321| train set 2.889x speedup, test set 1.446x speedup, val set 0.839x speedup, step: 37
Epoch 53/300 |loss: 0.001286| train set 2.930x speedup, test set 0.991x speedup, val set 0.839x speedup, step: 38
Epoch 54/300 |loss: 0.001269| train set 2.748x speedup, test set 0.991x speedup, val set 0.823x speedup, step: 39
Epoch 55/300 |loss: 0.001357| train set 2.858x speedup, test set 1.360x speedup, val set 0.828x speedup, step: 40
Epoch 56/300 |loss: 0.001182| train set 2.823x speedup, test set 1.453x speedup, val set 0.842x speedup, step: 41
Epoch 57/300 |loss: 0.001159| train set 2.900x speedup, test set 1.444x speedup, val set 0.842x speedup, step: 42
Epoch 58/300 |loss: 0.001496| train set 2.815x speedup, test set 1.479x speedup, val set 0.842x speedup, step: 43
Epoch 59/300 |loss: 0.001205| train set 2.822x speedup, test set 1.354x speedup, val set 0.842x speedup, step: 44
Epoch 60/300 |loss: 0.001375| train set 2.866x speedup, test set 1.421x speedup, val set 0.835x speedup, step: 45
Epoch 61/300 |loss: 0.001219| train set 2.875x speedup, test set 0.968x speedup, val set 0.859x speedup, step: 46
Epoch 62/300 |loss: 0.001106| train set 2.743x speedup, test set 1.382x speedup, val set 0.842x speedup, step: 47
Epoch 63/300 |loss: 0.000857| train set 2.836x speedup, test set 0.968x speedup, val set 0.854x speedup, step: 48
Epoch 64/300 |loss: 0.001006| train set 2.625x speedup, test set 0.968x speedup, val set 0.842x speedup, step: 49
Epoch 65/300 |loss: 0.001344| train set 2.815x speedup, test set 1.368x speedup, val set 0.954x speedup, step: 50
Epoch 66/300 |loss: 0.001025| train set 2.846x speedup, test set 0.983x speedup, val set 0.851x speedup, step: 51
Epoch 67/300 |loss: 0.001006| train set 2.774x speedup, test set 0.972x speedup, val set 0.839x speedup, step: 52
Epoch 68/300 |loss: 0.000966| train set 2.905x speedup, test set 0.985x speedup, val set 0.933x speedup, step: 53
Epoch 69/300 |loss: 0.001008| train set 2.541x speedup, test set 1.394x speedup, val set 0.858x speedup, step: 54
Epoch 70/300 |loss: 0.000985| train set 2.942x speedup, test set 1.007x speedup, val set 0.954x speedup, step: 55
Epoch 71/300 |loss: 0.000937| train set 2.856x speedup, test set 1.476x speedup, val set 0.603x speedup, step: 56
Epoch 72/300 |loss: 0.000731| train set 2.903x speedup, test set 1.426x speedup, val set 0.858x speedup, step: 57
Epoch 73/300 |loss: 0.000722| train set 2.841x speedup, test set 0.981x speedup, val set 0.933x speedup, step: 58
Epoch 74/300 |loss: 0.000674| train set 2.900x speedup, test set 1.014x speedup, val set 0.859x speedup, step: 59
Epoch 75/300 |loss: 0.000697| train set 2.954x speedup, test set 0.997x speedup, val set 0.841x speedup, step: 60
Epoch 76/300 |loss: 0.000589| train set 2.847x speedup, test set 0.983x speedup, val set 0.859x speedup, step: 61
Epoch 77/300 |loss: 0.000685| train set 2.954x speedup, test set 0.994x speedup, val set 0.840x speedup, step: 62
Epoch 78/300 |loss: 0.000547| train set 2.902x speedup, test set 1.426x speedup, val set 0.842x speedup, step: 63
Epoch 79/300 |loss: 0.000511| train set 2.949x speedup, test set 1.494x speedup, val set 0.840x speedup, step: 64
Epoch 80/300 |loss: 0.000494| train set 2.892x speedup, test set 1.426x speedup, val set 0.837x speedup, step: 65
Epoch 81/300 |loss: 0.000554| train set 2.863x speedup, test set 1.468x speedup, val set 0.859x speedup, step: 66
Epoch 82/300 |loss: 0.001024| train set 2.871x speedup, test set 0.977x speedup, val set 0.850x speedup, step: 67
Epoch 83/300 |loss: 0.000980| train set 2.886x speedup, test set 1.007x speedup, val set 0.954x speedup, step: 68
early stopping at epoch 83
Training per epoch cost 2.212 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 75, train speedup 2.954, test speedup 0.997, val speedup 0.841
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.226, test speedup 1.474, val speedup 1.168
last model at epoch 83, train speedup 2.886, test speedup 1.007, val speedup 0.954
execution cost 0:05:12.049583
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.227634, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007031| train set 0.971x speedup, test set 1.364x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006536| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006195| train set 0.964x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005986| train set 0.996x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005699| train set 1.034x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005371| train set 1.032x speedup, test set 1.125x speedup, val set 1.083x speedup, step: 9
Epoch 13/300 |loss: 0.005289| train set 1.083x speedup, test set 1.353x speedup, val set 1.023x speedup, step: 10
Epoch 14/300 |loss: 0.005099| train set 1.140x speedup, test set 1.366x speedup, val set 1.012x speedup, step: 11
Epoch 15/300 |loss: 0.004955| train set 0.974x speedup, test set 1.340x speedup, val set 0.978x speedup, step: 12
Epoch 16/300 |loss: 0.004913| train set 1.258x speedup, test set 1.474x speedup, val set 1.288x speedup, step: 1
Epoch 17/300 |loss: 0.005075| train set 1.044x speedup, test set 1.394x speedup, val set 0.990x speedup, step: 2
Epoch 18/300 |loss: 0.004077| train set 1.280x speedup, test set 1.356x speedup, val set 1.133x speedup, step: 3
Epoch 19/300 |loss: 0.004259| train set 1.262x speedup, test set 1.373x speedup, val set 1.133x speedup, step: 4
Epoch 20/300 |loss: 0.003738| train set 2.547x speedup, test set 1.393x speedup, val set 1.133x speedup, step: 5
Epoch 21/300 |loss: 0.003420| train set 1.207x speedup, test set 1.389x speedup, val set 0.973x speedup, step: 6
Epoch 22/300 |loss: 0.003308| train set 2.696x speedup, test set 1.389x speedup, val set 1.133x speedup, step: 7
Epoch 23/300 |loss: 0.003078| train set 2.333x speedup, test set 1.405x speedup, val set 0.949x speedup, step: 8
Epoch 24/300 |loss: 0.003722| train set 2.712x speedup, test set 1.363x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003266| train set 2.417x speedup, test set 1.381x speedup, val set 1.297x speedup, step: 1
Epoch 26/300 |loss: 0.002761| train set 2.698x speedup, test set 1.405x speedup, val set 0.870x speedup, step: 2
Epoch 27/300 |loss: 0.002817| train set 2.743x speedup, test set 1.404x speedup, val set 0.935x speedup, step: 3
Epoch 28/300 |loss: 0.002708| train set 2.730x speedup, test set 1.144x speedup, val set 0.934x speedup, step: 4
Epoch 29/300 |loss: 0.002592| train set 2.534x speedup, test set 1.121x speedup, val set 1.043x speedup, step: 5
Epoch 30/300 |loss: 0.002434| train set 2.434x speedup, test set 1.167x speedup, val set 0.899x speedup, step: 6
Epoch 31/300 |loss: 0.002469| train set 2.689x speedup, test set 1.380x speedup, val set 0.883x speedup, step: 7
Epoch 32/300 |loss: 0.002665| train set 2.437x speedup, test set 1.342x speedup, val set 1.001x speedup, step: 8
Epoch 33/300 |loss: 0.002610| train set 2.798x speedup, test set 1.113x speedup, val set 0.839x speedup, step: 9
Epoch 34/300 |loss: 0.002093| train set 2.867x speedup, test set 1.374x speedup, val set 1.044x speedup, step: 10
Epoch 35/300 |loss: 0.002261| train set 2.619x speedup, test set 1.113x speedup, val set 0.932x speedup, step: 11
Epoch 36/300 |loss: 0.002209| train set 2.499x speedup, test set 1.380x speedup, val set 0.839x speedup, step: 12
Epoch 37/300 |loss: 0.001963| train set 2.821x speedup, test set 1.232x speedup, val set 0.910x speedup, step: 13
Epoch 38/300 |loss: 0.001995| train set 2.775x speedup, test set 1.381x speedup, val set 0.907x speedup, step: 14
Epoch 39/300 |loss: 0.001852| train set 2.873x speedup, test set 1.381x speedup, val set 1.027x speedup, step: 15
Epoch 40/300 |loss: 0.002134| train set 2.786x speedup, test set 1.417x speedup, val set 0.906x speedup, step: 16
Epoch 41/300 |loss: 0.001888| train set 2.800x speedup, test set 1.121x speedup, val set 0.907x speedup, step: 17
Epoch 42/300 |loss: 0.001849| train set 2.855x speedup, test set 1.381x speedup, val set 0.934x speedup, step: 18
Epoch 43/300 |loss: 0.002086| train set 2.684x speedup, test set 1.453x speedup, val set 0.894x speedup, step: 19
Epoch 44/300 |loss: 0.001914| train set 2.821x speedup, test set 1.348x speedup, val set 0.913x speedup, step: 20
Epoch 45/300 |loss: 0.001597| train set 2.893x speedup, test set 1.423x speedup, val set 0.913x speedup, step: 21
Epoch 46/300 |loss: 0.001608| train set 2.806x speedup, test set 1.136x speedup, val set 0.917x speedup, step: 22
Epoch 47/300 |loss: 0.001640| train set 2.842x speedup, test set 1.214x speedup, val set 0.999x speedup, step: 23
Epoch 48/300 |loss: 0.001573| train set 2.829x speedup, test set 1.138x speedup, val set 0.821x speedup, step: 24
Epoch 49/300 |loss: 0.001482| train set 2.856x speedup, test set 1.159x speedup, val set 0.929x speedup, step: 25
Epoch 50/300 |loss: 0.001349| train set 2.796x speedup, test set 1.463x speedup, val set 0.819x speedup, step: 26
Epoch 51/300 |loss: 0.001297| train set 2.837x speedup, test set 1.202x speedup, val set 0.989x speedup, step: 27
Epoch 52/300 |loss: 0.001239| train set 2.904x speedup, test set 1.203x speedup, val set 0.911x speedup, step: 28
Epoch 53/300 |loss: 0.001459| train set 2.733x speedup, test set 1.214x speedup, val set 0.947x speedup, step: 29
Epoch 54/300 |loss: 0.001291| train set 2.800x speedup, test set 1.214x speedup, val set 0.832x speedup, step: 30
Epoch 55/300 |loss: 0.001273| train set 2.747x speedup, test set 1.153x speedup, val set 0.839x speedup, step: 31
Epoch 56/300 |loss: 0.001088| train set 2.849x speedup, test set 1.198x speedup, val set 0.805x speedup, step: 32
Epoch 57/300 |loss: 0.001060| train set 2.858x speedup, test set 1.011x speedup, val set 0.852x speedup, step: 33
Epoch 58/300 |loss: 0.001681| train set 2.756x speedup, test set 1.198x speedup, val set 0.892x speedup, step: 34
Epoch 59/300 |loss: 0.001115| train set 2.852x speedup, test set 1.148x speedup, val set 0.903x speedup, step: 35
Epoch 60/300 |loss: 0.001231| train set 2.816x speedup, test set 1.151x speedup, val set 0.915x speedup, step: 36
Epoch 61/300 |loss: 0.001082| train set 2.822x speedup, test set 1.011x speedup, val set 0.923x speedup, step: 37
Epoch 62/300 |loss: 0.001163| train set 2.809x speedup, test set 1.415x speedup, val set 0.993x speedup, step: 38
Epoch 63/300 |loss: 0.000906| train set 2.707x speedup, test set 1.403x speedup, val set 0.954x speedup, step: 39
Epoch 64/300 |loss: 0.001020| train set 2.682x speedup, test set 1.154x speedup, val set 0.904x speedup, step: 40
Epoch 65/300 |loss: 0.001359| train set 2.845x speedup, test set 1.180x speedup, val set 0.895x speedup, step: 41
Epoch 66/300 |loss: 0.001088| train set 2.806x speedup, test set 1.409x speedup, val set 0.891x speedup, step: 42
early stopping at epoch 66
Training per epoch cost 2.199 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 13.017s, pg runtime 31.019s, speedup 2.383x
08, opt runtime 7.377s, model runtime 17.141s, pg runtime 28.655s, speedup 1.672x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 99.557s, pg runtime 87.340s, speedup 0.877x
12, opt runtime 26.602s, model runtime 99.044s, pg runtime 85.447s, speedup 0.863x
13, opt runtime 3.332s, model runtime 27.373s, pg runtime 21.298s, speedup 0.778x
14, opt runtime 3.258s, model runtime 24.602s, pg runtime 18.141s, speedup 0.737x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 6.234s, model runtime 10.545s, pg runtime 32.540s, speedup 3.086x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
34, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 52, train speedup 2.904, test speedup 1.203, val speedup 0.911
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 25, train speedup 2.417, test speedup 1.381, val speedup 1.297
last model at epoch 66, train speedup 2.806, test speedup 1.409, val speedup 0.891
execution cost 0:04:11.913121
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.218257, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008262| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007591| train set 1.475x speedup, test set 1.372x speedup, val set 1.107x speedup, step: 3
Epoch 7/300 |loss: 0.007031| train set 0.971x speedup, test set 1.370x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006548| train set 1.535x speedup, test set 1.372x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006178| train set 0.981x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005995| train set 0.999x speedup, test set 1.122x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005845| train set 1.025x speedup, test set 1.357x speedup, val set 1.092x speedup, step: 8
Epoch 12/300 |loss: 0.005336| train set 1.018x speedup, test set 1.121x speedup, val set 1.087x speedup, step: 9
Epoch 13/300 |loss: 0.005193| train set 1.077x speedup, test set 1.328x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005040| train set 1.073x speedup, test set 1.352x speedup, val set 1.071x speedup, step: 11
Epoch 15/300 |loss: 0.005139| train set 1.020x speedup, test set 1.360x speedup, val set 1.098x speedup, step: 12
Epoch 16/300 |loss: 0.004854| train set 1.236x speedup, test set 1.487x speedup, val set 1.267x speedup, step: 1
Epoch 17/300 |loss: 0.005041| train set 0.977x speedup, test set 1.330x speedup, val set 0.984x speedup, step: 2
Epoch 18/300 |loss: 0.004058| train set 1.285x speedup, test set 1.351x speedup, val set 0.991x speedup, step: 3
Epoch 19/300 |loss: 0.004330| train set 1.263x speedup, test set 1.329x speedup, val set 0.989x speedup, step: 4
Epoch 20/300 |loss: 0.003796| train set 1.292x speedup, test set 1.390x speedup, val set 0.989x speedup, step: 5
Epoch 21/300 |loss: 0.003493| train set 1.213x speedup, test set 1.306x speedup, val set 0.988x speedup, step: 6
Epoch 22/300 |loss: 0.003492| train set 2.608x speedup, test set 1.330x speedup, val set 1.001x speedup, step: 7
Epoch 23/300 |loss: 0.003169| train set 2.262x speedup, test set 1.382x speedup, val set 0.937x speedup, step: 8
Epoch 24/300 |loss: 0.004244| train set 2.749x speedup, test set 1.320x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003459| train set 2.717x speedup, test set 1.352x speedup, val set 1.001x speedup, step: 10
Epoch 26/300 |loss: 0.003342| train set 2.616x speedup, test set 1.296x speedup, val set 0.997x speedup, step: 11
Epoch 27/300 |loss: 0.003011| train set 2.728x speedup, test set 1.360x speedup, val set 0.947x speedup, step: 12
Epoch 28/300 |loss: 0.002659| train set 2.681x speedup, test set 1.300x speedup, val set 0.976x speedup, step: 13
Epoch 29/300 |loss: 0.002628| train set 2.733x speedup, test set 1.301x speedup, val set 0.812x speedup, step: 14
Epoch 30/300 |loss: 0.002510| train set 2.659x speedup, test set 1.389x speedup, val set 0.822x speedup, step: 15
Epoch 31/300 |loss: 0.002336| train set 2.424x speedup, test set 1.415x speedup, val set 0.843x speedup, step: 16
Epoch 32/300 |loss: 0.002822| train set 2.687x speedup, test set 1.301x speedup, val set 0.825x speedup, step: 17
Epoch 33/300 |loss: 0.002742| train set 2.770x speedup, test set 1.352x speedup, val set 0.962x speedup, step: 18
Epoch 34/300 |loss: 0.002168| train set 2.825x speedup, test set 1.352x speedup, val set 1.083x speedup, step: 19
Epoch 35/300 |loss: 0.002324| train set 2.417x speedup, test set 1.349x speedup, val set 0.981x speedup, step: 20
Epoch 36/300 |loss: 0.002090| train set 2.539x speedup, test set 1.352x speedup, val set 0.839x speedup, step: 21
Epoch 37/300 |loss: 0.001990| train set 2.871x speedup, test set 1.352x speedup, val set 0.930x speedup, step: 22
Epoch 38/300 |loss: 0.002150| train set 2.921x speedup, test set 1.352x speedup, val set 0.834x speedup, step: 23
Epoch 39/300 |loss: 0.002037| train set 2.479x speedup, test set 1.376x speedup, val set 0.837x speedup, step: 24
Epoch 40/300 |loss: 0.002150| train set 2.870x speedup, test set 1.425x speedup, val set 0.842x speedup, step: 25
Epoch 41/300 |loss: 0.001772| train set 2.916x speedup, test set 1.363x speedup, val set 0.839x speedup, step: 26
Epoch 42/300 |loss: 0.001779| train set 2.853x speedup, test set 1.359x speedup, val set 0.840x speedup, step: 27
Epoch 43/300 |loss: 0.001849| train set 2.581x speedup, test set 1.384x speedup, val set 0.842x speedup, step: 28
Epoch 44/300 |loss: 0.001610| train set 2.867x speedup, test set 1.363x speedup, val set 0.843x speedup, step: 29
Epoch 45/300 |loss: 0.001761| train set 2.762x speedup, test set 1.388x speedup, val set 0.843x speedup, step: 30
Epoch 46/300 |loss: 0.001854| train set 2.775x speedup, test set 1.362x speedup, val set 0.710x speedup, step: 31
Epoch 47/300 |loss: 0.001647| train set 2.908x speedup, test set 1.363x speedup, val set 0.947x speedup, step: 32
Epoch 48/300 |loss: 0.001595| train set 2.835x speedup, test set 1.384x speedup, val set 0.850x speedup, step: 33
Epoch 49/300 |loss: 0.001460| train set 2.887x speedup, test set 1.384x speedup, val set 0.837x speedup, step: 34
Epoch 50/300 |loss: 0.001363| train set 2.535x speedup, test set 1.384x speedup, val set 0.832x speedup, step: 35
Epoch 51/300 |loss: 0.001327| train set 2.884x speedup, test set 1.363x speedup, val set 0.833x speedup, step: 36
Epoch 52/300 |loss: 0.001261| train set 2.910x speedup, test set 1.363x speedup, val set 0.838x speedup, step: 37
Epoch 53/300 |loss: 0.001435| train set 2.816x speedup, test set 1.363x speedup, val set 0.945x speedup, step: 38
Epoch 54/300 |loss: 0.001382| train set 2.834x speedup, test set 1.384x speedup, val set 0.839x speedup, step: 39
Epoch 55/300 |loss: 0.001470| train set 2.833x speedup, test set 1.363x speedup, val set 0.928x speedup, step: 40
Epoch 56/300 |loss: 0.001181| train set 2.832x speedup, test set 1.384x speedup, val set 0.940x speedup, step: 41
Epoch 57/300 |loss: 0.001220| train set 2.844x speedup, test set 1.384x speedup, val set 0.952x speedup, step: 42
Epoch 58/300 |loss: 0.001558| train set 2.821x speedup, test set 1.384x speedup, val set 0.842x speedup, step: 43
Epoch 59/300 |loss: 0.001207| train set 2.721x speedup, test set 1.384x speedup, val set 0.842x speedup, step: 44
Epoch 60/300 |loss: 0.001342| train set 2.818x speedup, test set 1.376x speedup, val set 0.945x speedup, step: 45
Epoch 61/300 |loss: 0.001298| train set 2.894x speedup, test set 1.384x speedup, val set 0.951x speedup, step: 46
early stopping at epoch 61
Training per epoch cost 2.235 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 2.921, test speedup 1.352, val speedup 0.834
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.236, test speedup 1.487, val speedup 1.267
last model at epoch 61, train speedup 2.894, test speedup 1.384, val speedup 0.951
execution cost 0:03:56.930758
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.770004, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007034| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006542| train set 1.481x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006194| train set 0.962x speedup, test set 1.128x speedup, val set 1.085x speedup, step: 6
Epoch 10/300 |loss: 0.005920| train set 0.972x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005639| train set 1.033x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005503| train set 1.026x speedup, test set 1.121x speedup, val set 1.084x speedup, step: 9
Epoch 13/300 |loss: 0.005149| train set 1.048x speedup, test set 1.352x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005073| train set 1.045x speedup, test set 1.352x speedup, val set 1.041x speedup, step: 11
Epoch 15/300 |loss: 0.005012| train set 1.028x speedup, test set 1.350x speedup, val set 1.076x speedup, step: 12
Epoch 16/300 |loss: 0.004746| train set 1.226x speedup, test set 1.489x speedup, val set 1.266x speedup, step: 1
Epoch 17/300 |loss: 0.004839| train set 1.048x speedup, test set 1.394x speedup, val set 1.077x speedup, step: 2
Epoch 18/300 |loss: 0.004082| train set 1.300x speedup, test set 1.389x speedup, val set 0.991x speedup, step: 3
Epoch 19/300 |loss: 0.004400| train set 1.266x speedup, test set 1.370x speedup, val set 1.032x speedup, step: 4
Epoch 20/300 |loss: 0.003753| train set 1.289x speedup, test set 1.411x speedup, val set 1.118x speedup, step: 5
Epoch 21/300 |loss: 0.003448| train set 1.231x speedup, test set 1.391x speedup, val set 0.973x speedup, step: 6
Epoch 22/300 |loss: 0.003450| train set 2.533x speedup, test set 1.381x speedup, val set 0.834x speedup, step: 7
Epoch 23/300 |loss: 0.003168| train set 2.325x speedup, test set 1.381x speedup, val set 1.001x speedup, step: 8
Epoch 24/300 |loss: 0.004262| train set 2.734x speedup, test set 1.414x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003438| train set 2.685x speedup, test set 1.412x speedup, val set 1.001x speedup, step: 10
Epoch 26/300 |loss: 0.003588| train set 2.253x speedup, test set 1.389x speedup, val set 0.948x speedup, step: 11
Epoch 27/300 |loss: 0.003019| train set 2.742x speedup, test set 1.415x speedup, val set 0.881x speedup, step: 12
Epoch 28/300 |loss: 0.002787| train set 2.670x speedup, test set 1.389x speedup, val set 0.882x speedup, step: 13
Epoch 29/300 |loss: 0.002677| train set 2.615x speedup, test set 1.349x speedup, val set 0.842x speedup, step: 14
Epoch 30/300 |loss: 0.002487| train set 2.389x speedup, test set 1.415x speedup, val set 0.832x speedup, step: 15
Epoch 31/300 |loss: 0.002421| train set 2.623x speedup, test set 1.415x speedup, val set 0.850x speedup, step: 16
Epoch 32/300 |loss: 0.002606| train set 2.718x speedup, test set 1.349x speedup, val set 0.842x speedup, step: 17
Epoch 33/300 |loss: 0.002557| train set 2.800x speedup, test set 1.352x speedup, val set 0.885x speedup, step: 18
Epoch 34/300 |loss: 0.002134| train set 2.847x speedup, test set 1.352x speedup, val set 0.985x speedup, step: 19
Epoch 35/300 |loss: 0.002344| train set 2.655x speedup, test set 1.296x speedup, val set 0.947x speedup, step: 20
Epoch 36/300 |loss: 0.002143| train set 2.526x speedup, test set 1.356x speedup, val set 0.833x speedup, step: 21
Epoch 37/300 |loss: 0.001973| train set 2.871x speedup, test set 1.356x speedup, val set 0.983x speedup, step: 22
Epoch 38/300 |loss: 0.001961| train set 2.864x speedup, test set 1.348x speedup, val set 0.850x speedup, step: 23
Epoch 39/300 |loss: 0.001915| train set 2.815x speedup, test set 1.352x speedup, val set 0.968x speedup, step: 24
Epoch 40/300 |loss: 0.002120| train set 2.834x speedup, test set 1.416x speedup, val set 0.947x speedup, step: 25
Epoch 41/300 |loss: 0.001926| train set 2.836x speedup, test set 1.301x speedup, val set 0.981x speedup, step: 26
Epoch 42/300 |loss: 0.001837| train set 2.785x speedup, test set 1.295x speedup, val set 0.981x speedup, step: 27
Epoch 43/300 |loss: 0.002042| train set 2.893x speedup, test set 1.352x speedup, val set 0.984x speedup, step: 28
Epoch 44/300 |loss: 0.001837| train set 2.776x speedup, test set 1.352x speedup, val set 0.984x speedup, step: 29
Epoch 45/300 |loss: 0.001899| train set 2.774x speedup, test set 1.346x speedup, val set 0.912x speedup, step: 30
Epoch 46/300 |loss: 0.001731| train set 2.854x speedup, test set 1.290x speedup, val set 0.975x speedup, step: 31
Epoch 47/300 |loss: 0.001858| train set 2.904x speedup, test set 1.359x speedup, val set 0.973x speedup, step: 32
Epoch 48/300 |loss: 0.001728| train set 2.806x speedup, test set 1.373x speedup, val set 0.852x speedup, step: 33
Epoch 49/300 |loss: 0.001481| train set 2.861x speedup, test set 1.365x speedup, val set 0.977x speedup, step: 34
Epoch 50/300 |loss: 0.001294| train set 2.852x speedup, test set 1.357x speedup, val set 0.963x speedup, step: 35
Epoch 51/300 |loss: 0.001454| train set 2.866x speedup, test set 1.365x speedup, val set 0.977x speedup, step: 36
Epoch 52/300 |loss: 0.001195| train set 2.818x speedup, test set 1.301x speedup, val set 0.980x speedup, step: 37
Epoch 53/300 |loss: 0.001295| train set 2.554x speedup, test set 1.424x speedup, val set 0.930x speedup, step: 38
Epoch 54/300 |loss: 0.001350| train set 2.533x speedup, test set 1.301x speedup, val set 0.971x speedup, step: 39
Epoch 55/300 |loss: 0.001224| train set 2.303x speedup, test set 1.352x speedup, val set 0.963x speedup, step: 40
Epoch 56/300 |loss: 0.001154| train set 2.777x speedup, test set 1.301x speedup, val set 0.948x speedup, step: 41
Epoch 57/300 |loss: 0.001069| train set 2.843x speedup, test set 1.311x speedup, val set 0.975x speedup, step: 42
Epoch 58/300 |loss: 0.001491| train set 2.761x speedup, test set 1.354x speedup, val set 0.846x speedup, step: 43
Epoch 59/300 |loss: 0.001029| train set 2.753x speedup, test set 1.299x speedup, val set 0.957x speedup, step: 44
Epoch 60/300 |loss: 0.001300| train set 2.882x speedup, test set 1.299x speedup, val set 0.936x speedup, step: 45
Epoch 61/300 |loss: 0.001272| train set 2.812x speedup, test set 1.320x speedup, val set 0.856x speedup, step: 46
early stopping at epoch 61
Training per epoch cost 1.269 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 47, train speedup 2.904, test speedup 1.359, val speedup 0.973
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.226, test speedup 1.489, val speedup 1.266
last model at epoch 61, train speedup 2.812, test speedup 1.320, val speedup 0.856
execution cost 0:01:56.496748
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.677797, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007031| train set 0.971x speedup, test set 1.364x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006536| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006195| train set 0.964x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.006031| train set 0.995x speedup, test set 1.353x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005643| train set 1.024x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005421| train set 1.026x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 9
Epoch 13/300 |loss: 0.005200| train set 1.045x speedup, test set 1.352x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005069| train set 1.125x speedup, test set 1.366x speedup, val set 1.091x speedup, step: 11
Epoch 15/300 |loss: 0.005125| train set 1.020x speedup, test set 1.340x speedup, val set 1.098x speedup, step: 12
Epoch 16/300 |loss: 0.004833| train set 1.255x speedup, test set 1.442x speedup, val set 1.162x speedup, step: 1
Epoch 17/300 |loss: 0.004995| train set 0.988x speedup, test set 1.389x speedup, val set 1.083x speedup, step: 2
Epoch 18/300 |loss: 0.004048| train set 1.298x speedup, test set 1.352x speedup, val set 1.297x speedup, step: 1
Epoch 19/300 |loss: 0.004272| train set 1.277x speedup, test set 1.409x speedup, val set 1.001x speedup, step: 2
Epoch 20/300 |loss: 0.003763| train set 1.289x speedup, test set 1.387x speedup, val set 1.089x speedup, step: 3
Epoch 21/300 |loss: 0.003453| train set 1.179x speedup, test set 1.347x speedup, val set 0.978x speedup, step: 4
Epoch 22/300 |loss: 0.003522| train set 2.643x speedup, test set 1.403x speedup, val set 0.983x speedup, step: 5
Epoch 23/300 |loss: 0.003209| train set 2.308x speedup, test set 1.324x speedup, val set 0.986x speedup, step: 6
Epoch 24/300 |loss: 0.004129| train set 2.635x speedup, test set 1.320x speedup, val set 1.187x speedup, step: 7
Epoch 25/300 |loss: 0.003479| train set 2.391x speedup, test set 1.324x speedup, val set 0.989x speedup, step: 8
Epoch 26/300 |loss: 0.003464| train set 2.258x speedup, test set 1.300x speedup, val set 1.039x speedup, step: 9
Epoch 27/300 |loss: 0.003037| train set 2.752x speedup, test set 1.126x speedup, val set 0.836x speedup, step: 10
Epoch 28/300 |loss: 0.002751| train set 2.618x speedup, test set 1.356x speedup, val set 0.832x speedup, step: 11
Epoch 29/300 |loss: 0.002672| train set 2.667x speedup, test set 1.363x speedup, val set 0.832x speedup, step: 12
Epoch 30/300 |loss: 0.002492| train set 2.602x speedup, test set 1.415x speedup, val set 0.832x speedup, step: 13
Epoch 31/300 |loss: 0.002546| train set 2.507x speedup, test set 1.415x speedup, val set 0.875x speedup, step: 14
Epoch 32/300 |loss: 0.002721| train set 2.586x speedup, test set 1.398x speedup, val set 0.832x speedup, step: 15
Epoch 33/300 |loss: 0.002592| train set 2.729x speedup, test set 1.389x speedup, val set 0.842x speedup, step: 16
Epoch 34/300 |loss: 0.002223| train set 2.812x speedup, test set 1.398x speedup, val set 0.831x speedup, step: 17
Epoch 35/300 |loss: 0.002248| train set 2.729x speedup, test set 1.406x speedup, val set 0.934x speedup, step: 18
Epoch 36/300 |loss: 0.002240| train set 2.555x speedup, test set 1.348x speedup, val set 0.839x speedup, step: 19
Epoch 37/300 |loss: 0.002043| train set 2.852x speedup, test set 1.348x speedup, val set 0.882x speedup, step: 20
Epoch 38/300 |loss: 0.002008| train set 2.848x speedup, test set 1.398x speedup, val set 0.843x speedup, step: 21
Epoch 39/300 |loss: 0.001916| train set 2.846x speedup, test set 1.462x speedup, val set 0.885x speedup, step: 22
Epoch 40/300 |loss: 0.002149| train set 2.793x speedup, test set 1.462x speedup, val set 0.945x speedup, step: 23
Epoch 41/300 |loss: 0.001926| train set 2.771x speedup, test set 1.462x speedup, val set 0.837x speedup, step: 24
Epoch 42/300 |loss: 0.001867| train set 2.824x speedup, test set 1.387x speedup, val set 0.881x speedup, step: 25
Epoch 43/300 |loss: 0.002343| train set 2.910x speedup, test set 1.470x speedup, val set 1.070x speedup, step: 26
Epoch 44/300 |loss: 0.001897| train set 2.762x speedup, test set 1.462x speedup, val set 0.938x speedup, step: 27
Epoch 45/300 |loss: 0.001872| train set 2.851x speedup, test set 1.499x speedup, val set 0.933x speedup, step: 28
Epoch 46/300 |loss: 0.001584| train set 2.880x speedup, test set 1.462x speedup, val set 0.951x speedup, step: 29
Epoch 47/300 |loss: 0.001598| train set 2.816x speedup, test set 1.462x speedup, val set 0.947x speedup, step: 30
Epoch 48/300 |loss: 0.001566| train set 2.747x speedup, test set 1.462x speedup, val set 0.947x speedup, step: 31
Epoch 49/300 |loss: 0.001465| train set 2.892x speedup, test set 1.470x speedup, val set 1.071x speedup, step: 32
Epoch 50/300 |loss: 0.001309| train set 2.820x speedup, test set 1.317x speedup, val set 0.942x speedup, step: 33
Epoch 51/300 |loss: 0.001341| train set 2.851x speedup, test set 1.468x speedup, val set 0.951x speedup, step: 34
Epoch 52/300 |loss: 0.001213| train set 2.920x speedup, test set 1.470x speedup, val set 0.951x speedup, step: 35
Epoch 53/300 |loss: 0.001279| train set 2.790x speedup, test set 1.470x speedup, val set 0.941x speedup, step: 36
Epoch 54/300 |loss: 0.001311| train set 2.765x speedup, test set 1.470x speedup, val set 0.936x speedup, step: 37
Epoch 55/300 |loss: 0.001237| train set 2.332x speedup, test set 1.149x speedup, val set 0.927x speedup, step: 38
Epoch 56/300 |loss: 0.001345| train set 2.878x speedup, test set 1.470x speedup, val set 0.948x speedup, step: 39
Epoch 57/300 |loss: 0.001288| train set 2.841x speedup, test set 1.468x speedup, val set 1.070x speedup, step: 40
Epoch 58/300 |loss: 0.001426| train set 2.801x speedup, test set 1.468x speedup, val set 0.905x speedup, step: 41
Epoch 59/300 |loss: 0.001108| train set 2.868x speedup, test set 1.468x speedup, val set 1.052x speedup, step: 42
Epoch 60/300 |loss: 0.001226| train set 2.806x speedup, test set 1.395x speedup, val set 0.906x speedup, step: 43
Epoch 61/300 |loss: 0.001322| train set 2.782x speedup, test set 1.468x speedup, val set 0.905x speedup, step: 44
early stopping at epoch 61
Training per epoch cost 1.257 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 100.428s, pg runtime 87.340s, speedup 0.870x
12, opt runtime 26.602s, model runtime 100.512s, pg runtime 85.447s, speedup 0.850x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 6.234s, model runtime 10.545s, pg runtime 32.540s, speedup 3.086x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
34, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 52, train speedup 2.920, test speedup 1.470, val speedup 0.951
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 18, train speedup 1.298, test speedup 1.352, val speedup 1.297
last model at epoch 61, train speedup 2.782, test speedup 1.468, val speedup 0.905
execution cost 0:01:56.994580
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.730420, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007034| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006542| train set 1.481x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006194| train set 0.962x speedup, test set 1.128x speedup, val set 1.085x speedup, step: 6
Epoch 10/300 |loss: 0.005920| train set 0.972x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005627| train set 1.036x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005527| train set 1.026x speedup, test set 1.121x speedup, val set 1.084x speedup, step: 9
Epoch 13/300 |loss: 0.005102| train set 1.060x speedup, test set 1.326x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.004998| train set 1.123x speedup, test set 1.365x speedup, val set 1.070x speedup, step: 11
Epoch 15/300 |loss: 0.005198| train set 1.028x speedup, test set 1.350x speedup, val set 1.099x speedup, step: 12
Epoch 16/300 |loss: 0.004873| train set 1.225x speedup, test set 1.489x speedup, val set 1.168x speedup, step: 1
Epoch 17/300 |loss: 0.005096| train set 1.001x speedup, test set 1.394x speedup, val set 1.001x speedup, step: 2
Epoch 18/300 |loss: 0.004143| train set 1.308x speedup, test set 1.422x speedup, val set 1.103x speedup, step: 3
Epoch 19/300 |loss: 0.004266| train set 1.276x speedup, test set 1.354x speedup, val set 1.032x speedup, step: 4
Epoch 20/300 |loss: 0.003835| train set 1.288x speedup, test set 1.354x speedup, val set 0.989x speedup, step: 5
Epoch 21/300 |loss: 0.003483| train set 1.256x speedup, test set 1.342x speedup, val set 0.988x speedup, step: 6
Epoch 22/300 |loss: 0.003539| train set 2.456x speedup, test set 1.374x speedup, val set 1.001x speedup, step: 7
Epoch 23/300 |loss: 0.003221| train set 2.321x speedup, test set 1.374x speedup, val set 1.001x speedup, step: 8
Epoch 24/300 |loss: 0.004361| train set 2.681x speedup, test set 1.342x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003506| train set 2.387x speedup, test set 1.381x speedup, val set 0.945x speedup, step: 10
Epoch 26/300 |loss: 0.003347| train set 2.513x speedup, test set 1.381x speedup, val set 0.997x speedup, step: 11
Epoch 27/300 |loss: 0.002935| train set 2.717x speedup, test set 1.356x speedup, val set 0.836x speedup, step: 12
Epoch 28/300 |loss: 0.002800| train set 2.473x speedup, test set 1.352x speedup, val set 0.867x speedup, step: 13
Epoch 29/300 |loss: 0.002645| train set 2.715x speedup, test set 1.356x speedup, val set 0.931x speedup, step: 14
Epoch 30/300 |loss: 0.002535| train set 2.411x speedup, test set 1.389x speedup, val set 0.838x speedup, step: 15
Epoch 31/300 |loss: 0.002460| train set 2.803x speedup, test set 1.415x speedup, val set 0.842x speedup, step: 16
Epoch 32/300 |loss: 0.002620| train set 2.347x speedup, test set 1.342x speedup, val set 0.822x speedup, step: 17
Epoch 33/300 |loss: 0.002641| train set 2.746x speedup, test set 1.342x speedup, val set 0.985x speedup, step: 18
Epoch 34/300 |loss: 0.002154| train set 2.857x speedup, test set 1.348x speedup, val set 0.842x speedup, step: 19
Epoch 35/300 |loss: 0.002189| train set 2.828x speedup, test set 1.296x speedup, val set 0.932x speedup, step: 20
Epoch 36/300 |loss: 0.002189| train set 2.443x speedup, test set 1.381x speedup, val set 0.838x speedup, step: 21
Epoch 37/300 |loss: 0.002039| train set 2.809x speedup, test set 1.343x speedup, val set 0.822x speedup, step: 22
Epoch 38/300 |loss: 0.002039| train set 2.891x speedup, test set 1.375x speedup, val set 0.841x speedup, step: 23
Epoch 39/300 |loss: 0.001909| train set 2.498x speedup, test set 1.356x speedup, val set 0.842x speedup, step: 24
Epoch 40/300 |loss: 0.002166| train set 2.807x speedup, test set 1.411x speedup, val set 0.836x speedup, step: 25
Epoch 41/300 |loss: 0.001871| train set 2.850x speedup, test set 1.356x speedup, val set 0.905x speedup, step: 26
Epoch 42/300 |loss: 0.001880| train set 2.653x speedup, test set 1.350x speedup, val set 0.839x speedup, step: 27
Epoch 43/300 |loss: 0.002534| train set 2.772x speedup, test set 1.350x speedup, val set 0.842x speedup, step: 28
Epoch 44/300 |loss: 0.002075| train set 2.852x speedup, test set 1.350x speedup, val set 0.932x speedup, step: 29
Epoch 45/300 |loss: 0.001659| train set 2.863x speedup, test set 1.350x speedup, val set 0.933x speedup, step: 30
Epoch 46/300 |loss: 0.001627| train set 2.804x speedup, test set 1.356x speedup, val set 0.931x speedup, step: 31
Epoch 47/300 |loss: 0.001568| train set 2.867x speedup, test set 1.350x speedup, val set 0.837x speedup, step: 32
Epoch 48/300 |loss: 0.001564| train set 2.799x speedup, test set 1.371x speedup, val set 0.837x speedup, step: 33
Epoch 49/300 |loss: 0.001584| train set 2.856x speedup, test set 1.170x speedup, val set 0.837x speedup, step: 34
Epoch 50/300 |loss: 0.001397| train set 2.493x speedup, test set 1.469x speedup, val set 0.832x speedup, step: 35
Epoch 51/300 |loss: 0.001473| train set 2.908x speedup, test set 1.433x speedup, val set 0.833x speedup, step: 36
Epoch 52/300 |loss: 0.001247| train set 2.745x speedup, test set 1.402x speedup, val set 0.832x speedup, step: 37
Epoch 53/300 |loss: 0.001479| train set 2.664x speedup, test set 1.179x speedup, val set 0.833x speedup, step: 38
Epoch 54/300 |loss: 0.001380| train set 2.513x speedup, test set 1.433x speedup, val set 0.834x speedup, step: 39
Epoch 55/300 |loss: 0.001243| train set 2.678x speedup, test set 1.370x speedup, val set 0.832x speedup, step: 40
Epoch 56/300 |loss: 0.001191| train set 2.836x speedup, test set 1.441x speedup, val set 0.827x speedup, step: 41
Epoch 57/300 |loss: 0.001080| train set 2.859x speedup, test set 1.433x speedup, val set 0.829x speedup, step: 42
Epoch 58/300 |loss: 0.001518| train set 2.698x speedup, test set 1.433x speedup, val set 0.830x speedup, step: 43
Epoch 59/300 |loss: 0.001388| train set 2.861x speedup, test set 1.370x speedup, val set 0.826x speedup, step: 44
Epoch 60/300 |loss: 0.001210| train set 2.884x speedup, test set 1.370x speedup, val set 0.837x speedup, step: 45
Epoch 61/300 |loss: 0.001077| train set 2.878x speedup, test set 1.173x speedup, val set 0.829x speedup, step: 46
Epoch 62/300 |loss: 0.001118| train set 2.818x speedup, test set 1.379x speedup, val set 0.841x speedup, step: 47
Epoch 63/300 |loss: 0.000876| train set 2.786x speedup, test set 1.370x speedup, val set 0.839x speedup, step: 48
Epoch 64/300 |loss: 0.001033| train set 2.725x speedup, test set 1.455x speedup, val set 0.837x speedup, step: 49
Epoch 65/300 |loss: 0.001543| train set 2.493x speedup, test set 1.133x speedup, val set 0.828x speedup, step: 50
Epoch 66/300 |loss: 0.001438| train set 2.844x speedup, test set 1.347x speedup, val set 0.832x speedup, step: 51
early stopping at epoch 66
Training per epoch cost 1.269 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 51, train speedup 2.908, test speedup 1.433, val speedup 0.833
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.225, test speedup 1.489, val speedup 1.168
last model at epoch 66, train speedup 2.844, test speedup 1.347, val speedup 0.832
execution cost 0:02:05.965208
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.882916, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008262| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007590| train set 1.498x speedup, test set 1.372x speedup, val set 1.107x speedup, step: 3
Epoch 7/300 |loss: 0.007039| train set 0.951x speedup, test set 1.369x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006557| train set 1.521x speedup, test set 1.372x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006182| train set 0.980x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.006025| train set 0.996x speedup, test set 1.126x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005860| train set 1.023x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005301| train set 1.037x speedup, test set 1.125x speedup, val set 1.085x speedup, step: 9
Epoch 13/300 |loss: 0.005198| train set 1.061x speedup, test set 1.348x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005044| train set 1.135x speedup, test set 1.365x speedup, val set 1.068x speedup, step: 11
Epoch 15/300 |loss: 0.005205| train set 1.019x speedup, test set 1.348x speedup, val set 1.070x speedup, step: 12
Epoch 16/300 |loss: 0.004968| train set 1.256x speedup, test set 1.456x speedup, val set 1.119x speedup, step: 13
Epoch 17/300 |loss: 0.005072| train set 1.059x speedup, test set 1.346x speedup, val set 0.994x speedup, step: 14
Epoch 18/300 |loss: 0.004125| train set 1.284x speedup, test set 1.352x speedup, val set 1.115x speedup, step: 15
Epoch 19/300 |loss: 0.004348| train set 1.272x speedup, test set 1.349x speedup, val set 0.989x speedup, step: 16
Epoch 20/300 |loss: 0.003856| train set 2.355x speedup, test set 1.378x speedup, val set 0.979x speedup, step: 17
Epoch 21/300 |loss: 0.003504| train set 1.278x speedup, test set 1.388x speedup, val set 0.978x speedup, step: 18
Epoch 22/300 |loss: 0.003519| train set 2.660x speedup, test set 1.388x speedup, val set 1.133x speedup, step: 1
Epoch 23/300 |loss: 0.003224| train set 2.329x speedup, test set 1.388x speedup, val set 1.001x speedup, step: 2
Epoch 24/300 |loss: 0.003848| train set 2.675x speedup, test set 1.359x speedup, val set 1.133x speedup, step: 1
Epoch 25/300 |loss: 0.003456| train set 2.434x speedup, test set 1.389x speedup, val set 1.133x speedup, step: 2
Epoch 26/300 |loss: 0.003410| train set 2.546x speedup, test set 1.328x speedup, val set 1.000x speedup, step: 3
Epoch 27/300 |loss: 0.002908| train set 2.773x speedup, test set 1.356x speedup, val set 1.000x speedup, step: 4
Epoch 28/300 |loss: 0.002702| train set 2.633x speedup, test set 1.356x speedup, val set 0.938x speedup, step: 5
Epoch 29/300 |loss: 0.002580| train set 2.611x speedup, test set 1.356x speedup, val set 1.036x speedup, step: 6
Epoch 30/300 |loss: 0.002447| train set 2.412x speedup, test set 1.356x speedup, val set 0.822x speedup, step: 7
Epoch 31/300 |loss: 0.002393| train set 2.771x speedup, test set 1.380x speedup, val set 0.938x speedup, step: 8
Epoch 32/300 |loss: 0.002553| train set 2.511x speedup, test set 1.300x speedup, val set 0.931x speedup, step: 9
Epoch 33/300 |loss: 0.002528| train set 2.760x speedup, test set 1.356x speedup, val set 1.052x speedup, step: 10
Epoch 34/300 |loss: 0.002139| train set 2.865x speedup, test set 1.357x speedup, val set 1.052x speedup, step: 11
Epoch 35/300 |loss: 0.002196| train set 2.794x speedup, test set 1.302x speedup, val set 0.999x speedup, step: 12
Epoch 36/300 |loss: 0.002077| train set 2.491x speedup, test set 1.357x speedup, val set 0.938x speedup, step: 13
Epoch 37/300 |loss: 0.002060| train set 2.694x speedup, test set 1.356x speedup, val set 0.934x speedup, step: 14
Epoch 38/300 |loss: 0.001981| train set 2.902x speedup, test set 1.357x speedup, val set 0.933x speedup, step: 15
Epoch 39/300 |loss: 0.001854| train set 2.841x speedup, test set 1.357x speedup, val set 1.052x speedup, step: 16
Epoch 40/300 |loss: 0.002147| train set 2.832x speedup, test set 1.426x speedup, val set 0.934x speedup, step: 17
Epoch 41/300 |loss: 0.001848| train set 2.800x speedup, test set 1.356x speedup, val set 1.052x speedup, step: 18
Epoch 42/300 |loss: 0.001795| train set 2.742x speedup, test set 1.348x speedup, val set 0.927x speedup, step: 19
Epoch 43/300 |loss: 0.001887| train set 2.819x speedup, test set 1.356x speedup, val set 1.000x speedup, step: 20
Epoch 44/300 |loss: 0.001685| train set 2.771x speedup, test set 1.348x speedup, val set 1.052x speedup, step: 21
Epoch 45/300 |loss: 0.001808| train set 2.827x speedup, test set 1.369x speedup, val set 0.934x speedup, step: 22
Epoch 46/300 |loss: 0.002005| train set 2.758x speedup, test set 1.369x speedup, val set 1.044x speedup, step: 23
Epoch 47/300 |loss: 0.001871| train set 2.829x speedup, test set 1.369x speedup, val set 1.048x speedup, step: 24
Epoch 48/300 |loss: 0.001711| train set 2.778x speedup, test set 1.453x speedup, val set 0.934x speedup, step: 25
Epoch 49/300 |loss: 0.001465| train set 2.893x speedup, test set 1.415x speedup, val set 1.052x speedup, step: 26
Epoch 50/300 |loss: 0.001404| train set 2.408x speedup, test set 1.453x speedup, val set 0.938x speedup, step: 27
Epoch 51/300 |loss: 0.001452| train set 2.896x speedup, test set 1.381x speedup, val set 1.048x speedup, step: 28
Epoch 52/300 |loss: 0.001181| train set 2.900x speedup, test set 1.369x speedup, val set 1.048x speedup, step: 29
Epoch 53/300 |loss: 0.001283| train set 2.715x speedup, test set 1.358x speedup, val set 0.934x speedup, step: 30
Epoch 54/300 |loss: 0.001397| train set 2.811x speedup, test set 1.348x speedup, val set 0.934x speedup, step: 31
Epoch 55/300 |loss: 0.001266| train set 2.875x speedup, test set 1.347x speedup, val set 0.934x speedup, step: 32
Epoch 56/300 |loss: 0.001154| train set 2.850x speedup, test set 1.388x speedup, val set 1.048x speedup, step: 33
Epoch 57/300 |loss: 0.001109| train set 2.966x speedup, test set 1.348x speedup, val set 1.052x speedup, step: 34
Epoch 58/300 |loss: 0.001501| train set 2.772x speedup, test set 1.367x speedup, val set 1.052x speedup, step: 35
Epoch 59/300 |loss: 0.001105| train set 2.828x speedup, test set 1.380x speedup, val set 0.934x speedup, step: 36
Epoch 60/300 |loss: 0.001236| train set 2.802x speedup, test set 1.335x speedup, val set 1.009x speedup, step: 37
Epoch 61/300 |loss: 0.001334| train set 2.909x speedup, test set 1.380x speedup, val set 1.052x speedup, step: 38
early stopping at epoch 61
Training per epoch cost 1.272 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
07, opt runtime 6.284s, model runtime 13.017s, pg runtime 31.019s, speedup 2.383x
08, opt runtime 7.377s, model runtime 17.141s, pg runtime 28.655s, speedup 1.672x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 100.428s, pg runtime 87.340s, speedup 0.870x
12, opt runtime 26.602s, model runtime 100.512s, pg runtime 85.447s, speedup 0.850x
13, opt runtime 3.332s, model runtime 27.373s, pg runtime 21.298s, speedup 0.778x
14, opt runtime 3.258s, model runtime 24.602s, pg runtime 18.141s, speedup 0.737x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.398s, pg runtime 1.438s, speedup 1.028x
20, opt runtime 1.428s, model runtime 1.645s, pg runtime 1.428s, speedup 0.868x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
34, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 57, train speedup 2.966, test speedup 1.348, val speedup 1.052
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 24, train speedup 2.675, test speedup 1.359, val speedup 1.133
last model at epoch 61, train speedup 2.909, test speedup 1.380, val speedup 1.052
execution cost 0:01:58.202983
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.712669, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007034| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006542| train set 1.481x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006198| train set 0.962x speedup, test set 1.128x speedup, val set 1.085x speedup, step: 6
Epoch 10/300 |loss: 0.005974| train set 0.973x speedup, test set 1.358x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005648| train set 1.036x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005486| train set 1.025x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 9
Epoch 13/300 |loss: 0.005171| train set 1.004x speedup, test set 1.352x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005054| train set 1.138x speedup, test set 1.365x speedup, val set 1.092x speedup, step: 11
Epoch 15/300 |loss: 0.005054| train set 1.019x speedup, test set 1.350x speedup, val set 1.098x speedup, step: 12
Epoch 16/300 |loss: 0.004866| train set 1.237x speedup, test set 1.489x speedup, val set 1.287x speedup, step: 1
Epoch 17/300 |loss: 0.005157| train set 1.047x speedup, test set 1.319x speedup, val set 0.994x speedup, step: 2
Epoch 18/300 |loss: 0.004155| train set 1.283x speedup, test set 1.412x speedup, val set 1.043x speedup, step: 3
Epoch 19/300 |loss: 0.004191| train set 1.265x speedup, test set 1.430x speedup, val set 1.020x speedup, step: 4
Epoch 20/300 |loss: 0.003861| train set 1.291x speedup, test set 1.382x speedup, val set 1.001x speedup, step: 5
Epoch 21/300 |loss: 0.003478| train set 1.255x speedup, test set 1.381x speedup, val set 0.971x speedup, step: 6
Epoch 22/300 |loss: 0.003529| train set 2.650x speedup, test set 1.381x speedup, val set 0.950x speedup, step: 7
Epoch 23/300 |loss: 0.003219| train set 2.315x speedup, test set 1.381x speedup, val set 1.001x speedup, step: 8
Epoch 24/300 |loss: 0.004091| train set 2.677x speedup, test set 1.434x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003432| train set 2.514x speedup, test set 1.382x speedup, val set 1.001x speedup, step: 10
Epoch 26/300 |loss: 0.003538| train set 2.231x speedup, test set 1.389x speedup, val set 1.000x speedup, step: 11
Epoch 27/300 |loss: 0.002972| train set 2.388x speedup, test set 1.389x speedup, val set 0.933x speedup, step: 12
Epoch 28/300 |loss: 0.002786| train set 2.742x speedup, test set 1.389x speedup, val set 0.938x speedup, step: 13
Epoch 29/300 |loss: 0.002608| train set 2.690x speedup, test set 1.389x speedup, val set 1.052x speedup, step: 14
Epoch 30/300 |loss: 0.002542| train set 2.328x speedup, test set 1.389x speedup, val set 0.913x speedup, step: 15
Epoch 31/300 |loss: 0.002399| train set 2.731x speedup, test set 1.415x speedup, val set 0.938x speedup, step: 16
Epoch 32/300 |loss: 0.002618| train set 2.355x speedup, test set 1.425x speedup, val set 0.913x speedup, step: 17
Epoch 33/300 |loss: 0.002604| train set 2.761x speedup, test set 1.352x speedup, val set 0.842x speedup, step: 18
Epoch 34/300 |loss: 0.002233| train set 2.808x speedup, test set 1.356x speedup, val set 0.938x speedup, step: 19
Epoch 35/300 |loss: 0.002407| train set 2.369x speedup, test set 1.149x speedup, val set 0.932x speedup, step: 20
Epoch 36/300 |loss: 0.002168| train set 2.497x speedup, test set 1.385x speedup, val set 0.842x speedup, step: 21
Epoch 37/300 |loss: 0.002062| train set 2.865x speedup, test set 1.356x speedup, val set 0.984x speedup, step: 22
Epoch 38/300 |loss: 0.002075| train set 2.847x speedup, test set 1.457x speedup, val set 0.984x speedup, step: 23
Epoch 39/300 |loss: 0.001911| train set 2.853x speedup, test set 1.389x speedup, val set 0.938x speedup, step: 24
Epoch 40/300 |loss: 0.002154| train set 2.864x speedup, test set 1.126x speedup, val set 0.970x speedup, step: 25
Epoch 41/300 |loss: 0.001899| train set 2.902x speedup, test set 1.126x speedup, val set 0.938x speedup, step: 26
Epoch 42/300 |loss: 0.001868| train set 2.823x speedup, test set 1.174x speedup, val set 0.838x speedup, step: 27
Epoch 43/300 |loss: 0.001946| train set 2.472x speedup, test set 1.126x speedup, val set 0.938x speedup, step: 28
Epoch 44/300 |loss: 0.001680| train set 2.718x speedup, test set 1.352x speedup, val set 0.938x speedup, step: 29
Epoch 45/300 |loss: 0.001718| train set 2.807x speedup, test set 1.174x speedup, val set 0.938x speedup, step: 30
Epoch 46/300 |loss: 0.001665| train set 2.835x speedup, test set 1.126x speedup, val set 0.842x speedup, step: 31
Epoch 47/300 |loss: 0.001611| train set 2.853x speedup, test set 1.194x speedup, val set 0.938x speedup, step: 32
Epoch 48/300 |loss: 0.001640| train set 2.803x speedup, test set 1.174x speedup, val set 0.827x speedup, step: 33
Epoch 49/300 |loss: 0.001449| train set 2.865x speedup, test set 1.126x speedup, val set 0.842x speedup, step: 34
Epoch 50/300 |loss: 0.001347| train set 2.829x speedup, test set 1.171x speedup, val set 0.839x speedup, step: 35
Epoch 51/300 |loss: 0.001414| train set 2.899x speedup, test set 1.166x speedup, val set 0.938x speedup, step: 36
Epoch 52/300 |loss: 0.001221| train set 2.812x speedup, test set 1.170x speedup, val set 0.934x speedup, step: 37
Epoch 53/300 |loss: 0.001344| train set 2.707x speedup, test set 1.169x speedup, val set 0.842x speedup, step: 38
Epoch 54/300 |loss: 0.001271| train set 2.771x speedup, test set 1.172x speedup, val set 0.821x speedup, step: 39
Epoch 55/300 |loss: 0.001388| train set 2.587x speedup, test set 1.174x speedup, val set 0.918x speedup, step: 40
Epoch 56/300 |loss: 0.001362| train set 2.793x speedup, test set 1.177x speedup, val set 0.915x speedup, step: 41
Epoch 57/300 |loss: 0.001159| train set 2.769x speedup, test set 1.172x speedup, val set 0.841x speedup, step: 42
Epoch 58/300 |loss: 0.001428| train set 2.779x speedup, test set 1.478x speedup, val set 0.928x speedup, step: 43
Epoch 59/300 |loss: 0.001049| train set 2.809x speedup, test set 1.224x speedup, val set 0.937x speedup, step: 44
Epoch 60/300 |loss: 0.001127| train set 2.842x speedup, test set 1.163x speedup, val set 0.847x speedup, step: 45
Epoch 61/300 |loss: 0.001032| train set 2.901x speedup, test set 1.417x speedup, val set 0.968x speedup, step: 46
Epoch 62/300 |loss: 0.000999| train set 2.741x speedup, test set 1.181x speedup, val set 0.968x speedup, step: 47
Epoch 63/300 |loss: 0.000934| train set 2.826x speedup, test set 1.126x speedup, val set 0.926x speedup, step: 48
Epoch 64/300 |loss: 0.001064| train set 2.583x speedup, test set 1.120x speedup, val set 0.926x speedup, step: 49
Epoch 65/300 |loss: 0.001247| train set 2.758x speedup, test set 1.164x speedup, val set 0.955x speedup, step: 50
Epoch 66/300 |loss: 0.001038| train set 2.843x speedup, test set 0.954x speedup, val set 0.844x speedup, step: 51
Epoch 67/300 |loss: 0.001020| train set 2.848x speedup, test set 1.360x speedup, val set 0.952x speedup, step: 52
Epoch 68/300 |loss: 0.000917| train set 2.871x speedup, test set 1.159x speedup, val set 0.844x speedup, step: 53
Epoch 69/300 |loss: 0.000851| train set 2.712x speedup, test set 1.337x speedup, val set 0.932x speedup, step: 54
Epoch 70/300 |loss: 0.000879| train set 2.941x speedup, test set 0.951x speedup, val set 0.847x speedup, step: 55
Epoch 71/300 |loss: 0.000932| train set 2.880x speedup, test set 1.148x speedup, val set 0.937x speedup, step: 56
Epoch 72/300 |loss: 0.000751| train set 2.905x speedup, test set 0.946x speedup, val set 0.838x speedup, step: 57
Epoch 73/300 |loss: 0.000636| train set 2.783x speedup, test set 1.152x speedup, val set 0.847x speedup, step: 58
Epoch 74/300 |loss: 0.000599| train set 2.764x speedup, test set 1.152x speedup, val set 0.838x speedup, step: 59
Epoch 75/300 |loss: 0.000536| train set 2.898x speedup, test set 1.115x speedup, val set 0.844x speedup, step: 60
Epoch 76/300 |loss: 0.000561| train set 2.806x speedup, test set 1.151x speedup, val set 0.844x speedup, step: 61
Epoch 77/300 |loss: 0.000570| train set 2.895x speedup, test set 1.115x speedup, val set 0.843x speedup, step: 62
Epoch 78/300 |loss: 0.000556| train set 2.867x speedup, test set 1.108x speedup, val set 0.844x speedup, step: 63
Epoch 79/300 |loss: 0.000587| train set 2.864x speedup, test set 1.108x speedup, val set 0.847x speedup, step: 64
Epoch 80/300 |loss: 0.000593| train set 2.951x speedup, test set 1.109x speedup, val set 0.844x speedup, step: 65
Epoch 81/300 |loss: 0.000581| train set 2.948x speedup, test set 1.161x speedup, val set 0.847x speedup, step: 66
Epoch 82/300 |loss: 0.000944| train set 2.758x speedup, test set 0.922x speedup, val set 0.849x speedup, step: 67
Epoch 83/300 |loss: 0.000828| train set 2.894x speedup, test set 1.122x speedup, val set 0.844x speedup, step: 68
early stopping at epoch 83
Training per epoch cost 1.255 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 80, train speedup 2.951, test speedup 1.109, val speedup 0.844
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.237, test speedup 1.489, val speedup 1.287
last model at epoch 83, train speedup 2.894, test speedup 1.122, val speedup 0.844
execution cost 0:02:33.394921
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.668627, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007031| train set 0.971x speedup, test set 1.364x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006536| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006195| train set 0.964x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005986| train set 0.996x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005703| train set 1.034x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005395| train set 1.035x speedup, test set 1.125x speedup, val set 1.100x speedup, step: 9
Epoch 13/300 |loss: 0.005261| train set 1.088x speedup, test set 1.353x speedup, val set 1.044x speedup, step: 10
Epoch 14/300 |loss: 0.005052| train set 1.140x speedup, test set 1.366x speedup, val set 1.234x speedup, step: 1
Epoch 15/300 |loss: 0.005094| train set 0.974x speedup, test set 1.350x speedup, val set 0.978x speedup, step: 2
Epoch 16/300 |loss: 0.004959| train set 1.253x speedup, test set 1.489x speedup, val set 1.178x speedup, step: 3
Epoch 17/300 |loss: 0.005080| train set 0.996x speedup, test set 1.356x speedup, val set 0.982x speedup, step: 4
Epoch 18/300 |loss: 0.004145| train set 1.293x speedup, test set 1.386x speedup, val set 1.118x speedup, step: 5
Epoch 19/300 |loss: 0.004223| train set 1.247x speedup, test set 1.409x speedup, val set 0.966x speedup, step: 6
Epoch 20/300 |loss: 0.003775| train set 2.559x speedup, test set 1.385x speedup, val set 1.088x speedup, step: 7
Epoch 21/300 |loss: 0.003453| train set 1.306x speedup, test set 1.390x speedup, val set 1.118x speedup, step: 8
Epoch 22/300 |loss: 0.003430| train set 2.733x speedup, test set 1.394x speedup, val set 1.133x speedup, step: 9
Epoch 23/300 |loss: 0.003092| train set 2.331x speedup, test set 1.409x speedup, val set 1.001x speedup, step: 10
Epoch 24/300 |loss: 0.004095| train set 2.756x speedup, test set 1.390x speedup, val set 1.297x speedup, step: 1
Epoch 25/300 |loss: 0.003276| train set 2.370x speedup, test set 1.412x speedup, val set 1.001x speedup, step: 2
Epoch 26/300 |loss: 0.003300| train set 2.123x speedup, test set 1.087x speedup, val set 0.999x speedup, step: 3
Epoch 27/300 |loss: 0.002864| train set 2.798x speedup, test set 1.356x speedup, val set 0.933x speedup, step: 4
Epoch 28/300 |loss: 0.002713| train set 2.704x speedup, test set 1.356x speedup, val set 0.917x speedup, step: 5
Epoch 29/300 |loss: 0.002641| train set 2.702x speedup, test set 1.356x speedup, val set 1.019x speedup, step: 6
Epoch 30/300 |loss: 0.002404| train set 2.499x speedup, test set 1.356x speedup, val set 0.933x speedup, step: 7
Epoch 31/300 |loss: 0.002302| train set 2.698x speedup, test set 1.380x speedup, val set 1.070x speedup, step: 8
Epoch 32/300 |loss: 0.002407| train set 2.524x speedup, test set 1.301x speedup, val set 1.021x speedup, step: 9
Epoch 33/300 |loss: 0.002657| train set 2.790x speedup, test set 1.301x speedup, val set 0.917x speedup, step: 10
Epoch 34/300 |loss: 0.002189| train set 2.899x speedup, test set 1.301x speedup, val set 1.027x speedup, step: 11
Epoch 35/300 |loss: 0.002262| train set 2.714x speedup, test set 1.358x speedup, val set 0.934x speedup, step: 12
Epoch 36/300 |loss: 0.002090| train set 2.553x speedup, test set 1.301x speedup, val set 0.914x speedup, step: 13
Epoch 37/300 |loss: 0.001905| train set 2.811x speedup, test set 1.295x speedup, val set 0.914x speedup, step: 14
Epoch 38/300 |loss: 0.002129| train set 2.775x speedup, test set 1.295x speedup, val set 0.913x speedup, step: 15
Epoch 39/300 |loss: 0.002240| train set 2.750x speedup, test set 1.349x speedup, val set 0.907x speedup, step: 16
Epoch 40/300 |loss: 0.002175| train set 2.806x speedup, test set 1.349x speedup, val set 0.897x speedup, step: 17
Epoch 41/300 |loss: 0.001867| train set 2.804x speedup, test set 1.349x speedup, val set 1.025x speedup, step: 18
Epoch 42/300 |loss: 0.001712| train set 2.811x speedup, test set 1.349x speedup, val set 0.914x speedup, step: 19
Epoch 43/300 |loss: 0.001821| train set 2.550x speedup, test set 1.301x speedup, val set 0.909x speedup, step: 20
Epoch 44/300 |loss: 0.001899| train set 2.900x speedup, test set 1.361x speedup, val set 0.917x speedup, step: 21
Epoch 45/300 |loss: 0.001675| train set 2.803x speedup, test set 1.342x speedup, val set 0.934x speedup, step: 22
Epoch 46/300 |loss: 0.001549| train set 2.788x speedup, test set 1.348x speedup, val set 0.905x speedup, step: 23
Epoch 47/300 |loss: 0.001624| train set 2.664x speedup, test set 1.409x speedup, val set 0.907x speedup, step: 24
Epoch 48/300 |loss: 0.001639| train set 2.880x speedup, test set 1.341x speedup, val set 1.048x speedup, step: 25
Epoch 49/300 |loss: 0.001594| train set 2.796x speedup, test set 1.342x speedup, val set 0.928x speedup, step: 26
Epoch 50/300 |loss: 0.001278| train set 2.792x speedup, test set 1.409x speedup, val set 0.925x speedup, step: 27
Epoch 51/300 |loss: 0.001362| train set 2.927x speedup, test set 1.341x speedup, val set 0.928x speedup, step: 28
Epoch 52/300 |loss: 0.001175| train set 2.850x speedup, test set 1.341x speedup, val set 0.934x speedup, step: 29
Epoch 53/300 |loss: 0.001378| train set 2.770x speedup, test set 1.417x speedup, val set 0.834x speedup, step: 30
Epoch 54/300 |loss: 0.001438| train set 2.847x speedup, test set 1.355x speedup, val set 0.906x speedup, step: 31
Epoch 55/300 |loss: 0.001360| train set 2.885x speedup, test set 1.344x speedup, val set 0.927x speedup, step: 32
Epoch 56/300 |loss: 0.001142| train set 2.826x speedup, test set 1.341x speedup, val set 0.934x speedup, step: 33
Epoch 57/300 |loss: 0.001129| train set 2.916x speedup, test set 1.341x speedup, val set 1.039x speedup, step: 34
Epoch 58/300 |loss: 0.001351| train set 2.791x speedup, test set 1.348x speedup, val set 1.043x speedup, step: 35
Epoch 59/300 |loss: 0.001037| train set 2.766x speedup, test set 1.347x speedup, val set 0.919x speedup, step: 36
Epoch 60/300 |loss: 0.001133| train set 2.798x speedup, test set 1.297x speedup, val set 1.039x speedup, step: 37
Epoch 61/300 |loss: 0.001257| train set 2.767x speedup, test set 1.377x speedup, val set 0.883x speedup, step: 38
Epoch 62/300 |loss: 0.001070| train set 2.863x speedup, test set 1.311x speedup, val set 0.927x speedup, step: 39
Epoch 63/300 |loss: 0.001155| train set 2.875x speedup, test set 1.304x speedup, val set 0.929x speedup, step: 40
Epoch 64/300 |loss: 0.001050| train set 2.614x speedup, test set 1.364x speedup, val set 0.833x speedup, step: 41
Epoch 65/300 |loss: 0.001323| train set 2.784x speedup, test set 1.334x speedup, val set 0.934x speedup, step: 42
Epoch 66/300 |loss: 0.001061| train set 2.820x speedup, test set 1.314x speedup, val set 0.929x speedup, step: 43
Epoch 67/300 |loss: 0.001094| train set 2.846x speedup, test set 1.376x speedup, val set 0.934x speedup, step: 44
Epoch 68/300 |loss: 0.001161| train set 2.737x speedup, test set 1.308x speedup, val set 0.934x speedup, step: 45
early stopping at epoch 68
Training per epoch cost 1.276 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
07, opt runtime 6.284s, model runtime 13.017s, pg runtime 31.019s, speedup 2.383x
08, opt runtime 7.377s, model runtime 17.141s, pg runtime 28.655s, speedup 1.672x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 87.340s, pg runtime 87.340s, speedup 1.000x
12, opt runtime 26.602s, model runtime 85.447s, pg runtime 85.447s, speedup 1.000x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.398s, pg runtime 1.438s, speedup 1.028x
20, opt runtime 1.428s, model runtime 1.645s, pg runtime 1.428s, speedup 0.868x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 73.048s, pg runtime 75.984s, speedup 1.040x
34, opt runtime 39.191s, model runtime 73.048s, pg runtime 75.984s, speedup 1.040x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 51, train speedup 2.927, test speedup 1.341, val speedup 0.928
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 24, train speedup 2.756, test speedup 1.390, val speedup 1.297
last model at epoch 68, train speedup 2.737, test speedup 1.308, val speedup 0.934
execution cost 0:02:09.021622
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.665319, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007034| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006540| train set 1.481x speedup, test set 1.344x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006195| train set 0.962x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005954| train set 0.997x speedup, test set 1.128x speedup, val set 1.085x speedup, step: 7
Epoch 11/300 |loss: 0.005702| train set 1.013x speedup, test set 1.352x speedup, val set 1.076x speedup, step: 8
Epoch 12/300 |loss: 0.005423| train set 1.033x speedup, test set 1.125x speedup, val set 1.087x speedup, step: 9
Epoch 13/300 |loss: 0.005177| train set 1.019x speedup, test set 1.391x speedup, val set 1.085x speedup, step: 10
Epoch 14/300 |loss: 0.005114| train set 1.047x speedup, test set 1.365x speedup, val set 0.987x speedup, step: 11
Epoch 15/300 |loss: 0.005088| train set 1.031x speedup, test set 1.360x speedup, val set 0.978x speedup, step: 12
Epoch 16/300 |loss: 0.004692| train set 1.253x speedup, test set 1.411x speedup, val set 1.161x speedup, step: 1
Epoch 17/300 |loss: 0.004817| train set 1.020x speedup, test set 1.330x speedup, val set 1.090x speedup, step: 2
Epoch 18/300 |loss: 0.004115| train set 1.306x speedup, test set 1.309x speedup, val set 1.032x speedup, step: 3
Epoch 19/300 |loss: 0.004372| train set 1.255x speedup, test set 1.324x speedup, val set 1.001x speedup, step: 4
Epoch 20/300 |loss: 0.003747| train set 1.280x speedup, test set 1.348x speedup, val set 0.989x speedup, step: 5
Epoch 21/300 |loss: 0.003445| train set 1.181x speedup, test set 1.334x speedup, val set 0.973x speedup, step: 6
Epoch 22/300 |loss: 0.003442| train set 2.697x speedup, test set 1.388x speedup, val set 1.001x speedup, step: 7
Epoch 23/300 |loss: 0.003094| train set 2.428x speedup, test set 1.325x speedup, val set 1.001x speedup, step: 8
Epoch 24/300 |loss: 0.003890| train set 2.730x speedup, test set 1.307x speedup, val set 1.187x speedup, step: 1
Epoch 25/300 |loss: 0.003403| train set 2.416x speedup, test set 1.389x speedup, val set 1.001x speedup, step: 2
Epoch 26/300 |loss: 0.002872| train set 2.731x speedup, test set 1.389x speedup, val set 0.997x speedup, step: 3
Epoch 27/300 |loss: 0.002893| train set 2.756x speedup, test set 1.360x speedup, val set 0.882x speedup, step: 4
Epoch 28/300 |loss: 0.002708| train set 2.732x speedup, test set 1.389x speedup, val set 0.934x speedup, step: 5
Epoch 29/300 |loss: 0.002566| train set 2.404x speedup, test set 1.354x speedup, val set 0.836x speedup, step: 6
Epoch 30/300 |loss: 0.002657| train set 2.723x speedup, test set 1.326x speedup, val set 0.938x speedup, step: 7
Epoch 31/300 |loss: 0.002562| train set 2.643x speedup, test set 1.415x speedup, val set 0.883x speedup, step: 8
Epoch 32/300 |loss: 0.002823| train set 2.333x speedup, test set 1.398x speedup, val set 0.837x speedup, step: 9
Epoch 33/300 |loss: 0.002461| train set 2.768x speedup, test set 1.356x speedup, val set 0.842x speedup, step: 10
Epoch 34/300 |loss: 0.002133| train set 2.825x speedup, test set 1.394x speedup, val set 0.913x speedup, step: 11
Epoch 35/300 |loss: 0.002098| train set 2.847x speedup, test set 1.357x speedup, val set 0.839x speedup, step: 12
Epoch 36/300 |loss: 0.002292| train set 2.490x speedup, test set 1.397x speedup, val set 0.839x speedup, step: 13
Epoch 37/300 |loss: 0.001991| train set 2.739x speedup, test set 1.306x speedup, val set 0.842x speedup, step: 14
Epoch 38/300 |loss: 0.001880| train set 2.889x speedup, test set 1.462x speedup, val set 0.842x speedup, step: 15
Epoch 39/300 |loss: 0.001908| train set 2.836x speedup, test set 1.364x speedup, val set 0.951x speedup, step: 16
Epoch 40/300 |loss: 0.002020| train set 2.729x speedup, test set 1.370x speedup, val set 0.838x speedup, step: 17
Epoch 41/300 |loss: 0.001865| train set 2.817x speedup, test set 1.352x speedup, val set 0.927x speedup, step: 18
Epoch 42/300 |loss: 0.001673| train set 2.835x speedup, test set 1.356x speedup, val set 0.934x speedup, step: 19
Epoch 43/300 |loss: 0.001802| train set 2.862x speedup, test set 1.429x speedup, val set 0.938x speedup, step: 20
Epoch 44/300 |loss: 0.001684| train set 2.711x speedup, test set 1.443x speedup, val set 0.938x speedup, step: 21
Epoch 45/300 |loss: 0.001870| train set 2.798x speedup, test set 1.457x speedup, val set 0.933x speedup, step: 22
Epoch 46/300 |loss: 0.001792| train set 2.722x speedup, test set 1.376x speedup, val set 0.938x speedup, step: 23
Epoch 47/300 |loss: 0.001598| train set 2.752x speedup, test set 1.448x speedup, val set 0.920x speedup, step: 24
Epoch 48/300 |loss: 0.001562| train set 2.806x speedup, test set 1.378x speedup, val set 0.931x speedup, step: 25
Epoch 49/300 |loss: 0.001480| train set 2.846x speedup, test set 1.425x speedup, val set 0.938x speedup, step: 26
Epoch 50/300 |loss: 0.001273| train set 2.545x speedup, test set 1.475x speedup, val set 0.938x speedup, step: 27
Epoch 51/300 |loss: 0.001337| train set 2.821x speedup, test set 1.448x speedup, val set 0.938x speedup, step: 28
Epoch 52/300 |loss: 0.001228| train set 2.882x speedup, test set 1.440x speedup, val set 1.044x speedup, step: 29
Epoch 53/300 |loss: 0.001231| train set 2.808x speedup, test set 1.372x speedup, val set 0.931x speedup, step: 30
Epoch 54/300 |loss: 0.001331| train set 2.494x speedup, test set 1.448x speedup, val set 0.928x speedup, step: 31
Epoch 55/300 |loss: 0.001289| train set 2.794x speedup, test set 1.356x speedup, val set 0.927x speedup, step: 32
Epoch 56/300 |loss: 0.001282| train set 2.838x speedup, test set 1.376x speedup, val set 0.931x speedup, step: 33
Epoch 57/300 |loss: 0.001175| train set 2.864x speedup, test set 1.439x speedup, val set 1.034x speedup, step: 34
Epoch 58/300 |loss: 0.001503| train set 2.864x speedup, test set 1.462x speedup, val set 0.938x speedup, step: 35
Epoch 59/300 |loss: 0.001282| train set 2.861x speedup, test set 1.356x speedup, val set 0.923x speedup, step: 36
early stopping at epoch 59
Training per epoch cost 1.260 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 99.557s, pg runtime 87.340s, speedup 0.877x
12, opt runtime 26.602s, model runtime 99.044s, pg runtime 85.447s, speedup 0.863x
13, opt runtime 3.332s, model runtime 27.373s, pg runtime 21.298s, speedup 0.778x
14, opt runtime 3.258s, model runtime 24.602s, pg runtime 18.141s, speedup 0.737x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.398s, pg runtime 1.438s, speedup 1.028x
20, opt runtime 1.428s, model runtime 1.645s, pg runtime 1.428s, speedup 0.868x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 6.234s, model runtime 10.545s, pg runtime 32.540s, speedup 3.086x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
34, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 2.889, test speedup 1.462, val speedup 0.842
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 24, train speedup 2.730, test speedup 1.307, val speedup 1.187
last model at epoch 59, train speedup 2.861, test speedup 1.356, val speedup 0.923
execution cost 0:01:53.285240
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.691675, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008262| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007591| train set 1.475x speedup, test set 1.372x speedup, val set 1.107x speedup, step: 3
Epoch 7/300 |loss: 0.007030| train set 0.971x speedup, test set 1.370x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006546| train set 1.534x speedup, test set 1.372x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006187| train set 0.967x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005939| train set 0.994x speedup, test set 1.121x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005774| train set 0.996x speedup, test set 1.352x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005333| train set 1.035x speedup, test set 1.125x speedup, val set 1.085x speedup, step: 9
Epoch 13/300 |loss: 0.005191| train set 1.062x speedup, test set 1.354x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005055| train set 1.146x speedup, test set 1.365x speedup, val set 1.070x speedup, step: 11
Epoch 15/300 |loss: 0.005170| train set 1.025x speedup, test set 1.348x speedup, val set 1.099x speedup, step: 12
Epoch 16/300 |loss: 0.004851| train set 1.243x speedup, test set 1.440x speedup, val set 1.111x speedup, step: 13
Epoch 17/300 |loss: 0.005028| train set 0.972x speedup, test set 1.339x speedup, val set 0.984x speedup, step: 14
Epoch 18/300 |loss: 0.004062| train set 1.281x speedup, test set 1.412x speedup, val set 0.991x speedup, step: 15
Epoch 19/300 |loss: 0.004336| train set 1.272x speedup, test set 1.450x speedup, val set 1.133x speedup, step: 1
Epoch 20/300 |loss: 0.003724| train set 1.287x speedup, test set 1.382x speedup, val set 1.118x speedup, step: 2
Epoch 21/300 |loss: 0.003485| train set 1.205x speedup, test set 1.164x speedup, val set 1.107x speedup, step: 3
Epoch 22/300 |loss: 0.003529| train set 2.653x speedup, test set 1.412x speedup, val set 1.133x speedup, step: 4
Epoch 23/300 |loss: 0.003199| train set 2.318x speedup, test set 1.412x speedup, val set 0.989x speedup, step: 5
Epoch 24/300 |loss: 0.004479| train set 2.700x speedup, test set 1.404x speedup, val set 1.133x speedup, step: 1
Epoch 25/300 |loss: 0.003414| train set 2.438x speedup, test set 1.410x speedup, val set 1.001x speedup, step: 2
Epoch 26/300 |loss: 0.003382| train set 2.493x speedup, test set 1.300x speedup, val set 0.978x speedup, step: 3
Epoch 27/300 |loss: 0.002948| train set 2.775x speedup, test set 1.126x speedup, val set 0.927x speedup, step: 4
Epoch 28/300 |loss: 0.002750| train set 2.680x speedup, test set 1.388x speedup, val set 0.840x speedup, step: 5
Epoch 29/300 |loss: 0.002596| train set 2.707x speedup, test set 1.342x speedup, val set 1.036x speedup, step: 6
Epoch 30/300 |loss: 0.002439| train set 2.487x speedup, test set 1.126x speedup, val set 0.897x speedup, step: 7
Epoch 31/300 |loss: 0.002396| train set 2.441x speedup, test set 1.415x speedup, val set 0.927x speedup, step: 8
Epoch 32/300 |loss: 0.002670| train set 2.690x speedup, test set 1.348x speedup, val set 1.079x speedup, step: 9
Epoch 33/300 |loss: 0.002599| train set 2.744x speedup, test set 1.356x speedup, val set 0.980x speedup, step: 10
Epoch 34/300 |loss: 0.002129| train set 2.816x speedup, test set 1.349x speedup, val set 1.108x speedup, step: 11
Epoch 35/300 |loss: 0.002212| train set 2.834x speedup, test set 1.133x speedup, val set 0.947x speedup, step: 12
Epoch 36/300 |loss: 0.002104| train set 2.441x speedup, test set 1.337x speedup, val set 0.934x speedup, step: 13
Epoch 37/300 |loss: 0.002046| train set 2.863x speedup, test set 1.126x speedup, val set 1.023x speedup, step: 14
Epoch 38/300 |loss: 0.002019| train set 2.867x speedup, test set 1.133x speedup, val set 0.934x speedup, step: 15
Epoch 39/300 |loss: 0.001941| train set 2.788x speedup, test set 1.356x speedup, val set 0.835x speedup, step: 16
Epoch 40/300 |loss: 0.002124| train set 2.802x speedup, test set 1.363x speedup, val set 1.133x speedup, step: 17
Epoch 41/300 |loss: 0.001941| train set 2.826x speedup, test set 1.126x speedup, val set 0.984x speedup, step: 18
Epoch 42/300 |loss: 0.001941| train set 2.744x speedup, test set 1.355x speedup, val set 0.980x speedup, step: 19
Epoch 43/300 |loss: 0.002389| train set 2.562x speedup, test set 1.369x speedup, val set 0.938x speedup, step: 20
Epoch 44/300 |loss: 0.001974| train set 2.792x speedup, test set 1.355x speedup, val set 0.909x speedup, step: 21
Epoch 45/300 |loss: 0.001679| train set 2.881x speedup, test set 1.094x speedup, val set 0.934x speedup, step: 22
Epoch 46/300 |loss: 0.001797| train set 2.780x speedup, test set 1.365x speedup, val set 0.938x speedup, step: 23
Epoch 47/300 |loss: 0.001827| train set 2.926x speedup, test set 1.365x speedup, val set 0.926x speedup, step: 24
Epoch 48/300 |loss: 0.001774| train set 2.848x speedup, test set 1.309x speedup, val set 0.913x speedup, step: 25
Epoch 49/300 |loss: 0.001548| train set 2.916x speedup, test set 1.094x speedup, val set 0.917x speedup, step: 26
Epoch 50/300 |loss: 0.001442| train set 2.425x speedup, test set 1.428x speedup, val set 0.913x speedup, step: 27
Epoch 51/300 |loss: 0.001471| train set 2.843x speedup, test set 1.375x speedup, val set 0.913x speedup, step: 28
Epoch 52/300 |loss: 0.001295| train set 2.936x speedup, test set 1.134x speedup, val set 0.913x speedup, step: 29
Epoch 53/300 |loss: 0.001449| train set 2.639x speedup, test set 1.134x speedup, val set 0.913x speedup, step: 30
Epoch 54/300 |loss: 0.001428| train set 2.931x speedup, test set 1.090x speedup, val set 0.913x speedup, step: 31
Epoch 55/300 |loss: 0.001302| train set 2.308x speedup, test set 1.302x speedup, val set 0.913x speedup, step: 32
Epoch 56/300 |loss: 0.001258| train set 2.671x speedup, test set 1.304x speedup, val set 0.913x speedup, step: 33
Epoch 57/300 |loss: 0.001213| train set 2.856x speedup, test set 1.307x speedup, val set 0.905x speedup, step: 34
Epoch 58/300 |loss: 0.001585| train set 2.793x speedup, test set 1.399x speedup, val set 0.917x speedup, step: 35
Epoch 59/300 |loss: 0.001188| train set 2.839x speedup, test set 1.365x speedup, val set 0.913x speedup, step: 36
Epoch 60/300 |loss: 0.001250| train set 2.901x speedup, test set 1.315x speedup, val set 1.009x speedup, step: 37
Epoch 61/300 |loss: 0.001144| train set 2.952x speedup, test set 1.309x speedup, val set 0.917x speedup, step: 38
Epoch 62/300 |loss: 0.001209| train set 2.796x speedup, test set 1.301x speedup, val set 0.913x speedup, step: 39
Epoch 63/300 |loss: 0.000982| train set 2.667x speedup, test set 1.307x speedup, val set 0.893x speedup, step: 40
Epoch 64/300 |loss: 0.001142| train set 2.692x speedup, test set 1.307x speedup, val set 0.913x speedup, step: 41
Epoch 65/300 |loss: 0.001198| train set 2.465x speedup, test set 1.307x speedup, val set 0.907x speedup, step: 42
Epoch 66/300 |loss: 0.001281| train set 2.693x speedup, test set 2.272x speedup, val set 0.999x speedup, step: 43
Epoch 67/300 |loss: 0.001150| train set 2.907x speedup, test set 2.293x speedup, val set 0.999x speedup, step: 44
Epoch 68/300 |loss: 0.001199| train set 2.886x speedup, test set 1.309x speedup, val set 1.135x speedup, step: 1
Epoch 69/300 |loss: 0.000891| train set 2.718x speedup, test set 2.272x speedup, val set 0.900x speedup, step: 2
Epoch 70/300 |loss: 0.001034| train set 2.896x speedup, test set 1.338x speedup, val set 0.947x speedup, step: 3
Epoch 71/300 |loss: 0.001000| train set 2.831x speedup, test set 2.299x speedup, val set 0.900x speedup, step: 4
Epoch 72/300 |loss: 0.000777| train set 2.889x speedup, test set 2.280x speedup, val set 0.900x speedup, step: 5
Epoch 73/300 |loss: 0.000797| train set 2.827x speedup, test set 1.301x speedup, val set 0.899x speedup, step: 6
Epoch 74/300 |loss: 0.000697| train set 2.885x speedup, test set 2.300x speedup, val set 0.907x speedup, step: 7
Epoch 75/300 |loss: 0.000731| train set 2.878x speedup, test set 2.320x speedup, val set 0.913x speedup, step: 8
Epoch 76/300 |loss: 0.000657| train set 2.912x speedup, test set 1.316x speedup, val set 0.900x speedup, step: 9
Epoch 77/300 |loss: 0.000906| train set 2.836x speedup, test set 1.298x speedup, val set 0.899x speedup, step: 10
Epoch 78/300 |loss: 0.000813| train set 2.792x speedup, test set 2.285x speedup, val set 0.900x speedup, step: 11
Epoch 79/300 |loss: 0.001018| train set 2.838x speedup, test set 2.312x speedup, val set 0.981x speedup, step: 12
Epoch 80/300 |loss: 0.000715| train set 2.766x speedup, test set 1.316x speedup, val set 0.900x speedup, step: 13
Epoch 81/300 |loss: 0.000678| train set 2.902x speedup, test set 2.284x speedup, val set 0.913x speedup, step: 14
Epoch 82/300 |loss: 0.001289| train set 2.672x speedup, test set 1.318x speedup, val set 0.999x speedup, step: 15
Epoch 83/300 |loss: 0.000944| train set 2.877x speedup, test set 2.292x speedup, val set 1.130x speedup, step: 16
early stopping at epoch 83
Training per epoch cost 1.252 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
07, opt runtime 6.284s, model runtime 13.017s, pg runtime 31.019s, speedup 2.383x
08, opt runtime 7.377s, model runtime 17.141s, pg runtime 28.655s, speedup 1.672x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 100.428s, pg runtime 87.340s, speedup 0.870x
12, opt runtime 26.602s, model runtime 100.512s, pg runtime 85.447s, speedup 0.850x
13, opt runtime 3.332s, model runtime 16.163s, pg runtime 21.298s, speedup 1.318x
14, opt runtime 3.258s, model runtime 13.591s, pg runtime 18.141s, speedup 1.335x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.457s, pg runtime 1.438s, speedup 0.987x
20, opt runtime 1.428s, model runtime 1.528s, pg runtime 1.428s, speedup 0.934x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 6.234s, model runtime 10.545s, pg runtime 32.540s, speedup 3.086x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 76.171s, pg runtime 75.984s, speedup 0.998x
34, opt runtime 39.191s, model runtime 76.171s, pg runtime 75.984s, speedup 0.998x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 61, train speedup 2.952, test speedup 1.309, val speedup 0.917
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 68, train speedup 2.886, test speedup 1.309, val speedup 1.135
last model at epoch 83, train speedup 2.877, test speedup 2.292, val speedup 1.130
execution cost 0:02:34.043985
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.676080, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007032| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006533| train set 1.466x speedup, test set 1.344x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006204| train set 0.962x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005962| train set 0.995x speedup, test set 1.121x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005771| train set 1.011x speedup, test set 1.357x speedup, val set 1.076x speedup, step: 8
Epoch 12/300 |loss: 0.005373| train set 1.025x speedup, test set 1.125x speedup, val set 1.087x speedup, step: 9
Epoch 13/300 |loss: 0.005195| train set 1.002x speedup, test set 1.354x speedup, val set 1.084x speedup, step: 10
Epoch 14/300 |loss: 0.005033| train set 1.142x speedup, test set 1.354x speedup, val set 1.070x speedup, step: 11
Epoch 15/300 |loss: 0.005118| train set 1.025x speedup, test set 1.350x speedup, val set 1.070x speedup, step: 12
Epoch 16/300 |loss: 0.004881| train set 1.238x speedup, test set 1.418x speedup, val set 1.268x speedup, step: 1
Epoch 17/300 |loss: 0.005023| train set 1.052x speedup, test set 1.335x speedup, val set 1.095x speedup, step: 2
Epoch 18/300 |loss: 0.004082| train set 1.305x speedup, test set 1.362x speedup, val set 1.032x speedup, step: 3
Epoch 19/300 |loss: 0.004359| train set 1.247x speedup, test set 1.315x speedup, val set 1.043x speedup, step: 4
Epoch 20/300 |loss: 0.003786| train set 1.282x speedup, test set 1.325x speedup, val set 1.001x speedup, step: 5
Epoch 21/300 |loss: 0.003468| train set 1.256x speedup, test set 1.365x speedup, val set 0.990x speedup, step: 6
Epoch 22/300 |loss: 0.003478| train set 2.660x speedup, test set 1.333x speedup, val set 0.882x speedup, step: 7
Epoch 23/300 |loss: 0.003188| train set 2.251x speedup, test set 1.333x speedup, val set 0.986x speedup, step: 8
Epoch 24/300 |loss: 0.003842| train set 2.742x speedup, test set 1.356x speedup, val set 1.187x speedup, step: 9
Epoch 25/300 |loss: 0.003404| train set 2.418x speedup, test set 1.331x speedup, val set 1.001x speedup, step: 10
Epoch 26/300 |loss: 0.003241| train set 2.215x speedup, test set 1.301x speedup, val set 0.983x speedup, step: 11
Epoch 27/300 |loss: 0.002963| train set 2.781x speedup, test set 1.356x speedup, val set 0.984x speedup, step: 12
Epoch 28/300 |loss: 0.002679| train set 2.684x speedup, test set 1.356x speedup, val set 0.934x speedup, step: 13
Epoch 29/300 |loss: 0.002576| train set 2.754x speedup, test set 1.328x speedup, val set 0.926x speedup, step: 14
Epoch 30/300 |loss: 0.002463| train set 2.417x speedup, test set 1.350x speedup, val set 0.838x speedup, step: 15
Epoch 31/300 |loss: 0.002382| train set 2.755x speedup, test set 1.380x speedup, val set 0.938x speedup, step: 16
Epoch 32/300 |loss: 0.002744| train set 2.515x speedup, test set 1.348x speedup, val set 0.935x speedup, step: 17
Epoch 33/300 |loss: 0.002539| train set 2.851x speedup, test set 1.343x speedup, val set 0.984x speedup, step: 18
Epoch 34/300 |loss: 0.002103| train set 2.819x speedup, test set 1.343x speedup, val set 0.842x speedup, step: 19
Epoch 35/300 |loss: 0.002282| train set 2.872x speedup, test set 1.289x speedup, val set 0.838x speedup, step: 20
Epoch 36/300 |loss: 0.002064| train set 2.589x speedup, test set 1.320x speedup, val set 0.839x speedup, step: 21
Epoch 37/300 |loss: 0.002030| train set 2.784x speedup, test set 1.322x speedup, val set 0.839x speedup, step: 22
Epoch 38/300 |loss: 0.002120| train set 2.849x speedup, test set 1.294x speedup, val set 0.839x speedup, step: 23
Epoch 39/300 |loss: 0.001872| train set 2.809x speedup, test set 1.294x speedup, val set 0.842x speedup, step: 24
Epoch 40/300 |loss: 0.002171| train set 2.819x speedup, test set 1.289x speedup, val set 0.839x speedup, step: 25
Epoch 41/300 |loss: 0.001805| train set 2.846x speedup, test set 1.356x speedup, val set 0.838x speedup, step: 26
Epoch 42/300 |loss: 0.001956| train set 2.838x speedup, test set 1.343x speedup, val set 0.839x speedup, step: 27
Epoch 43/300 |loss: 0.002018| train set 2.892x speedup, test set 1.289x speedup, val set 0.842x speedup, step: 28
Epoch 44/300 |loss: 0.001921| train set 2.850x speedup, test set 1.301x speedup, val set 0.842x speedup, step: 29
Epoch 45/300 |loss: 0.001667| train set 2.853x speedup, test set 1.139x speedup, val set 0.839x speedup, step: 30
Epoch 46/300 |loss: 0.001759| train set 2.501x speedup, test set 1.344x speedup, val set 0.842x speedup, step: 31
Epoch 47/300 |loss: 0.001690| train set 2.811x speedup, test set 1.342x speedup, val set 0.839x speedup, step: 32
Epoch 48/300 |loss: 0.001537| train set 2.847x speedup, test set 1.343x speedup, val set 0.839x speedup, step: 33
Epoch 49/300 |loss: 0.001563| train set 2.835x speedup, test set 1.347x speedup, val set 0.842x speedup, step: 34
Epoch 50/300 |loss: 0.001405| train set 2.539x speedup, test set 1.295x speedup, val set 0.840x speedup, step: 35
Epoch 51/300 |loss: 0.001378| train set 2.886x speedup, test set 1.321x speedup, val set 0.834x speedup, step: 36
Epoch 52/300 |loss: 0.001218| train set 2.917x speedup, test set 1.321x speedup, val set 0.833x speedup, step: 37
Epoch 53/300 |loss: 0.001303| train set 2.808x speedup, test set 0.951x speedup, val set 0.840x speedup, step: 38
Epoch 54/300 |loss: 0.001290| train set 2.920x speedup, test set 0.924x speedup, val set 0.839x speedup, step: 39
Epoch 55/300 |loss: 0.001279| train set 2.385x speedup, test set 1.126x speedup, val set 0.838x speedup, step: 40
Epoch 56/300 |loss: 0.001144| train set 2.857x speedup, test set 1.322x speedup, val set 0.839x speedup, step: 41
Epoch 57/300 |loss: 0.001035| train set 2.835x speedup, test set 1.349x speedup, val set 0.842x speedup, step: 42
Epoch 58/300 |loss: 0.001593| train set 2.902x speedup, test set 1.349x speedup, val set 0.839x speedup, step: 43
Epoch 59/300 |loss: 0.001128| train set 2.787x speedup, test set 1.363x speedup, val set 0.822x speedup, step: 44
Epoch 60/300 |loss: 0.001221| train set 2.833x speedup, test set 1.307x speedup, val set 0.842x speedup, step: 45
Epoch 61/300 |loss: 0.001108| train set 2.881x speedup, test set 1.349x speedup, val set 0.842x speedup, step: 46
Epoch 62/300 |loss: 0.001108| train set 2.821x speedup, test set 1.363x speedup, val set 0.828x speedup, step: 47
Epoch 63/300 |loss: 0.000998| train set 2.825x speedup, test set 1.363x speedup, val set 0.831x speedup, step: 48
Epoch 64/300 |loss: 0.001130| train set 2.843x speedup, test set 1.307x speedup, val set 0.822x speedup, step: 49
Epoch 65/300 |loss: 0.001320| train set 2.825x speedup, test set 0.930x speedup, val set 0.839x speedup, step: 50
Epoch 66/300 |loss: 0.001186| train set 2.813x speedup, test set 1.301x speedup, val set 0.842x speedup, step: 51
early stopping at epoch 66
Training per epoch cost 1.247 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 54, train speedup 2.920, test speedup 0.924, val speedup 0.839
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.238, test speedup 1.418, val speedup 1.268
last model at epoch 66, train speedup 2.813, test speedup 1.301, val speedup 0.842
execution cost 0:02:03.199752
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.707856, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007032| train set 0.971x speedup, test set 1.365x speedup, val set 1.090x speedup, step: 4
Epoch 8/300 |loss: 0.006531| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006186| train set 0.967x speedup, test set 1.127x speedup, val set 1.085x speedup, step: 6
Epoch 10/300 |loss: 0.006014| train set 0.995x speedup, test set 1.126x speedup, val set 1.106x speedup, step: 7
Epoch 11/300 |loss: 0.005657| train set 1.034x speedup, test set 1.357x speedup, val set 1.076x speedup, step: 8
Epoch 12/300 |loss: 0.005476| train set 1.039x speedup, test set 1.125x speedup, val set 1.103x speedup, step: 9
Epoch 13/300 |loss: 0.005184| train set 1.012x speedup, test set 1.354x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005122| train set 1.137x speedup, test set 1.366x speedup, val set 1.092x speedup, step: 11
Epoch 15/300 |loss: 0.004989| train set 1.013x speedup, test set 1.122x speedup, val set 1.070x speedup, step: 12
Epoch 16/300 |loss: 0.004727| train set 1.256x speedup, test set 1.442x speedup, val set 1.177x speedup, step: 1
Epoch 17/300 |loss: 0.004852| train set 1.040x speedup, test set 1.356x speedup, val set 1.022x speedup, step: 2
Epoch 18/300 |loss: 0.004131| train set 1.300x speedup, test set 1.356x speedup, val set 1.086x speedup, step: 3
Epoch 19/300 |loss: 0.004196| train set 1.262x speedup, test set 1.387x speedup, val set 1.133x speedup, step: 4
Epoch 20/300 |loss: 0.003808| train set 1.289x speedup, test set 1.397x speedup, val set 1.001x speedup, step: 5
Epoch 21/300 |loss: 0.003418| train set 1.203x speedup, test set 1.108x speedup, val set 0.978x speedup, step: 6
Epoch 22/300 |loss: 0.003304| train set 2.669x speedup, test set 1.398x speedup, val set 0.882x speedup, step: 7
Epoch 23/300 |loss: 0.003132| train set 2.339x speedup, test set 1.333x speedup, val set 0.949x speedup, step: 8
Epoch 24/300 |loss: 0.003992| train set 2.689x speedup, test set 1.328x speedup, val set 1.187x speedup, step: 1
Epoch 25/300 |loss: 0.003516| train set 2.742x speedup, test set 1.360x speedup, val set 0.949x speedup, step: 2
Epoch 26/300 |loss: 0.002965| train set 2.599x speedup, test set 1.338x speedup, val set 0.982x speedup, step: 3
Epoch 27/300 |loss: 0.002982| train set 2.771x speedup, test set 1.356x speedup, val set 0.938x speedup, step: 4
Epoch 28/300 |loss: 0.002602| train set 2.680x speedup, test set 1.356x speedup, val set 0.938x speedup, step: 5
Epoch 29/300 |loss: 0.002617| train set 2.733x speedup, test set 1.366x speedup, val set 0.932x speedup, step: 6
Epoch 30/300 |loss: 0.002533| train set 2.761x speedup, test set 1.380x speedup, val set 0.933x speedup, step: 7
Epoch 31/300 |loss: 0.002450| train set 2.719x speedup, test set 1.402x speedup, val set 0.927x speedup, step: 8
Epoch 32/300 |loss: 0.002764| train set 2.333x speedup, test set 1.338x speedup, val set 0.917x speedup, step: 9
Epoch 33/300 |loss: 0.002604| train set 2.841x speedup, test set 1.370x speedup, val set 0.938x speedup, step: 10
Epoch 34/300 |loss: 0.002134| train set 2.920x speedup, test set 1.321x speedup, val set 0.825x speedup, step: 11
Epoch 35/300 |loss: 0.002261| train set 2.874x speedup, test set 1.378x speedup, val set 0.933x speedup, step: 12
Epoch 36/300 |loss: 0.002168| train set 2.534x speedup, test set 1.349x speedup, val set 0.838x speedup, step: 13
Epoch 37/300 |loss: 0.002005| train set 2.699x speedup, test set 1.307x speedup, val set 1.024x speedup, step: 14
Epoch 38/300 |loss: 0.002017| train set 2.854x speedup, test set 1.297x speedup, val set 0.917x speedup, step: 15
Epoch 39/300 |loss: 0.002016| train set 2.768x speedup, test set 1.368x speedup, val set 0.894x speedup, step: 16
Epoch 40/300 |loss: 0.002186| train set 2.794x speedup, test set 1.424x speedup, val set 0.826x speedup, step: 17
Epoch 41/300 |loss: 0.001835| train set 2.932x speedup, test set 1.132x speedup, val set 0.825x speedup, step: 18
Epoch 42/300 |loss: 0.001901| train set 2.836x speedup, test set 1.403x speedup, val set 0.840x speedup, step: 19
Epoch 43/300 |loss: 0.002089| train set 2.846x speedup, test set 1.385x speedup, val set 0.825x speedup, step: 20
Epoch 44/300 |loss: 0.001899| train set 2.855x speedup, test set 1.364x speedup, val set 0.822x speedup, step: 21
Epoch 45/300 |loss: 0.001681| train set 2.825x speedup, test set 1.364x speedup, val set 0.822x speedup, step: 22
Epoch 46/300 |loss: 0.001713| train set 2.823x speedup, test set 1.352x speedup, val set 0.825x speedup, step: 23
Epoch 47/300 |loss: 0.001733| train set 2.895x speedup, test set 1.410x speedup, val set 0.834x speedup, step: 24
Epoch 48/300 |loss: 0.001611| train set 2.833x speedup, test set 1.352x speedup, val set 0.821x speedup, step: 25
Epoch 49/300 |loss: 0.001581| train set 2.874x speedup, test set 0.955x speedup, val set 0.842x speedup, step: 26
Epoch 50/300 |loss: 0.001351| train set 2.860x speedup, test set 1.364x speedup, val set 0.833x speedup, step: 27
Epoch 51/300 |loss: 0.001380| train set 2.911x speedup, test set 0.963x speedup, val set 0.834x speedup, step: 28
Epoch 52/300 |loss: 0.001262| train set 2.796x speedup, test set 1.161x speedup, val set 0.840x speedup, step: 29
Epoch 53/300 |loss: 0.001314| train set 2.660x speedup, test set 1.130x speedup, val set 0.838x speedup, step: 30
Epoch 54/300 |loss: 0.001389| train set 2.890x speedup, test set 1.131x speedup, val set 0.833x speedup, step: 31
Epoch 55/300 |loss: 0.001392| train set 2.336x speedup, test set 1.138x speedup, val set 0.814x speedup, step: 32
Epoch 56/300 |loss: 0.001238| train set 2.856x speedup, test set 1.132x speedup, val set 0.830x speedup, step: 33
Epoch 57/300 |loss: 0.001160| train set 2.777x speedup, test set 1.306x speedup, val set 0.830x speedup, step: 34
Epoch 58/300 |loss: 0.001659| train set 2.773x speedup, test set 1.372x speedup, val set 0.903x speedup, step: 35
Epoch 59/300 |loss: 0.001138| train set 2.719x speedup, test set 1.372x speedup, val set 0.814x speedup, step: 36
Epoch 60/300 |loss: 0.001331| train set 2.759x speedup, test set 1.118x speedup, val set 0.830x speedup, step: 37
Epoch 61/300 |loss: 0.001087| train set 2.909x speedup, test set 1.127x speedup, val set 0.828x speedup, step: 38
Epoch 62/300 |loss: 0.001030| train set 2.803x speedup, test set 1.137x speedup, val set 0.811x speedup, step: 39
Epoch 63/300 |loss: 0.001020| train set 2.863x speedup, test set 0.974x speedup, val set 0.832x speedup, step: 40
Epoch 64/300 |loss: 0.001204| train set 2.617x speedup, test set 1.129x speedup, val set 0.906x speedup, step: 41
Epoch 65/300 |loss: 0.001447| train set 2.774x speedup, test set 1.147x speedup, val set 0.824x speedup, step: 42
Epoch 66/300 |loss: 0.001196| train set 2.876x speedup, test set 0.961x speedup, val set 0.828x speedup, step: 43
early stopping at epoch 66
Training per epoch cost 1.262 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 99.557s, pg runtime 87.340s, speedup 0.877x
12, opt runtime 26.602s, model runtime 99.044s, pg runtime 85.447s, speedup 0.863x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 6.234s, model runtime 10.545s, pg runtime 32.540s, speedup 3.086x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
34, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 41, train speedup 2.932, test speedup 1.132, val speedup 0.825
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 24, train speedup 2.689, test speedup 1.328, val speedup 1.187
last model at epoch 66, train speedup 2.876, test speedup 0.961, val speedup 0.828
execution cost 0:02:06.349702
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.682485, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007031| train set 0.971x speedup, test set 1.364x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006536| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006194| train set 0.964x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005997| train set 0.995x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005718| train set 1.036x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005374| train set 1.028x speedup, test set 1.125x speedup, val set 1.083x speedup, step: 9
Epoch 13/300 |loss: 0.005194| train set 1.067x speedup, test set 1.425x speedup, val set 1.023x speedup, step: 10
Epoch 14/300 |loss: 0.005019| train set 1.138x speedup, test set 1.365x speedup, val set 1.067x speedup, step: 11
Epoch 15/300 |loss: 0.005295| train set 1.030x speedup, test set 1.350x speedup, val set 1.098x speedup, step: 12
Epoch 16/300 |loss: 0.004817| train set 1.236x speedup, test set 1.418x speedup, val set 1.287x speedup, step: 1
Epoch 17/300 |loss: 0.004987| train set 1.061x speedup, test set 1.330x speedup, val set 1.000x speedup, step: 2
Epoch 18/300 |loss: 0.004031| train set 1.303x speedup, test set 1.352x speedup, val set 1.030x speedup, step: 3
Epoch 19/300 |loss: 0.004415| train set 1.247x speedup, test set 1.377x speedup, val set 1.031x speedup, step: 4
Epoch 20/300 |loss: 0.003804| train set 1.297x speedup, test set 1.381x speedup, val set 0.977x speedup, step: 5
Epoch 21/300 |loss: 0.003462| train set 1.218x speedup, test set 1.347x speedup, val set 0.984x speedup, step: 6
Epoch 22/300 |loss: 0.003424| train set 2.565x speedup, test set 1.381x speedup, val set 1.133x speedup, step: 7
Epoch 23/300 |loss: 0.003167| train set 2.312x speedup, test set 1.352x speedup, val set 0.977x speedup, step: 8
Epoch 24/300 |loss: 0.003973| train set 2.659x speedup, test set 1.399x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003460| train set 2.375x speedup, test set 1.352x speedup, val set 1.001x speedup, step: 10
Epoch 26/300 |loss: 0.003394| train set 2.665x speedup, test set 1.330x speedup, val set 0.997x speedup, step: 11
Epoch 27/300 |loss: 0.002868| train set 2.661x speedup, test set 1.389x speedup, val set 0.836x speedup, step: 12
Epoch 28/300 |loss: 0.002656| train set 2.748x speedup, test set 1.389x speedup, val set 0.839x speedup, step: 13
Epoch 29/300 |loss: 0.002550| train set 2.740x speedup, test set 1.356x speedup, val set 0.832x speedup, step: 14
Epoch 30/300 |loss: 0.002429| train set 2.439x speedup, test set 1.415x speedup, val set 0.837x speedup, step: 15
Epoch 31/300 |loss: 0.002424| train set 2.701x speedup, test set 1.380x speedup, val set 0.833x speedup, step: 16
Epoch 32/300 |loss: 0.002577| train set 2.537x speedup, test set 1.355x speedup, val set 0.821x speedup, step: 17
Epoch 33/300 |loss: 0.002529| train set 2.857x speedup, test set 1.415x speedup, val set 0.914x speedup, step: 18
Epoch 34/300 |loss: 0.002151| train set 2.880x speedup, test set 1.356x speedup, val set 0.913x speedup, step: 19
Epoch 35/300 |loss: 0.002357| train set 2.405x speedup, test set 1.356x speedup, val set 0.868x speedup, step: 20
Epoch 36/300 |loss: 0.002199| train set 2.475x speedup, test set 1.356x speedup, val set 0.838x speedup, step: 21
Epoch 37/300 |loss: 0.002047| train set 2.769x speedup, test set 1.356x speedup, val set 0.841x speedup, step: 22
Epoch 38/300 |loss: 0.002112| train set 2.883x speedup, test set 1.328x speedup, val set 0.838x speedup, step: 23
Epoch 39/300 |loss: 0.001979| train set 2.852x speedup, test set 1.356x speedup, val set 0.913x speedup, step: 24
Epoch 40/300 |loss: 0.002074| train set 2.498x speedup, test set 0.992x speedup, val set 0.839x speedup, step: 25
Epoch 41/300 |loss: 0.001817| train set 2.825x speedup, test set 1.356x speedup, val set 0.836x speedup, step: 26
Epoch 42/300 |loss: 0.001852| train set 2.856x speedup, test set 1.356x speedup, val set 0.839x speedup, step: 27
Epoch 43/300 |loss: 0.002384| train set 2.781x speedup, test set 1.417x speedup, val set 0.911x speedup, step: 28
Epoch 44/300 |loss: 0.002135| train set 2.823x speedup, test set 1.355x speedup, val set 0.841x speedup, step: 29
Epoch 45/300 |loss: 0.001649| train set 2.779x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 30
Epoch 46/300 |loss: 0.001562| train set 2.790x speedup, test set 0.954x speedup, val set 0.837x speedup, step: 31
Epoch 47/300 |loss: 0.001606| train set 2.884x speedup, test set 1.416x speedup, val set 0.839x speedup, step: 32
Epoch 48/300 |loss: 0.001507| train set 2.779x speedup, test set 1.374x speedup, val set 0.820x speedup, step: 33
Epoch 49/300 |loss: 0.001493| train set 2.874x speedup, test set 1.366x speedup, val set 0.913x speedup, step: 34
Epoch 50/300 |loss: 0.001340| train set 2.553x speedup, test set 1.355x speedup, val set 0.841x speedup, step: 35
Epoch 51/300 |loss: 0.001319| train set 2.839x speedup, test set 1.424x speedup, val set 0.903x speedup, step: 36
Epoch 52/300 |loss: 0.001190| train set 2.785x speedup, test set 1.436x speedup, val set 0.836x speedup, step: 37
Epoch 53/300 |loss: 0.001593| train set 2.772x speedup, test set 1.436x speedup, val set 0.834x speedup, step: 38
Epoch 54/300 |loss: 0.001387| train set 2.442x speedup, test set 0.998x speedup, val set 0.833x speedup, step: 39
Epoch 55/300 |loss: 0.001236| train set 2.639x speedup, test set 1.371x speedup, val set 0.833x speedup, step: 40
Epoch 56/300 |loss: 0.001088| train set 2.758x speedup, test set 1.374x speedup, val set 0.899x speedup, step: 41
Epoch 57/300 |loss: 0.001185| train set 2.802x speedup, test set 1.366x speedup, val set 0.841x speedup, step: 42
Epoch 58/300 |loss: 0.001629| train set 2.820x speedup, test set 1.374x speedup, val set 0.837x speedup, step: 43
Epoch 59/300 |loss: 0.001156| train set 2.782x speedup, test set 1.366x speedup, val set 0.827x speedup, step: 44
Epoch 60/300 |loss: 0.001171| train set 2.808x speedup, test set 1.363x speedup, val set 0.836x speedup, step: 45
Epoch 61/300 |loss: 0.001186| train set 2.870x speedup, test set 1.374x speedup, val set 0.837x speedup, step: 46
Epoch 62/300 |loss: 0.001109| train set 2.735x speedup, test set 1.366x speedup, val set 0.907x speedup, step: 47
Epoch 63/300 |loss: 0.000860| train set 2.899x speedup, test set 1.374x speedup, val set 0.912x speedup, step: 48
Epoch 64/300 |loss: 0.000835| train set 2.731x speedup, test set 1.366x speedup, val set 0.832x speedup, step: 49
Epoch 65/300 |loss: 0.001202| train set 2.729x speedup, test set 1.368x speedup, val set 0.830x speedup, step: 50
Epoch 66/300 |loss: 0.001185| train set 2.828x speedup, test set 1.369x speedup, val set 1.081x speedup, step: 51
early stopping at epoch 66
Training per epoch cost 1.247 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 34.379s, pg runtime 21.298s, speedup 0.620x
14, opt runtime 3.258s, model runtime 30.464s, pg runtime 18.141s, speedup 0.595x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 63, train speedup 2.899, test speedup 1.374, val speedup 0.912
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.236, test speedup 1.418, val speedup 1.287
last model at epoch 66, train speedup 2.828, test speedup 1.369, val speedup 1.081
execution cost 0:02:02.995165
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.815567, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008262| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007590| train set 1.498x speedup, test set 1.372x speedup, val set 1.107x speedup, step: 3
Epoch 7/300 |loss: 0.007038| train set 0.951x speedup, test set 1.369x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006547| train set 1.464x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006185| train set 0.981x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.006012| train set 1.003x speedup, test set 1.125x speedup, val set 1.085x speedup, step: 7
Epoch 11/300 |loss: 0.005809| train set 1.022x speedup, test set 1.353x speedup, val set 1.076x speedup, step: 8
Epoch 12/300 |loss: 0.005321| train set 1.032x speedup, test set 1.125x speedup, val set 1.087x speedup, step: 9
Epoch 13/300 |loss: 0.005209| train set 1.040x speedup, test set 1.353x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005058| train set 1.138x speedup, test set 1.354x speedup, val set 1.226x speedup, step: 1
Epoch 15/300 |loss: 0.005152| train set 0.983x speedup, test set 1.122x speedup, val set 1.070x speedup, step: 2
Epoch 16/300 |loss: 0.004935| train set 1.242x speedup, test set 1.442x speedup, val set 1.119x speedup, step: 3
Epoch 17/300 |loss: 0.005079| train set 1.048x speedup, test set 1.355x speedup, val set 0.959x speedup, step: 4
Epoch 18/300 |loss: 0.004106| train set 1.300x speedup, test set 1.340x speedup, val set 1.258x speedup, step: 1
Epoch 19/300 |loss: 0.004338| train set 1.197x speedup, test set 1.372x speedup, val set 0.968x speedup, step: 2
Epoch 20/300 |loss: 0.003905| train set 1.295x speedup, test set 1.406x speedup, val set 0.968x speedup, step: 3
Epoch 21/300 |loss: 0.003544| train set 1.273x speedup, test set 1.377x speedup, val set 0.924x speedup, step: 4
Epoch 22/300 |loss: 0.003421| train set 2.701x speedup, test set 1.389x speedup, val set 0.983x speedup, step: 5
Epoch 23/300 |loss: 0.003187| train set 2.344x speedup, test set 1.397x speedup, val set 1.066x speedup, step: 6
Epoch 24/300 |loss: 0.004118| train set 2.608x speedup, test set 1.370x speedup, val set 1.133x speedup, step: 7
Epoch 25/300 |loss: 0.003455| train set 2.704x speedup, test set 1.382x speedup, val set 1.001x speedup, step: 8
Epoch 26/300 |loss: 0.003382| train set 2.262x speedup, test set 1.355x speedup, val set 0.878x speedup, step: 9
Epoch 27/300 |loss: 0.002895| train set 2.758x speedup, test set 1.149x speedup, val set 0.836x speedup, step: 10
Epoch 28/300 |loss: 0.002651| train set 2.663x speedup, test set 1.389x speedup, val set 1.048x speedup, step: 11
Epoch 29/300 |loss: 0.002532| train set 2.755x speedup, test set 1.348x speedup, val set 1.044x speedup, step: 12
Epoch 30/300 |loss: 0.002433| train set 2.721x speedup, test set 1.126x speedup, val set 0.933x speedup, step: 13
Epoch 31/300 |loss: 0.002372| train set 2.658x speedup, test set 1.380x speedup, val set 0.927x speedup, step: 14
Epoch 32/300 |loss: 0.002399| train set 2.427x speedup, test set 1.356x speedup, val set 0.925x speedup, step: 15
Epoch 33/300 |loss: 0.002398| train set 2.806x speedup, test set 1.389x speedup, val set 0.938x speedup, step: 16
Epoch 34/300 |loss: 0.002103| train set 2.895x speedup, test set 1.389x speedup, val set 0.933x speedup, step: 17
Epoch 35/300 |loss: 0.002490| train set 2.650x speedup, test set 1.109x speedup, val set 0.933x speedup, step: 18
Epoch 36/300 |loss: 0.002112| train set 2.478x speedup, test set 1.380x speedup, val set 0.934x speedup, step: 19
Epoch 37/300 |loss: 0.002005| train set 2.853x speedup, test set 1.347x speedup, val set 0.837x speedup, step: 20
Epoch 38/300 |loss: 0.001959| train set 2.851x speedup, test set 1.347x speedup, val set 0.926x speedup, step: 21
Epoch 39/300 |loss: 0.002024| train set 2.806x speedup, test set 1.389x speedup, val set 1.052x speedup, step: 22
Epoch 40/300 |loss: 0.002255| train set 2.824x speedup, test set 1.128x speedup, val set 0.931x speedup, step: 23
Epoch 41/300 |loss: 0.001781| train set 2.853x speedup, test set 1.373x speedup, val set 1.052x speedup, step: 24
Epoch 42/300 |loss: 0.001830| train set 2.820x speedup, test set 1.389x speedup, val set 0.842x speedup, step: 25
Epoch 43/300 |loss: 0.001748| train set 2.809x speedup, test set 0.979x speedup, val set 0.842x speedup, step: 26
Epoch 44/300 |loss: 0.001891| train set 2.799x speedup, test set 1.355x speedup, val set 0.842x speedup, step: 27
Epoch 45/300 |loss: 0.001744| train set 2.875x speedup, test set 1.126x speedup, val set 0.928x speedup, step: 28
Epoch 46/300 |loss: 0.001644| train set 2.857x speedup, test set 0.954x speedup, val set 0.921x speedup, step: 29
Epoch 47/300 |loss: 0.001688| train set 2.809x speedup, test set 1.152x speedup, val set 1.048x speedup, step: 30
Epoch 48/300 |loss: 0.001629| train set 2.832x speedup, test set 1.349x speedup, val set 0.927x speedup, step: 31
Epoch 49/300 |loss: 0.001548| train set 2.793x speedup, test set 1.314x speedup, val set 1.052x speedup, step: 32
Epoch 50/300 |loss: 0.001324| train set 2.847x speedup, test set 0.956x speedup, val set 0.938x speedup, step: 33
Epoch 51/300 |loss: 0.001369| train set 2.820x speedup, test set 1.030x speedup, val set 1.052x speedup, step: 34
Epoch 52/300 |loss: 0.001177| train set 2.961x speedup, test set 1.117x speedup, val set 1.052x speedup, step: 35
Epoch 53/300 |loss: 0.001284| train set 2.619x speedup, test set 1.121x speedup, val set 0.933x speedup, step: 36
Epoch 54/300 |loss: 0.001395| train set 2.559x speedup, test set 0.962x speedup, val set 0.933x speedup, step: 37
Epoch 55/300 |loss: 0.001321| train set 2.759x speedup, test set 1.117x speedup, val set 0.927x speedup, step: 38
Epoch 56/300 |loss: 0.001215| train set 2.833x speedup, test set 1.139x speedup, val set 1.047x speedup, step: 39
Epoch 57/300 |loss: 0.001110| train set 2.897x speedup, test set 0.966x speedup, val set 1.052x speedup, step: 40
Epoch 58/300 |loss: 0.001598| train set 2.804x speedup, test set 1.396x speedup, val set 1.052x speedup, step: 41
Epoch 59/300 |loss: 0.001176| train set 2.841x speedup, test set 1.123x speedup, val set 1.048x speedup, step: 42
Epoch 60/300 |loss: 0.001164| train set 2.908x speedup, test set 1.136x speedup, val set 0.907x speedup, step: 43
Epoch 61/300 |loss: 0.001214| train set 2.861x speedup, test set 0.964x speedup, val set 0.920x speedup, step: 44
Epoch 62/300 |loss: 0.001221| train set 2.791x speedup, test set 1.132x speedup, val set 0.950x speedup, step: 45
Epoch 63/300 |loss: 0.001055| train set 2.863x speedup, test set 0.971x speedup, val set 1.026x speedup, step: 46
Epoch 64/300 |loss: 0.001042| train set 2.838x speedup, test set 1.100x speedup, val set 0.913x speedup, step: 47
Epoch 65/300 |loss: 0.001278| train set 2.687x speedup, test set 1.100x speedup, val set 0.913x speedup, step: 48
Epoch 66/300 |loss: 0.001138| train set 2.832x speedup, test set 0.937x speedup, val set 0.936x speedup, step: 49
early stopping at epoch 66
Training per epoch cost 1.206 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 100.428s, pg runtime 87.340s, speedup 0.870x
12, opt runtime 26.602s, model runtime 100.512s, pg runtime 85.447s, speedup 0.850x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 180.921s, pg runtime 148.707s, speedup 0.822x
16, opt runtime 53.440s, model runtime 165.749s, pg runtime 140.742s, speedup 0.849x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.457s, pg runtime 1.438s, speedup 0.987x
20, opt runtime 1.428s, model runtime 1.528s, pg runtime 1.428s, speedup 0.934x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 6.234s, model runtime 10.545s, pg runtime 32.540s, speedup 3.086x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
34, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 52, train speedup 2.961, test speedup 1.117, val speedup 1.052
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 18, train speedup 1.300, test speedup 1.340, val speedup 1.258
last model at epoch 66, train speedup 2.832, test speedup 0.937, val speedup 0.936
execution cost 0:01:59.898501
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.706651, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007034| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006543| train set 1.481x speedup, test set 1.344x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006196| train set 0.962x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005957| train set 1.003x speedup, test set 1.125x speedup, val set 1.085x speedup, step: 7
Epoch 11/300 |loss: 0.005760| train set 1.026x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005407| train set 1.017x speedup, test set 1.125x speedup, val set 1.008x speedup, step: 9
Epoch 13/300 |loss: 0.005240| train set 1.002x speedup, test set 1.352x speedup, val set 1.085x speedup, step: 10
Epoch 14/300 |loss: 0.005140| train set 1.048x speedup, test set 1.365x speedup, val set 1.070x speedup, step: 11
Epoch 15/300 |loss: 0.004966| train set 1.027x speedup, test set 1.350x speedup, val set 1.098x speedup, step: 12
Epoch 16/300 |loss: 0.004658| train set 1.252x speedup, test set 1.474x speedup, val set 1.161x speedup, step: 1
Epoch 17/300 |loss: 0.004660| train set 1.053x speedup, test set 1.331x speedup, val set 0.939x speedup, step: 2
Epoch 18/300 |loss: 0.004111| train set 1.304x speedup, test set 1.362x speedup, val set 1.030x speedup, step: 3
Epoch 19/300 |loss: 0.004414| train set 1.272x speedup, test set 1.313x speedup, val set 1.030x speedup, step: 4
Epoch 20/300 |loss: 0.003697| train set 1.286x speedup, test set 1.360x speedup, val set 0.966x speedup, step: 5
Epoch 21/300 |loss: 0.003396| train set 1.189x speedup, test set 1.363x speedup, val set 0.978x speedup, step: 6
Epoch 22/300 |loss: 0.003245| train set 2.720x speedup, test set 1.330x speedup, val set 0.981x speedup, step: 7
Epoch 23/300 |loss: 0.003263| train set 2.345x speedup, test set 1.333x speedup, val set 0.949x speedup, step: 8
Epoch 24/300 |loss: 0.003768| train set 2.707x speedup, test set 1.363x speedup, val set 1.187x speedup, step: 1
Epoch 25/300 |loss: 0.003350| train set 2.405x speedup, test set 1.333x speedup, val set 1.133x speedup, step: 2
Epoch 26/300 |loss: 0.002878| train set 2.740x speedup, test set 1.426x speedup, val set 1.038x speedup, step: 3
Epoch 27/300 |loss: 0.002923| train set 2.651x speedup, test set 1.389x speedup, val set 0.935x speedup, step: 4
Epoch 28/300 |loss: 0.002735| train set 2.726x speedup, test set 1.389x speedup, val set 0.934x speedup, step: 5
Epoch 29/300 |loss: 0.002768| train set 2.713x speedup, test set 1.356x speedup, val set 1.049x speedup, step: 6
Epoch 30/300 |loss: 0.002441| train set 2.504x speedup, test set 1.388x speedup, val set 0.873x speedup, step: 7
Epoch 31/300 |loss: 0.002628| train set 2.426x speedup, test set 1.415x speedup, val set 0.836x speedup, step: 8
Epoch 32/300 |loss: 0.002850| train set 2.487x speedup, test set 1.338x speedup, val set 1.000x speedup, step: 9
Epoch 33/300 |loss: 0.002552| train set 2.753x speedup, test set 1.389x speedup, val set 0.881x speedup, step: 10
Epoch 34/300 |loss: 0.002153| train set 2.830x speedup, test set 1.327x speedup, val set 0.930x speedup, step: 11
Epoch 35/300 |loss: 0.002219| train set 2.832x speedup, test set 1.301x speedup, val set 0.969x speedup, step: 12
Epoch 36/300 |loss: 0.002116| train set 2.492x speedup, test set 1.331x speedup, val set 0.839x speedup, step: 13
Epoch 37/300 |loss: 0.001967| train set 2.810x speedup, test set 1.384x speedup, val set 0.836x speedup, step: 14
Epoch 38/300 |loss: 0.001986| train set 2.855x speedup, test set 1.376x speedup, val set 0.839x speedup, step: 15
Epoch 39/300 |loss: 0.001959| train set 2.870x speedup, test set 1.376x speedup, val set 0.929x speedup, step: 16
Epoch 40/300 |loss: 0.002138| train set 2.834x speedup, test set 1.453x speedup, val set 0.936x speedup, step: 17
Epoch 41/300 |loss: 0.001772| train set 2.856x speedup, test set 1.376x speedup, val set 0.928x speedup, step: 18
Epoch 42/300 |loss: 0.001780| train set 2.790x speedup, test set 1.376x speedup, val set 0.934x speedup, step: 19
Epoch 43/300 |loss: 0.002252| train set 2.567x speedup, test set 1.476x speedup, val set 0.938x speedup, step: 20
Epoch 44/300 |loss: 0.002014| train set 2.697x speedup, test set 1.376x speedup, val set 0.927x speedup, step: 21
Epoch 45/300 |loss: 0.001698| train set 2.760x speedup, test set 1.382x speedup, val set 0.918x speedup, step: 22
Epoch 46/300 |loss: 0.001561| train set 2.785x speedup, test set 1.382x speedup, val set 0.934x speedup, step: 23
Epoch 47/300 |loss: 0.001511| train set 2.875x speedup, test set 1.385x speedup, val set 0.935x speedup, step: 24
Epoch 48/300 |loss: 0.001535| train set 2.802x speedup, test set 1.372x speedup, val set 0.927x speedup, step: 25
Epoch 49/300 |loss: 0.001529| train set 2.803x speedup, test set 1.363x speedup, val set 0.938x speedup, step: 26
Epoch 50/300 |loss: 0.001302| train set 2.851x speedup, test set 1.451x speedup, val set 0.927x speedup, step: 27
Epoch 51/300 |loss: 0.001378| train set 2.839x speedup, test set 1.456x speedup, val set 0.936x speedup, step: 28
Epoch 52/300 |loss: 0.001215| train set 2.877x speedup, test set 1.470x speedup, val set 0.829x speedup, step: 29
Epoch 53/300 |loss: 0.001221| train set 2.735x speedup, test set 1.426x speedup, val set 0.827x speedup, step: 30
Epoch 54/300 |loss: 0.001322| train set 2.502x speedup, test set 1.376x speedup, val set 0.918x speedup, step: 31
Epoch 55/300 |loss: 0.001267| train set 2.462x speedup, test set 1.384x speedup, val set 0.828x speedup, step: 32
Epoch 56/300 |loss: 0.001159| train set 2.803x speedup, test set 1.382x speedup, val set 0.928x speedup, step: 33
Epoch 57/300 |loss: 0.001183| train set 2.826x speedup, test set 1.444x speedup, val set 0.837x speedup, step: 34
Epoch 58/300 |loss: 0.001498| train set 2.774x speedup, test set 1.445x speedup, val set 0.938x speedup, step: 35
Epoch 59/300 |loss: 0.001331| train set 2.841x speedup, test set 1.355x speedup, val set 0.919x speedup, step: 36
early stopping at epoch 59
Training per epoch cost 1.197 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 27.373s, pg runtime 21.298s, speedup 0.778x
14, opt runtime 3.258s, model runtime 24.602s, pg runtime 18.141s, speedup 0.737x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 6.234s, model runtime 10.545s, pg runtime 32.540s, speedup 3.086x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
34, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 52, train speedup 2.877, test speedup 1.470, val speedup 0.829
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 24, train speedup 2.707, test speedup 1.363, val speedup 1.187
last model at epoch 59, train speedup 2.841, test speedup 1.355, val speedup 0.919
execution cost 0:01:46.538110
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.731537, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007034| train set 0.971x speedup, test set 1.365x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006541| train set 1.469x speedup, test set 1.344x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006202| train set 0.962x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005962| train set 0.974x speedup, test set 1.128x speedup, val set 1.106x speedup, step: 7
Epoch 11/300 |loss: 0.005781| train set 1.036x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005355| train set 1.030x speedup, test set 1.125x speedup, val set 1.085x speedup, step: 9
Epoch 13/300 |loss: 0.005202| train set 1.069x speedup, test set 1.354x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005110| train set 1.123x speedup, test set 1.366x speedup, val set 1.093x speedup, step: 11
Epoch 15/300 |loss: 0.005085| train set 1.021x speedup, test set 1.350x speedup, val set 1.071x speedup, step: 12
Epoch 16/300 |loss: 0.004877| train set 1.236x speedup, test set 1.474x speedup, val set 1.287x speedup, step: 1
Epoch 17/300 |loss: 0.005128| train set 1.066x speedup, test set 1.352x speedup, val set 0.997x speedup, step: 2
Epoch 18/300 |loss: 0.004093| train set 1.295x speedup, test set 1.377x speedup, val set 1.043x speedup, step: 3
Epoch 19/300 |loss: 0.004326| train set 1.267x speedup, test set 1.326x speedup, val set 0.996x speedup, step: 4
Epoch 20/300 |loss: 0.003865| train set 1.284x speedup, test set 1.354x speedup, val set 0.989x speedup, step: 5
Epoch 21/300 |loss: 0.003472| train set 1.218x speedup, test set 1.356x speedup, val set 0.996x speedup, step: 6
Epoch 22/300 |loss: 0.003473| train set 2.746x speedup, test set 1.381x speedup, val set 1.001x speedup, step: 7
Epoch 23/300 |loss: 0.003229| train set 2.368x speedup, test set 1.348x speedup, val set 0.949x speedup, step: 8
Epoch 24/300 |loss: 0.003897| train set 2.701x speedup, test set 1.363x speedup, val set 1.114x speedup, step: 9
Epoch 25/300 |loss: 0.003375| train set 2.674x speedup, test set 1.389x speedup, val set 0.949x speedup, step: 10
Epoch 26/300 |loss: 0.003138| train set 2.310x speedup, test set 1.356x speedup, val set 0.982x speedup, step: 11
Epoch 27/300 |loss: 0.003018| train set 2.740x speedup, test set 1.356x speedup, val set 0.933x speedup, step: 12
Epoch 28/300 |loss: 0.002789| train set 2.673x speedup, test set 1.356x speedup, val set 0.934x speedup, step: 13
Epoch 29/300 |loss: 0.002683| train set 2.685x speedup, test set 1.356x speedup, val set 0.938x speedup, step: 14
Epoch 30/300 |loss: 0.002584| train set 2.421x speedup, test set 1.356x speedup, val set 0.938x speedup, step: 15
Epoch 31/300 |loss: 0.002449| train set 2.758x speedup, test set 1.380x speedup, val set 0.940x speedup, step: 16
Epoch 32/300 |loss: 0.002574| train set 2.791x speedup, test set 1.301x speedup, val set 0.930x speedup, step: 17
Epoch 33/300 |loss: 0.002986| train set 2.757x speedup, test set 1.356x speedup, val set 1.112x speedup, step: 18
Epoch 34/300 |loss: 0.002424| train set 2.799x speedup, test set 1.356x speedup, val set 0.912x speedup, step: 19
Epoch 35/300 |loss: 0.002476| train set 2.420x speedup, test set 1.128x speedup, val set 0.978x speedup, step: 20
Epoch 36/300 |loss: 0.002222| train set 2.539x speedup, test set 1.120x speedup, val set 0.947x speedup, step: 21
Epoch 37/300 |loss: 0.002000| train set 2.826x speedup, test set 1.120x speedup, val set 0.956x speedup, step: 22
Epoch 38/300 |loss: 0.001987| train set 2.830x speedup, test set 1.352x speedup, val set 0.839x speedup, step: 23
Epoch 39/300 |loss: 0.001939| train set 2.855x speedup, test set 1.356x speedup, val set 0.842x speedup, step: 24
Epoch 40/300 |loss: 0.002146| train set 2.833x speedup, test set 1.356x speedup, val set 0.951x speedup, step: 25
Epoch 41/300 |loss: 0.001870| train set 2.860x speedup, test set 1.126x speedup, val set 0.842x speedup, step: 26
Epoch 42/300 |loss: 0.001892| train set 2.828x speedup, test set 1.358x speedup, val set 0.839x speedup, step: 27
Epoch 43/300 |loss: 0.001953| train set 2.897x speedup, test set 1.328x speedup, val set 0.984x speedup, step: 28
Epoch 44/300 |loss: 0.001923| train set 2.760x speedup, test set 1.352x speedup, val set 0.859x speedup, step: 29
Epoch 45/300 |loss: 0.002029| train set 2.800x speedup, test set 1.359x speedup, val set 0.934x speedup, step: 30
Epoch 46/300 |loss: 0.001677| train set 2.544x speedup, test set 1.364x speedup, val set 0.784x speedup, step: 31
Epoch 47/300 |loss: 0.001801| train set 2.888x speedup, test set 1.346x speedup, val set 0.951x speedup, step: 32
Epoch 48/300 |loss: 0.001613| train set 2.855x speedup, test set 1.299x speedup, val set 0.933x speedup, step: 33
Epoch 49/300 |loss: 0.001708| train set 2.816x speedup, test set 1.123x speedup, val set 0.917x speedup, step: 34
Epoch 50/300 |loss: 0.001601| train set 2.734x speedup, test set 1.382x speedup, val set 0.850x speedup, step: 35
Epoch 51/300 |loss: 0.001606| train set 2.815x speedup, test set 1.302x speedup, val set 0.930x speedup, step: 36
Epoch 52/300 |loss: 0.001275| train set 2.910x speedup, test set 1.351x speedup, val set 0.924x speedup, step: 37
Epoch 53/300 |loss: 0.001364| train set 2.638x speedup, test set 1.351x speedup, val set 0.948x speedup, step: 38
Epoch 54/300 |loss: 0.001425| train set 2.722x speedup, test set 1.302x speedup, val set 0.913x speedup, step: 39
Epoch 55/300 |loss: 0.001289| train set 2.431x speedup, test set 1.354x speedup, val set 0.907x speedup, step: 40
Epoch 56/300 |loss: 0.001096| train set 2.872x speedup, test set 1.351x speedup, val set 0.917x speedup, step: 41
Epoch 57/300 |loss: 0.001061| train set 2.778x speedup, test set 1.299x speedup, val set 0.917x speedup, step: 42
Epoch 58/300 |loss: 0.001539| train set 2.844x speedup, test set 1.351x speedup, val set 0.930x speedup, step: 43
Epoch 59/300 |loss: 0.001036| train set 2.769x speedup, test set 1.358x speedup, val set 0.916x speedup, step: 44
Epoch 60/300 |loss: 0.001398| train set 2.775x speedup, test set 1.417x speedup, val set 1.043x speedup, step: 45
Epoch 61/300 |loss: 0.001079| train set 2.807x speedup, test set 1.357x speedup, val set 0.916x speedup, step: 46
Epoch 62/300 |loss: 0.001116| train set 2.808x speedup, test set 1.363x speedup, val set 0.841x speedup, step: 47
Epoch 63/300 |loss: 0.000944| train set 2.820x speedup, test set 1.358x speedup, val set 0.927x speedup, step: 48
Epoch 64/300 |loss: 0.001197| train set 2.664x speedup, test set 1.356x speedup, val set 1.026x speedup, step: 49
Epoch 65/300 |loss: 0.001411| train set 2.841x speedup, test set 1.162x speedup, val set 0.933x speedup, step: 50
early stopping at epoch 65
Training per epoch cost 1.193 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 52, train speedup 2.910, test speedup 1.351, val speedup 0.924
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.236, test speedup 1.474, val speedup 1.287
last model at epoch 65, train speedup 2.841, test speedup 1.162, val speedup 0.933
execution cost 0:01:56.522396
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.720819, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007031| train set 0.971x speedup, test set 1.364x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006536| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006190| train set 0.964x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.006030| train set 0.996x speedup, test set 1.353x speedup, val set 1.106x speedup, step: 7
Epoch 11/300 |loss: 0.005770| train set 1.035x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005349| train set 1.044x speedup, test set 1.125x speedup, val set 1.100x speedup, step: 9
Epoch 13/300 |loss: 0.005166| train set 1.061x speedup, test set 1.425x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.004910| train set 1.122x speedup, test set 1.357x speedup, val set 1.069x speedup, step: 11
Epoch 15/300 |loss: 0.005342| train set 1.018x speedup, test set 1.340x speedup, val set 1.019x speedup, step: 12
Epoch 16/300 |loss: 0.004960| train set 1.238x speedup, test set 1.436x speedup, val set 1.126x speedup, step: 13
Epoch 17/300 |loss: 0.004932| train set 0.979x speedup, test set 1.343x speedup, val set 1.092x speedup, step: 14
Epoch 18/300 |loss: 0.004040| train set 1.309x speedup, test set 1.352x speedup, val set 1.267x speedup, step: 1
Epoch 19/300 |loss: 0.004327| train set 1.256x speedup, test set 1.346x speedup, val set 1.187x speedup, step: 2
Epoch 20/300 |loss: 0.003765| train set 2.620x speedup, test set 1.397x speedup, val set 1.001x speedup, step: 3
Epoch 21/300 |loss: 0.003433| train set 1.265x speedup, test set 1.381x speedup, val set 1.109x speedup, step: 4
Epoch 22/300 |loss: 0.003398| train set 2.737x speedup, test set 1.389x speedup, val set 1.133x speedup, step: 5
Epoch 23/300 |loss: 0.003157| train set 2.326x speedup, test set 1.381x speedup, val set 1.066x speedup, step: 6
Epoch 24/300 |loss: 0.003719| train set 2.626x speedup, test set 1.459x speedup, val set 1.187x speedup, step: 7
Epoch 25/300 |loss: 0.003422| train set 2.439x speedup, test set 1.412x speedup, val set 1.133x speedup, step: 8
Epoch 26/300 |loss: 0.003123| train set 2.569x speedup, test set 1.389x speedup, val set 0.983x speedup, step: 9
Epoch 27/300 |loss: 0.002888| train set 2.678x speedup, test set 1.389x speedup, val set 0.979x speedup, step: 10
Epoch 28/300 |loss: 0.002703| train set 2.784x speedup, test set 1.389x speedup, val set 0.947x speedup, step: 11
Epoch 29/300 |loss: 0.002542| train set 2.668x speedup, test set 1.389x speedup, val set 0.935x speedup, step: 12
Epoch 30/300 |loss: 0.002455| train set 2.456x speedup, test set 1.389x speedup, val set 0.947x speedup, step: 13
Epoch 31/300 |loss: 0.002408| train set 2.804x speedup, test set 1.415x speedup, val set 0.938x speedup, step: 14
Epoch 32/300 |loss: 0.002563| train set 2.648x speedup, test set 1.389x speedup, val set 0.831x speedup, step: 15
Epoch 33/300 |loss: 0.002615| train set 2.761x speedup, test set 1.356x speedup, val set 0.885x speedup, step: 16
Epoch 34/300 |loss: 0.002141| train set 2.685x speedup, test set 1.389x speedup, val set 0.950x speedup, step: 17
Epoch 35/300 |loss: 0.002286| train set 2.744x speedup, test set 1.356x speedup, val set 0.947x speedup, step: 18
Epoch 36/300 |loss: 0.002175| train set 2.459x speedup, test set 1.380x speedup, val set 0.951x speedup, step: 19
Epoch 37/300 |loss: 0.002003| train set 2.705x speedup, test set 1.400x speedup, val set 0.950x speedup, step: 20
Epoch 38/300 |loss: 0.001997| train set 2.786x speedup, test set 1.406x speedup, val set 0.948x speedup, step: 21
Epoch 39/300 |loss: 0.002002| train set 2.792x speedup, test set 1.367x speedup, val set 1.044x speedup, step: 22
Epoch 40/300 |loss: 0.002300| train set 2.735x speedup, test set 1.349x speedup, val set 0.951x speedup, step: 23
Epoch 41/300 |loss: 0.001848| train set 2.793x speedup, test set 1.356x speedup, val set 0.952x speedup, step: 24
Epoch 42/300 |loss: 0.001765| train set 2.838x speedup, test set 1.348x speedup, val set 0.947x speedup, step: 25
Epoch 43/300 |loss: 0.001795| train set 2.869x speedup, test set 1.358x speedup, val set 0.951x speedup, step: 26
Epoch 44/300 |loss: 0.001758| train set 2.866x speedup, test set 1.348x speedup, val set 0.938x speedup, step: 27
Epoch 45/300 |loss: 0.001914| train set 2.855x speedup, test set 1.367x speedup, val set 0.832x speedup, step: 28
Epoch 46/300 |loss: 0.001744| train set 2.790x speedup, test set 1.341x speedup, val set 0.943x speedup, step: 29
Epoch 47/300 |loss: 0.001615| train set 2.848x speedup, test set 1.352x speedup, val set 0.948x speedup, step: 30
Epoch 48/300 |loss: 0.001538| train set 2.735x speedup, test set 1.342x speedup, val set 0.943x speedup, step: 31
Epoch 49/300 |loss: 0.001472| train set 2.803x speedup, test set 1.351x speedup, val set 0.942x speedup, step: 32
Epoch 50/300 |loss: 0.001230| train set 2.686x speedup, test set 1.356x speedup, val set 0.939x speedup, step: 33
Epoch 51/300 |loss: 0.001453| train set 2.863x speedup, test set 1.359x speedup, val set 0.942x speedup, step: 34
Epoch 52/300 |loss: 0.001262| train set 2.854x speedup, test set 1.365x speedup, val set 0.933x speedup, step: 35
Epoch 53/300 |loss: 0.001339| train set 2.673x speedup, test set 1.360x speedup, val set 0.948x speedup, step: 36
Epoch 54/300 |loss: 0.001364| train set 2.842x speedup, test set 0.951x speedup, val set 0.925x speedup, step: 37
Epoch 55/300 |loss: 0.001372| train set 2.324x speedup, test set 1.374x speedup, val set 0.931x speedup, step: 38
Epoch 56/300 |loss: 0.001176| train set 2.806x speedup, test set 1.341x speedup, val set 0.936x speedup, step: 39
Epoch 57/300 |loss: 0.001078| train set 2.813x speedup, test set 1.354x speedup, val set 0.936x speedup, step: 40
Epoch 58/300 |loss: 0.001554| train set 2.730x speedup, test set 1.354x speedup, val set 0.943x speedup, step: 41
Epoch 59/300 |loss: 0.001200| train set 2.814x speedup, test set 1.348x speedup, val set 0.948x speedup, step: 42
Epoch 60/300 |loss: 0.001191| train set 2.823x speedup, test set 1.348x speedup, val set 0.929x speedup, step: 43
Epoch 61/300 |loss: 0.001074| train set 2.720x speedup, test set 1.353x speedup, val set 0.936x speedup, step: 44
Epoch 62/300 |loss: 0.001044| train set 2.759x speedup, test set 1.342x speedup, val set 0.928x speedup, step: 45
Epoch 63/300 |loss: 0.000929| train set 2.777x speedup, test set 1.349x speedup, val set 0.917x speedup, step: 46
Epoch 64/300 |loss: 0.001178| train set 2.729x speedup, test set 1.353x speedup, val set 0.933x speedup, step: 47
Epoch 65/300 |loss: 0.001208| train set 2.783x speedup, test set 1.348x speedup, val set 0.912x speedup, step: 48
early stopping at epoch 65
Training per epoch cost 1.205 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 100.428s, pg runtime 87.340s, speedup 0.870x
12, opt runtime 26.602s, model runtime 100.512s, pg runtime 85.447s, speedup 0.850x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.457s, pg runtime 1.438s, speedup 0.987x
20, opt runtime 1.428s, model runtime 1.528s, pg runtime 1.428s, speedup 0.934x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 6.234s, model runtime 10.545s, pg runtime 32.540s, speedup 3.086x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
34, opt runtime 39.191s, model runtime 68.913s, pg runtime 75.984s, speedup 1.103x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 43, train speedup 2.869, test speedup 1.358, val speedup 0.951
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 18, train speedup 1.309, test speedup 1.352, val speedup 1.267
last model at epoch 65, train speedup 2.783, test speedup 1.348, val speedup 0.912
execution cost 0:01:58.053570
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.694060, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010257| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009665| train set 1.488x speedup, test set 2.643x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009258| train set 0.978x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008265| train set 1.453x speedup, test set 2.614x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007578| train set 1.494x speedup, test set 1.372x speedup, val set 1.088x speedup, step: 3
Epoch 7/300 |loss: 0.007042| train set 1.000x speedup, test set 1.336x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006507| train set 1.465x speedup, test set 1.345x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006209| train set 0.986x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005969| train set 0.994x speedup, test set 1.126x speedup, val set 1.124x speedup, step: 7
Epoch 11/300 |loss: 0.005937| train set 1.014x speedup, test set 1.353x speedup, val set 1.092x speedup, step: 8
Epoch 12/300 |loss: 0.005302| train set 1.033x speedup, test set 1.125x speedup, val set 1.087x speedup, step: 9
Epoch 13/300 |loss: 0.005202| train set 1.042x speedup, test set 1.357x speedup, val set 1.024x speedup, step: 10
Epoch 14/300 |loss: 0.005144| train set 1.150x speedup, test set 1.366x speedup, val set 1.043x speedup, step: 11
Epoch 15/300 |loss: 0.005053| train set 1.015x speedup, test set 1.354x speedup, val set 1.079x speedup, step: 12
Epoch 16/300 |loss: 0.004910| train set 1.236x speedup, test set 1.389x speedup, val set 1.268x speedup, step: 1
Epoch 17/300 |loss: 0.005054| train set 0.988x speedup, test set 1.344x speedup, val set 1.056x speedup, step: 2
Epoch 18/300 |loss: 0.004112| train set 1.290x speedup, test set 1.365x speedup, val set 1.020x speedup, step: 3
Epoch 19/300 |loss: 0.004319| train set 1.244x speedup, test set 1.326x speedup, val set 0.996x speedup, step: 4
Epoch 20/300 |loss: 0.003832| train set 1.336x speedup, test set 1.348x speedup, val set 0.996x speedup, step: 5
Epoch 21/300 |loss: 0.003556| train set 1.121x speedup, test set 1.299x speedup, val set 0.955x speedup, step: 6
Epoch 22/300 |loss: 0.003528| train set 2.722x speedup, test set 1.344x speedup, val set 0.950x speedup, step: 7
Epoch 23/300 |loss: 0.003343| train set 2.463x speedup, test set 1.306x speedup, val set 0.987x speedup, step: 8
Epoch 24/300 |loss: 0.004243| train set 2.725x speedup, test set 1.302x speedup, val set 0.968x speedup, step: 9
Epoch 25/300 |loss: 0.003328| train set 2.675x speedup, test set 1.348x speedup, val set 0.968x speedup, step: 10
Epoch 26/300 |loss: 0.003342| train set 2.331x speedup, test set 1.297x speedup, val set 1.039x speedup, step: 11
Epoch 27/300 |loss: 0.002906| train set 2.744x speedup, test set 1.297x speedup, val set 0.948x speedup, step: 12
Epoch 28/300 |loss: 0.002774| train set 2.770x speedup, test set 1.297x speedup, val set 0.949x speedup, step: 13
Epoch 29/300 |loss: 0.002750| train set 2.648x speedup, test set 1.297x speedup, val set 0.921x speedup, step: 14
Epoch 30/300 |loss: 0.002514| train set 2.509x speedup, test set 1.297x speedup, val set 0.854x speedup, step: 15
Epoch 31/300 |loss: 0.002428| train set 2.752x speedup, test set 1.317x speedup, val set 0.833x speedup, step: 16
Epoch 32/300 |loss: 0.002704| train set 2.816x speedup, test set 1.297x speedup, val set 0.959x speedup, step: 17
Epoch 33/300 |loss: 0.002636| train set 2.841x speedup, test set 1.317x speedup, val set 0.863x speedup, step: 18
Epoch 34/300 |loss: 0.002262| train set 2.909x speedup, test set 1.315x speedup, val set 0.826x speedup, step: 19
Epoch 35/300 |loss: 0.002578| train set 2.789x speedup, test set 1.103x speedup, val set 0.995x speedup, step: 20
Epoch 36/300 |loss: 0.002261| train set 2.576x speedup, test set 1.315x speedup, val set 0.822x speedup, step: 21
Epoch 37/300 |loss: 0.001943| train set 2.747x speedup, test set 1.098x speedup, val set 0.822x speedup, step: 22
Epoch 38/300 |loss: 0.002086| train set 2.878x speedup, test set 1.315x speedup, val set 0.822x speedup, step: 23
Epoch 39/300 |loss: 0.001999| train set 2.867x speedup, test set 1.315x speedup, val set 0.818x speedup, step: 24
Epoch 40/300 |loss: 0.002220| train set 2.940x speedup, test set 1.322x speedup, val set 0.823x speedup, step: 25
Epoch 41/300 |loss: 0.001950| train set 2.882x speedup, test set 1.315x speedup, val set 0.815x speedup, step: 26
Epoch 42/300 |loss: 0.001898| train set 2.687x speedup, test set 1.315x speedup, val set 0.823x speedup, step: 27
Epoch 43/300 |loss: 0.002044| train set 2.873x speedup, test set 1.315x speedup, val set 0.823x speedup, step: 28
Epoch 44/300 |loss: 0.001944| train set 2.760x speedup, test set 1.322x speedup, val set 0.822x speedup, step: 29
Epoch 45/300 |loss: 0.001677| train set 2.885x speedup, test set 1.379x speedup, val set 0.823x speedup, step: 30
Epoch 46/300 |loss: 0.001556| train set 2.836x speedup, test set 1.315x speedup, val set 0.850x speedup, step: 31
Epoch 47/300 |loss: 0.001615| train set 2.883x speedup, test set 1.322x speedup, val set 0.839x speedup, step: 32
Epoch 48/300 |loss: 0.001600| train set 2.725x speedup, test set 1.379x speedup, val set 0.833x speedup, step: 33
Epoch 49/300 |loss: 0.001696| train set 2.842x speedup, test set 1.322x speedup, val set 0.921x speedup, step: 34
Epoch 50/300 |loss: 0.001449| train set 2.893x speedup, test set 1.321x speedup, val set 0.822x speedup, step: 35
Epoch 51/300 |loss: 0.001342| train set 2.837x speedup, test set 1.304x speedup, val set 0.839x speedup, step: 36
Epoch 52/300 |loss: 0.001164| train set 2.903x speedup, test set 1.322x speedup, val set 0.815x speedup, step: 37
Epoch 53/300 |loss: 0.001467| train set 2.897x speedup, test set 1.323x speedup, val set 0.823x speedup, step: 38
Epoch 54/300 |loss: 0.001572| train set 2.895x speedup, test set 1.097x speedup, val set 0.816x speedup, step: 39
Epoch 55/300 |loss: 0.001289| train set 2.802x speedup, test set 1.312x speedup, val set 0.559x speedup, step: 40
Epoch 56/300 |loss: 0.001091| train set 2.798x speedup, test set 1.322x speedup, val set 0.554x speedup, step: 41
Epoch 57/300 |loss: 0.001177| train set 2.855x speedup, test set 1.316x speedup, val set 0.558x speedup, step: 42
Epoch 58/300 |loss: 0.001385| train set 2.753x speedup, test set 1.364x speedup, val set 0.558x speedup, step: 43
Epoch 59/300 |loss: 0.001102| train set 2.859x speedup, test set 1.363x speedup, val set 0.557x speedup, step: 44
Epoch 60/300 |loss: 0.001245| train set 2.818x speedup, test set 1.301x speedup, val set 0.558x speedup, step: 45
Epoch 61/300 |loss: 0.001284| train set 2.725x speedup, test set 1.304x speedup, val set 0.841x speedup, step: 46
early stopping at epoch 61
Training per epoch cost 1.190 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 34.379s, pg runtime 21.298s, speedup 0.620x
14, opt runtime 3.258s, model runtime 30.464s, pg runtime 18.141s, speedup 0.595x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 40, train speedup 2.940, test speedup 1.322, val speedup 0.823
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.236, test speedup 1.389, val speedup 1.268
last model at epoch 61, train speedup 2.725, test speedup 1.304, val speedup 0.841
execution cost 0:01:49.993875
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.727782, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007031| train set 0.971x speedup, test set 1.364x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006536| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006192| train set 0.964x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.006018| train set 0.995x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005744| train set 1.025x speedup, test set 1.357x speedup, val set 1.076x speedup, step: 8
Epoch 12/300 |loss: 0.005364| train set 1.030x speedup, test set 1.125x speedup, val set 1.083x speedup, step: 9
Epoch 13/300 |loss: 0.005160| train set 1.063x speedup, test set 1.348x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.004926| train set 1.142x speedup, test set 1.354x speedup, val set 1.088x speedup, step: 11
Epoch 15/300 |loss: 0.005396| train set 1.024x speedup, test set 1.340x speedup, val set 1.099x speedup, step: 12
Epoch 16/300 |loss: 0.004972| train set 1.285x speedup, test set 1.474x speedup, val set 1.268x speedup, step: 1
Epoch 17/300 |loss: 0.005076| train set 1.053x speedup, test set 1.412x speedup, val set 1.083x speedup, step: 2
Epoch 18/300 |loss: 0.004102| train set 1.283x speedup, test set 1.352x speedup, val set 1.187x speedup, step: 3
Epoch 19/300 |loss: 0.004182| train set 1.248x speedup, test set 1.371x speedup, val set 0.989x speedup, step: 4
Epoch 20/300 |loss: 0.003773| train set 2.616x speedup, test set 1.342x speedup, val set 0.979x speedup, step: 5
Epoch 21/300 |loss: 0.003430| train set 2.359x speedup, test set 1.348x speedup, val set 0.964x speedup, step: 6
Epoch 22/300 |loss: 0.003491| train set 2.633x speedup, test set 1.381x speedup, val set 0.983x speedup, step: 7
Epoch 23/300 |loss: 0.003290| train set 2.314x speedup, test set 1.374x speedup, val set 1.133x speedup, step: 8
Epoch 24/300 |loss: 0.004133| train set 2.617x speedup, test set 1.343x speedup, val set 1.024x speedup, step: 9
Epoch 25/300 |loss: 0.003479| train set 2.385x speedup, test set 1.374x speedup, val set 0.982x speedup, step: 10
Epoch 26/300 |loss: 0.003249| train set 2.264x speedup, test set 1.380x speedup, val set 0.934x speedup, step: 11
Epoch 27/300 |loss: 0.002894| train set 2.693x speedup, test set 1.380x speedup, val set 0.930x speedup, step: 12
Epoch 28/300 |loss: 0.002678| train set 2.715x speedup, test set 1.406x speedup, val set 0.839x speedup, step: 13
Epoch 29/300 |loss: 0.002606| train set 2.653x speedup, test set 1.342x speedup, val set 1.036x speedup, step: 14
Epoch 30/300 |loss: 0.002410| train set 2.707x speedup, test set 1.126x speedup, val set 1.047x speedup, step: 15
Epoch 31/300 |loss: 0.002491| train set 2.696x speedup, test set 1.380x speedup, val set 0.798x speedup, step: 16
Epoch 32/300 |loss: 0.002569| train set 2.693x speedup, test set 1.381x speedup, val set 0.927x speedup, step: 17
Epoch 33/300 |loss: 0.002455| train set 2.697x speedup, test set 1.372x speedup, val set 0.986x speedup, step: 18
Epoch 34/300 |loss: 0.002156| train set 2.743x speedup, test set 1.406x speedup, val set 0.981x speedup, step: 19
Epoch 35/300 |loss: 0.004413| train set 2.614x speedup, test set 0.969x speedup, val set 1.049x speedup, step: 20
Epoch 36/300 |loss: 0.003506| train set 2.726x speedup, test set 1.350x speedup, val set 1.127x speedup, step: 21
early stopping at epoch 36
Training per epoch cost 1.203 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 34, train speedup 2.743, test speedup 1.406, val speedup 0.981
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.285, test speedup 1.474, val speedup 1.268
last model at epoch 36, train speedup 2.726, test speedup 1.350, val speedup 1.127
execution cost 0:01:09.135581
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.678239, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008262| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007591| train set 1.475x speedup, test set 1.372x speedup, val set 1.107x speedup, step: 3
Epoch 7/300 |loss: 0.007030| train set 0.971x speedup, test set 1.370x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006547| train set 1.537x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006178| train set 0.981x speedup, test set 1.128x speedup, val set 1.084x speedup, step: 6
Epoch 10/300 |loss: 0.005994| train set 0.998x speedup, test set 1.125x speedup, val set 1.107x speedup, step: 7
Epoch 11/300 |loss: 0.005776| train set 1.029x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005351| train set 1.020x speedup, test set 1.125x speedup, val set 1.085x speedup, step: 9
Epoch 13/300 |loss: 0.005174| train set 1.065x speedup, test set 1.327x speedup, val set 1.036x speedup, step: 10
Epoch 14/300 |loss: 0.005133| train set 1.048x speedup, test set 1.366x speedup, val set 1.070x speedup, step: 11
Epoch 15/300 |loss: 0.005044| train set 1.024x speedup, test set 1.366x speedup, val set 1.049x speedup, step: 12
Epoch 16/300 |loss: 0.004723| train set 1.252x speedup, test set 1.378x speedup, val set 1.161x speedup, step: 1
Epoch 17/300 |loss: 0.004866| train set 1.069x speedup, test set 1.351x speedup, val set 1.078x speedup, step: 2
Epoch 18/300 |loss: 0.004079| train set 1.297x speedup, test set 1.352x speedup, val set 0.979x speedup, step: 3
Epoch 19/300 |loss: 0.004353| train set 1.269x speedup, test set 1.313x speedup, val set 0.979x speedup, step: 4
Epoch 20/300 |loss: 0.003653| train set 1.277x speedup, test set 1.324x speedup, val set 1.118x speedup, step: 5
Epoch 21/300 |loss: 0.003446| train set 1.227x speedup, test set 1.388x speedup, val set 0.970x speedup, step: 6
Epoch 22/300 |loss: 0.003463| train set 2.411x speedup, test set 1.323x speedup, val set 1.133x speedup, step: 7
Epoch 23/300 |loss: 0.003131| train set 2.303x speedup, test set 1.317x speedup, val set 0.988x speedup, step: 8
Epoch 24/300 |loss: 0.003956| train set 2.648x speedup, test set 1.347x speedup, val set 1.082x speedup, step: 9
Epoch 25/300 |loss: 0.003535| train set 2.400x speedup, test set 1.323x speedup, val set 1.001x speedup, step: 10
Epoch 26/300 |loss: 0.003137| train set 2.612x speedup, test set 1.317x speedup, val set 0.832x speedup, step: 11
Epoch 27/300 |loss: 0.003150| train set 2.629x speedup, test set 1.294x speedup, val set 0.842x speedup, step: 12
Epoch 28/300 |loss: 0.002650| train set 2.706x speedup, test set 1.348x speedup, val set 0.843x speedup, step: 13
Epoch 29/300 |loss: 0.002722| train set 2.427x speedup, test set 1.357x speedup, val set 0.808x speedup, step: 14
Epoch 30/300 |loss: 0.002490| train set 2.495x speedup, test set 1.356x speedup, val set 0.836x speedup, step: 15
Epoch 31/300 |loss: 0.002363| train set 2.343x speedup, test set 1.372x speedup, val set 0.834x speedup, step: 16
Epoch 32/300 |loss: 0.002981| train set 2.420x speedup, test set 1.386x speedup, val set 0.839x speedup, step: 17
Epoch 33/300 |loss: 0.002368| train set 2.746x speedup, test set 1.348x speedup, val set 0.839x speedup, step: 18
Epoch 34/300 |loss: 0.002180| train set 2.868x speedup, test set 1.417x speedup, val set 0.835x speedup, step: 19
Epoch 35/300 |loss: 0.002150| train set 2.840x speedup, test set 1.348x speedup, val set 0.839x speedup, step: 20
Epoch 36/300 |loss: 0.002278| train set 2.459x speedup, test set 1.355x speedup, val set 0.839x speedup, step: 21
Epoch 37/300 |loss: 0.001962| train set 2.763x speedup, test set 1.322x speedup, val set 0.841x speedup, step: 22
Epoch 38/300 |loss: 0.001964| train set 2.877x speedup, test set 1.355x speedup, val set 0.839x speedup, step: 23
Epoch 39/300 |loss: 0.001929| train set 2.841x speedup, test set 1.381x speedup, val set 0.835x speedup, step: 24
Epoch 40/300 |loss: 0.002030| train set 2.867x speedup, test set 1.363x speedup, val set 0.839x speedup, step: 25
Epoch 41/300 |loss: 0.001900| train set 2.871x speedup, test set 1.427x speedup, val set 0.829x speedup, step: 26
Epoch 42/300 |loss: 0.001740| train set 2.800x speedup, test set 1.391x speedup, val set 0.839x speedup, step: 27
Epoch 43/300 |loss: 0.001953| train set 2.845x speedup, test set 1.363x speedup, val set 0.839x speedup, step: 28
Epoch 44/300 |loss: 0.001675| train set 2.689x speedup, test set 1.363x speedup, val set 0.828x speedup, step: 29
Epoch 45/300 |loss: 0.001870| train set 2.758x speedup, test set 1.386x speedup, val set 0.835x speedup, step: 30
Epoch 46/300 |loss: 0.001792| train set 2.842x speedup, test set 1.433x speedup, val set 0.842x speedup, step: 31
Epoch 47/300 |loss: 0.001581| train set 2.939x speedup, test set 1.433x speedup, val set 0.839x speedup, step: 32
Epoch 48/300 |loss: 0.001634| train set 2.819x speedup, test set 1.438x speedup, val set 0.831x speedup, step: 33
Epoch 49/300 |loss: 0.001444| train set 2.902x speedup, test set 1.441x speedup, val set 0.843x speedup, step: 34
Epoch 50/300 |loss: 0.001309| train set 2.856x speedup, test set 1.441x speedup, val set 0.837x speedup, step: 35
Epoch 51/300 |loss: 0.001566| train set 2.948x speedup, test set 1.456x speedup, val set 0.842x speedup, step: 36
Epoch 52/300 |loss: 0.001211| train set 2.922x speedup, test set 1.366x speedup, val set 0.834x speedup, step: 37
Epoch 53/300 |loss: 0.001231| train set 2.792x speedup, test set 1.371x speedup, val set 0.839x speedup, step: 38
Epoch 54/300 |loss: 0.001305| train set 2.760x speedup, test set 1.366x speedup, val set 0.833x speedup, step: 39
Epoch 55/300 |loss: 0.001458| train set 2.855x speedup, test set 1.311x speedup, val set 0.971x speedup, step: 40
Epoch 56/300 |loss: 0.001138| train set 2.850x speedup, test set 1.379x speedup, val set 0.936x speedup, step: 41
Epoch 57/300 |loss: 0.001195| train set 2.906x speedup, test set 1.371x speedup, val set 0.843x speedup, step: 42
Epoch 58/300 |loss: 0.001517| train set 2.741x speedup, test set 1.409x speedup, val set 0.975x speedup, step: 43
Epoch 59/300 |loss: 0.001126| train set 2.726x speedup, test set 1.334x speedup, val set 0.859x speedup, step: 44
Epoch 60/300 |loss: 0.001195| train set 2.839x speedup, test set 1.393x speedup, val set 0.936x speedup, step: 45
Epoch 61/300 |loss: 0.001159| train set 2.847x speedup, test set 1.393x speedup, val set 0.951x speedup, step: 46
Epoch 62/300 |loss: 0.000991| train set 2.869x speedup, test set 1.380x speedup, val set 0.843x speedup, step: 47
Epoch 63/300 |loss: 0.001067| train set 2.778x speedup, test set 1.358x speedup, val set 0.952x speedup, step: 48
Epoch 64/300 |loss: 0.001166| train set 2.666x speedup, test set 1.358x speedup, val set 0.940x speedup, step: 49
Epoch 65/300 |loss: 0.001345| train set 2.841x speedup, test set 1.377x speedup, val set 0.567x speedup, step: 50
early stopping at epoch 65
Training per epoch cost 1.198 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 34.379s, pg runtime 21.298s, speedup 0.620x
14, opt runtime 3.258s, model runtime 30.464s, pg runtime 18.141s, speedup 0.595x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 51, train speedup 2.948, test speedup 1.456, val speedup 0.842
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.252, test speedup 1.378, val speedup 1.161
last model at epoch 65, train speedup 2.841, test speedup 1.377, val speedup 0.567
execution cost 0:01:56.902378
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.680494, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008261| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007585| train set 1.470x speedup, test set 1.372x speedup, val set 1.085x speedup, step: 3
Epoch 7/300 |loss: 0.007031| train set 0.971x speedup, test set 1.364x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006536| train set 1.469x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006195| train set 0.964x speedup, test set 1.127x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005986| train set 0.996x speedup, test set 1.125x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005699| train set 1.034x speedup, test set 1.357x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005372| train set 1.032x speedup, test set 1.125x speedup, val set 1.083x speedup, step: 9
Epoch 13/300 |loss: 0.005293| train set 1.091x speedup, test set 1.354x speedup, val set 1.044x speedup, step: 10
Epoch 14/300 |loss: 0.005088| train set 1.118x speedup, test set 1.366x speedup, val set 1.012x speedup, step: 11
Epoch 15/300 |loss: 0.004946| train set 0.980x speedup, test set 1.350x speedup, val set 0.978x speedup, step: 12
Epoch 16/300 |loss: 0.004864| train set 1.255x speedup, test set 1.474x speedup, val set 1.178x speedup, step: 1
Epoch 17/300 |loss: 0.005093| train set 1.056x speedup, test set 1.335x speedup, val set 0.982x speedup, step: 2
Epoch 18/300 |loss: 0.004063| train set 1.291x speedup, test set 1.352x speedup, val set 1.001x speedup, step: 3
Epoch 19/300 |loss: 0.004250| train set 1.248x speedup, test set 1.409x speedup, val set 1.118x speedup, step: 4
Epoch 20/300 |loss: 0.003720| train set 2.436x speedup, test set 1.387x speedup, val set 1.001x speedup, step: 5
Epoch 21/300 |loss: 0.003390| train set 1.208x speedup, test set 1.359x speedup, val set 0.971x speedup, step: 6
Epoch 22/300 |loss: 0.003431| train set 2.745x speedup, test set 1.381x speedup, val set 1.001x speedup, step: 7
Epoch 23/300 |loss: 0.003138| train set 2.341x speedup, test set 1.349x speedup, val set 1.133x speedup, step: 8
Epoch 24/300 |loss: 0.003720| train set 2.505x speedup, test set 1.371x speedup, val set 1.133x speedup, step: 9
Epoch 25/300 |loss: 0.003276| train set 2.673x speedup, test set 1.389x speedup, val set 1.104x speedup, step: 10
Epoch 26/300 |loss: 0.002861| train set 2.639x speedup, test set 1.355x speedup, val set 0.978x speedup, step: 11
Epoch 27/300 |loss: 0.002964| train set 2.737x speedup, test set 1.348x speedup, val set 0.984x speedup, step: 12
Epoch 28/300 |loss: 0.002821| train set 2.699x speedup, test set 1.389x speedup, val set 0.917x speedup, step: 13
Epoch 29/300 |loss: 0.002649| train set 2.555x speedup, test set 1.370x speedup, val set 0.903x speedup, step: 14
Epoch 30/300 |loss: 0.002516| train set 2.454x speedup, test set 1.143x speedup, val set 0.913x speedup, step: 15
Epoch 31/300 |loss: 0.002437| train set 2.586x speedup, test set 1.380x speedup, val set 0.927x speedup, step: 16
Epoch 32/300 |loss: 0.002682| train set 2.403x speedup, test set 1.356x speedup, val set 0.910x speedup, step: 17
Epoch 33/300 |loss: 0.002528| train set 2.806x speedup, test set 1.356x speedup, val set 0.917x speedup, step: 18
Epoch 34/300 |loss: 0.002156| train set 2.667x speedup, test set 1.356x speedup, val set 1.010x speedup, step: 19
Epoch 35/300 |loss: 0.002353| train set 2.697x speedup, test set 1.126x speedup, val set 0.933x speedup, step: 20
Epoch 36/300 |loss: 0.002195| train set 2.495x speedup, test set 1.134x speedup, val set 0.913x speedup, step: 21
Epoch 37/300 |loss: 0.002019| train set 2.843x speedup, test set 1.425x speedup, val set 0.913x speedup, step: 22
Epoch 38/300 |loss: 0.001930| train set 2.853x speedup, test set 1.425x speedup, val set 0.819x speedup, step: 23
Epoch 39/300 |loss: 0.001855| train set 2.894x speedup, test set 1.425x speedup, val set 0.917x speedup, step: 24
Epoch 40/300 |loss: 0.002088| train set 2.767x speedup, test set 1.174x speedup, val set 0.934x speedup, step: 25
Epoch 41/300 |loss: 0.001984| train set 2.833x speedup, test set 1.134x speedup, val set 0.938x speedup, step: 26
Epoch 42/300 |loss: 0.001847| train set 2.816x speedup, test set 1.367x speedup, val set 0.823x speedup, step: 27
Epoch 43/300 |loss: 0.002101| train set 2.835x speedup, test set 1.411x speedup, val set 0.835x speedup, step: 28
Epoch 44/300 |loss: 0.001758| train set 2.728x speedup, test set 1.413x speedup, val set 0.819x speedup, step: 29
Epoch 45/300 |loss: 0.001747| train set 2.836x speedup, test set 1.154x speedup, val set 0.904x speedup, step: 30
Epoch 46/300 |loss: 0.001669| train set 2.879x speedup, test set 1.134x speedup, val set 0.929x speedup, step: 31
Epoch 47/300 |loss: 0.001582| train set 2.887x speedup, test set 1.144x speedup, val set 0.827x speedup, step: 32
Epoch 48/300 |loss: 0.001513| train set 2.873x speedup, test set 1.134x speedup, val set 0.830x speedup, step: 33
Epoch 49/300 |loss: 0.001712| train set 2.846x speedup, test set 1.372x speedup, val set 0.842x speedup, step: 34
Epoch 50/300 |loss: 0.001544| train set 2.760x speedup, test set 1.175x speedup, val set 0.907x speedup, step: 35
Epoch 51/300 |loss: 0.001513| train set 2.825x speedup, test set 1.400x speedup, val set 0.842x speedup, step: 36
Epoch 52/300 |loss: 0.001248| train set 2.828x speedup, test set 1.468x speedup, val set 0.830x speedup, step: 37
Epoch 53/300 |loss: 0.001473| train set 2.605x speedup, test set 1.182x speedup, val set 0.948x speedup, step: 38
Epoch 54/300 |loss: 0.001408| train set 2.741x speedup, test set 1.148x speedup, val set 0.838x speedup, step: 39
Epoch 55/300 |loss: 0.001303| train set 2.639x speedup, test set 1.400x speedup, val set 0.913x speedup, step: 40
Epoch 56/300 |loss: 0.001344| train set 2.806x speedup, test set 1.387x speedup, val set 0.831x speedup, step: 41
Epoch 57/300 |loss: 0.001307| train set 2.822x speedup, test set 1.387x speedup, val set 0.859x speedup, step: 42
Epoch 58/300 |loss: 0.001632| train set 2.705x speedup, test set 1.420x speedup, val set 0.843x speedup, step: 43
Epoch 59/300 |loss: 0.001125| train set 2.775x speedup, test set 1.408x speedup, val set 0.854x speedup, step: 44
Epoch 60/300 |loss: 0.001271| train set 2.815x speedup, test set 1.378x speedup, val set 0.938x speedup, step: 45
Epoch 61/300 |loss: 0.001110| train set 2.788x speedup, test set 1.143x speedup, val set 0.928x speedup, step: 46
Epoch 62/300 |loss: 0.001025| train set 2.710x speedup, test set 1.420x speedup, val set 0.840x speedup, step: 47
Epoch 63/300 |loss: 0.000896| train set 2.706x speedup, test set 1.408x speedup, val set 0.838x speedup, step: 48
Epoch 64/300 |loss: 0.001200| train set 2.711x speedup, test set 1.151x speedup, val set 0.920x speedup, step: 49
Epoch 65/300 |loss: 0.001509| train set 2.619x speedup, test set 1.093x speedup, val set 0.831x speedup, step: 50
Epoch 66/300 |loss: 0.001167| train set 2.831x speedup, test set 1.404x speedup, val set 0.838x speedup, step: 51
Epoch 67/300 |loss: 0.001452| train set 2.743x speedup, test set 2.526x speedup, val set 0.843x speedup, step: 52
Epoch 68/300 |loss: 0.001500| train set 2.831x speedup, test set 1.375x speedup, val set 1.065x speedup, step: 53
early stopping at epoch 68
Training per epoch cost 1.207 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
22, opt runtime 20.897s, model runtime 42.847s, pg runtime 23.708s, speedup 0.553x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 39, train speedup 2.894, test speedup 1.425, val speedup 0.917
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.255, test speedup 1.474, val speedup 1.178
last model at epoch 68, train speedup 2.831, test speedup 1.375, val speedup 1.065
execution cost 0:02:00.790743
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.662355, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.029521| train set 0.996x speedup, test set 2.690x speedup, val set 1.063x speedup, step: 1
Epoch 1/300 |loss: 0.011931| train set 0.971x speedup, test set 2.508x speedup, val set 1.063x speedup, step: 1
Epoch 2/300 |loss: 0.010259| train set 0.971x speedup, test set 2.565x speedup, val set 1.063x speedup, step: 1
Epoch 3/300 |loss: 0.009659| train set 1.487x speedup, test set 2.636x speedup, val set 1.060x speedup, step: 2
Epoch 4/300 |loss: 0.009280| train set 0.958x speedup, test set 2.583x speedup, val set 1.127x speedup, step: 1
Epoch 5/300 |loss: 0.008262| train set 0.963x speedup, test set 2.548x speedup, val set 1.083x speedup, step: 2
Epoch 6/300 |loss: 0.007589| train set 1.494x speedup, test set 1.372x speedup, val set 1.107x speedup, step: 3
Epoch 7/300 |loss: 0.007017| train set 0.971x speedup, test set 1.361x speedup, val set 1.084x speedup, step: 4
Epoch 8/300 |loss: 0.006522| train set 1.522x speedup, test set 1.371x speedup, val set 1.077x speedup, step: 5
Epoch 9/300 |loss: 0.006207| train set 0.961x speedup, test set 1.128x speedup, val set 1.077x speedup, step: 6
Epoch 10/300 |loss: 0.005988| train set 0.981x speedup, test set 1.126x speedup, val set 1.084x speedup, step: 7
Epoch 11/300 |loss: 0.005719| train set 0.997x speedup, test set 1.353x speedup, val set 1.090x speedup, step: 8
Epoch 12/300 |loss: 0.005342| train set 1.031x speedup, test set 1.125x speedup, val set 1.025x speedup, step: 9
Epoch 13/300 |loss: 0.005239| train set 1.060x speedup, test set 1.391x speedup, val set 1.023x speedup, step: 10
Epoch 14/300 |loss: 0.005182| train set 1.071x speedup, test set 1.362x speedup, val set 1.069x speedup, step: 11
Epoch 15/300 |loss: 0.005007| train set 0.964x speedup, test set 1.350x speedup, val set 1.070x speedup, step: 12
Epoch 16/300 |loss: 0.004844| train set 1.232x speedup, test set 1.487x speedup, val set 1.177x speedup, step: 1
Epoch 17/300 |loss: 0.004980| train set 0.987x speedup, test set 1.331x speedup, val set 0.992x speedup, step: 2
Epoch 18/300 |loss: 0.004043| train set 1.298x speedup, test set 1.352x speedup, val set 1.032x speedup, step: 3
Epoch 19/300 |loss: 0.004314| train set 1.254x speedup, test set 1.350x speedup, val set 0.991x speedup, step: 4
Epoch 20/300 |loss: 0.003729| train set 1.289x speedup, test set 1.326x speedup, val set 0.840x speedup, step: 5
Epoch 21/300 |loss: 0.003430| train set 1.183x speedup, test set 1.391x speedup, val set 0.809x speedup, step: 6
Epoch 22/300 |loss: 0.003396| train set 2.540x speedup, test set 1.389x speedup, val set 0.949x speedup, step: 7
Epoch 23/300 |loss: 0.003168| train set 2.316x speedup, test set 1.333x speedup, val set 0.974x speedup, step: 8
Epoch 24/300 |loss: 0.003895| train set 2.762x speedup, test set 1.352x speedup, val set 1.066x speedup, step: 9
Epoch 25/300 |loss: 0.003475| train set 2.419x speedup, test set 1.331x speedup, val set 0.945x speedup, step: 10
Epoch 26/300 |loss: 0.002966| train set 2.633x speedup, test set 1.360x speedup, val set 0.983x speedup, step: 11
Epoch 27/300 |loss: 0.003131| train set 2.741x speedup, test set 1.356x speedup, val set 0.833x speedup, step: 12
Epoch 28/300 |loss: 0.002726| train set 2.644x speedup, test set 1.389x speedup, val set 0.839x speedup, step: 13
Epoch 29/300 |loss: 0.002668| train set 2.750x speedup, test set 1.356x speedup, val set 0.838x speedup, step: 14
Epoch 30/300 |loss: 0.002447| train set 2.460x speedup, test set 1.413x speedup, val set 0.838x speedup, step: 15
Epoch 31/300 |loss: 0.002439| train set 2.372x speedup, test set 1.415x speedup, val set 0.850x speedup, step: 16
Epoch 32/300 |loss: 0.002792| train set 2.385x speedup, test set 1.391x speedup, val set 0.842x speedup, step: 17
Epoch 33/300 |loss: 0.002443| train set 2.791x speedup, test set 1.391x speedup, val set 0.839x speedup, step: 18
Epoch 34/300 |loss: 0.002176| train set 2.896x speedup, test set 1.391x speedup, val set 0.841x speedup, step: 19
Epoch 35/300 |loss: 0.002291| train set 2.734x speedup, test set 1.367x speedup, val set 0.933x speedup, step: 20
Epoch 36/300 |loss: 0.002348| train set 2.468x speedup, test set 1.415x speedup, val set 0.839x speedup, step: 21
Epoch 37/300 |loss: 0.002121| train set 2.765x speedup, test set 1.359x speedup, val set 0.950x speedup, step: 22
Epoch 38/300 |loss: 0.002230| train set 2.810x speedup, test set 1.382x speedup, val set 0.842x speedup, step: 23
Epoch 39/300 |loss: 0.002117| train set 2.865x speedup, test set 1.391x speedup, val set 0.835x speedup, step: 24
Epoch 40/300 |loss: 0.002219| train set 2.768x speedup, test set 1.425x speedup, val set 0.942x speedup, step: 25
Epoch 41/300 |loss: 0.001942| train set 2.844x speedup, test set 1.371x speedup, val set 0.938x speedup, step: 26
Epoch 42/300 |loss: 0.001978| train set 2.836x speedup, test set 1.303x speedup, val set 0.835x speedup, step: 27
Epoch 43/300 |loss: 0.001864| train set 2.883x speedup, test set 1.448x speedup, val set 0.951x speedup, step: 28
Epoch 44/300 |loss: 0.002029| train set 2.722x speedup, test set 1.353x speedup, val set 0.842x speedup, step: 29
Epoch 45/300 |loss: 0.001762| train set 2.773x speedup, test set 1.352x speedup, val set 0.839x speedup, step: 30
Epoch 46/300 |loss: 0.001644| train set 2.802x speedup, test set 1.370x speedup, val set 0.842x speedup, step: 31
Epoch 47/300 |loss: 0.001691| train set 2.869x speedup, test set 1.366x speedup, val set 0.838x speedup, step: 32
Epoch 48/300 |loss: 0.001650| train set 2.796x speedup, test set 1.356x speedup, val set 0.838x speedup, step: 33
Epoch 49/300 |loss: 0.001428| train set 2.922x speedup, test set 1.356x speedup, val set 0.842x speedup, step: 34
Epoch 50/300 |loss: 0.001280| train set 2.597x speedup, test set 1.421x speedup, val set 0.872x speedup, step: 35
Epoch 51/300 |loss: 0.001384| train set 2.800x speedup, test set 1.421x speedup, val set 0.938x speedup, step: 36
Epoch 52/300 |loss: 0.001247| train set 2.850x speedup, test set 1.421x speedup, val set 0.923x speedup, step: 37
Epoch 53/300 |loss: 0.001244| train set 2.649x speedup, test set 1.169x speedup, val set 0.984x speedup, step: 38
Epoch 54/300 |loss: 0.001391| train set 2.784x speedup, test set 1.183x speedup, val set 0.869x speedup, step: 39
Epoch 55/300 |loss: 0.001369| train set 2.728x speedup, test set 1.438x speedup, val set 0.838x speedup, step: 40
Epoch 56/300 |loss: 0.001115| train set 2.851x speedup, test set 1.425x speedup, val set 0.830x speedup, step: 41
Epoch 57/300 |loss: 0.001282| train set 2.866x speedup, test set 1.418x speedup, val set 0.842x speedup, step: 42
Epoch 58/300 |loss: 0.001470| train set 2.778x speedup, test set 1.443x speedup, val set 0.952x speedup, step: 43
Epoch 59/300 |loss: 0.001287| train set 2.758x speedup, test set 1.426x speedup, val set 0.842x speedup, step: 44
early stopping at epoch 59
Training per epoch cost 1.205 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 102.086s, pg runtime 148.707s, speedup 1.457x
16, opt runtime 53.440s, model runtime 99.251s, pg runtime 140.742s, speedup 1.418x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 49, train speedup 2.922, test speedup 1.356, val speedup 0.842
best test speedup epoch: 0, train speedup 0.996, test speedup 2.690, val speedup 1.063
best validation speedup epoch: 16, train speedup 1.232, test speedup 1.487, val speedup 1.177
last model at epoch 59, train speedup 2.758, test speedup 1.426, val speedup 0.842
execution cost 0:01:47.398640
==================================================
