all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.220239, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414686| train set 1.038x speedup, test set 2.552x speedup, val set 0.988x speedup, step: 1, train time 17.84 s
Epoch 1/50 |loss: 0.338163| train set 1.836x speedup, test set 2.454x speedup, val set 0.983x speedup, step: 2, train time 15.24 s
Epoch 2/50 |loss: 0.304502| train set 2.230x speedup, test set 2.488x speedup, val set 0.891x speedup, step: 3, train time 15.22 s
Epoch 3/50 |loss: 0.282004| train set 2.470x speedup, test set 2.786x speedup, val set 0.870x speedup, step: 4, train time 15.21 s
Epoch 4/50 |loss: 0.265823| train set 2.452x speedup, test set 2.583x speedup, val set 1.065x speedup, step: 1, train time 15.93 s
Epoch 5/50 |loss: 0.248107| train set 2.044x speedup, test set 2.616x speedup, val set 0.987x speedup, step: 2, train time 15.10 s
Epoch 6/50 |loss: 0.236892| train set 2.773x speedup, test set 2.630x speedup, val set 0.833x speedup, step: 3, train time 15.03 s
Epoch 7/50 |loss: 0.227065| train set 2.227x speedup, test set 2.575x speedup, val set 0.835x speedup, step: 4, train time 15.32 s
Epoch 8/50 |loss: 0.207698| train set 2.686x speedup, test set 1.710x speedup, val set 0.819x speedup, step: 5, train time 15.14 s
Epoch 9/50 |loss: 0.205171| train set 2.805x speedup, test set 2.723x speedup, val set 0.948x speedup, step: 6, train time 15.06 s
Epoch 10/50 |loss: 0.203072| train set 2.774x speedup, test set 1.636x speedup, val set 0.812x speedup, step: 7, train time 15.03 s
Epoch 11/50 |loss: 0.185504| train set 2.715x speedup, test set 2.622x speedup, val set 0.971x speedup, step: 8, train time 15.13 s
Epoch 12/50 |loss: 0.184234| train set 2.610x speedup, test set 1.681x speedup, val set 0.923x speedup, step: 9, train time 15.11 s
Epoch 13/50 |loss: 0.181243| train set 2.694x speedup, test set 1.411x speedup, val set 0.924x speedup, step: 10, train time 15.12 s
Epoch 14/50 |loss: 0.179042| train set 2.765x speedup, test set 2.508x speedup, val set 0.983x speedup, step: 11, train time 15.14 s
Epoch 15/50 |loss: 0.165771| train set 2.639x speedup, test set 1.406x speedup, val set 0.830x speedup, step: 12, train time 15.03 s
Epoch 16/50 |loss: 0.160775| train set 2.937x speedup, test set 1.633x speedup, val set 0.822x speedup, step: 13, train time 15.32 s
Epoch 17/50 |loss: 0.154490| train set 2.669x speedup, test set 1.612x speedup, val set 0.822x speedup, step: 14, train time 15.23 s
Epoch 18/50 |loss: 0.150545| train set 2.951x speedup, test set 1.613x speedup, val set 0.933x speedup, step: 15, train time 15.01 s
Epoch 19/50 |loss: 0.147945| train set 2.953x speedup, test set 1.665x speedup, val set 0.933x speedup, step: 16, train time 14.66 s
Epoch 20/50 |loss: 0.148469| train set 2.868x speedup, test set 1.430x speedup, val set 0.822x speedup, step: 17, train time 14.84 s
Epoch 21/50 |loss: 0.134751| train set 2.529x speedup, test set 1.382x speedup, val set 0.967x speedup, step: 18, train time 15.04 s
Epoch 22/50 |loss: 0.134705| train set 2.815x speedup, test set 1.602x speedup, val set 0.822x speedup, step: 19, train time 15.34 s
Epoch 23/50 |loss: 0.126737| train set 2.966x speedup, test set 1.639x speedup, val set 0.811x speedup, step: 20, train time 14.91 s
Epoch 24/50 |loss: 0.127701| train set 2.984x speedup, test set 1.382x speedup, val set 0.822x speedup, step: 21, train time 15.05 s
Epoch 25/50 |loss: 0.126789| train set 2.911x speedup, test set 1.663x speedup, val set 0.908x speedup, step: 22, train time 15.02 s
Epoch 26/50 |loss: 0.131069| train set 2.961x speedup, test set 1.666x speedup, val set 0.822x speedup, step: 23, train time 15.14 s
Epoch 27/50 |loss: 0.122913| train set 2.812x speedup, test set 2.420x speedup, val set 0.971x speedup, step: 24, train time 15.23 s
Epoch 28/50 |loss: 0.118829| train set 2.964x speedup, test set 1.694x speedup, val set 0.933x speedup, step: 25, train time 15.32 s
Epoch 29/50 |loss: 0.119761| train set 2.930x speedup, test set 1.649x speedup, val set 1.061x speedup, step: 26, train time 15.12 s
Epoch 30/50 |loss: 0.120213| train set 2.883x speedup, test set 1.377x speedup, val set 0.971x speedup, step: 27, train time 15.22 s
Epoch 31/50 |loss: 0.109604| train set 2.952x speedup, test set 2.659x speedup, val set 1.231x speedup, step: 28, train time 15.11 s
Epoch 32/50 |loss: 0.109762| train set 3.022x speedup, test set 1.395x speedup, val set 0.811x speedup, step: 29, train time 15.11 s
Epoch 33/50 |loss: 0.105145| train set 3.016x speedup, test set 1.672x speedup, val set 0.811x speedup, step: 30, train time 15.02 s
Epoch 34/50 |loss: 0.107701| train set 3.045x speedup, test set 1.379x speedup, val set 0.957x speedup, step: 31, train time 15.11 s
Epoch 35/50 |loss: 0.105881| train set 2.910x speedup, test set 1.426x speedup, val set 1.077x speedup, step: 32, train time 15.03 s
Epoch 36/50 |loss: 0.102698| train set 2.812x speedup, test set 1.385x speedup, val set 1.026x speedup, step: 33, train time 15.15 s
Epoch 37/50 |loss: 0.100670| train set 2.988x speedup, test set 1.429x speedup, val set 1.153x speedup, step: 34, train time 15.25 s
Epoch 38/50 |loss: 0.104651| train set 2.985x speedup, test set 2.501x speedup, val set 0.957x speedup, step: 35, train time 15.45 s
Epoch 39/50 |loss: 0.096008| train set 3.020x speedup, test set 2.480x speedup, val set 0.957x speedup, step: 36, train time 15.30 s
Epoch 40/50 |loss: 0.096002| train set 3.028x speedup, test set 1.375x speedup, val set 0.811x speedup, step: 37, train time 15.13 s
Epoch 41/50 |loss: 0.094643| train set 2.846x speedup, test set 2.497x speedup, val set 0.957x speedup, step: 38, train time 15.31 s
Epoch 42/50 |loss: 0.098609| train set 3.004x speedup, test set 2.474x speedup, val set 1.077x speedup, step: 39, train time 15.07 s
Epoch 43/50 |loss: 0.093229| train set 2.819x speedup, test set 2.491x speedup, val set 1.127x speedup, step: 40, train time 15.14 s
Epoch 44/50 |loss: 0.092159| train set 2.986x speedup, test set 1.446x speedup, val set 1.061x speedup, step: 41, train time 15.15 s
Epoch 45/50 |loss: 0.095552| train set 3.014x speedup, test set 1.394x speedup, val set 0.971x speedup, step: 42, train time 15.23 s
Epoch 46/50 |loss: 0.090951| train set 2.949x speedup, test set 2.580x speedup, val set 0.971x speedup, step: 43, train time 15.33 s
Epoch 47/50 |loss: 0.094922| train set 2.997x speedup, test set 1.377x speedup, val set 1.026x speedup, step: 44, train time 15.03 s
Epoch 48/50 |loss: 0.089958| train set 2.878x speedup, test set 1.368x speedup, val set 0.971x speedup, step: 45, train time 15.41 s
Epoch 49/50 |loss: 0.091234| train set 2.871x speedup, test set 1.360x speedup, val set 0.957x speedup, step: 46, train time 15.21 s
Training per epoch cost 15.213 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
08, opt runtime 7.377s, model runtime 37.574s, pg runtime 28.655s, speedup 0.763x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 11.791s, pg runtime 5.572s, speedup 0.473x
30, opt runtime 5.539s, model runtime 10.142s, pg runtime 5.539s, speedup 0.546x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 34, train speedup 3.045, test speedup 1.379, val speedup 0.957
best test speedup epoch: 3, train speedup 2.470, test speedup 2.786, val speedup 0.870
best validation speedup epoch: 4, train speedup 2.452, test speedup 2.583, val speedup 1.065
last model at epoch 49, train speedup 2.871, test speedup 1.360, val speedup 0.957
execution cost 0:14:02.509063
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.475535, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414329| train set 1.038x speedup, test set 2.552x speedup, val set 0.983x speedup, step: 1, train time 17.66 s
Epoch 1/50 |loss: 0.339056| train set 1.113x speedup, test set 2.477x speedup, val set 0.985x speedup, step: 2, train time 15.15 s
Epoch 2/50 |loss: 0.308106| train set 2.147x speedup, test set 2.514x speedup, val set 0.983x speedup, step: 3, train time 15.13 s
Epoch 3/50 |loss: 0.280596| train set 2.328x speedup, test set 2.513x speedup, val set 1.045x speedup, step: 4, train time 15.11 s
Epoch 4/50 |loss: 0.267134| train set 2.112x speedup, test set 1.372x speedup, val set 0.809x speedup, step: 1, train time 15.83 s
Epoch 5/50 |loss: 0.247636| train set 2.253x speedup, test set 2.576x speedup, val set 0.833x speedup, step: 2, train time 15.03 s
Epoch 6/50 |loss: 0.233474| train set 2.697x speedup, test set 2.727x speedup, val set 1.153x speedup, step: 3, train time 15.05 s
Epoch 7/50 |loss: 0.225199| train set 2.301x speedup, test set 1.387x speedup, val set 0.951x speedup, step: 4, train time 15.52 s
Epoch 8/50 |loss: 0.209167| train set 2.740x speedup, test set 2.711x speedup, val set 0.905x speedup, step: 5, train time 15.12 s
Epoch 9/50 |loss: 0.205829| train set 2.814x speedup, test set 1.525x speedup, val set 1.048x speedup, step: 1, train time 15.22 s
Epoch 10/50 |loss: 0.199461| train set 2.771x speedup, test set 2.677x speedup, val set 0.972x speedup, step: 2, train time 15.01 s
Epoch 11/50 |loss: 0.186368| train set 2.432x speedup, test set 1.664x speedup, val set 0.976x speedup, step: 3, train time 15.24 s
Epoch 12/50 |loss: 0.179713| train set 2.401x speedup, test set 1.466x speedup, val set 0.989x speedup, step: 4, train time 15.14 s
Epoch 13/50 |loss: 0.180184| train set 2.702x speedup, test set 2.644x speedup, val set 1.153x speedup, step: 5, train time 15.10 s
Epoch 14/50 |loss: 0.171435| train set 2.767x speedup, test set 1.396x speedup, val set 0.971x speedup, step: 6, train time 15.13 s
Epoch 15/50 |loss: 0.162351| train set 2.570x speedup, test set 1.416x speedup, val set 0.987x speedup, step: 7, train time 14.73 s
Epoch 16/50 |loss: 0.156370| train set 2.840x speedup, test set 1.003x speedup, val set 0.933x speedup, step: 8, train time 14.86 s
Epoch 17/50 |loss: 0.153742| train set 2.628x speedup, test set 0.969x speedup, val set 0.987x speedup, step: 9, train time 14.61 s
Epoch 18/50 |loss: 0.148505| train set 3.006x speedup, test set 0.989x speedup, val set 1.047x speedup, step: 10, train time 14.53 s
Epoch 19/50 |loss: 0.144550| train set 2.814x speedup, test set 1.001x speedup, val set 0.933x speedup, step: 11, train time 14.44 s
Epoch 20/50 |loss: 0.141955| train set 2.729x speedup, test set 0.986x speedup, val set 0.971x speedup, step: 12, train time 14.51 s
Epoch 21/50 |loss: 0.131979| train set 2.371x speedup, test set 0.980x speedup, val set 0.987x speedup, step: 13, train time 14.45 s
Epoch 22/50 |loss: 0.132723| train set 2.806x speedup, test set 2.581x speedup, val set 0.822x speedup, step: 14, train time 14.52 s
Epoch 23/50 |loss: 0.118782| train set 2.903x speedup, test set 1.006x speedup, val set 0.822x speedup, step: 15, train time 14.44 s
Epoch 24/50 |loss: 0.123306| train set 2.849x speedup, test set 0.983x speedup, val set 0.971x speedup, step: 16, train time 14.42 s
Epoch 25/50 |loss: 0.125358| train set 2.909x speedup, test set 1.006x speedup, val set 1.047x speedup, step: 17, train time 14.51 s
Epoch 26/50 |loss: 0.131644| train set 2.984x speedup, test set 0.998x speedup, val set 1.153x speedup, step: 18, train time 14.51 s
Epoch 27/50 |loss: 0.115606| train set 3.047x speedup, test set 0.982x speedup, val set 0.933x speedup, step: 19, train time 14.61 s
Epoch 28/50 |loss: 0.112023| train set 2.952x speedup, test set 1.401x speedup, val set 1.017x speedup, step: 20, train time 14.62 s
Epoch 29/50 |loss: 0.114851| train set 2.935x speedup, test set 1.444x speedup, val set 0.936x speedup, step: 21, train time 14.53 s
Epoch 30/50 |loss: 0.111446| train set 2.566x speedup, test set 0.976x speedup, val set 0.967x speedup, step: 22, train time 14.43 s
Epoch 31/50 |loss: 0.103164| train set 2.907x speedup, test set 0.994x speedup, val set 1.047x speedup, step: 23, train time 14.32 s
Epoch 32/50 |loss: 0.108427| train set 2.864x speedup, test set 0.975x speedup, val set 0.971x speedup, step: 24, train time 14.54 s
Epoch 33/50 |loss: 0.099315| train set 3.018x speedup, test set 1.459x speedup, val set 0.933x speedup, step: 25, train time 14.33 s
Epoch 34/50 |loss: 0.100639| train set 3.044x speedup, test set 2.459x speedup, val set 0.933x speedup, step: 26, train time 14.34 s
Epoch 35/50 |loss: 0.103950| train set 3.025x speedup, test set 1.401x speedup, val set 1.017x speedup, step: 27, train time 14.52 s
Epoch 36/50 |loss: 0.098368| train set 2.739x speedup, test set 0.998x speedup, val set 0.971x speedup, step: 28, train time 14.54 s
Epoch 37/50 |loss: 0.096645| train set 2.961x speedup, test set 2.501x speedup, val set 1.017x speedup, step: 29, train time 14.43 s
Epoch 38/50 |loss: 0.101169| train set 2.987x speedup, test set 1.458x speedup, val set 1.047x speedup, step: 30, train time 14.51 s
Epoch 39/50 |loss: 0.090233| train set 3.020x speedup, test set 1.392x speedup, val set 1.095x speedup, step: 1, train time 14.80 s
Epoch 40/50 |loss: 0.090435| train set 2.918x speedup, test set 1.410x speedup, val set 0.971x speedup, step: 2, train time 14.31 s
Epoch 41/50 |loss: 0.091874| train set 3.044x speedup, test set 1.009x speedup, val set 0.971x speedup, step: 3, train time 14.41 s
Epoch 42/50 |loss: 0.096938| train set 3.002x speedup, test set 0.978x speedup, val set 0.933x speedup, step: 4, train time 14.33 s
Epoch 43/50 |loss: 0.089945| train set 2.987x speedup, test set 2.550x speedup, val set 0.933x speedup, step: 5, train time 14.52 s
Epoch 44/50 |loss: 0.093328| train set 2.976x speedup, test set 1.427x speedup, val set 1.061x speedup, step: 6, train time 14.41 s
Epoch 45/50 |loss: 0.093048| train set 2.736x speedup, test set 1.391x speedup, val set 0.971x speedup, step: 7, train time 14.44 s
Epoch 46/50 |loss: 0.087388| train set 2.995x speedup, test set 2.622x speedup, val set 0.971x speedup, step: 8, train time 14.41 s
Epoch 47/50 |loss: 0.090890| train set 3.007x speedup, test set 1.432x speedup, val set 0.822x speedup, step: 9, train time 14.51 s
Epoch 48/50 |loss: 0.086126| train set 2.884x speedup, test set 0.990x speedup, val set 1.061x speedup, step: 10, train time 14.41 s
Epoch 49/50 |loss: 0.086659| train set 3.011x speedup, test set 0.979x speedup, val set 0.933x speedup, step: 11, train time 14.41 s
Training per epoch cost 14.754 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.244s, pg runtime 1.206s, speedup 0.970x
40, opt runtime 1.086s, model runtime 1.160s, pg runtime 1.181s, speedup 1.018x
====================
best train speedup epoch: 27, train speedup 3.047, test speedup 0.982, val speedup 0.933
best test speedup epoch: 6, train speedup 2.697, test speedup 2.727, val speedup 1.153
best validation speedup epoch: 39, train speedup 3.020, test speedup 1.392, val speedup 1.095
last model at epoch 49, train speedup 3.011, test speedup 0.979, val speedup 0.933
execution cost 0:13:33.041249
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.361739, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414570| train set 1.038x speedup, test set 2.686x speedup, val set 0.985x speedup, step: 1, train time 17.48 s
Epoch 1/50 |loss: 0.339143| train set 1.069x speedup, test set 2.454x speedup, val set 1.057x speedup, step: 2, train time 14.99 s
Epoch 2/50 |loss: 0.306570| train set 2.202x speedup, test set 2.668x speedup, val set 0.987x speedup, step: 3, train time 14.81 s
Epoch 3/50 |loss: 0.281770| train set 2.293x speedup, test set 2.817x speedup, val set 0.914x speedup, step: 4, train time 14.91 s
Epoch 4/50 |loss: 0.267757| train set 2.471x speedup, test set 2.469x speedup, val set 1.118x speedup, step: 1, train time 15.83 s
Epoch 5/50 |loss: 0.248326| train set 2.125x speedup, test set 2.534x speedup, val set 1.042x speedup, step: 2, train time 14.82 s
Epoch 6/50 |loss: 0.236454| train set 2.489x speedup, test set 1.392x speedup, val set 0.972x speedup, step: 3, train time 14.80 s
Epoch 7/50 |loss: 0.225551| train set 2.170x speedup, test set 1.351x speedup, val set 0.898x speedup, step: 4, train time 14.76 s
Epoch 8/50 |loss: 0.209699| train set 2.687x speedup, test set 2.613x speedup, val set 0.905x speedup, step: 5, train time 14.83 s
Epoch 9/50 |loss: 0.203617| train set 2.388x speedup, test set 2.532x speedup, val set 1.052x speedup, step: 6, train time 15.11 s
Epoch 10/50 |loss: 0.202764| train set 2.751x speedup, test set 2.494x speedup, val set 0.895x speedup, step: 7, train time 14.94 s
Epoch 11/50 |loss: 0.190681| train set 2.458x speedup, test set 2.467x speedup, val set 0.896x speedup, step: 8, train time 14.93 s
Epoch 12/50 |loss: 0.183123| train set 2.767x speedup, test set 2.509x speedup, val set 0.923x speedup, step: 9, train time 14.85 s
Epoch 13/50 |loss: 0.184090| train set 2.697x speedup, test set 2.492x speedup, val set 1.048x speedup, step: 10, train time 14.66 s
Epoch 14/50 |loss: 0.179185| train set 2.757x speedup, test set 2.397x speedup, val set 0.920x speedup, step: 11, train time 14.77 s
Epoch 15/50 |loss: 0.163626| train set 2.737x speedup, test set 2.433x speedup, val set 0.811x speedup, step: 12, train time 14.84 s
Epoch 16/50 |loss: 0.161432| train set 2.807x speedup, test set 2.386x speedup, val set 1.031x speedup, step: 13, train time 15.11 s
Epoch 17/50 |loss: 0.154976| train set 2.652x speedup, test set 2.429x speedup, val set 1.080x speedup, step: 14, train time 14.76 s
Epoch 18/50 |loss: 0.151028| train set 2.911x speedup, test set 2.350x speedup, val set 1.034x speedup, step: 15, train time 15.24 s
Epoch 19/50 |loss: 0.148648| train set 2.747x speedup, test set 2.422x speedup, val set 0.923x speedup, step: 16, train time 15.35 s
Epoch 20/50 |loss: 0.142035| train set 2.870x speedup, test set 2.385x speedup, val set 0.957x speedup, step: 17, train time 15.16 s
Epoch 21/50 |loss: 0.138885| train set 2.525x speedup, test set 2.368x speedup, val set 0.959x speedup, step: 18, train time 15.13 s
Epoch 22/50 |loss: 0.134539| train set 2.403x speedup, test set 2.423x speedup, val set 0.896x speedup, step: 19, train time 15.13 s
Epoch 23/50 |loss: 0.125047| train set 2.928x speedup, test set 2.442x speedup, val set 0.811x speedup, step: 20, train time 15.04 s
Epoch 24/50 |loss: 0.128519| train set 2.848x speedup, test set 2.467x speedup, val set 0.896x speedup, step: 21, train time 15.01 s
Epoch 25/50 |loss: 0.123639| train set 2.914x speedup, test set 2.404x speedup, val set 1.031x speedup, step: 22, train time 15.07 s
Epoch 26/50 |loss: 0.128152| train set 2.942x speedup, test set 2.467x speedup, val set 1.031x speedup, step: 23, train time 15.11 s
Epoch 27/50 |loss: 0.120815| train set 2.822x speedup, test set 2.467x speedup, val set 0.957x speedup, step: 24, train time 15.34 s
Epoch 28/50 |loss: 0.113157| train set 2.977x speedup, test set 2.427x speedup, val set 1.030x speedup, step: 25, train time 15.23 s
Epoch 29/50 |loss: 0.114594| train set 2.815x speedup, test set 2.429x speedup, val set 1.021x speedup, step: 26, train time 14.95 s
Epoch 30/50 |loss: 0.113334| train set 2.565x speedup, test set 2.361x speedup, val set 0.953x speedup, step: 27, train time 15.26 s
Epoch 31/50 |loss: 0.110912| train set 2.543x speedup, test set 2.411x speedup, val set 1.031x speedup, step: 28, train time 15.03 s
Epoch 32/50 |loss: 0.110733| train set 2.786x speedup, test set 2.410x speedup, val set 1.031x speedup, step: 29, train time 15.25 s
Epoch 33/50 |loss: 0.102387| train set 2.978x speedup, test set 2.449x speedup, val set 1.031x speedup, step: 30, train time 15.20 s
Epoch 34/50 |loss: 0.103264| train set 3.027x speedup, test set 2.386x speedup, val set 1.031x speedup, step: 31, train time 15.23 s
Epoch 35/50 |loss: 0.106525| train set 2.922x speedup, test set 2.324x speedup, val set 1.031x speedup, step: 32, train time 15.13 s
Epoch 36/50 |loss: 0.098213| train set 2.815x speedup, test set 2.412x speedup, val set 1.076x speedup, step: 33, train time 15.26 s
Epoch 37/50 |loss: 0.101504| train set 2.959x speedup, test set 2.418x speedup, val set 1.297x speedup, step: 34, train time 15.23 s
Epoch 38/50 |loss: 0.101814| train set 2.974x speedup, test set 2.393x speedup, val set 1.077x speedup, step: 35, train time 15.21 s
Epoch 39/50 |loss: 0.093031| train set 3.042x speedup, test set 2.381x speedup, val set 1.076x speedup, step: 36, train time 15.22 s
Epoch 40/50 |loss: 0.096075| train set 3.004x speedup, test set 2.429x speedup, val set 0.896x speedup, step: 37, train time 15.53 s
Epoch 41/50 |loss: 0.092659| train set 3.041x speedup, test set 2.337x speedup, val set 1.076x speedup, step: 38, train time 15.34 s
Epoch 42/50 |loss: 0.097639| train set 2.837x speedup, test set 2.429x speedup, val set 1.165x speedup, step: 39, train time 15.25 s
Epoch 43/50 |loss: 0.090337| train set 2.980x speedup, test set 2.349x speedup, val set 1.076x speedup, step: 40, train time 15.32 s
Epoch 44/50 |loss: 0.090932| train set 3.048x speedup, test set 2.320x speedup, val set 0.956x speedup, step: 41, train time 15.24 s
Epoch 45/50 |loss: 0.093706| train set 2.748x speedup, test set 2.407x speedup, val set 1.014x speedup, step: 42, train time 15.22 s
Epoch 46/50 |loss: 0.087044| train set 2.782x speedup, test set 2.398x speedup, val set 1.165x speedup, step: 43, train time 15.14 s
Epoch 47/50 |loss: 0.092902| train set 2.991x speedup, test set 2.363x speedup, val set 1.076x speedup, step: 44, train time 15.31 s
Epoch 48/50 |loss: 0.086777| train set 3.045x speedup, test set 2.300x speedup, val set 1.165x speedup, step: 45, train time 15.14 s
Epoch 49/50 |loss: 0.090867| train set 2.767x speedup, test set 2.316x speedup, val set 0.959x speedup, step: 46, train time 15.23 s
Training per epoch cost 15.154 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 48.407s, pg runtime 32.939s, speedup 0.680x
18, opt runtime 6.149s, model runtime 45.581s, pg runtime 30.760s, speedup 0.675x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 44, train speedup 3.048, test speedup 2.320, val speedup 0.956
best test speedup epoch: 3, train speedup 2.293, test speedup 2.817, val speedup 0.914
best validation speedup epoch: 4, train speedup 2.471, test speedup 2.469, val speedup 1.118
last model at epoch 49, train speedup 2.767, test speedup 2.316, val speedup 0.959
execution cost 0:13:59.368957
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.342760, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414506| train set 1.039x speedup, test set 2.571x speedup, val set 1.061x speedup, step: 1, train time 17.53 s
Epoch 1/50 |loss: 0.338479| train set 1.176x speedup, test set 2.604x speedup, val set 0.968x speedup, step: 2, train time 15.09 s
Epoch 2/50 |loss: 0.305110| train set 2.454x speedup, test set 2.503x speedup, val set 0.987x speedup, step: 3, train time 14.94 s
Epoch 3/50 |loss: 0.280940| train set 2.198x speedup, test set 2.731x speedup, val set 0.912x speedup, step: 4, train time 15.10 s
Epoch 4/50 |loss: 0.264001| train set 2.454x speedup, test set 2.805x speedup, val set 0.809x speedup, step: 1, train time 15.74 s
Epoch 5/50 |loss: 0.245373| train set 2.065x speedup, test set 2.606x speedup, val set 0.989x speedup, step: 2, train time 15.10 s
Epoch 6/50 |loss: 0.233542| train set 2.722x speedup, test set 2.669x speedup, val set 0.968x speedup, step: 3, train time 15.15 s
Epoch 7/50 |loss: 0.223437| train set 2.254x speedup, test set 1.414x speedup, val set 0.824x speedup, step: 4, train time 15.01 s
Epoch 8/50 |loss: 0.208048| train set 2.674x speedup, test set 2.571x speedup, val set 1.121x speedup, step: 5, train time 15.20 s
Epoch 9/50 |loss: 0.204095| train set 2.846x speedup, test set 2.635x speedup, val set 1.048x speedup, step: 1, train time 15.33 s
Epoch 10/50 |loss: 0.199020| train set 2.695x speedup, test set 1.412x speedup, val set 0.846x speedup, step: 2, train time 15.11 s
Epoch 11/50 |loss: 0.185294| train set 2.395x speedup, test set 2.643x speedup, val set 0.865x speedup, step: 3, train time 15.12 s
Epoch 12/50 |loss: 0.179504| train set 2.673x speedup, test set 1.444x speedup, val set 1.005x speedup, step: 4, train time 15.22 s
Epoch 13/50 |loss: 0.179970| train set 2.631x speedup, test set 1.359x speedup, val set 1.044x speedup, step: 5, train time 14.91 s
Epoch 14/50 |loss: 0.172162| train set 2.780x speedup, test set 1.390x speedup, val set 1.297x speedup, step: 1, train time 14.91 s
Epoch 15/50 |loss: 0.160419| train set 2.829x speedup, test set 1.383x speedup, val set 0.956x speedup, step: 2, train time 15.21 s
Epoch 16/50 |loss: 0.151432| train set 2.935x speedup, test set 1.402x speedup, val set 0.860x speedup, step: 3, train time 15.12 s
Epoch 17/50 |loss: 0.149023| train set 2.559x speedup, test set 2.522x speedup, val set 1.188x speedup, step: 4, train time 15.14 s
Epoch 18/50 |loss: 0.142339| train set 2.911x speedup, test set 2.656x speedup, val set 1.111x speedup, step: 5, train time 15.03 s
Epoch 19/50 |loss: 0.140613| train set 2.815x speedup, test set 2.518x speedup, val set 1.231x speedup, step: 6, train time 15.50 s
Epoch 20/50 |loss: 0.140845| train set 2.888x speedup, test set 1.383x speedup, val set 1.026x speedup, step: 7, train time 15.20 s
Epoch 21/50 |loss: 0.130555| train set 2.153x speedup, test set 1.429x speedup, val set 1.021x speedup, step: 8, train time 15.05 s
Epoch 22/50 |loss: 0.129294| train set 2.905x speedup, test set 1.397x speedup, val set 1.044x speedup, step: 9, train time 15.11 s
Epoch 23/50 |loss: 0.120100| train set 2.780x speedup, test set 1.371x speedup, val set 0.956x speedup, step: 10, train time 15.05 s
Epoch 24/50 |loss: 0.117871| train set 3.041x speedup, test set 2.721x speedup, val set 0.956x speedup, step: 11, train time 15.08 s
Epoch 25/50 |loss: 0.119039| train set 2.881x speedup, test set 1.445x speedup, val set 1.118x speedup, step: 12, train time 15.19 s
Epoch 26/50 |loss: 0.130297| train set 3.001x speedup, test set 2.661x speedup, val set 1.111x speedup, step: 13, train time 15.03 s
Epoch 27/50 |loss: 0.114657| train set 2.820x speedup, test set 2.541x speedup, val set 1.165x speedup, step: 14, train time 15.11 s
Epoch 28/50 |loss: 0.109384| train set 2.969x speedup, test set 2.502x speedup, val set 1.211x speedup, step: 15, train time 15.20 s
Epoch 29/50 |loss: 0.110240| train set 2.734x speedup, test set 2.522x speedup, val set 1.026x speedup, step: 16, train time 15.06 s
Epoch 30/50 |loss: 0.105967| train set 3.022x speedup, test set 2.409x speedup, val set 0.957x speedup, step: 17, train time 15.13 s
Epoch 31/50 |loss: 0.108187| train set 2.809x speedup, test set 2.695x speedup, val set 1.044x speedup, step: 18, train time 15.12 s
Epoch 32/50 |loss: 0.102624| train set 2.812x speedup, test set 2.502x speedup, val set 0.957x speedup, step: 19, train time 15.04 s
Epoch 33/50 |loss: 0.097650| train set 3.043x speedup, test set 2.518x speedup, val set 1.165x speedup, step: 20, train time 15.14 s
Epoch 34/50 |loss: 0.097222| train set 2.698x speedup, test set 2.518x speedup, val set 1.165x speedup, step: 21, train time 15.25 s
Epoch 35/50 |loss: 0.100236| train set 2.980x speedup, test set 1.383x speedup, val set 1.153x speedup, step: 22, train time 15.13 s
Epoch 36/50 |loss: 0.095528| train set 2.895x speedup, test set 1.402x speedup, val set 1.165x speedup, step: 23, train time 15.14 s
Epoch 37/50 |loss: 0.095019| train set 2.970x speedup, test set 2.518x speedup, val set 1.297x speedup, step: 24, train time 15.11 s
Epoch 38/50 |loss: 0.095050| train set 3.045x speedup, test set 2.433x speedup, val set 1.297x speedup, step: 25, train time 14.96 s
Epoch 39/50 |loss: 0.091125| train set 3.010x speedup, test set 2.477x speedup, val set 1.076x speedup, step: 26, train time 15.16 s
Epoch 40/50 |loss: 0.092226| train set 2.945x speedup, test set 2.431x speedup, val set 1.297x speedup, step: 27, train time 15.13 s
Epoch 41/50 |loss: 0.090018| train set 2.843x speedup, test set 2.651x speedup, val set 1.165x speedup, step: 28, train time 15.25 s
Epoch 42/50 |loss: 0.096938| train set 3.005x speedup, test set 2.518x speedup, val set 1.127x speedup, step: 29, train time 15.13 s
Epoch 43/50 |loss: 0.081886| train set 2.992x speedup, test set 2.447x speedup, val set 1.297x speedup, step: 30, train time 15.13 s
Epoch 44/50 |loss: 0.087381| train set 3.049x speedup, test set 2.519x speedup, val set 1.127x speedup, step: 31, train time 15.05 s
Epoch 45/50 |loss: 0.090475| train set 2.849x speedup, test set 2.502x speedup, val set 0.971x speedup, step: 32, train time 15.21 s
Epoch 46/50 |loss: 0.085418| train set 3.010x speedup, test set 2.447x speedup, val set 1.095x speedup, step: 33, train time 15.14 s
Epoch 47/50 |loss: 0.090919| train set 3.024x speedup, test set 1.433x speedup, val set 1.165x speedup, step: 34, train time 15.13 s
Epoch 48/50 |loss: 0.085330| train set 2.947x speedup, test set 2.409x speedup, val set 1.127x speedup, step: 35, train time 15.10 s
Epoch 49/50 |loss: 0.086667| train set 2.793x speedup, test set 1.420x speedup, val set 0.971x speedup, step: 36, train time 15.03 s
Training per epoch cost 15.180 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 48.407s, pg runtime 32.939s, speedup 0.680x
18, opt runtime 6.149s, model runtime 45.581s, pg runtime 30.760s, speedup 0.675x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 44, train speedup 3.049, test speedup 2.519, val speedup 1.127
best test speedup epoch: 4, train speedup 2.454, test speedup 2.805, val speedup 0.809
best validation speedup epoch: 14, train speedup 2.780, test speedup 1.390, val speedup 1.297
last model at epoch 49, train speedup 2.793, test speedup 1.420, val speedup 0.971
execution cost 0:13:59.668675
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.194200, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414109| train set 1.039x speedup, test set 1.694x speedup, val set 0.985x speedup, step: 1, train time 17.32 s
Epoch 1/50 |loss: 0.337651| train set 1.070x speedup, test set 2.703x speedup, val set 0.968x speedup, step: 2, train time 15.16 s
Epoch 2/50 |loss: 0.305227| train set 2.293x speedup, test set 2.530x speedup, val set 0.987x speedup, step: 3, train time 15.13 s
Epoch 3/50 |loss: 0.283002| train set 2.108x speedup, test set 2.734x speedup, val set 0.820x speedup, step: 4, train time 15.01 s
Epoch 4/50 |loss: 0.266564| train set 2.598x speedup, test set 2.610x speedup, val set 0.983x speedup, step: 1, train time 16.01 s
Epoch 5/50 |loss: 0.247096| train set 2.191x speedup, test set 2.542x speedup, val set 0.987x speedup, step: 2, train time 14.93 s
Epoch 6/50 |loss: 0.234599| train set 2.755x speedup, test set 1.437x speedup, val set 0.949x speedup, step: 3, train time 14.93 s
Epoch 7/50 |loss: 0.226806| train set 2.257x speedup, test set 1.440x speedup, val set 0.824x speedup, step: 4, train time 14.94 s
Epoch 8/50 |loss: 0.209378| train set 2.722x speedup, test set 1.737x speedup, val set 0.964x speedup, step: 5, train time 14.92 s
Epoch 9/50 |loss: 0.204217| train set 2.640x speedup, test set 2.727x speedup, val set 1.000x speedup, step: 1, train time 15.13 s
Epoch 10/50 |loss: 0.204138| train set 2.728x speedup, test set 1.445x speedup, val set 0.866x speedup, step: 2, train time 14.61 s
Epoch 11/50 |loss: 0.182602| train set 2.474x speedup, test set 1.663x speedup, val set 0.931x speedup, step: 3, train time 14.82 s
Epoch 12/50 |loss: 0.182476| train set 2.779x speedup, test set 2.634x speedup, val set 1.026x speedup, step: 4, train time 14.81 s
Epoch 13/50 |loss: 0.181222| train set 2.687x speedup, test set 1.438x speedup, val set 1.134x speedup, step: 5, train time 14.81 s
Epoch 14/50 |loss: 0.173138| train set 2.768x speedup, test set 1.411x speedup, val set 1.043x speedup, step: 1, train time 14.82 s
Epoch 15/50 |loss: 0.160861| train set 2.849x speedup, test set 1.411x speedup, val set 1.231x speedup, step: 2, train time 14.82 s
Epoch 16/50 |loss: 0.151369| train set 2.770x speedup, test set 1.453x speedup, val set 1.095x speedup, step: 3, train time 14.90 s
Epoch 17/50 |loss: 0.153490| train set 2.691x speedup, test set 2.679x speedup, val set 1.165x speedup, step: 4, train time 14.92 s
Epoch 18/50 |loss: 0.145030| train set 2.965x speedup, test set 1.434x speedup, val set 1.111x speedup, step: 5, train time 14.85 s
Epoch 19/50 |loss: 0.143970| train set 2.753x speedup, test set 2.671x speedup, val set 1.111x speedup, step: 1, train time 14.96 s
Epoch 20/50 |loss: 0.144009| train set 2.865x speedup, test set 2.603x speedup, val set 1.111x speedup, step: 2, train time 14.89 s
Epoch 21/50 |loss: 0.132549| train set 2.397x speedup, test set 1.479x speedup, val set 1.027x speedup, step: 3, train time 14.84 s
Epoch 22/50 |loss: 0.131390| train set 2.825x speedup, test set 2.559x speedup, val set 1.045x speedup, step: 4, train time 15.00 s
Epoch 23/50 |loss: 0.122499| train set 2.980x speedup, test set 1.747x speedup, val set 1.044x speedup, step: 5, train time 14.82 s
Epoch 24/50 |loss: 0.124319| train set 2.849x speedup, test set 2.645x speedup, val set 1.026x speedup, step: 6, train time 14.84 s
Epoch 25/50 |loss: 0.124172| train set 2.875x speedup, test set 3.133x speedup, val set 1.111x speedup, step: 7, train time 14.75 s
Epoch 26/50 |loss: 0.126801| train set 2.926x speedup, test set 2.972x speedup, val set 1.297x speedup, step: 8, train time 15.04 s
Epoch 27/50 |loss: 0.119220| train set 2.783x speedup, test set 2.640x speedup, val set 1.129x speedup, step: 9, train time 14.91 s
Epoch 28/50 |loss: 0.110690| train set 2.984x speedup, test set 3.243x speedup, val set 1.231x speedup, step: 10, train time 14.84 s
Epoch 29/50 |loss: 0.111265| train set 2.885x speedup, test set 2.640x speedup, val set 1.127x speedup, step: 1, train time 15.03 s
Epoch 30/50 |loss: 0.117731| train set 2.563x speedup, test set 2.695x speedup, val set 1.122x speedup, step: 2, train time 14.90 s
Epoch 31/50 |loss: 0.109158| train set 2.767x speedup, test set 1.446x speedup, val set 1.231x speedup, step: 3, train time 14.83 s
Epoch 32/50 |loss: 0.109233| train set 2.770x speedup, test set 2.718x speedup, val set 1.127x speedup, step: 4, train time 15.03 s
Epoch 33/50 |loss: 0.102254| train set 3.004x speedup, test set 2.955x speedup, val set 1.298x speedup, step: 5, train time 15.23 s
Epoch 34/50 |loss: 0.105143| train set 2.625x speedup, test set 2.718x speedup, val set 1.127x speedup, step: 1, train time 14.93 s
Epoch 35/50 |loss: 0.102400| train set 2.963x speedup, test set 1.446x speedup, val set 1.044x speedup, step: 2, train time 15.11 s
Epoch 36/50 |loss: 0.096099| train set 2.821x speedup, test set 2.788x speedup, val set 1.165x speedup, step: 3, train time 15.10 s
Epoch 37/50 |loss: 0.098980| train set 2.917x speedup, test set 2.670x speedup, val set 1.063x speedup, step: 4, train time 15.04 s
Epoch 38/50 |loss: 0.102537| train set 2.988x speedup, test set 2.670x speedup, val set 1.026x speedup, step: 5, train time 15.06 s
Epoch 39/50 |loss: 0.093702| train set 3.027x speedup, test set 2.718x speedup, val set 1.026x speedup, step: 6, train time 15.10 s
Epoch 40/50 |loss: 0.090899| train set 2.910x speedup, test set 1.469x speedup, val set 1.127x speedup, step: 7, train time 15.11 s
Epoch 41/50 |loss: 0.094369| train set 3.025x speedup, test set 2.828x speedup, val set 1.026x speedup, step: 8, train time 15.12 s
Epoch 42/50 |loss: 0.100593| train set 3.003x speedup, test set 2.534x speedup, val set 1.127x speedup, step: 9, train time 15.02 s
Epoch 43/50 |loss: 0.094530| train set 2.986x speedup, test set 1.728x speedup, val set 1.127x speedup, step: 10, train time 15.01 s
Epoch 44/50 |loss: 0.092761| train set 2.988x speedup, test set 1.454x speedup, val set 1.127x speedup, step: 1, train time 15.21 s
Epoch 45/50 |loss: 0.093780| train set 2.379x speedup, test set 2.674x speedup, val set 1.127x speedup, step: 2, train time 15.03 s
Epoch 46/50 |loss: 0.090101| train set 2.716x speedup, test set 2.670x speedup, val set 1.129x speedup, step: 3, train time 15.17 s
Epoch 47/50 |loss: 0.093342| train set 2.963x speedup, test set 2.642x speedup, val set 1.127x speedup, step: 4, train time 15.12 s
Epoch 48/50 |loss: 0.090403| train set 3.026x speedup, test set 2.670x speedup, val set 1.127x speedup, step: 5, train time 15.11 s
Epoch 49/50 |loss: 0.087833| train set 2.860x speedup, test set 2.586x speedup, val set 0.971x speedup, step: 6, train time 15.11 s
Training per epoch cost 15.042 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.244s, pg runtime 1.206s, speedup 0.970x
40, opt runtime 1.086s, model runtime 1.160s, pg runtime 1.181s, speedup 1.018x
====================
best train speedup epoch: 39, train speedup 3.027, test speedup 2.718, val speedup 1.026
best test speedup epoch: 28, train speedup 2.984, test speedup 3.243, val speedup 1.231
best validation speedup epoch: 44, train speedup 2.988, test speedup 1.454, val speedup 1.127
last model at epoch 49, train speedup 2.860, test speedup 2.586, val speedup 0.971
execution cost 0:13:51.415515
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.898961, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414259| train set 1.038x speedup, test set 2.712x speedup, val set 1.060x speedup, step: 1, train time 16.03 s
Epoch 1/50 |loss: 0.340135| train set 1.834x speedup, test set 2.474x speedup, val set 0.983x speedup, step: 2, train time 14.53 s
Epoch 2/50 |loss: 0.308888| train set 2.219x speedup, test set 2.493x speedup, val set 0.987x speedup, step: 3, train time 14.53 s
Epoch 3/50 |loss: 0.284591| train set 2.339x speedup, test set 2.907x speedup, val set 0.997x speedup, step: 4, train time 14.64 s
Epoch 4/50 |loss: 0.267059| train set 2.629x speedup, test set 2.602x speedup, val set 0.980x speedup, step: 1, train time 15.34 s
Epoch 5/50 |loss: 0.247775| train set 2.249x speedup, test set 2.560x speedup, val set 1.046x speedup, step: 2, train time 14.49 s
Epoch 6/50 |loss: 0.235653| train set 2.382x speedup, test set 1.406x speedup, val set 0.874x speedup, step: 3, train time 14.43 s
Epoch 7/50 |loss: 0.226100| train set 2.256x speedup, test set 1.428x speedup, val set 0.750x speedup, step: 4, train time 14.49 s
Epoch 8/50 |loss: 0.209072| train set 2.712x speedup, test set 2.807x speedup, val set 0.893x speedup, step: 5, train time 14.21 s
Epoch 9/50 |loss: 0.201212| train set 2.712x speedup, test set 1.486x speedup, val set 1.039x speedup, step: 1, train time 14.22 s
Epoch 10/50 |loss: 0.202239| train set 2.791x speedup, test set 1.500x speedup, val set 1.052x speedup, step: 2, train time 14.41 s
Epoch 11/50 |loss: 0.184609| train set 2.421x speedup, test set 2.735x speedup, val set 1.001x speedup, step: 3, train time 14.22 s
Epoch 12/50 |loss: 0.181250| train set 2.777x speedup, test set 1.512x speedup, val set 0.920x speedup, step: 4, train time 14.45 s
Epoch 13/50 |loss: 0.180524| train set 2.695x speedup, test set 1.457x speedup, val set 1.133x speedup, step: 5, train time 14.12 s
Epoch 14/50 |loss: 0.169088| train set 2.769x speedup, test set 2.624x speedup, val set 0.957x speedup, step: 6, train time 14.43 s
Epoch 15/50 |loss: 0.162666| train set 2.910x speedup, test set 1.474x speedup, val set 0.920x speedup, step: 7, train time 14.30 s
Epoch 16/50 |loss: 0.156869| train set 2.823x speedup, test set 1.442x speedup, val set 0.811x speedup, step: 8, train time 14.31 s
Epoch 17/50 |loss: 0.148406| train set 2.633x speedup, test set 1.452x speedup, val set 1.080x speedup, step: 9, train time 14.33 s
Epoch 18/50 |loss: 0.143886| train set 3.000x speedup, test set 1.424x speedup, val set 1.031x speedup, step: 10, train time 14.31 s
Epoch 19/50 |loss: 0.145367| train set 2.868x speedup, test set 1.431x speedup, val set 1.031x speedup, step: 11, train time 14.33 s
Epoch 20/50 |loss: 0.138156| train set 2.879x speedup, test set 2.945x speedup, val set 0.920x speedup, step: 12, train time 14.22 s
Epoch 21/50 |loss: 0.130353| train set 2.401x speedup, test set 1.471x speedup, val set 0.957x speedup, step: 13, train time 14.12 s
Epoch 22/50 |loss: 0.131632| train set 2.780x speedup, test set 2.550x speedup, val set 0.811x speedup, step: 14, train time 14.31 s
Epoch 23/50 |loss: 0.121225| train set 2.918x speedup, test set 1.431x speedup, val set 0.957x speedup, step: 15, train time 14.30 s
Epoch 24/50 |loss: 0.121875| train set 2.986x speedup, test set 1.448x speedup, val set 0.920x speedup, step: 16, train time 14.22 s
Epoch 25/50 |loss: 0.123511| train set 2.867x speedup, test set 2.532x speedup, val set 1.031x speedup, step: 17, train time 14.31 s
Epoch 26/50 |loss: 0.129347| train set 2.935x speedup, test set 2.412x speedup, val set 1.111x speedup, step: 18, train time 14.33 s
Epoch 27/50 |loss: 0.122263| train set 2.985x speedup, test set 1.428x speedup, val set 1.031x speedup, step: 19, train time 14.27 s
Epoch 28/50 |loss: 0.112074| train set 2.981x speedup, test set 1.416x speedup, val set 0.920x speedup, step: 20, train time 14.42 s
Epoch 29/50 |loss: 0.110798| train set 2.939x speedup, test set 1.437x speedup, val set 0.957x speedup, step: 21, train time 14.31 s
Epoch 30/50 |loss: 0.113127| train set 2.740x speedup, test set 1.029x speedup, val set 0.953x speedup, step: 22, train time 14.32 s
Epoch 31/50 |loss: 0.110632| train set 2.961x speedup, test set 1.416x speedup, val set 1.031x speedup, step: 23, train time 14.32 s
Epoch 32/50 |loss: 0.108543| train set 2.727x speedup, test set 1.538x speedup, val set 0.957x speedup, step: 24, train time 14.31 s
Epoch 33/50 |loss: 0.101471| train set 3.009x speedup, test set 1.432x speedup, val set 1.031x speedup, step: 25, train time 14.34 s
Epoch 34/50 |loss: 0.101209| train set 3.027x speedup, test set 2.956x speedup, val set 0.957x speedup, step: 26, train time 14.21 s
Epoch 35/50 |loss: 0.102710| train set 2.964x speedup, test set 1.495x speedup, val set 0.957x speedup, step: 27, train time 14.49 s
Epoch 36/50 |loss: 0.097421| train set 2.826x speedup, test set 1.497x speedup, val set 0.959x speedup, step: 28, train time 14.13 s
Epoch 37/50 |loss: 0.099969| train set 2.969x speedup, test set 2.586x speedup, val set 1.031x speedup, step: 29, train time 14.23 s
Epoch 38/50 |loss: 0.103615| train set 2.985x speedup, test set 1.488x speedup, val set 1.031x speedup, step: 30, train time 14.31 s
Epoch 39/50 |loss: 0.091071| train set 2.880x speedup, test set 1.435x speedup, val set 0.957x speedup, step: 31, train time 14.34 s
Epoch 40/50 |loss: 0.099680| train set 3.044x speedup, test set 1.448x speedup, val set 1.111x speedup, step: 32, train time 14.22 s
Epoch 41/50 |loss: 0.094292| train set 3.045x speedup, test set 2.875x speedup, val set 0.957x speedup, step: 33, train time 14.23 s
Epoch 42/50 |loss: 0.099118| train set 3.028x speedup, test set 1.439x speedup, val set 1.031x speedup, step: 34, train time 14.33 s
Epoch 43/50 |loss: 0.089888| train set 2.823x speedup, test set 2.882x speedup, val set 0.957x speedup, step: 35, train time 14.40 s
Epoch 44/50 |loss: 0.092057| train set 2.988x speedup, test set 1.513x speedup, val set 1.165x speedup, step: 1, train time 14.21 s
Epoch 45/50 |loss: 0.093251| train set 2.947x speedup, test set 1.491x speedup, val set 0.957x speedup, step: 2, train time 14.42 s
Epoch 46/50 |loss: 0.087321| train set 3.020x speedup, test set 1.485x speedup, val set 1.076x speedup, step: 3, train time 14.25 s
Epoch 47/50 |loss: 0.093057| train set 2.867x speedup, test set 1.539x speedup, val set 0.956x speedup, step: 4, train time 14.34 s
Epoch 48/50 |loss: 0.088024| train set 2.899x speedup, test set 2.775x speedup, val set 0.957x speedup, step: 5, train time 14.24 s
Epoch 49/50 |loss: 0.086776| train set 2.776x speedup, test set 1.411x speedup, val set 0.920x speedup, step: 6, train time 14.22 s
Training per epoch cost 14.376 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 605.138s, pg runtime 626.529s, speedup 1.035x
32, opt runtime 24.662s, model runtime 615.484s, pg runtime 613.999s, speedup 0.998x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.244s, pg runtime 1.206s, speedup 0.970x
40, opt runtime 1.086s, model runtime 1.160s, pg runtime 1.181s, speedup 1.018x
====================
best train speedup epoch: 41, train speedup 3.045, test speedup 2.875, val speedup 0.957
best test speedup epoch: 34, train speedup 3.027, test speedup 2.956, val speedup 0.957
best validation speedup epoch: 44, train speedup 2.988, test speedup 1.513, val speedup 1.165
last model at epoch 49, train speedup 2.776, test speedup 1.411, val speedup 0.920
execution cost 0:13:09.076739
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.314789, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414167| train set 1.039x speedup, test set 2.564x speedup, val set 0.985x speedup, step: 1, train time 17.12 s
Epoch 1/50 |loss: 0.340568| train set 1.067x speedup, test set 2.508x speedup, val set 0.983x speedup, step: 2, train time 15.20 s
Epoch 2/50 |loss: 0.308667| train set 2.119x speedup, test set 2.506x speedup, val set 0.983x speedup, step: 3, train time 14.95 s
Epoch 3/50 |loss: 0.282299| train set 2.289x speedup, test set 1.476x speedup, val set 0.921x speedup, step: 4, train time 14.86 s
Epoch 4/50 |loss: 0.265705| train set 2.476x speedup, test set 2.607x speedup, val set 1.069x speedup, step: 1, train time 15.82 s
Epoch 5/50 |loss: 0.245314| train set 2.093x speedup, test set 2.418x speedup, val set 0.990x speedup, step: 2, train time 14.85 s
Epoch 6/50 |loss: 0.230005| train set 2.692x speedup, test set 1.404x speedup, val set 1.133x speedup, step: 3, train time 15.02 s
Epoch 7/50 |loss: 0.220713| train set 2.262x speedup, test set 1.368x speedup, val set 0.813x speedup, step: 4, train time 15.02 s
Epoch 8/50 |loss: 0.206044| train set 2.784x speedup, test set 1.432x speedup, val set 1.056x speedup, step: 5, train time 15.12 s
Epoch 9/50 |loss: 0.196877| train set 2.681x speedup, test set 0.977x speedup, val set 1.132x speedup, step: 1, train time 15.02 s
Epoch 10/50 |loss: 0.201419| train set 2.780x speedup, test set 1.432x speedup, val set 0.896x speedup, step: 2, train time 14.52 s
Epoch 11/50 |loss: 0.179190| train set 2.377x speedup, test set 1.466x speedup, val set 1.077x speedup, step: 3, train time 14.83 s
Epoch 12/50 |loss: 0.175793| train set 2.791x speedup, test set 1.451x speedup, val set 1.034x speedup, step: 4, train time 14.73 s
Epoch 13/50 |loss: 0.179520| train set 2.692x speedup, test set 1.454x speedup, val set 1.047x speedup, step: 5, train time 14.85 s
Epoch 14/50 |loss: 0.172657| train set 2.763x speedup, test set 1.436x speedup, val set 0.971x speedup, step: 6, train time 15.02 s
Epoch 15/50 |loss: 0.157161| train set 2.882x speedup, test set 1.458x speedup, val set 0.933x speedup, step: 7, train time 15.02 s
Epoch 16/50 |loss: 0.155496| train set 2.916x speedup, test set 1.472x speedup, val set 0.933x speedup, step: 8, train time 14.93 s
Epoch 17/50 |loss: 0.150840| train set 2.628x speedup, test set 1.432x speedup, val set 1.080x speedup, step: 9, train time 14.94 s
Epoch 18/50 |loss: 0.146886| train set 2.961x speedup, test set 1.447x speedup, val set 0.923x speedup, step: 10, train time 14.84 s
Epoch 19/50 |loss: 0.140487| train set 2.663x speedup, test set 0.974x speedup, val set 0.957x speedup, step: 11, train time 14.84 s
Epoch 20/50 |loss: 0.140698| train set 2.734x speedup, test set 1.469x speedup, val set 1.026x speedup, step: 12, train time 15.00 s
Epoch 21/50 |loss: 0.130279| train set 2.615x speedup, test set 0.993x speedup, val set 1.021x speedup, step: 13, train time 14.81 s
Epoch 22/50 |loss: 0.130318| train set 2.959x speedup, test set 1.469x speedup, val set 0.896x speedup, step: 14, train time 14.82 s
Epoch 23/50 |loss: 0.123494| train set 2.840x speedup, test set 1.469x speedup, val set 1.026x speedup, step: 15, train time 14.83 s
Epoch 24/50 |loss: 0.124905| train set 2.983x speedup, test set 1.469x speedup, val set 0.920x speedup, step: 16, train time 14.72 s
Epoch 25/50 |loss: 0.121775| train set 2.905x speedup, test set 1.164x speedup, val set 1.031x speedup, step: 17, train time 14.83 s
Epoch 26/50 |loss: 0.124638| train set 2.940x speedup, test set 1.522x speedup, val set 1.111x speedup, step: 18, train time 14.83 s
Epoch 27/50 |loss: 0.118509| train set 2.967x speedup, test set 1.472x speedup, val set 0.984x speedup, step: 19, train time 14.84 s
Epoch 28/50 |loss: 0.109024| train set 2.942x speedup, test set 1.420x speedup, val set 0.984x speedup, step: 20, train time 14.66 s
Epoch 29/50 |loss: 0.110192| train set 2.927x speedup, test set 1.521x speedup, val set 0.971x speedup, step: 21, train time 14.74 s
Epoch 30/50 |loss: 0.112026| train set 2.874x speedup, test set 1.423x speedup, val set 1.021x speedup, step: 22, train time 14.73 s
Epoch 31/50 |loss: 0.105709| train set 2.774x speedup, test set 1.164x speedup, val set 1.111x speedup, step: 23, train time 14.82 s
Epoch 32/50 |loss: 0.111545| train set 2.764x speedup, test set 1.482x speedup, val set 1.026x speedup, step: 24, train time 14.85 s
Epoch 33/50 |loss: 0.099935| train set 3.017x speedup, test set 1.559x speedup, val set 1.031x speedup, step: 25, train time 14.83 s
Epoch 34/50 |loss: 0.100442| train set 2.988x speedup, test set 1.425x speedup, val set 0.957x speedup, step: 26, train time 14.92 s
Epoch 35/50 |loss: 0.101083| train set 2.916x speedup, test set 1.560x speedup, val set 0.920x speedup, step: 27, train time 14.92 s
Epoch 36/50 |loss: 0.096568| train set 2.959x speedup, test set 1.479x speedup, val set 1.029x speedup, step: 28, train time 14.94 s
Epoch 37/50 |loss: 0.097759| train set 2.984x speedup, test set 1.193x speedup, val set 1.095x speedup, step: 29, train time 14.84 s
Epoch 38/50 |loss: 0.098056| train set 2.986x speedup, test set 1.591x speedup, val set 1.111x speedup, step: 30, train time 14.95 s
Epoch 39/50 |loss: 0.093500| train set 3.022x speedup, test set 1.509x speedup, val set 1.076x speedup, step: 31, train time 14.93 s
Epoch 40/50 |loss: 0.088298| train set 2.988x speedup, test set 1.490x speedup, val set 1.111x speedup, step: 32, train time 14.94 s
Epoch 41/50 |loss: 0.094103| train set 3.051x speedup, test set 1.470x speedup, val set 0.957x speedup, step: 33, train time 15.04 s
Epoch 42/50 |loss: 0.097038| train set 2.846x speedup, test set 1.486x speedup, val set 0.920x speedup, step: 34, train time 15.01 s
Epoch 43/50 |loss: 0.090750| train set 2.924x speedup, test set 1.522x speedup, val set 1.076x speedup, step: 35, train time 15.02 s
Epoch 44/50 |loss: 0.089261| train set 2.987x speedup, test set 1.479x speedup, val set 0.957x speedup, step: 36, train time 15.04 s
Epoch 45/50 |loss: 0.089595| train set 2.703x speedup, test set 1.433x speedup, val set 0.957x speedup, step: 37, train time 15.04 s
Epoch 46/50 |loss: 0.085343| train set 3.010x speedup, test set 1.486x speedup, val set 1.076x speedup, step: 38, train time 15.03 s
Epoch 47/50 |loss: 0.092200| train set 2.962x speedup, test set 1.518x speedup, val set 0.957x speedup, step: 39, train time 15.12 s
Epoch 48/50 |loss: 0.089490| train set 2.871x speedup, test set 1.099x speedup, val set 0.953x speedup, step: 40, train time 14.94 s
Epoch 49/50 |loss: 0.088152| train set 2.846x speedup, test set 1.479x speedup, val set 0.923x speedup, step: 41, train time 14.91 s
Training per epoch cost 14.967 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 50.648s, pg runtime 32.278s, speedup 0.637x
06, opt runtime 25.597s, model runtime 45.228s, pg runtime 27.136s, speedup 0.600x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 48.407s, pg runtime 32.939s, speedup 0.680x
18, opt runtime 6.149s, model runtime 45.581s, pg runtime 30.760s, speedup 0.675x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 605.138s, pg runtime 626.529s, speedup 1.035x
32, opt runtime 24.662s, model runtime 615.484s, pg runtime 613.999s, speedup 0.998x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 41, train speedup 3.051, test speedup 1.470, val speedup 0.957
best test speedup epoch: 4, train speedup 2.476, test speedup 2.607, val speedup 1.069
best validation speedup epoch: 9, train speedup 2.681, test speedup 0.977, val speedup 1.132
last model at epoch 49, train speedup 2.846, test speedup 1.479, val speedup 0.923
execution cost 0:13:49.004675
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.188394, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414273| train set 1.039x speedup, test set 2.567x speedup, val set 0.985x speedup, step: 1, train time 17.26 s
Epoch 1/50 |loss: 0.336942| train set 1.015x speedup, test set 2.620x speedup, val set 0.983x speedup, step: 2, train time 15.12 s
Epoch 2/50 |loss: 0.305540| train set 2.193x speedup, test set 2.431x speedup, val set 0.987x speedup, step: 3, train time 14.96 s
Epoch 3/50 |loss: 0.280783| train set 2.437x speedup, test set 2.754x speedup, val set 0.902x speedup, step: 4, train time 14.99 s
Epoch 4/50 |loss: 0.262769| train set 2.733x speedup, test set 2.397x speedup, val set 1.118x speedup, step: 1, train time 15.77 s
Epoch 5/50 |loss: 0.240860| train set 2.157x speedup, test set 2.409x speedup, val set 1.046x speedup, step: 2, train time 14.93 s
Epoch 6/50 |loss: 0.227696| train set 2.669x speedup, test set 2.413x speedup, val set 0.912x speedup, step: 3, train time 15.03 s
Epoch 7/50 |loss: 0.222042| train set 2.258x speedup, test set 2.395x speedup, val set 0.837x speedup, step: 4, train time 15.12 s
Epoch 8/50 |loss: 0.202987| train set 2.856x speedup, test set 2.477x speedup, val set 0.966x speedup, step: 5, train time 14.62 s
Epoch 9/50 |loss: 0.196989| train set 2.667x speedup, test set 2.606x speedup, val set 1.052x speedup, step: 6, train time 14.65 s
Epoch 10/50 |loss: 0.196014| train set 2.645x speedup, test set 2.595x speedup, val set 0.898x speedup, step: 7, train time 14.64 s
Epoch 11/50 |loss: 0.176419| train set 2.717x speedup, test set 2.541x speedup, val set 0.972x speedup, step: 8, train time 14.81 s
Epoch 12/50 |loss: 0.173723| train set 2.702x speedup, test set 2.542x speedup, val set 1.080x speedup, step: 9, train time 14.75 s
Epoch 13/50 |loss: 0.166704| train set 2.718x speedup, test set 2.443x speedup, val set 0.898x speedup, step: 10, train time 14.92 s
Epoch 14/50 |loss: 0.171104| train set 2.771x speedup, test set 2.469x speedup, val set 1.080x speedup, step: 11, train time 14.94 s
Epoch 15/50 |loss: 0.153644| train set 2.746x speedup, test set 2.333x speedup, val set 1.031x speedup, step: 12, train time 14.64 s
Epoch 16/50 |loss: 0.148504| train set 2.960x speedup, test set 1.488x speedup, val set 0.811x speedup, step: 13, train time 14.82 s
Epoch 17/50 |loss: 0.144375| train set 2.627x speedup, test set 1.438x speedup, val set 0.959x speedup, step: 14, train time 14.89 s
Epoch 18/50 |loss: 0.139816| train set 2.886x speedup, test set 2.370x speedup, val set 0.923x speedup, step: 15, train time 14.92 s
Epoch 19/50 |loss: 0.136501| train set 2.954x speedup, test set 2.641x speedup, val set 1.080x speedup, step: 16, train time 14.93 s
Epoch 20/50 |loss: 0.131335| train set 2.873x speedup, test set 1.422x speedup, val set 0.959x speedup, step: 17, train time 15.03 s
Epoch 21/50 |loss: 0.127776| train set 2.668x speedup, test set 0.975x speedup, val set 0.957x speedup, step: 18, train time 15.11 s
Epoch 22/50 |loss: 0.125901| train set 2.776x speedup, test set 2.657x speedup, val set 1.189x speedup, step: 19, train time 15.02 s
Epoch 23/50 |loss: 0.115531| train set 2.974x speedup, test set 1.460x speedup, val set 0.957x speedup, step: 20, train time 15.10 s
Epoch 24/50 |loss: 0.116174| train set 3.043x speedup, test set 2.646x speedup, val set 0.957x speedup, step: 21, train time 14.94 s
Epoch 25/50 |loss: 0.118993| train set 2.921x speedup, test set 1.547x speedup, val set 1.031x speedup, step: 22, train time 15.12 s
Epoch 26/50 |loss: 0.122954| train set 2.987x speedup, test set 2.653x speedup, val set 1.031x speedup, step: 23, train time 14.94 s
Epoch 27/50 |loss: 0.115329| train set 2.998x speedup, test set 1.440x speedup, val set 0.957x speedup, step: 24, train time 14.91 s
Epoch 28/50 |loss: 0.110585| train set 2.942x speedup, test set 1.469x speedup, val set 1.133x speedup, step: 25, train time 14.90 s
Epoch 29/50 |loss: 0.106807| train set 2.862x speedup, test set 2.918x speedup, val set 0.953x speedup, step: 26, train time 14.93 s
Epoch 30/50 |loss: 0.105103| train set 2.795x speedup, test set 1.466x speedup, val set 0.953x speedup, step: 27, train time 14.94 s
Epoch 31/50 |loss: 0.100244| train set 2.909x speedup, test set 2.715x speedup, val set 1.031x speedup, step: 28, train time 14.83 s
Epoch 32/50 |loss: 0.102459| train set 2.985x speedup, test set 1.217x speedup, val set 0.953x speedup, step: 29, train time 14.93 s
Epoch 33/50 |loss: 0.096548| train set 3.015x speedup, test set 2.554x speedup, val set 1.031x speedup, step: 30, train time 14.93 s
Epoch 34/50 |loss: 0.096840| train set 2.569x speedup, test set 1.382x speedup, val set 0.957x speedup, step: 31, train time 15.01 s
Epoch 35/50 |loss: 0.100774| train set 2.954x speedup, test set 1.803x speedup, val set 1.031x speedup, step: 32, train time 15.03 s
Epoch 36/50 |loss: 0.092675| train set 2.991x speedup, test set 2.671x speedup, val set 0.959x speedup, step: 33, train time 14.93 s
Epoch 37/50 |loss: 0.092787| train set 2.911x speedup, test set 2.537x speedup, val set 1.189x speedup, step: 34, train time 14.95 s
Epoch 38/50 |loss: 0.097629| train set 2.985x speedup, test set 2.671x speedup, val set 1.031x speedup, step: 35, train time 14.92 s
Epoch 39/50 |loss: 0.084689| train set 3.033x speedup, test set 1.503x speedup, val set 1.076x speedup, step: 36, train time 14.93 s
Epoch 40/50 |loss: 0.090283| train set 2.996x speedup, test set 2.568x speedup, val set 1.297x speedup, step: 37, train time 15.12 s
Epoch 41/50 |loss: 0.087662| train set 3.000x speedup, test set 1.473x speedup, val set 0.957x speedup, step: 38, train time 15.15 s
Epoch 42/50 |loss: 0.096962| train set 3.004x speedup, test set 2.465x speedup, val set 1.189x speedup, step: 39, train time 15.12 s
Epoch 43/50 |loss: 0.085699| train set 2.837x speedup, test set 2.599x speedup, val set 0.957x speedup, step: 40, train time 15.02 s
Epoch 44/50 |loss: 0.089696| train set 2.989x speedup, test set 2.614x speedup, val set 1.044x speedup, step: 41, train time 15.12 s
Epoch 45/50 |loss: 0.085283| train set 2.962x speedup, test set 1.692x speedup, val set 0.957x speedup, step: 42, train time 15.02 s
Epoch 46/50 |loss: 0.082928| train set 3.033x speedup, test set 2.642x speedup, val set 1.076x speedup, step: 43, train time 14.82 s
Epoch 47/50 |loss: 0.087234| train set 3.022x speedup, test set 2.549x speedup, val set 1.076x speedup, step: 44, train time 14.94 s
Epoch 48/50 |loss: 0.084344| train set 2.907x speedup, test set 2.921x speedup, val set 1.040x speedup, step: 45, train time 15.01 s
Epoch 49/50 |loss: 0.082179| train set 3.050x speedup, test set 1.783x speedup, val set 0.959x speedup, step: 46, train time 15.01 s
Training per epoch cost 15.008 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 17.756s, pg runtime 32.969s, speedup 1.857x
24, opt runtime 6.234s, model runtime 17.977s, pg runtime 32.540s, speedup 1.810x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 49, train speedup 3.050, test speedup 1.783, val speedup 0.959
best test speedup epoch: 48, train speedup 2.907, test speedup 2.921, val speedup 1.040
best validation speedup epoch: 4, train speedup 2.733, test speedup 2.397, val speedup 1.118
last model at epoch 49, train speedup 3.050, test speedup 1.783, val speedup 0.959
execution cost 0:13:49.044847
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.321224, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414376| train set 1.038x speedup, test set 2.700x speedup, val set 1.057x speedup, step: 1, train time 17.26 s
Epoch 1/50 |loss: 0.339527| train set 1.990x speedup, test set 2.477x speedup, val set 0.983x speedup, step: 2, train time 15.02 s
Epoch 2/50 |loss: 0.305176| train set 2.123x speedup, test set 2.589x speedup, val set 0.987x speedup, step: 3, train time 15.13 s
Epoch 3/50 |loss: 0.282023| train set 2.402x speedup, test set 2.626x speedup, val set 0.921x speedup, step: 4, train time 15.16 s
Epoch 4/50 |loss: 0.268432| train set 2.765x speedup, test set 2.742x speedup, val set 1.132x speedup, step: 1, train time 16.02 s
Epoch 5/50 |loss: 0.248420| train set 2.226x speedup, test set 1.659x speedup, val set 1.039x speedup, step: 2, train time 14.99 s
Epoch 6/50 |loss: 0.235821| train set 2.760x speedup, test set 2.560x speedup, val set 1.048x speedup, step: 3, train time 14.53 s
Epoch 7/50 |loss: 0.226066| train set 2.198x speedup, test set 2.550x speedup, val set 0.912x speedup, step: 4, train time 14.74 s
Epoch 8/50 |loss: 0.210223| train set 2.844x speedup, test set 1.468x speedup, val set 1.039x speedup, step: 5, train time 14.90 s
Epoch 9/50 |loss: 0.203943| train set 2.577x speedup, test set 2.672x speedup, val set 1.121x speedup, step: 6, train time 14.99 s
Epoch 10/50 |loss: 0.198557| train set 2.894x speedup, test set 1.479x speedup, val set 0.902x speedup, step: 7, train time 14.84 s
Epoch 11/50 |loss: 0.185658| train set 2.511x speedup, test set 2.534x speedup, val set 1.039x speedup, step: 8, train time 14.83 s
Epoch 12/50 |loss: 0.180916| train set 2.817x speedup, test set 2.687x speedup, val set 1.034x speedup, step: 9, train time 14.91 s
Epoch 13/50 |loss: 0.180000| train set 2.734x speedup, test set 2.511x speedup, val set 0.909x speedup, step: 10, train time 14.77 s
Epoch 14/50 |loss: 0.173653| train set 2.752x speedup, test set 2.610x speedup, val set 0.819x speedup, step: 11, train time 14.95 s
Epoch 15/50 |loss: 0.161295| train set 2.654x speedup, test set 1.433x speedup, val set 0.934x speedup, step: 12, train time 14.74 s
Epoch 16/50 |loss: 0.159527| train set 2.977x speedup, test set 2.802x speedup, val set 1.031x speedup, step: 13, train time 15.02 s
Epoch 17/50 |loss: 0.149526| train set 2.613x speedup, test set 2.623x speedup, val set 1.076x speedup, step: 14, train time 14.72 s
Epoch 18/50 |loss: 0.146268| train set 2.947x speedup, test set 1.141x speedup, val set 1.031x speedup, step: 15, train time 14.83 s
Epoch 19/50 |loss: 0.144287| train set 2.857x speedup, test set 2.668x speedup, val set 1.031x speedup, step: 16, train time 14.91 s
Epoch 20/50 |loss: 0.138439| train set 2.867x speedup, test set 2.570x speedup, val set 1.076x speedup, step: 17, train time 14.95 s
Epoch 21/50 |loss: 0.131073| train set 2.387x speedup, test set 1.133x speedup, val set 0.968x speedup, step: 18, train time 14.84 s
Epoch 22/50 |loss: 0.133540| train set 2.640x speedup, test set 1.761x speedup, val set 0.909x speedup, step: 19, train time 15.04 s
Epoch 23/50 |loss: 0.120635| train set 2.949x speedup, test set 1.172x speedup, val set 1.031x speedup, step: 20, train time 15.20 s
Epoch 24/50 |loss: 0.124203| train set 3.031x speedup, test set 1.174x speedup, val set 1.076x speedup, step: 21, train time 15.13 s
Epoch 25/50 |loss: 0.123683| train set 2.879x speedup, test set 1.172x speedup, val set 0.896x speedup, step: 22, train time 15.12 s
Epoch 26/50 |loss: 0.125905| train set 2.969x speedup, test set 1.152x speedup, val set 1.076x speedup, step: 23, train time 15.13 s
Epoch 27/50 |loss: 0.115865| train set 3.047x speedup, test set 1.146x speedup, val set 1.031x speedup, step: 24, train time 15.11 s
Epoch 28/50 |loss: 0.110608| train set 2.962x speedup, test set 1.160x speedup, val set 0.920x speedup, step: 25, train time 15.12 s
Epoch 29/50 |loss: 0.109925| train set 2.959x speedup, test set 1.405x speedup, val set 0.957x speedup, step: 26, train time 15.27 s
Epoch 30/50 |loss: 0.109906| train set 2.561x speedup, test set 1.144x speedup, val set 0.953x speedup, step: 27, train time 15.33 s
Epoch 31/50 |loss: 0.107633| train set 2.952x speedup, test set 1.148x speedup, val set 1.048x speedup, step: 28, train time 15.03 s
Epoch 32/50 |loss: 0.105968| train set 2.731x speedup, test set 1.153x speedup, val set 0.953x speedup, step: 29, train time 14.97 s
Epoch 33/50 |loss: 0.098606| train set 3.000x speedup, test set 1.156x speedup, val set 1.031x speedup, step: 30, train time 15.12 s
Epoch 34/50 |loss: 0.101085| train set 2.522x speedup, test set 1.153x speedup, val set 0.957x speedup, step: 31, train time 14.93 s
Epoch 35/50 |loss: 0.103778| train set 2.983x speedup, test set 1.154x speedup, val set 1.076x speedup, step: 32, train time 15.12 s
Epoch 36/50 |loss: 0.097335| train set 2.959x speedup, test set 1.452x speedup, val set 0.957x speedup, step: 33, train time 15.03 s
Epoch 37/50 |loss: 0.098463| train set 2.911x speedup, test set 1.158x speedup, val set 1.076x speedup, step: 34, train time 15.23 s
Epoch 38/50 |loss: 0.101600| train set 2.981x speedup, test set 1.165x speedup, val set 1.076x speedup, step: 35, train time 15.32 s
Epoch 39/50 |loss: 0.092713| train set 3.023x speedup, test set 1.153x speedup, val set 1.076x speedup, step: 36, train time 15.12 s
Epoch 40/50 |loss: 0.093229| train set 2.780x speedup, test set 1.179x speedup, val set 0.972x speedup, step: 37, train time 15.24 s
Epoch 41/50 |loss: 0.089579| train set 2.881x speedup, test set 1.764x speedup, val set 0.957x speedup, step: 38, train time 15.11 s
Epoch 42/50 |loss: 0.094554| train set 3.046x speedup, test set 1.137x speedup, val set 0.972x speedup, step: 39, train time 15.15 s
Epoch 43/50 |loss: 0.090144| train set 2.986x speedup, test set 1.153x speedup, val set 0.957x speedup, step: 40, train time 15.13 s
Epoch 44/50 |loss: 0.090578| train set 2.980x speedup, test set 1.140x speedup, val set 0.957x speedup, step: 41, train time 14.93 s
Epoch 45/50 |loss: 0.089692| train set 3.020x speedup, test set 1.133x speedup, val set 0.972x speedup, step: 42, train time 15.32 s
Epoch 46/50 |loss: 0.085898| train set 2.950x speedup, test set 2.498x speedup, val set 0.972x speedup, step: 43, train time 15.10 s
Epoch 47/50 |loss: 0.088527| train set 3.019x speedup, test set 1.160x speedup, val set 0.957x speedup, step: 44, train time 15.22 s
Epoch 48/50 |loss: 0.086011| train set 2.865x speedup, test set 1.152x speedup, val set 0.953x speedup, step: 45, train time 15.03 s
Epoch 49/50 |loss: 0.083426| train set 2.764x speedup, test set 1.160x speedup, val set 0.968x speedup, step: 46, train time 15.14 s
Training per epoch cost 15.094 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 11.791s, pg runtime 5.572s, speedup 0.473x
30, opt runtime 5.539s, model runtime 10.142s, pg runtime 5.539s, speedup 0.546x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 27, train speedup 3.047, test speedup 1.146, val speedup 1.031
best test speedup epoch: 16, train speedup 2.977, test speedup 2.802, val speedup 1.031
best validation speedup epoch: 4, train speedup 2.765, test speedup 2.742, val speedup 1.132
last model at epoch 49, train speedup 2.764, test speedup 1.160, val speedup 0.968
execution cost 0:13:55.764291
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.422410, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414090| train set 1.039x speedup, test set 1.450x speedup, val set 0.989x speedup, step: 1, train time 17.33 s
Epoch 1/50 |loss: 0.339918| train set 1.018x speedup, test set 2.491x speedup, val set 0.971x speedup, step: 2, train time 15.11 s
Epoch 2/50 |loss: 0.308480| train set 2.209x speedup, test set 2.496x speedup, val set 0.987x speedup, step: 3, train time 15.13 s
Epoch 3/50 |loss: 0.283878| train set 1.926x speedup, test set 2.636x speedup, val set 0.769x speedup, step: 4, train time 14.54 s
Epoch 4/50 |loss: 0.266891| train set 2.665x speedup, test set 2.501x speedup, val set 0.980x speedup, step: 1, train time 15.45 s
Epoch 5/50 |loss: 0.248385| train set 2.206x speedup, test set 2.656x speedup, val set 0.987x speedup, step: 2, train time 14.91 s
Epoch 6/50 |loss: 0.234044| train set 2.663x speedup, test set 1.869x speedup, val set 1.048x speedup, step: 3, train time 14.90 s
Epoch 7/50 |loss: 0.225268| train set 2.272x speedup, test set 1.449x speedup, val set 0.824x speedup, step: 4, train time 14.90 s
Epoch 8/50 |loss: 0.204576| train set 2.702x speedup, test set 1.121x speedup, val set 1.056x speedup, step: 5, train time 14.73 s
Epoch 9/50 |loss: 0.203183| train set 2.679x speedup, test set 2.560x speedup, val set 1.048x speedup, step: 1, train time 14.71 s
Epoch 10/50 |loss: 0.196884| train set 2.486x speedup, test set 0.968x speedup, val set 0.822x speedup, step: 2, train time 14.80 s
Epoch 11/50 |loss: 0.182291| train set 2.266x speedup, test set 1.495x speedup, val set 0.931x speedup, step: 3, train time 14.83 s
Epoch 12/50 |loss: 0.178077| train set 2.659x speedup, test set 1.497x speedup, val set 1.034x speedup, step: 4, train time 14.92 s
Epoch 13/50 |loss: 0.174004| train set 2.659x speedup, test set 1.442x speedup, val set 0.987x speedup, step: 5, train time 14.64 s
Epoch 14/50 |loss: 0.167500| train set 2.786x speedup, test set 1.479x speedup, val set 0.957x speedup, step: 6, train time 14.94 s
Epoch 15/50 |loss: 0.159650| train set 2.876x speedup, test set 1.477x speedup, val set 1.065x speedup, step: 7, train time 14.73 s
Epoch 16/50 |loss: 0.152324| train set 2.844x speedup, test set 0.991x speedup, val set 0.821x speedup, step: 8, train time 14.92 s
Epoch 17/50 |loss: 0.147470| train set 2.633x speedup, test set 0.974x speedup, val set 1.031x speedup, step: 9, train time 14.82 s
Epoch 18/50 |loss: 0.142460| train set 2.928x speedup, test set 1.505x speedup, val set 1.047x speedup, step: 10, train time 14.82 s
Epoch 19/50 |loss: 0.140974| train set 2.771x speedup, test set 1.505x speedup, val set 1.153x speedup, step: 1, train time 14.85 s
Epoch 20/50 |loss: 0.134067| train set 2.880x speedup, test set 1.494x speedup, val set 0.971x speedup, step: 2, train time 14.82 s
Epoch 21/50 |loss: 0.128023| train set 2.672x speedup, test set 1.462x speedup, val set 0.974x speedup, step: 3, train time 14.82 s
Epoch 22/50 |loss: 0.126451| train set 2.677x speedup, test set 0.970x speedup, val set 1.044x speedup, step: 4, train time 14.67 s
Epoch 23/50 |loss: 0.122082| train set 3.005x speedup, test set 1.417x speedup, val set 1.111x speedup, step: 5, train time 14.86 s
Epoch 24/50 |loss: 0.119422| train set 3.049x speedup, test set 0.985x speedup, val set 1.043x speedup, step: 6, train time 14.74 s
Epoch 25/50 |loss: 0.120193| train set 2.901x speedup, test set 1.433x speedup, val set 0.956x speedup, step: 7, train time 14.93 s
Epoch 26/50 |loss: 0.125753| train set 2.939x speedup, test set 0.981x speedup, val set 1.026x speedup, step: 8, train time 14.53 s
Epoch 27/50 |loss: 0.116865| train set 2.970x speedup, test set 1.437x speedup, val set 1.026x speedup, step: 9, train time 14.73 s
Epoch 28/50 |loss: 0.110700| train set 2.983x speedup, test set 0.990x speedup, val set 1.077x speedup, step: 10, train time 14.65 s
Epoch 29/50 |loss: 0.109548| train set 2.942x speedup, test set 0.978x speedup, val set 1.043x speedup, step: 11, train time 14.73 s
Epoch 30/50 |loss: 0.112691| train set 3.021x speedup, test set 1.430x speedup, val set 1.021x speedup, step: 12, train time 14.73 s
Epoch 31/50 |loss: 0.106027| train set 2.961x speedup, test set 1.452x speedup, val set 1.231x speedup, step: 13, train time 14.85 s
Epoch 32/50 |loss: 0.109213| train set 2.819x speedup, test set 0.998x speedup, val set 1.127x speedup, step: 14, train time 14.73 s
Epoch 33/50 |loss: 0.098715| train set 3.012x speedup, test set 1.509x speedup, val set 1.165x speedup, step: 15, train time 14.83 s
Epoch 34/50 |loss: 0.102307| train set 2.969x speedup, test set 1.582x speedup, val set 0.957x speedup, step: 16, train time 14.84 s
Epoch 35/50 |loss: 0.099040| train set 2.970x speedup, test set 0.998x speedup, val set 1.077x speedup, step: 17, train time 14.82 s
Epoch 36/50 |loss: 0.094993| train set 2.942x speedup, test set 1.509x speedup, val set 0.971x speedup, step: 18, train time 14.93 s
Epoch 37/50 |loss: 0.095819| train set 2.966x speedup, test set 1.459x speedup, val set 1.211x speedup, step: 19, train time 14.84 s
Epoch 38/50 |loss: 0.094308| train set 3.045x speedup, test set 1.483x speedup, val set 1.026x speedup, step: 20, train time 14.93 s
Epoch 39/50 |loss: 0.092603| train set 2.890x speedup, test set 1.457x speedup, val set 1.165x speedup, step: 1, train time 15.03 s
Epoch 40/50 |loss: 0.091933| train set 3.048x speedup, test set 1.514x speedup, val set 1.026x speedup, step: 2, train time 14.82 s
Epoch 41/50 |loss: 0.091718| train set 2.979x speedup, test set 1.472x speedup, val set 1.026x speedup, step: 3, train time 14.81 s
Epoch 42/50 |loss: 0.093505| train set 2.887x speedup, test set 1.465x speedup, val set 1.127x speedup, step: 4, train time 15.04 s
Epoch 43/50 |loss: 0.087952| train set 2.826x speedup, test set 1.519x speedup, val set 1.127x speedup, step: 5, train time 14.93 s
Epoch 44/50 |loss: 0.089078| train set 2.987x speedup, test set 1.537x speedup, val set 1.127x speedup, step: 6, train time 14.93 s
Epoch 45/50 |loss: 0.091479| train set 2.737x speedup, test set 0.986x speedup, val set 1.026x speedup, step: 7, train time 14.83 s
Epoch 46/50 |loss: 0.086865| train set 3.030x speedup, test set 1.512x speedup, val set 1.127x speedup, step: 8, train time 14.93 s
Epoch 47/50 |loss: 0.092168| train set 2.938x speedup, test set 1.531x speedup, val set 1.026x speedup, step: 9, train time 14.91 s
Epoch 48/50 |loss: 0.086750| train set 2.884x speedup, test set 1.421x speedup, val set 1.021x speedup, step: 10, train time 14.95 s
Epoch 49/50 |loss: 0.087512| train set 2.806x speedup, test set 1.014x speedup, val set 0.980x speedup, step: 11, train time 14.91 s
Training per epoch cost 14.901 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 48.407s, pg runtime 32.939s, speedup 0.680x
18, opt runtime 6.149s, model runtime 45.581s, pg runtime 30.760s, speedup 0.675x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.757s, pg runtime 32.969s, speedup 2.804x
24, opt runtime 6.234s, model runtime 11.767s, pg runtime 32.540s, speedup 2.765x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 605.138s, pg runtime 626.529s, speedup 1.035x
32, opt runtime 24.662s, model runtime 615.484s, pg runtime 613.999s, speedup 0.998x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.244s, pg runtime 1.206s, speedup 0.970x
40, opt runtime 1.086s, model runtime 1.160s, pg runtime 1.181s, speedup 1.018x
====================
best train speedup epoch: 24, train speedup 3.049, test speedup 0.985, val speedup 1.043
best test speedup epoch: 5, train speedup 2.206, test speedup 2.656, val speedup 0.987
best validation speedup epoch: 39, train speedup 2.890, test speedup 1.457, val speedup 1.165
last model at epoch 49, train speedup 2.806, test speedup 1.014, val speedup 0.980
execution cost 0:13:45.660968
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.804269, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.413546| train set 1.033x speedup, test set 2.526x speedup, val set 1.057x speedup, step: 1, train time 9.79 s
Epoch 1/50 |loss: 0.339192| train set 1.018x speedup, test set 2.548x speedup, val set 0.973x speedup, step: 2, train time 8.79 s
Epoch 2/50 |loss: 0.305680| train set 2.195x speedup, test set 2.422x speedup, val set 0.948x speedup, step: 3, train time 8.42 s
Epoch 3/50 |loss: 0.281891| train set 1.964x speedup, test set 2.603x speedup, val set 0.851x speedup, step: 4, train time 8.60 s
Epoch 4/50 |loss: 0.264823| train set 2.774x speedup, test set 2.786x speedup, val set 1.065x speedup, step: 1, train time 9.02 s
Epoch 5/50 |loss: 0.243600| train set 2.287x speedup, test set 2.572x speedup, val set 1.043x speedup, step: 2, train time 8.50 s
Epoch 6/50 |loss: 0.228991| train set 2.488x speedup, test set 1.425x speedup, val set 0.909x speedup, step: 3, train time 8.41 s
Epoch 7/50 |loss: 0.221000| train set 2.224x speedup, test set 1.402x speedup, val set 0.769x speedup, step: 4, train time 8.60 s
Epoch 8/50 |loss: 0.203175| train set 2.619x speedup, test set 1.407x speedup, val set 0.915x speedup, step: 5, train time 8.61 s
Epoch 9/50 |loss: 0.194691| train set 2.620x speedup, test set 1.000x speedup, val set 1.067x speedup, step: 1, train time 8.59 s
Epoch 10/50 |loss: 0.195541| train set 2.899x speedup, test set 0.993x speedup, val set 1.044x speedup, step: 2, train time 8.51 s
Epoch 11/50 |loss: 0.175532| train set 2.770x speedup, test set 1.792x speedup, val set 1.153x speedup, step: 3, train time 8.50 s
Epoch 12/50 |loss: 0.176488| train set 2.392x speedup, test set 1.007x speedup, val set 1.080x speedup, step: 4, train time 8.41 s
Epoch 13/50 |loss: 0.174125| train set 2.657x speedup, test set 1.419x speedup, val set 0.987x speedup, step: 5, train time 8.61 s
Epoch 14/50 |loss: 0.166212| train set 2.772x speedup, test set 1.444x speedup, val set 1.211x speedup, step: 1, train time 8.50 s
Epoch 15/50 |loss: 0.154090| train set 2.764x speedup, test set 1.429x speedup, val set 0.987x speedup, step: 2, train time 8.40 s
Epoch 16/50 |loss: 0.152730| train set 2.782x speedup, test set 0.996x speedup, val set 1.061x speedup, step: 3, train time 8.35 s
Epoch 17/50 |loss: 0.145922| train set 2.608x speedup, test set 1.431x speedup, val set 1.211x speedup, step: 4, train time 8.41 s
Epoch 18/50 |loss: 0.142553| train set 3.007x speedup, test set 1.429x speedup, val set 1.153x speedup, step: 5, train time 8.30 s
Epoch 19/50 |loss: 0.138330| train set 2.754x speedup, test set 1.460x speedup, val set 1.153x speedup, step: 6, train time 8.60 s
Epoch 20/50 |loss: 0.138593| train set 2.879x speedup, test set 1.450x speedup, val set 1.211x speedup, step: 7, train time 8.92 s
Epoch 21/50 |loss: 0.125735| train set 2.401x speedup, test set 1.362x speedup, val set 1.057x speedup, step: 8, train time 8.61 s
Epoch 22/50 |loss: 0.129864| train set 2.626x speedup, test set 1.430x speedup, val set 1.044x speedup, step: 9, train time 8.40 s
Epoch 23/50 |loss: 0.116723| train set 2.844x speedup, test set 1.430x speedup, val set 0.874x speedup, step: 10, train time 8.71 s
Epoch 24/50 |loss: 0.117763| train set 2.974x speedup, test set 1.383x speedup, val set 0.972x speedup, step: 11, train time 8.32 s
Epoch 25/50 |loss: 0.121075| train set 2.964x speedup, test set 2.527x speedup, val set 1.031x speedup, step: 12, train time 8.42 s
Epoch 26/50 |loss: 0.125732| train set 3.043x speedup, test set 1.452x speedup, val set 1.231x speedup, step: 13, train time 8.49 s
Epoch 27/50 |loss: 0.113408| train set 2.963x speedup, test set 1.396x speedup, val set 1.077x speedup, step: 14, train time 8.81 s
Epoch 28/50 |loss: 0.111005| train set 2.985x speedup, test set 1.416x speedup, val set 1.017x speedup, step: 15, train time 8.61 s
Epoch 29/50 |loss: 0.107693| train set 2.860x speedup, test set 1.354x speedup, val set 1.017x speedup, step: 16, train time 8.51 s
Epoch 30/50 |loss: 0.108960| train set 3.024x speedup, test set 1.394x speedup, val set 0.997x speedup, step: 17, train time 8.81 s
Epoch 31/50 |loss: 0.103089| train set 2.728x speedup, test set 1.440x speedup, val set 1.153x speedup, step: 18, train time 8.53 s
Epoch 32/50 |loss: 0.109887| train set 2.862x speedup, test set 1.444x speedup, val set 1.040x speedup, step: 19, train time 8.60 s
Epoch 33/50 |loss: 0.097182| train set 3.010x speedup, test set 2.525x speedup, val set 1.231x speedup, step: 20, train time 8.43 s
Epoch 34/50 |loss: 0.099088| train set 2.978x speedup, test set 2.503x speedup, val set 1.001x speedup, step: 21, train time 8.35 s
Epoch 35/50 |loss: 0.099167| train set 2.968x speedup, test set 1.386x speedup, val set 1.153x speedup, step: 22, train time 8.40 s
Epoch 36/50 |loss: 0.096937| train set 2.982x speedup, test set 1.428x speedup, val set 1.231x speedup, step: 23, train time 8.53 s
Epoch 37/50 |loss: 0.092506| train set 2.945x speedup, test set 1.373x speedup, val set 1.153x speedup, step: 24, train time 8.43 s
Epoch 38/50 |loss: 0.097901| train set 3.033x speedup, test set 1.430x speedup, val set 1.153x speedup, step: 25, train time 8.23 s
Epoch 39/50 |loss: 0.091670| train set 3.010x speedup, test set 1.396x speedup, val set 1.211x speedup, step: 1, train time 8.40 s
Epoch 40/50 |loss: 0.087062| train set 2.993x speedup, test set 1.425x speedup, val set 1.153x speedup, step: 2, train time 8.51 s
Epoch 41/50 |loss: 0.088087| train set 2.746x speedup, test set 1.373x speedup, val set 1.043x speedup, step: 3, train time 8.60 s
Epoch 42/50 |loss: 0.097743| train set 3.004x speedup, test set 2.548x speedup, val set 1.153x speedup, step: 4, train time 8.61 s
Epoch 43/50 |loss: 0.084546| train set 2.974x speedup, test set 1.770x speedup, val set 0.987x speedup, step: 5, train time 8.69 s
Epoch 44/50 |loss: 0.088753| train set 2.988x speedup, test set 1.364x speedup, val set 1.061x speedup, step: 6, train time 8.41 s
Epoch 45/50 |loss: 0.088576| train set 3.033x speedup, test set 1.386x speedup, val set 1.047x speedup, step: 7, train time 8.60 s
Epoch 46/50 |loss: 0.082394| train set 2.957x speedup, test set 2.643x speedup, val set 1.211x speedup, step: 8, train time 8.71 s
Epoch 47/50 |loss: 0.093004| train set 2.947x speedup, test set 1.612x speedup, val set 1.211x speedup, step: 9, train time 8.92 s
Epoch 48/50 |loss: 0.082586| train set 2.855x speedup, test set 1.396x speedup, val set 1.061x speedup, step: 10, train time 8.73 s
Epoch 49/50 |loss: 0.082682| train set 3.030x speedup, test set 1.352x speedup, val set 0.824x speedup, step: 11, train time 8.63 s
Training per epoch cost 8.577 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
08, opt runtime 7.377s, model runtime 37.574s, pg runtime 28.655s, speedup 0.763x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 9.462s, pg runtime 7.799s, speedup 0.824x
28, opt runtime 7.199s, model runtime 9.907s, pg runtime 7.619s, speedup 0.769x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 26, train speedup 3.043, test speedup 1.452, val speedup 1.231
best test speedup epoch: 4, train speedup 2.774, test speedup 2.786, val speedup 1.065
best validation speedup epoch: 39, train speedup 3.010, test speedup 1.396, val speedup 1.211
last model at epoch 49, train speedup 3.030, test speedup 1.352, val speedup 0.824
execution cost 0:07:40.470790
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.705973, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.412945| train set 1.038x speedup, test set 2.599x speedup, val set 1.057x speedup, step: 1, train time 9.50 s
Epoch 1/50 |loss: 0.337507| train set 1.018x speedup, test set 2.566x speedup, val set 0.983x speedup, step: 2, train time 8.40 s
Epoch 2/50 |loss: 0.304166| train set 2.114x speedup, test set 2.498x speedup, val set 0.983x speedup, step: 3, train time 8.51 s
Epoch 3/50 |loss: 0.283150| train set 2.554x speedup, test set 2.766x speedup, val set 1.069x speedup, step: 4, train time 8.62 s
Epoch 4/50 |loss: 0.263741| train set 2.398x speedup, test set 2.536x speedup, val set 1.065x speedup, step: 1, train time 8.91 s
Epoch 5/50 |loss: 0.245574| train set 2.351x speedup, test set 1.428x speedup, val set 1.043x speedup, step: 2, train time 8.31 s
Epoch 6/50 |loss: 0.230366| train set 2.775x speedup, test set 2.760x speedup, val set 1.037x speedup, step: 3, train time 8.70 s
Epoch 7/50 |loss: 0.223903| train set 2.013x speedup, test set 1.425x speedup, val set 0.896x speedup, step: 4, train time 8.39 s
Epoch 8/50 |loss: 0.205257| train set 2.801x speedup, test set 2.710x speedup, val set 0.915x speedup, step: 5, train time 8.52 s
Epoch 9/50 |loss: 0.200297| train set 2.822x speedup, test set 1.440x speedup, val set 1.133x speedup, step: 1, train time 8.60 s
Epoch 10/50 |loss: 0.200100| train set 2.757x speedup, test set 2.616x speedup, val set 0.972x speedup, step: 2, train time 8.52 s
Epoch 11/50 |loss: 0.183731| train set 2.717x speedup, test set 2.758x speedup, val set 1.114x speedup, step: 3, train time 8.51 s
Epoch 12/50 |loss: 0.179773| train set 2.625x speedup, test set 2.688x speedup, val set 1.094x speedup, step: 4, train time 8.31 s
Epoch 13/50 |loss: 0.178457| train set 2.661x speedup, test set 2.562x speedup, val set 0.987x speedup, step: 5, train time 8.51 s
Epoch 14/50 |loss: 0.172606| train set 2.778x speedup, test set 2.702x speedup, val set 1.076x speedup, step: 6, train time 8.20 s
Epoch 15/50 |loss: 0.162262| train set 2.708x speedup, test set 1.436x speedup, val set 1.094x speedup, step: 7, train time 8.72 s
Epoch 16/50 |loss: 0.155116| train set 2.789x speedup, test set 1.725x speedup, val set 0.908x speedup, step: 8, train time 8.30 s
Epoch 17/50 |loss: 0.152130| train set 2.618x speedup, test set 1.411x speedup, val set 1.189x speedup, step: 9, train time 8.81 s
Epoch 18/50 |loss: 0.149403| train set 2.975x speedup, test set 2.673x speedup, val set 1.031x speedup, step: 10, train time 8.49 s
Epoch 19/50 |loss: 0.142891| train set 2.764x speedup, test set 1.411x speedup, val set 1.076x speedup, step: 11, train time 8.59 s
Epoch 20/50 |loss: 0.144099| train set 2.736x speedup, test set 1.678x speedup, val set 1.189x speedup, step: 12, train time 8.68 s
Epoch 21/50 |loss: 0.130709| train set 2.206x speedup, test set 1.436x speedup, val set 0.957x speedup, step: 13, train time 8.62 s
Epoch 22/50 |loss: 0.136508| train set 2.616x speedup, test set 2.617x speedup, val set 0.896x speedup, step: 14, train time 8.53 s
Epoch 23/50 |loss: 0.123567| train set 3.005x speedup, test set 2.589x speedup, val set 1.189x speedup, step: 15, train time 8.62 s
Epoch 24/50 |loss: 0.126703| train set 3.047x speedup, test set 1.416x speedup, val set 1.076x speedup, step: 16, train time 8.42 s
Epoch 25/50 |loss: 0.124013| train set 2.961x speedup, test set 1.689x speedup, val set 1.031x speedup, step: 17, train time 8.73 s
Epoch 26/50 |loss: 0.132063| train set 2.944x speedup, test set 2.674x speedup, val set 1.211x speedup, step: 18, train time 8.51 s
Epoch 27/50 |loss: 0.116694| train set 2.989x speedup, test set 1.657x speedup, val set 1.031x speedup, step: 19, train time 8.61 s
Epoch 28/50 |loss: 0.114626| train set 2.881x speedup, test set 1.677x speedup, val set 1.153x speedup, step: 20, train time 8.71 s
Epoch 29/50 |loss: 0.116166| train set 2.771x speedup, test set 1.691x speedup, val set 1.021x speedup, step: 21, train time 8.39 s
Epoch 30/50 |loss: 0.111847| train set 2.526x speedup, test set 1.411x speedup, val set 0.953x speedup, step: 22, train time 8.62 s
Epoch 31/50 |loss: 0.107452| train set 2.496x speedup, test set 2.631x speedup, val set 1.076x speedup, step: 23, train time 8.41 s
Epoch 32/50 |loss: 0.113455| train set 2.803x speedup, test set 1.634x speedup, val set 0.948x speedup, step: 24, train time 8.41 s
Epoch 33/50 |loss: 0.105354| train set 3.004x speedup, test set 1.422x speedup, val set 1.076x speedup, step: 25, train time 8.51 s
Epoch 34/50 |loss: 0.106602| train set 3.013x speedup, test set 2.619x speedup, val set 0.957x speedup, step: 26, train time 8.51 s
Epoch 35/50 |loss: 0.104092| train set 2.951x speedup, test set 2.522x speedup, val set 1.133x speedup, step: 27, train time 8.22 s
Epoch 36/50 |loss: 0.097080| train set 2.882x speedup, test set 2.625x speedup, val set 1.076x speedup, step: 28, train time 8.67 s
Epoch 37/50 |loss: 0.103125| train set 2.938x speedup, test set 2.512x speedup, val set 1.211x speedup, step: 29, train time 8.32 s
Epoch 38/50 |loss: 0.096510| train set 3.049x speedup, test set 2.590x speedup, val set 1.076x speedup, step: 30, train time 8.51 s
Epoch 39/50 |loss: 0.090439| train set 3.007x speedup, test set 2.592x speedup, val set 1.076x speedup, step: 31, train time 8.53 s
Epoch 40/50 |loss: 0.097911| train set 2.978x speedup, test set 1.381x speedup, val set 1.076x speedup, step: 32, train time 8.33 s
Epoch 41/50 |loss: 0.089846| train set 3.025x speedup, test set 1.445x speedup, val set 1.076x speedup, step: 33, train time 8.50 s
Epoch 42/50 |loss: 0.101763| train set 2.981x speedup, test set 2.562x speedup, val set 1.034x speedup, step: 34, train time 8.42 s
Epoch 43/50 |loss: 0.091326| train set 2.831x speedup, test set 2.554x speedup, val set 0.896x speedup, step: 35, train time 9.02 s
Epoch 44/50 |loss: 0.090084| train set 2.988x speedup, test set 2.553x speedup, val set 1.044x speedup, step: 36, train time 8.49 s
Epoch 45/50 |loss: 0.091819| train set 2.974x speedup, test set 1.421x speedup, val set 1.076x speedup, step: 37, train time 8.70 s
Epoch 46/50 |loss: 0.088803| train set 3.020x speedup, test set 2.575x speedup, val set 1.076x speedup, step: 38, train time 8.71 s
Epoch 47/50 |loss: 0.092114| train set 2.664x speedup, test set 2.674x speedup, val set 1.189x speedup, step: 39, train time 8.20 s
Epoch 48/50 |loss: 0.085713| train set 3.003x speedup, test set 2.486x speedup, val set 1.189x speedup, step: 40, train time 8.39 s
Epoch 49/50 |loss: 0.084739| train set 3.022x speedup, test set 2.449x speedup, val set 0.896x speedup, step: 41, train time 8.41 s
Training per epoch cost 8.542 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 38, train speedup 3.049, test speedup 2.590, val speedup 1.076
best test speedup epoch: 3, train speedup 2.554, test speedup 2.766, val speedup 1.069
best validation speedup epoch: 9, train speedup 2.822, test speedup 1.440, val speedup 1.133
last model at epoch 49, train speedup 3.022, test speedup 2.449, val speedup 0.896
execution cost 0:07:37.997981
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.719310, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414942| train set 1.037x speedup, test set 2.567x speedup, val set 0.985x speedup, step: 1, train time 9.96 s
Epoch 1/50 |loss: 0.338818| train set 1.018x speedup, test set 2.454x speedup, val set 0.983x speedup, step: 2, train time 8.61 s
Epoch 2/50 |loss: 0.308222| train set 2.457x speedup, test set 2.474x speedup, val set 0.987x speedup, step: 3, train time 8.61 s
Epoch 3/50 |loss: 0.282110| train set 2.132x speedup, test set 2.648x speedup, val set 0.868x speedup, step: 4, train time 8.33 s
Epoch 4/50 |loss: 0.264774| train set 2.374x speedup, test set 2.646x speedup, val set 0.833x speedup, step: 1, train time 9.11 s
Epoch 5/50 |loss: 0.243696| train set 2.085x speedup, test set 2.574x speedup, val set 0.985x speedup, step: 2, train time 8.31 s
Epoch 6/50 |loss: 0.233230| train set 2.501x speedup, test set 2.556x speedup, val set 0.822x speedup, step: 3, train time 8.99 s
Epoch 7/50 |loss: 0.223048| train set 2.250x speedup, test set 2.604x speedup, val set 1.069x speedup, step: 4, train time 8.32 s
Epoch 8/50 |loss: 0.204732| train set 2.803x speedup, test set 2.643x speedup, val set 0.915x speedup, step: 5, train time 8.30 s
Epoch 9/50 |loss: 0.200426| train set 2.821x speedup, test set 2.556x speedup, val set 1.065x speedup, step: 1, train time 8.22 s
Epoch 10/50 |loss: 0.197840| train set 2.443x speedup, test set 2.574x speedup, val set 0.920x speedup, step: 2, train time 8.30 s
Epoch 11/50 |loss: 0.183144| train set 2.221x speedup, test set 2.525x speedup, val set 0.920x speedup, step: 3, train time 8.42 s
Epoch 12/50 |loss: 0.180398| train set 2.766x speedup, test set 2.644x speedup, val set 1.031x speedup, step: 4, train time 8.70 s
Epoch 13/50 |loss: 0.179728| train set 2.783x speedup, test set 2.459x speedup, val set 1.047x speedup, step: 5, train time 8.39 s
Epoch 14/50 |loss: 0.172723| train set 2.755x speedup, test set 2.652x speedup, val set 0.971x speedup, step: 6, train time 8.50 s
Epoch 15/50 |loss: 0.157532| train set 2.840x speedup, test set 2.511x speedup, val set 0.933x speedup, step: 7, train time 8.42 s
Epoch 16/50 |loss: 0.152939| train set 2.983x speedup, test set 2.438x speedup, val set 1.047x speedup, step: 8, train time 8.40 s
Epoch 17/50 |loss: 0.150541| train set 2.641x speedup, test set 2.574x speedup, val set 0.971x speedup, step: 9, train time 8.61 s
Epoch 18/50 |loss: 0.144319| train set 2.929x speedup, test set 2.449x speedup, val set 1.047x speedup, step: 10, train time 8.43 s
Epoch 19/50 |loss: 0.144066| train set 2.843x speedup, test set 2.607x speedup, val set 1.047x speedup, step: 11, train time 8.40 s
Epoch 20/50 |loss: 0.141055| train set 3.007x speedup, test set 1.745x speedup, val set 0.933x speedup, step: 12, train time 8.70 s
Epoch 21/50 |loss: 0.129765| train set 2.676x speedup, test set 2.384x speedup, val set 0.967x speedup, step: 13, train time 8.69 s
Epoch 22/50 |loss: 0.133025| train set 2.816x speedup, test set 2.498x speedup, val set 0.896x speedup, step: 14, train time 8.40 s
Epoch 23/50 |loss: 0.124086| train set 2.978x speedup, test set 2.372x speedup, val set 0.822x speedup, step: 15, train time 8.33 s
Epoch 24/50 |loss: 0.119913| train set 2.971x speedup, test set 2.371x speedup, val set 0.971x speedup, step: 16, train time 8.72 s
Epoch 25/50 |loss: 0.122543| train set 2.976x speedup, test set 2.523x speedup, val set 1.031x speedup, step: 17, train time 8.39 s
Epoch 26/50 |loss: 0.123073| train set 3.005x speedup, test set 2.511x speedup, val set 1.047x speedup, step: 18, train time 8.24 s
Epoch 27/50 |loss: 0.114859| train set 3.047x speedup, test set 2.466x speedup, val set 1.047x speedup, step: 19, train time 8.61 s
Epoch 28/50 |loss: 0.107421| train set 2.984x speedup, test set 2.363x speedup, val set 1.047x speedup, step: 20, train time 8.52 s
Epoch 29/50 |loss: 0.112335| train set 2.899x speedup, test set 2.589x speedup, val set 0.971x speedup, step: 21, train time 8.31 s
Epoch 30/50 |loss: 0.109856| train set 2.978x speedup, test set 1.736x speedup, val set 0.967x speedup, step: 22, train time 8.61 s
Epoch 31/50 |loss: 0.105571| train set 2.960x speedup, test set 1.752x speedup, val set 1.111x speedup, step: 23, train time 8.50 s
Epoch 32/50 |loss: 0.108693| train set 2.970x speedup, test set 1.740x speedup, val set 0.971x speedup, step: 24, train time 8.40 s
Epoch 33/50 |loss: 0.096076| train set 3.005x speedup, test set 2.401x speedup, val set 1.047x speedup, step: 25, train time 8.61 s
Epoch 34/50 |loss: 0.103028| train set 2.719x speedup, test set 2.426x speedup, val set 1.098x speedup, step: 1, train time 8.32 s
Epoch 35/50 |loss: 0.102325| train set 2.922x speedup, test set 2.667x speedup, val set 1.047x speedup, step: 2, train time 8.23 s
Epoch 36/50 |loss: 0.091651| train set 2.804x speedup, test set 2.566x speedup, val set 1.094x speedup, step: 3, train time 8.60 s
Epoch 37/50 |loss: 0.103050| train set 2.919x speedup, test set 2.431x speedup, val set 1.094x speedup, step: 4, train time 8.60 s
Epoch 38/50 |loss: 0.104485| train set 2.987x speedup, test set 2.566x speedup, val set 1.048x speedup, step: 5, train time 8.54 s
Epoch 39/50 |loss: 0.088463| train set 3.043x speedup, test set 2.431x speedup, val set 1.047x speedup, step: 6, train time 8.52 s
Epoch 40/50 |loss: 0.090206| train set 3.044x speedup, test set 2.566x speedup, val set 1.047x speedup, step: 7, train time 8.51 s
Epoch 41/50 |loss: 0.089350| train set 3.026x speedup, test set 2.533x speedup, val set 0.908x speedup, step: 8, train time 8.31 s
Epoch 42/50 |loss: 0.097620| train set 2.853x speedup, test set 2.431x speedup, val set 1.047x speedup, step: 9, train time 8.61 s
Epoch 43/50 |loss: 0.085300| train set 2.980x speedup, test set 2.525x speedup, val set 1.047x speedup, step: 10, train time 8.41 s
Epoch 44/50 |loss: 0.085593| train set 2.944x speedup, test set 2.560x speedup, val set 1.047x speedup, step: 11, train time 8.22 s
Epoch 45/50 |loss: 0.095082| train set 2.931x speedup, test set 2.412x speedup, val set 1.165x speedup, step: 12, train time 8.50 s
Epoch 46/50 |loss: 0.084373| train set 2.955x speedup, test set 2.558x speedup, val set 1.047x speedup, step: 13, train time 8.72 s
Epoch 47/50 |loss: 0.091659| train set 2.826x speedup, test set 2.587x speedup, val set 1.094x speedup, step: 14, train time 8.41 s
Epoch 48/50 |loss: 0.086951| train set 2.874x speedup, test set 2.594x speedup, val set 1.090x speedup, step: 15, train time 8.51 s
Epoch 49/50 |loss: 0.082849| train set 3.043x speedup, test set 2.456x speedup, val set 1.047x speedup, step: 16, train time 8.59 s
Training per epoch cost 8.519 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.641s, pg runtime 1.438s, speedup 0.876x
20, opt runtime 1.428s, model runtime 1.764s, pg runtime 1.428s, speedup 0.810x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 27, train speedup 3.047, test speedup 2.466, val speedup 1.047
best test speedup epoch: 35, train speedup 2.922, test speedup 2.667, val speedup 1.047
best validation speedup epoch: 34, train speedup 2.719, test speedup 2.426, val speedup 1.098
last model at epoch 49, train speedup 3.043, test speedup 2.456, val speedup 1.047
execution cost 0:07:38.422717
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.725436, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.413917| train set 1.039x speedup, test set 1.450x speedup, val set 0.985x speedup, step: 1, train time 9.46 s
Epoch 1/50 |loss: 0.338545| train set 1.840x speedup, test set 2.623x speedup, val set 0.983x speedup, step: 2, train time 8.41 s
Epoch 2/50 |loss: 0.306780| train set 2.217x speedup, test set 1.692x speedup, val set 0.987x speedup, step: 3, train time 8.43 s
Epoch 3/50 |loss: 0.278421| train set 2.237x speedup, test set 2.789x speedup, val set 0.997x speedup, step: 4, train time 8.50 s
Epoch 4/50 |loss: 0.262326| train set 2.756x speedup, test set 1.404x speedup, val set 0.948x speedup, step: 1, train time 9.12 s
Epoch 5/50 |loss: 0.242851| train set 1.999x speedup, test set 2.592x speedup, val set 1.127x speedup, step: 2, train time 8.51 s
Epoch 6/50 |loss: 0.234965| train set 2.802x speedup, test set 1.729x speedup, val set 1.070x speedup, step: 3, train time 8.40 s
Epoch 7/50 |loss: 0.224014| train set 2.274x speedup, test set 1.403x speedup, val set 0.898x speedup, step: 4, train time 8.39 s
Epoch 8/50 |loss: 0.206915| train set 2.691x speedup, test set 1.666x speedup, val set 0.916x speedup, step: 5, train time 8.42 s
Epoch 9/50 |loss: 0.201476| train set 2.498x speedup, test set 1.446x speedup, val set 1.133x speedup, step: 1, train time 8.49 s
Epoch 10/50 |loss: 0.200938| train set 2.754x speedup, test set 1.415x speedup, val set 0.874x speedup, step: 2, train time 8.40 s
Epoch 11/50 |loss: 0.184083| train set 2.731x speedup, test set 1.425x speedup, val set 1.062x speedup, step: 3, train time 8.29 s
Epoch 12/50 |loss: 0.177461| train set 2.788x speedup, test set 2.609x speedup, val set 1.034x speedup, step: 4, train time 8.52 s
Epoch 13/50 |loss: 0.183581| train set 2.606x speedup, test set 1.390x speedup, val set 0.974x speedup, step: 5, train time 8.89 s
Epoch 14/50 |loss: 0.171241| train set 2.778x speedup, test set 1.440x speedup, val set 1.044x speedup, step: 6, train time 8.60 s
Epoch 15/50 |loss: 0.158644| train set 2.713x speedup, test set 1.369x speedup, val set 0.811x speedup, step: 7, train time 8.21 s
Epoch 16/50 |loss: 0.152551| train set 2.787x speedup, test set 1.395x speedup, val set 0.874x speedup, step: 8, train time 8.62 s
Epoch 17/50 |loss: 0.149619| train set 2.501x speedup, test set 0.998x speedup, val set 1.076x speedup, step: 9, train time 8.52 s
Epoch 18/50 |loss: 0.145075| train set 3.041x speedup, test set 1.448x speedup, val set 0.811x speedup, step: 10, train time 8.62 s
Epoch 19/50 |loss: 0.142402| train set 2.438x speedup, test set 1.432x speedup, val set 0.920x speedup, step: 11, train time 8.49 s
Epoch 20/50 |loss: 0.144388| train set 2.879x speedup, test set 1.411x speedup, val set 0.957x speedup, step: 12, train time 8.41 s
Epoch 21/50 |loss: 0.128954| train set 2.353x speedup, test set 0.993x speedup, val set 0.957x speedup, step: 13, train time 8.53 s
Epoch 22/50 |loss: 0.129496| train set 2.620x speedup, test set 0.978x speedup, val set 0.874x speedup, step: 14, train time 8.31 s
Epoch 23/50 |loss: 0.122670| train set 2.853x speedup, test set 0.979x speedup, val set 0.874x speedup, step: 15, train time 8.42 s
Epoch 24/50 |loss: 0.121037| train set 3.033x speedup, test set 1.000x speedup, val set 0.811x speedup, step: 16, train time 8.63 s
Epoch 25/50 |loss: 0.125697| train set 2.931x speedup, test set 1.646x speedup, val set 0.896x speedup, step: 17, train time 8.50 s
Epoch 26/50 |loss: 0.127806| train set 2.967x speedup, test set 1.002x speedup, val set 0.822x speedup, step: 18, train time 8.51 s
Epoch 27/50 |loss: 0.117813| train set 2.846x speedup, test set 0.974x speedup, val set 0.957x speedup, step: 19, train time 8.70 s
Epoch 28/50 |loss: 0.109790| train set 2.951x speedup, test set 0.979x speedup, val set 1.001x speedup, step: 20, train time 8.33 s
Epoch 29/50 |loss: 0.114331| train set 2.949x speedup, test set 0.991x speedup, val set 0.920x speedup, step: 21, train time 8.54 s
Epoch 30/50 |loss: 0.114697| train set 2.839x speedup, test set 0.986x speedup, val set 0.953x speedup, step: 22, train time 8.70 s
Epoch 31/50 |loss: 0.107878| train set 2.970x speedup, test set 1.030x speedup, val set 1.044x speedup, step: 23, train time 8.70 s
Epoch 32/50 |loss: 0.109794| train set 2.749x speedup, test set 1.000x speedup, val set 0.811x speedup, step: 24, train time 8.50 s
Epoch 33/50 |loss: 0.098715| train set 2.983x speedup, test set 1.033x speedup, val set 0.897x speedup, step: 25, train time 8.48 s
Epoch 34/50 |loss: 0.105666| train set 3.005x speedup, test set 0.993x speedup, val set 0.811x speedup, step: 26, train time 8.61 s
Epoch 35/50 |loss: 0.100149| train set 3.021x speedup, test set 1.437x speedup, val set 0.931x speedup, step: 27, train time 8.50 s
Epoch 36/50 |loss: 0.095684| train set 2.961x speedup, test set 0.999x speedup, val set 1.077x speedup, step: 28, train time 8.69 s
Epoch 37/50 |loss: 0.095671| train set 2.955x speedup, test set 1.469x speedup, val set 1.231x speedup, step: 29, train time 8.69 s
Epoch 38/50 |loss: 0.101671| train set 2.960x speedup, test set 1.022x speedup, val set 0.921x speedup, step: 30, train time 8.61 s
Epoch 39/50 |loss: 0.092805| train set 3.009x speedup, test set 1.430x speedup, val set 0.957x speedup, step: 31, train time 8.80 s
Epoch 40/50 |loss: 0.093385| train set 3.023x speedup, test set 1.003x speedup, val set 1.031x speedup, step: 32, train time 8.23 s
Epoch 41/50 |loss: 0.091819| train set 3.044x speedup, test set 0.982x speedup, val set 0.811x speedup, step: 33, train time 8.50 s
Epoch 42/50 |loss: 0.094355| train set 3.004x speedup, test set 1.017x speedup, val set 1.001x speedup, step: 34, train time 8.59 s
Epoch 43/50 |loss: 0.085696| train set 2.837x speedup, test set 1.438x speedup, val set 0.920x speedup, step: 35, train time 8.69 s
Epoch 44/50 |loss: 0.092516| train set 2.991x speedup, test set 1.023x speedup, val set 0.874x speedup, step: 36, train time 8.70 s
Epoch 45/50 |loss: 0.091796| train set 2.979x speedup, test set 0.986x speedup, val set 0.957x speedup, step: 37, train time 8.41 s
Epoch 46/50 |loss: 0.086909| train set 2.970x speedup, test set 1.003x speedup, val set 0.811x speedup, step: 38, train time 8.50 s
Epoch 47/50 |loss: 0.093238| train set 2.957x speedup, test set 1.015x speedup, val set 0.931x speedup, step: 39, train time 8.32 s
Epoch 48/50 |loss: 0.082213| train set 2.860x speedup, test set 1.394x speedup, val set 1.026x speedup, step: 40, train time 8.60 s
Epoch 49/50 |loss: 0.079299| train set 3.023x speedup, test set 1.003x speedup, val set 0.811x speedup, step: 41, train time 8.51 s
Training per epoch cost 8.550 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 41, train speedup 3.044, test speedup 0.982, val speedup 0.811
best test speedup epoch: 3, train speedup 2.237, test speedup 2.789, val speedup 0.997
best validation speedup epoch: 9, train speedup 2.498, test speedup 1.446, val speedup 1.133
last model at epoch 49, train speedup 3.023, test speedup 1.003, val speedup 0.811
execution cost 0:07:39.985013
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.745055, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414157| train set 1.033x speedup, test set 2.820x speedup, val set 0.988x speedup, step: 1, train time 10.40 s
Epoch 1/50 |loss: 0.336603| train set 2.183x speedup, test set 2.490x speedup, val set 0.983x speedup, step: 2, train time 8.51 s
Epoch 2/50 |loss: 0.305256| train set 2.218x speedup, test set 2.456x speedup, val set 0.987x speedup, step: 3, train time 8.40 s
Epoch 3/50 |loss: 0.282807| train set 2.031x speedup, test set 2.632x speedup, val set 0.842x speedup, step: 4, train time 8.51 s
Epoch 4/50 |loss: 0.265300| train set 2.350x speedup, test set 2.738x speedup, val set 0.951x speedup, step: 1, train time 8.81 s
Epoch 5/50 |loss: 0.244056| train set 2.151x speedup, test set 1.663x speedup, val set 0.987x speedup, step: 2, train time 8.51 s
Epoch 6/50 |loss: 0.231374| train set 2.685x speedup, test set 1.440x speedup, val set 0.822x speedup, step: 3, train time 8.80 s
Epoch 7/50 |loss: 0.227281| train set 2.244x speedup, test set 1.405x speedup, val set 0.824x speedup, step: 4, train time 8.78 s
Epoch 8/50 |loss: 0.205984| train set 2.800x speedup, test set 1.110x speedup, val set 1.039x speedup, step: 5, train time 8.80 s
Epoch 9/50 |loss: 0.201022| train set 2.822x speedup, test set 0.996x speedup, val set 1.070x speedup, step: 1, train time 8.63 s
Epoch 10/50 |loss: 0.200388| train set 2.775x speedup, test set 1.390x speedup, val set 0.874x speedup, step: 2, train time 8.60 s
Epoch 11/50 |loss: 0.184198| train set 2.400x speedup, test set 1.411x speedup, val set 1.058x speedup, step: 3, train time 8.60 s
Epoch 12/50 |loss: 0.182800| train set 2.661x speedup, test set 0.976x speedup, val set 1.046x speedup, step: 4, train time 8.71 s
Epoch 13/50 |loss: 0.178164| train set 2.703x speedup, test set 0.975x speedup, val set 0.833x speedup, step: 5, train time 8.70 s
Epoch 14/50 |loss: 0.173826| train set 2.758x speedup, test set 1.368x speedup, val set 0.975x speedup, step: 6, train time 8.81 s
Epoch 15/50 |loss: 0.159064| train set 2.772x speedup, test set 0.977x speedup, val set 0.833x speedup, step: 7, train time 8.70 s
Epoch 16/50 |loss: 0.154590| train set 2.922x speedup, test set 1.474x speedup, val set 0.990x speedup, step: 8, train time 8.39 s
Epoch 17/50 |loss: 0.153473| train set 2.661x speedup, test set 0.978x speedup, val set 0.975x speedup, step: 9, train time 8.49 s
Epoch 18/50 |loss: 0.149060| train set 2.900x speedup, test set 1.358x speedup, val set 0.974x speedup, step: 10, train time 8.41 s
Epoch 19/50 |loss: 0.146382| train set 2.787x speedup, test set 1.471x speedup, val set 0.975x speedup, step: 11, train time 8.72 s
Epoch 20/50 |loss: 0.143771| train set 2.852x speedup, test set 1.394x speedup, val set 0.959x speedup, step: 12, train time 8.81 s
Epoch 21/50 |loss: 0.136321| train set 2.401x speedup, test set 1.417x speedup, val set 0.985x speedup, step: 13, train time 8.50 s
Epoch 22/50 |loss: 0.134461| train set 2.824x speedup, test set 1.382x speedup, val set 1.046x speedup, step: 14, train time 8.59 s
Epoch 23/50 |loss: 0.126810| train set 2.841x speedup, test set 0.978x speedup, val set 1.046x speedup, step: 15, train time 8.72 s
Epoch 24/50 |loss: 0.120793| train set 2.831x speedup, test set 0.990x speedup, val set 0.975x speedup, step: 16, train time 8.51 s
Epoch 25/50 |loss: 0.130791| train set 2.868x speedup, test set 0.990x speedup, val set 1.029x speedup, step: 17, train time 8.42 s
Epoch 26/50 |loss: 0.131871| train set 2.941x speedup, test set 1.437x speedup, val set 1.043x speedup, step: 18, train time 8.21 s
Epoch 27/50 |loss: 0.120366| train set 2.898x speedup, test set 1.004x speedup, val set 1.046x speedup, step: 19, train time 8.50 s
Epoch 28/50 |loss: 0.112514| train set 2.949x speedup, test set 1.004x speedup, val set 1.061x speedup, step: 20, train time 8.50 s
Epoch 29/50 |loss: 0.115139| train set 2.814x speedup, test set 1.417x speedup, val set 1.046x speedup, step: 21, train time 8.21 s
Epoch 30/50 |loss: 0.118147| train set 2.563x speedup, test set 0.987x speedup, val set 0.953x speedup, step: 22, train time 8.61 s
Epoch 31/50 |loss: 0.114320| train set 2.773x speedup, test set 1.037x speedup, val set 0.923x speedup, step: 23, train time 8.50 s
Epoch 32/50 |loss: 0.110189| train set 2.961x speedup, test set 0.983x speedup, val set 0.975x speedup, step: 24, train time 8.41 s
Epoch 33/50 |loss: 0.101393| train set 3.003x speedup, test set 1.032x speedup, val set 0.960x speedup, step: 25, train time 8.61 s
Epoch 34/50 |loss: 0.112074| train set 2.830x speedup, test set 1.394x speedup, val set 0.975x speedup, step: 26, train time 8.55 s
Epoch 35/50 |loss: 0.106492| train set 2.952x speedup, test set 1.447x speedup, val set 1.048x speedup, step: 27, train time 8.51 s
Epoch 36/50 |loss: 0.099247| train set 2.963x speedup, test set 1.447x speedup, val set 0.975x speedup, step: 28, train time 8.69 s
Epoch 37/50 |loss: 0.105688| train set 2.912x speedup, test set 1.449x speedup, val set 1.043x speedup, step: 29, train time 8.53 s
Epoch 38/50 |loss: 0.101555| train set 2.984x speedup, test set 1.437x speedup, val set 1.029x speedup, step: 30, train time 8.50 s
Epoch 39/50 |loss: 0.092824| train set 2.953x speedup, test set 1.474x speedup, val set 0.975x speedup, step: 31, train time 8.91 s
Epoch 40/50 |loss: 0.101101| train set 3.047x speedup, test set 1.447x speedup, val set 0.934x speedup, step: 32, train time 8.42 s
Epoch 41/50 |loss: 0.096332| train set 2.926x speedup, test set 1.394x speedup, val set 0.959x speedup, step: 33, train time 8.49 s
Epoch 42/50 |loss: 0.099733| train set 3.000x speedup, test set 1.439x speedup, val set 1.187x speedup, step: 34, train time 8.41 s
Epoch 43/50 |loss: 0.086613| train set 2.837x speedup, test set 1.432x speedup, val set 0.975x speedup, step: 35, train time 8.52 s
Epoch 44/50 |loss: 0.093570| train set 2.986x speedup, test set 1.492x speedup, val set 1.187x speedup, step: 1, train time 8.40 s
Epoch 45/50 |loss: 0.096559| train set 2.701x speedup, test set 0.983x speedup, val set 0.975x speedup, step: 2, train time 8.42 s
Epoch 46/50 |loss: 0.089210| train set 3.018x speedup, test set 1.431x speedup, val set 1.046x speedup, step: 3, train time 8.40 s
Epoch 47/50 |loss: 0.093461| train set 2.958x speedup, test set 1.029x speedup, val set 1.099x speedup, step: 4, train time 8.40 s
Epoch 48/50 |loss: 0.085698| train set 2.992x speedup, test set 1.004x speedup, val set 1.046x speedup, step: 5, train time 8.81 s
Epoch 49/50 |loss: 0.088092| train set 2.963x speedup, test set 1.036x speedup, val set 0.937x speedup, step: 6, train time 8.60 s
Training per epoch cost 8.599 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 47.174s, pg runtime 112.305s, speedup 2.381x
04, opt runtime 30.267s, model runtime 43.737s, pg runtime 100.885s, speedup 2.307x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 40, train speedup 3.047, test speedup 1.447, val speedup 0.934
best test speedup epoch: 0, train speedup 1.033, test speedup 2.820, val speedup 0.988
best validation speedup epoch: 44, train speedup 2.986, test speedup 1.492, val speedup 1.187
last model at epoch 49, train speedup 2.963, test speedup 1.036, val speedup 0.937
execution cost 0:07:42.106917
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.746090, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414871| train set 1.038x speedup, test set 2.593x speedup, val set 0.985x speedup, step: 1, train time 9.62 s
Epoch 1/50 |loss: 0.340295| train set 1.104x speedup, test set 2.527x speedup, val set 1.057x speedup, step: 2, train time 8.52 s
Epoch 2/50 |loss: 0.305194| train set 2.461x speedup, test set 2.454x speedup, val set 0.987x speedup, step: 3, train time 8.59 s
Epoch 3/50 |loss: 0.280855| train set 2.356x speedup, test set 2.554x speedup, val set 1.039x speedup, step: 4, train time 8.41 s
Epoch 4/50 |loss: 0.266696| train set 2.213x speedup, test set 2.668x speedup, val set 0.869x speedup, step: 1, train time 9.20 s
Epoch 5/50 |loss: 0.246511| train set 2.139x speedup, test set 1.649x speedup, val set 0.870x speedup, step: 2, train time 8.50 s
Epoch 6/50 |loss: 0.236205| train set 2.655x speedup, test set 1.429x speedup, val set 1.077x speedup, step: 3, train time 8.70 s
Epoch 7/50 |loss: 0.223446| train set 2.240x speedup, test set 1.400x speedup, val set 0.822x speedup, step: 4, train time 8.40 s
Epoch 8/50 |loss: 0.207761| train set 2.797x speedup, test set 1.438x speedup, val set 1.106x speedup, step: 5, train time 8.42 s
Epoch 9/50 |loss: 0.202937| train set 2.846x speedup, test set 1.442x speedup, val set 1.132x speedup, step: 1, train time 8.51 s
Epoch 10/50 |loss: 0.197626| train set 2.611x speedup, test set 1.485x speedup, val set 0.860x speedup, step: 2, train time 8.63 s
Epoch 11/50 |loss: 0.185567| train set 2.764x speedup, test set 1.440x speedup, val set 1.077x speedup, step: 3, train time 8.71 s
Epoch 12/50 |loss: 0.180474| train set 2.629x speedup, test set 1.466x speedup, val set 0.951x speedup, step: 4, train time 8.79 s
Epoch 13/50 |loss: 0.178055| train set 2.655x speedup, test set 1.425x speedup, val set 1.132x speedup, step: 5, train time 8.51 s
Epoch 14/50 |loss: 0.172408| train set 2.753x speedup, test set 1.426x speedup, val set 0.968x speedup, step: 6, train time 8.72 s
Epoch 15/50 |loss: 0.161048| train set 2.719x speedup, test set 1.397x speedup, val set 0.948x speedup, step: 7, train time 8.32 s
Epoch 16/50 |loss: 0.157537| train set 2.799x speedup, test set 1.451x speedup, val set 0.933x speedup, step: 8, train time 8.59 s
Epoch 17/50 |loss: 0.151149| train set 2.636x speedup, test set 1.456x speedup, val set 0.920x speedup, step: 9, train time 8.64 s
Epoch 18/50 |loss: 0.143519| train set 2.951x speedup, test set 1.451x speedup, val set 0.948x speedup, step: 10, train time 8.91 s
Epoch 19/50 |loss: 0.140979| train set 2.891x speedup, test set 1.476x speedup, val set 0.933x speedup, step: 11, train time 8.60 s
Epoch 20/50 |loss: 0.144285| train set 2.870x speedup, test set 1.465x speedup, val set 0.933x speedup, step: 12, train time 8.41 s
Epoch 21/50 |loss: 0.131269| train set 2.374x speedup, test set 1.411x speedup, val set 0.971x speedup, step: 13, train time 8.54 s
Epoch 22/50 |loss: 0.134435| train set 2.623x speedup, test set 1.420x speedup, val set 0.873x speedup, step: 14, train time 8.59 s
Epoch 23/50 |loss: 0.125171| train set 2.934x speedup, test set 1.456x speedup, val set 0.984x speedup, step: 15, train time 8.81 s
Epoch 24/50 |loss: 0.124531| train set 2.904x speedup, test set 1.465x speedup, val set 0.920x speedup, step: 16, train time 8.49 s
Epoch 25/50 |loss: 0.125994| train set 3.013x speedup, test set 1.446x speedup, val set 0.920x speedup, step: 17, train time 8.61 s
Epoch 26/50 |loss: 0.125241| train set 2.961x speedup, test set 1.446x speedup, val set 1.047x speedup, step: 18, train time 8.40 s
Epoch 27/50 |loss: 0.117370| train set 3.045x speedup, test set 1.443x speedup, val set 1.111x speedup, step: 19, train time 8.71 s
Epoch 28/50 |loss: 0.113880| train set 2.979x speedup, test set 1.440x speedup, val set 0.948x speedup, step: 20, train time 8.70 s
Epoch 29/50 |loss: 0.110295| train set 2.994x speedup, test set 1.446x speedup, val set 0.933x speedup, step: 21, train time 8.69 s
Epoch 30/50 |loss: 0.115230| train set 2.829x speedup, test set 1.406x speedup, val set 0.953x speedup, step: 22, train time 9.09 s
Epoch 31/50 |loss: 0.109379| train set 2.917x speedup, test set 1.396x speedup, val set 1.047x speedup, step: 23, train time 8.31 s
Epoch 32/50 |loss: 0.106600| train set 2.918x speedup, test set 1.414x speedup, val set 0.930x speedup, step: 24, train time 8.41 s
Epoch 33/50 |loss: 0.099866| train set 3.017x speedup, test set 1.430x speedup, val set 1.047x speedup, step: 25, train time 8.88 s
Epoch 34/50 |loss: 0.104582| train set 2.812x speedup, test set 1.422x speedup, val set 0.957x speedup, step: 26, train time 8.73 s
Epoch 35/50 |loss: 0.103242| train set 2.925x speedup, test set 1.409x speedup, val set 1.031x speedup, step: 27, train time 8.40 s
Epoch 36/50 |loss: 0.094357| train set 2.916x speedup, test set 1.457x speedup, val set 1.034x speedup, step: 28, train time 8.33 s
Epoch 37/50 |loss: 0.097944| train set 2.899x speedup, test set 1.422x speedup, val set 1.047x speedup, step: 29, train time 8.41 s
Epoch 38/50 |loss: 0.101453| train set 2.983x speedup, test set 1.403x speedup, val set 1.031x speedup, step: 30, train time 8.50 s
Epoch 39/50 |loss: 0.091866| train set 3.024x speedup, test set 1.447x speedup, val set 1.031x speedup, step: 31, train time 8.62 s
Epoch 40/50 |loss: 0.096811| train set 3.003x speedup, test set 1.422x speedup, val set 1.047x speedup, step: 32, train time 8.49 s
Epoch 41/50 |loss: 0.089198| train set 2.990x speedup, test set 1.446x speedup, val set 0.923x speedup, step: 33, train time 8.80 s
Epoch 42/50 |loss: 0.095451| train set 3.017x speedup, test set 1.422x speedup, val set 1.047x speedup, step: 34, train time 8.51 s
Epoch 43/50 |loss: 0.087920| train set 2.966x speedup, test set 1.409x speedup, val set 1.065x speedup, step: 35, train time 8.42 s
Epoch 44/50 |loss: 0.091857| train set 2.986x speedup, test set 1.435x speedup, val set 0.933x speedup, step: 36, train time 8.51 s
Epoch 45/50 |loss: 0.090245| train set 2.970x speedup, test set 1.409x speedup, val set 1.047x speedup, step: 37, train time 8.69 s
Epoch 46/50 |loss: 0.088229| train set 2.978x speedup, test set 1.446x speedup, val set 1.047x speedup, step: 38, train time 8.53 s
Epoch 47/50 |loss: 0.090317| train set 2.813x speedup, test set 1.435x speedup, val set 1.047x speedup, step: 39, train time 8.60 s
Epoch 48/50 |loss: 0.081993| train set 3.054x speedup, test set 1.409x speedup, val set 1.065x speedup, step: 40, train time 8.60 s
Epoch 49/50 |loss: 0.087957| train set 3.024x speedup, test set 1.422x speedup, val set 0.933x speedup, step: 41, train time 8.49 s
Training per epoch cost 8.611 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 49.702s, pg runtime 32.278s, speedup 0.649x
06, opt runtime 25.597s, model runtime 51.074s, pg runtime 27.136s, speedup 0.531x
07, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
08, opt runtime 7.377s, model runtime 37.574s, pg runtime 28.655s, speedup 0.763x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 17.756s, pg runtime 32.969s, speedup 1.857x
24, opt runtime 6.234s, model runtime 17.977s, pg runtime 32.540s, speedup 1.810x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.791s, pg runtime 5.572s, speedup 0.473x
30, opt runtime 5.539s, model runtime 10.142s, pg runtime 5.539s, speedup 0.546x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 48, train speedup 3.054, test speedup 1.409, val speedup 1.065
best test speedup epoch: 4, train speedup 2.213, test speedup 2.668, val speedup 0.869
best validation speedup epoch: 9, train speedup 2.846, test speedup 1.442, val speedup 1.132
last model at epoch 49, train speedup 3.024, test speedup 1.422, val speedup 0.933
execution cost 0:07:42.492553
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.725686, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.413337| train set 1.025x speedup, test set 2.606x speedup, val set 1.057x speedup, step: 1, train time 9.81 s
Epoch 1/50 |loss: 0.337253| train set 1.018x speedup, test set 2.522x speedup, val set 0.983x speedup, step: 2, train time 8.50 s
Epoch 2/50 |loss: 0.307227| train set 2.192x speedup, test set 2.486x speedup, val set 0.983x speedup, step: 3, train time 8.70 s
Epoch 3/50 |loss: 0.280886| train set 2.471x speedup, test set 2.799x speedup, val set 1.069x speedup, step: 4, train time 8.70 s
Epoch 4/50 |loss: 0.262751| train set 2.214x speedup, test set 1.686x speedup, val set 0.948x speedup, step: 1, train time 9.02 s
Epoch 5/50 |loss: 0.245612| train set 2.161x speedup, test set 1.652x speedup, val set 0.983x speedup, step: 2, train time 9.30 s
Epoch 6/50 |loss: 0.234133| train set 2.814x speedup, test set 1.684x speedup, val set 1.132x speedup, step: 3, train time 8.33 s
Epoch 7/50 |loss: 0.223394| train set 1.972x speedup, test set 1.416x speedup, val set 0.769x speedup, step: 4, train time 8.51 s
Epoch 8/50 |loss: 0.208418| train set 2.666x speedup, test set 1.617x speedup, val set 0.953x speedup, step: 5, train time 8.39 s
Epoch 9/50 |loss: 0.199745| train set 2.531x speedup, test set 1.631x speedup, val set 1.065x speedup, step: 1, train time 8.40 s
Epoch 10/50 |loss: 0.197426| train set 2.760x speedup, test set 1.643x speedup, val set 0.971x speedup, step: 2, train time 8.69 s
Epoch 11/50 |loss: 0.183153| train set 2.764x speedup, test set 1.629x speedup, val set 1.039x speedup, step: 3, train time 8.60 s
Epoch 12/50 |loss: 0.179040| train set 2.778x speedup, test set 1.629x speedup, val set 1.114x speedup, step: 4, train time 8.69 s
Epoch 13/50 |loss: 0.181142| train set 2.643x speedup, test set 1.609x speedup, val set 0.922x speedup, step: 5, train time 8.32 s
Epoch 14/50 |loss: 0.172198| train set 2.781x speedup, test set 1.631x speedup, val set 0.983x speedup, step: 6, train time 8.51 s
Epoch 15/50 |loss: 0.164084| train set 2.727x speedup, test set 1.597x speedup, val set 0.987x speedup, step: 7, train time 8.31 s
Epoch 16/50 |loss: 0.157203| train set 2.615x speedup, test set 1.606x speedup, val set 0.987x speedup, step: 8, train time 8.22 s
Epoch 17/50 |loss: 0.148859| train set 2.646x speedup, test set 1.620x speedup, val set 1.118x speedup, step: 9, train time 8.31 s
Epoch 18/50 |loss: 0.145844| train set 2.923x speedup, test set 1.620x speedup, val set 0.971x speedup, step: 10, train time 8.50 s
Epoch 19/50 |loss: 0.146542| train set 2.731x speedup, test set 1.649x speedup, val set 1.026x speedup, step: 11, train time 8.30 s
Epoch 20/50 |loss: 0.140388| train set 2.701x speedup, test set 1.604x speedup, val set 0.971x speedup, step: 12, train time 8.62 s
Epoch 21/50 |loss: 0.132624| train set 2.257x speedup, test set 1.613x speedup, val set 1.057x speedup, step: 13, train time 8.62 s
Epoch 22/50 |loss: 0.136697| train set 2.786x speedup, test set 1.640x speedup, val set 1.044x speedup, step: 14, train time 8.49 s
Epoch 23/50 |loss: 0.129331| train set 2.803x speedup, test set 1.610x speedup, val set 1.044x speedup, step: 15, train time 8.62 s
Epoch 24/50 |loss: 0.123006| train set 3.048x speedup, test set 1.604x speedup, val set 0.811x speedup, step: 16, train time 8.61 s
Epoch 25/50 |loss: 0.125836| train set 2.890x speedup, test set 1.667x speedup, val set 1.044x speedup, step: 17, train time 8.50 s
Epoch 26/50 |loss: 0.129021| train set 2.983x speedup, test set 1.616x speedup, val set 0.931x speedup, step: 18, train time 8.70 s
Epoch 27/50 |loss: 0.124597| train set 2.836x speedup, test set 1.630x speedup, val set 1.029x speedup, step: 19, train time 8.52 s
Epoch 28/50 |loss: 0.115572| train set 2.985x speedup, test set 2.429x speedup, val set 1.061x speedup, step: 20, train time 8.42 s
Epoch 29/50 |loss: 0.114386| train set 2.936x speedup, test set 1.650x speedup, val set 1.131x speedup, step: 1, train time 8.31 s
Epoch 30/50 |loss: 0.116050| train set 2.843x speedup, test set 1.663x speedup, val set 1.122x speedup, step: 2, train time 8.88 s
Epoch 31/50 |loss: 0.110973| train set 2.908x speedup, test set 1.657x speedup, val set 1.153x speedup, step: 3, train time 8.40 s
Epoch 32/50 |loss: 0.116088| train set 2.841x speedup, test set 1.604x speedup, val set 1.061x speedup, step: 4, train time 9.00 s
Epoch 33/50 |loss: 0.105706| train set 3.017x speedup, test set 1.657x speedup, val set 1.297x speedup, step: 5, train time 8.60 s
Epoch 34/50 |loss: 0.107310| train set 2.912x speedup, test set 2.657x speedup, val set 1.211x speedup, step: 1, train time 8.50 s
Epoch 35/50 |loss: 0.104103| train set 2.945x speedup, test set 1.616x speedup, val set 1.153x speedup, step: 2, train time 8.33 s
Epoch 36/50 |loss: 0.098421| train set 2.970x speedup, test set 2.477x speedup, val set 1.065x speedup, step: 3, train time 8.50 s
Epoch 37/50 |loss: 0.099906| train set 2.912x speedup, test set 1.650x speedup, val set 1.211x speedup, step: 4, train time 8.53 s
Epoch 38/50 |loss: 0.103004| train set 3.047x speedup, test set 1.650x speedup, val set 1.017x speedup, step: 5, train time 8.40 s
Epoch 39/50 |loss: 0.096062| train set 2.832x speedup, test set 1.610x speedup, val set 0.974x speedup, step: 6, train time 8.31 s
Epoch 40/50 |loss: 0.094353| train set 3.005x speedup, test set 1.610x speedup, val set 1.127x speedup, step: 7, train time 8.61 s
Epoch 41/50 |loss: 0.093241| train set 3.044x speedup, test set 1.610x speedup, val set 1.061x speedup, step: 8, train time 8.60 s
Epoch 42/50 |loss: 0.099184| train set 2.851x speedup, test set 1.610x speedup, val set 1.127x speedup, step: 9, train time 8.50 s
Epoch 43/50 |loss: 0.088311| train set 2.991x speedup, test set 1.565x speedup, val set 1.211x speedup, step: 10, train time 8.69 s
Epoch 44/50 |loss: 0.088185| train set 2.971x speedup, test set 1.587x speedup, val set 1.061x speedup, step: 11, train time 8.89 s
Epoch 45/50 |loss: 0.093640| train set 2.815x speedup, test set 1.699x speedup, val set 1.127x speedup, step: 12, train time 8.70 s
Epoch 46/50 |loss: 0.084460| train set 2.953x speedup, test set 1.707x speedup, val set 1.127x speedup, step: 13, train time 8.44 s
Epoch 47/50 |loss: 0.095267| train set 2.962x speedup, test set 1.707x speedup, val set 1.061x speedup, step: 14, train time 8.71 s
Epoch 48/50 |loss: 0.083337| train set 2.987x speedup, test set 1.651x speedup, val set 1.127x speedup, step: 15, train time 8.50 s
Epoch 49/50 |loss: 0.083835| train set 2.823x speedup, test set 1.678x speedup, val set 0.974x speedup, step: 16, train time 8.49 s
Training per epoch cost 8.582 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 49.702s, pg runtime 32.278s, speedup 0.649x
06, opt runtime 25.597s, model runtime 51.074s, pg runtime 27.136s, speedup 0.531x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 6.580s, pg runtime 5.572s, speedup 0.847x
30, opt runtime 5.539s, model runtime 6.521s, pg runtime 5.539s, speedup 0.849x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 24, train speedup 3.048, test speedup 1.604, val speedup 0.811
best test speedup epoch: 3, train speedup 2.471, test speedup 2.799, val speedup 1.069
best validation speedup epoch: 34, train speedup 2.912, test speedup 2.657, val speedup 1.211
last model at epoch 49, train speedup 2.823, test speedup 1.678, val speedup 0.974
execution cost 0:07:40.230113
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.707084, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.413465| train set 1.057x speedup, test set 2.570x speedup, val set 0.983x speedup, step: 1, train time 9.72 s
Epoch 1/50 |loss: 0.337916| train set 1.837x speedup, test set 2.553x speedup, val set 0.985x speedup, step: 2, train time 8.60 s
Epoch 2/50 |loss: 0.305592| train set 2.555x speedup, test set 1.432x speedup, val set 1.043x speedup, step: 3, train time 8.50 s
Epoch 3/50 |loss: 0.279737| train set 2.338x speedup, test set 2.602x speedup, val set 0.971x speedup, step: 4, train time 8.62 s
Epoch 4/50 |loss: 0.265548| train set 2.734x speedup, test set 2.508x speedup, val set 1.069x speedup, step: 1, train time 9.40 s
Epoch 5/50 |loss: 0.245833| train set 2.269x speedup, test set 2.417x speedup, val set 0.873x speedup, step: 2, train time 8.61 s
Epoch 6/50 |loss: 0.232855| train set 2.415x speedup, test set 2.604x speedup, val set 0.922x speedup, step: 3, train time 8.58 s
Epoch 7/50 |loss: 0.224849| train set 2.174x speedup, test set 1.355x speedup, val set 0.835x speedup, step: 4, train time 8.43 s
Epoch 8/50 |loss: 0.208779| train set 2.828x speedup, test set 2.569x speedup, val set 1.043x speedup, step: 5, train time 8.81 s
Epoch 9/50 |loss: 0.200100| train set 2.643x speedup, test set 2.557x speedup, val set 1.069x speedup, step: 1, train time 8.54 s
Epoch 10/50 |loss: 0.201161| train set 2.753x speedup, test set 2.560x speedup, val set 0.971x speedup, step: 2, train time 8.60 s
Epoch 11/50 |loss: 0.184138| train set 2.402x speedup, test set 2.541x speedup, val set 0.987x speedup, step: 3, train time 8.63 s
Epoch 12/50 |loss: 0.178392| train set 2.732x speedup, test set 2.659x speedup, val set 0.936x speedup, step: 4, train time 8.42 s
Epoch 13/50 |loss: 0.177427| train set 2.588x speedup, test set 1.469x speedup, val set 0.971x speedup, step: 5, train time 8.63 s
Epoch 14/50 |loss: 0.174064| train set 2.767x speedup, test set 1.641x speedup, val set 0.822x speedup, step: 6, train time 8.41 s
Epoch 15/50 |loss: 0.165332| train set 2.845x speedup, test set 2.498x speedup, val set 0.922x speedup, step: 7, train time 8.60 s
Epoch 16/50 |loss: 0.154281| train set 2.468x speedup, test set 1.346x speedup, val set 0.860x speedup, step: 8, train time 8.51 s
Epoch 17/50 |loss: 0.149511| train set 2.417x speedup, test set 2.510x speedup, val set 0.974x speedup, step: 9, train time 8.31 s
Epoch 18/50 |loss: 0.146100| train set 2.950x speedup, test set 2.644x speedup, val set 0.933x speedup, step: 10, train time 8.89 s
Epoch 19/50 |loss: 0.144708| train set 2.783x speedup, test set 2.649x speedup, val set 0.936x speedup, step: 11, train time 8.73 s
Epoch 20/50 |loss: 0.141744| train set 2.849x speedup, test set 2.654x speedup, val set 0.936x speedup, step: 12, train time 8.81 s
Epoch 21/50 |loss: 0.132185| train set 2.263x speedup, test set 1.423x speedup, val set 0.971x speedup, step: 13, train time 8.59 s
Epoch 22/50 |loss: 0.131320| train set 2.763x speedup, test set 2.498x speedup, val set 1.044x speedup, step: 14, train time 8.50 s
Epoch 23/50 |loss: 0.128135| train set 2.880x speedup, test set 2.522x speedup, val set 1.111x speedup, step: 15, train time 8.83 s
Epoch 24/50 |loss: 0.123699| train set 3.045x speedup, test set 2.630x speedup, val set 1.029x speedup, step: 16, train time 8.79 s
Epoch 25/50 |loss: 0.122948| train set 2.919x speedup, test set 2.665x speedup, val set 1.111x speedup, step: 17, train time 8.40 s
Epoch 26/50 |loss: 0.129294| train set 2.941x speedup, test set 2.665x speedup, val set 1.132x speedup, step: 18, train time 8.89 s
Epoch 27/50 |loss: 0.118445| train set 3.041x speedup, test set 1.710x speedup, val set 0.984x speedup, step: 19, train time 8.39 s
Epoch 28/50 |loss: 0.110796| train set 2.908x speedup, test set 2.507x speedup, val set 1.231x speedup, step: 20, train time 8.49 s
Epoch 29/50 |loss: 0.116465| train set 2.806x speedup, test set 2.507x speedup, val set 1.043x speedup, step: 21, train time 8.41 s
Epoch 30/50 |loss: 0.113925| train set 2.878x speedup, test set 2.507x speedup, val set 1.021x speedup, step: 22, train time 8.71 s
Epoch 31/50 |loss: 0.109515| train set 2.908x speedup, test set 2.649x speedup, val set 1.111x speedup, step: 23, train time 8.69 s
Epoch 32/50 |loss: 0.111922| train set 2.786x speedup, test set 2.507x speedup, val set 1.026x speedup, step: 24, train time 8.69 s
Epoch 33/50 |loss: 0.096895| train set 2.977x speedup, test set 2.683x speedup, val set 1.111x speedup, step: 25, train time 8.42 s
Epoch 34/50 |loss: 0.106259| train set 2.813x speedup, test set 2.614x speedup, val set 1.026x speedup, step: 26, train time 8.60 s
Epoch 35/50 |loss: 0.102625| train set 2.905x speedup, test set 2.483x speedup, val set 1.165x speedup, step: 27, train time 8.80 s
Epoch 36/50 |loss: 0.098401| train set 2.961x speedup, test set 2.522x speedup, val set 1.165x speedup, step: 28, train time 8.72 s
Epoch 37/50 |loss: 0.102933| train set 2.910x speedup, test set 2.507x speedup, val set 1.297x speedup, step: 29, train time 8.60 s
Epoch 38/50 |loss: 0.097907| train set 2.972x speedup, test set 2.649x speedup, val set 1.112x speedup, step: 30, train time 8.29 s
Epoch 39/50 |loss: 0.091368| train set 2.890x speedup, test set 2.614x speedup, val set 1.026x speedup, step: 31, train time 8.13 s
Epoch 40/50 |loss: 0.099231| train set 2.892x speedup, test set 2.614x speedup, val set 1.165x speedup, step: 32, train time 8.72 s
Epoch 41/50 |loss: 0.091979| train set 2.918x speedup, test set 2.579x speedup, val set 1.029x speedup, step: 33, train time 8.69 s
Epoch 42/50 |loss: 0.094160| train set 2.854x speedup, test set 2.507x speedup, val set 1.127x speedup, step: 34, train time 8.81 s
Epoch 43/50 |loss: 0.089041| train set 2.972x speedup, test set 2.507x speedup, val set 1.297x speedup, step: 35, train time 8.51 s
Epoch 44/50 |loss: 0.094859| train set 2.970x speedup, test set 2.507x speedup, val set 1.026x speedup, step: 36, train time 8.51 s
Epoch 45/50 |loss: 0.096037| train set 2.988x speedup, test set 2.436x speedup, val set 1.165x speedup, step: 37, train time 8.50 s
Epoch 46/50 |loss: 0.090423| train set 2.947x speedup, test set 2.507x speedup, val set 1.165x speedup, step: 38, train time 8.60 s
Epoch 47/50 |loss: 0.092674| train set 2.497x speedup, test set 2.500x speedup, val set 1.026x speedup, step: 39, train time 8.40 s
Epoch 48/50 |loss: 0.087672| train set 2.864x speedup, test set 2.614x speedup, val set 1.127x speedup, step: 40, train time 8.51 s
Epoch 49/50 |loss: 0.085994| train set 2.872x speedup, test set 2.531x speedup, val set 0.971x speedup, step: 41, train time 8.59 s
Training per epoch cost 8.623 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 12.337s, pg runtime 1.206s, speedup 0.098x
40, opt runtime 1.086s, model runtime 13.122s, pg runtime 1.181s, speedup 0.090x
====================
best train speedup epoch: 24, train speedup 3.045, test speedup 2.630, val speedup 1.029
best test speedup epoch: 33, train speedup 2.977, test speedup 2.683, val speedup 1.111
best validation speedup epoch: 9, train speedup 2.643, test speedup 2.557, val speedup 1.069
last model at epoch 49, train speedup 2.872, test speedup 2.531, val speedup 0.971
execution cost 0:07:42.803328
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.737682, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414080| train set 1.057x speedup, test set 2.661x speedup, val set 0.985x speedup, step: 1, train time 9.63 s
Epoch 1/50 |loss: 0.338953| train set 1.090x speedup, test set 2.478x speedup, val set 0.983x speedup, step: 2, train time 8.69 s
Epoch 2/50 |loss: 0.304007| train set 2.239x speedup, test set 2.595x speedup, val set 0.987x speedup, step: 3, train time 8.31 s
Epoch 3/50 |loss: 0.281979| train set 2.299x speedup, test set 2.635x speedup, val set 0.895x speedup, step: 4, train time 8.70 s
Epoch 4/50 |loss: 0.265165| train set 2.762x speedup, test set 2.934x speedup, val set 1.036x speedup, step: 1, train time 9.10 s
Epoch 5/50 |loss: 0.247626| train set 2.125x speedup, test set 2.530x speedup, val set 1.039x speedup, step: 2, train time 8.51 s
Epoch 6/50 |loss: 0.235764| train set 2.670x speedup, test set 2.636x speedup, val set 0.931x speedup, step: 3, train time 8.61 s
Epoch 7/50 |loss: 0.221927| train set 2.446x speedup, test set 1.412x speedup, val set 0.824x speedup, step: 4, train time 8.39 s
Epoch 8/50 |loss: 0.214118| train set 2.588x speedup, test set 2.728x speedup, val set 1.043x speedup, step: 5, train time 8.60 s
Epoch 9/50 |loss: 0.201760| train set 2.599x speedup, test set 2.679x speedup, val set 1.003x speedup, step: 6, train time 9.09 s
Epoch 10/50 |loss: 0.203344| train set 2.767x speedup, test set 2.844x speedup, val set 0.955x speedup, step: 7, train time 8.71 s
Epoch 11/50 |loss: 0.183073| train set 2.693x speedup, test set 2.506x speedup, val set 1.061x speedup, step: 8, train time 8.49 s
Epoch 12/50 |loss: 0.180300| train set 2.956x speedup, test set 2.689x speedup, val set 0.920x speedup, step: 9, train time 8.79 s
Epoch 13/50 |loss: 0.177467| train set 2.591x speedup, test set 1.406x speedup, val set 0.907x speedup, step: 10, train time 8.41 s
Epoch 14/50 |loss: 0.175277| train set 2.604x speedup, test set 2.453x speedup, val set 0.974x speedup, step: 11, train time 8.61 s
Epoch 15/50 |loss: 0.162741| train set 2.763x speedup, test set 1.411x speedup, val set 0.860x speedup, step: 12, train time 8.51 s
Epoch 16/50 |loss: 0.153595| train set 2.937x speedup, test set 1.411x speedup, val set 0.908x speedup, step: 13, train time 8.40 s
Epoch 17/50 |loss: 0.154141| train set 2.651x speedup, test set 1.451x speedup, val set 1.076x speedup, step: 14, train time 8.51 s
Epoch 18/50 |loss: 0.146436| train set 2.958x speedup, test set 2.709x speedup, val set 0.984x speedup, step: 15, train time 8.60 s
Epoch 19/50 |loss: 0.142512| train set 2.999x speedup, test set 2.623x speedup, val set 1.047x speedup, step: 1, train time 9.00 s
Epoch 20/50 |loss: 0.137553| train set 2.802x speedup, test set 1.481x speedup, val set 0.957x speedup, step: 2, train time 8.61 s
Epoch 21/50 |loss: 0.136047| train set 2.259x speedup, test set 1.459x speedup, val set 1.061x speedup, step: 3, train time 8.79 s
Epoch 22/50 |loss: 0.132556| train set 2.486x speedup, test set 2.351x speedup, val set 0.860x speedup, step: 4, train time 8.31 s
Epoch 23/50 |loss: 0.125931| train set 2.844x speedup, test set 2.436x speedup, val set 0.874x speedup, step: 5, train time 8.60 s
Epoch 24/50 |loss: 0.123950| train set 3.038x speedup, test set 1.418x speedup, val set 0.971x speedup, step: 6, train time 8.51 s
Epoch 25/50 |loss: 0.127771| train set 2.868x speedup, test set 2.634x speedup, val set 1.231x speedup, step: 7, train time 8.32 s
Epoch 26/50 |loss: 0.128334| train set 2.979x speedup, test set 2.962x speedup, val set 0.987x speedup, step: 8, train time 8.12 s
Epoch 27/50 |loss: 0.118448| train set 3.049x speedup, test set 1.507x speedup, val set 1.061x speedup, step: 9, train time 8.62 s
Epoch 28/50 |loss: 0.112927| train set 2.935x speedup, test set 2.570x speedup, val set 1.017x speedup, step: 10, train time 8.59 s
Epoch 29/50 |loss: 0.113214| train set 3.004x speedup, test set 2.916x speedup, val set 0.971x speedup, step: 11, train time 8.59 s
Epoch 30/50 |loss: 0.114937| train set 2.534x speedup, test set 2.357x speedup, val set 0.971x speedup, step: 12, train time 9.02 s
Epoch 31/50 |loss: 0.107092| train set 2.962x speedup, test set 1.504x speedup, val set 1.047x speedup, step: 13, train time 8.68 s
Epoch 32/50 |loss: 0.111150| train set 2.938x speedup, test set 1.789x speedup, val set 0.822x speedup, step: 14, train time 8.69 s
Epoch 33/50 |loss: 0.100186| train set 3.006x speedup, test set 1.532x speedup, val set 0.987x speedup, step: 15, train time 8.81 s
Epoch 34/50 |loss: 0.103433| train set 2.872x speedup, test set 2.612x speedup, val set 0.822x speedup, step: 16, train time 8.55 s
Epoch 35/50 |loss: 0.107161| train set 2.923x speedup, test set 1.923x speedup, val set 0.885x speedup, step: 17, train time 8.23 s
Epoch 36/50 |loss: 0.098049| train set 2.962x speedup, test set 1.500x speedup, val set 1.095x speedup, step: 18, train time 8.49 s
Epoch 37/50 |loss: 0.098387| train set 2.988x speedup, test set 1.550x speedup, val set 1.211x speedup, step: 19, train time 8.69 s
Epoch 38/50 |loss: 0.099075| train set 3.049x speedup, test set 1.523x speedup, val set 1.095x speedup, step: 20, train time 8.29 s
Epoch 39/50 |loss: 0.089380| train set 3.021x speedup, test set 2.918x speedup, val set 0.971x speedup, step: 21, train time 8.61 s
Epoch 40/50 |loss: 0.094228| train set 3.002x speedup, test set 1.463x speedup, val set 0.885x speedup, step: 22, train time 8.44 s
Epoch 41/50 |loss: 0.088372| train set 2.846x speedup, test set 2.449x speedup, val set 0.971x speedup, step: 23, train time 8.52 s
Epoch 42/50 |loss: 0.103458| train set 3.048x speedup, test set 2.830x speedup, val set 1.153x speedup, step: 24, train time 8.89 s
Epoch 43/50 |loss: 0.090336| train set 2.981x speedup, test set 2.833x speedup, val set 0.822x speedup, step: 25, train time 8.43 s
Epoch 44/50 |loss: 0.090968| train set 2.987x speedup, test set 2.589x speedup, val set 1.061x speedup, step: 1, train time 8.41 s
Epoch 45/50 |loss: 0.091232| train set 2.988x speedup, test set 2.815x speedup, val set 1.095x speedup, step: 2, train time 8.20 s
Epoch 46/50 |loss: 0.088900| train set 2.840x speedup, test set 2.733x speedup, val set 1.047x speedup, step: 3, train time 8.39 s
Epoch 47/50 |loss: 0.099931| train set 2.676x speedup, test set 2.777x speedup, val set 0.971x speedup, step: 4, train time 8.49 s
Epoch 48/50 |loss: 0.080751| train set 3.047x speedup, test set 2.597x speedup, val set 1.211x speedup, step: 5, train time 8.51 s
Epoch 49/50 |loss: 0.087463| train set 3.015x speedup, test set 2.733x speedup, val set 0.908x speedup, step: 6, train time 8.41 s
Training per epoch cost 8.589 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
18, opt runtime 6.149s, model runtime 16.444s, pg runtime 30.760s, speedup 1.871x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 27, train speedup 3.049, test speedup 1.507, val speedup 1.061
best test speedup epoch: 26, train speedup 2.979, test speedup 2.962, val speedup 0.987
best validation speedup epoch: 44, train speedup 2.987, test speedup 2.589, val speedup 1.061
last model at epoch 49, train speedup 3.015, test speedup 2.733, val speedup 0.908
execution cost 0:07:41.191550
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.708835, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.413399| train set 1.037x speedup, test set 2.590x speedup, val set 1.057x speedup, step: 1, train time 9.69 s
Epoch 1/50 |loss: 0.338333| train set 1.104x speedup, test set 2.555x speedup, val set 0.983x speedup, step: 2, train time 8.22 s
Epoch 2/50 |loss: 0.305766| train set 2.421x speedup, test set 2.598x speedup, val set 0.989x speedup, step: 3, train time 8.51 s
Epoch 3/50 |loss: 0.281858| train set 2.211x speedup, test set 2.438x speedup, val set 0.994x speedup, step: 4, train time 8.50 s
Epoch 4/50 |loss: 0.267356| train set 2.478x speedup, test set 2.532x speedup, val set 0.880x speedup, step: 1, train time 8.89 s
Epoch 5/50 |loss: 0.248312| train set 2.089x speedup, test set 2.583x speedup, val set 1.043x speedup, step: 2, train time 8.42 s
Epoch 6/50 |loss: 0.235139| train set 2.797x speedup, test set 1.398x speedup, val set 1.066x speedup, step: 3, train time 8.60 s
Epoch 7/50 |loss: 0.227164| train set 2.209x speedup, test set 2.603x speedup, val set 0.937x speedup, step: 4, train time 8.50 s
Epoch 8/50 |loss: 0.211993| train set 2.819x speedup, test set 1.381x speedup, val set 0.964x speedup, step: 5, train time 8.50 s
Epoch 9/50 |loss: 0.202746| train set 2.605x speedup, test set 2.497x speedup, val set 1.065x speedup, step: 1, train time 8.20 s
Epoch 10/50 |loss: 0.200780| train set 2.472x speedup, test set 2.635x speedup, val set 0.748x speedup, step: 2, train time 8.92 s
Epoch 11/50 |loss: 0.183643| train set 2.483x speedup, test set 1.406x speedup, val set 0.885x speedup, step: 3, train time 8.60 s
Epoch 12/50 |loss: 0.181159| train set 2.781x speedup, test set 2.492x speedup, val set 0.882x speedup, step: 4, train time 8.22 s
Epoch 13/50 |loss: 0.179324| train set 2.653x speedup, test set 1.430x speedup, val set 0.962x speedup, step: 5, train time 8.61 s
Epoch 14/50 |loss: 0.175934| train set 2.758x speedup, test set 2.656x speedup, val set 1.043x speedup, step: 6, train time 8.41 s
Epoch 15/50 |loss: 0.160446| train set 2.827x speedup, test set 1.449x speedup, val set 0.873x speedup, step: 7, train time 8.50 s
Epoch 16/50 |loss: 0.156513| train set 2.646x speedup, test set 1.444x speedup, val set 0.987x speedup, step: 8, train time 8.40 s
Epoch 17/50 |loss: 0.150849| train set 2.561x speedup, test set 2.692x speedup, val set 1.043x speedup, step: 9, train time 8.62 s
Epoch 18/50 |loss: 0.147424| train set 2.948x speedup, test set 2.594x speedup, val set 1.111x speedup, step: 10, train time 8.51 s
Epoch 19/50 |loss: 0.143656| train set 2.935x speedup, test set 2.541x speedup, val set 0.974x speedup, step: 11, train time 8.61 s
Epoch 20/50 |loss: 0.140222| train set 2.841x speedup, test set 2.610x speedup, val set 1.165x speedup, step: 12, train time 8.51 s
Epoch 21/50 |loss: 0.134179| train set 2.503x speedup, test set 2.578x speedup, val set 1.046x speedup, step: 13, train time 8.70 s
Epoch 22/50 |loss: 0.135825| train set 2.463x speedup, test set 2.700x speedup, val set 1.127x speedup, step: 14, train time 8.50 s
Epoch 23/50 |loss: 0.124088| train set 2.832x speedup, test set 1.416x speedup, val set 0.957x speedup, step: 15, train time 8.50 s
Epoch 24/50 |loss: 0.123022| train set 3.046x speedup, test set 2.597x speedup, val set 1.044x speedup, step: 16, train time 8.43 s
Epoch 25/50 |loss: 0.128243| train set 2.957x speedup, test set 2.541x speedup, val set 1.165x speedup, step: 17, train time 8.39 s
Epoch 26/50 |loss: 0.129246| train set 3.003x speedup, test set 2.656x speedup, val set 1.044x speedup, step: 18, train time 8.80 s
Epoch 27/50 |loss: 0.116784| train set 2.883x speedup, test set 2.469x speedup, val set 1.026x speedup, step: 19, train time 8.69 s
Epoch 28/50 |loss: 0.112810| train set 2.969x speedup, test set 2.585x speedup, val set 1.133x speedup, step: 20, train time 8.79 s
Epoch 29/50 |loss: 0.111370| train set 2.762x speedup, test set 1.428x speedup, val set 1.127x speedup, step: 1, train time 8.44 s
Epoch 30/50 |loss: 0.112755| train set 2.680x speedup, test set 1.482x speedup, val set 0.953x speedup, step: 2, train time 8.42 s
Epoch 31/50 |loss: 0.105679| train set 2.937x speedup, test set 2.512x speedup, val set 1.297x speedup, step: 3, train time 8.91 s
Epoch 32/50 |loss: 0.108026| train set 2.788x speedup, test set 1.424x speedup, val set 0.971x speedup, step: 4, train time 8.51 s
Epoch 33/50 |loss: 0.101324| train set 2.994x speedup, test set 1.432x speedup, val set 1.297x speedup, step: 5, train time 8.42 s
Epoch 34/50 |loss: 0.103329| train set 2.868x speedup, test set 2.541x speedup, val set 1.026x speedup, step: 6, train time 8.51 s
Epoch 35/50 |loss: 0.103586| train set 2.987x speedup, test set 1.414x speedup, val set 1.133x speedup, step: 7, train time 8.70 s
Epoch 36/50 |loss: 0.095791| train set 2.825x speedup, test set 1.414x speedup, val set 1.165x speedup, step: 8, train time 8.61 s
Epoch 37/50 |loss: 0.099425| train set 2.996x speedup, test set 2.503x speedup, val set 1.297x speedup, step: 9, train time 8.72 s
Epoch 38/50 |loss: 0.097882| train set 3.043x speedup, test set 2.582x speedup, val set 1.165x speedup, step: 10, train time 8.59 s
Epoch 39/50 |loss: 0.088969| train set 3.028x speedup, test set 2.634x speedup, val set 1.076x speedup, step: 11, train time 8.20 s
Epoch 40/50 |loss: 0.096247| train set 3.049x speedup, test set 2.672x speedup, val set 1.297x speedup, step: 12, train time 8.52 s
Epoch 41/50 |loss: 0.093242| train set 3.038x speedup, test set 2.595x speedup, val set 0.959x speedup, step: 13, train time 8.29 s
Epoch 42/50 |loss: 0.094132| train set 2.774x speedup, test set 2.700x speedup, val set 1.127x speedup, step: 14, train time 8.51 s
Epoch 43/50 |loss: 0.089443| train set 2.974x speedup, test set 2.508x speedup, val set 1.165x speedup, step: 15, train time 8.39 s
Epoch 44/50 |loss: 0.088450| train set 3.049x speedup, test set 2.649x speedup, val set 1.095x speedup, step: 16, train time 8.40 s
Epoch 45/50 |loss: 0.088006| train set 2.741x speedup, test set 1.464x speedup, val set 1.169x speedup, step: 17, train time 8.82 s
Epoch 46/50 |loss: 0.085921| train set 2.846x speedup, test set 1.444x speedup, val set 1.297x speedup, step: 18, train time 8.62 s
Epoch 47/50 |loss: 0.097652| train set 3.020x speedup, test set 1.478x speedup, val set 1.297x speedup, step: 19, train time 8.41 s
Epoch 48/50 |loss: 0.082061| train set 2.982x speedup, test set 2.597x speedup, val set 1.165x speedup, step: 20, train time 8.22 s
Epoch 49/50 |loss: 0.087431| train set 2.810x speedup, test set 2.492x speedup, val set 0.956x speedup, step: 21, train time 8.59 s
Training per epoch cost 8.551 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 6.580s, pg runtime 5.572s, speedup 0.847x
30, opt runtime 5.539s, model runtime 6.521s, pg runtime 5.539s, speedup 0.849x
31, opt runtime 24.840s, model runtime 605.138s, pg runtime 626.529s, speedup 1.035x
32, opt runtime 24.662s, model runtime 615.484s, pg runtime 613.999s, speedup 0.998x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 40, train speedup 3.049, test speedup 2.672, val speedup 1.297
best test speedup epoch: 22, train speedup 2.463, test speedup 2.700, val speedup 1.127
best validation speedup epoch: 29, train speedup 2.762, test speedup 1.428, val speedup 1.127
last model at epoch 49, train speedup 2.810, test speedup 2.492, val speedup 0.956
execution cost 0:07:39.024054
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.717481, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.413860| train set 1.037x speedup, test set 2.563x speedup, val set 0.985x speedup, step: 1, train time 9.67 s
Epoch 1/50 |loss: 0.339306| train set 1.017x speedup, test set 2.529x speedup, val set 0.983x speedup, step: 2, train time 8.42 s
Epoch 2/50 |loss: 0.304590| train set 2.185x speedup, test set 2.518x speedup, val set 0.989x speedup, step: 3, train time 8.53 s
Epoch 3/50 |loss: 0.282738| train set 2.473x speedup, test set 2.582x speedup, val set 1.069x speedup, step: 4, train time 8.52 s
Epoch 4/50 |loss: 0.263956| train set 2.367x speedup, test set 2.461x speedup, val set 1.069x speedup, step: 1, train time 10.22 s
Epoch 5/50 |loss: 0.247416| train set 1.871x speedup, test set 2.543x speedup, val set 1.042x speedup, step: 2, train time 8.51 s
Epoch 6/50 |loss: 0.231781| train set 2.728x speedup, test set 1.680x speedup, val set 0.922x speedup, step: 3, train time 9.20 s
Epoch 7/50 |loss: 0.226096| train set 2.295x speedup, test set 1.393x speedup, val set 0.909x speedup, step: 4, train time 9.01 s
Epoch 8/50 |loss: 0.205947| train set 2.550x speedup, test set 1.695x speedup, val set 0.964x speedup, step: 5, train time 9.14 s
Epoch 9/50 |loss: 0.202792| train set 2.649x speedup, test set 1.711x speedup, val set 1.065x speedup, step: 6, train time 8.61 s
Epoch 10/50 |loss: 0.202290| train set 2.748x speedup, test set 1.400x speedup, val set 0.964x speedup, step: 7, train time 8.42 s
Epoch 11/50 |loss: 0.182418| train set 2.486x speedup, test set 1.400x speedup, val set 0.983x speedup, step: 8, train time 8.50 s
Epoch 12/50 |loss: 0.178990| train set 2.899x speedup, test set 2.590x speedup, val set 1.069x speedup, step: 9, train time 8.43 s
Epoch 13/50 |loss: 0.180455| train set 2.697x speedup, test set 1.375x speedup, val set 0.922x speedup, step: 10, train time 8.62 s
Epoch 14/50 |loss: 0.172643| train set 2.761x speedup, test set 1.413x speedup, val set 1.115x speedup, step: 1, train time 8.64 s
Epoch 15/50 |loss: 0.161341| train set 2.716x speedup, test set 0.984x speedup, val set 1.115x speedup, step: 2, train time 8.51 s
Epoch 16/50 |loss: 0.155641| train set 2.803x speedup, test set 0.990x speedup, val set 0.821x speedup, step: 3, train time 9.02 s
Epoch 17/50 |loss: 0.150022| train set 2.580x speedup, test set 1.402x speedup, val set 1.095x speedup, step: 4, train time 8.31 s
Epoch 18/50 |loss: 0.149533| train set 2.899x speedup, test set 0.992x speedup, val set 1.047x speedup, step: 5, train time 8.53 s
Epoch 19/50 |loss: 0.143998| train set 2.806x speedup, test set 1.415x speedup, val set 0.971x speedup, step: 6, train time 8.60 s
Epoch 20/50 |loss: 0.141163| train set 2.870x speedup, test set 1.378x speedup, val set 1.095x speedup, step: 7, train time 8.91 s
Epoch 21/50 |loss: 0.136320| train set 2.640x speedup, test set 0.993x speedup, val set 0.971x speedup, step: 8, train time 8.81 s
Epoch 22/50 |loss: 0.134976| train set 2.620x speedup, test set 2.639x speedup, val set 0.811x speedup, step: 9, train time 9.00 s
Epoch 23/50 |loss: 0.127667| train set 2.672x speedup, test set 0.968x speedup, val set 1.115x speedup, step: 10, train time 8.53 s
Epoch 24/50 |loss: 0.126928| train set 2.889x speedup, test set 0.989x speedup, val set 0.957x speedup, step: 11, train time 8.31 s
Epoch 25/50 |loss: 0.127306| train set 2.910x speedup, test set 1.655x speedup, val set 0.896x speedup, step: 12, train time 9.60 s
Epoch 26/50 |loss: 0.134567| train set 2.943x speedup, test set 1.422x speedup, val set 1.095x speedup, step: 13, train time 8.52 s
Epoch 27/50 |loss: 0.120534| train set 2.894x speedup, test set 1.438x speedup, val set 1.115x speedup, step: 14, train time 8.61 s
Epoch 28/50 |loss: 0.113638| train set 2.940x speedup, test set 2.633x speedup, val set 0.948x speedup, step: 15, train time 8.33 s
Epoch 29/50 |loss: 0.116606| train set 2.907x speedup, test set 1.370x speedup, val set 0.987x speedup, step: 16, train time 8.54 s
Epoch 30/50 |loss: 0.113920| train set 2.839x speedup, test set 0.988x speedup, val set 0.953x speedup, step: 17, train time 8.39 s
Epoch 31/50 |loss: 0.111119| train set 2.910x speedup, test set 0.991x speedup, val set 1.047x speedup, step: 18, train time 8.91 s
Epoch 32/50 |loss: 0.116153| train set 2.851x speedup, test set 0.957x speedup, val set 0.957x speedup, step: 19, train time 8.71 s
Epoch 33/50 |loss: 0.103334| train set 3.000x speedup, test set 0.998x speedup, val set 1.047x speedup, step: 20, train time 8.53 s
Epoch 34/50 |loss: 0.106996| train set 2.801x speedup, test set 2.668x speedup, val set 1.076x speedup, step: 21, train time 8.70 s
Epoch 35/50 |loss: 0.107266| train set 2.921x speedup, test set 0.991x speedup, val set 1.047x speedup, step: 22, train time 8.82 s
Epoch 36/50 |loss: 0.099652| train set 2.992x speedup, test set 0.965x speedup, val set 1.165x speedup, step: 23, train time 8.32 s
Epoch 37/50 |loss: 0.101275| train set 2.964x speedup, test set 1.664x speedup, val set 1.065x speedup, step: 24, train time 8.51 s
Epoch 38/50 |loss: 0.104818| train set 2.966x speedup, test set 1.104x speedup, val set 1.047x speedup, step: 25, train time 8.91 s
Epoch 39/50 |loss: 0.091692| train set 2.950x speedup, test set 2.499x speedup, val set 0.971x speedup, step: 26, train time 8.42 s
Epoch 40/50 |loss: 0.097831| train set 3.017x speedup, test set 1.395x speedup, val set 1.095x speedup, step: 27, train time 8.51 s
Epoch 41/50 |loss: 0.094149| train set 3.049x speedup, test set 2.486x speedup, val set 1.076x speedup, step: 28, train time 8.72 s
Epoch 42/50 |loss: 0.097196| train set 2.851x speedup, test set 2.363x speedup, val set 0.948x speedup, step: 29, train time 8.89 s
Epoch 43/50 |loss: 0.084812| train set 2.837x speedup, test set 2.420x speedup, val set 0.908x speedup, step: 30, train time 8.32 s
Epoch 44/50 |loss: 0.091250| train set 2.961x speedup, test set 1.390x speedup, val set 0.971x speedup, step: 31, train time 8.83 s
Epoch 45/50 |loss: 0.091385| train set 2.974x speedup, test set 1.361x speedup, val set 0.971x speedup, step: 32, train time 8.58 s
Epoch 46/50 |loss: 0.084453| train set 2.731x speedup, test set 1.362x speedup, val set 0.974x speedup, step: 33, train time 8.32 s
Epoch 47/50 |loss: 0.089956| train set 2.959x speedup, test set 1.383x speedup, val set 1.095x speedup, step: 34, train time 8.62 s
Epoch 48/50 |loss: 0.083643| train set 2.904x speedup, test set 2.360x speedup, val set 0.971x speedup, step: 35, train time 9.69 s
Epoch 49/50 |loss: 0.083359| train set 2.764x speedup, test set 1.403x speedup, val set 1.031x speedup, step: 36, train time 8.70 s
Training per epoch cost 8.719 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 12.337s, pg runtime 1.206s, speedup 0.098x
40, opt runtime 1.086s, model runtime 13.122s, pg runtime 1.181s, speedup 0.090x
====================
best train speedup epoch: 41, train speedup 3.049, test speedup 2.486, val speedup 1.076
best test speedup epoch: 34, train speedup 2.801, test speedup 2.668, val speedup 1.076
best validation speedup epoch: 14, train speedup 2.761, test speedup 1.413, val speedup 1.115
last model at epoch 49, train speedup 2.764, test speedup 1.403, val speedup 1.031
execution cost 0:07:49.203605
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.710286, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414344| train set 1.039x speedup, test set 2.678x speedup, val set 0.985x speedup, step: 1, train time 9.82 s
Epoch 1/50 |loss: 0.339546| train set 1.049x speedup, test set 2.450x speedup, val set 0.983x speedup, step: 2, train time 8.32 s
Epoch 2/50 |loss: 0.304116| train set 2.194x speedup, test set 2.424x speedup, val set 0.987x speedup, step: 3, train time 8.70 s
Epoch 3/50 |loss: 0.277354| train set 2.459x speedup, test set 2.545x speedup, val set 0.771x speedup, step: 4, train time 8.61 s
Epoch 4/50 |loss: 0.265348| train set 2.468x speedup, test set 1.429x speedup, val set 0.875x speedup, step: 1, train time 9.20 s
Epoch 5/50 |loss: 0.245098| train set 2.211x speedup, test set 1.446x speedup, val set 1.043x speedup, step: 2, train time 8.42 s
Epoch 6/50 |loss: 0.235303| train set 2.666x speedup, test set 1.422x speedup, val set 1.044x speedup, step: 3, train time 8.70 s
Epoch 7/50 |loss: 0.223166| train set 2.200x speedup, test set 1.375x speedup, val set 0.898x speedup, step: 4, train time 9.30 s
Epoch 8/50 |loss: 0.208818| train set 2.698x speedup, test set 2.524x speedup, val set 0.964x speedup, step: 5, train time 8.83 s
Epoch 9/50 |loss: 0.200758| train set 2.641x speedup, test set 1.425x speedup, val set 1.132x speedup, step: 1, train time 8.10 s
Epoch 10/50 |loss: 0.199399| train set 2.765x speedup, test set 1.396x speedup, val set 0.956x speedup, step: 2, train time 8.71 s
Epoch 11/50 |loss: 0.183480| train set 2.269x speedup, test set 1.360x speedup, val set 1.187x speedup, step: 3, train time 8.42 s
Epoch 12/50 |loss: 0.175749| train set 2.657x speedup, test set 1.349x speedup, val set 1.169x speedup, step: 4, train time 8.31 s
Epoch 13/50 |loss: 0.178220| train set 2.664x speedup, test set 1.350x speedup, val set 1.044x speedup, step: 5, train time 8.91 s
Epoch 14/50 |loss: 0.173229| train set 2.757x speedup, test set 0.980x speedup, val set 1.165x speedup, step: 1, train time 9.03 s
Epoch 15/50 |loss: 0.156237| train set 2.706x speedup, test set 0.960x speedup, val set 1.126x speedup, step: 2, train time 8.91 s
Epoch 16/50 |loss: 0.153594| train set 2.840x speedup, test set 0.959x speedup, val set 1.297x speedup, step: 3, train time 8.42 s
Epoch 17/50 |loss: 0.146372| train set 2.627x speedup, test set 0.962x speedup, val set 1.169x speedup, step: 4, train time 8.62 s
Epoch 18/50 |loss: 0.144672| train set 2.999x speedup, test set 1.355x speedup, val set 1.111x speedup, step: 5, train time 8.64 s
Epoch 19/50 |loss: 0.139547| train set 2.844x speedup, test set 1.390x speedup, val set 1.111x speedup, step: 6, train time 8.71 s
Epoch 20/50 |loss: 0.134939| train set 2.833x speedup, test set 1.364x speedup, val set 1.026x speedup, step: 7, train time 8.41 s
Epoch 21/50 |loss: 0.130341| train set 2.373x speedup, test set 0.976x speedup, val set 1.021x speedup, step: 8, train time 8.71 s
Epoch 22/50 |loss: 0.131882| train set 2.652x speedup, test set 1.375x speedup, val set 1.297x speedup, step: 9, train time 8.70 s
Epoch 23/50 |loss: 0.121665| train set 2.993x speedup, test set 1.331x speedup, val set 1.111x speedup, step: 10, train time 8.63 s
Epoch 24/50 |loss: 0.116298| train set 3.010x speedup, test set 0.974x speedup, val set 1.026x speedup, step: 11, train time 9.10 s
Epoch 25/50 |loss: 0.123192| train set 2.929x speedup, test set 1.347x speedup, val set 1.111x speedup, step: 12, train time 8.71 s
Epoch 26/50 |loss: 0.124569| train set 3.046x speedup, test set 1.391x speedup, val set 1.111x speedup, step: 13, train time 9.03 s
Epoch 27/50 |loss: 0.111731| train set 2.759x speedup, test set 0.959x speedup, val set 1.165x speedup, step: 14, train time 8.41 s
Epoch 28/50 |loss: 0.107315| train set 2.984x speedup, test set 1.358x speedup, val set 1.297x speedup, step: 15, train time 8.61 s
Epoch 29/50 |loss: 0.109015| train set 2.946x speedup, test set 1.359x speedup, val set 1.026x speedup, step: 16, train time 8.73 s
Epoch 30/50 |loss: 0.111150| train set 2.840x speedup, test set 0.974x speedup, val set 1.021x speedup, step: 17, train time 9.03 s
Epoch 31/50 |loss: 0.101134| train set 2.773x speedup, test set 1.366x speedup, val set 1.231x speedup, step: 18, train time 8.31 s
Epoch 32/50 |loss: 0.113430| train set 2.694x speedup, test set 1.365x speedup, val set 1.165x speedup, step: 19, train time 8.81 s
Epoch 33/50 |loss: 0.098074| train set 3.051x speedup, test set 0.982x speedup, val set 1.111x speedup, step: 20, train time 8.80 s
Epoch 34/50 |loss: 0.098923| train set 3.047x speedup, test set 1.404x speedup, val set 1.165x speedup, step: 1, train time 8.71 s
Epoch 35/50 |loss: 0.102698| train set 2.964x speedup, test set 0.958x speedup, val set 1.297x speedup, step: 2, train time 8.21 s
Epoch 36/50 |loss: 0.095526| train set 2.976x speedup, test set 1.342x speedup, val set 1.165x speedup, step: 3, train time 8.64 s
Epoch 37/50 |loss: 0.094257| train set 2.959x speedup, test set 1.346x speedup, val set 1.231x speedup, step: 4, train time 8.32 s
Epoch 38/50 |loss: 0.096484| train set 2.944x speedup, test set 1.366x speedup, val set 1.297x speedup, step: 5, train time 8.50 s
Epoch 39/50 |loss: 0.089915| train set 2.887x speedup, test set 1.371x speedup, val set 1.165x speedup, step: 6, train time 8.71 s
Epoch 40/50 |loss: 0.087786| train set 3.045x speedup, test set 1.373x speedup, val set 1.111x speedup, step: 7, train time 9.03 s
Epoch 41/50 |loss: 0.086656| train set 2.903x speedup, test set 0.954x speedup, val set 1.165x speedup, step: 8, train time 8.40 s
Epoch 42/50 |loss: 0.095297| train set 2.850x speedup, test set 1.344x speedup, val set 1.231x speedup, step: 9, train time 8.80 s
Epoch 43/50 |loss: 0.082600| train set 2.837x speedup, test set 1.350x speedup, val set 1.165x speedup, step: 10, train time 8.42 s
Epoch 44/50 |loss: 0.087736| train set 2.944x speedup, test set 1.385x speedup, val set 1.231x speedup, step: 1, train time 8.71 s
Epoch 45/50 |loss: 0.089158| train set 2.961x speedup, test set 1.349x speedup, val set 1.165x speedup, step: 2, train time 8.69 s
Epoch 46/50 |loss: 0.086660| train set 2.969x speedup, test set 0.964x speedup, val set 1.165x speedup, step: 3, train time 9.19 s
Epoch 47/50 |loss: 0.091980| train set 2.957x speedup, test set 1.389x speedup, val set 1.164x speedup, step: 4, train time 8.72 s
Epoch 48/50 |loss: 0.082526| train set 2.901x speedup, test set 0.963x speedup, val set 1.122x speedup, step: 5, train time 8.31 s
Epoch 49/50 |loss: 0.082126| train set 2.856x speedup, test set 1.337x speedup, val set 1.111x speedup, step: 6, train time 8.65 s
Training per epoch cost 8.694 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 33, train speedup 3.051, test speedup 0.982, val speedup 1.111
best test speedup epoch: 0, train speedup 1.039, test speedup 2.678, val speedup 0.985
best validation speedup epoch: 44, train speedup 2.944, test speedup 1.385, val speedup 1.231
last model at epoch 49, train speedup 2.856, test speedup 1.337, val speedup 1.111
execution cost 0:07:47.906571
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.732627, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414248| train set 1.044x speedup, test set 2.530x speedup, val set 0.985x speedup, step: 1, train time 9.51 s
Epoch 1/50 |loss: 0.339308| train set 1.070x speedup, test set 2.421x speedup, val set 0.983x speedup, step: 2, train time 8.92 s
Epoch 2/50 |loss: 0.307411| train set 2.456x speedup, test set 2.388x speedup, val set 0.987x speedup, step: 3, train time 8.50 s
Epoch 3/50 |loss: 0.282120| train set 2.099x speedup, test set 2.524x speedup, val set 0.731x speedup, step: 4, train time 8.72 s
Epoch 4/50 |loss: 0.265013| train set 2.749x speedup, test set 2.653x speedup, val set 1.065x speedup, step: 1, train time 9.43 s
Epoch 5/50 |loss: 0.245277| train set 2.163x speedup, test set 1.654x speedup, val set 0.873x speedup, step: 2, train time 8.67 s
Epoch 6/50 |loss: 0.229487| train set 2.789x speedup, test set 1.422x speedup, val set 1.133x speedup, step: 3, train time 8.51 s
Epoch 7/50 |loss: 0.219057| train set 2.210x speedup, test set 0.988x speedup, val set 0.909x speedup, step: 4, train time 9.10 s
Epoch 8/50 |loss: 0.202997| train set 2.744x speedup, test set 1.102x speedup, val set 1.106x speedup, step: 5, train time 8.41 s
Epoch 9/50 |loss: 0.197379| train set 2.595x speedup, test set 1.731x speedup, val set 1.048x speedup, step: 6, train time 8.71 s
Epoch 10/50 |loss: 0.194251| train set 2.906x speedup, test set 1.465x speedup, val set 1.030x speedup, step: 7, train time 8.91 s
Epoch 11/50 |loss: 0.181881| train set 2.412x speedup, test set 1.650x speedup, val set 1.122x speedup, step: 8, train time 9.13 s
Epoch 12/50 |loss: 0.176349| train set 2.829x speedup, test set 2.632x speedup, val set 1.031x speedup, step: 9, train time 8.12 s
Epoch 13/50 |loss: 0.174314| train set 2.748x speedup, test set 2.498x speedup, val set 1.231x speedup, step: 10, train time 8.51 s
Epoch 14/50 |loss: 0.167525| train set 2.632x speedup, test set 1.689x speedup, val set 0.948x speedup, step: 11, train time 8.90 s
Epoch 15/50 |loss: 0.156131| train set 2.711x speedup, test set 1.376x speedup, val set 1.065x speedup, step: 12, train time 8.73 s
Epoch 16/50 |loss: 0.145996| train set 2.951x speedup, test set 1.635x speedup, val set 0.948x speedup, step: 13, train time 8.81 s
Epoch 17/50 |loss: 0.149906| train set 2.642x speedup, test set 1.706x speedup, val set 1.096x speedup, step: 14, train time 8.53 s
Epoch 18/50 |loss: 0.144828| train set 2.996x speedup, test set 2.354x speedup, val set 0.920x speedup, step: 15, train time 8.79 s
Epoch 19/50 |loss: 0.140250| train set 2.849x speedup, test set 2.789x speedup, val set 0.920x speedup, step: 16, train time 8.69 s
Epoch 20/50 |loss: 0.135076| train set 2.876x speedup, test set 1.641x speedup, val set 0.957x speedup, step: 17, train time 8.64 s
Epoch 21/50 |loss: 0.126077| train set 2.507x speedup, test set 1.380x speedup, val set 0.985x speedup, step: 18, train time 8.80 s
Epoch 22/50 |loss: 0.129382| train set 2.815x speedup, test set 1.689x speedup, val set 0.874x speedup, step: 19, train time 8.62 s
Epoch 23/50 |loss: 0.121028| train set 2.699x speedup, test set 2.485x speedup, val set 0.920x speedup, step: 20, train time 9.22 s
Epoch 24/50 |loss: 0.119690| train set 2.985x speedup, test set 2.792x speedup, val set 0.920x speedup, step: 21, train time 8.62 s
Epoch 25/50 |loss: 0.121273| train set 2.885x speedup, test set 2.480x speedup, val set 1.031x speedup, step: 22, train time 8.43 s
Epoch 26/50 |loss: 0.126141| train set 2.983x speedup, test set 2.592x speedup, val set 1.047x speedup, step: 23, train time 8.81 s
Epoch 27/50 |loss: 0.113629| train set 3.044x speedup, test set 2.491x speedup, val set 1.031x speedup, step: 24, train time 9.12 s
Epoch 28/50 |loss: 0.106913| train set 2.835x speedup, test set 2.522x speedup, val set 1.153x speedup, step: 25, train time 8.83 s
Epoch 29/50 |loss: 0.106829| train set 2.803x speedup, test set 1.624x speedup, val set 0.933x speedup, step: 26, train time 8.42 s
Epoch 30/50 |loss: 0.105865| train set 2.841x speedup, test set 2.562x speedup, val set 0.953x speedup, step: 27, train time 8.80 s
Epoch 31/50 |loss: 0.105636| train set 2.822x speedup, test set 2.669x speedup, val set 1.047x speedup, step: 28, train time 8.62 s
Epoch 32/50 |loss: 0.102149| train set 2.995x speedup, test set 2.928x speedup, val set 0.933x speedup, step: 29, train time 9.10 s
Epoch 33/50 |loss: 0.099864| train set 2.865x speedup, test set 2.545x speedup, val set 1.047x speedup, step: 30, train time 8.24 s
Epoch 34/50 |loss: 0.099620| train set 2.850x speedup, test set 1.653x speedup, val set 0.971x speedup, step: 31, train time 8.71 s
Epoch 35/50 |loss: 0.102035| train set 2.963x speedup, test set 2.655x speedup, val set 1.153x speedup, step: 32, train time 8.41 s
Epoch 36/50 |loss: 0.093200| train set 2.973x speedup, test set 2.789x speedup, val set 0.933x speedup, step: 33, train time 8.81 s
Epoch 37/50 |loss: 0.094612| train set 2.970x speedup, test set 2.807x speedup, val set 1.153x speedup, step: 34, train time 8.59 s
Epoch 38/50 |loss: 0.099920| train set 2.821x speedup, test set 1.656x speedup, val set 0.971x speedup, step: 35, train time 8.72 s
Epoch 39/50 |loss: 0.091134| train set 3.026x speedup, test set 1.655x speedup, val set 0.957x speedup, step: 36, train time 8.51 s
Epoch 40/50 |loss: 0.094294| train set 2.977x speedup, test set 2.613x speedup, val set 1.065x speedup, step: 37, train time 8.71 s
Epoch 41/50 |loss: 0.090571| train set 3.046x speedup, test set 2.488x speedup, val set 0.920x speedup, step: 38, train time 8.52 s
Epoch 42/50 |loss: 0.094190| train set 2.889x speedup, test set 2.724x speedup, val set 0.933x speedup, step: 39, train time 8.62 s
Epoch 43/50 |loss: 0.086851| train set 2.817x speedup, test set 2.549x speedup, val set 0.920x speedup, step: 40, train time 8.60 s
Epoch 44/50 |loss: 0.086555| train set 2.971x speedup, test set 2.981x speedup, val set 0.933x speedup, step: 41, train time 8.40 s
Epoch 45/50 |loss: 0.088791| train set 3.032x speedup, test set 2.491x speedup, val set 0.971x speedup, step: 42, train time 8.41 s
Epoch 46/50 |loss: 0.082228| train set 2.948x speedup, test set 2.670x speedup, val set 1.047x speedup, step: 43, train time 8.82 s
Epoch 47/50 |loss: 0.094257| train set 2.961x speedup, test set 2.652x speedup, val set 0.933x speedup, step: 44, train time 9.10 s
Epoch 48/50 |loss: 0.080852| train set 2.894x speedup, test set 2.640x speedup, val set 1.061x speedup, step: 45, train time 9.39 s
Epoch 49/50 |loss: 0.085718| train set 2.854x speedup, test set 2.760x speedup, val set 1.031x speedup, step: 46, train time 8.30 s
Training per epoch cost 8.730 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 41, train speedup 3.046, test speedup 2.488, val speedup 0.920
best test speedup epoch: 44, train speedup 2.971, test speedup 2.981, val speedup 0.933
best validation speedup epoch: 4, train speedup 2.749, test speedup 2.653, val speedup 1.065
last model at epoch 49, train speedup 2.854, test speedup 2.760, val speedup 1.031
execution cost 0:07:50.229276
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.712711, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414028| train set 1.038x speedup, test set 2.574x speedup, val set 1.060x speedup, step: 1, train time 9.65 s
Epoch 1/50 |loss: 0.340197| train set 1.124x speedup, test set 2.460x speedup, val set 0.985x speedup, step: 2, train time 8.41 s
Epoch 2/50 |loss: 0.306729| train set 2.462x speedup, test set 2.524x speedup, val set 0.987x speedup, step: 3, train time 8.53 s
Epoch 3/50 |loss: 0.284566| train set 2.232x speedup, test set 2.633x speedup, val set 0.912x speedup, step: 4, train time 9.02 s
Epoch 4/50 |loss: 0.263978| train set 2.482x speedup, test set 2.431x speedup, val set 1.003x speedup, step: 1, train time 9.72 s
Epoch 5/50 |loss: 0.245120| train set 2.302x speedup, test set 1.410x speedup, val set 1.043x speedup, step: 2, train time 8.51 s
Epoch 6/50 |loss: 0.231109| train set 2.681x speedup, test set 2.486x speedup, val set 0.873x speedup, step: 3, train time 8.61 s
Epoch 7/50 |loss: 0.223370| train set 2.240x speedup, test set 1.410x speedup, val set 0.824x speedup, step: 4, train time 9.22 s
Epoch 8/50 |loss: 0.208203| train set 2.668x speedup, test set 1.455x speedup, val set 0.866x speedup, step: 5, train time 8.60 s
Epoch 9/50 |loss: 0.200516| train set 2.603x speedup, test set 2.449x speedup, val set 1.136x speedup, step: 1, train time 8.80 s
Epoch 10/50 |loss: 0.199462| train set 2.774x speedup, test set 2.597x speedup, val set 0.817x speedup, step: 2, train time 9.19 s
Epoch 11/50 |loss: 0.184448| train set 2.434x speedup, test set 1.099x speedup, val set 0.874x speedup, step: 3, train time 8.70 s
Epoch 12/50 |loss: 0.180561| train set 2.780x speedup, test set 2.704x speedup, val set 0.923x speedup, step: 4, train time 8.74 s
Epoch 13/50 |loss: 0.177956| train set 2.686x speedup, test set 0.981x speedup, val set 0.886x speedup, step: 5, train time 8.93 s
Epoch 14/50 |loss: 0.172956| train set 2.772x speedup, test set 2.513x speedup, val set 0.811x speedup, step: 6, train time 8.94 s
Epoch 15/50 |loss: 0.161249| train set 2.530x speedup, test set 1.354x speedup, val set 0.821x speedup, step: 7, train time 8.38 s
Epoch 16/50 |loss: 0.155166| train set 2.787x speedup, test set 0.978x speedup, val set 0.811x speedup, step: 8, train time 9.03 s
Epoch 17/50 |loss: 0.153601| train set 2.635x speedup, test set 1.566x speedup, val set 0.896x speedup, step: 9, train time 8.41 s
Epoch 18/50 |loss: 0.148166| train set 2.914x speedup, test set 1.590x speedup, val set 0.813x speedup, step: 10, train time 8.70 s
Epoch 19/50 |loss: 0.141884| train set 2.843x speedup, test set 2.421x speedup, val set 0.923x speedup, step: 11, train time 8.41 s
Epoch 20/50 |loss: 0.140877| train set 2.818x speedup, test set 2.364x speedup, val set 0.920x speedup, step: 12, train time 9.30 s
Epoch 21/50 |loss: 0.134843| train set 2.369x speedup, test set 1.360x speedup, val set 0.970x speedup, step: 13, train time 8.63 s
Epoch 22/50 |loss: 0.132146| train set 2.612x speedup, test set 1.617x speedup, val set 0.821x speedup, step: 14, train time 9.13 s
Epoch 23/50 |loss: 0.123565| train set 2.843x speedup, test set 1.077x speedup, val set 0.885x speedup, step: 15, train time 9.54 s
Epoch 24/50 |loss: 0.125398| train set 2.811x speedup, test set 2.443x speedup, val set 0.957x speedup, step: 16, train time 8.51 s
Epoch 25/50 |loss: 0.126474| train set 2.923x speedup, test set 1.437x speedup, val set 0.936x speedup, step: 17, train time 8.40 s
Epoch 26/50 |loss: 0.130145| train set 2.984x speedup, test set 1.427x speedup, val set 0.933x speedup, step: 18, train time 8.82 s
Epoch 27/50 |loss: 0.118856| train set 2.955x speedup, test set 0.969x speedup, val set 0.984x speedup, step: 19, train time 9.20 s
Epoch 28/50 |loss: 0.113556| train set 2.987x speedup, test set 1.404x speedup, val set 1.017x speedup, step: 20, train time 8.41 s
Epoch 29/50 |loss: 0.111758| train set 2.798x speedup, test set 2.517x speedup, val set 0.974x speedup, step: 21, train time 8.42 s
Epoch 30/50 |loss: 0.118280| train set 2.530x speedup, test set 1.371x speedup, val set 1.021x speedup, step: 22, train time 8.39 s
Epoch 31/50 |loss: 0.111860| train set 2.804x speedup, test set 1.409x speedup, val set 1.047x speedup, step: 23, train time 8.51 s
Epoch 32/50 |loss: 0.113003| train set 2.811x speedup, test set 1.405x speedup, val set 0.933x speedup, step: 24, train time 8.31 s
Epoch 33/50 |loss: 0.104411| train set 3.017x speedup, test set 1.445x speedup, val set 0.821x speedup, step: 25, train time 8.90 s
Epoch 34/50 |loss: 0.104207| train set 2.268x speedup, test set 1.392x speedup, val set 0.824x speedup, step: 26, train time 8.70 s
Epoch 35/50 |loss: 0.110201| train set 2.912x speedup, test set 1.386x speedup, val set 1.017x speedup, step: 27, train time 8.61 s
Epoch 36/50 |loss: 0.099930| train set 2.795x speedup, test set 1.381x speedup, val set 0.936x speedup, step: 28, train time 8.70 s
Epoch 37/50 |loss: 0.105565| train set 2.931x speedup, test set 1.379x speedup, val set 1.061x speedup, step: 29, train time 9.00 s
Epoch 38/50 |loss: 0.107312| train set 2.986x speedup, test set 1.372x speedup, val set 0.984x speedup, step: 30, train time 8.75 s
Epoch 39/50 |loss: 0.092595| train set 2.970x speedup, test set 1.373x speedup, val set 0.933x speedup, step: 31, train time 9.02 s
Epoch 40/50 |loss: 0.100559| train set 2.996x speedup, test set 1.397x speedup, val set 0.863x speedup, step: 32, train time 8.60 s
Epoch 41/50 |loss: 0.095110| train set 2.986x speedup, test set 1.381x speedup, val set 0.974x speedup, step: 33, train time 8.54 s
Epoch 42/50 |loss: 0.102631| train set 3.008x speedup, test set 1.443x speedup, val set 0.824x speedup, step: 34, train time 8.89 s
Epoch 43/50 |loss: 0.091005| train set 2.805x speedup, test set 1.478x speedup, val set 0.821x speedup, step: 35, train time 8.40 s
Epoch 44/50 |loss: 0.093226| train set 2.814x speedup, test set 1.428x speedup, val set 0.821x speedup, step: 36, train time 8.52 s
Epoch 45/50 |loss: 0.100029| train set 2.892x speedup, test set 1.390x speedup, val set 0.974x speedup, step: 37, train time 8.42 s
Epoch 46/50 |loss: 0.094334| train set 2.938x speedup, test set 1.376x speedup, val set 0.987x speedup, step: 38, train time 8.59 s
Epoch 47/50 |loss: 0.098986| train set 2.956x speedup, test set 1.452x speedup, val set 0.824x speedup, step: 39, train time 8.51 s
Epoch 48/50 |loss: 0.082727| train set 2.930x speedup, test set 1.425x speedup, val set 1.026x speedup, step: 40, train time 8.81 s
Epoch 49/50 |loss: 0.086373| train set 2.775x speedup, test set 1.380x speedup, val set 0.936x speedup, step: 41, train time 8.74 s
Training per epoch cost 8.756 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 49.702s, pg runtime 32.278s, speedup 0.649x
06, opt runtime 25.597s, model runtime 51.074s, pg runtime 27.136s, speedup 0.531x
07, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
08, opt runtime 7.377s, model runtime 37.574s, pg runtime 28.655s, speedup 0.763x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 48.407s, pg runtime 32.939s, speedup 0.680x
18, opt runtime 6.149s, model runtime 45.581s, pg runtime 30.760s, speedup 0.675x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 37.819s, pg runtime 25.034s, speedup 0.662x
22, opt runtime 20.897s, model runtime 39.874s, pg runtime 23.708s, speedup 0.595x
23, opt runtime 6.250s, model runtime 17.756s, pg runtime 32.969s, speedup 1.857x
24, opt runtime 6.234s, model runtime 17.977s, pg runtime 32.540s, speedup 1.810x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.791s, pg runtime 5.572s, speedup 0.473x
30, opt runtime 5.539s, model runtime 10.142s, pg runtime 5.539s, speedup 0.546x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 33, train speedup 3.017, test speedup 1.445, val speedup 0.821
best test speedup epoch: 12, train speedup 2.780, test speedup 2.704, val speedup 0.923
best validation speedup epoch: 9, train speedup 2.603, test speedup 2.449, val speedup 1.136
last model at epoch 49, train speedup 2.775, test speedup 1.380, val speedup 0.936
execution cost 0:07:51.671418
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.732339, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.413391| train set 1.039x speedup, test set 2.548x speedup, val set 0.985x speedup, step: 1, train time 9.98 s
Epoch 1/50 |loss: 0.337885| train set 1.037x speedup, test set 2.429x speedup, val set 0.983x speedup, step: 2, train time 8.62 s
Epoch 2/50 |loss: 0.305931| train set 2.308x speedup, test set 2.485x speedup, val set 0.987x speedup, step: 3, train time 8.62 s
Epoch 3/50 |loss: 0.280289| train set 2.318x speedup, test set 2.543x speedup, val set 0.997x speedup, step: 4, train time 8.93 s
Epoch 4/50 |loss: 0.267312| train set 2.454x speedup, test set 1.376x speedup, val set 0.951x speedup, step: 1, train time 9.50 s
Epoch 5/50 |loss: 0.243337| train set 2.127x speedup, test set 2.671x speedup, val set 0.987x speedup, step: 2, train time 8.90 s
Epoch 6/50 |loss: 0.233225| train set 2.648x speedup, test set 1.404x speedup, val set 1.037x speedup, step: 3, train time 8.72 s
Epoch 7/50 |loss: 0.221726| train set 2.135x speedup, test set 1.349x speedup, val set 0.813x speedup, step: 4, train time 8.92 s
Epoch 8/50 |loss: 0.207267| train set 2.748x speedup, test set 2.602x speedup, val set 0.960x speedup, step: 5, train time 8.32 s
Epoch 9/50 |loss: 0.200025| train set 2.628x speedup, test set 2.574x speedup, val set 1.132x speedup, step: 1, train time 8.91 s
Epoch 10/50 |loss: 0.198368| train set 2.772x speedup, test set 2.673x speedup, val set 0.896x speedup, step: 2, train time 8.81 s
Epoch 11/50 |loss: 0.181772| train set 2.413x speedup, test set 1.672x speedup, val set 0.874x speedup, step: 3, train time 8.59 s
Epoch 12/50 |loss: 0.177403| train set 2.777x speedup, test set 2.470x speedup, val set 1.031x speedup, step: 4, train time 8.69 s
Epoch 13/50 |loss: 0.178912| train set 2.689x speedup, test set 2.482x speedup, val set 1.231x speedup, step: 5, train time 8.73 s
Epoch 14/50 |loss: 0.167533| train set 2.771x speedup, test set 2.470x speedup, val set 1.231x speedup, step: 1, train time 9.02 s
Epoch 15/50 |loss: 0.162104| train set 2.815x speedup, test set 1.419x speedup, val set 0.984x speedup, step: 2, train time 8.30 s
Epoch 16/50 |loss: 0.156107| train set 2.773x speedup, test set 2.447x speedup, val set 0.873x speedup, step: 3, train time 8.51 s
Epoch 17/50 |loss: 0.151248| train set 2.679x speedup, test set 2.447x speedup, val set 1.026x speedup, step: 4, train time 8.52 s
Epoch 18/50 |loss: 0.144899| train set 2.946x speedup, test set 2.484x speedup, val set 0.984x speedup, step: 5, train time 8.42 s
Epoch 19/50 |loss: 0.141684| train set 2.977x speedup, test set 2.740x speedup, val set 1.111x speedup, step: 6, train time 8.81 s
Epoch 20/50 |loss: 0.143608| train set 2.877x speedup, test set 2.637x speedup, val set 0.984x speedup, step: 7, train time 8.52 s
Epoch 21/50 |loss: 0.130720| train set 2.284x speedup, test set 2.519x speedup, val set 1.021x speedup, step: 8, train time 8.52 s
Epoch 22/50 |loss: 0.134935| train set 2.644x speedup, test set 2.548x speedup, val set 0.860x speedup, step: 9, train time 8.80 s
Epoch 23/50 |loss: 0.121767| train set 2.918x speedup, test set 2.579x speedup, val set 0.860x speedup, step: 10, train time 8.21 s
Epoch 24/50 |loss: 0.121861| train set 3.049x speedup, test set 2.513x speedup, val set 0.965x speedup, step: 11, train time 8.62 s
Epoch 25/50 |loss: 0.123648| train set 2.951x speedup, test set 2.590x speedup, val set 0.984x speedup, step: 12, train time 8.33 s
Epoch 26/50 |loss: 0.129631| train set 3.047x speedup, test set 2.528x speedup, val set 1.044x speedup, step: 13, train time 8.03 s
Epoch 27/50 |loss: 0.118444| train set 2.850x speedup, test set 2.603x speedup, val set 1.026x speedup, step: 14, train time 8.50 s
Epoch 28/50 |loss: 0.109577| train set 2.986x speedup, test set 2.513x speedup, val set 1.077x speedup, step: 15, train time 8.32 s
Epoch 29/50 |loss: 0.113010| train set 2.959x speedup, test set 2.513x speedup, val set 1.122x speedup, step: 16, train time 8.12 s
Epoch 30/50 |loss: 0.116229| train set 2.563x speedup, test set 1.374x speedup, val set 1.021x speedup, step: 17, train time 8.51 s
Epoch 31/50 |loss: 0.112719| train set 2.957x speedup, test set 2.513x speedup, val set 1.111x speedup, step: 18, train time 8.60 s
Epoch 32/50 |loss: 0.109096| train set 2.273x speedup, test set 1.359x speedup, val set 1.021x speedup, step: 19, train time 8.40 s
Epoch 33/50 |loss: 0.102189| train set 3.042x speedup, test set 2.648x speedup, val set 0.956x speedup, step: 20, train time 8.40 s
Epoch 34/50 |loss: 0.102210| train set 3.027x speedup, test set 2.574x speedup, val set 0.980x speedup, step: 21, train time 8.91 s
Epoch 35/50 |loss: 0.104720| train set 2.983x speedup, test set 2.665x speedup, val set 0.931x speedup, step: 22, train time 8.51 s
Epoch 36/50 |loss: 0.100737| train set 2.955x speedup, test set 2.648x speedup, val set 0.860x speedup, step: 23, train time 8.31 s
Epoch 37/50 |loss: 0.098537| train set 2.948x speedup, test set 2.574x speedup, val set 1.297x speedup, step: 24, train time 8.62 s
Epoch 38/50 |loss: 0.100489| train set 2.984x speedup, test set 2.513x speedup, val set 1.111x speedup, step: 25, train time 8.12 s
Epoch 39/50 |loss: 0.089104| train set 2.819x speedup, test set 2.648x speedup, val set 1.165x speedup, step: 26, train time 8.43 s
Epoch 40/50 |loss: 0.090070| train set 3.046x speedup, test set 2.669x speedup, val set 1.165x speedup, step: 27, train time 8.42 s
Epoch 41/50 |loss: 0.091251| train set 2.889x speedup, test set 2.574x speedup, val set 1.026x speedup, step: 28, train time 8.60 s
Epoch 42/50 |loss: 0.101063| train set 2.831x speedup, test set 2.574x speedup, val set 1.021x speedup, step: 29, train time 8.20 s
Epoch 43/50 |loss: 0.087226| train set 2.836x speedup, test set 2.648x speedup, val set 0.984x speedup, step: 30, train time 8.51 s
Epoch 44/50 |loss: 0.087880| train set 2.979x speedup, test set 2.587x speedup, val set 1.077x speedup, step: 31, train time 8.51 s
Epoch 45/50 |loss: 0.099931| train set 2.980x speedup, test set 2.669x speedup, val set 1.026x speedup, step: 32, train time 8.22 s
Epoch 46/50 |loss: 0.089765| train set 2.900x speedup, test set 2.549x speedup, val set 1.165x speedup, step: 33, train time 8.20 s
Epoch 47/50 |loss: 0.091107| train set 2.920x speedup, test set 2.668x speedup, val set 0.860x speedup, step: 34, train time 8.83 s
Epoch 48/50 |loss: 0.084924| train set 2.880x speedup, test set 2.513x speedup, val set 1.026x speedup, step: 35, train time 8.20 s
Epoch 49/50 |loss: 0.081450| train set 3.022x speedup, test set 2.576x speedup, val set 0.860x speedup, step: 36, train time 8.32 s
Training per epoch cost 8.572 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 12.337s, pg runtime 1.206s, speedup 0.098x
40, opt runtime 1.086s, model runtime 13.122s, pg runtime 1.181s, speedup 0.090x
====================
best train speedup epoch: 24, train speedup 3.049, test speedup 2.513, val speedup 0.965
best test speedup epoch: 19, train speedup 2.977, test speedup 2.740, val speedup 1.111
best validation speedup epoch: 14, train speedup 2.771, test speedup 2.470, val speedup 1.231
last model at epoch 49, train speedup 3.022, test speedup 2.576, val speedup 0.860
execution cost 0:07:42.328853
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.699097, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414367| train set 1.039x speedup, test set 2.544x speedup, val set 0.985x speedup, step: 1, train time 9.82 s
Epoch 1/50 |loss: 0.338124| train set 1.104x speedup, test set 2.554x speedup, val set 0.983x speedup, step: 2, train time 8.30 s
Epoch 2/50 |loss: 0.303712| train set 2.451x speedup, test set 2.665x speedup, val set 0.987x speedup, step: 3, train time 8.89 s
Epoch 3/50 |loss: 0.278765| train set 2.404x speedup, test set 2.616x speedup, val set 0.870x speedup, step: 4, train time 8.43 s
Epoch 4/50 |loss: 0.265351| train set 2.469x speedup, test set 2.651x speedup, val set 0.948x speedup, step: 1, train time 9.01 s
Epoch 5/50 |loss: 0.244099| train set 2.186x speedup, test set 2.657x speedup, val set 0.987x speedup, step: 2, train time 8.40 s
Epoch 6/50 |loss: 0.231321| train set 2.688x speedup, test set 1.425x speedup, val set 0.968x speedup, step: 3, train time 8.31 s
Epoch 7/50 |loss: 0.222341| train set 2.490x speedup, test set 1.374x speedup, val set 0.974x speedup, step: 4, train time 8.42 s
Epoch 8/50 |loss: 0.208110| train set 2.652x speedup, test set 2.640x speedup, val set 0.971x speedup, step: 5, train time 8.80 s
Epoch 9/50 |loss: 0.200349| train set 2.656x speedup, test set 2.572x speedup, val set 1.065x speedup, step: 1, train time 8.51 s
Epoch 10/50 |loss: 0.198946| train set 2.772x speedup, test set 2.630x speedup, val set 0.894x speedup, step: 2, train time 8.60 s
Epoch 11/50 |loss: 0.184250| train set 2.471x speedup, test set 2.624x speedup, val set 0.957x speedup, step: 3, train time 8.32 s
Epoch 12/50 |loss: 0.180496| train set 2.759x speedup, test set 2.920x speedup, val set 1.031x speedup, step: 4, train time 8.42 s
Epoch 13/50 |loss: 0.176234| train set 2.704x speedup, test set 1.494x speedup, val set 0.971x speedup, step: 5, train time 8.31 s
Epoch 14/50 |loss: 0.171120| train set 2.777x speedup, test set 2.610x speedup, val set 1.165x speedup, step: 1, train time 8.91 s
Epoch 15/50 |loss: 0.159776| train set 2.891x speedup, test set 1.481x speedup, val set 0.956x speedup, step: 2, train time 8.32 s
Epoch 16/50 |loss: 0.156233| train set 2.645x speedup, test set 1.434x speedup, val set 1.094x speedup, step: 3, train time 8.50 s
Epoch 17/50 |loss: 0.150330| train set 2.670x speedup, test set 1.700x speedup, val set 0.957x speedup, step: 4, train time 8.33 s
Epoch 18/50 |loss: 0.146655| train set 2.931x speedup, test set 2.808x speedup, val set 1.047x speedup, step: 5, train time 8.73 s
Epoch 19/50 |loss: 0.145431| train set 2.952x speedup, test set 1.443x speedup, val set 1.026x speedup, step: 6, train time 8.23 s
Epoch 20/50 |loss: 0.138645| train set 2.705x speedup, test set 1.426x speedup, val set 0.971x speedup, step: 7, train time 8.21 s
Epoch 21/50 |loss: 0.131509| train set 2.257x speedup, test set 2.680x speedup, val set 0.971x speedup, step: 8, train time 8.31 s
Epoch 22/50 |loss: 0.133469| train set 2.944x speedup, test set 1.438x speedup, val set 0.956x speedup, step: 9, train time 8.60 s
Epoch 23/50 |loss: 0.122151| train set 2.981x speedup, test set 1.386x speedup, val set 0.860x speedup, step: 10, train time 8.62 s
Epoch 24/50 |loss: 0.117335| train set 2.953x speedup, test set 1.394x speedup, val set 1.031x speedup, step: 11, train time 8.64 s
Epoch 25/50 |loss: 0.119657| train set 2.899x speedup, test set 1.493x speedup, val set 1.111x speedup, step: 12, train time 8.41 s
Epoch 26/50 |loss: 0.122915| train set 3.046x speedup, test set 2.604x speedup, val set 1.047x speedup, step: 13, train time 8.62 s
Epoch 27/50 |loss: 0.117859| train set 3.038x speedup, test set 1.421x speedup, val set 1.111x speedup, step: 14, train time 8.12 s
Epoch 28/50 |loss: 0.112327| train set 2.985x speedup, test set 1.438x speedup, val set 1.047x speedup, step: 15, train time 8.51 s
Epoch 29/50 |loss: 0.111142| train set 2.991x speedup, test set 1.425x speedup, val set 1.021x speedup, step: 16, train time 8.71 s
Epoch 30/50 |loss: 0.113033| train set 2.790x speedup, test set 1.442x speedup, val set 1.021x speedup, step: 17, train time 8.20 s
Epoch 31/50 |loss: 0.104905| train set 2.812x speedup, test set 1.480x speedup, val set 1.111x speedup, step: 18, train time 8.47 s
Epoch 32/50 |loss: 0.106354| train set 2.683x speedup, test set 1.434x speedup, val set 1.021x speedup, step: 19, train time 8.39 s
Epoch 33/50 |loss: 0.101736| train set 3.052x speedup, test set 1.457x speedup, val set 1.111x speedup, step: 20, train time 8.51 s
Epoch 34/50 |loss: 0.101328| train set 2.832x speedup, test set 1.485x speedup, val set 1.026x speedup, step: 21, train time 8.33 s
Epoch 35/50 |loss: 0.103949| train set 2.922x speedup, test set 1.489x speedup, val set 1.111x speedup, step: 22, train time 8.31 s
Epoch 36/50 |loss: 0.096489| train set 3.012x speedup, test set 1.511x speedup, val set 1.111x speedup, step: 23, train time 8.60 s
Epoch 37/50 |loss: 0.096193| train set 2.815x speedup, test set 1.484x speedup, val set 1.095x speedup, step: 24, train time 8.31 s
Epoch 38/50 |loss: 0.095928| train set 3.050x speedup, test set 1.887x speedup, val set 1.111x speedup, step: 25, train time 8.40 s
Epoch 39/50 |loss: 0.091451| train set 3.047x speedup, test set 1.430x speedup, val set 1.165x speedup, step: 1, train time 8.50 s
Epoch 40/50 |loss: 0.094888| train set 3.050x speedup, test set 1.452x speedup, val set 0.956x speedup, step: 2, train time 8.52 s
Epoch 41/50 |loss: 0.086131| train set 3.002x speedup, test set 1.421x speedup, val set 1.165x speedup, step: 3, train time 8.43 s
Epoch 42/50 |loss: 0.099370| train set 2.852x speedup, test set 1.455x speedup, val set 1.165x speedup, step: 4, train time 8.28 s
Epoch 43/50 |loss: 0.089019| train set 2.982x speedup, test set 1.463x speedup, val set 1.111x speedup, step: 5, train time 8.50 s
Epoch 44/50 |loss: 0.088184| train set 2.985x speedup, test set 1.388x speedup, val set 0.984x speedup, step: 6, train time 8.30 s
Epoch 45/50 |loss: 0.094136| train set 3.051x speedup, test set 1.411x speedup, val set 1.111x speedup, step: 7, train time 8.50 s
Epoch 46/50 |loss: 0.090257| train set 2.957x speedup, test set 1.375x speedup, val set 1.168x speedup, step: 8, train time 8.42 s
Epoch 47/50 |loss: 0.093232| train set 2.616x speedup, test set 2.560x speedup, val set 1.165x speedup, step: 9, train time 8.42 s
Epoch 48/50 |loss: 0.083034| train set 2.847x speedup, test set 1.407x speedup, val set 1.026x speedup, step: 10, train time 8.41 s
Epoch 49/50 |loss: 0.085443| train set 2.674x speedup, test set 1.375x speedup, val set 1.047x speedup, step: 11, train time 8.49 s
Training per epoch cost 8.492 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 33, train speedup 3.052, test speedup 1.457, val speedup 1.111
best test speedup epoch: 12, train speedup 2.759, test speedup 2.920, val speedup 1.031
best validation speedup epoch: 39, train speedup 3.047, test speedup 1.430, val speedup 1.165
last model at epoch 49, train speedup 2.674, test speedup 1.375, val speedup 1.047
execution cost 0:07:37.293754
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.723951, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414302| train set 1.048x speedup, test set 2.566x speedup, val set 0.985x speedup, step: 1, train time 9.61 s
Epoch 1/50 |loss: 0.339283| train set 1.695x speedup, test set 2.662x speedup, val set 0.983x speedup, step: 2, train time 8.40 s
Epoch 2/50 |loss: 0.307705| train set 2.539x speedup, test set 2.498x speedup, val set 0.987x speedup, step: 3, train time 8.71 s
Epoch 3/50 |loss: 0.276633| train set 2.397x speedup, test set 2.886x speedup, val set 0.997x speedup, step: 4, train time 8.43 s
Epoch 4/50 |loss: 0.263428| train set 2.260x speedup, test set 2.659x speedup, val set 0.951x speedup, step: 1, train time 9.20 s
Epoch 5/50 |loss: 0.245704| train set 2.059x speedup, test set 1.646x speedup, val set 0.833x speedup, step: 2, train time 8.52 s
Epoch 6/50 |loss: 0.230555| train set 2.506x speedup, test set 0.984x speedup, val set 1.048x speedup, step: 3, train time 8.42 s
Epoch 7/50 |loss: 0.222169| train set 2.634x speedup, test set 0.993x speedup, val set 0.912x speedup, step: 4, train time 8.11 s
Epoch 8/50 |loss: 0.204442| train set 2.810x speedup, test set 1.084x speedup, val set 0.905x speedup, step: 5, train time 8.21 s
Epoch 9/50 |loss: 0.197975| train set 2.944x speedup, test set 1.001x speedup, val set 1.042x speedup, step: 1, train time 8.89 s
Epoch 10/50 |loss: 0.198727| train set 2.774x speedup, test set 1.426x speedup, val set 0.810x speedup, step: 2, train time 8.31 s
Epoch 11/50 |loss: 0.181472| train set 2.421x speedup, test set 1.135x speedup, val set 1.061x speedup, step: 3, train time 8.52 s
Epoch 12/50 |loss: 0.173917| train set 2.911x speedup, test set 1.467x speedup, val set 1.050x speedup, step: 4, train time 8.60 s
Epoch 13/50 |loss: 0.176459| train set 2.771x speedup, test set 0.969x speedup, val set 0.911x speedup, step: 5, train time 8.63 s
Epoch 14/50 |loss: 0.170371| train set 2.761x speedup, test set 0.996x speedup, val set 0.922x speedup, step: 6, train time 8.23 s
Epoch 15/50 |loss: 0.153759| train set 2.812x speedup, test set 0.965x speedup, val set 1.049x speedup, step: 7, train time 8.42 s
Epoch 16/50 |loss: 0.147323| train set 2.925x speedup, test set 0.988x speedup, val set 0.911x speedup, step: 8, train time 8.53 s
Epoch 17/50 |loss: 0.145515| train set 2.691x speedup, test set 1.439x speedup, val set 1.098x speedup, step: 9, train time 8.91 s
Epoch 18/50 |loss: 0.142464| train set 3.026x speedup, test set 1.116x speedup, val set 1.051x speedup, step: 10, train time 8.90 s
Epoch 19/50 |loss: 0.141412| train set 2.859x speedup, test set 0.983x speedup, val set 1.098x speedup, step: 1, train time 8.41 s
Epoch 20/50 |loss: 0.137419| train set 2.711x speedup, test set 0.962x speedup, val set 0.959x speedup, step: 2, train time 8.70 s
Epoch 21/50 |loss: 0.132657| train set 2.399x speedup, test set 1.116x speedup, val set 0.970x speedup, step: 3, train time 8.72 s
Epoch 22/50 |loss: 0.133443| train set 2.909x speedup, test set 0.962x speedup, val set 1.044x speedup, step: 4, train time 8.41 s
Epoch 23/50 |loss: 0.120748| train set 2.879x speedup, test set 0.962x speedup, val set 1.095x speedup, step: 5, train time 8.89 s
Epoch 24/50 |loss: 0.119968| train set 2.835x speedup, test set 0.987x speedup, val set 1.076x speedup, step: 6, train time 8.29 s
Epoch 25/50 |loss: 0.123730| train set 2.943x speedup, test set 0.983x speedup, val set 0.896x speedup, step: 7, train time 8.20 s
Epoch 26/50 |loss: 0.127005| train set 2.983x speedup, test set 0.983x speedup, val set 1.048x speedup, step: 8, train time 8.61 s
Epoch 27/50 |loss: 0.114425| train set 2.820x speedup, test set 0.992x speedup, val set 0.955x speedup, step: 9, train time 8.73 s
Epoch 28/50 |loss: 0.107334| train set 2.982x speedup, test set 0.974x speedup, val set 0.920x speedup, step: 10, train time 8.42 s
Epoch 29/50 |loss: 0.107485| train set 2.784x speedup, test set 1.399x speedup, val set 1.072x speedup, step: 11, train time 8.24 s
Epoch 30/50 |loss: 0.109408| train set 2.837x speedup, test set 1.149x speedup, val set 0.956x speedup, step: 12, train time 8.39 s
Epoch 31/50 |loss: 0.102157| train set 2.774x speedup, test set 1.202x speedup, val set 1.031x speedup, step: 13, train time 8.52 s
Epoch 32/50 |loss: 0.109355| train set 2.824x speedup, test set 1.180x speedup, val set 0.953x speedup, step: 14, train time 8.74 s
Epoch 33/50 |loss: 0.097472| train set 3.033x speedup, test set 1.202x speedup, val set 1.034x speedup, step: 15, train time 8.44 s
Epoch 34/50 |loss: 0.101385| train set 2.963x speedup, test set 1.404x speedup, val set 0.923x speedup, step: 16, train time 8.60 s
Epoch 35/50 |loss: 0.099877| train set 2.911x speedup, test set 1.031x speedup, val set 1.031x speedup, step: 17, train time 8.32 s
Epoch 36/50 |loss: 0.099318| train set 2.826x speedup, test set 1.145x speedup, val set 0.936x speedup, step: 18, train time 8.69 s
Epoch 37/50 |loss: 0.094654| train set 2.936x speedup, test set 0.966x speedup, val set 1.047x speedup, step: 19, train time 8.72 s
Epoch 38/50 |loss: 0.097860| train set 3.049x speedup, test set 0.983x speedup, val set 0.971x speedup, step: 20, train time 8.82 s
Epoch 39/50 |loss: 0.089173| train set 3.024x speedup, test set 1.433x speedup, val set 1.080x speedup, step: 21, train time 8.62 s
Epoch 40/50 |loss: 0.092054| train set 2.942x speedup, test set 1.495x speedup, val set 1.026x speedup, step: 22, train time 8.82 s
Epoch 41/50 |loss: 0.090458| train set 2.986x speedup, test set 0.966x speedup, val set 0.957x speedup, step: 23, train time 8.41 s
Epoch 42/50 |loss: 0.097416| train set 3.004x speedup, test set 1.539x speedup, val set 0.984x speedup, step: 24, train time 8.41 s
Epoch 43/50 |loss: 0.086279| train set 2.981x speedup, test set 0.980x speedup, val set 1.050x speedup, step: 25, train time 8.71 s
Epoch 44/50 |loss: 0.087841| train set 2.985x speedup, test set 1.022x speedup, val set 0.934x speedup, step: 26, train time 8.71 s
Epoch 45/50 |loss: 0.090769| train set 2.823x speedup, test set 1.006x speedup, val set 0.956x speedup, step: 27, train time 8.82 s
Epoch 46/50 |loss: 0.082148| train set 3.007x speedup, test set 1.028x speedup, val set 1.034x speedup, step: 28, train time 8.79 s
Epoch 47/50 |loss: 0.091410| train set 2.812x speedup, test set 1.009x speedup, val set 0.957x speedup, step: 29, train time 8.31 s
Epoch 48/50 |loss: 0.080104| train set 3.023x speedup, test set 1.020x speedup, val set 0.967x speedup, step: 30, train time 8.23 s
Epoch 49/50 |loss: 0.081916| train set 3.025x speedup, test set 1.006x speedup, val set 1.034x speedup, step: 31, train time 8.42 s
Training per epoch cost 8.574 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
16, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 605.138s, pg runtime 626.529s, speedup 1.035x
32, opt runtime 24.662s, model runtime 615.484s, pg runtime 613.999s, speedup 0.998x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.244s, pg runtime 1.206s, speedup 0.970x
40, opt runtime 1.086s, model runtime 1.160s, pg runtime 1.181s, speedup 1.018x
====================
best train speedup epoch: 38, train speedup 3.049, test speedup 0.983, val speedup 0.971
best test speedup epoch: 3, train speedup 2.397, test speedup 2.886, val speedup 0.997
best validation speedup epoch: 19, train speedup 2.859, test speedup 0.983, val speedup 1.098
last model at epoch 49, train speedup 3.025, test speedup 1.006, val speedup 1.034
execution cost 0:07:42.117442
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.729380, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.413209| train set 1.036x speedup, test set 2.646x speedup, val set 0.983x speedup, step: 1, train time 9.99 s
Epoch 1/50 |loss: 0.337459| train set 1.017x speedup, test set 2.693x speedup, val set 0.983x speedup, step: 2, train time 8.40 s
Epoch 2/50 |loss: 0.307271| train set 2.190x speedup, test set 2.552x speedup, val set 0.987x speedup, step: 3, train time 8.40 s
Epoch 3/50 |loss: 0.284778| train set 2.164x speedup, test set 2.660x speedup, val set 0.811x speedup, step: 4, train time 8.63 s
Epoch 4/50 |loss: 0.268557| train set 2.753x speedup, test set 2.736x speedup, val set 0.939x speedup, step: 1, train time 8.60 s
Epoch 5/50 |loss: 0.248403| train set 2.234x speedup, test set 1.690x speedup, val set 0.983x speedup, step: 2, train time 8.11 s
Epoch 6/50 |loss: 0.235949| train set 2.400x speedup, test set 1.745x speedup, val set 1.133x speedup, step: 3, train time 8.23 s
Epoch 7/50 |loss: 0.226112| train set 2.242x speedup, test set 1.677x speedup, val set 0.923x speedup, step: 4, train time 8.60 s
Epoch 8/50 |loss: 0.210702| train set 2.677x speedup, test set 1.764x speedup, val set 1.026x speedup, step: 5, train time 8.62 s
Epoch 9/50 |loss: 0.202886| train set 2.720x speedup, test set 1.417x speedup, val set 1.048x speedup, step: 1, train time 8.55 s
Epoch 10/50 |loss: 0.201557| train set 2.752x speedup, test set 1.447x speedup, val set 0.950x speedup, step: 2, train time 8.30 s
Epoch 11/50 |loss: 0.187138| train set 2.119x speedup, test set 1.653x speedup, val set 0.925x speedup, step: 3, train time 8.70 s
Epoch 12/50 |loss: 0.184739| train set 2.308x speedup, test set 2.430x speedup, val set 0.923x speedup, step: 4, train time 8.54 s
Epoch 13/50 |loss: 0.182656| train set 2.748x speedup, test set 1.437x speedup, val set 1.231x speedup, step: 5, train time 8.41 s
Epoch 14/50 |loss: 0.171038| train set 2.756x speedup, test set 1.389x speedup, val set 0.959x speedup, step: 6, train time 8.50 s
Epoch 15/50 |loss: 0.167600| train set 2.768x speedup, test set 1.432x speedup, val set 0.984x speedup, step: 7, train time 8.61 s
Epoch 16/50 |loss: 0.158058| train set 2.777x speedup, test set 1.360x speedup, val set 0.971x speedup, step: 8, train time 8.51 s
Epoch 17/50 |loss: 0.153733| train set 2.681x speedup, test set 1.436x speedup, val set 0.959x speedup, step: 9, train time 8.92 s
Epoch 18/50 |loss: 0.147246| train set 2.955x speedup, test set 1.398x speedup, val set 0.923x speedup, step: 10, train time 8.64 s
Epoch 19/50 |loss: 0.146916| train set 2.719x speedup, test set 1.439x speedup, val set 0.917x speedup, step: 11, train time 8.31 s
Epoch 20/50 |loss: 0.141636| train set 2.867x speedup, test set 1.416x speedup, val set 0.923x speedup, step: 12, train time 8.70 s
Epoch 21/50 |loss: 0.131141| train set 2.659x speedup, test set 1.381x speedup, val set 0.959x speedup, step: 13, train time 8.31 s
Epoch 22/50 |loss: 0.130533| train set 2.681x speedup, test set 1.629x speedup, val set 1.026x speedup, step: 14, train time 8.80 s
Epoch 23/50 |loss: 0.122797| train set 2.993x speedup, test set 1.373x speedup, val set 0.984x speedup, step: 15, train time 8.33 s
Epoch 24/50 |loss: 0.123671| train set 2.982x speedup, test set 1.031x speedup, val set 1.112x speedup, step: 1, train time 8.70 s
Epoch 25/50 |loss: 0.124580| train set 2.948x speedup, test set 1.645x speedup, val set 1.111x speedup, step: 2, train time 8.49 s
Epoch 26/50 |loss: 0.126548| train set 2.985x speedup, test set 1.455x speedup, val set 0.987x speedup, step: 3, train time 8.72 s
Epoch 27/50 |loss: 0.116418| train set 2.962x speedup, test set 1.445x speedup, val set 1.026x speedup, step: 4, train time 8.42 s
Epoch 28/50 |loss: 0.107519| train set 2.943x speedup, test set 1.415x speedup, val set 0.984x speedup, step: 5, train time 8.61 s
Epoch 29/50 |loss: 0.112616| train set 2.692x speedup, test set 1.674x speedup, val set 1.021x speedup, step: 6, train time 8.32 s
Epoch 30/50 |loss: 0.109671| train set 2.844x speedup, test set 1.408x speedup, val set 1.021x speedup, step: 7, train time 8.42 s
Epoch 31/50 |loss: 0.105470| train set 2.909x speedup, test set 1.429x speedup, val set 1.111x speedup, step: 8, train time 8.33 s
Epoch 32/50 |loss: 0.112362| train set 2.729x speedup, test set 1.445x speedup, val set 0.980x speedup, step: 9, train time 8.49 s
Epoch 33/50 |loss: 0.097317| train set 3.003x speedup, test set 1.415x speedup, val set 1.112x speedup, step: 10, train time 8.30 s
Epoch 34/50 |loss: 0.104764| train set 2.990x speedup, test set 1.408x speedup, val set 1.111x speedup, step: 11, train time 8.60 s
Epoch 35/50 |loss: 0.105423| train set 2.951x speedup, test set 1.455x speedup, val set 0.984x speedup, step: 12, train time 8.42 s
Epoch 36/50 |loss: 0.096008| train set 2.791x speedup, test set 1.419x speedup, val set 0.987x speedup, step: 13, train time 8.62 s
Epoch 37/50 |loss: 0.099276| train set 2.924x speedup, test set 1.700x speedup, val set 1.111x speedup, step: 14, train time 8.54 s
Epoch 38/50 |loss: 0.099326| train set 2.986x speedup, test set 1.738x speedup, val set 1.031x speedup, step: 15, train time 8.63 s
Epoch 39/50 |loss: 0.086400| train set 3.026x speedup, test set 1.778x speedup, val set 1.115x speedup, step: 1, train time 8.42 s
Epoch 40/50 |loss: 0.092243| train set 2.987x speedup, test set 1.382x speedup, val set 0.984x speedup, step: 2, train time 8.32 s
Epoch 41/50 |loss: 0.089284| train set 3.045x speedup, test set 1.743x speedup, val set 1.034x speedup, step: 3, train time 8.51 s
Epoch 42/50 |loss: 0.094339| train set 3.006x speedup, test set 1.699x speedup, val set 1.111x speedup, step: 4, train time 8.31 s
Epoch 43/50 |loss: 0.087160| train set 2.988x speedup, test set 1.759x speedup, val set 1.112x speedup, step: 5, train time 8.61 s
Epoch 44/50 |loss: 0.088721| train set 2.987x speedup, test set 1.392x speedup, val set 0.984x speedup, step: 6, train time 8.61 s
Epoch 45/50 |loss: 0.091311| train set 2.920x speedup, test set 1.387x speedup, val set 1.029x speedup, step: 7, train time 8.42 s
Epoch 46/50 |loss: 0.089664| train set 2.949x speedup, test set 1.691x speedup, val set 1.111x speedup, step: 8, train time 8.21 s
Epoch 47/50 |loss: 0.092619| train set 2.953x speedup, test set 1.759x speedup, val set 1.115x speedup, step: 9, train time 8.42 s
Epoch 48/50 |loss: 0.081858| train set 2.847x speedup, test set 1.751x speedup, val set 1.026x speedup, step: 10, train time 8.53 s
Epoch 49/50 |loss: 0.082482| train set 3.008x speedup, test set 1.819x speedup, val set 0.984x speedup, step: 11, train time 8.41 s
Training per epoch cost 8.522 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
08, opt runtime 7.377s, model runtime 8.566s, pg runtime 28.655s, speedup 3.345x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 41, train speedup 3.045, test speedup 1.743, val speedup 1.034
best test speedup epoch: 4, train speedup 2.753, test speedup 2.736, val speedup 0.939
best validation speedup epoch: 39, train speedup 3.026, test speedup 1.778, val speedup 1.115
last model at epoch 49, train speedup 3.008, test speedup 1.819, val speedup 0.984
execution cost 0:07:39.422029
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.703480, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414472| train set 1.039x speedup, test set 2.708x speedup, val set 0.985x speedup, step: 1, train time 9.60 s
Epoch 1/50 |loss: 0.338954| train set 1.061x speedup, test set 2.562x speedup, val set 0.971x speedup, step: 2, train time 8.30 s
Epoch 2/50 |loss: 0.305463| train set 2.295x speedup, test set 2.558x speedup, val set 0.987x speedup, step: 3, train time 8.35 s
Epoch 3/50 |loss: 0.283593| train set 2.260x speedup, test set 3.004x speedup, val set 0.810x speedup, step: 4, train time 8.29 s
Epoch 4/50 |loss: 0.261649| train set 2.436x speedup, test set 2.910x speedup, val set 0.723x speedup, step: 1, train time 9.01 s
Epoch 5/50 |loss: 0.243287| train set 2.137x speedup, test set 2.450x speedup, val set 0.983x speedup, step: 2, train time 8.58 s
Epoch 6/50 |loss: 0.234141| train set 2.637x speedup, test set 1.425x speedup, val set 0.857x speedup, step: 3, train time 8.42 s
Epoch 7/50 |loss: 0.223232| train set 2.481x speedup, test set 1.416x speedup, val set 0.922x speedup, step: 4, train time 8.60 s
Epoch 8/50 |loss: 0.203174| train set 2.835x speedup, test set 1.445x speedup, val set 0.912x speedup, step: 5, train time 8.92 s
Epoch 9/50 |loss: 0.201360| train set 2.675x speedup, test set 2.740x speedup, val set 1.132x speedup, step: 1, train time 8.43 s
Epoch 10/50 |loss: 0.198232| train set 2.620x speedup, test set 1.393x speedup, val set 0.693x speedup, step: 2, train time 8.30 s
Epoch 11/50 |loss: 0.182174| train set 2.413x speedup, test set 2.521x speedup, val set 0.931x speedup, step: 3, train time 8.80 s
Epoch 12/50 |loss: 0.179382| train set 2.671x speedup, test set 2.536x speedup, val set 0.957x speedup, step: 4, train time 7.99 s
Epoch 13/50 |loss: 0.177644| train set 2.659x speedup, test set 1.359x speedup, val set 0.971x speedup, step: 5, train time 8.40 s
Epoch 14/50 |loss: 0.176215| train set 2.626x speedup, test set 2.589x speedup, val set 0.957x speedup, step: 6, train time 8.62 s
Epoch 15/50 |loss: 0.157865| train set 2.900x speedup, test set 2.601x speedup, val set 1.044x speedup, step: 7, train time 8.30 s
Epoch 16/50 |loss: 0.154913| train set 2.961x speedup, test set 2.564x speedup, val set 0.860x speedup, step: 8, train time 8.20 s
Epoch 17/50 |loss: 0.153159| train set 2.704x speedup, test set 2.448x speedup, val set 1.076x speedup, step: 9, train time 8.42 s
Epoch 18/50 |loss: 0.146355| train set 2.870x speedup, test set 2.463x speedup, val set 0.959x speedup, step: 10, train time 8.41 s
Epoch 19/50 |loss: 0.146154| train set 2.785x speedup, test set 2.659x speedup, val set 1.026x speedup, step: 11, train time 8.29 s
Epoch 20/50 |loss: 0.143627| train set 2.836x speedup, test set 1.469x speedup, val set 0.957x speedup, step: 12, train time 8.62 s
Epoch 21/50 |loss: 0.132199| train set 2.673x speedup, test set 1.724x speedup, val set 1.026x speedup, step: 13, train time 8.32 s
Epoch 22/50 |loss: 0.135845| train set 2.366x speedup, test set 1.772x speedup, val set 0.956x speedup, step: 14, train time 8.31 s
Epoch 23/50 |loss: 0.128395| train set 2.916x speedup, test set 1.432x speedup, val set 0.956x speedup, step: 15, train time 8.52 s
Epoch 24/50 |loss: 0.126362| train set 2.965x speedup, test set 2.585x speedup, val set 0.957x speedup, step: 16, train time 8.71 s
Epoch 25/50 |loss: 0.126939| train set 2.863x speedup, test set 2.557x speedup, val set 0.956x speedup, step: 17, train time 8.43 s
Epoch 26/50 |loss: 0.133359| train set 2.941x speedup, test set 2.617x speedup, val set 1.111x speedup, step: 18, train time 8.31 s
Epoch 27/50 |loss: 0.121808| train set 2.876x speedup, test set 2.429x speedup, val set 1.165x speedup, step: 19, train time 8.83 s
Epoch 28/50 |loss: 0.111478| train set 2.979x speedup, test set 1.357x speedup, val set 1.111x speedup, step: 20, train time 8.51 s
Epoch 29/50 |loss: 0.113699| train set 2.742x speedup, test set 2.464x speedup, val set 1.029x speedup, step: 21, train time 8.33 s
Epoch 30/50 |loss: 0.116665| train set 2.793x speedup, test set 1.399x speedup, val set 0.953x speedup, step: 22, train time 8.40 s
Epoch 31/50 |loss: 0.110232| train set 2.979x speedup, test set 1.432x speedup, val set 0.956x speedup, step: 23, train time 8.12 s
Epoch 32/50 |loss: 0.108673| train set 2.650x speedup, test set 1.408x speedup, val set 0.811x speedup, step: 24, train time 8.62 s
Epoch 33/50 |loss: 0.103598| train set 3.003x speedup, test set 1.435x speedup, val set 1.165x speedup, step: 25, train time 8.30 s
Epoch 34/50 |loss: 0.107766| train set 2.890x speedup, test set 2.542x speedup, val set 1.026x speedup, step: 26, train time 8.92 s
Epoch 35/50 |loss: 0.104970| train set 2.952x speedup, test set 2.471x speedup, val set 0.956x speedup, step: 27, train time 8.63 s
Epoch 36/50 |loss: 0.095994| train set 2.694x speedup, test set 1.411x speedup, val set 1.165x speedup, step: 28, train time 8.31 s
Epoch 37/50 |loss: 0.100998| train set 2.782x speedup, test set 2.447x speedup, val set 1.187x speedup, step: 29, train time 8.80 s
Epoch 38/50 |loss: 0.101133| train set 2.986x speedup, test set 1.447x speedup, val set 0.957x speedup, step: 30, train time 8.21 s
Epoch 39/50 |loss: 0.090490| train set 2.886x speedup, test set 2.391x speedup, val set 0.957x speedup, step: 31, train time 8.71 s
Epoch 40/50 |loss: 0.096488| train set 3.001x speedup, test set 2.632x speedup, val set 0.956x speedup, step: 32, train time 8.32 s
Epoch 41/50 |loss: 0.095837| train set 2.873x speedup, test set 1.393x speedup, val set 0.957x speedup, step: 33, train time 8.51 s
Epoch 42/50 |loss: 0.097496| train set 3.004x speedup, test set 1.388x speedup, val set 1.076x speedup, step: 34, train time 8.43 s
Epoch 43/50 |loss: 0.087161| train set 2.991x speedup, test set 2.475x speedup, val set 1.076x speedup, step: 35, train time 8.53 s
Epoch 44/50 |loss: 0.098200| train set 2.977x speedup, test set 2.386x speedup, val set 1.111x speedup, step: 36, train time 8.51 s
Epoch 45/50 |loss: 0.092641| train set 2.702x speedup, test set 2.296x speedup, val set 1.165x speedup, step: 37, train time 8.19 s
Epoch 46/50 |loss: 0.090551| train set 2.957x speedup, test set 2.537x speedup, val set 1.165x speedup, step: 38, train time 8.64 s
Epoch 47/50 |loss: 0.093195| train set 2.977x speedup, test set 2.506x speedup, val set 1.165x speedup, step: 39, train time 8.31 s
Epoch 48/50 |loss: 0.082463| train set 2.884x speedup, test set 2.436x speedup, val set 1.159x speedup, step: 40, train time 8.62 s
Epoch 49/50 |loss: 0.084865| train set 2.855x speedup, test set 2.365x speedup, val set 0.957x speedup, step: 41, train time 8.33 s
Training per epoch cost 8.491 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
08, opt runtime 7.377s, model runtime 37.574s, pg runtime 28.655s, speedup 0.763x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 11.791s, pg runtime 5.572s, speedup 0.473x
30, opt runtime 5.539s, model runtime 10.142s, pg runtime 5.539s, speedup 0.546x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 42, train speedup 3.004, test speedup 1.388, val speedup 1.076
best test speedup epoch: 3, train speedup 2.260, test speedup 3.004, val speedup 0.810
best validation speedup epoch: 9, train speedup 2.675, test speedup 2.740, val speedup 1.132
last model at epoch 49, train speedup 2.855, test speedup 2.365, val speedup 0.957
execution cost 0:07:36.997067
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.716095, and there are 11944 training samples
in channel 9
Epoch 0/50 |loss: 0.414851| train set 1.038x speedup, test set 2.529x speedup, val set 0.985x speedup, step: 1, train time 9.37 s
Epoch 1/50 |loss: 0.338482| train set 1.838x speedup, test set 2.470x speedup, val set 0.983x speedup, step: 2, train time 8.01 s
Epoch 2/50 |loss: 0.303829| train set 2.557x speedup, test set 2.461x speedup, val set 0.987x speedup, step: 3, train time 8.22 s
Epoch 3/50 |loss: 0.282851| train set 2.091x speedup, test set 2.636x speedup, val set 0.760x speedup, step: 4, train time 7.91 s
Epoch 4/50 |loss: 0.266040| train set 2.776x speedup, test set 2.651x speedup, val set 0.980x speedup, step: 1, train time 8.90 s
Epoch 5/50 |loss: 0.243575| train set 2.005x speedup, test set 0.997x speedup, val set 0.985x speedup, step: 2, train time 8.23 s
Epoch 6/50 |loss: 0.232457| train set 2.559x speedup, test set 0.973x speedup, val set 0.909x speedup, step: 3, train time 8.71 s
Epoch 7/50 |loss: 0.224178| train set 2.310x speedup, test set 0.975x speedup, val set 0.824x speedup, step: 4, train time 8.61 s
Epoch 8/50 |loss: 0.208615| train set 2.846x speedup, test set 1.114x speedup, val set 0.905x speedup, step: 5, train time 8.10 s
Epoch 9/50 |loss: 0.202476| train set 2.870x speedup, test set 0.984x speedup, val set 1.132x speedup, step: 1, train time 8.42 s
Epoch 10/50 |loss: 0.196918| train set 2.771x speedup, test set 1.448x speedup, val set 0.808x speedup, step: 2, train time 8.23 s
Epoch 11/50 |loss: 0.185545| train set 2.713x speedup, test set 2.653x speedup, val set 1.044x speedup, step: 3, train time 8.49 s
Epoch 12/50 |loss: 0.182355| train set 2.672x speedup, test set 1.407x speedup, val set 0.920x speedup, step: 4, train time 8.61 s
Epoch 13/50 |loss: 0.177183| train set 2.772x speedup, test set 1.402x speedup, val set 0.922x speedup, step: 5, train time 8.11 s
Epoch 14/50 |loss: 0.170446| train set 2.756x speedup, test set 2.502x speedup, val set 0.971x speedup, step: 6, train time 8.40 s
Epoch 15/50 |loss: 0.159198| train set 2.730x speedup, test set 0.981x speedup, val set 0.944x speedup, step: 7, train time 8.31 s
Epoch 16/50 |loss: 0.155838| train set 2.846x speedup, test set 1.469x speedup, val set 0.933x speedup, step: 8, train time 8.70 s
Epoch 17/50 |loss: 0.155137| train set 2.631x speedup, test set 1.383x speedup, val set 1.094x speedup, step: 9, train time 8.34 s
Epoch 18/50 |loss: 0.147758| train set 2.933x speedup, test set 1.447x speedup, val set 0.933x speedup, step: 10, train time 8.90 s
Epoch 19/50 |loss: 0.142287| train set 2.857x speedup, test set 1.403x speedup, val set 0.957x speedup, step: 11, train time 8.71 s
Epoch 20/50 |loss: 0.144706| train set 2.878x speedup, test set 1.360x speedup, val set 0.971x speedup, step: 12, train time 8.42 s
Epoch 21/50 |loss: 0.132043| train set 2.529x speedup, test set 1.383x speedup, val set 1.026x speedup, step: 13, train time 8.31 s
Epoch 22/50 |loss: 0.133554| train set 2.777x speedup, test set 1.375x speedup, val set 0.860x speedup, step: 14, train time 8.30 s
Epoch 23/50 |loss: 0.122966| train set 2.994x speedup, test set 1.626x speedup, val set 0.971x speedup, step: 15, train time 8.52 s
Epoch 24/50 |loss: 0.123835| train set 2.979x speedup, test set 1.375x speedup, val set 0.984x speedup, step: 16, train time 8.21 s
Epoch 25/50 |loss: 0.125740| train set 2.906x speedup, test set 2.621x speedup, val set 1.047x speedup, step: 17, train time 8.22 s
Epoch 26/50 |loss: 0.128634| train set 2.944x speedup, test set 1.427x speedup, val set 0.860x speedup, step: 18, train time 8.42 s
Epoch 27/50 |loss: 0.118443| train set 2.983x speedup, test set 1.416x speedup, val set 1.026x speedup, step: 19, train time 8.32 s
Epoch 28/50 |loss: 0.112119| train set 2.980x speedup, test set 1.425x speedup, val set 1.017x speedup, step: 20, train time 7.93 s
Epoch 29/50 |loss: 0.112706| train set 2.995x speedup, test set 1.414x speedup, val set 0.967x speedup, step: 21, train time 8.48 s
Epoch 30/50 |loss: 0.116133| train set 2.796x speedup, test set 1.422x speedup, val set 1.021x speedup, step: 22, train time 8.61 s
Epoch 31/50 |loss: 0.104321| train set 2.738x speedup, test set 1.424x speedup, val set 1.111x speedup, step: 23, train time 8.31 s
Epoch 32/50 |loss: 0.110372| train set 2.733x speedup, test set 1.369x speedup, val set 0.933x speedup, step: 24, train time 8.90 s
Epoch 33/50 |loss: 0.102012| train set 3.020x speedup, test set 1.466x speedup, val set 1.111x speedup, step: 25, train time 8.51 s
Epoch 34/50 |loss: 0.104233| train set 2.988x speedup, test set 1.410x speedup, val set 0.984x speedup, step: 26, train time 8.41 s
Epoch 35/50 |loss: 0.106012| train set 2.968x speedup, test set 1.424x speedup, val set 1.077x speedup, step: 27, train time 8.20 s
Epoch 36/50 |loss: 0.095037| train set 2.969x speedup, test set 1.424x speedup, val set 0.971x speedup, step: 28, train time 8.43 s
Epoch 37/50 |loss: 0.099101| train set 2.924x speedup, test set 1.437x speedup, val set 1.297x speedup, step: 29, train time 8.43 s
Epoch 38/50 |loss: 0.096474| train set 2.984x speedup, test set 1.416x speedup, val set 0.934x speedup, step: 30, train time 8.42 s
Epoch 39/50 |loss: 0.089173| train set 3.023x speedup, test set 1.424x speedup, val set 1.111x speedup, step: 31, train time 8.21 s
Epoch 40/50 |loss: 0.095269| train set 3.022x speedup, test set 1.416x speedup, val set 1.026x speedup, step: 32, train time 8.42 s
Epoch 41/50 |loss: 0.091435| train set 2.993x speedup, test set 1.387x speedup, val set 1.026x speedup, step: 33, train time 8.01 s
Epoch 42/50 |loss: 0.098332| train set 3.043x speedup, test set 1.429x speedup, val set 1.026x speedup, step: 34, train time 8.40 s
Epoch 43/50 |loss: 0.092532| train set 2.826x speedup, test set 1.429x speedup, val set 0.933x speedup, step: 35, train time 8.29 s
Epoch 44/50 |loss: 0.082901| train set 2.977x speedup, test set 1.416x speedup, val set 1.026x speedup, step: 36, train time 8.43 s
Epoch 45/50 |loss: 0.090175| train set 2.880x speedup, test set 1.416x speedup, val set 1.026x speedup, step: 37, train time 8.51 s
Epoch 46/50 |loss: 0.086484| train set 3.006x speedup, test set 1.437x speedup, val set 1.165x speedup, step: 38, train time 8.40 s
Epoch 47/50 |loss: 0.097272| train set 3.005x speedup, test set 2.658x speedup, val set 1.026x speedup, step: 39, train time 8.31 s
Epoch 48/50 |loss: 0.084520| train set 2.891x speedup, test set 1.416x speedup, val set 0.971x speedup, step: 40, train time 8.50 s
Epoch 49/50 |loss: 0.083330| train set 3.006x speedup, test set 1.427x speedup, val set 0.933x speedup, step: 41, train time 8.19 s
Training per epoch cost 8.406 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
08, opt runtime 7.377s, model runtime 37.574s, pg runtime 28.655s, speedup 0.763x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 48.407s, pg runtime 32.939s, speedup 0.680x
18, opt runtime 6.149s, model runtime 45.581s, pg runtime 30.760s, speedup 0.675x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 605.138s, pg runtime 626.529s, speedup 1.035x
32, opt runtime 24.662s, model runtime 615.484s, pg runtime 613.999s, speedup 0.998x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 12.337s, pg runtime 1.206s, speedup 0.098x
40, opt runtime 1.086s, model runtime 13.122s, pg runtime 1.181s, speedup 0.090x
====================
best train speedup epoch: 42, train speedup 3.043, test speedup 1.429, val speedup 1.026
best test speedup epoch: 47, train speedup 3.005, test speedup 2.658, val speedup 1.026
best validation speedup epoch: 9, train speedup 2.870, test speedup 0.984, val speedup 1.132
last model at epoch 49, train speedup 3.006, test speedup 1.427, val speedup 0.933
execution cost 0:07:32.303613
==================================================
