all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.761376, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.355x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009283| train set 0.835x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008582| train set 0.878x speedup, test set 1.222x speedup, val set 0.937x speedup, step: 3
Epoch 7/300 |loss: 0.007982| train set 0.940x speedup, test set 1.201x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007394| train set 0.919x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007084| train set 0.975x speedup, test set 1.210x speedup, val set 1.351x speedup, step: 1
Epoch 10/300 |loss: 0.007129| train set 0.986x speedup, test set 1.210x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006188| train set 1.227x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005678| train set 0.955x speedup, test set 2.318x speedup, val set 0.926x speedup, step: 2
Epoch 13/300 |loss: 0.005727| train set 1.335x speedup, test set 2.318x speedup, val set 1.522x speedup, step: 1
Epoch 14/300 |loss: 0.005360| train set 1.332x speedup, test set 1.225x speedup, val set 1.374x speedup, step: 2
Epoch 15/300 |loss: 0.005067| train set 1.381x speedup, test set 1.203x speedup, val set 1.386x speedup, step: 3
Epoch 16/300 |loss: 0.004664| train set 1.365x speedup, test set 1.203x speedup, val set 1.371x speedup, step: 4
Epoch 17/300 |loss: 0.004584| train set 1.384x speedup, test set 1.203x speedup, val set 1.354x speedup, step: 5
Epoch 18/300 |loss: 0.004280| train set 2.498x speedup, test set 1.275x speedup, val set 1.523x speedup, step: 1
Epoch 19/300 |loss: 0.004268| train set 1.387x speedup, test set 1.225x speedup, val set 0.937x speedup, step: 2
Epoch 20/300 |loss: 0.004699| train set 2.112x speedup, test set 1.238x speedup, val set 1.457x speedup, step: 3
Epoch 21/300 |loss: 0.003902| train set 2.270x speedup, test set 1.232x speedup, val set 1.374x speedup, step: 4
Epoch 22/300 |loss: 0.003694| train set 2.002x speedup, test set 2.465x speedup, val set 0.928x speedup, step: 5
Epoch 23/300 |loss: 0.004038| train set 2.283x speedup, test set 1.244x speedup, val set 1.533x speedup, step: 1
Epoch 24/300 |loss: 0.004497| train set 2.317x speedup, test set 2.464x speedup, val set 1.523x speedup, step: 2
Epoch 25/300 |loss: 0.003490| train set 2.366x speedup, test set 1.231x speedup, val set 1.523x speedup, step: 3
Epoch 26/300 |loss: 0.003345| train set 2.528x speedup, test set 1.256x speedup, val set 1.549x speedup, step: 1
Epoch 27/300 |loss: 0.003460| train set 2.539x speedup, test set 1.221x speedup, val set 1.354x speedup, step: 2
Epoch 28/300 |loss: 0.003055| train set 2.431x speedup, test set 1.254x speedup, val set 1.470x speedup, step: 3
Epoch 29/300 |loss: 0.003052| train set 2.506x speedup, test set 1.256x speedup, val set 1.511x speedup, step: 4
Epoch 30/300 |loss: 0.003095| train set 2.543x speedup, test set 2.143x speedup, val set 1.387x speedup, step: 5
Epoch 31/300 |loss: 0.003389| train set 2.602x speedup, test set 1.261x speedup, val set 1.549x speedup, step: 1
Epoch 32/300 |loss: 0.002845| train set 2.440x speedup, test set 1.220x speedup, val set 1.549x speedup, step: 1
Epoch 33/300 |loss: 0.003209| train set 2.599x speedup, test set 1.230x speedup, val set 1.264x speedup, step: 2
Epoch 34/300 |loss: 0.002739| train set 2.480x speedup, test set 1.201x speedup, val set 1.549x speedup, step: 1
Epoch 35/300 |loss: 0.002433| train set 2.526x speedup, test set 1.216x speedup, val set 1.267x speedup, step: 2
Epoch 36/300 |loss: 0.003082| train set 2.500x speedup, test set 1.198x speedup, val set 1.549x speedup, step: 3
Epoch 37/300 |loss: 0.002828| train set 2.638x speedup, test set 1.195x speedup, val set 1.277x speedup, step: 4
Epoch 38/300 |loss: 0.002317| train set 2.488x speedup, test set 2.103x speedup, val set 1.249x speedup, step: 5
Epoch 39/300 |loss: 0.002279| train set 2.448x speedup, test set 1.118x speedup, val set 1.262x speedup, step: 6
Epoch 40/300 |loss: 0.002218| train set 2.462x speedup, test set 1.215x speedup, val set 1.267x speedup, step: 7
Epoch 41/300 |loss: 0.002519| train set 2.509x speedup, test set 1.175x speedup, val set 1.394x speedup, step: 8
Epoch 42/300 |loss: 0.002567| train set 2.729x speedup, test set 1.126x speedup, val set 1.277x speedup, step: 9
Epoch 43/300 |loss: 0.002542| train set 2.717x speedup, test set 1.333x speedup, val set 1.276x speedup, step: 10
Epoch 44/300 |loss: 0.002203| train set 2.643x speedup, test set 1.105x speedup, val set 1.259x speedup, step: 11
Epoch 45/300 |loss: 0.002409| train set 2.171x speedup, test set 1.126x speedup, val set 1.427x speedup, step: 12
Epoch 46/300 |loss: 0.002076| train set 2.647x speedup, test set 1.106x speedup, val set 1.259x speedup, step: 13
Epoch 47/300 |loss: 0.001959| train set 2.589x speedup, test set 1.355x speedup, val set 1.277x speedup, step: 14
Epoch 48/300 |loss: 0.002037| train set 2.635x speedup, test set 1.165x speedup, val set 1.526x speedup, step: 15
Epoch 49/300 |loss: 0.002091| train set 2.685x speedup, test set 1.179x speedup, val set 1.526x speedup, step: 16
Epoch 50/300 |loss: 0.001983| train set 2.642x speedup, test set 2.348x speedup, val set 1.526x speedup, step: 17
Epoch 51/300 |loss: 0.001891| train set 2.707x speedup, test set 1.127x speedup, val set 1.528x speedup, step: 18
Epoch 52/300 |loss: 0.001587| train set 2.710x speedup, test set 1.107x speedup, val set 1.277x speedup, step: 19
Epoch 53/300 |loss: 0.001561| train set 2.662x speedup, test set 1.201x speedup, val set 1.413x speedup, step: 20
Epoch 54/300 |loss: 0.001579| train set 2.333x speedup, test set 1.989x speedup, val set 1.369x speedup, step: 21
Epoch 55/300 |loss: 0.001754| train set 2.736x speedup, test set 2.060x speedup, val set 1.358x speedup, step: 22
Epoch 56/300 |loss: 0.001511| train set 2.639x speedup, test set 1.987x speedup, val set 1.513x speedup, step: 23
Epoch 57/300 |loss: 0.001619| train set 2.704x speedup, test set 2.313x speedup, val set 1.934x speedup, step: 1
Epoch 58/300 |loss: 0.002337| train set 2.581x speedup, test set 2.041x speedup, val set 1.513x speedup, step: 2
Epoch 59/300 |loss: 0.001478| train set 2.672x speedup, test set 2.109x speedup, val set 1.527x speedup, step: 3
Epoch 60/300 |loss: 0.001621| train set 2.405x speedup, test set 2.008x speedup, val set 1.287x speedup, step: 4
Epoch 61/300 |loss: 0.001992| train set 2.669x speedup, test set 2.052x speedup, val set 1.278x speedup, step: 5
early stopping at epoch 61
Training per epoch cost 2.224 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 48.776s, pg runtime 23.223s, speedup 0.476x
18, opt runtime 10.788s, model runtime 56.246s, pg runtime 32.939s, speedup 0.586x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 5.961s, model runtime 9.875s, pg runtime 31.210s, speedup 3.161x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.333s, pg runtime 7.268s, speedup 0.991x
28, opt runtime 6.854s, model runtime 7.066s, pg runtime 6.854s, speedup 0.970x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 11.120s, pg runtime 11.120s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 0.912s, model runtime 26.225s, pg runtime 0.912s, speedup 0.035x
40, opt runtime 0.873s, model runtime 23.911s, pg runtime 0.873s, speedup 0.036x
====================
best train speedup epoch: 55, train speedup 2.736, test speedup 2.060, val speedup 1.358
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.704, test speedup 2.313, val speedup 1.934
last model at epoch 61, train speedup 2.669, test speedup 2.052, val speedup 1.278
execution cost 0:03:55.496624
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.836683, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009284| train set 0.831x speedup, test set 1.263x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008581| train set 0.880x speedup, test set 0.860x speedup, val set 0.936x speedup, step: 3
Epoch 7/300 |loss: 0.008029| train set 0.946x speedup, test set 1.214x speedup, val set 0.914x speedup, step: 4
Epoch 8/300 |loss: 0.007385| train set 0.923x speedup, test set 1.216x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007079| train set 0.974x speedup, test set 1.207x speedup, val set 1.351x speedup, step: 1
Epoch 10/300 |loss: 0.007118| train set 0.951x speedup, test set 2.346x speedup, val set 0.934x speedup, step: 2
Epoch 11/300 |loss: 0.006288| train set 1.223x speedup, test set 1.203x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005706| train set 0.962x speedup, test set 2.207x speedup, val set 0.934x speedup, step: 2
Epoch 13/300 |loss: 0.005709| train set 1.334x speedup, test set 2.318x speedup, val set 1.365x speedup, step: 3
Epoch 14/300 |loss: 0.005298| train set 1.251x speedup, test set 1.210x speedup, val set 0.926x speedup, step: 4
Epoch 15/300 |loss: 0.005230| train set 1.391x speedup, test set 1.203x speedup, val set 1.371x speedup, step: 1
Epoch 16/300 |loss: 0.004938| train set 1.342x speedup, test set 1.210x speedup, val set 1.505x speedup, step: 1
Epoch 17/300 |loss: 0.004614| train set 1.388x speedup, test set 1.208x speedup, val set 0.901x speedup, step: 2
Epoch 18/300 |loss: 0.004358| train set 2.465x speedup, test set 1.210x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.004475| train set 1.352x speedup, test set 1.216x speedup, val set 0.926x speedup, step: 2
Epoch 20/300 |loss: 0.004497| train set 2.378x speedup, test set 1.168x speedup, val set 1.352x speedup, step: 3
Epoch 21/300 |loss: 0.003934| train set 1.419x speedup, test set 1.214x speedup, val set 1.457x speedup, step: 4
Epoch 22/300 |loss: 0.003678| train set 2.134x speedup, test set 1.162x speedup, val set 0.934x speedup, step: 5
Epoch 23/300 |loss: 0.004107| train set 2.429x speedup, test set 1.207x speedup, val set 1.533x speedup, step: 6
Epoch 24/300 |loss: 0.004649| train set 2.522x speedup, test set 1.203x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003532| train set 2.522x speedup, test set 1.188x speedup, val set 1.533x speedup, step: 2
Epoch 26/300 |loss: 0.003439| train set 2.472x speedup, test set 1.208x speedup, val set 1.369x speedup, step: 3
Epoch 27/300 |loss: 0.003593| train set 2.682x speedup, test set 1.158x speedup, val set 0.927x speedup, step: 4
Epoch 28/300 |loss: 0.003223| train set 2.531x speedup, test set 2.497x speedup, val set 1.276x speedup, step: 5
Epoch 29/300 |loss: 0.003254| train set 2.472x speedup, test set 1.235x speedup, val set 1.391x speedup, step: 6
Epoch 30/300 |loss: 0.003264| train set 2.603x speedup, test set 2.262x speedup, val set 1.389x speedup, step: 7
Epoch 31/300 |loss: 0.003253| train set 2.645x speedup, test set 1.238x speedup, val set 1.549x speedup, step: 8
Epoch 32/300 |loss: 0.002933| train set 2.547x speedup, test set 1.211x speedup, val set 1.549x speedup, step: 9
Epoch 33/300 |loss: 0.002886| train set 2.566x speedup, test set 2.291x speedup, val set 1.413x speedup, step: 10
Epoch 34/300 |loss: 0.002742| train set 2.622x speedup, test set 1.192x speedup, val set 1.526x speedup, step: 11
Epoch 35/300 |loss: 0.002550| train set 2.610x speedup, test set 2.188x speedup, val set 1.267x speedup, step: 12
Epoch 36/300 |loss: 0.002832| train set 2.688x speedup, test set 2.103x speedup, val set 1.413x speedup, step: 13
Epoch 37/300 |loss: 0.002573| train set 2.608x speedup, test set 1.144x speedup, val set 1.397x speedup, step: 14
Epoch 38/300 |loss: 0.002384| train set 2.702x speedup, test set 2.245x speedup, val set 1.400x speedup, step: 15
Epoch 39/300 |loss: 0.002250| train set 2.664x speedup, test set 2.047x speedup, val set 1.413x speedup, step: 16
Epoch 40/300 |loss: 0.002416| train set 2.545x speedup, test set 2.191x speedup, val set 1.509x speedup, step: 17
Epoch 41/300 |loss: 0.003158| train set 2.565x speedup, test set 1.984x speedup, val set 1.413x speedup, step: 18
Epoch 42/300 |loss: 0.002562| train set 2.715x speedup, test set 2.035x speedup, val set 1.413x speedup, step: 19
Epoch 43/300 |loss: 0.002767| train set 2.607x speedup, test set 1.921x speedup, val set 1.512x speedup, step: 20
Epoch 44/300 |loss: 0.002410| train set 2.563x speedup, test set 1.923x speedup, val set 1.413x speedup, step: 21
Epoch 45/300 |loss: 0.002372| train set 2.505x speedup, test set 2.052x speedup, val set 1.599x speedup, step: 1
Epoch 46/300 |loss: 0.002186| train set 2.602x speedup, test set 2.139x speedup, val set 1.513x speedup, step: 2
Epoch 47/300 |loss: 0.002059| train set 2.589x speedup, test set 2.318x speedup, val set 1.400x speedup, step: 3
Epoch 48/300 |loss: 0.002367| train set 2.675x speedup, test set 2.001x speedup, val set 1.527x speedup, step: 4
Epoch 49/300 |loss: 0.002169| train set 2.638x speedup, test set 2.229x speedup, val set 1.527x speedup, step: 5
Epoch 50/300 |loss: 0.002052| train set 2.643x speedup, test set 2.221x speedup, val set 1.501x speedup, step: 6
Epoch 51/300 |loss: 0.001968| train set 2.675x speedup, test set 2.073x speedup, val set 1.512x speedup, step: 7
Epoch 52/300 |loss: 0.001718| train set 2.709x speedup, test set 1.940x speedup, val set 1.512x speedup, step: 8
Epoch 53/300 |loss: 0.001642| train set 2.732x speedup, test set 1.968x speedup, val set 1.528x speedup, step: 9
Epoch 54/300 |loss: 0.001667| train set 2.664x speedup, test set 1.564x speedup, val set 1.400x speedup, step: 10
Epoch 55/300 |loss: 0.001594| train set 2.696x speedup, test set 2.155x speedup, val set 1.413x speedup, step: 11
Epoch 56/300 |loss: 0.001395| train set 2.612x speedup, test set 1.976x speedup, val set 1.526x speedup, step: 12
Epoch 57/300 |loss: 0.001368| train set 2.638x speedup, test set 2.163x speedup, val set 1.523x speedup, step: 13
Epoch 58/300 |loss: 0.001862| train set 2.635x speedup, test set 2.165x speedup, val set 1.527x speedup, step: 14
Epoch 59/300 |loss: 0.001383| train set 2.603x speedup, test set 1.995x speedup, val set 1.523x speedup, step: 15
Epoch 60/300 |loss: 0.001649| train set 2.632x speedup, test set 2.144x speedup, val set 1.526x speedup, step: 16
Epoch 61/300 |loss: 0.001586| train set 2.663x speedup, test set 2.167x speedup, val set 1.526x speedup, step: 17
Epoch 62/300 |loss: 0.001366| train set 2.679x speedup, test set 1.945x speedup, val set 1.523x speedup, step: 18
Epoch 63/300 |loss: 0.001331| train set 2.677x speedup, test set 1.897x speedup, val set 1.401x speedup, step: 19
Epoch 64/300 |loss: 0.001214| train set 2.650x speedup, test set 1.935x speedup, val set 1.267x speedup, step: 20
Epoch 65/300 |loss: 0.001621| train set 2.349x speedup, test set 2.094x speedup, val set 1.301x speedup, step: 21
Epoch 66/300 |loss: 0.001420| train set 2.639x speedup, test set 2.080x speedup, val set 1.378x speedup, step: 22
early stopping at epoch 66
Training per epoch cost 2.105 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 118.456s, pg runtime 92.131s, speedup 0.778x
04, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
18, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 9.875s, pg runtime 31.210s, speedup 3.161x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.333s, pg runtime 7.268s, speedup 0.991x
28, opt runtime 6.854s, model runtime 7.066s, pg runtime 6.854s, speedup 0.970x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 44.857s, pg runtime 69.421s, speedup 1.548x
34, opt runtime 35.527s, model runtime 42.569s, pg runtime 71.730s, speedup 1.685x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 0.912s, pg runtime 0.912s, speedup 1.000x
40, opt runtime 0.873s, model runtime 0.873s, pg runtime 0.873s, speedup 1.000x
====================
best train speedup epoch: 53, train speedup 2.732, test speedup 1.968, val speedup 1.528
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 45, train speedup 2.505, test speedup 2.052, val speedup 1.599
last model at epoch 66, train speedup 2.639, test speedup 2.080, val speedup 1.378
execution cost 0:03:52.057856
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.165639, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.355x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009283| train set 0.835x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008582| train set 0.878x speedup, test set 1.222x speedup, val set 0.937x speedup, step: 3
Epoch 7/300 |loss: 0.007974| train set 0.957x speedup, test set 1.201x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007392| train set 0.919x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007090| train set 0.988x speedup, test set 1.210x speedup, val set 1.350x speedup, step: 1
Epoch 10/300 |loss: 0.007061| train set 0.987x speedup, test set 1.210x speedup, val set 0.776x speedup, step: 2
Epoch 11/300 |loss: 0.006096| train set 1.243x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005665| train set 0.962x speedup, test set 2.200x speedup, val set 0.926x speedup, step: 2
Epoch 13/300 |loss: 0.005650| train set 1.373x speedup, test set 2.327x speedup, val set 1.365x speedup, step: 3
Epoch 14/300 |loss: 0.005267| train set 1.330x speedup, test set 1.225x speedup, val set 0.901x speedup, step: 4
Epoch 15/300 |loss: 0.005004| train set 1.384x speedup, test set 1.196x speedup, val set 1.386x speedup, step: 1
Epoch 16/300 |loss: 0.004710| train set 1.360x speedup, test set 1.225x speedup, val set 1.351x speedup, step: 2
Epoch 17/300 |loss: 0.004568| train set 1.417x speedup, test set 1.225x speedup, val set 1.533x speedup, step: 1
Epoch 18/300 |loss: 0.004545| train set 2.447x speedup, test set 1.225x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.004876| train set 1.426x speedup, test set 1.225x speedup, val set 1.374x speedup, step: 2
Epoch 20/300 |loss: 0.004033| train set 2.108x speedup, test set 2.352x speedup, val set 0.927x speedup, step: 3
Epoch 21/300 |loss: 0.003821| train set 1.408x speedup, test set 1.278x speedup, val set 1.456x speedup, step: 4
Epoch 22/300 |loss: 0.003697| train set 2.194x speedup, test set 1.220x speedup, val set 0.803x speedup, step: 5
Epoch 23/300 |loss: 0.003920| train set 2.320x speedup, test set 2.487x speedup, val set 1.456x speedup, step: 6
Epoch 24/300 |loss: 0.004316| train set 2.489x speedup, test set 2.410x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003505| train set 2.488x speedup, test set 2.467x speedup, val set 1.456x speedup, step: 2
Epoch 26/300 |loss: 0.003427| train set 2.539x speedup, test set 1.248x speedup, val set 1.526x speedup, step: 3
Epoch 27/300 |loss: 0.003509| train set 2.659x speedup, test set 1.175x speedup, val set 1.355x speedup, step: 4
Epoch 28/300 |loss: 0.003101| train set 2.573x speedup, test set 2.637x speedup, val set 1.390x speedup, step: 5
Epoch 29/300 |loss: 0.003151| train set 2.380x speedup, test set 2.516x speedup, val set 1.533x speedup, step: 6
Epoch 30/300 |loss: 0.002947| train set 2.606x speedup, test set 2.426x speedup, val set 1.523x speedup, step: 7
Epoch 31/300 |loss: 0.003029| train set 2.587x speedup, test set 1.233x speedup, val set 1.549x speedup, step: 1
Epoch 32/300 |loss: 0.002852| train set 2.569x speedup, test set 2.586x speedup, val set 1.549x speedup, step: 1
Epoch 33/300 |loss: 0.002996| train set 2.609x speedup, test set 2.302x speedup, val set 1.277x speedup, step: 2
Epoch 34/300 |loss: 0.002723| train set 2.542x speedup, test set 2.588x speedup, val set 1.549x speedup, step: 1
Epoch 35/300 |loss: 0.002516| train set 2.630x speedup, test set 2.401x speedup, val set 1.267x speedup, step: 2
Epoch 36/300 |loss: 0.003081| train set 2.693x speedup, test set 1.224x speedup, val set 1.549x speedup, step: 1
Epoch 37/300 |loss: 0.002652| train set 2.604x speedup, test set 1.279x speedup, val set 1.413x speedup, step: 2
Epoch 38/300 |loss: 0.002480| train set 2.606x speedup, test set 2.220x speedup, val set 1.264x speedup, step: 3
Epoch 39/300 |loss: 0.002296| train set 2.532x speedup, test set 2.541x speedup, val set 1.277x speedup, step: 4
Epoch 40/300 |loss: 0.002390| train set 2.675x speedup, test set 1.255x speedup, val set 1.409x speedup, step: 5
Epoch 41/300 |loss: 0.002515| train set 2.452x speedup, test set 2.723x speedup, val set 1.262x speedup, step: 6
Epoch 42/300 |loss: 0.002591| train set 2.714x speedup, test set 1.182x speedup, val set 1.340x speedup, step: 7
Epoch 43/300 |loss: 0.002634| train set 2.599x speedup, test set 1.803x speedup, val set 1.277x speedup, step: 8
Epoch 44/300 |loss: 0.002278| train set 2.515x speedup, test set 2.198x speedup, val set 1.259x speedup, step: 9
Epoch 45/300 |loss: 0.002567| train set 2.336x speedup, test set 1.586x speedup, val set 0.924x speedup, step: 10
Epoch 46/300 |loss: 0.002208| train set 2.576x speedup, test set 1.260x speedup, val set 1.357x speedup, step: 11
Epoch 47/300 |loss: 0.002016| train set 2.627x speedup, test set 1.031x speedup, val set 1.267x speedup, step: 12
Epoch 48/300 |loss: 0.002101| train set 2.610x speedup, test set 2.244x speedup, val set 1.527x speedup, step: 13
Epoch 49/300 |loss: 0.002150| train set 2.672x speedup, test set 1.028x speedup, val set 1.401x speedup, step: 14
Epoch 50/300 |loss: 0.001850| train set 2.479x speedup, test set 1.855x speedup, val set 1.277x speedup, step: 15
Epoch 51/300 |loss: 0.001912| train set 2.704x speedup, test set 2.283x speedup, val set 1.259x speedup, step: 16
Epoch 52/300 |loss: 0.001599| train set 2.675x speedup, test set 2.223x speedup, val set 1.933x speedup, step: 1
Epoch 53/300 |loss: 0.001547| train set 2.710x speedup, test set 1.809x speedup, val set 1.401x speedup, step: 2
Epoch 54/300 |loss: 0.001540| train set 2.569x speedup, test set 1.074x speedup, val set 1.277x speedup, step: 3
Epoch 55/300 |loss: 0.001895| train set 2.721x speedup, test set 0.961x speedup, val set 1.413x speedup, step: 4
Epoch 56/300 |loss: 0.001627| train set 2.651x speedup, test set 1.580x speedup, val set 1.526x speedup, step: 5
Epoch 57/300 |loss: 0.001512| train set 2.676x speedup, test set 1.695x speedup, val set 2.253x speedup, step: 1
Epoch 58/300 |loss: 0.002011| train set 2.616x speedup, test set 1.568x speedup, val set 2.262x speedup, step: 1
Epoch 59/300 |loss: 0.001571| train set 2.652x speedup, test set 2.212x speedup, val set 2.253x speedup, step: 2
Epoch 60/300 |loss: 0.001708| train set 2.550x speedup, test set 1.542x speedup, val set 1.277x speedup, step: 3
Epoch 61/300 |loss: 0.001767| train set 2.678x speedup, test set 1.106x speedup, val set 1.349x speedup, step: 4
early stopping at epoch 61
Training per epoch cost 2.231 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 118.456s, pg runtime 92.131s, speedup 0.778x
04, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
18, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
28, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 312.290s, pg runtime 608.707s, speedup 1.949x
32, opt runtime 24.706s, model runtime 314.812s, pg runtime 610.808s, speedup 1.940x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 26.225s, pg runtime 0.912s, speedup 0.035x
40, opt runtime 0.873s, model runtime 23.911s, pg runtime 0.873s, speedup 0.036x
====================
best train speedup epoch: 55, train speedup 2.721, test speedup 0.961, val speedup 1.413
best test speedup epoch: 41, train speedup 2.452, test speedup 2.723, val speedup 1.262
best validation speedup epoch: 58, train speedup 2.616, test speedup 1.568, val speedup 2.262
last model at epoch 61, train speedup 2.678, test speedup 1.106, val speedup 1.349
execution cost 0:03:56.916981
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.240496, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.355x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009283| train set 0.835x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008582| train set 0.878x speedup, test set 1.222x speedup, val set 0.937x speedup, step: 3
Epoch 7/300 |loss: 0.007974| train set 0.957x speedup, test set 1.201x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007392| train set 0.919x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007090| train set 0.988x speedup, test set 1.210x speedup, val set 1.350x speedup, step: 1
Epoch 10/300 |loss: 0.007072| train set 0.986x speedup, test set 1.210x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006121| train set 1.247x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005605| train set 0.818x speedup, test set 2.318x speedup, val set 0.926x speedup, step: 2
Epoch 13/300 |loss: 0.005734| train set 1.342x speedup, test set 2.327x speedup, val set 1.365x speedup, step: 3
Epoch 14/300 |loss: 0.005255| train set 1.337x speedup, test set 1.203x speedup, val set 0.901x speedup, step: 4
Epoch 15/300 |loss: 0.005011| train set 1.492x speedup, test set 1.203x speedup, val set 1.371x speedup, step: 1
Epoch 16/300 |loss: 0.004631| train set 1.368x speedup, test set 1.225x speedup, val set 1.505x speedup, step: 1
Epoch 17/300 |loss: 0.004479| train set 1.374x speedup, test set 1.203x speedup, val set 0.901x speedup, step: 2
Epoch 18/300 |loss: 0.004592| train set 2.534x speedup, test set 1.225x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.005047| train set 1.369x speedup, test set 1.223x speedup, val set 1.452x speedup, step: 2
Epoch 20/300 |loss: 0.004143| train set 2.295x speedup, test set 2.240x speedup, val set 0.925x speedup, step: 3
Epoch 21/300 |loss: 0.003763| train set 2.298x speedup, test set 1.251x speedup, val set 1.435x speedup, step: 4
Epoch 22/300 |loss: 0.003683| train set 2.476x speedup, test set 1.201x speedup, val set 1.431x speedup, step: 5
Epoch 23/300 |loss: 0.003722| train set 2.431x speedup, test set 1.244x speedup, val set 1.349x speedup, step: 6
Epoch 24/300 |loss: 0.004303| train set 2.483x speedup, test set 2.401x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003424| train set 2.599x speedup, test set 2.369x speedup, val set 1.366x speedup, step: 2
Epoch 26/300 |loss: 0.003269| train set 2.546x speedup, test set 2.427x speedup, val set 1.376x speedup, step: 3
Epoch 27/300 |loss: 0.003700| train set 2.691x speedup, test set 2.305x speedup, val set 1.249x speedup, step: 4
Epoch 28/300 |loss: 0.003096| train set 2.557x speedup, test set 2.375x speedup, val set 0.876x speedup, step: 5
Epoch 29/300 |loss: 0.003221| train set 2.632x speedup, test set 2.477x speedup, val set 1.508x speedup, step: 6
Epoch 30/300 |loss: 0.003015| train set 2.625x speedup, test set 2.269x speedup, val set 1.349x speedup, step: 7
Epoch 31/300 |loss: 0.003060| train set 2.569x speedup, test set 2.618x speedup, val set 1.523x speedup, step: 8
Epoch 32/300 |loss: 0.002809| train set 2.516x speedup, test set 2.476x speedup, val set 1.526x speedup, step: 9
Epoch 33/300 |loss: 0.002914| train set 2.436x speedup, test set 2.303x speedup, val set 1.267x speedup, step: 10
Epoch 34/300 |loss: 0.002692| train set 2.648x speedup, test set 2.227x speedup, val set 1.394x speedup, step: 11
Epoch 35/300 |loss: 0.002583| train set 2.640x speedup, test set 2.522x speedup, val set 1.267x speedup, step: 12
Epoch 36/300 |loss: 0.002783| train set 2.530x speedup, test set 2.361x speedup, val set 1.394x speedup, step: 13
Epoch 37/300 |loss: 0.002518| train set 2.674x speedup, test set 2.619x speedup, val set 1.277x speedup, step: 14
Epoch 38/300 |loss: 0.002330| train set 2.665x speedup, test set 2.310x speedup, val set 1.266x speedup, step: 15
Epoch 39/300 |loss: 0.002145| train set 2.678x speedup, test set 2.304x speedup, val set 1.413x speedup, step: 16
Epoch 40/300 |loss: 0.002300| train set 2.701x speedup, test set 2.277x speedup, val set 1.274x speedup, step: 17
Epoch 41/300 |loss: 0.002857| train set 2.536x speedup, test set 2.294x speedup, val set 1.277x speedup, step: 18
Epoch 42/300 |loss: 0.002533| train set 2.684x speedup, test set 2.242x speedup, val set 1.277x speedup, step: 19
Epoch 43/300 |loss: 0.002346| train set 2.710x speedup, test set 2.284x speedup, val set 1.400x speedup, step: 20
Epoch 44/300 |loss: 0.002204| train set 2.550x speedup, test set 2.182x speedup, val set 1.373x speedup, step: 21
Epoch 45/300 |loss: 0.002570| train set 2.627x speedup, test set 2.178x speedup, val set 1.326x speedup, step: 22
Epoch 46/300 |loss: 0.001985| train set 2.577x speedup, test set 2.054x speedup, val set 1.391x speedup, step: 23
Epoch 47/300 |loss: 0.002026| train set 2.627x speedup, test set 2.375x speedup, val set 1.391x speedup, step: 24
Epoch 48/300 |loss: 0.002056| train set 2.646x speedup, test set 2.310x speedup, val set 1.392x speedup, step: 25
Epoch 49/300 |loss: 0.002050| train set 2.683x speedup, test set 2.049x speedup, val set 1.413x speedup, step: 26
Epoch 50/300 |loss: 0.001808| train set 2.661x speedup, test set 2.181x speedup, val set 1.392x speedup, step: 27
Epoch 51/300 |loss: 0.001800| train set 2.650x speedup, test set 1.568x speedup, val set 1.391x speedup, step: 28
Epoch 52/300 |loss: 0.001552| train set 2.656x speedup, test set 2.074x speedup, val set 1.400x speedup, step: 29
Epoch 53/300 |loss: 0.001485| train set 2.690x speedup, test set 1.569x speedup, val set 1.413x speedup, step: 30
Epoch 54/300 |loss: 0.001729| train set 2.637x speedup, test set 1.504x speedup, val set 1.392x speedup, step: 31
Epoch 55/300 |loss: 0.001748| train set 2.573x speedup, test set 2.183x speedup, val set 1.413x speedup, step: 32
Epoch 56/300 |loss: 0.001530| train set 2.646x speedup, test set 2.074x speedup, val set 1.410x speedup, step: 33
Epoch 57/300 |loss: 0.001613| train set 2.669x speedup, test set 2.002x speedup, val set 2.013x speedup, step: 1
Epoch 58/300 |loss: 0.002214| train set 2.573x speedup, test set 2.046x speedup, val set 1.413x speedup, step: 2
Epoch 59/300 |loss: 0.001460| train set 2.626x speedup, test set 1.976x speedup, val set 1.410x speedup, step: 3
Epoch 60/300 |loss: 0.001757| train set 2.611x speedup, test set 1.971x speedup, val set 1.287x speedup, step: 4
Epoch 61/300 |loss: 0.001903| train set 2.646x speedup, test set 1.453x speedup, val set 1.220x speedup, step: 5
early stopping at epoch 61
Training per epoch cost 2.229 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 48.776s, pg runtime 23.223s, speedup 0.476x
18, opt runtime 10.788s, model runtime 56.246s, pg runtime 32.939s, speedup 0.586x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
28, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 23.980s, pg runtime 0.912s, speedup 0.038x
40, opt runtime 0.873s, model runtime 25.328s, pg runtime 0.873s, speedup 0.034x
====================
best train speedup epoch: 43, train speedup 2.710, test speedup 2.284, val speedup 1.400
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.669, test speedup 2.002, val speedup 2.013
last model at epoch 61, train speedup 2.646, test speedup 1.453, val speedup 1.220
execution cost 0:03:55.396380
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.276895, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009290| train set 0.831x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008610| train set 0.880x speedup, test set 0.860x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008035| train set 0.952x speedup, test set 1.216x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007386| train set 0.900x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007035| train set 0.972x speedup, test set 1.210x speedup, val set 1.454x speedup, step: 1
Epoch 10/300 |loss: 0.007160| train set 0.987x speedup, test set 2.346x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006287| train set 1.244x speedup, test set 1.216x speedup, val set 1.371x speedup, step: 3
Epoch 12/300 |loss: 0.005662| train set 0.992x speedup, test set 2.207x speedup, val set 0.925x speedup, step: 4
Epoch 13/300 |loss: 0.005660| train set 1.333x speedup, test set 1.203x speedup, val set 1.522x speedup, step: 1
Epoch 14/300 |loss: 0.005281| train set 1.325x speedup, test set 1.225x speedup, val set 0.907x speedup, step: 2
Epoch 15/300 |loss: 0.005192| train set 1.379x speedup, test set 1.210x speedup, val set 1.549x speedup, step: 1
Epoch 16/300 |loss: 0.004816| train set 1.338x speedup, test set 1.203x speedup, val set 1.505x speedup, step: 2
Epoch 17/300 |loss: 0.004584| train set 1.384x speedup, test set 1.203x speedup, val set 0.893x speedup, step: 3
Epoch 18/300 |loss: 0.004320| train set 2.497x speedup, test set 1.259x speedup, val set 1.522x speedup, step: 4
Epoch 19/300 |loss: 0.004283| train set 1.283x speedup, test set 2.338x speedup, val set 0.937x speedup, step: 5
Epoch 20/300 |loss: 0.004803| train set 2.139x speedup, test set 2.432x speedup, val set 1.549x speedup, step: 1
Epoch 21/300 |loss: 0.003815| train set 1.370x speedup, test set 2.529x speedup, val set 1.436x speedup, step: 2
Epoch 22/300 |loss: 0.003653| train set 1.748x speedup, test set 2.267x speedup, val set 0.803x speedup, step: 3
Epoch 23/300 |loss: 0.004110| train set 2.427x speedup, test set 2.312x speedup, val set 1.483x speedup, step: 4
Epoch 24/300 |loss: 0.004382| train set 2.359x speedup, test set 2.365x speedup, val set 1.523x speedup, step: 5
Epoch 25/300 |loss: 0.003449| train set 2.474x speedup, test set 2.391x speedup, val set 1.433x speedup, step: 6
Epoch 26/300 |loss: 0.003437| train set 2.519x speedup, test set 1.187x speedup, val set 1.533x speedup, step: 7
Epoch 27/300 |loss: 0.003441| train set 2.591x speedup, test set 1.187x speedup, val set 1.432x speedup, step: 8
Epoch 28/300 |loss: 0.003003| train set 2.584x speedup, test set 2.623x speedup, val set 1.316x speedup, step: 9
Epoch 29/300 |loss: 0.003103| train set 2.382x speedup, test set 2.446x speedup, val set 1.511x speedup, step: 10
Epoch 30/300 |loss: 0.002888| train set 2.514x speedup, test set 2.564x speedup, val set 1.534x speedup, step: 11
Epoch 31/300 |loss: 0.002940| train set 2.594x speedup, test set 1.229x speedup, val set 1.511x speedup, step: 12
Epoch 32/300 |loss: 0.002979| train set 2.458x speedup, test set 2.416x speedup, val set 1.498x speedup, step: 13
Epoch 33/300 |loss: 0.002802| train set 2.456x speedup, test set 2.510x speedup, val set 1.354x speedup, step: 14
Epoch 34/300 |loss: 0.002731| train set 2.656x speedup, test set 2.613x speedup, val set 1.537x speedup, step: 15
Epoch 35/300 |loss: 0.002455| train set 2.587x speedup, test set 2.286x speedup, val set 1.706x speedup, step: 1
Epoch 36/300 |loss: 0.003079| train set 2.618x speedup, test set 2.518x speedup, val set 1.376x speedup, step: 2
Epoch 37/300 |loss: 0.002609| train set 2.582x speedup, test set 2.629x speedup, val set 1.995x speedup, step: 1
Epoch 38/300 |loss: 0.002275| train set 2.620x speedup, test set 2.527x speedup, val set 1.400x speedup, step: 2
Epoch 39/300 |loss: 0.002165| train set 2.473x speedup, test set 2.560x speedup, val set 1.995x speedup, step: 1
Epoch 40/300 |loss: 0.002317| train set 2.585x speedup, test set 1.219x speedup, val set 1.490x speedup, step: 2
Epoch 41/300 |loss: 0.002767| train set 2.473x speedup, test set 2.547x speedup, val set 2.021x speedup, step: 1
Epoch 42/300 |loss: 0.002458| train set 2.664x speedup, test set 2.408x speedup, val set 1.734x speedup, step: 2
Epoch 43/300 |loss: 0.002552| train set 2.624x speedup, test set 2.418x speedup, val set 1.995x speedup, step: 3
Epoch 44/300 |loss: 0.002276| train set 2.549x speedup, test set 2.101x speedup, val set 2.154x speedup, step: 1
Epoch 45/300 |loss: 0.002823| train set 2.547x speedup, test set 2.345x speedup, val set 1.266x speedup, step: 2
Epoch 46/300 |loss: 0.001919| train set 2.706x speedup, test set 2.388x speedup, val set 1.705x speedup, step: 3
Epoch 47/300 |loss: 0.001799| train set 2.596x speedup, test set 2.331x speedup, val set 1.341x speedup, step: 4
Epoch 48/300 |loss: 0.002204| train set 2.640x speedup, test set 2.067x speedup, val set 1.508x speedup, step: 5
Epoch 49/300 |loss: 0.001948| train set 2.606x speedup, test set 1.181x speedup, val set 1.705x speedup, step: 6
Epoch 50/300 |loss: 0.001779| train set 2.472x speedup, test set 2.382x speedup, val set 1.734x speedup, step: 7
Epoch 51/300 |loss: 0.001786| train set 2.686x speedup, test set 2.410x speedup, val set 1.951x speedup, step: 8
Epoch 52/300 |loss: 0.001466| train set 2.658x speedup, test set 2.139x speedup, val set 1.730x speedup, step: 9
Epoch 53/300 |loss: 0.001550| train set 2.651x speedup, test set 2.075x speedup, val set 2.022x speedup, step: 10
Epoch 54/300 |loss: 0.001399| train set 2.417x speedup, test set 2.303x speedup, val set 1.237x speedup, step: 11
Epoch 55/300 |loss: 0.001461| train set 2.512x speedup, test set 2.110x speedup, val set 1.755x speedup, step: 12
Epoch 56/300 |loss: 0.001335| train set 2.625x speedup, test set 2.105x speedup, val set 1.267x speedup, step: 13
Epoch 57/300 |loss: 0.001297| train set 2.710x speedup, test set 2.320x speedup, val set 2.015x speedup, step: 14
Epoch 58/300 |loss: 0.001989| train set 2.646x speedup, test set 2.322x speedup, val set 2.022x speedup, step: 15
Epoch 59/300 |loss: 0.001491| train set 2.650x speedup, test set 2.167x speedup, val set 2.177x speedup, step: 1
Epoch 60/300 |loss: 0.001678| train set 2.593x speedup, test set 2.058x speedup, val set 1.734x speedup, step: 2
Epoch 61/300 |loss: 0.001742| train set 2.693x speedup, test set 2.391x speedup, val set 1.667x speedup, step: 3
early stopping at epoch 61
Training per epoch cost 2.111 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
12, opt runtime 25.043s, model runtime 60.927s, pg runtime 73.019s, speedup 1.198x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 129.074s, pg runtime 87.329s, speedup 0.677x
16, opt runtime 48.784s, model runtime 124.142s, pg runtime 78.349s, speedup 0.631x
17, opt runtime 7.469s, model runtime 41.483s, pg runtime 23.223s, speedup 0.560x
18, opt runtime 10.788s, model runtime 60.401s, pg runtime 32.939s, speedup 0.545x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 44.857s, pg runtime 69.421s, speedup 1.548x
34, opt runtime 35.527s, model runtime 42.569s, pg runtime 71.730s, speedup 1.685x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 57, train speedup 2.710, test speedup 2.320, val speedup 2.015
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 59, train speedup 2.650, test speedup 2.167, val speedup 2.177
last model at epoch 61, train speedup 2.693, test speedup 2.391, val speedup 1.667
execution cost 0:03:38.178511
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.269320, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.355x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009283| train set 0.835x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008582| train set 0.878x speedup, test set 1.222x speedup, val set 0.937x speedup, step: 3
Epoch 7/300 |loss: 0.007974| train set 0.957x speedup, test set 1.201x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007392| train set 0.919x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007090| train set 0.988x speedup, test set 1.210x speedup, val set 1.350x speedup, step: 1
Epoch 10/300 |loss: 0.007072| train set 0.986x speedup, test set 1.210x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006121| train set 1.233x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005600| train set 0.994x speedup, test set 2.318x speedup, val set 0.925x speedup, step: 2
Epoch 13/300 |loss: 0.005739| train set 1.326x speedup, test set 1.205x speedup, val set 1.365x speedup, step: 3
Epoch 14/300 |loss: 0.005248| train set 1.330x speedup, test set 1.225x speedup, val set 1.374x speedup, step: 1
Epoch 15/300 |loss: 0.005035| train set 1.390x speedup, test set 1.203x speedup, val set 1.386x speedup, step: 1
Epoch 16/300 |loss: 0.004692| train set 1.359x speedup, test set 1.225x speedup, val set 1.371x speedup, step: 2
Epoch 17/300 |loss: 0.004513| train set 1.388x speedup, test set 1.203x speedup, val set 0.901x speedup, step: 3
Epoch 18/300 |loss: 0.004359| train set 2.583x speedup, test set 1.251x speedup, val set 1.522x speedup, step: 1
Epoch 19/300 |loss: 0.004436| train set 1.214x speedup, test set 2.401x speedup, val set 0.937x speedup, step: 2
Epoch 20/300 |loss: 0.005059| train set 2.500x speedup, test set 2.401x speedup, val set 1.550x speedup, step: 1
Epoch 21/300 |loss: 0.003722| train set 1.403x speedup, test set 1.221x speedup, val set 1.456x speedup, step: 2
Epoch 22/300 |loss: 0.003634| train set 1.313x speedup, test set 2.215x speedup, val set 0.927x speedup, step: 3
Epoch 23/300 |loss: 0.004027| train set 2.406x speedup, test set 2.284x speedup, val set 1.535x speedup, step: 4
Epoch 24/300 |loss: 0.004048| train set 2.551x speedup, test set 2.292x speedup, val set 1.549x speedup, step: 5
Epoch 25/300 |loss: 0.003422| train set 2.332x speedup, test set 2.198x speedup, val set 1.408x speedup, step: 6
Epoch 26/300 |loss: 0.003515| train set 2.481x speedup, test set 2.364x speedup, val set 1.526x speedup, step: 7
Epoch 27/300 |loss: 0.003506| train set 2.625x speedup, test set 1.223x speedup, val set 1.511x speedup, step: 8
Epoch 28/300 |loss: 0.003102| train set 2.504x speedup, test set 2.558x speedup, val set 1.330x speedup, step: 9
Epoch 29/300 |loss: 0.003058| train set 2.602x speedup, test set 2.325x speedup, val set 1.508x speedup, step: 10
Epoch 30/300 |loss: 0.002982| train set 2.488x speedup, test set 2.180x speedup, val set 1.259x speedup, step: 11
Epoch 31/300 |loss: 0.002966| train set 2.475x speedup, test set 1.209x speedup, val set 1.524x speedup, step: 12
Epoch 32/300 |loss: 0.003028| train set 2.450x speedup, test set 2.338x speedup, val set 1.526x speedup, step: 13
Epoch 33/300 |loss: 0.002965| train set 2.522x speedup, test set 2.256x speedup, val set 1.327x speedup, step: 14
Epoch 34/300 |loss: 0.002730| train set 2.618x speedup, test set 2.239x speedup, val set 1.409x speedup, step: 15
Epoch 35/300 |loss: 0.002549| train set 2.493x speedup, test set 2.191x speedup, val set 1.277x speedup, step: 16
Epoch 36/300 |loss: 0.003096| train set 2.618x speedup, test set 1.253x speedup, val set 1.274x speedup, step: 17
Epoch 37/300 |loss: 0.002613| train set 2.603x speedup, test set 2.301x speedup, val set 1.277x speedup, step: 18
Epoch 38/300 |loss: 0.002453| train set 2.635x speedup, test set 2.209x speedup, val set 1.249x speedup, step: 19
Epoch 39/300 |loss: 0.002335| train set 2.581x speedup, test set 2.216x speedup, val set 1.262x speedup, step: 20
Epoch 40/300 |loss: 0.002466| train set 2.664x speedup, test set 1.198x speedup, val set 1.373x speedup, step: 21
Epoch 41/300 |loss: 0.002497| train set 2.494x speedup, test set 2.244x speedup, val set 1.262x speedup, step: 22
Epoch 42/300 |loss: 0.002519| train set 2.667x speedup, test set 2.385x speedup, val set 1.244x speedup, step: 23
Epoch 43/300 |loss: 0.002563| train set 2.678x speedup, test set 2.267x speedup, val set 1.262x speedup, step: 24
Epoch 44/300 |loss: 0.002238| train set 2.582x speedup, test set 2.268x speedup, val set 1.230x speedup, step: 25
Epoch 45/300 |loss: 0.002692| train set 2.483x speedup, test set 2.190x speedup, val set 1.428x speedup, step: 26
Epoch 46/300 |loss: 0.002110| train set 2.568x speedup, test set 1.168x speedup, val set 1.400x speedup, step: 27
Epoch 47/300 |loss: 0.001964| train set 2.665x speedup, test set 1.162x speedup, val set 1.259x speedup, step: 28
Epoch 48/300 |loss: 0.002000| train set 2.582x speedup, test set 1.219x speedup, val set 1.527x speedup, step: 29
Epoch 49/300 |loss: 0.002386| train set 2.658x speedup, test set 1.201x speedup, val set 1.277x speedup, step: 30
Epoch 50/300 |loss: 0.001893| train set 2.634x speedup, test set 2.294x speedup, val set 1.277x speedup, step: 31
Epoch 51/300 |loss: 0.001939| train set 2.665x speedup, test set 2.120x speedup, val set 1.259x speedup, step: 32
Epoch 52/300 |loss: 0.001647| train set 2.681x speedup, test set 1.124x speedup, val set 1.748x speedup, step: 1
Epoch 53/300 |loss: 0.001516| train set 2.640x speedup, test set 2.443x speedup, val set 1.376x speedup, step: 2
Epoch 54/300 |loss: 0.001565| train set 2.650x speedup, test set 1.221x speedup, val set 1.226x speedup, step: 3
Epoch 55/300 |loss: 0.001757| train set 2.688x speedup, test set 1.178x speedup, val set 1.413x speedup, step: 4
Epoch 56/300 |loss: 0.001510| train set 2.643x speedup, test set 2.366x speedup, val set 1.527x speedup, step: 5
Epoch 57/300 |loss: 0.001630| train set 2.675x speedup, test set 1.178x speedup, val set 2.254x speedup, step: 1
Epoch 58/300 |loss: 0.002116| train set 2.648x speedup, test set 1.177x speedup, val set 1.484x speedup, step: 2
Epoch 59/300 |loss: 0.001580| train set 2.661x speedup, test set 1.157x speedup, val set 2.022x speedup, step: 3
Epoch 60/300 |loss: 0.001620| train set 2.604x speedup, test set 2.347x speedup, val set 1.946x speedup, step: 4
Epoch 61/300 |loss: 0.001797| train set 2.667x speedup, test set 2.235x speedup, val set 1.208x speedup, step: 5
Epoch 62/300 |loss: 0.001451| train set 2.749x speedup, test set 2.351x speedup, val set 1.208x speedup, step: 6
Epoch 63/300 |loss: 0.001279| train set 2.697x speedup, test set 2.275x speedup, val set 1.632x speedup, step: 7
Epoch 64/300 |loss: 0.001248| train set 2.592x speedup, test set 2.349x speedup, val set 1.679x speedup, step: 8
Epoch 65/300 |loss: 0.001546| train set 2.583x speedup, test set 2.235x speedup, val set 1.312x speedup, step: 9
Epoch 66/300 |loss: 0.001458| train set 2.640x speedup, test set 2.347x speedup, val set 1.220x speedup, step: 10
Epoch 67/300 |loss: 0.001473| train set 2.662x speedup, test set 1.098x speedup, val set 1.256x speedup, step: 11
Epoch 68/300 |loss: 0.001344| train set 2.777x speedup, test set 2.391x speedup, val set 1.401x speedup, step: 12
Epoch 69/300 |loss: 0.001227| train set 2.671x speedup, test set 2.236x speedup, val set 1.237x speedup, step: 13
Epoch 70/300 |loss: 0.001418| train set 2.645x speedup, test set 2.097x speedup, val set 1.267x speedup, step: 14
Epoch 71/300 |loss: 0.001234| train set 2.654x speedup, test set 2.169x speedup, val set 1.401x speedup, step: 15
Epoch 72/300 |loss: 0.001034| train set 2.640x speedup, test set 2.224x speedup, val set 1.320x speedup, step: 16
Epoch 73/300 |loss: 0.001648| train set 2.616x speedup, test set 2.385x speedup, val set 1.291x speedup, step: 17
Epoch 74/300 |loss: 0.001193| train set 2.644x speedup, test set 2.160x speedup, val set 1.275x speedup, step: 18
Epoch 75/300 |loss: 0.001022| train set 2.711x speedup, test set 2.193x speedup, val set 1.805x speedup, step: 19
Epoch 76/300 |loss: 0.000816| train set 2.695x speedup, test set 2.354x speedup, val set 1.674x speedup, step: 20
Epoch 77/300 |loss: 0.000859| train set 2.702x speedup, test set 2.275x speedup, val set 1.990x speedup, step: 21
Epoch 78/300 |loss: 0.000923| train set 2.636x speedup, test set 2.250x speedup, val set 1.815x speedup, step: 22
Epoch 79/300 |loss: 0.000813| train set 2.696x speedup, test set 2.354x speedup, val set 2.015x speedup, step: 23
Epoch 80/300 |loss: 0.000831| train set 2.724x speedup, test set 1.308x speedup, val set 1.805x speedup, step: 24
Epoch 81/300 |loss: 0.001132| train set 2.680x speedup, test set 2.289x speedup, val set 1.020x speedup, step: 25
Epoch 82/300 |loss: 0.001029| train set 2.722x speedup, test set 2.419x speedup, val set 1.836x speedup, step: 26
Epoch 83/300 |loss: 0.000818| train set 2.751x speedup, test set 2.230x speedup, val set 1.656x speedup, step: 27
Epoch 84/300 |loss: 0.001121| train set 2.590x speedup, test set 2.215x speedup, val set 0.983x speedup, step: 28
Epoch 85/300 |loss: 0.000906| train set 2.697x speedup, test set 2.230x speedup, val set 1.661x speedup, step: 29
early stopping at epoch 85
Training per epoch cost 2.216 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 12.479s, pg runtime 16.134s, speedup 1.293x
08, opt runtime 6.284s, model runtime 13.017s, pg runtime 31.019s, speedup 2.383x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
18, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
28, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 786.481s, pg runtime 651.942s, speedup 0.829x
36, opt runtime 16.639s, model runtime 700.825s, pg runtime 462.544s, speedup 0.660x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 0.912s, pg runtime 0.912s, speedup 1.000x
40, opt runtime 0.873s, model runtime 0.873s, pg runtime 0.873s, speedup 1.000x
====================
best train speedup epoch: 68, train speedup 2.777, test speedup 2.391, val speedup 1.401
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.675, test speedup 1.178, val speedup 2.254
last model at epoch 85, train speedup 2.697, test speedup 2.230, val speedup 1.661
execution cost 0:05:22.184312
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.205874, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.355x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009283| train set 0.835x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008582| train set 0.878x speedup, test set 1.222x speedup, val set 0.937x speedup, step: 3
Epoch 7/300 |loss: 0.007974| train set 0.957x speedup, test set 1.201x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007392| train set 0.919x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007090| train set 0.988x speedup, test set 1.210x speedup, val set 1.350x speedup, step: 1
Epoch 10/300 |loss: 0.007061| train set 0.987x speedup, test set 1.210x speedup, val set 0.776x speedup, step: 2
Epoch 11/300 |loss: 0.006096| train set 1.248x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005672| train set 0.996x speedup, test set 2.200x speedup, val set 0.926x speedup, step: 2
Epoch 13/300 |loss: 0.005636| train set 1.386x speedup, test set 1.203x speedup, val set 1.365x speedup, step: 3
Epoch 14/300 |loss: 0.005212| train set 1.312x speedup, test set 1.225x speedup, val set 0.892x speedup, step: 4
Epoch 15/300 |loss: 0.005033| train set 1.389x speedup, test set 1.196x speedup, val set 1.386x speedup, step: 1
Epoch 16/300 |loss: 0.004741| train set 1.351x speedup, test set 1.225x speedup, val set 1.530x speedup, step: 1
Epoch 17/300 |loss: 0.004500| train set 1.368x speedup, test set 1.203x speedup, val set 1.549x speedup, step: 1
Epoch 18/300 |loss: 0.004384| train set 2.552x speedup, test set 1.203x speedup, val set 1.522x speedup, step: 2
Epoch 19/300 |loss: 0.004042| train set 1.296x speedup, test set 2.295x speedup, val set 0.927x speedup, step: 3
Epoch 20/300 |loss: 0.004701| train set 2.383x speedup, test set 2.425x speedup, val set 1.433x speedup, step: 4
Epoch 21/300 |loss: 0.004023| train set 1.405x speedup, test set 1.255x speedup, val set 1.437x speedup, step: 5
Epoch 22/300 |loss: 0.003656| train set 2.515x speedup, test set 1.202x speedup, val set 0.925x speedup, step: 6
Epoch 23/300 |loss: 0.003847| train set 2.499x speedup, test set 1.247x speedup, val set 1.501x speedup, step: 7
Epoch 24/300 |loss: 0.004542| train set 2.519x speedup, test set 2.347x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003415| train set 2.617x speedup, test set 2.304x speedup, val set 1.375x speedup, step: 2
Epoch 26/300 |loss: 0.003349| train set 2.495x speedup, test set 1.199x speedup, val set 1.549x speedup, step: 1
Epoch 27/300 |loss: 0.003494| train set 2.601x speedup, test set 1.178x speedup, val set 1.358x speedup, step: 2
Epoch 28/300 |loss: 0.003026| train set 2.641x speedup, test set 2.161x speedup, val set 1.376x speedup, step: 3
Epoch 29/300 |loss: 0.003177| train set 2.599x speedup, test set 1.221x speedup, val set 1.355x speedup, step: 4
Epoch 30/300 |loss: 0.003125| train set 2.603x speedup, test set 2.269x speedup, val set 1.352x speedup, step: 5
Epoch 31/300 |loss: 0.003007| train set 2.610x speedup, test set 1.194x speedup, val set 1.526x speedup, step: 6
Epoch 32/300 |loss: 0.002814| train set 2.506x speedup, test set 1.247x speedup, val set 1.549x speedup, step: 7
Epoch 33/300 |loss: 0.002965| train set 2.603x speedup, test set 2.377x speedup, val set 1.352x speedup, step: 8
Epoch 34/300 |loss: 0.002686| train set 2.665x speedup, test set 1.247x speedup, val set 1.526x speedup, step: 9
Epoch 35/300 |loss: 0.002532| train set 2.632x speedup, test set 1.245x speedup, val set 1.264x speedup, step: 10
Epoch 36/300 |loss: 0.003060| train set 2.568x speedup, test set 1.004x speedup, val set 1.526x speedup, step: 11
Epoch 37/300 |loss: 0.002730| train set 2.658x speedup, test set 1.192x speedup, val set 1.277x speedup, step: 12
Epoch 38/300 |loss: 0.002535| train set 2.655x speedup, test set 2.584x speedup, val set 1.249x speedup, step: 13
Epoch 39/300 |loss: 0.002378| train set 2.587x speedup, test set 2.063x speedup, val set 1.413x speedup, step: 14
Epoch 40/300 |loss: 0.002271| train set 2.548x speedup, test set 1.166x speedup, val set 1.277x speedup, step: 15
Epoch 41/300 |loss: 0.002624| train set 2.532x speedup, test set 2.393x speedup, val set 1.394x speedup, step: 16
Epoch 42/300 |loss: 0.002542| train set 2.721x speedup, test set 1.191x speedup, val set 1.277x speedup, step: 17
Epoch 43/300 |loss: 0.002636| train set 2.702x speedup, test set 1.116x speedup, val set 1.413x speedup, step: 18
Epoch 44/300 |loss: 0.002336| train set 2.563x speedup, test set 1.119x speedup, val set 1.259x speedup, step: 19
Epoch 45/300 |loss: 0.002588| train set 2.561x speedup, test set 1.141x speedup, val set 1.427x speedup, step: 20
Epoch 46/300 |loss: 0.002124| train set 2.594x speedup, test set 1.092x speedup, val set 1.267x speedup, step: 21
Epoch 47/300 |loss: 0.002011| train set 2.627x speedup, test set 1.099x speedup, val set 1.259x speedup, step: 22
Epoch 48/300 |loss: 0.002091| train set 2.665x speedup, test set 1.118x speedup, val set 1.267x speedup, step: 23
Epoch 49/300 |loss: 0.002176| train set 2.676x speedup, test set 0.953x speedup, val set 1.400x speedup, step: 24
Epoch 50/300 |loss: 0.001881| train set 2.695x speedup, test set 1.118x speedup, val set 1.277x speedup, step: 25
Epoch 51/300 |loss: 0.001942| train set 2.678x speedup, test set 0.996x speedup, val set 1.259x speedup, step: 26
Epoch 52/300 |loss: 0.001611| train set 2.745x speedup, test set 0.947x speedup, val set 1.277x speedup, step: 27
Epoch 53/300 |loss: 0.001496| train set 2.648x speedup, test set 0.958x speedup, val set 1.413x speedup, step: 28
Epoch 54/300 |loss: 0.001544| train set 2.590x speedup, test set 1.023x speedup, val set 1.259x speedup, step: 29
Epoch 55/300 |loss: 0.001926| train set 2.705x speedup, test set 0.944x speedup, val set 1.413x speedup, step: 30
Epoch 56/300 |loss: 0.001640| train set 2.682x speedup, test set 1.121x speedup, val set 1.522x speedup, step: 31
Epoch 57/300 |loss: 0.001483| train set 2.695x speedup, test set 0.937x speedup, val set 2.021x speedup, step: 1
Epoch 58/300 |loss: 0.002064| train set 2.634x speedup, test set 0.953x speedup, val set 1.526x speedup, step: 2
Epoch 59/300 |loss: 0.001575| train set 2.625x speedup, test set 1.136x speedup, val set 1.413x speedup, step: 3
Epoch 60/300 |loss: 0.001521| train set 2.618x speedup, test set 1.105x speedup, val set 1.413x speedup, step: 4
Epoch 61/300 |loss: 0.001765| train set 2.697x speedup, test set 1.135x speedup, val set 1.277x speedup, step: 5
Epoch 62/300 |loss: 0.001465| train set 2.647x speedup, test set 0.935x speedup, val set 1.413x speedup, step: 6
Epoch 63/300 |loss: 0.001262| train set 2.694x speedup, test set 0.945x speedup, val set 1.400x speedup, step: 7
Epoch 64/300 |loss: 0.001345| train set 2.660x speedup, test set 1.139x speedup, val set 1.414x speedup, step: 8
Epoch 65/300 |loss: 0.001372| train set 2.650x speedup, test set 1.120x speedup, val set 1.528x speedup, step: 9
Epoch 66/300 |loss: 0.001312| train set 2.710x speedup, test set 0.934x speedup, val set 1.259x speedup, step: 10
Epoch 67/300 |loss: 0.001553| train set 2.670x speedup, test set 0.930x speedup, val set 1.358x speedup, step: 11
Epoch 68/300 |loss: 0.001505| train set 2.736x speedup, test set 1.062x speedup, val set 1.513x speedup, step: 12
Epoch 69/300 |loss: 0.001434| train set 2.679x speedup, test set 1.105x speedup, val set 1.413x speedup, step: 13
Epoch 70/300 |loss: 0.001286| train set 2.745x speedup, test set 1.060x speedup, val set 1.370x speedup, step: 14
Epoch 71/300 |loss: 0.001437| train set 2.690x speedup, test set 1.096x speedup, val set 1.528x speedup, step: 15
Epoch 72/300 |loss: 0.001196| train set 2.657x speedup, test set 1.071x speedup, val set 1.528x speedup, step: 16
Epoch 73/300 |loss: 0.001606| train set 2.654x speedup, test set 1.096x speedup, val set 1.358x speedup, step: 17
Epoch 74/300 |loss: 0.001164| train set 2.657x speedup, test set 1.100x speedup, val set 1.513x speedup, step: 18
Epoch 75/300 |loss: 0.001145| train set 2.695x speedup, test set 1.096x speedup, val set 1.278x speedup, step: 19
Epoch 76/300 |loss: 0.000958| train set 2.651x speedup, test set 1.096x speedup, val set 1.278x speedup, step: 20
Epoch 77/300 |loss: 0.001055| train set 2.736x speedup, test set 2.046x speedup, val set 1.278x speedup, step: 21
Epoch 78/300 |loss: 0.001099| train set 2.663x speedup, test set 0.947x speedup, val set 1.528x speedup, step: 22
Epoch 79/300 |loss: 0.000984| train set 2.742x speedup, test set 0.934x speedup, val set 1.414x speedup, step: 23
Epoch 80/300 |loss: 0.000869| train set 2.746x speedup, test set 1.250x speedup, val set 1.267x speedup, step: 24
Epoch 81/300 |loss: 0.001341| train set 2.720x speedup, test set 1.096x speedup, val set 1.277x speedup, step: 25
Epoch 82/300 |loss: 0.001346| train set 2.679x speedup, test set 2.083x speedup, val set 1.369x speedup, step: 26
Epoch 83/300 |loss: 0.000908| train set 2.620x speedup, test set 0.928x speedup, val set 1.370x speedup, step: 27
Epoch 84/300 |loss: 0.001693| train set 2.657x speedup, test set 1.042x speedup, val set 1.400x speedup, step: 28
Epoch 85/300 |loss: 0.001289| train set 2.731x speedup, test set 0.919x speedup, val set 1.401x speedup, step: 29
early stopping at epoch 85
Training per epoch cost 2.217 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 118.456s, pg runtime 92.131s, speedup 0.778x
04, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 48.776s, pg runtime 23.223s, speedup 0.476x
18, opt runtime 10.788s, model runtime 56.246s, pg runtime 32.939s, speedup 0.586x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 5.961s, model runtime 9.875s, pg runtime 31.210s, speedup 3.161x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.333s, pg runtime 7.268s, speedup 0.991x
28, opt runtime 6.854s, model runtime 7.066s, pg runtime 6.854s, speedup 0.970x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 312.290s, pg runtime 608.707s, speedup 1.949x
32, opt runtime 24.706s, model runtime 314.812s, pg runtime 610.808s, speedup 1.940x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 786.481s, pg runtime 651.942s, speedup 0.829x
36, opt runtime 16.639s, model runtime 700.825s, pg runtime 462.544s, speedup 0.660x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 23.980s, pg runtime 0.912s, speedup 0.038x
40, opt runtime 0.873s, model runtime 25.328s, pg runtime 0.873s, speedup 0.034x
====================
best train speedup epoch: 80, train speedup 2.746, test speedup 1.250, val speedup 1.267
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.695, test speedup 0.937, val speedup 2.021
last model at epoch 85, train speedup 2.731, test speedup 0.919, val speedup 1.401
execution cost 0:05:23.825175
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.882819, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009290| train set 0.831x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008610| train set 0.880x speedup, test set 0.860x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008035| train set 0.952x speedup, test set 1.216x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007386| train set 0.900x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007034| train set 0.972x speedup, test set 1.210x speedup, val set 1.452x speedup, step: 1
Epoch 10/300 |loss: 0.007144| train set 0.987x speedup, test set 2.346x speedup, val set 0.900x speedup, step: 2
Epoch 11/300 |loss: 0.006252| train set 1.229x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 3
Epoch 12/300 |loss: 0.005636| train set 0.816x speedup, test set 2.207x speedup, val set 0.925x speedup, step: 4
Epoch 13/300 |loss: 0.005651| train set 1.349x speedup, test set 2.345x speedup, val set 1.522x speedup, step: 1
Epoch 14/300 |loss: 0.005296| train set 1.332x speedup, test set 1.225x speedup, val set 0.941x speedup, step: 2
Epoch 15/300 |loss: 0.005102| train set 1.391x speedup, test set 2.318x speedup, val set 1.530x speedup, step: 1
Epoch 16/300 |loss: 0.004747| train set 1.352x speedup, test set 1.203x speedup, val set 1.352x speedup, step: 2
Epoch 17/300 |loss: 0.004467| train set 1.382x speedup, test set 1.251x speedup, val set 1.372x speedup, step: 3
Epoch 18/300 |loss: 0.004344| train set 2.426x speedup, test set 1.259x speedup, val set 1.522x speedup, step: 4
Epoch 19/300 |loss: 0.004228| train set 1.260x speedup, test set 1.168x speedup, val set 0.936x speedup, step: 5
Epoch 20/300 |loss: 0.004850| train set 2.201x speedup, test set 2.340x speedup, val set 1.602x speedup, step: 1
Epoch 21/300 |loss: 0.003838| train set 1.393x speedup, test set 1.228x speedup, val set 1.433x speedup, step: 2
Epoch 22/300 |loss: 0.003815| train set 1.177x speedup, test set 2.123x speedup, val set 0.928x speedup, step: 3
Epoch 23/300 |loss: 0.004253| train set 2.434x speedup, test set 1.196x speedup, val set 1.431x speedup, step: 4
Epoch 24/300 |loss: 0.004212| train set 2.469x speedup, test set 2.285x speedup, val set 1.523x speedup, step: 5
Epoch 25/300 |loss: 0.003518| train set 2.534x speedup, test set 2.371x speedup, val set 1.433x speedup, step: 6
Epoch 26/300 |loss: 0.003629| train set 2.265x speedup, test set 1.184x speedup, val set 1.522x speedup, step: 7
Epoch 27/300 |loss: 0.003626| train set 2.384x speedup, test set 1.216x speedup, val set 1.484x speedup, step: 8
Epoch 28/300 |loss: 0.003234| train set 2.600x speedup, test set 2.407x speedup, val set 1.608x speedup, step: 1
Epoch 29/300 |loss: 0.003156| train set 2.637x speedup, test set 2.323x speedup, val set 1.511x speedup, step: 2
Epoch 30/300 |loss: 0.003108| train set 2.516x speedup, test set 2.333x speedup, val set 1.501x speedup, step: 3
Epoch 31/300 |loss: 0.003136| train set 2.595x speedup, test set 1.228x speedup, val set 1.522x speedup, step: 4
Epoch 32/300 |loss: 0.002818| train set 2.507x speedup, test set 1.207x speedup, val set 1.522x speedup, step: 5
Epoch 33/300 |loss: 0.003133| train set 2.607x speedup, test set 2.324x speedup, val set 1.508x speedup, step: 6
Epoch 34/300 |loss: 0.002703| train set 2.602x speedup, test set 2.226x speedup, val set 1.501x speedup, step: 7
Epoch 35/300 |loss: 0.002603| train set 2.622x speedup, test set 1.207x speedup, val set 1.379x speedup, step: 8
Epoch 36/300 |loss: 0.002990| train set 2.567x speedup, test set 1.207x speedup, val set 1.376x speedup, step: 9
Epoch 37/300 |loss: 0.002745| train set 2.570x speedup, test set 1.226x speedup, val set 1.391x speedup, step: 10
Epoch 38/300 |loss: 0.002481| train set 2.607x speedup, test set 2.333x speedup, val set 1.338x speedup, step: 11
Epoch 39/300 |loss: 0.002286| train set 2.587x speedup, test set 1.210x speedup, val set 1.413x speedup, step: 12
Epoch 40/300 |loss: 0.002328| train set 2.587x speedup, test set 1.167x speedup, val set 1.501x speedup, step: 13
Epoch 41/300 |loss: 0.002821| train set 2.453x speedup, test set 1.322x speedup, val set 1.262x speedup, step: 14
Epoch 42/300 |loss: 0.002886| train set 2.588x speedup, test set 2.264x speedup, val set 1.267x speedup, step: 15
Epoch 43/300 |loss: 0.002570| train set 2.647x speedup, test set 1.336x speedup, val set 1.264x speedup, step: 16
Epoch 44/300 |loss: 0.002299| train set 2.438x speedup, test set 1.142x speedup, val set 1.282x speedup, step: 17
Epoch 45/300 |loss: 0.002597| train set 2.598x speedup, test set 1.121x speedup, val set 1.360x speedup, step: 18
Epoch 46/300 |loss: 0.001991| train set 2.647x speedup, test set 1.116x speedup, val set 1.267x speedup, step: 19
Epoch 47/300 |loss: 0.002053| train set 2.604x speedup, test set 1.335x speedup, val set 1.259x speedup, step: 20
Epoch 48/300 |loss: 0.002201| train set 2.613x speedup, test set 1.165x speedup, val set 1.370x speedup, step: 21
Epoch 49/300 |loss: 0.002170| train set 2.611x speedup, test set 1.186x speedup, val set 1.366x speedup, step: 22
Epoch 50/300 |loss: 0.001823| train set 2.409x speedup, test set 1.307x speedup, val set 1.369x speedup, step: 23
Epoch 51/300 |loss: 0.001883| train set 2.690x speedup, test set 1.140x speedup, val set 1.346x speedup, step: 24
Epoch 52/300 |loss: 0.001657| train set 2.624x speedup, test set 1.145x speedup, val set 1.366x speedup, step: 25
Epoch 53/300 |loss: 0.001578| train set 2.716x speedup, test set 1.166x speedup, val set 1.369x speedup, step: 26
Epoch 54/300 |loss: 0.001595| train set 2.558x speedup, test set 1.306x speedup, val set 1.355x speedup, step: 27
Epoch 55/300 |loss: 0.001767| train set 2.600x speedup, test set 1.183x speedup, val set 1.438x speedup, step: 28
Epoch 56/300 |loss: 0.001582| train set 2.615x speedup, test set 1.272x speedup, val set 1.346x speedup, step: 29
Epoch 57/300 |loss: 0.001658| train set 2.645x speedup, test set 1.144x speedup, val set 1.934x speedup, step: 1
Epoch 58/300 |loss: 0.001910| train set 2.575x speedup, test set 1.322x speedup, val set 1.295x speedup, step: 2
Epoch 59/300 |loss: 0.001429| train set 2.648x speedup, test set 2.274x speedup, val set 1.298x speedup, step: 3
Epoch 60/300 |loss: 0.001655| train set 2.604x speedup, test set 1.306x speedup, val set 1.280x speedup, step: 4
Epoch 61/300 |loss: 0.001963| train set 2.693x speedup, test set 2.179x speedup, val set 1.350x speedup, step: 5
Epoch 62/300 |loss: 0.001603| train set 2.601x speedup, test set 1.298x speedup, val set 1.298x speedup, step: 6
early stopping at epoch 62
Training per epoch cost 2.102 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
18, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
28, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 69.421s, pg runtime 69.421s, speedup 1.000x
34, opt runtime 35.527s, model runtime 71.730s, pg runtime 71.730s, speedup 1.000x
35, opt runtime 18.690s, model runtime 786.481s, pg runtime 651.942s, speedup 0.829x
36, opt runtime 16.639s, model runtime 700.825s, pg runtime 462.544s, speedup 0.660x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 53, train speedup 2.716, test speedup 1.166, val speedup 1.369
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.645, test speedup 1.144, val speedup 1.934
last model at epoch 62, train speedup 2.601, test speedup 1.298, val speedup 1.298
execution cost 0:03:36.996890
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.262459, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009289| train set 0.831x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008610| train set 0.898x speedup, test set 0.871x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008020| train set 0.954x speedup, test set 1.216x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007371| train set 0.945x speedup, test set 1.235x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.006992| train set 0.972x speedup, test set 1.216x speedup, val set 1.371x speedup, step: 1
Epoch 10/300 |loss: 0.007205| train set 0.973x speedup, test set 2.346x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006205| train set 1.236x speedup, test set 1.231x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005647| train set 0.966x speedup, test set 2.281x speedup, val set 0.925x speedup, step: 2
Epoch 13/300 |loss: 0.005607| train set 1.267x speedup, test set 2.318x speedup, val set 1.522x speedup, step: 1
Epoch 14/300 |loss: 0.005172| train set 1.323x speedup, test set 1.203x speedup, val set 0.907x speedup, step: 2
Epoch 15/300 |loss: 0.005112| train set 1.351x speedup, test set 1.203x speedup, val set 1.549x speedup, step: 1
Epoch 16/300 |loss: 0.004667| train set 1.371x speedup, test set 1.203x speedup, val set 1.530x speedup, step: 2
Epoch 17/300 |loss: 0.004551| train set 1.373x speedup, test set 1.257x speedup, val set 1.549x speedup, step: 1
Epoch 18/300 |loss: 0.004459| train set 2.450x speedup, test set 1.246x speedup, val set 1.523x speedup, step: 2
Epoch 19/300 |loss: 0.004180| train set 1.386x speedup, test set 2.441x speedup, val set 0.901x speedup, step: 3
Epoch 20/300 |loss: 0.004803| train set 2.421x speedup, test set 1.201x speedup, val set 1.454x speedup, step: 4
Epoch 21/300 |loss: 0.003884| train set 1.429x speedup, test set 1.267x speedup, val set 1.457x speedup, step: 5
Epoch 22/300 |loss: 0.003754| train set 2.352x speedup, test set 1.183x speedup, val set 1.431x speedup, step: 6
Epoch 23/300 |loss: 0.003823| train set 2.548x speedup, test set 1.234x speedup, val set 1.549x speedup, step: 1
Epoch 24/300 |loss: 0.004315| train set 2.563x speedup, test set 2.336x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003597| train set 2.464x speedup, test set 1.231x speedup, val set 1.635x speedup, step: 1
Epoch 26/300 |loss: 0.003427| train set 2.505x speedup, test set 1.194x speedup, val set 1.549x speedup, step: 2
Epoch 27/300 |loss: 0.003429| train set 2.619x speedup, test set 1.209x speedup, val set 1.436x speedup, step: 3
Epoch 28/300 |loss: 0.003052| train set 2.561x speedup, test set 2.406x speedup, val set 1.347x speedup, step: 4
Epoch 29/300 |loss: 0.003055| train set 2.611x speedup, test set 1.217x speedup, val set 1.511x speedup, step: 5
Epoch 30/300 |loss: 0.002955| train set 2.568x speedup, test set 2.360x speedup, val set 1.501x speedup, step: 6
Epoch 31/300 |loss: 0.003002| train set 2.600x speedup, test set 1.206x speedup, val set 1.549x speedup, step: 7
Epoch 32/300 |loss: 0.002734| train set 2.481x speedup, test set 1.230x speedup, val set 1.549x speedup, step: 8
Epoch 33/300 |loss: 0.003061| train set 2.600x speedup, test set 2.302x speedup, val set 1.332x speedup, step: 9
Epoch 34/300 |loss: 0.002749| train set 2.500x speedup, test set 2.576x speedup, val set 1.526x speedup, step: 10
Epoch 35/300 |loss: 0.002547| train set 2.636x speedup, test set 2.379x speedup, val set 1.267x speedup, step: 11
Epoch 36/300 |loss: 0.002858| train set 2.530x speedup, test set 2.465x speedup, val set 1.413x speedup, step: 12
Epoch 37/300 |loss: 0.002630| train set 2.631x speedup, test set 1.251x speedup, val set 1.394x speedup, step: 13
Epoch 38/300 |loss: 0.002200| train set 2.668x speedup, test set 2.608x speedup, val set 1.262x speedup, step: 14
Epoch 39/300 |loss: 0.002112| train set 2.624x speedup, test set 2.564x speedup, val set 1.394x speedup, step: 15
Epoch 40/300 |loss: 0.002257| train set 2.720x speedup, test set 1.279x speedup, val set 1.234x speedup, step: 16
Epoch 41/300 |loss: 0.002883| train set 2.590x speedup, test set 2.437x speedup, val set 1.394x speedup, step: 17
Epoch 42/300 |loss: 0.002579| train set 2.583x speedup, test set 2.429x speedup, val set 1.748x speedup, step: 1
Epoch 43/300 |loss: 0.002601| train set 2.675x speedup, test set 2.262x speedup, val set 1.400x speedup, step: 2
Epoch 44/300 |loss: 0.002200| train set 2.497x speedup, test set 2.108x speedup, val set 1.259x speedup, step: 3
Epoch 45/300 |loss: 0.002418| train set 2.446x speedup, test set 2.366x speedup, val set 1.439x speedup, step: 4
Epoch 46/300 |loss: 0.002231| train set 2.630x speedup, test set 1.195x speedup, val set 1.247x speedup, step: 5
Epoch 47/300 |loss: 0.001982| train set 2.642x speedup, test set 1.179x speedup, val set 1.287x speedup, step: 6
Epoch 48/300 |loss: 0.001908| train set 2.610x speedup, test set 2.111x speedup, val set 1.267x speedup, step: 7
Epoch 49/300 |loss: 0.002092| train set 2.642x speedup, test set 2.367x speedup, val set 1.358x speedup, step: 8
Epoch 50/300 |loss: 0.001819| train set 2.492x speedup, test set 2.486x speedup, val set 1.267x speedup, step: 9
Epoch 51/300 |loss: 0.001887| train set 2.623x speedup, test set 2.374x speedup, val set 1.260x speedup, step: 10
Epoch 52/300 |loss: 0.001614| train set 2.714x speedup, test set 1.228x speedup, val set 1.265x speedup, step: 11
Epoch 53/300 |loss: 0.001650| train set 2.708x speedup, test set 1.145x speedup, val set 1.278x speedup, step: 12
Epoch 54/300 |loss: 0.001725| train set 2.576x speedup, test set 2.375x speedup, val set 1.276x speedup, step: 13
Epoch 55/300 |loss: 0.001802| train set 2.674x speedup, test set 2.176x speedup, val set 1.413x speedup, step: 14
Epoch 56/300 |loss: 0.001631| train set 2.574x speedup, test set 1.191x speedup, val set 1.503x speedup, step: 15
Epoch 57/300 |loss: 0.001540| train set 2.677x speedup, test set 1.226x speedup, val set 1.979x speedup, step: 1
Epoch 58/300 |loss: 0.001795| train set 2.642x speedup, test set 1.145x speedup, val set 1.401x speedup, step: 2
Epoch 59/300 |loss: 0.001420| train set 2.628x speedup, test set 1.152x speedup, val set 1.392x speedup, step: 3
Epoch 60/300 |loss: 0.001793| train set 2.522x speedup, test set 2.106x speedup, val set 1.288x speedup, step: 4
Epoch 61/300 |loss: 0.002043| train set 2.637x speedup, test set 1.150x speedup, val set 1.260x speedup, step: 5
early stopping at epoch 61
Training per epoch cost 2.219 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 12.479s, pg runtime 16.134s, speedup 1.293x
08, opt runtime 6.284s, model runtime 13.017s, pg runtime 31.019s, speedup 2.383x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
12, opt runtime 25.043s, model runtime 60.927s, pg runtime 73.019s, speedup 1.198x
13, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
14, opt runtime 3.449s, model runtime 3.449s, pg runtime 14.824s, speedup 4.298x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
18, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.333s, pg runtime 7.268s, speedup 0.991x
28, opt runtime 6.854s, model runtime 7.066s, pg runtime 6.854s, speedup 0.970x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 786.481s, pg runtime 651.942s, speedup 0.829x
36, opt runtime 16.639s, model runtime 700.825s, pg runtime 462.544s, speedup 0.660x
37, opt runtime 11.120s, model runtime 11.120s, pg runtime 11.120s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 0.912s, model runtime 0.912s, pg runtime 0.912s, speedup 1.000x
40, opt runtime 0.873s, model runtime 0.873s, pg runtime 0.873s, speedup 1.000x
====================
best train speedup epoch: 40, train speedup 2.720, test speedup 1.279, val speedup 1.234
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.677, test speedup 1.226, val speedup 1.979
last model at epoch 61, train speedup 2.637, test speedup 1.150, val speedup 1.260
execution cost 0:03:55.709845
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.207216, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009285| train set 0.833x speedup, test set 1.263x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008576| train set 0.880x speedup, test set 0.871x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008031| train set 0.942x speedup, test set 1.214x speedup, val set 0.914x speedup, step: 4
Epoch 8/300 |loss: 0.007406| train set 0.901x speedup, test set 1.216x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007170| train set 0.971x speedup, test set 1.207x speedup, val set 0.937x speedup, step: 6
Epoch 10/300 |loss: 0.006948| train set 0.925x speedup, test set 2.231x speedup, val set 0.795x speedup, step: 7
Epoch 11/300 |loss: 0.006173| train set 1.256x speedup, test set 1.209x speedup, val set 0.900x speedup, step: 8
Epoch 12/300 |loss: 0.005639| train set 0.926x speedup, test set 2.206x speedup, val set 0.925x speedup, step: 9
Epoch 13/300 |loss: 0.005642| train set 1.278x speedup, test set 2.318x speedup, val set 1.365x speedup, step: 1
Epoch 14/300 |loss: 0.005369| train set 1.281x speedup, test set 1.225x speedup, val set 0.926x speedup, step: 2
Epoch 15/300 |loss: 0.005064| train set 1.385x speedup, test set 1.208x speedup, val set 1.386x speedup, step: 1
Epoch 16/300 |loss: 0.004710| train set 1.370x speedup, test set 1.208x speedup, val set 1.351x speedup, step: 2
Epoch 17/300 |loss: 0.004650| train set 1.373x speedup, test set 1.199x speedup, val set 0.892x speedup, step: 3
Epoch 18/300 |loss: 0.004228| train set 2.404x speedup, test set 2.514x speedup, val set 0.907x speedup, step: 4
Epoch 19/300 |loss: 0.004885| train set 2.295x speedup, test set 2.433x speedup, val set 1.372x speedup, step: 5
Epoch 20/300 |loss: 0.004234| train set 1.885x speedup, test set 2.199x speedup, val set 0.925x speedup, step: 6
Epoch 21/300 |loss: 0.004070| train set 1.416x speedup, test set 2.423x speedup, val set 1.413x speedup, step: 1
Epoch 22/300 |loss: 0.003666| train set 2.323x speedup, test set 2.362x speedup, val set 1.410x speedup, step: 2
Epoch 23/300 |loss: 0.003894| train set 2.509x speedup, test set 1.241x speedup, val set 1.610x speedup, step: 1
Epoch 24/300 |loss: 0.004821| train set 2.510x speedup, test set 2.305x speedup, val set 1.457x speedup, step: 2
Epoch 25/300 |loss: 0.003550| train set 2.483x speedup, test set 2.298x speedup, val set 1.366x speedup, step: 3
Epoch 26/300 |loss: 0.003540| train set 2.385x speedup, test set 1.198x speedup, val set 1.348x speedup, step: 4
Epoch 27/300 |loss: 0.003497| train set 2.382x speedup, test set 1.193x speedup, val set 1.334x speedup, step: 5
Epoch 28/300 |loss: 0.003143| train set 2.636x speedup, test set 2.262x speedup, val set 1.316x speedup, step: 6
Epoch 29/300 |loss: 0.003145| train set 2.597x speedup, test set 1.200x speedup, val set 1.484x speedup, step: 7
Epoch 30/300 |loss: 0.003023| train set 2.582x speedup, test set 1.192x speedup, val set 1.366x speedup, step: 8
Epoch 31/300 |loss: 0.003127| train set 2.574x speedup, test set 1.255x speedup, val set 1.523x speedup, step: 9
Epoch 32/300 |loss: 0.002860| train set 2.521x speedup, test set 1.235x speedup, val set 1.366x speedup, step: 10
Epoch 33/300 |loss: 0.003024| train set 2.431x speedup, test set 2.279x speedup, val set 1.430x speedup, step: 11
Epoch 34/300 |loss: 0.002668| train set 2.332x speedup, test set 2.307x speedup, val set 1.391x speedup, step: 12
Epoch 35/300 |loss: 0.002459| train set 2.443x speedup, test set 1.258x speedup, val set 1.251x speedup, step: 13
Epoch 36/300 |loss: 0.002845| train set 2.448x speedup, test set 1.255x speedup, val set 1.394x speedup, step: 14
Epoch 37/300 |loss: 0.002609| train set 2.590x speedup, test set 2.533x speedup, val set 1.370x speedup, step: 15
Epoch 38/300 |loss: 0.002346| train set 2.436x speedup, test set 2.333x speedup, val set 1.352x speedup, step: 16
Epoch 39/300 |loss: 0.002161| train set 2.390x speedup, test set 2.533x speedup, val set 1.277x speedup, step: 17
Epoch 40/300 |loss: 0.002272| train set 2.548x speedup, test set 1.223x speedup, val set 1.323x speedup, step: 18
Epoch 41/300 |loss: 0.002937| train set 2.263x speedup, test set 1.258x speedup, val set 1.262x speedup, step: 19
Epoch 42/300 |loss: 0.002626| train set 2.385x speedup, test set 2.197x speedup, val set 1.262x speedup, step: 20
Epoch 43/300 |loss: 0.002575| train set 2.658x speedup, test set 2.568x speedup, val set 1.369x speedup, step: 21
Epoch 44/300 |loss: 0.002230| train set 2.465x speedup, test set 2.288x speedup, val set 1.332x speedup, step: 22
Epoch 45/300 |loss: 0.002386| train set 2.533x speedup, test set 2.255x speedup, val set 1.350x speedup, step: 23
Epoch 46/300 |loss: 0.002222| train set 2.515x speedup, test set 2.374x speedup, val set 1.357x speedup, step: 24
Epoch 47/300 |loss: 0.002067| train set 2.534x speedup, test set 2.629x speedup, val set 1.277x speedup, step: 25
Epoch 48/300 |loss: 0.002159| train set 2.512x speedup, test set 2.224x speedup, val set 1.370x speedup, step: 26
Epoch 49/300 |loss: 0.002106| train set 2.580x speedup, test set 1.191x speedup, val set 1.370x speedup, step: 27
Epoch 50/300 |loss: 0.001863| train set 2.478x speedup, test set 1.293x speedup, val set 1.370x speedup, step: 28
Epoch 51/300 |loss: 0.001883| train set 2.598x speedup, test set 1.172x speedup, val set 1.352x speedup, step: 29
Epoch 52/300 |loss: 0.001660| train set 2.659x speedup, test set 1.320x speedup, val set 1.366x speedup, step: 30
Epoch 53/300 |loss: 0.001491| train set 2.588x speedup, test set 2.782x speedup, val set 1.370x speedup, step: 31
Epoch 54/300 |loss: 0.001576| train set 2.527x speedup, test set 1.319x speedup, val set 1.237x speedup, step: 32
Epoch 55/300 |loss: 0.001757| train set 2.634x speedup, test set 2.429x speedup, val set 1.370x speedup, step: 33
Epoch 56/300 |loss: 0.001531| train set 2.667x speedup, test set 1.149x speedup, val set 1.366x speedup, step: 34
Epoch 57/300 |loss: 0.001503| train set 2.571x speedup, test set 1.226x speedup, val set 1.370x speedup, step: 35
Epoch 58/300 |loss: 0.002120| train set 2.456x speedup, test set 2.105x speedup, val set 1.298x speedup, step: 36
Epoch 59/300 |loss: 0.001494| train set 2.571x speedup, test set 1.160x speedup, val set 1.370x speedup, step: 37
Epoch 60/300 |loss: 0.001708| train set 2.463x speedup, test set 1.161x speedup, val set 1.289x speedup, step: 38
Epoch 61/300 |loss: 0.001870| train set 2.626x speedup, test set 1.996x speedup, val set 1.335x speedup, step: 39
early stopping at epoch 61
Training per epoch cost 2.235 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
16, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
17, opt runtime 7.469s, model runtime 23.223s, pg runtime 23.223s, speedup 1.000x
18, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
19, opt runtime 1.148s, model runtime 1.214s, pg runtime 1.214s, speedup 1.000x
20, opt runtime 1.353s, model runtime 1.380s, pg runtime 1.380s, speedup 1.000x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 69.421s, pg runtime 69.421s, speedup 1.000x
34, opt runtime 35.527s, model runtime 71.730s, pg runtime 71.730s, speedup 1.000x
35, opt runtime 18.690s, model runtime 786.481s, pg runtime 651.942s, speedup 0.829x
36, opt runtime 16.639s, model runtime 700.825s, pg runtime 462.544s, speedup 0.660x
37, opt runtime 11.120s, model runtime 11.120s, pg runtime 11.120s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 56, train speedup 2.667, test speedup 1.149, val speedup 1.366
best test speedup epoch: 53, train speedup 2.588, test speedup 2.782, val speedup 1.370
best validation speedup epoch: 23, train speedup 2.509, test speedup 1.241, val speedup 1.610
last model at epoch 61, train speedup 2.626, test speedup 1.996, val speedup 1.335
execution cost 0:03:55.763059
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.698946, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009289| train set 0.831x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008609| train set 0.900x speedup, test set 0.871x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008022| train set 0.954x speedup, test set 1.216x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007373| train set 0.922x speedup, test set 1.235x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.006996| train set 0.972x speedup, test set 1.210x speedup, val set 1.350x speedup, step: 1
Epoch 10/300 |loss: 0.007188| train set 0.974x speedup, test set 2.430x speedup, val set 0.900x speedup, step: 2
Epoch 11/300 |loss: 0.006213| train set 1.216x speedup, test set 1.216x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005645| train set 0.988x speedup, test set 2.231x speedup, val set 0.934x speedup, step: 2
Epoch 13/300 |loss: 0.005637| train set 1.342x speedup, test set 2.318x speedup, val set 1.522x speedup, step: 1
Epoch 14/300 |loss: 0.005335| train set 1.331x speedup, test set 1.203x speedup, val set 0.907x speedup, step: 2
Epoch 15/300 |loss: 0.005029| train set 1.338x speedup, test set 1.203x speedup, val set 1.549x speedup, step: 1
Epoch 16/300 |loss: 0.004778| train set 1.356x speedup, test set 1.210x speedup, val set 1.505x speedup, step: 2
Epoch 17/300 |loss: 0.004561| train set 1.369x speedup, test set 1.210x speedup, val set 1.549x speedup, step: 1
Epoch 18/300 |loss: 0.004439| train set 2.508x speedup, test set 1.251x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.004501| train set 1.422x speedup, test set 1.230x speedup, val set 0.936x speedup, step: 2
Epoch 20/300 |loss: 0.004545| train set 1.954x speedup, test set 1.219x speedup, val set 0.935x speedup, step: 3
Epoch 21/300 |loss: 0.003955| train set 1.381x speedup, test set 1.273x speedup, val set 0.936x speedup, step: 4
Epoch 22/300 |loss: 0.003717| train set 1.881x speedup, test set 1.141x speedup, val set 0.802x speedup, step: 5
Epoch 23/300 |loss: 0.004070| train set 2.410x speedup, test set 1.196x speedup, val set 1.530x speedup, step: 6
Epoch 24/300 |loss: 0.004540| train set 2.460x speedup, test set 2.392x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003491| train set 2.518x speedup, test set 1.199x speedup, val set 1.635x speedup, step: 1
Epoch 26/300 |loss: 0.003454| train set 2.417x speedup, test set 1.185x speedup, val set 1.372x speedup, step: 2
Epoch 27/300 |loss: 0.003522| train set 2.562x speedup, test set 1.187x speedup, val set 1.372x speedup, step: 3
Epoch 28/300 |loss: 0.003124| train set 2.424x speedup, test set 2.338x speedup, val set 1.372x speedup, step: 4
Epoch 29/300 |loss: 0.003141| train set 2.459x speedup, test set 1.180x speedup, val set 1.631x speedup, step: 5
Epoch 30/300 |loss: 0.002997| train set 2.559x speedup, test set 2.176x speedup, val set 1.349x speedup, step: 6
Epoch 31/300 |loss: 0.003059| train set 2.498x speedup, test set 1.238x speedup, val set 1.549x speedup, step: 7
Epoch 32/300 |loss: 0.002787| train set 2.425x speedup, test set 1.231x speedup, val set 1.549x speedup, step: 8
Epoch 33/300 |loss: 0.003290| train set 2.621x speedup, test set 1.351x speedup, val set 1.259x speedup, step: 9
Epoch 34/300 |loss: 0.002765| train set 2.391x speedup, test set 2.075x speedup, val set 1.387x speedup, step: 10
Epoch 35/300 |loss: 0.002529| train set 2.426x speedup, test set 2.167x speedup, val set 1.267x speedup, step: 11
Epoch 36/300 |loss: 0.002896| train set 2.567x speedup, test set 1.226x speedup, val set 1.387x speedup, step: 12
Epoch 37/300 |loss: 0.002581| train set 2.613x speedup, test set 1.237x speedup, val set 1.274x speedup, step: 13
Epoch 38/300 |loss: 0.002342| train set 2.552x speedup, test set 2.255x speedup, val set 1.264x speedup, step: 14
Epoch 39/300 |loss: 0.002168| train set 2.518x speedup, test set 1.230x speedup, val set 1.274x speedup, step: 15
Epoch 40/300 |loss: 0.002301| train set 2.392x speedup, test set 1.209x speedup, val set 1.264x speedup, step: 16
Epoch 41/300 |loss: 0.002638| train set 2.401x speedup, test set 1.421x speedup, val set 1.277x speedup, step: 17
Epoch 42/300 |loss: 0.002712| train set 2.680x speedup, test set 2.289x speedup, val set 1.375x speedup, step: 18
Epoch 43/300 |loss: 0.002433| train set 2.509x speedup, test set 1.408x speedup, val set 1.338x speedup, step: 19
Epoch 44/300 |loss: 0.002152| train set 2.586x speedup, test set 1.987x speedup, val set 1.346x speedup, step: 20
Epoch 45/300 |loss: 0.002537| train set 2.575x speedup, test set 2.059x speedup, val set 1.368x speedup, step: 21
Epoch 46/300 |loss: 0.002115| train set 2.560x speedup, test set 1.367x speedup, val set 1.375x speedup, step: 22
Epoch 47/300 |loss: 0.001876| train set 2.623x speedup, test set 1.131x speedup, val set 1.327x speedup, step: 23
Epoch 48/300 |loss: 0.002064| train set 2.611x speedup, test set 1.261x speedup, val set 1.346x speedup, step: 24
Epoch 49/300 |loss: 0.002188| train set 2.586x speedup, test set 1.223x speedup, val set 1.264x speedup, step: 25
Epoch 50/300 |loss: 0.001802| train set 2.680x speedup, test set 1.401x speedup, val set 1.277x speedup, step: 26
Epoch 51/300 |loss: 0.001791| train set 2.642x speedup, test set 1.340x speedup, val set 1.269x speedup, step: 27
Epoch 52/300 |loss: 0.001535| train set 2.681x speedup, test set 1.115x speedup, val set 1.365x speedup, step: 28
Epoch 53/300 |loss: 0.001443| train set 2.775x speedup, test set 1.220x speedup, val set 1.277x speedup, step: 29
Epoch 54/300 |loss: 0.001566| train set 2.390x speedup, test set 1.121x speedup, val set 1.260x speedup, step: 30
Epoch 55/300 |loss: 0.001950| train set 2.653x speedup, test set 1.256x speedup, val set 1.355x speedup, step: 31
Epoch 56/300 |loss: 0.001453| train set 2.651x speedup, test set 1.126x speedup, val set 1.366x speedup, step: 32
Epoch 57/300 |loss: 0.001348| train set 2.680x speedup, test set 1.151x speedup, val set 1.355x speedup, step: 33
Epoch 58/300 |loss: 0.001835| train set 2.673x speedup, test set 1.355x speedup, val set 1.355x speedup, step: 34
Epoch 59/300 |loss: 0.001404| train set 2.620x speedup, test set 1.264x speedup, val set 1.355x speedup, step: 35
Epoch 60/300 |loss: 0.001727| train set 2.582x speedup, test set 1.262x speedup, val set 1.357x speedup, step: 36
Epoch 61/300 |loss: 0.001918| train set 2.697x speedup, test set 1.264x speedup, val set 1.355x speedup, step: 37
early stopping at epoch 61
Training per epoch cost 1.262 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
07, opt runtime 6.460s, model runtime 6.460s, pg runtime 16.134s, speedup 2.498x
08, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
16, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
17, opt runtime 7.469s, model runtime 23.223s, pg runtime 23.223s, speedup 1.000x
18, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
28, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 69.421s, pg runtime 69.421s, speedup 1.000x
34, opt runtime 35.527s, model runtime 71.730s, pg runtime 71.730s, speedup 1.000x
35, opt runtime 18.690s, model runtime 786.481s, pg runtime 651.942s, speedup 0.829x
36, opt runtime 16.639s, model runtime 700.825s, pg runtime 462.544s, speedup 0.660x
37, opt runtime 11.120s, model runtime 70.189s, pg runtime 11.120s, speedup 0.158x
38, opt runtime 18.262s, model runtime 68.157s, pg runtime 18.262s, speedup 0.268x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 53, train speedup 2.775, test speedup 1.220, val speedup 1.277
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 25, train speedup 2.518, test speedup 1.199, val speedup 1.635
last model at epoch 61, train speedup 2.697, test speedup 1.264, val speedup 1.355
execution cost 0:01:56.918209
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.705410, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009289| train set 0.831x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008610| train set 0.877x speedup, test set 0.871x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008032| train set 0.957x speedup, test set 1.216x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007389| train set 0.907x speedup, test set 1.235x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007095| train set 0.972x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 1
Epoch 10/300 |loss: 0.007143| train set 0.941x speedup, test set 2.328x speedup, val set 0.934x speedup, step: 2
Epoch 11/300 |loss: 0.006383| train set 1.229x speedup, test set 1.233x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005775| train set 0.956x speedup, test set 2.206x speedup, val set 0.935x speedup, step: 2
Epoch 13/300 |loss: 0.005721| train set 1.328x speedup, test set 2.318x speedup, val set 1.354x speedup, step: 3
Epoch 14/300 |loss: 0.005392| train set 1.248x speedup, test set 1.203x speedup, val set 1.374x speedup, step: 1
Epoch 15/300 |loss: 0.005463| train set 1.308x speedup, test set 1.225x speedup, val set 0.900x speedup, step: 2
Epoch 16/300 |loss: 0.006013| train set 2.146x speedup, test set 1.225x speedup, val set 1.522x speedup, step: 1
Epoch 17/300 |loss: 0.004996| train set 1.178x speedup, test set 1.162x speedup, val set 0.934x speedup, step: 2
Epoch 18/300 |loss: 0.004345| train set 2.267x speedup, test set 1.210x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.005074| train set 1.317x speedup, test set 1.235x speedup, val set 1.372x speedup, step: 2
Epoch 20/300 |loss: 0.004776| train set 2.311x speedup, test set 1.229x speedup, val set 1.387x speedup, step: 3
Epoch 21/300 |loss: 0.003966| train set 1.376x speedup, test set 1.277x speedup, val set 0.936x speedup, step: 4
Epoch 22/300 |loss: 0.003679| train set 2.307x speedup, test set 2.417x speedup, val set 1.431x speedup, step: 5
Epoch 23/300 |loss: 0.004104| train set 2.460x speedup, test set 1.216x speedup, val set 1.455x speedup, step: 6
Epoch 24/300 |loss: 0.004453| train set 2.286x speedup, test set 2.293x speedup, val set 1.533x speedup, step: 7
Epoch 25/300 |loss: 0.003497| train set 2.503x speedup, test set 1.209x speedup, val set 1.375x speedup, step: 8
Epoch 26/300 |loss: 0.003721| train set 2.463x speedup, test set 2.329x speedup, val set 1.375x speedup, step: 9
Epoch 27/300 |loss: 0.003257| train set 2.552x speedup, test set 1.232x speedup, val set 1.357x speedup, step: 10
Epoch 28/300 |loss: 0.003114| train set 2.323x speedup, test set 2.277x speedup, val set 1.331x speedup, step: 11
Epoch 29/300 |loss: 0.003208| train set 2.354x speedup, test set 2.304x speedup, val set 1.247x speedup, step: 12
Epoch 30/300 |loss: 0.003143| train set 2.574x speedup, test set 2.530x speedup, val set 1.357x speedup, step: 13
Epoch 31/300 |loss: 0.002912| train set 2.498x speedup, test set 2.419x speedup, val set 1.409x speedup, step: 14
Epoch 32/300 |loss: 0.002765| train set 2.499x speedup, test set 2.525x speedup, val set 1.522x speedup, step: 15
Epoch 33/300 |loss: 0.002879| train set 2.585x speedup, test set 2.583x speedup, val set 1.274x speedup, step: 16
Epoch 34/300 |loss: 0.002682| train set 2.508x speedup, test set 2.426x speedup, val set 1.369x speedup, step: 17
Epoch 35/300 |loss: 0.002481| train set 2.572x speedup, test set 2.055x speedup, val set 1.251x speedup, step: 18
Epoch 36/300 |loss: 0.002807| train set 2.649x speedup, test set 2.568x speedup, val set 1.366x speedup, step: 19
Epoch 37/300 |loss: 0.002573| train set 2.589x speedup, test set 2.411x speedup, val set 1.277x speedup, step: 20
Epoch 38/300 |loss: 0.002317| train set 2.604x speedup, test set 2.423x speedup, val set 1.318x speedup, step: 21
Epoch 39/300 |loss: 0.002142| train set 2.623x speedup, test set 2.366x speedup, val set 1.237x speedup, step: 22
Epoch 40/300 |loss: 0.002246| train set 2.537x speedup, test set 1.489x speedup, val set 1.320x speedup, step: 23
Epoch 41/300 |loss: 0.002640| train set 2.562x speedup, test set 2.279x speedup, val set 1.262x speedup, step: 24
Epoch 42/300 |loss: 0.002377| train set 2.696x speedup, test set 2.581x speedup, val set 1.354x speedup, step: 25
Epoch 43/300 |loss: 0.002266| train set 2.662x speedup, test set 2.431x speedup, val set 1.276x speedup, step: 26
Epoch 44/300 |loss: 0.002015| train set 2.406x speedup, test set 2.064x speedup, val set 1.329x speedup, step: 27
Epoch 45/300 |loss: 0.002483| train set 2.473x speedup, test set 2.066x speedup, val set 1.349x speedup, step: 28
Epoch 46/300 |loss: 0.001972| train set 2.591x speedup, test set 1.251x speedup, val set 1.875x speedup, step: 1
Epoch 47/300 |loss: 0.001807| train set 2.576x speedup, test set 1.704x speedup, val set 1.269x speedup, step: 2
Epoch 48/300 |loss: 0.001992| train set 2.659x speedup, test set 2.124x speedup, val set 1.320x speedup, step: 3
Epoch 49/300 |loss: 0.002404| train set 2.604x speedup, test set 0.967x speedup, val set 1.358x speedup, step: 4
Epoch 50/300 |loss: 0.002115| train set 2.620x speedup, test set 1.435x speedup, val set 1.734x speedup, step: 5
Epoch 51/300 |loss: 0.001957| train set 2.699x speedup, test set 1.475x speedup, val set 1.875x speedup, step: 1
Epoch 52/300 |loss: 0.001602| train set 2.698x speedup, test set 1.079x speedup, val set 1.837x speedup, step: 2
Epoch 53/300 |loss: 0.001603| train set 2.710x speedup, test set 1.651x speedup, val set 1.909x speedup, step: 1
Epoch 54/300 |loss: 0.001645| train set 2.654x speedup, test set 1.128x speedup, val set 1.358x speedup, step: 2
Epoch 55/300 |loss: 0.001511| train set 2.671x speedup, test set 1.552x speedup, val set 1.513x speedup, step: 3
Epoch 56/300 |loss: 0.001350| train set 2.578x speedup, test set 1.390x speedup, val set 1.358x speedup, step: 4
Epoch 57/300 |loss: 0.001419| train set 2.640x speedup, test set 1.076x speedup, val set 1.926x speedup, step: 1
Epoch 58/300 |loss: 0.001960| train set 2.632x speedup, test set 2.048x speedup, val set 1.927x speedup, step: 1
Epoch 59/300 |loss: 0.001370| train set 2.617x speedup, test set 2.262x speedup, val set 1.926x speedup, step: 2
Epoch 60/300 |loss: 0.001572| train set 2.542x speedup, test set 2.338x speedup, val set 1.358x speedup, step: 3
Epoch 61/300 |loss: 0.001649| train set 2.562x speedup, test set 1.120x speedup, val set 1.323x speedup, step: 4
Epoch 62/300 |loss: 0.001371| train set 2.718x speedup, test set 1.519x speedup, val set 1.904x speedup, step: 5
Epoch 63/300 |loss: 0.001111| train set 2.632x speedup, test set 1.523x speedup, val set 1.357x speedup, step: 6
Epoch 64/300 |loss: 0.001130| train set 2.557x speedup, test set 1.682x speedup, val set 1.357x speedup, step: 7
Epoch 65/300 |loss: 0.001613| train set 2.481x speedup, test set 1.394x speedup, val set 1.349x speedup, step: 8
Epoch 66/300 |loss: 0.001179| train set 2.670x speedup, test set 1.054x speedup, val set 1.366x speedup, step: 9
Epoch 67/300 |loss: 0.001317| train set 2.703x speedup, test set 0.976x speedup, val set 0.804x speedup, step: 10
Epoch 68/300 |loss: 0.001219| train set 2.741x speedup, test set 1.377x speedup, val set 1.358x speedup, step: 11
Epoch 69/300 |loss: 0.001061| train set 2.699x speedup, test set 1.060x speedup, val set 1.369x speedup, step: 12
Epoch 70/300 |loss: 0.001095| train set 2.747x speedup, test set 1.393x speedup, val set 1.370x speedup, step: 13
Epoch 71/300 |loss: 0.001257| train set 2.672x speedup, test set 1.508x speedup, val set 1.369x speedup, step: 14
Epoch 72/300 |loss: 0.000952| train set 2.687x speedup, test set 2.330x speedup, val set 1.369x speedup, step: 15
Epoch 73/300 |loss: 0.001336| train set 2.727x speedup, test set 2.134x speedup, val set 1.356x speedup, step: 16
Epoch 74/300 |loss: 0.001126| train set 2.715x speedup, test set 0.999x speedup, val set 1.381x speedup, step: 17
Epoch 75/300 |loss: 0.000856| train set 2.668x speedup, test set 1.057x speedup, val set 1.358x speedup, step: 18
Epoch 76/300 |loss: 0.000740| train set 2.633x speedup, test set 1.057x speedup, val set 1.077x speedup, step: 19
Epoch 77/300 |loss: 0.000808| train set 2.710x speedup, test set 1.049x speedup, val set 1.077x speedup, step: 20
Epoch 78/300 |loss: 0.000857| train set 2.661x speedup, test set 1.067x speedup, val set 1.070x speedup, step: 21
Epoch 79/300 |loss: 0.000791| train set 2.751x speedup, test set 1.083x speedup, val set 1.370x speedup, step: 22
Epoch 80/300 |loss: 0.000768| train set 2.706x speedup, test set 0.950x speedup, val set 1.369x speedup, step: 23
Epoch 81/300 |loss: 0.000923| train set 2.692x speedup, test set 1.067x speedup, val set 1.077x speedup, step: 24
Epoch 82/300 |loss: 0.001202| train set 2.577x speedup, test set 2.104x speedup, val set 1.065x speedup, step: 25
Epoch 83/300 |loss: 0.000803| train set 2.644x speedup, test set 2.294x speedup, val set 1.369x speedup, step: 26
Epoch 84/300 |loss: 0.000901| train set 2.733x speedup, test set 1.131x speedup, val set 1.361x speedup, step: 27
Epoch 85/300 |loss: 0.000725| train set 2.714x speedup, test set 1.131x speedup, val set 1.077x speedup, step: 28
Epoch 86/300 |loss: 0.000940| train set 2.779x speedup, test set 0.950x speedup, val set 1.078x speedup, step: 29
Epoch 87/300 |loss: 0.000754| train set 2.749x speedup, test set 2.076x speedup, val set 1.369x speedup, step: 30
Epoch 88/300 |loss: 0.000727| train set 2.748x speedup, test set 1.295x speedup, val set 1.078x speedup, step: 31
Epoch 89/300 |loss: 0.000704| train set 2.748x speedup, test set 0.950x speedup, val set 1.077x speedup, step: 32
Epoch 90/300 |loss: 0.000704| train set 2.658x speedup, test set 2.076x speedup, val set 1.078x speedup, step: 33
Epoch 91/300 |loss: 0.000644| train set 2.740x speedup, test set 2.048x speedup, val set 1.361x speedup, step: 34
Epoch 92/300 |loss: 0.001010| train set 2.660x speedup, test set 2.076x speedup, val set 1.077x speedup, step: 35
Epoch 93/300 |loss: 0.000840| train set 2.733x speedup, test set 1.067x speedup, val set 1.077x speedup, step: 36
Epoch 94/300 |loss: 0.000964| train set 2.753x speedup, test set 2.076x speedup, val set 1.349x speedup, step: 37
early stopping at epoch 94
Training per epoch cost 1.237 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 93.826s, pg runtime 92.131s, speedup 0.982x
04, opt runtime 29.502s, model runtime 110.289s, pg runtime 112.305s, speedup 1.018x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
12, opt runtime 25.043s, model runtime 60.927s, pg runtime 73.019s, speedup 1.198x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 41.483s, pg runtime 23.223s, speedup 0.560x
18, opt runtime 10.788s, model runtime 60.401s, pg runtime 32.939s, speedup 0.545x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
28, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 86, train speedup 2.779, test speedup 0.950, val speedup 1.078
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 58, train speedup 2.632, test speedup 2.048, val speedup 1.927
last model at epoch 94, train speedup 2.753, test speedup 2.076, val speedup 1.349
execution cost 0:02:53.303375
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.678187, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.355x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009283| train set 0.835x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008582| train set 0.878x speedup, test set 1.222x speedup, val set 0.937x speedup, step: 3
Epoch 7/300 |loss: 0.007974| train set 0.957x speedup, test set 1.201x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007392| train set 0.919x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007090| train set 0.988x speedup, test set 1.210x speedup, val set 1.350x speedup, step: 1
Epoch 10/300 |loss: 0.007072| train set 0.986x speedup, test set 1.210x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006121| train set 1.233x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005600| train set 0.994x speedup, test set 2.318x speedup, val set 0.925x speedup, step: 2
Epoch 13/300 |loss: 0.005737| train set 1.326x speedup, test set 1.205x speedup, val set 1.386x speedup, step: 1
Epoch 14/300 |loss: 0.005235| train set 1.329x speedup, test set 1.203x speedup, val set 1.353x speedup, step: 2
Epoch 15/300 |loss: 0.004977| train set 1.390x speedup, test set 1.203x speedup, val set 1.386x speedup, step: 1
Epoch 16/300 |loss: 0.004663| train set 1.363x speedup, test set 1.225x speedup, val set 1.530x speedup, step: 1
Epoch 17/300 |loss: 0.004470| train set 1.382x speedup, test set 1.225x speedup, val set 1.375x speedup, step: 2
Epoch 18/300 |loss: 0.004426| train set 2.481x speedup, test set 1.251x speedup, val set 1.522x speedup, step: 3
Epoch 19/300 |loss: 0.004220| train set 1.381x speedup, test set 2.422x speedup, val set 0.926x speedup, step: 4
Epoch 20/300 |loss: 0.004782| train set 2.346x speedup, test set 1.187x speedup, val set 1.352x speedup, step: 5
Epoch 21/300 |loss: 0.003820| train set 2.311x speedup, test set 1.251x speedup, val set 1.436x speedup, step: 6
Epoch 22/300 |loss: 0.003625| train set 2.440x speedup, test set 1.175x speedup, val set 1.355x speedup, step: 7
Epoch 23/300 |loss: 0.003906| train set 2.353x speedup, test set 1.228x speedup, val set 1.523x speedup, step: 8
Epoch 24/300 |loss: 0.004585| train set 2.402x speedup, test set 2.410x speedup, val set 1.375x speedup, step: 9
Epoch 25/300 |loss: 0.003777| train set 2.633x speedup, test set 1.225x speedup, val set 1.387x speedup, step: 10
Epoch 26/300 |loss: 0.003853| train set 2.450x speedup, test set 1.279x speedup, val set 1.387x speedup, step: 11
Epoch 27/300 |loss: 0.003237| train set 2.605x speedup, test set 1.246x speedup, val set 1.358x speedup, step: 12
Epoch 28/300 |loss: 0.003024| train set 2.543x speedup, test set 1.249x speedup, val set 1.316x speedup, step: 13
Epoch 29/300 |loss: 0.003133| train set 2.494x speedup, test set 1.254x speedup, val set 1.369x speedup, step: 14
Epoch 30/300 |loss: 0.003040| train set 2.547x speedup, test set 1.244x speedup, val set 1.349x speedup, step: 15
Epoch 31/300 |loss: 0.003157| train set 2.479x speedup, test set 1.255x speedup, val set 1.505x speedup, step: 16
Epoch 32/300 |loss: 0.002879| train set 2.543x speedup, test set 2.482x speedup, val set 1.522x speedup, step: 17
Epoch 33/300 |loss: 0.002809| train set 2.550x speedup, test set 2.190x speedup, val set 1.264x speedup, step: 18
Epoch 34/300 |loss: 0.002709| train set 2.447x speedup, test set 2.189x speedup, val set 1.409x speedup, step: 19
Epoch 35/300 |loss: 0.002594| train set 2.583x speedup, test set 2.471x speedup, val set 1.277x speedup, step: 20
Epoch 36/300 |loss: 0.002967| train set 2.611x speedup, test set 1.255x speedup, val set 1.394x speedup, step: 21
Epoch 37/300 |loss: 0.002699| train set 2.559x speedup, test set 1.278x speedup, val set 1.277x speedup, step: 22
Epoch 38/300 |loss: 0.002393| train set 2.598x speedup, test set 2.269x speedup, val set 1.264x speedup, step: 23
Epoch 39/300 |loss: 0.002363| train set 2.550x speedup, test set 2.168x speedup, val set 1.277x speedup, step: 24
Epoch 40/300 |loss: 0.002313| train set 2.657x speedup, test set 1.190x speedup, val set 1.237x speedup, step: 25
Epoch 41/300 |loss: 0.002461| train set 2.544x speedup, test set 1.160x speedup, val set 1.250x speedup, step: 26
Epoch 42/300 |loss: 0.002448| train set 2.662x speedup, test set 1.173x speedup, val set 1.323x speedup, step: 27
Epoch 43/300 |loss: 0.002652| train set 2.646x speedup, test set 1.125x speedup, val set 1.267x speedup, step: 28
Epoch 44/300 |loss: 0.002218| train set 2.620x speedup, test set 2.089x speedup, val set 1.267x speedup, step: 29
Epoch 45/300 |loss: 0.002658| train set 2.547x speedup, test set 2.123x speedup, val set 1.448x speedup, step: 30
Epoch 46/300 |loss: 0.002172| train set 2.558x speedup, test set 1.124x speedup, val set 1.251x speedup, step: 31
Epoch 47/300 |loss: 0.002062| train set 2.658x speedup, test set 1.981x speedup, val set 1.267x speedup, step: 32
Epoch 48/300 |loss: 0.002199| train set 2.540x speedup, test set 2.092x speedup, val set 1.260x speedup, step: 33
Epoch 49/300 |loss: 0.002265| train set 2.647x speedup, test set 1.201x speedup, val set 1.369x speedup, step: 34
Epoch 50/300 |loss: 0.001923| train set 2.618x speedup, test set 2.048x speedup, val set 1.277x speedup, step: 35
Epoch 51/300 |loss: 0.001928| train set 2.627x speedup, test set 2.205x speedup, val set 1.259x speedup, step: 36
Epoch 52/300 |loss: 0.001717| train set 2.721x speedup, test set 2.092x speedup, val set 1.251x speedup, step: 37
Epoch 53/300 |loss: 0.001596| train set 2.545x speedup, test set 1.171x speedup, val set 1.247x speedup, step: 38
Epoch 54/300 |loss: 0.001695| train set 2.671x speedup, test set 2.136x speedup, val set 1.237x speedup, step: 39
Epoch 55/300 |loss: 0.001893| train set 2.665x speedup, test set 2.105x speedup, val set 1.413x speedup, step: 40
Epoch 56/300 |loss: 0.001662| train set 2.650x speedup, test set 2.047x speedup, val set 1.335x speedup, step: 41
Epoch 57/300 |loss: 0.001487| train set 2.693x speedup, test set 1.103x speedup, val set 2.169x speedup, step: 1
Epoch 58/300 |loss: 0.001912| train set 2.597x speedup, test set 1.085x speedup, val set 1.484x speedup, step: 2
Epoch 59/300 |loss: 0.001459| train set 2.689x speedup, test set 2.105x speedup, val set 1.335x speedup, step: 3
Epoch 60/300 |loss: 0.001687| train set 2.581x speedup, test set 2.029x speedup, val set 1.247x speedup, step: 4
Epoch 61/300 |loss: 0.002216| train set 2.666x speedup, test set 0.937x speedup, val set 1.335x speedup, step: 5
Epoch 62/300 |loss: 0.001485| train set 2.712x speedup, test set 1.970x speedup, val set 1.323x speedup, step: 6
Epoch 63/300 |loss: 0.001242| train set 2.706x speedup, test set 1.973x speedup, val set 1.237x speedup, step: 7
Epoch 64/300 |loss: 0.001222| train set 2.606x speedup, test set 1.090x speedup, val set 1.698x speedup, step: 8
Epoch 65/300 |loss: 0.001445| train set 2.644x speedup, test set 2.088x speedup, val set 1.513x speedup, step: 9
Epoch 66/300 |loss: 0.001395| train set 2.680x speedup, test set 1.120x speedup, val set 1.230x speedup, step: 10
Epoch 67/300 |loss: 0.001782| train set 2.713x speedup, test set 1.491x speedup, val set 1.323x speedup, step: 11
Epoch 68/300 |loss: 0.001528| train set 2.748x speedup, test set 1.090x speedup, val set 1.865x speedup, step: 12
early stopping at epoch 68
Training per epoch cost 1.256 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 48.776s, pg runtime 23.223s, speedup 0.476x
18, opt runtime 10.788s, model runtime 56.246s, pg runtime 32.939s, speedup 0.586x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
28, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 786.481s, pg runtime 651.942s, speedup 0.829x
36, opt runtime 16.639s, model runtime 700.825s, pg runtime 462.544s, speedup 0.660x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 26.225s, pg runtime 0.912s, speedup 0.035x
40, opt runtime 0.873s, model runtime 23.911s, pg runtime 0.873s, speedup 0.036x
====================
best train speedup epoch: 68, train speedup 2.748, test speedup 1.090, val speedup 1.865
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.693, test speedup 1.103, val speedup 2.169
last model at epoch 68, train speedup 2.748, test speedup 1.090, val speedup 1.865
execution cost 0:02:10.107480
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.683882, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.355x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009284| train set 0.835x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008564| train set 0.877x speedup, test set 1.222x speedup, val set 0.925x speedup, step: 3
Epoch 7/300 |loss: 0.007990| train set 0.947x speedup, test set 1.216x speedup, val set 0.906x speedup, step: 4
Epoch 8/300 |loss: 0.007411| train set 0.918x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007096| train set 0.972x speedup, test set 1.210x speedup, val set 1.452x speedup, step: 1
Epoch 10/300 |loss: 0.007017| train set 0.956x speedup, test set 1.179x speedup, val set 0.900x speedup, step: 2
Epoch 11/300 |loss: 0.006084| train set 1.247x speedup, test set 1.203x speedup, val set 0.900x speedup, step: 3
Epoch 12/300 |loss: 0.005615| train set 0.816x speedup, test set 2.206x speedup, val set 0.934x speedup, step: 4
Epoch 13/300 |loss: 0.005771| train set 1.375x speedup, test set 1.203x speedup, val set 1.365x speedup, step: 5
Epoch 14/300 |loss: 0.005376| train set 1.405x speedup, test set 1.225x speedup, val set 1.386x speedup, step: 6
Epoch 15/300 |loss: 0.005116| train set 1.358x speedup, test set 1.203x speedup, val set 0.901x speedup, step: 7
Epoch 16/300 |loss: 0.004685| train set 1.362x speedup, test set 1.212x speedup, val set 1.371x speedup, step: 8
Epoch 17/300 |loss: 0.004439| train set 1.404x speedup, test set 1.203x speedup, val set 1.549x speedup, step: 1
Epoch 18/300 |loss: 0.004330| train set 2.194x speedup, test set 2.169x speedup, val set 1.623x speedup, step: 1
Epoch 19/300 |loss: 0.004255| train set 1.410x speedup, test set 2.258x speedup, val set 0.936x speedup, step: 2
Epoch 20/300 |loss: 0.004856| train set 2.172x speedup, test set 2.260x speedup, val set 1.388x speedup, step: 3
Epoch 21/300 |loss: 0.003736| train set 2.302x speedup, test set 1.232x speedup, val set 1.457x speedup, step: 4
Epoch 22/300 |loss: 0.003597| train set 2.391x speedup, test set 2.235x speedup, val set 0.928x speedup, step: 5
Epoch 23/300 |loss: 0.003792| train set 2.523x speedup, test set 2.490x speedup, val set 1.526x speedup, step: 6
Epoch 24/300 |loss: 0.004559| train set 2.544x speedup, test set 2.396x speedup, val set 1.413x speedup, step: 7
Epoch 25/300 |loss: 0.003694| train set 2.523x speedup, test set 2.332x speedup, val set 1.387x speedup, step: 8
Epoch 26/300 |loss: 0.003790| train set 2.523x speedup, test set 2.428x speedup, val set 1.388x speedup, step: 9
Epoch 27/300 |loss: 0.003212| train set 2.628x speedup, test set 2.062x speedup, val set 1.355x speedup, step: 10
Epoch 28/300 |loss: 0.003021| train set 2.529x speedup, test set 2.283x speedup, val set 1.316x speedup, step: 11
Epoch 29/300 |loss: 0.003074| train set 2.625x speedup, test set 2.259x speedup, val set 1.391x speedup, step: 12
Epoch 30/300 |loss: 0.002939| train set 2.561x speedup, test set 2.336x speedup, val set 1.348x speedup, step: 13
Epoch 31/300 |loss: 0.003048| train set 2.547x speedup, test set 2.271x speedup, val set 1.526x speedup, step: 14
Epoch 32/300 |loss: 0.002837| train set 2.512x speedup, test set 2.259x speedup, val set 1.369x speedup, step: 15
Epoch 33/300 |loss: 0.002855| train set 2.573x speedup, test set 2.282x speedup, val set 1.352x speedup, step: 16
Epoch 34/300 |loss: 0.002819| train set 2.542x speedup, test set 2.334x speedup, val set 1.259x speedup, step: 17
Epoch 35/300 |loss: 0.002522| train set 2.601x speedup, test set 2.428x speedup, val set 1.249x speedup, step: 18
Epoch 36/300 |loss: 0.002849| train set 2.561x speedup, test set 2.260x speedup, val set 1.259x speedup, step: 19
Epoch 37/300 |loss: 0.002532| train set 2.655x speedup, test set 2.338x speedup, val set 1.277x speedup, step: 20
Epoch 38/300 |loss: 0.002378| train set 2.660x speedup, test set 2.184x speedup, val set 1.262x speedup, step: 21
Epoch 39/300 |loss: 0.002173| train set 2.662x speedup, test set 2.428x speedup, val set 1.262x speedup, step: 22
Epoch 40/300 |loss: 0.002220| train set 2.584x speedup, test set 2.260x speedup, val set 1.259x speedup, step: 23
Epoch 41/300 |loss: 0.002769| train set 2.568x speedup, test set 2.339x speedup, val set 1.262x speedup, step: 24
Epoch 42/300 |loss: 0.002762| train set 2.697x speedup, test set 2.348x speedup, val set 1.262x speedup, step: 25
Epoch 43/300 |loss: 0.002488| train set 2.639x speedup, test set 2.084x speedup, val set 1.259x speedup, step: 26
Epoch 44/300 |loss: 0.002166| train set 2.527x speedup, test set 2.050x speedup, val set 1.262x speedup, step: 27
Epoch 45/300 |loss: 0.002310| train set 2.619x speedup, test set 2.185x speedup, val set 1.259x speedup, step: 28
Epoch 46/300 |loss: 0.002350| train set 2.576x speedup, test set 2.009x speedup, val set 1.273x speedup, step: 29
Epoch 47/300 |loss: 0.002069| train set 2.557x speedup, test set 2.339x speedup, val set 1.259x speedup, step: 30
Epoch 48/300 |loss: 0.002020| train set 2.589x speedup, test set 2.098x speedup, val set 1.275x speedup, step: 31
Epoch 49/300 |loss: 0.002015| train set 2.713x speedup, test set 2.083x speedup, val set 1.277x speedup, step: 32
Epoch 50/300 |loss: 0.001759| train set 2.682x speedup, test set 2.160x speedup, val set 1.277x speedup, step: 33
Epoch 51/300 |loss: 0.001728| train set 2.751x speedup, test set 2.217x speedup, val set 1.262x speedup, step: 34
Epoch 52/300 |loss: 0.001534| train set 2.729x speedup, test set 2.083x speedup, val set 1.277x speedup, step: 35
Epoch 53/300 |loss: 0.001453| train set 2.710x speedup, test set 2.083x speedup, val set 1.262x speedup, step: 36
Epoch 54/300 |loss: 0.001536| train set 2.623x speedup, test set 2.172x speedup, val set 1.245x speedup, step: 37
Epoch 55/300 |loss: 0.001665| train set 2.731x speedup, test set 1.993x speedup, val set 1.259x speedup, step: 38
Epoch 56/300 |loss: 0.001505| train set 2.635x speedup, test set 2.136x speedup, val set 1.413x speedup, step: 39
Epoch 57/300 |loss: 0.001520| train set 2.608x speedup, test set 2.032x speedup, val set 2.206x speedup, step: 1
Epoch 58/300 |loss: 0.002138| train set 2.620x speedup, test set 1.973x speedup, val set 1.413x speedup, step: 2
Epoch 59/300 |loss: 0.001585| train set 2.632x speedup, test set 1.994x speedup, val set 1.277x speedup, step: 3
Epoch 60/300 |loss: 0.001761| train set 2.578x speedup, test set 1.996x speedup, val set 1.274x speedup, step: 4
Epoch 61/300 |loss: 0.001890| train set 2.709x speedup, test set 1.966x speedup, val set 1.277x speedup, step: 5
early stopping at epoch 61
Training per epoch cost 1.266 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 6.460s, pg runtime 16.134s, speedup 2.498x
08, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
16, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
17, opt runtime 7.469s, model runtime 48.776s, pg runtime 23.223s, speedup 0.476x
18, opt runtime 10.788s, model runtime 56.246s, pg runtime 32.939s, speedup 0.586x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.333s, pg runtime 7.268s, speedup 0.991x
28, opt runtime 6.854s, model runtime 7.066s, pg runtime 6.854s, speedup 0.970x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 97.976s, pg runtime 11.120s, speedup 0.114x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 0.912s, model runtime 26.225s, pg runtime 0.912s, speedup 0.035x
40, opt runtime 0.873s, model runtime 23.911s, pg runtime 0.873s, speedup 0.036x
====================
best train speedup epoch: 51, train speedup 2.751, test speedup 2.217, val speedup 1.262
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.608, test speedup 2.032, val speedup 2.206
last model at epoch 61, train speedup 2.709, test speedup 1.966, val speedup 1.277
execution cost 0:01:56.794522
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.660014, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.355x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009284| train set 0.835x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008578| train set 0.880x speedup, test set 1.222x speedup, val set 1.013x speedup, step: 3
Epoch 7/300 |loss: 0.007990| train set 0.957x speedup, test set 1.201x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007410| train set 0.918x speedup, test set 1.229x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007062| train set 0.989x speedup, test set 1.210x speedup, val set 1.351x speedup, step: 1
Epoch 10/300 |loss: 0.007138| train set 0.972x speedup, test set 1.210x speedup, val set 0.777x speedup, step: 2
Epoch 11/300 |loss: 0.006226| train set 1.240x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005696| train set 1.001x speedup, test set 2.200x speedup, val set 0.934x speedup, step: 2
Epoch 13/300 |loss: 0.005676| train set 1.398x speedup, test set 2.320x speedup, val set 1.365x speedup, step: 3
Epoch 14/300 |loss: 0.005282| train set 1.431x speedup, test set 1.225x speedup, val set 0.906x speedup, step: 4
Epoch 15/300 |loss: 0.005079| train set 1.381x speedup, test set 1.203x speedup, val set 1.386x speedup, step: 1
Epoch 16/300 |loss: 0.004689| train set 1.361x speedup, test set 1.203x speedup, val set 1.530x speedup, step: 1
Epoch 17/300 |loss: 0.004413| train set 1.376x speedup, test set 2.320x speedup, val set 0.967x speedup, step: 2
Epoch 18/300 |loss: 0.004581| train set 2.580x speedup, test set 1.284x speedup, val set 1.522x speedup, step: 3
Epoch 19/300 |loss: 0.004414| train set 1.442x speedup, test set 2.400x speedup, val set 0.936x speedup, step: 4
Epoch 20/300 |loss: 0.004681| train set 2.201x speedup, test set 1.175x speedup, val set 1.387x speedup, step: 5
Epoch 21/300 |loss: 0.003728| train set 1.407x speedup, test set 1.175x speedup, val set 1.354x speedup, step: 6
Epoch 22/300 |loss: 0.003720| train set 2.352x speedup, test set 1.176x speedup, val set 1.372x speedup, step: 7
Epoch 23/300 |loss: 0.003939| train set 2.564x speedup, test set 2.466x speedup, val set 1.549x speedup, step: 1
Epoch 24/300 |loss: 0.004312| train set 2.490x speedup, test set 2.395x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003455| train set 2.487x speedup, test set 2.302x speedup, val set 1.635x speedup, step: 1
Epoch 26/300 |loss: 0.003435| train set 2.537x speedup, test set 2.073x speedup, val set 1.387x speedup, step: 2
Epoch 27/300 |loss: 0.003495| train set 2.358x speedup, test set 1.168x speedup, val set 1.375x speedup, step: 3
Epoch 28/300 |loss: 0.003080| train set 2.564x speedup, test set 2.182x speedup, val set 1.267x speedup, step: 4
Epoch 29/300 |loss: 0.003087| train set 2.527x speedup, test set 2.295x speedup, val set 1.511x speedup, step: 5
Epoch 30/300 |loss: 0.003126| train set 2.533x speedup, test set 2.083x speedup, val set 1.387x speedup, step: 6
Epoch 31/300 |loss: 0.003059| train set 2.459x speedup, test set 2.472x speedup, val set 1.549x speedup, step: 7
Epoch 32/300 |loss: 0.002802| train set 2.622x speedup, test set 2.530x speedup, val set 1.549x speedup, step: 8
Epoch 33/300 |loss: 0.002968| train set 2.566x speedup, test set 2.413x speedup, val set 1.391x speedup, step: 9
Epoch 34/300 |loss: 0.002670| train set 2.637x speedup, test set 2.527x speedup, val set 1.391x speedup, step: 10
Epoch 35/300 |loss: 0.002443| train set 2.446x speedup, test set 2.395x speedup, val set 1.251x speedup, step: 11
Epoch 36/300 |loss: 0.003029| train set 2.457x speedup, test set 2.622x speedup, val set 1.259x speedup, step: 12
Epoch 37/300 |loss: 0.002823| train set 2.435x speedup, test set 2.493x speedup, val set 1.262x speedup, step: 13
Epoch 38/300 |loss: 0.002453| train set 2.578x speedup, test set 2.216x speedup, val set 1.249x speedup, step: 14
Epoch 39/300 |loss: 0.002273| train set 2.583x speedup, test set 2.127x speedup, val set 1.262x speedup, step: 15
Epoch 40/300 |loss: 0.002237| train set 2.606x speedup, test set 1.324x speedup, val set 1.259x speedup, step: 16
Epoch 41/300 |loss: 0.002786| train set 2.465x speedup, test set 1.331x speedup, val set 1.401x speedup, step: 17
Epoch 42/300 |loss: 0.002744| train set 2.660x speedup, test set 2.159x speedup, val set 1.706x speedup, step: 1
Epoch 43/300 |loss: 0.002735| train set 2.685x speedup, test set 2.244x speedup, val set 1.267x speedup, step: 2
early stopping at epoch 43
Training per epoch cost 1.238 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
07, opt runtime 6.460s, model runtime 12.479s, pg runtime 16.134s, speedup 1.293x
08, opt runtime 6.284s, model runtime 13.017s, pg runtime 31.019s, speedup 2.383x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
18, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 44.857s, pg runtime 69.421s, speedup 1.548x
34, opt runtime 35.527s, model runtime 42.569s, pg runtime 71.730s, speedup 1.685x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 26.225s, pg runtime 0.912s, speedup 0.035x
40, opt runtime 0.873s, model runtime 23.911s, pg runtime 0.873s, speedup 0.036x
====================
best train speedup epoch: 43, train speedup 2.685, test speedup 2.244, val speedup 1.267
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 42, train speedup 2.660, test speedup 2.159, val speedup 1.706
last model at epoch 43, train speedup 2.685, test speedup 2.244, val speedup 1.267
execution cost 0:01:24.028651
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.704929, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009290| train set 0.831x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008610| train set 0.880x speedup, test set 0.860x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008034| train set 0.952x speedup, test set 1.216x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007376| train set 0.900x speedup, test set 1.238x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007052| train set 0.977x speedup, test set 1.210x speedup, val set 1.372x speedup, step: 1
Epoch 10/300 |loss: 0.007217| train set 0.958x speedup, test set 2.346x speedup, val set 0.934x speedup, step: 2
Epoch 11/300 |loss: 0.006463| train set 1.236x speedup, test set 1.225x speedup, val set 1.371x speedup, step: 3
Epoch 12/300 |loss: 0.005841| train set 0.798x speedup, test set 2.200x speedup, val set 0.926x speedup, step: 4
Epoch 13/300 |loss: 0.005818| train set 1.341x speedup, test set 1.203x speedup, val set 0.897x speedup, step: 5
Epoch 14/300 |loss: 0.005262| train set 1.268x speedup, test set 1.225x speedup, val set 0.891x speedup, step: 6
Epoch 15/300 |loss: 0.005139| train set 1.362x speedup, test set 1.194x speedup, val set 1.371x speedup, step: 7
Epoch 16/300 |loss: 0.004737| train set 1.374x speedup, test set 1.203x speedup, val set 1.549x speedup, step: 1
Epoch 17/300 |loss: 0.004476| train set 1.391x speedup, test set 1.249x speedup, val set 0.892x speedup, step: 2
Epoch 18/300 |loss: 0.004312| train set 2.482x speedup, test set 1.251x speedup, val set 1.522x speedup, step: 3
Epoch 19/300 |loss: 0.004594| train set 1.419x speedup, test set 2.370x speedup, val set 0.900x speedup, step: 4
Epoch 20/300 |loss: 0.004489| train set 2.352x speedup, test set 1.218x speedup, val set 0.936x speedup, step: 5
Epoch 21/300 |loss: 0.003888| train set 1.402x speedup, test set 1.249x speedup, val set 0.936x speedup, step: 6
Epoch 22/300 |loss: 0.003788| train set 2.210x speedup, test set 2.366x speedup, val set 0.935x speedup, step: 7
Epoch 23/300 |loss: 0.004329| train set 2.504x speedup, test set 1.229x speedup, val set 1.533x speedup, step: 8
Epoch 24/300 |loss: 0.004671| train set 2.540x speedup, test set 2.433x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003485| train set 2.478x speedup, test set 2.302x speedup, val set 1.456x speedup, step: 2
Epoch 26/300 |loss: 0.003527| train set 2.510x speedup, test set 2.223x speedup, val set 1.526x speedup, step: 3
Epoch 27/300 |loss: 0.003441| train set 2.596x speedup, test set 2.369x speedup, val set 1.357x speedup, step: 4
Epoch 28/300 |loss: 0.003102| train set 2.638x speedup, test set 2.437x speedup, val set 1.318x speedup, step: 5
Epoch 29/300 |loss: 0.003098| train set 2.580x speedup, test set 2.328x speedup, val set 1.391x speedup, step: 6
Epoch 30/300 |loss: 0.002968| train set 2.510x speedup, test set 2.427x speedup, val set 1.501x speedup, step: 7
Epoch 31/300 |loss: 0.003258| train set 2.575x speedup, test set 2.302x speedup, val set 1.549x speedup, step: 1
Epoch 32/300 |loss: 0.002870| train set 2.562x speedup, test set 2.104x speedup, val set 1.549x speedup, step: 1
Epoch 33/300 |loss: 0.003035| train set 2.534x speedup, test set 2.345x speedup, val set 1.391x speedup, step: 2
Epoch 34/300 |loss: 0.002748| train set 2.455x speedup, test set 2.442x speedup, val set 1.391x speedup, step: 3
Epoch 35/300 |loss: 0.002572| train set 2.420x speedup, test set 2.285x speedup, val set 1.251x speedup, step: 4
Epoch 36/300 |loss: 0.002723| train set 2.535x speedup, test set 2.261x speedup, val set 1.251x speedup, step: 5
Epoch 37/300 |loss: 0.002577| train set 2.520x speedup, test set 2.174x speedup, val set 1.394x speedup, step: 6
Epoch 38/300 |loss: 0.002247| train set 2.680x speedup, test set 2.246x speedup, val set 1.251x speedup, step: 7
Epoch 39/300 |loss: 0.002259| train set 2.506x speedup, test set 2.082x speedup, val set 1.247x speedup, step: 8
Epoch 40/300 |loss: 0.002399| train set 2.584x speedup, test set 2.082x speedup, val set 1.701x speedup, step: 1
Epoch 41/300 |loss: 0.002477| train set 2.461x speedup, test set 2.082x speedup, val set 1.262x speedup, step: 2
Epoch 42/300 |loss: 0.002653| train set 2.698x speedup, test set 2.082x speedup, val set 1.340x speedup, step: 3
Epoch 43/300 |loss: 0.002527| train set 2.646x speedup, test set 2.054x speedup, val set 1.397x speedup, step: 4
Epoch 44/300 |loss: 0.002336| train set 2.623x speedup, test set 2.223x speedup, val set 1.693x speedup, step: 5
Epoch 45/300 |loss: 0.002445| train set 2.462x speedup, test set 2.149x speedup, val set 1.428x speedup, step: 6
Epoch 46/300 |loss: 0.001922| train set 2.460x speedup, test set 2.148x speedup, val set 1.340x speedup, step: 7
Epoch 47/300 |loss: 0.001853| train set 2.657x speedup, test set 1.172x speedup, val set 1.259x speedup, step: 8
Epoch 48/300 |loss: 0.002061| train set 2.674x speedup, test set 2.058x speedup, val set 1.350x speedup, step: 9
Epoch 49/300 |loss: 0.002235| train set 2.615x speedup, test set 1.147x speedup, val set 1.748x speedup, step: 1
Epoch 50/300 |loss: 0.002060| train set 2.536x speedup, test set 2.105x speedup, val set 1.260x speedup, step: 2
Epoch 51/300 |loss: 0.001809| train set 2.510x speedup, test set 2.020x speedup, val set 1.245x speedup, step: 3
Epoch 52/300 |loss: 0.001550| train set 2.700x speedup, test set 2.107x speedup, val set 1.706x speedup, step: 4
Epoch 53/300 |loss: 0.001584| train set 2.708x speedup, test set 1.161x speedup, val set 1.791x speedup, step: 1
Epoch 54/300 |loss: 0.001598| train set 2.259x speedup, test set 1.970x speedup, val set 1.358x speedup, step: 2
Epoch 55/300 |loss: 0.002472| train set 2.637x speedup, test set 2.173x speedup, val set 1.409x speedup, step: 3
Epoch 56/300 |loss: 0.001575| train set 2.581x speedup, test set 1.121x speedup, val set 1.349x speedup, step: 4
Epoch 57/300 |loss: 0.001426| train set 2.614x speedup, test set 1.137x speedup, val set 1.735x speedup, step: 5
Epoch 58/300 |loss: 0.001889| train set 2.636x speedup, test set 2.060x speedup, val set 1.698x speedup, step: 6
Epoch 59/300 |loss: 0.001442| train set 2.622x speedup, test set 1.114x speedup, val set 1.693x speedup, step: 7
Epoch 60/300 |loss: 0.001549| train set 2.631x speedup, test set 2.094x speedup, val set 1.903x speedup, step: 1
Epoch 61/300 |loss: 0.001555| train set 2.690x speedup, test set 1.116x speedup, val set 1.267x speedup, step: 2
Epoch 62/300 |loss: 0.001264| train set 2.681x speedup, test set 1.133x speedup, val set 1.312x speedup, step: 3
Epoch 63/300 |loss: 0.001088| train set 2.667x speedup, test set 2.049x speedup, val set 1.259x speedup, step: 4
Epoch 64/300 |loss: 0.001090| train set 2.646x speedup, test set 1.138x speedup, val set 1.267x speedup, step: 5
Epoch 65/300 |loss: 0.001342| train set 2.568x speedup, test set 1.126x speedup, val set 1.346x speedup, step: 6
Epoch 66/300 |loss: 0.001247| train set 2.675x speedup, test set 1.954x speedup, val set 1.350x speedup, step: 7
Epoch 67/300 |loss: 0.001385| train set 2.714x speedup, test set 1.156x speedup, val set 1.434x speedup, step: 8
Epoch 68/300 |loss: 0.001298| train set 2.721x speedup, test set 1.149x speedup, val set 1.370x speedup, step: 9
Epoch 69/300 |loss: 0.001130| train set 2.694x speedup, test set 1.126x speedup, val set 1.350x speedup, step: 10
Epoch 70/300 |loss: 0.000865| train set 2.733x speedup, test set 2.058x speedup, val set 1.350x speedup, step: 11
Epoch 71/300 |loss: 0.000885| train set 2.676x speedup, test set 2.110x speedup, val set 1.370x speedup, step: 12
Epoch 72/300 |loss: 0.001225| train set 2.705x speedup, test set 2.069x speedup, val set 1.350x speedup, step: 13
Epoch 73/300 |loss: 0.001470| train set 2.671x speedup, test set 1.151x speedup, val set 1.347x speedup, step: 14
early stopping at epoch 73
Training per epoch cost 1.254 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 41.483s, pg runtime 23.223s, speedup 0.560x
18, opt runtime 10.788s, model runtime 60.401s, pg runtime 32.939s, speedup 0.545x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 29.334s, pg runtime 22.482s, speedup 0.766x
22, opt runtime 6.519s, model runtime 14.361s, pg runtime 6.519s, speedup 0.454x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
28, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 44.857s, pg runtime 69.421s, speedup 1.548x
34, opt runtime 35.527s, model runtime 42.569s, pg runtime 71.730s, speedup 1.685x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 70.189s, pg runtime 11.120s, speedup 0.158x
38, opt runtime 18.262s, model runtime 68.157s, pg runtime 18.262s, speedup 0.268x
39, opt runtime 0.912s, model runtime 26.225s, pg runtime 0.912s, speedup 0.035x
40, opt runtime 0.873s, model runtime 23.911s, pg runtime 0.873s, speedup 0.036x
====================
best train speedup epoch: 70, train speedup 2.733, test speedup 2.058, val speedup 1.350
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 60, train speedup 2.631, test speedup 2.094, val speedup 1.903
last model at epoch 73, train speedup 2.671, test speedup 1.151, val speedup 1.347
execution cost 0:02:15.948819
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.685882, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009284| train set 0.831x speedup, test set 1.263x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008581| train set 0.880x speedup, test set 0.860x speedup, val set 0.936x speedup, step: 3
Epoch 7/300 |loss: 0.008029| train set 0.946x speedup, test set 1.214x speedup, val set 0.914x speedup, step: 4
Epoch 8/300 |loss: 0.007385| train set 0.923x speedup, test set 1.216x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007079| train set 0.974x speedup, test set 1.207x speedup, val set 1.351x speedup, step: 1
Epoch 10/300 |loss: 0.007130| train set 0.950x speedup, test set 2.346x speedup, val set 0.934x speedup, step: 2
Epoch 11/300 |loss: 0.006313| train set 1.228x speedup, test set 1.203x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005728| train set 0.933x speedup, test set 2.206x speedup, val set 0.934x speedup, step: 2
Epoch 13/300 |loss: 0.005693| train set 1.334x speedup, test set 2.318x speedup, val set 1.354x speedup, step: 3
Epoch 14/300 |loss: 0.005275| train set 1.324x speedup, test set 1.210x speedup, val set 0.906x speedup, step: 4
Epoch 15/300 |loss: 0.005024| train set 1.389x speedup, test set 1.210x speedup, val set 0.906x speedup, step: 5
Epoch 16/300 |loss: 0.004717| train set 1.369x speedup, test set 1.210x speedup, val set 1.530x speedup, step: 1
Epoch 17/300 |loss: 0.004548| train set 1.389x speedup, test set 1.203x speedup, val set 0.901x speedup, step: 2
Epoch 18/300 |loss: 0.004536| train set 2.513x speedup, test set 2.505x speedup, val set 1.523x speedup, step: 3
Epoch 19/300 |loss: 0.004366| train set 1.458x speedup, test set 2.264x speedup, val set 0.934x speedup, step: 4
Epoch 20/300 |loss: 0.004723| train set 2.167x speedup, test set 2.268x speedup, val set 0.901x speedup, step: 5
Epoch 21/300 |loss: 0.003956| train set 1.422x speedup, test set 1.194x speedup, val set 0.928x speedup, step: 6
Epoch 22/300 |loss: 0.003786| train set 2.344x speedup, test set 2.140x speedup, val set 0.802x speedup, step: 7
Epoch 23/300 |loss: 0.003844| train set 2.492x speedup, test set 1.201x speedup, val set 1.508x speedup, step: 8
Epoch 24/300 |loss: 0.004601| train set 2.341x speedup, test set 2.327x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003724| train set 2.532x speedup, test set 1.217x speedup, val set 1.533x speedup, step: 2
Epoch 26/300 |loss: 0.003612| train set 2.621x speedup, test set 1.189x speedup, val set 1.357x speedup, step: 3
Epoch 27/300 |loss: 0.003582| train set 2.581x speedup, test set 1.177x speedup, val set 1.354x speedup, step: 4
Epoch 28/300 |loss: 0.003325| train set 2.617x speedup, test set 2.134x speedup, val set 1.276x speedup, step: 5
Epoch 29/300 |loss: 0.003239| train set 2.548x speedup, test set 1.175x speedup, val set 1.353x speedup, step: 6
Epoch 30/300 |loss: 0.003060| train set 2.566x speedup, test set 2.195x speedup, val set 1.349x speedup, step: 7
Epoch 31/300 |loss: 0.003118| train set 2.555x speedup, test set 1.193x speedup, val set 1.549x speedup, step: 1
Epoch 32/300 |loss: 0.002869| train set 2.369x speedup, test set 1.165x speedup, val set 1.549x speedup, step: 2
Epoch 33/300 |loss: 0.003091| train set 2.580x speedup, test set 1.159x speedup, val set 1.346x speedup, step: 3
Epoch 34/300 |loss: 0.002801| train set 2.654x speedup, test set 1.164x speedup, val set 1.354x speedup, step: 4
Epoch 35/300 |loss: 0.002585| train set 2.507x speedup, test set 2.298x speedup, val set 0.847x speedup, step: 5
Epoch 36/300 |loss: 0.002842| train set 2.626x speedup, test set 1.257x speedup, val set 1.391x speedup, step: 6
Epoch 37/300 |loss: 0.002611| train set 2.704x speedup, test set 1.208x speedup, val set 1.394x speedup, step: 7
Epoch 38/300 |loss: 0.002535| train set 2.565x speedup, test set 1.150x speedup, val set 1.249x speedup, step: 8
Epoch 39/300 |loss: 0.002461| train set 2.612x speedup, test set 1.135x speedup, val set 1.278x speedup, step: 9
Epoch 40/300 |loss: 0.002422| train set 2.560x speedup, test set 1.125x speedup, val set 1.251x speedup, step: 10
Epoch 41/300 |loss: 0.002713| train set 2.537x speedup, test set 2.114x speedup, val set 1.260x speedup, step: 11
Epoch 42/300 |loss: 0.002805| train set 2.757x speedup, test set 2.078x speedup, val set 1.366x speedup, step: 12
Epoch 43/300 |loss: 0.002783| train set 2.612x speedup, test set 1.297x speedup, val set 1.264x speedup, step: 13
Epoch 44/300 |loss: 0.002413| train set 2.448x speedup, test set 1.142x speedup, val set 1.277x speedup, step: 14
Epoch 45/300 |loss: 0.002709| train set 2.291x speedup, test set 2.035x speedup, val set 0.931x speedup, step: 15
Epoch 46/300 |loss: 0.002388| train set 2.505x speedup, test set 1.106x speedup, val set 1.366x speedup, step: 16
Epoch 47/300 |loss: 0.002230| train set 2.529x speedup, test set 1.100x speedup, val set 1.267x speedup, step: 17
Epoch 48/300 |loss: 0.002444| train set 2.595x speedup, test set 2.103x speedup, val set 1.260x speedup, step: 18
Epoch 49/300 |loss: 0.002639| train set 2.642x speedup, test set 1.122x speedup, val set 1.275x speedup, step: 19
early stopping at epoch 49
Training per epoch cost 1.246 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
16, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
17, opt runtime 7.469s, model runtime 23.223s, pg runtime 23.223s, speedup 1.000x
18, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
19, opt runtime 1.148s, model runtime 1.360s, pg runtime 1.214s, speedup 0.892x
20, opt runtime 1.353s, model runtime 1.610s, pg runtime 1.380s, speedup 0.858x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 69.421s, pg runtime 69.421s, speedup 1.000x
34, opt runtime 35.527s, model runtime 71.730s, pg runtime 71.730s, speedup 1.000x
35, opt runtime 18.690s, model runtime 786.481s, pg runtime 651.942s, speedup 0.829x
36, opt runtime 16.639s, model runtime 700.825s, pg runtime 462.544s, speedup 0.660x
37, opt runtime 11.120s, model runtime 70.189s, pg runtime 11.120s, speedup 0.158x
38, opt runtime 18.262s, model runtime 68.157s, pg runtime 18.262s, speedup 0.268x
39, opt runtime 0.912s, model runtime 0.912s, pg runtime 0.912s, speedup 1.000x
40, opt runtime 0.873s, model runtime 0.873s, pg runtime 0.873s, speedup 1.000x
====================
best train speedup epoch: 42, train speedup 2.757, test speedup 2.078, val speedup 1.366
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 31, train speedup 2.555, test speedup 1.193, val speedup 1.549
last model at epoch 49, train speedup 2.642, test speedup 1.122, val speedup 1.275
execution cost 0:01:34.338846
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.695517, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009289| train set 0.831x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008604| train set 0.879x speedup, test set 0.860x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008043| train set 0.955x speedup, test set 1.216x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007385| train set 0.924x speedup, test set 1.216x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007076| train set 0.973x speedup, test set 1.214x speedup, val set 1.351x speedup, step: 1
Epoch 10/300 |loss: 0.007117| train set 0.955x speedup, test set 2.231x speedup, val set 0.933x speedup, step: 2
Epoch 11/300 |loss: 0.006260| train set 1.257x speedup, test set 1.216x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005701| train set 0.966x speedup, test set 2.231x speedup, val set 0.925x speedup, step: 2
Epoch 13/300 |loss: 0.005631| train set 1.328x speedup, test set 2.318x speedup, val set 1.509x speedup, step: 1
Epoch 14/300 |loss: 0.005354| train set 1.314x speedup, test set 1.203x speedup, val set 0.907x speedup, step: 2
Epoch 15/300 |loss: 0.005028| train set 1.366x speedup, test set 1.189x speedup, val set 0.900x speedup, step: 3
Epoch 16/300 |loss: 0.004815| train set 1.370x speedup, test set 1.203x speedup, val set 1.522x speedup, step: 1
Epoch 17/300 |loss: 0.004585| train set 1.387x speedup, test set 1.213x speedup, val set 0.901x speedup, step: 2
Epoch 18/300 |loss: 0.004420| train set 2.459x speedup, test set 2.318x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.004167| train set 1.360x speedup, test set 2.284x speedup, val set 0.900x speedup, step: 2
Epoch 20/300 |loss: 0.004739| train set 2.008x speedup, test set 2.250x speedup, val set 0.935x speedup, step: 3
Epoch 21/300 |loss: 0.003920| train set 1.433x speedup, test set 1.209x speedup, val set 1.457x speedup, step: 4
Epoch 22/300 |loss: 0.003600| train set 2.022x speedup, test set 2.260x speedup, val set 0.927x speedup, step: 5
Epoch 23/300 |loss: 0.004063| train set 2.471x speedup, test set 2.260x speedup, val set 1.533x speedup, step: 6
Epoch 24/300 |loss: 0.004364| train set 2.379x speedup, test set 2.266x speedup, val set 1.388x speedup, step: 7
Epoch 25/300 |loss: 0.003379| train set 2.562x speedup, test set 2.259x speedup, val set 1.456x speedup, step: 8
Epoch 26/300 |loss: 0.003227| train set 2.431x speedup, test set 2.259x speedup, val set 1.355x speedup, step: 9
Epoch 27/300 |loss: 0.003454| train set 2.500x speedup, test set 2.197x speedup, val set 1.313x speedup, step: 10
Epoch 28/300 |loss: 0.003017| train set 2.442x speedup, test set 2.268x speedup, val set 1.313x speedup, step: 11
Epoch 29/300 |loss: 0.003037| train set 2.317x speedup, test set 2.294x speedup, val set 1.249x speedup, step: 12
Epoch 30/300 |loss: 0.002965| train set 2.454x speedup, test set 2.143x speedup, val set 1.249x speedup, step: 13
Epoch 31/300 |loss: 0.003025| train set 2.613x speedup, test set 2.305x speedup, val set 1.549x speedup, step: 1
Epoch 32/300 |loss: 0.002786| train set 2.342x speedup, test set 2.331x speedup, val set 1.264x speedup, step: 2
Epoch 33/300 |loss: 0.002895| train set 2.479x speedup, test set 2.270x speedup, val set 1.262x speedup, step: 3
Epoch 34/300 |loss: 0.002647| train set 2.543x speedup, test set 2.174x speedup, val set 1.274x speedup, step: 4
Epoch 35/300 |loss: 0.002438| train set 2.561x speedup, test set 2.146x speedup, val set 1.249x speedup, step: 5
Epoch 36/300 |loss: 0.002694| train set 2.442x speedup, test set 2.514x speedup, val set 1.274x speedup, step: 6
Epoch 37/300 |loss: 0.002570| train set 2.561x speedup, test set 2.145x speedup, val set 1.264x speedup, step: 7
Epoch 38/300 |loss: 0.002161| train set 2.645x speedup, test set 2.146x speedup, val set 1.264x speedup, step: 8
Epoch 39/300 |loss: 0.002140| train set 2.598x speedup, test set 2.118x speedup, val set 1.754x speedup, step: 1
Epoch 40/300 |loss: 0.002264| train set 2.588x speedup, test set 2.053x speedup, val set 1.729x speedup, step: 2
Epoch 41/300 |loss: 0.002894| train set 2.541x speedup, test set 2.048x speedup, val set 1.754x speedup, step: 1
Epoch 42/300 |loss: 0.002452| train set 2.679x speedup, test set 2.053x speedup, val set 1.729x speedup, step: 2
Epoch 43/300 |loss: 0.002492| train set 2.614x speedup, test set 2.007x speedup, val set 1.749x speedup, step: 3
Epoch 44/300 |loss: 0.002096| train set 2.606x speedup, test set 2.168x speedup, val set 1.729x speedup, step: 4
Epoch 45/300 |loss: 0.002331| train set 2.344x speedup, test set 2.042x speedup, val set 1.335x speedup, step: 5
Epoch 46/300 |loss: 0.002266| train set 2.669x speedup, test set 1.984x speedup, val set 1.860x speedup, step: 1
Epoch 47/300 |loss: 0.002032| train set 2.505x speedup, test set 2.332x speedup, val set 1.754x speedup, step: 2
Epoch 48/300 |loss: 0.002141| train set 2.582x speedup, test set 1.952x speedup, val set 1.264x speedup, step: 3
Epoch 49/300 |loss: 0.001844| train set 2.549x speedup, test set 1.669x speedup, val set 1.754x speedup, step: 4
Epoch 50/300 |loss: 0.001736| train set 2.634x speedup, test set 2.453x speedup, val set 1.754x speedup, step: 5
Epoch 51/300 |loss: 0.001716| train set 2.574x speedup, test set 1.994x speedup, val set 1.734x speedup, step: 6
Epoch 52/300 |loss: 0.001534| train set 2.715x speedup, test set 1.454x speedup, val set 1.734x speedup, step: 7
Epoch 53/300 |loss: 0.001525| train set 2.616x speedup, test set 2.311x speedup, val set 1.754x speedup, step: 8
Epoch 54/300 |loss: 0.001471| train set 2.565x speedup, test set 1.544x speedup, val set 1.267x speedup, step: 9
Epoch 55/300 |loss: 0.001530| train set 2.722x speedup, test set 2.053x speedup, val set 1.755x speedup, step: 10
Epoch 56/300 |loss: 0.001370| train set 2.585x speedup, test set 1.994x speedup, val set 1.260x speedup, step: 11
Epoch 57/300 |loss: 0.001389| train set 2.587x speedup, test set 1.572x speedup, val set 1.750x speedup, step: 12
Epoch 58/300 |loss: 0.001851| train set 2.621x speedup, test set 1.493x speedup, val set 1.755x speedup, step: 13
Epoch 59/300 |loss: 0.001322| train set 2.614x speedup, test set 2.048x speedup, val set 1.750x speedup, step: 14
Epoch 60/300 |loss: 0.001661| train set 2.605x speedup, test set 1.486x speedup, val set 1.755x speedup, step: 15
Epoch 61/300 |loss: 0.001728| train set 2.535x speedup, test set 1.564x speedup, val set 1.755x speedup, step: 16
early stopping at epoch 61
Training per epoch cost 1.261 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
12, opt runtime 25.043s, model runtime 60.927s, pg runtime 73.019s, speedup 1.198x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
16, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
17, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
18, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.333s, pg runtime 7.268s, speedup 0.991x
28, opt runtime 6.854s, model runtime 7.066s, pg runtime 6.854s, speedup 0.970x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 68.830s, pg runtime 69.421s, speedup 1.009x
34, opt runtime 35.527s, model runtime 71.899s, pg runtime 71.730s, speedup 0.998x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 102.048s, pg runtime 11.120s, speedup 0.109x
38, opt runtime 18.262s, model runtime 105.582s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 0.912s, pg runtime 0.912s, speedup 1.000x
40, opt runtime 0.873s, model runtime 0.873s, pg runtime 0.873s, speedup 1.000x
====================
best train speedup epoch: 55, train speedup 2.722, test speedup 2.053, val speedup 1.755
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 46, train speedup 2.669, test speedup 1.984, val speedup 1.860
last model at epoch 61, train speedup 2.535, test speedup 1.564, val speedup 1.755
execution cost 0:01:57.016076
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.668415, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009289| train set 0.831x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008602| train set 0.879x speedup, test set 0.871x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008036| train set 0.957x speedup, test set 1.201x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007382| train set 0.931x speedup, test set 1.216x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007059| train set 0.973x speedup, test set 1.210x speedup, val set 1.429x speedup, step: 1
Epoch 10/300 |loss: 0.007151| train set 0.946x speedup, test set 2.346x speedup, val set 0.933x speedup, step: 2
Epoch 11/300 |loss: 0.006323| train set 1.236x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 3
Epoch 12/300 |loss: 0.005787| train set 0.962x speedup, test set 2.225x speedup, val set 0.929x speedup, step: 4
Epoch 13/300 |loss: 0.005775| train set 1.327x speedup, test set 2.345x speedup, val set 1.354x speedup, step: 5
Epoch 14/300 |loss: 0.005357| train set 1.323x speedup, test set 1.203x speedup, val set 0.897x speedup, step: 6
Epoch 15/300 |loss: 0.005366| train set 1.349x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 7
Epoch 16/300 |loss: 0.005745| train set 2.157x speedup, test set 1.203x speedup, val set 1.509x speedup, step: 1
Epoch 17/300 |loss: 0.004933| train set 1.272x speedup, test set 1.157x speedup, val set 0.808x speedup, step: 2
Epoch 18/300 |loss: 0.004396| train set 2.249x speedup, test set 1.210x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.005199| train set 1.299x speedup, test set 1.225x speedup, val set 0.801x speedup, step: 2
Epoch 20/300 |loss: 0.004965| train set 2.456x speedup, test set 1.225x speedup, val set 1.374x speedup, step: 3
Epoch 21/300 |loss: 0.003935| train set 1.387x speedup, test set 2.402x speedup, val set 0.923x speedup, step: 4
Epoch 22/300 |loss: 0.003773| train set 1.382x speedup, test set 2.396x speedup, val set 1.409x speedup, step: 5
Epoch 23/300 |loss: 0.004215| train set 2.442x speedup, test set 1.410x speedup, val set 1.433x speedup, step: 6
Epoch 24/300 |loss: 0.004516| train set 2.242x speedup, test set 2.336x speedup, val set 0.926x speedup, step: 7
Epoch 25/300 |loss: 0.003526| train set 2.493x speedup, test set 1.221x speedup, val set 1.533x speedup, step: 8
Epoch 26/300 |loss: 0.003624| train set 2.480x speedup, test set 2.354x speedup, val set 1.508x speedup, step: 9
Epoch 27/300 |loss: 0.003152| train set 2.551x speedup, test set 2.327x speedup, val set 1.375x speedup, step: 10
Epoch 28/300 |loss: 0.003053| train set 2.537x speedup, test set 2.524x speedup, val set 1.397x speedup, step: 11
Epoch 29/300 |loss: 0.003084| train set 2.591x speedup, test set 2.422x speedup, val set 1.357x speedup, step: 12
Epoch 30/300 |loss: 0.003097| train set 2.591x speedup, test set 2.431x speedup, val set 1.346x speedup, step: 13
Epoch 31/300 |loss: 0.003079| train set 2.589x speedup, test set 2.555x speedup, val set 1.397x speedup, step: 14
Epoch 32/300 |loss: 0.002843| train set 2.488x speedup, test set 2.555x speedup, val set 1.522x speedup, step: 15
Epoch 33/300 |loss: 0.002881| train set 2.576x speedup, test set 2.524x speedup, val set 1.508x speedup, step: 16
Epoch 34/300 |loss: 0.002856| train set 2.687x speedup, test set 2.619x speedup, val set 1.486x speedup, step: 17
Epoch 35/300 |loss: 0.002481| train set 2.631x speedup, test set 2.524x speedup, val set 1.357x speedup, step: 18
Epoch 36/300 |loss: 0.002947| train set 2.661x speedup, test set 2.448x speedup, val set 1.362x speedup, step: 19
Epoch 37/300 |loss: 0.002663| train set 2.610x speedup, test set 1.457x speedup, val set 1.235x speedup, step: 20
Epoch 38/300 |loss: 0.002482| train set 2.614x speedup, test set 2.707x speedup, val set 1.355x speedup, step: 21
Epoch 39/300 |loss: 0.002407| train set 2.606x speedup, test set 2.548x speedup, val set 1.389x speedup, step: 22
Epoch 40/300 |loss: 0.002382| train set 2.634x speedup, test set 1.248x speedup, val set 1.508x speedup, step: 23
Epoch 41/300 |loss: 0.002823| train set 2.580x speedup, test set 2.427x speedup, val set 1.983x speedup, step: 1
Epoch 42/300 |loss: 0.002615| train set 2.724x speedup, test set 2.530x speedup, val set 1.378x speedup, step: 2
Epoch 43/300 |loss: 0.002597| train set 2.704x speedup, test set 1.414x speedup, val set 1.397x speedup, step: 3
Epoch 44/300 |loss: 0.002306| train set 2.645x speedup, test set 2.053x speedup, val set 1.512x speedup, step: 4
Epoch 45/300 |loss: 0.002447| train set 2.489x speedup, test set 2.142x speedup, val set 1.512x speedup, step: 5
Epoch 46/300 |loss: 0.002269| train set 2.580x speedup, test set 1.365x speedup, val set 1.995x speedup, step: 1
Epoch 47/300 |loss: 0.002039| train set 2.609x speedup, test set 2.351x speedup, val set 1.389x speedup, step: 2
Epoch 48/300 |loss: 0.002146| train set 2.577x speedup, test set 1.376x speedup, val set 1.494x speedup, step: 3
Epoch 49/300 |loss: 0.002137| train set 2.639x speedup, test set 1.358x speedup, val set 1.401x speedup, step: 4
Epoch 50/300 |loss: 0.001820| train set 2.617x speedup, test set 2.382x speedup, val set 1.997x speedup, step: 1
Epoch 51/300 |loss: 0.001768| train set 2.568x speedup, test set 2.297x speedup, val set 1.389x speedup, step: 2
Epoch 52/300 |loss: 0.001538| train set 2.655x speedup, test set 1.128x speedup, val set 1.997x speedup, step: 1
Epoch 53/300 |loss: 0.001559| train set 2.702x speedup, test set 2.358x speedup, val set 1.401x speedup, step: 2
Epoch 54/300 |loss: 0.001541| train set 2.459x speedup, test set 1.704x speedup, val set 1.386x speedup, step: 3
Epoch 55/300 |loss: 0.002093| train set 2.680x speedup, test set 1.402x speedup, val set 2.021x speedup, step: 1
Epoch 56/300 |loss: 0.001637| train set 2.591x speedup, test set 1.312x speedup, val set 1.400x speedup, step: 2
Epoch 57/300 |loss: 0.001426| train set 2.745x speedup, test set 1.377x speedup, val set 2.264x speedup, step: 1
Epoch 58/300 |loss: 0.001809| train set 2.627x speedup, test set 2.273x speedup, val set 1.946x speedup, step: 2
Epoch 59/300 |loss: 0.001472| train set 2.641x speedup, test set 1.400x speedup, val set 2.201x speedup, step: 3
Epoch 60/300 |loss: 0.001688| train set 2.642x speedup, test set 1.240x speedup, val set 2.021x speedup, step: 4
Epoch 61/300 |loss: 0.002090| train set 2.708x speedup, test set 1.258x speedup, val set 1.400x speedup, step: 5
early stopping at epoch 61
Training per epoch cost 1.254 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
08, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
12, opt runtime 25.043s, model runtime 60.927s, pg runtime 73.019s, speedup 1.198x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 45.251s, pg runtime 23.223s, speedup 0.513x
18, opt runtime 10.788s, model runtime 48.407s, pg runtime 32.939s, speedup 0.680x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.353s, model runtime 1.462s, pg runtime 1.380s, speedup 0.944x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 5.961s, model runtime 11.695s, pg runtime 31.210s, speedup 2.669x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
28, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 69.421s, pg runtime 69.421s, speedup 1.000x
34, opt runtime 35.527s, model runtime 71.730s, pg runtime 71.730s, speedup 1.000x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.639s, model runtime 462.544s, pg runtime 462.544s, speedup 1.000x
37, opt runtime 11.120s, model runtime 11.120s, pg runtime 11.120s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 57, train speedup 2.745, test speedup 1.377, val speedup 2.264
best test speedup epoch: 38, train speedup 2.614, test speedup 2.707, val speedup 1.355
best validation speedup epoch: 57, train speedup 2.745, test speedup 1.377, val speedup 2.264
last model at epoch 61, train speedup 2.708, test speedup 1.258, val speedup 1.400
execution cost 0:01:56.800297
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.666695, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.625x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.532x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.618x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.667x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.513x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009290| train set 0.831x speedup, test set 1.284x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008610| train set 0.880x speedup, test set 0.860x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008035| train set 0.952x speedup, test set 1.216x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007386| train set 0.900x speedup, test set 1.232x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007038| train set 0.972x speedup, test set 1.210x speedup, val set 1.455x speedup, step: 1
Epoch 10/300 |loss: 0.007145| train set 0.987x speedup, test set 2.346x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006224| train set 1.224x speedup, test set 1.210x speedup, val set 1.371x speedup, step: 3
Epoch 12/300 |loss: 0.005604| train set 0.973x speedup, test set 2.281x speedup, val set 0.925x speedup, step: 4
Epoch 13/300 |loss: 0.005684| train set 1.322x speedup, test set 1.203x speedup, val set 1.522x speedup, step: 1
Epoch 14/300 |loss: 0.005281| train set 1.314x speedup, test set 1.210x speedup, val set 0.907x speedup, step: 2
Epoch 15/300 |loss: 0.005067| train set 1.355x speedup, test set 1.210x speedup, val set 1.386x speedup, step: 3
Epoch 16/300 |loss: 0.004725| train set 1.364x speedup, test set 1.210x speedup, val set 1.505x speedup, step: 4
Epoch 17/300 |loss: 0.004532| train set 1.379x speedup, test set 1.211x speedup, val set 0.901x speedup, step: 5
Epoch 18/300 |loss: 0.004496| train set 2.505x speedup, test set 2.346x speedup, val set 1.498x speedup, step: 6
Epoch 19/300 |loss: 0.004024| train set 1.290x speedup, test set 1.225x speedup, val set 0.885x speedup, step: 7
Epoch 20/300 |loss: 0.004592| train set 1.879x speedup, test set 2.147x speedup, val set 0.883x speedup, step: 8
Epoch 21/300 |loss: 0.004159| train set 2.232x speedup, test set 1.260x speedup, val set 0.936x speedup, step: 9
Epoch 22/300 |loss: 0.003612| train set 2.350x speedup, test set 1.207x speedup, val set 0.926x speedup, step: 10
Epoch 23/300 |loss: 0.003804| train set 2.281x speedup, test set 2.613x speedup, val set 1.623x speedup, step: 1
Epoch 24/300 |loss: 0.004539| train set 2.475x speedup, test set 2.467x speedup, val set 1.549x speedup, step: 2
Epoch 25/300 |loss: 0.003725| train set 2.561x speedup, test set 1.223x speedup, val set 1.387x speedup, step: 3
Epoch 26/300 |loss: 0.003680| train set 2.516x speedup, test set 1.206x speedup, val set 1.372x speedup, step: 4
Epoch 27/300 |loss: 0.003481| train set 2.647x speedup, test set 1.185x speedup, val set 1.357x speedup, step: 5
Epoch 28/300 |loss: 0.003243| train set 2.630x speedup, test set 2.461x speedup, val set 1.347x speedup, step: 6
Epoch 29/300 |loss: 0.003063| train set 2.502x speedup, test set 2.145x speedup, val set 1.427x speedup, step: 7
Epoch 30/300 |loss: 0.003101| train set 2.633x speedup, test set 2.425x speedup, val set 1.554x speedup, step: 8
Epoch 31/300 |loss: 0.003055| train set 2.606x speedup, test set 2.347x speedup, val set 1.549x speedup, step: 9
Epoch 32/300 |loss: 0.002970| train set 2.550x speedup, test set 2.530x speedup, val set 1.549x speedup, step: 10
Epoch 33/300 |loss: 0.002761| train set 2.536x speedup, test set 2.250x speedup, val set 1.413x speedup, step: 11
Epoch 34/300 |loss: 0.002620| train set 2.547x speedup, test set 2.249x speedup, val set 1.530x speedup, step: 12
Epoch 35/300 |loss: 0.002468| train set 2.580x speedup, test set 2.137x speedup, val set 1.440x speedup, step: 13
Epoch 36/300 |loss: 0.002889| train set 2.652x speedup, test set 2.218x speedup, val set 1.553x speedup, step: 14
Epoch 37/300 |loss: 0.002632| train set 2.661x speedup, test set 2.249x speedup, val set 1.277x speedup, step: 15
Epoch 38/300 |loss: 0.002354| train set 2.633x speedup, test set 2.147x speedup, val set 1.335x speedup, step: 16
Epoch 39/300 |loss: 0.002241| train set 2.497x speedup, test set 2.294x speedup, val set 1.277x speedup, step: 17
Epoch 40/300 |loss: 0.002168| train set 2.735x speedup, test set 2.472x speedup, val set 1.323x speedup, step: 18
Epoch 41/300 |loss: 0.002572| train set 2.436x speedup, test set 2.638x speedup, val set 1.262x speedup, step: 19
Epoch 42/300 |loss: 0.002470| train set 2.753x speedup, test set 2.305x speedup, val set 1.352x speedup, step: 20
Epoch 43/300 |loss: 0.002435| train set 2.714x speedup, test set 2.147x speedup, val set 1.277x speedup, step: 21
Epoch 44/300 |loss: 0.002214| train set 2.596x speedup, test set 2.097x speedup, val set 1.370x speedup, step: 22
Epoch 45/300 |loss: 0.002361| train set 2.505x speedup, test set 2.041x speedup, val set 1.428x speedup, step: 23
Epoch 46/300 |loss: 0.002174| train set 2.626x speedup, test set 2.294x speedup, val set 1.267x speedup, step: 24
Epoch 47/300 |loss: 0.001979| train set 2.674x speedup, test set 2.440x speedup, val set 1.277x speedup, step: 25
Epoch 48/300 |loss: 0.002096| train set 2.634x speedup, test set 2.400x speedup, val set 1.350x speedup, step: 26
Epoch 49/300 |loss: 0.002287| train set 2.619x speedup, test set 1.188x speedup, val set 1.370x speedup, step: 27
Epoch 50/300 |loss: 0.002046| train set 2.455x speedup, test set 2.377x speedup, val set 1.430x speedup, step: 28
Epoch 51/300 |loss: 0.001808| train set 2.551x speedup, test set 2.400x speedup, val set 1.277x speedup, step: 29
Epoch 52/300 |loss: 0.001464| train set 2.590x speedup, test set 2.146x speedup, val set 1.381x speedup, step: 30
Epoch 53/300 |loss: 0.001481| train set 2.640x speedup, test set 1.199x speedup, val set 1.370x speedup, step: 31
Epoch 54/300 |loss: 0.001555| train set 2.632x speedup, test set 2.235x speedup, val set 1.277x speedup, step: 32
Epoch 55/300 |loss: 0.001592| train set 2.677x speedup, test set 1.999x speedup, val set 1.381x speedup, step: 33
Epoch 56/300 |loss: 0.001427| train set 2.626x speedup, test set 2.000x speedup, val set 1.346x speedup, step: 34
Epoch 57/300 |loss: 0.001518| train set 2.593x speedup, test set 1.225x speedup, val set 1.366x speedup, step: 35
Epoch 58/300 |loss: 0.002110| train set 2.583x speedup, test set 2.114x speedup, val set 1.527x speedup, step: 36
Epoch 59/300 |loss: 0.001452| train set 2.732x speedup, test set 2.053x speedup, val set 1.366x speedup, step: 37
Epoch 60/300 |loss: 0.001587| train set 2.610x speedup, test set 1.999x speedup, val set 1.335x speedup, step: 38
Epoch 61/300 |loss: 0.001992| train set 2.665x speedup, test set 2.044x speedup, val set 1.370x speedup, step: 39
early stopping at epoch 61
Training per epoch cost 1.262 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
07, opt runtime 6.460s, model runtime 6.460s, pg runtime 16.134s, speedup 2.498x
08, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
12, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
13, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
14, opt runtime 3.449s, model runtime 14.824s, pg runtime 14.824s, speedup 1.000x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
18, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
19, opt runtime 1.148s, model runtime 1.214s, pg runtime 1.214s, speedup 1.000x
20, opt runtime 1.353s, model runtime 1.380s, pg runtime 1.380s, speedup 1.000x
21, opt runtime 22.482s, model runtime 33.671s, pg runtime 22.482s, speedup 0.668x
22, opt runtime 6.519s, model runtime 45.646s, pg runtime 6.519s, speedup 0.143x
23, opt runtime 6.250s, model runtime 10.621s, pg runtime 32.969s, speedup 3.104x
24, opt runtime 5.961s, model runtime 9.875s, pg runtime 31.210s, speedup 3.161x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.404s, model runtime 2.167s, pg runtime 1.404s, speedup 0.648x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 38.718s, model runtime 69.421s, pg runtime 69.421s, speedup 1.000x
34, opt runtime 35.527s, model runtime 71.730s, pg runtime 71.730s, speedup 1.000x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 11.120s, pg runtime 11.120s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 42, train speedup 2.753, test speedup 2.305, val speedup 1.352
best test speedup epoch: 3, train speedup 0.780, test speedup 2.667, val speedup 1.023
best validation speedup epoch: 23, train speedup 2.281, test speedup 2.613, val speedup 1.623
last model at epoch 61, train speedup 2.665, test speedup 2.044, val speedup 1.370
execution cost 0:01:57.130140
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.665659, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.346x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009284| train set 0.835x speedup, test set 1.264x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008565| train set 0.870x speedup, test set 1.364x speedup, val set 0.925x speedup, step: 3
Epoch 7/300 |loss: 0.007992| train set 0.947x speedup, test set 1.345x speedup, val set 0.906x speedup, step: 4
Epoch 8/300 |loss: 0.007413| train set 0.914x speedup, test set 1.342x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007100| train set 0.974x speedup, test set 1.338x speedup, val set 1.372x speedup, step: 1
Epoch 10/300 |loss: 0.007065| train set 0.945x speedup, test set 1.301x speedup, val set 0.900x speedup, step: 2
Epoch 11/300 |loss: 0.006166| train set 1.233x speedup, test set 1.338x speedup, val set 1.371x speedup, step: 3
Epoch 12/300 |loss: 0.005646| train set 0.961x speedup, test set 2.152x speedup, val set 0.935x speedup, step: 4
Epoch 13/300 |loss: 0.005691| train set 1.316x speedup, test set 1.331x speedup, val set 1.509x speedup, step: 1
Epoch 14/300 |loss: 0.005370| train set 1.376x speedup, test set 1.331x speedup, val set 0.912x speedup, step: 2
Epoch 15/300 |loss: 0.005166| train set 1.390x speedup, test set 1.331x speedup, val set 1.386x speedup, step: 3
Epoch 16/300 |loss: 0.004814| train set 1.359x speedup, test set 1.331x speedup, val set 1.365x speedup, step: 4
Epoch 17/300 |loss: 0.004478| train set 1.378x speedup, test set 1.395x speedup, val set 0.906x speedup, step: 5
Epoch 18/300 |loss: 0.004490| train set 2.546x speedup, test set 1.393x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.004801| train set 1.345x speedup, test set 1.384x speedup, val set 1.372x speedup, step: 2
Epoch 20/300 |loss: 0.004173| train set 1.871x speedup, test set 2.175x speedup, val set 0.923x speedup, step: 3
Epoch 21/300 |loss: 0.004086| train set 1.385x speedup, test set 1.374x speedup, val set 1.432x speedup, step: 4
Epoch 22/300 |loss: 0.003748| train set 1.985x speedup, test set 1.270x speedup, val set 1.411x speedup, step: 5
Epoch 23/300 |loss: 0.003912| train set 2.405x speedup, test set 1.376x speedup, val set 1.549x speedup, step: 1
Epoch 24/300 |loss: 0.004844| train set 2.498x speedup, test set 2.210x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003511| train set 2.462x speedup, test set 1.336x speedup, val set 1.549x speedup, step: 1
Epoch 26/300 |loss: 0.003337| train set 2.439x speedup, test set 1.296x speedup, val set 1.388x speedup, step: 2
Epoch 27/300 |loss: 0.003530| train set 2.520x speedup, test set 1.270x speedup, val set 1.354x speedup, step: 3
Epoch 28/300 |loss: 0.003168| train set 2.506x speedup, test set 2.285x speedup, val set 0.936x speedup, step: 4
Epoch 29/300 |loss: 0.003107| train set 2.599x speedup, test set 1.309x speedup, val set 1.526x speedup, step: 5
Epoch 30/300 |loss: 0.003194| train set 2.422x speedup, test set 2.061x speedup, val set 1.369x speedup, step: 6
Epoch 31/300 |loss: 0.003078| train set 2.607x speedup, test set 1.344x speedup, val set 1.549x speedup, step: 1
Epoch 32/300 |loss: 0.002804| train set 2.486x speedup, test set 2.204x speedup, val set 1.523x speedup, step: 2
Epoch 33/300 |loss: 0.003159| train set 2.629x speedup, test set 2.076x speedup, val set 1.387x speedup, step: 3
Epoch 34/300 |loss: 0.002742| train set 2.603x speedup, test set 1.254x speedup, val set 1.259x speedup, step: 4
Epoch 35/300 |loss: 0.002571| train set 2.606x speedup, test set 1.345x speedup, val set 1.249x speedup, step: 5
Epoch 36/300 |loss: 0.003169| train set 2.517x speedup, test set 1.381x speedup, val set 1.526x speedup, step: 6
Epoch 37/300 |loss: 0.002789| train set 2.682x speedup, test set 2.240x speedup, val set 1.409x speedup, step: 7
Epoch 38/300 |loss: 0.002486| train set 2.569x speedup, test set 1.986x speedup, val set 1.249x speedup, step: 8
Epoch 39/300 |loss: 0.002318| train set 2.527x speedup, test set 1.967x speedup, val set 1.277x speedup, step: 9
Epoch 40/300 |loss: 0.002301| train set 2.328x speedup, test set 1.283x speedup, val set 1.244x speedup, step: 10
Epoch 41/300 |loss: 0.002899| train set 2.481x speedup, test set 1.222x speedup, val set 1.262x speedup, step: 11
Epoch 42/300 |loss: 0.002810| train set 2.629x speedup, test set 1.990x speedup, val set 1.366x speedup, step: 12
Epoch 43/300 |loss: 0.002653| train set 2.672x speedup, test set 2.145x speedup, val set 1.369x speedup, step: 13
Epoch 44/300 |loss: 0.002352| train set 2.460x speedup, test set 1.249x speedup, val set 1.350x speedup, step: 14
Epoch 45/300 |loss: 0.002354| train set 2.412x speedup, test set 1.235x speedup, val set 1.346x speedup, step: 15
Epoch 46/300 |loss: 0.002182| train set 2.573x speedup, test set 1.251x speedup, val set 1.355x speedup, step: 16
Epoch 47/300 |loss: 0.002009| train set 2.553x speedup, test set 1.237x speedup, val set 1.267x speedup, step: 17
Epoch 48/300 |loss: 0.002087| train set 2.560x speedup, test set 1.241x speedup, val set 1.347x speedup, step: 18
Epoch 49/300 |loss: 0.002062| train set 2.673x speedup, test set 1.234x speedup, val set 1.369x speedup, step: 19
Epoch 50/300 |loss: 0.001759| train set 2.517x speedup, test set 1.239x speedup, val set 1.257x speedup, step: 20
Epoch 51/300 |loss: 0.001867| train set 2.764x speedup, test set 1.235x speedup, val set 1.357x speedup, step: 21
Epoch 52/300 |loss: 0.001643| train set 2.671x speedup, test set 1.955x speedup, val set 1.274x speedup, step: 22
Epoch 53/300 |loss: 0.001559| train set 2.643x speedup, test set 1.233x speedup, val set 1.277x speedup, step: 23
Epoch 54/300 |loss: 0.001701| train set 2.617x speedup, test set 1.232x speedup, val set 1.265x speedup, step: 24
Epoch 55/300 |loss: 0.001886| train set 2.696x speedup, test set 1.212x speedup, val set 1.410x speedup, step: 25
Epoch 56/300 |loss: 0.001500| train set 2.611x speedup, test set 1.203x speedup, val set 1.366x speedup, step: 26
Epoch 57/300 |loss: 0.001525| train set 2.617x speedup, test set 1.239x speedup, val set 1.522x speedup, step: 27
Epoch 58/300 |loss: 0.001955| train set 2.677x speedup, test set 1.209x speedup, val set 1.366x speedup, step: 28
Epoch 59/300 |loss: 0.001526| train set 2.643x speedup, test set 1.225x speedup, val set 1.366x speedup, step: 29
Epoch 60/300 |loss: 0.001698| train set 2.575x speedup, test set 2.142x speedup, val set 1.369x speedup, step: 30
Epoch 61/300 |loss: 0.001961| train set 2.691x speedup, test set 1.220x speedup, val set 1.259x speedup, step: 31
early stopping at epoch 61
Training per epoch cost 1.206 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 12.431s, pg runtime 14.286s, speedup 1.149x
08, opt runtime 7.237s, model runtime 9.171s, pg runtime 17.708s, speedup 1.931x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 60.927s, pg runtime 73.019s, speedup 1.198x
12, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
15, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
16, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
17, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
18, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 49.848s, pg runtime 6.281s, speedup 0.126x
22, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
23, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 35.538s, model runtime 41.909s, pg runtime 70.116s, speedup 1.673x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 16.138s, model runtime 638.331s, pg runtime 501.793s, speedup 0.786x
36, opt runtime 16.438s, model runtime 516.443s, pg runtime 546.887s, speedup 1.059x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 25.709s, pg runtime 1.100s, speedup 0.043x
40, opt runtime 1.084s, model runtime 25.937s, pg runtime 1.155s, speedup 0.045x
====================
best train speedup epoch: 51, train speedup 2.764, test speedup 1.235, val speedup 1.357
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 31, train speedup 2.607, test speedup 1.344, val speedup 1.549
last model at epoch 61, train speedup 2.691, test speedup 1.220, val speedup 1.259
execution cost 0:01:50.590081
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.748037, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.532x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009285| train set 0.833x speedup, test set 1.244x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008576| train set 0.880x speedup, test set 0.937x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008029| train set 0.954x speedup, test set 1.342x speedup, val set 0.914x speedup, step: 4
Epoch 8/300 |loss: 0.007402| train set 0.909x speedup, test set 1.345x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007105| train set 0.969x speedup, test set 1.335x speedup, val set 1.429x speedup, step: 1
Epoch 10/300 |loss: 0.007015| train set 0.929x speedup, test set 2.170x speedup, val set 0.802x speedup, step: 2
Epoch 11/300 |loss: 0.006162| train set 1.242x speedup, test set 1.331x speedup, val set 1.371x speedup, step: 3
Epoch 12/300 |loss: 0.005646| train set 0.988x speedup, test set 2.152x speedup, val set 0.934x speedup, step: 4
Epoch 13/300 |loss: 0.005696| train set 1.289x speedup, test set 1.331x speedup, val set 1.365x speedup, step: 5
Epoch 14/300 |loss: 0.005451| train set 1.332x speedup, test set 1.367x speedup, val set 0.901x speedup, step: 6
Epoch 15/300 |loss: 0.004976| train set 1.378x speedup, test set 1.335x speedup, val set 1.371x speedup, step: 7
Epoch 16/300 |loss: 0.004793| train set 1.351x speedup, test set 1.335x speedup, val set 1.352x speedup, step: 8
Epoch 17/300 |loss: 0.004504| train set 1.374x speedup, test set 1.329x speedup, val set 1.530x speedup, step: 1
Epoch 18/300 |loss: 0.004440| train set 2.445x speedup, test set 1.426x speedup, val set 1.523x speedup, step: 2
Epoch 19/300 |loss: 0.004054| train set 1.308x speedup, test set 2.139x speedup, val set 0.926x speedup, step: 3
Epoch 20/300 |loss: 0.004533| train set 1.744x speedup, test set 2.200x speedup, val set 0.923x speedup, step: 4
Epoch 21/300 |loss: 0.004148| train set 1.392x speedup, test set 1.328x speedup, val set 1.431x speedup, step: 5
Epoch 22/300 |loss: 0.003766| train set 1.259x speedup, test set 2.187x speedup, val set 0.796x speedup, step: 6
Epoch 23/300 |loss: 0.003817| train set 2.297x speedup, test set 1.367x speedup, val set 1.508x speedup, step: 7
Epoch 24/300 |loss: 0.004546| train set 2.396x speedup, test set 2.238x speedup, val set 1.366x speedup, step: 8
Epoch 25/300 |loss: 0.003748| train set 2.518x speedup, test set 2.150x speedup, val set 0.996x speedup, step: 9
Epoch 26/300 |loss: 0.003440| train set 2.475x speedup, test set 1.257x speedup, val set 1.355x speedup, step: 10
Epoch 27/300 |loss: 0.003434| train set 2.635x speedup, test set 1.280x speedup, val set 1.337x speedup, step: 11
Epoch 28/300 |loss: 0.003037| train set 2.614x speedup, test set 2.111x speedup, val set 1.316x speedup, step: 12
Epoch 29/300 |loss: 0.003008| train set 2.444x speedup, test set 1.251x speedup, val set 1.357x speedup, step: 13
Epoch 30/300 |loss: 0.002993| train set 2.486x speedup, test set 2.229x speedup, val set 1.348x speedup, step: 14
Epoch 31/300 |loss: 0.003083| train set 2.415x speedup, test set 1.380x speedup, val set 1.391x speedup, step: 15
Epoch 32/300 |loss: 0.002707| train set 2.548x speedup, test set 2.310x speedup, val set 1.332x speedup, step: 16
Epoch 33/300 |loss: 0.003190| train set 2.500x speedup, test set 2.124x speedup, val set 1.400x speedup, step: 17
Epoch 34/300 |loss: 0.002716| train set 2.453x speedup, test set 2.428x speedup, val set 1.332x speedup, step: 18
Epoch 35/300 |loss: 0.002477| train set 2.468x speedup, test set 2.241x speedup, val set 1.251x speedup, step: 19
Epoch 36/300 |loss: 0.003026| train set 2.412x speedup, test set 2.173x speedup, val set 1.259x speedup, step: 20
Epoch 37/300 |loss: 0.002734| train set 2.502x speedup, test set 2.342x speedup, val set 1.262x speedup, step: 21
Epoch 38/300 |loss: 0.002413| train set 2.615x speedup, test set 2.241x speedup, val set 1.251x speedup, step: 22
Epoch 39/300 |loss: 0.002234| train set 2.602x speedup, test set 2.427x speedup, val set 1.277x speedup, step: 23
Epoch 40/300 |loss: 0.002325| train set 2.332x speedup, test set 1.383x speedup, val set 1.237x speedup, step: 24
Epoch 41/300 |loss: 0.002894| train set 2.450x speedup, test set 2.472x speedup, val set 1.262x speedup, step: 25
Epoch 42/300 |loss: 0.002687| train set 2.532x speedup, test set 2.427x speedup, val set 1.251x speedup, step: 26
Epoch 43/300 |loss: 0.002548| train set 2.652x speedup, test set 2.309x speedup, val set 1.267x speedup, step: 27
Epoch 44/300 |loss: 0.002295| train set 2.477x speedup, test set 2.135x speedup, val set 1.234x speedup, step: 28
Epoch 45/300 |loss: 0.002525| train set 2.564x speedup, test set 2.225x speedup, val set 1.427x speedup, step: 29
Epoch 46/300 |loss: 0.002241| train set 2.578x speedup, test set 1.963x speedup, val set 1.249x speedup, step: 30
Epoch 47/300 |loss: 0.002082| train set 2.643x speedup, test set 2.204x speedup, val set 1.267x speedup, step: 31
Epoch 48/300 |loss: 0.002161| train set 2.653x speedup, test set 2.047x speedup, val set 1.249x speedup, step: 32
Epoch 49/300 |loss: 0.002294| train set 2.594x speedup, test set 1.328x speedup, val set 1.348x speedup, step: 33
Epoch 50/300 |loss: 0.002070| train set 2.477x speedup, test set 2.490x speedup, val set 1.249x speedup, step: 34
Epoch 51/300 |loss: 0.001903| train set 2.703x speedup, test set 2.166x speedup, val set 1.251x speedup, step: 35
Epoch 52/300 |loss: 0.001656| train set 2.613x speedup, test set 2.047x speedup, val set 1.340x speedup, step: 36
Epoch 53/300 |loss: 0.001568| train set 2.617x speedup, test set 2.383x speedup, val set 1.251x speedup, step: 37
Epoch 54/300 |loss: 0.001542| train set 2.282x speedup, test set 2.151x speedup, val set 1.237x speedup, step: 38
Epoch 55/300 |loss: 0.001669| train set 2.669x speedup, test set 2.284x speedup, val set 1.262x speedup, step: 39
Epoch 56/300 |loss: 0.001533| train set 2.502x speedup, test set 1.986x speedup, val set 1.358x speedup, step: 40
Epoch 57/300 |loss: 0.001569| train set 2.628x speedup, test set 2.131x speedup, val set 1.898x speedup, step: 1
Epoch 58/300 |loss: 0.002106| train set 2.521x speedup, test set 1.986x speedup, val set 1.378x speedup, step: 2
Epoch 59/300 |loss: 0.001521| train set 2.645x speedup, test set 2.129x speedup, val set 1.347x speedup, step: 3
Epoch 60/300 |loss: 0.001619| train set 2.523x speedup, test set 2.151x speedup, val set 1.347x speedup, step: 4
Epoch 61/300 |loss: 0.001855| train set 2.562x speedup, test set 2.064x speedup, val set 1.366x speedup, step: 5
Epoch 62/300 |loss: 0.001497| train set 2.681x speedup, test set 2.118x speedup, val set 1.340x speedup, step: 6
Epoch 63/300 |loss: 0.001424| train set 2.618x speedup, test set 2.065x speedup, val set 1.343x speedup, step: 7
Epoch 64/300 |loss: 0.001210| train set 2.649x speedup, test set 2.299x speedup, val set 1.340x speedup, step: 8
Epoch 65/300 |loss: 0.001555| train set 2.639x speedup, test set 2.071x speedup, val set 1.378x speedup, step: 9
Epoch 66/300 |loss: 0.001343| train set 2.627x speedup, test set 2.065x speedup, val set 1.320x speedup, step: 10
Epoch 67/300 |loss: 0.001612| train set 2.723x speedup, test set 2.052x speedup, val set 1.337x speedup, step: 11
Epoch 68/300 |loss: 0.001671| train set 2.626x speedup, test set 2.061x speedup, val set 1.267x speedup, step: 12
early stopping at epoch 68
Training per epoch cost 1.204 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 60.927s, pg runtime 73.019s, speedup 1.198x
12, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
15, opt runtime 47.518s, model runtime 120.739s, pg runtime 75.736s, speedup 0.627x
16, opt runtime 48.784s, model runtime 124.142s, pg runtime 78.349s, speedup 0.631x
17, opt runtime 10.788s, model runtime 60.401s, pg runtime 32.939s, speedup 0.545x
18, opt runtime 7.469s, model runtime 41.483s, pg runtime 23.223s, speedup 0.560x
19, opt runtime 1.309s, model runtime 1.382s, pg runtime 1.356s, speedup 0.981x
20, opt runtime 1.340s, model runtime 1.478s, pg runtime 1.340s, speedup 0.907x
21, opt runtime 6.281s, model runtime 49.848s, pg runtime 6.281s, speedup 0.126x
22, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
23, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 35.538s, model runtime 63.734s, pg runtime 70.116s, speedup 1.100x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
36, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 25.709s, pg runtime 1.100s, speedup 0.043x
40, opt runtime 1.084s, model runtime 25.937s, pg runtime 1.155s, speedup 0.045x
====================
best train speedup epoch: 67, train speedup 2.723, test speedup 2.052, val speedup 1.337
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.628, test speedup 2.131, val speedup 1.898
last model at epoch 68, train speedup 2.626, test speedup 2.061, val speedup 1.267
execution cost 0:02:02.284271
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.677302, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.532x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009284| train set 0.831x speedup, test set 1.244x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008581| train set 0.880x speedup, test set 0.921x speedup, val set 0.936x speedup, step: 3
Epoch 7/300 |loss: 0.008029| train set 0.946x speedup, test set 1.342x speedup, val set 0.914x speedup, step: 4
Epoch 8/300 |loss: 0.007385| train set 0.923x speedup, test set 1.345x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007079| train set 0.974x speedup, test set 1.335x speedup, val set 1.351x speedup, step: 1
Epoch 10/300 |loss: 0.007127| train set 0.945x speedup, test set 2.276x speedup, val set 0.934x speedup, step: 2
Epoch 11/300 |loss: 0.006304| train set 1.228x speedup, test set 1.331x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005707| train set 0.933x speedup, test set 2.152x speedup, val set 0.934x speedup, step: 2
Epoch 13/300 |loss: 0.005750| train set 1.333x speedup, test set 1.331x speedup, val set 1.354x speedup, step: 3
Epoch 14/300 |loss: 0.005341| train set 1.268x speedup, test set 1.331x speedup, val set 0.900x speedup, step: 4
Epoch 15/300 |loss: 0.005260| train set 1.377x speedup, test set 1.331x speedup, val set 0.906x speedup, step: 5
Epoch 16/300 |loss: 0.005134| train set 1.381x speedup, test set 1.331x speedup, val set 1.522x speedup, step: 1
Epoch 17/300 |loss: 0.004797| train set 1.367x speedup, test set 1.331x speedup, val set 0.900x speedup, step: 2
Epoch 18/300 |loss: 0.004441| train set 2.295x speedup, test set 1.331x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.005215| train set 1.309x speedup, test set 1.355x speedup, val set 1.351x speedup, step: 2
Epoch 20/300 |loss: 0.004961| train set 2.240x speedup, test set 1.331x speedup, val set 1.387x speedup, step: 3
Epoch 21/300 |loss: 0.004028| train set 1.380x speedup, test set 1.329x speedup, val set 1.404x speedup, step: 4
Epoch 22/300 |loss: 0.003789| train set 2.429x speedup, test set 1.327x speedup, val set 1.354x speedup, step: 5
Epoch 23/300 |loss: 0.004269| train set 1.414x speedup, test set 1.334x speedup, val set 1.455x speedup, step: 6
Epoch 24/300 |loss: 0.004546| train set 2.405x speedup, test set 1.329x speedup, val set 1.533x speedup, step: 7
Epoch 25/300 |loss: 0.003576| train set 2.493x speedup, test set 1.327x speedup, val set 1.533x speedup, step: 8
Epoch 26/300 |loss: 0.003796| train set 2.422x speedup, test set 1.324x speedup, val set 1.533x speedup, step: 9
Epoch 27/300 |loss: 0.003427| train set 2.648x speedup, test set 1.302x speedup, val set 1.511x speedup, step: 10
Epoch 28/300 |loss: 0.003180| train set 2.561x speedup, test set 2.181x speedup, val set 1.267x speedup, step: 11
Epoch 29/300 |loss: 0.003252| train set 2.459x speedup, test set 1.340x speedup, val set 1.526x speedup, step: 12
Epoch 30/300 |loss: 0.003317| train set 2.596x speedup, test set 1.427x speedup, val set 1.523x speedup, step: 13
Epoch 31/300 |loss: 0.002995| train set 2.591x speedup, test set 1.427x speedup, val set 1.549x speedup, step: 1
Epoch 32/300 |loss: 0.002901| train set 2.462x speedup, test set 1.408x speedup, val set 1.549x speedup, step: 1
Epoch 33/300 |loss: 0.003048| train set 2.578x speedup, test set 2.279x speedup, val set 1.549x speedup, step: 1
Epoch 34/300 |loss: 0.002762| train set 2.480x speedup, test set 1.318x speedup, val set 1.400x speedup, step: 2
Epoch 35/300 |loss: 0.002644| train set 2.624x speedup, test set 1.385x speedup, val set 1.267x speedup, step: 3
Epoch 36/300 |loss: 0.003051| train set 2.561x speedup, test set 1.367x speedup, val set 1.277x speedup, step: 4
Epoch 37/300 |loss: 0.002719| train set 2.631x speedup, test set 1.330x speedup, val set 1.277x speedup, step: 5
Epoch 38/300 |loss: 0.002592| train set 2.584x speedup, test set 1.282x speedup, val set 1.335x speedup, step: 6
Epoch 39/300 |loss: 0.002541| train set 2.541x speedup, test set 1.332x speedup, val set 1.277x speedup, step: 7
Epoch 40/300 |loss: 0.002478| train set 2.579x speedup, test set 1.254x speedup, val set 1.355x speedup, step: 8
Epoch 41/300 |loss: 0.002927| train set 2.521x speedup, test set 1.310x speedup, val set 1.267x speedup, step: 9
Epoch 42/300 |loss: 0.002763| train set 2.710x speedup, test set 1.292x speedup, val set 1.357x speedup, step: 10
Epoch 43/300 |loss: 0.002782| train set 2.627x speedup, test set 1.245x speedup, val set 1.287x speedup, step: 11
early stopping at epoch 43
Training per epoch cost 1.210 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
12, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
18, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 49.848s, pg runtime 6.281s, speedup 0.126x
22, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
23, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 70.116s, pg runtime 70.116s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
36, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
37, opt runtime 15.754s, model runtime 73.566s, pg runtime 15.754s, speedup 0.214x
38, opt runtime 13.961s, model runtime 70.701s, pg runtime 13.961s, speedup 0.197x
39, opt runtime 1.098s, model runtime 1.100s, pg runtime 1.100s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 42, train speedup 2.710, test speedup 1.292, val speedup 1.357
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 33, train speedup 2.578, test speedup 2.279, val speedup 1.549
last model at epoch 43, train speedup 2.627, test speedup 1.245, val speedup 1.287
execution cost 0:01:21.502475
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.664918, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.532x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009284| train set 0.831x speedup, test set 1.244x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008581| train set 0.880x speedup, test set 0.921x speedup, val set 0.936x speedup, step: 3
Epoch 7/300 |loss: 0.008029| train set 0.946x speedup, test set 1.342x speedup, val set 0.914x speedup, step: 4
Epoch 8/300 |loss: 0.007385| train set 0.923x speedup, test set 1.345x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007079| train set 0.974x speedup, test set 1.335x speedup, val set 1.351x speedup, step: 1
Epoch 10/300 |loss: 0.007131| train set 0.950x speedup, test set 2.276x speedup, val set 0.934x speedup, step: 2
Epoch 11/300 |loss: 0.006308| train set 1.236x speedup, test set 1.331x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005737| train set 0.962x speedup, test set 2.152x speedup, val set 0.934x speedup, step: 2
Epoch 13/300 |loss: 0.005728| train set 1.334x speedup, test set 2.256x speedup, val set 1.354x speedup, step: 3
Epoch 14/300 |loss: 0.005237| train set 1.257x speedup, test set 1.335x speedup, val set 0.901x speedup, step: 4
Epoch 15/300 |loss: 0.005345| train set 1.383x speedup, test set 1.331x speedup, val set 1.371x speedup, step: 1
Epoch 16/300 |loss: 0.005225| train set 2.140x speedup, test set 1.320x speedup, val set 1.522x speedup, step: 1
Epoch 17/300 |loss: 0.004755| train set 1.414x speedup, test set 1.338x speedup, val set 1.373x speedup, step: 2
Epoch 18/300 |loss: 0.004442| train set 2.481x speedup, test set 1.335x speedup, val set 1.522x speedup, step: 1
Epoch 19/300 |loss: 0.005153| train set 1.383x speedup, test set 1.357x speedup, val set 1.352x speedup, step: 2
Epoch 20/300 |loss: 0.004628| train set 2.531x speedup, test set 1.325x speedup, val set 1.388x speedup, step: 3
Epoch 21/300 |loss: 0.004002| train set 1.408x speedup, test set 1.297x speedup, val set 0.935x speedup, step: 4
Epoch 22/300 |loss: 0.003845| train set 1.302x speedup, test set 2.230x speedup, val set 1.431x speedup, step: 5
Epoch 23/300 |loss: 0.004089| train set 2.418x speedup, test set 1.304x speedup, val set 1.337x speedup, step: 6
Epoch 24/300 |loss: 0.004503| train set 2.435x speedup, test set 1.338x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003813| train set 2.503x speedup, test set 1.314x speedup, val set 1.549x speedup, step: 1
Epoch 26/300 |loss: 0.003834| train set 2.558x speedup, test set 1.362x speedup, val set 1.549x speedup, step: 2
Epoch 27/300 |loss: 0.003266| train set 2.622x speedup, test set 1.307x speedup, val set 1.372x speedup, step: 3
Epoch 28/300 |loss: 0.003106| train set 2.566x speedup, test set 2.306x speedup, val set 1.249x speedup, step: 4
Epoch 29/300 |loss: 0.003106| train set 2.542x speedup, test set 1.334x speedup, val set 1.378x speedup, step: 5
Epoch 30/300 |loss: 0.003386| train set 2.540x speedup, test set 2.264x speedup, val set 1.259x speedup, step: 6
Epoch 31/300 |loss: 0.003071| train set 2.665x speedup, test set 1.351x speedup, val set 1.409x speedup, step: 7
Epoch 32/300 |loss: 0.002837| train set 2.438x speedup, test set 1.307x speedup, val set 1.549x speedup, step: 1
Epoch 33/300 |loss: 0.002955| train set 2.570x speedup, test set 1.344x speedup, val set 1.495x speedup, step: 2
Epoch 34/300 |loss: 0.002755| train set 2.516x speedup, test set 1.433x speedup, val set 1.409x speedup, step: 3
Epoch 35/300 |loss: 0.002650| train set 2.527x speedup, test set 2.284x speedup, val set 1.267x speedup, step: 4
Epoch 36/300 |loss: 0.002658| train set 2.594x speedup, test set 2.389x speedup, val set 1.392x speedup, step: 5
Epoch 37/300 |loss: 0.002613| train set 2.642x speedup, test set 1.374x speedup, val set 1.277x speedup, step: 6
Epoch 38/300 |loss: 0.002381| train set 2.605x speedup, test set 2.261x speedup, val set 1.245x speedup, step: 7
Epoch 39/300 |loss: 0.002243| train set 2.635x speedup, test set 2.377x speedup, val set 1.277x speedup, step: 8
Epoch 40/300 |loss: 0.002302| train set 2.565x speedup, test set 2.588x speedup, val set 1.267x speedup, step: 9
Epoch 41/300 |loss: 0.002873| train set 2.506x speedup, test set 2.350x speedup, val set 1.262x speedup, step: 10
Epoch 42/300 |loss: 0.002670| train set 2.684x speedup, test set 2.406x speedup, val set 1.262x speedup, step: 11
Epoch 43/300 |loss: 0.002646| train set 2.625x speedup, test set 1.347x speedup, val set 1.267x speedup, step: 12
Epoch 44/300 |loss: 0.002270| train set 2.591x speedup, test set 2.174x speedup, val set 1.277x speedup, step: 13
Epoch 45/300 |loss: 0.002435| train set 2.440x speedup, test set 2.090x speedup, val set 0.924x speedup, step: 14
Epoch 46/300 |loss: 0.002489| train set 2.586x speedup, test set 1.400x speedup, val set 1.706x speedup, step: 1
Epoch 47/300 |loss: 0.002172| train set 2.639x speedup, test set 1.404x speedup, val set 1.277x speedup, step: 2
Epoch 48/300 |loss: 0.002295| train set 2.599x speedup, test set 1.326x speedup, val set 1.267x speedup, step: 3
Epoch 49/300 |loss: 0.002337| train set 2.664x speedup, test set 1.332x speedup, val set 1.274x speedup, step: 4
Epoch 50/300 |loss: 0.002121| train set 2.554x speedup, test set 1.358x speedup, val set 1.277x speedup, step: 5
Epoch 51/300 |loss: 0.001930| train set 2.516x speedup, test set 1.326x speedup, val set 1.267x speedup, step: 6
Epoch 52/300 |loss: 0.001660| train set 2.732x speedup, test set 1.306x speedup, val set 1.267x speedup, step: 7
Epoch 53/300 |loss: 0.001618| train set 2.607x speedup, test set 1.351x speedup, val set 1.277x speedup, step: 8
Epoch 54/300 |loss: 0.001631| train set 2.530x speedup, test set 1.375x speedup, val set 1.267x speedup, step: 9
Epoch 55/300 |loss: 0.001675| train set 2.711x speedup, test set 1.441x speedup, val set 1.277x speedup, step: 10
Epoch 56/300 |loss: 0.001442| train set 2.541x speedup, test set 1.379x speedup, val set 1.277x speedup, step: 11
Epoch 57/300 |loss: 0.001544| train set 2.578x speedup, test set 1.539x speedup, val set 1.754x speedup, step: 1
Epoch 58/300 |loss: 0.002064| train set 2.637x speedup, test set 1.365x speedup, val set 1.754x speedup, step: 1
Epoch 59/300 |loss: 0.001597| train set 2.658x speedup, test set 1.417x speedup, val set 1.354x speedup, step: 2
Epoch 60/300 |loss: 0.001817| train set 2.552x speedup, test set 1.356x speedup, val set 1.267x speedup, step: 3
Epoch 61/300 |loss: 0.001653| train set 2.656x speedup, test set 1.345x speedup, val set 1.909x speedup, step: 1
Epoch 62/300 |loss: 0.001395| train set 2.644x speedup, test set 1.327x speedup, val set 1.357x speedup, step: 2
Epoch 63/300 |loss: 0.001367| train set 2.588x speedup, test set 1.387x speedup, val set 1.267x speedup, step: 3
Epoch 64/300 |loss: 0.001230| train set 2.553x speedup, test set 1.362x speedup, val set 1.734x speedup, step: 4
Epoch 65/300 |loss: 0.001689| train set 2.367x speedup, test set 1.280x speedup, val set 1.357x speedup, step: 5
Epoch 66/300 |loss: 0.001435| train set 2.668x speedup, test set 1.345x speedup, val set 1.734x speedup, step: 6
Epoch 67/300 |loss: 0.001510| train set 2.601x speedup, test set 1.311x speedup, val set 1.267x speedup, step: 7
Epoch 68/300 |loss: 0.001573| train set 2.753x speedup, test set 1.329x speedup, val set 1.933x speedup, step: 1
Epoch 69/300 |loss: 0.001527| train set 2.596x speedup, test set 1.367x speedup, val set 1.267x speedup, step: 2
Epoch 70/300 |loss: 0.001487| train set 2.743x speedup, test set 1.266x speedup, val set 1.357x speedup, step: 3
Epoch 71/300 |loss: 0.001229| train set 2.673x speedup, test set 1.322x speedup, val set 1.955x speedup, step: 1
Epoch 72/300 |loss: 0.001088| train set 2.701x speedup, test set 1.333x speedup, val set 1.909x speedup, step: 2
Epoch 73/300 |loss: 0.001478| train set 2.696x speedup, test set 1.360x speedup, val set 1.358x speedup, step: 3
Epoch 74/300 |loss: 0.001318| train set 2.661x speedup, test set 1.334x speedup, val set 1.369x speedup, step: 4
Epoch 75/300 |loss: 0.001064| train set 2.646x speedup, test set 1.332x speedup, val set 1.347x speedup, step: 5
Epoch 76/300 |loss: 0.000976| train set 2.615x speedup, test set 1.330x speedup, val set 1.911x speedup, step: 6
Epoch 77/300 |loss: 0.001000| train set 2.723x speedup, test set 1.322x speedup, val set 1.358x speedup, step: 7
Epoch 78/300 |loss: 0.001123| train set 2.721x speedup, test set 1.330x speedup, val set 1.934x speedup, step: 8
Epoch 79/300 |loss: 0.000922| train set 2.725x speedup, test set 1.316x speedup, val set 1.933x speedup, step: 9
Epoch 80/300 |loss: 0.000955| train set 2.678x speedup, test set 1.339x speedup, val set 1.911x speedup, step: 10
Epoch 81/300 |loss: 0.001062| train set 2.684x speedup, test set 1.336x speedup, val set 1.381x speedup, step: 11
Epoch 82/300 |loss: 0.001290| train set 2.718x speedup, test set 1.350x speedup, val set 1.932x speedup, step: 12
Epoch 83/300 |loss: 0.001118| train set 2.656x speedup, test set 1.260x speedup, val set 1.911x speedup, step: 13
Epoch 84/300 |loss: 0.001737| train set 2.670x speedup, test set 1.288x speedup, val set 1.370x speedup, step: 14
early stopping at epoch 84
Training per epoch cost 1.196 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 23.961s, pg runtime 32.278s, speedup 1.347x
06, opt runtime 19.263s, model runtime 30.418s, pg runtime 19.263s, speedup 0.633x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 60.927s, pg runtime 73.019s, speedup 1.198x
12, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 56.246s, pg runtime 32.939s, speedup 0.586x
18, opt runtime 7.469s, model runtime 48.776s, pg runtime 23.223s, speedup 0.476x
19, opt runtime 1.309s, model runtime 1.382s, pg runtime 1.356s, speedup 0.981x
20, opt runtime 1.340s, model runtime 1.478s, pg runtime 1.340s, speedup 0.907x
21, opt runtime 6.281s, model runtime 22.977s, pg runtime 6.281s, speedup 0.273x
22, opt runtime 25.034s, model runtime 31.752s, pg runtime 25.034s, speedup 0.788x
23, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 7.355s, pg runtime 7.533s, speedup 1.024x
28, opt runtime 7.268s, model runtime 7.333s, pg runtime 7.268s, speedup 0.991x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 35.538s, model runtime 41.909s, pg runtime 70.116s, speedup 1.673x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 16.138s, model runtime 501.793s, pg runtime 501.793s, speedup 1.000x
36, opt runtime 16.438s, model runtime 546.887s, pg runtime 546.887s, speedup 1.000x
37, opt runtime 15.754s, model runtime 104.295s, pg runtime 15.754s, speedup 0.151x
38, opt runtime 13.961s, model runtime 103.136s, pg runtime 13.961s, speedup 0.135x
39, opt runtime 1.098s, model runtime 25.709s, pg runtime 1.100s, speedup 0.043x
40, opt runtime 1.084s, model runtime 25.937s, pg runtime 1.155s, speedup 0.045x
====================
best train speedup epoch: 68, train speedup 2.753, test speedup 1.329, val speedup 1.933
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 71, train speedup 2.673, test speedup 1.322, val speedup 1.955
last model at epoch 84, train speedup 2.670, test speedup 1.288, val speedup 1.370
execution cost 0:02:31.067538
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.878129, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.346x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009283| train set 0.835x speedup, test set 1.264x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008582| train set 0.878x speedup, test set 1.364x speedup, val set 0.937x speedup, step: 3
Epoch 7/300 |loss: 0.007974| train set 0.957x speedup, test set 1.335x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007392| train set 0.919x speedup, test set 1.374x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007090| train set 0.988x speedup, test set 1.338x speedup, val set 1.350x speedup, step: 1
Epoch 10/300 |loss: 0.007068| train set 0.987x speedup, test set 1.338x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006090| train set 1.247x speedup, test set 1.331x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005632| train set 0.801x speedup, test set 2.139x speedup, val set 0.925x speedup, step: 2
Epoch 13/300 |loss: 0.005673| train set 1.420x speedup, test set 2.265x speedup, val set 1.365x speedup, step: 3
Epoch 14/300 |loss: 0.005233| train set 1.270x speedup, test set 1.367x speedup, val set 0.892x speedup, step: 4
Epoch 15/300 |loss: 0.004960| train set 1.393x speedup, test set 1.329x speedup, val set 1.549x speedup, step: 1
Epoch 16/300 |loss: 0.005091| train set 1.361x speedup, test set 1.357x speedup, val set 1.501x speedup, step: 2
Epoch 17/300 |loss: 0.004442| train set 1.396x speedup, test set 1.370x speedup, val set 0.901x speedup, step: 3
Epoch 18/300 |loss: 0.004254| train set 2.419x speedup, test set 1.395x speedup, val set 1.549x speedup, step: 1
Epoch 19/300 |loss: 0.004125| train set 1.279x speedup, test set 2.365x speedup, val set 0.900x speedup, step: 2
Epoch 20/300 |loss: 0.004879| train set 2.258x speedup, test set 2.202x speedup, val set 0.893x speedup, step: 3
Epoch 21/300 |loss: 0.003887| train set 2.334x speedup, test set 1.375x speedup, val set 1.355x speedup, step: 4
Epoch 22/300 |loss: 0.003791| train set 2.113x speedup, test set 2.195x speedup, val set 0.927x speedup, step: 5
Epoch 23/300 |loss: 0.003981| train set 2.374x speedup, test set 2.278x speedup, val set 1.570x speedup, step: 1
Epoch 24/300 |loss: 0.004338| train set 2.424x speedup, test set 2.278x speedup, val set 1.501x speedup, step: 2
Epoch 25/300 |loss: 0.003515| train set 2.416x speedup, test set 2.156x speedup, val set 0.936x speedup, step: 3
Epoch 26/300 |loss: 0.003481| train set 2.470x speedup, test set 1.357x speedup, val set 1.526x speedup, step: 4
Epoch 27/300 |loss: 0.003457| train set 2.638x speedup, test set 1.327x speedup, val set 1.247x speedup, step: 5
Epoch 28/300 |loss: 0.003085| train set 2.557x speedup, test set 2.456x speedup, val set 0.846x speedup, step: 6
Epoch 29/300 |loss: 0.003179| train set 2.480x speedup, test set 1.968x speedup, val set 1.395x speedup, step: 7
Epoch 30/300 |loss: 0.003030| train set 2.566x speedup, test set 2.043x speedup, val set 1.242x speedup, step: 8
Epoch 31/300 |loss: 0.003108| train set 2.441x speedup, test set 1.429x speedup, val set 1.535x speedup, step: 9
Epoch 32/300 |loss: 0.002905| train set 2.467x speedup, test set 1.273x speedup, val set 1.410x speedup, step: 10
Epoch 33/300 |loss: 0.003298| train set 2.661x speedup, test set 1.968x speedup, val set 1.259x speedup, step: 11
Epoch 34/300 |loss: 0.002795| train set 2.622x speedup, test set 2.150x speedup, val set 1.391x speedup, step: 12
Epoch 35/300 |loss: 0.002476| train set 2.608x speedup, test set 1.291x speedup, val set 1.247x speedup, step: 13
Epoch 36/300 |loss: 0.003062| train set 2.640x speedup, test set 1.330x speedup, val set 1.391x speedup, step: 14
Epoch 37/300 |loss: 0.002710| train set 2.585x speedup, test set 1.299x speedup, val set 1.262x speedup, step: 15
Epoch 38/300 |loss: 0.002596| train set 2.554x speedup, test set 2.115x speedup, val set 1.249x speedup, step: 16
Epoch 39/300 |loss: 0.002322| train set 2.564x speedup, test set 2.170x speedup, val set 1.277x speedup, step: 17
Epoch 40/300 |loss: 0.002385| train set 2.539x speedup, test set 1.240x speedup, val set 1.237x speedup, step: 18
Epoch 41/300 |loss: 0.002590| train set 2.424x speedup, test set 2.178x speedup, val set 1.277x speedup, step: 19
Epoch 42/300 |loss: 0.002751| train set 2.689x speedup, test set 2.037x speedup, val set 1.244x speedup, step: 20
Epoch 43/300 |loss: 0.002601| train set 2.669x speedup, test set 1.255x speedup, val set 1.228x speedup, step: 21
Epoch 44/300 |loss: 0.002234| train set 2.614x speedup, test set 1.261x speedup, val set 1.247x speedup, step: 22
Epoch 45/300 |loss: 0.002608| train set 2.563x speedup, test set 2.100x speedup, val set 1.350x speedup, step: 23
Epoch 46/300 |loss: 0.002177| train set 2.677x speedup, test set 1.223x speedup, val set 1.245x speedup, step: 24
Epoch 47/300 |loss: 0.002038| train set 2.632x speedup, test set 1.268x speedup, val set 1.259x speedup, step: 25
Epoch 48/300 |loss: 0.002206| train set 2.643x speedup, test set 1.264x speedup, val set 1.275x speedup, step: 26
Epoch 49/300 |loss: 0.002120| train set 2.596x speedup, test set 1.271x speedup, val set 1.413x speedup, step: 27
Epoch 50/300 |loss: 0.001717| train set 2.596x speedup, test set 1.276x speedup, val set 1.277x speedup, step: 28
Epoch 51/300 |loss: 0.001801| train set 2.606x speedup, test set 2.019x speedup, val set 1.259x speedup, step: 29
Epoch 52/300 |loss: 0.001591| train set 2.693x speedup, test set 1.236x speedup, val set 1.247x speedup, step: 30
Epoch 53/300 |loss: 0.001521| train set 2.706x speedup, test set 1.290x speedup, val set 1.247x speedup, step: 31
Epoch 54/300 |loss: 0.001518| train set 2.510x speedup, test set 1.283x speedup, val set 1.247x speedup, step: 32
Epoch 55/300 |loss: 0.001651| train set 2.614x speedup, test set 1.270x speedup, val set 1.413x speedup, step: 33
Epoch 56/300 |loss: 0.001519| train set 2.557x speedup, test set 1.284x speedup, val set 1.401x speedup, step: 34
Epoch 57/300 |loss: 0.001475| train set 2.557x speedup, test set 1.193x speedup, val set 1.940x speedup, step: 1
Epoch 58/300 |loss: 0.002053| train set 2.682x speedup, test set 2.191x speedup, val set 1.247x speedup, step: 2
Epoch 59/300 |loss: 0.001469| train set 2.650x speedup, test set 1.253x speedup, val set 1.373x speedup, step: 3
Epoch 60/300 |loss: 0.001650| train set 2.588x speedup, test set 2.133x speedup, val set 1.247x speedup, step: 4
Epoch 61/300 |loss: 0.001901| train set 2.566x speedup, test set 1.253x speedup, val set 1.230x speedup, step: 5
early stopping at epoch 61
Training per epoch cost 1.205 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 7.110s, model runtime 38.849s, pg runtime 14.286s, speedup 0.368x
08, opt runtime 7.237s, model runtime 36.429s, pg runtime 17.708s, speedup 0.486x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
12, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 60.401s, pg runtime 32.939s, speedup 0.545x
18, opt runtime 7.469s, model runtime 41.483s, pg runtime 23.223s, speedup 0.560x
19, opt runtime 1.309s, model runtime 1.382s, pg runtime 1.356s, speedup 0.981x
20, opt runtime 1.340s, model runtime 1.478s, pg runtime 1.340s, speedup 0.907x
21, opt runtime 6.281s, model runtime 49.848s, pg runtime 6.281s, speedup 0.126x
22, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
23, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 66.430s, pg runtime 611.327s, speedup 9.203x
32, opt runtime 24.706s, model runtime 55.387s, pg runtime 610.808s, speedup 11.028x
33, opt runtime 35.538s, model runtime 63.734s, pg runtime 70.116s, speedup 1.100x
34, opt runtime 39.191s, model runtime 75.740s, pg runtime 75.984s, speedup 1.003x
35, opt runtime 16.138s, model runtime 638.331s, pg runtime 501.793s, speedup 0.786x
36, opt runtime 16.438s, model runtime 516.443s, pg runtime 546.887s, speedup 1.059x
37, opt runtime 15.754s, model runtime 104.295s, pg runtime 15.754s, speedup 0.151x
38, opt runtime 13.961s, model runtime 103.136s, pg runtime 13.961s, speedup 0.135x
39, opt runtime 1.098s, model runtime 3.195s, pg runtime 1.100s, speedup 0.344x
40, opt runtime 1.084s, model runtime 3.471s, pg runtime 1.155s, speedup 0.333x
====================
best train speedup epoch: 53, train speedup 2.706, test speedup 1.290, val speedup 1.247
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.557, test speedup 1.193, val speedup 1.940
last model at epoch 61, train speedup 2.566, test speedup 1.253, val speedup 1.230
execution cost 0:01:51.109564
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.754829, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011385| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010406| train set 0.778x speedup, test set 1.346x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009283| train set 0.835x speedup, test set 1.264x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008582| train set 0.878x speedup, test set 1.364x speedup, val set 0.937x speedup, step: 3
Epoch 7/300 |loss: 0.007974| train set 0.957x speedup, test set 1.335x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007392| train set 0.919x speedup, test set 1.374x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007090| train set 0.988x speedup, test set 1.338x speedup, val set 1.350x speedup, step: 1
Epoch 10/300 |loss: 0.007072| train set 0.986x speedup, test set 1.338x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006121| train set 1.233x speedup, test set 1.338x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005602| train set 0.995x speedup, test set 2.256x speedup, val set 0.926x speedup, step: 2
Epoch 13/300 |loss: 0.005752| train set 1.393x speedup, test set 1.334x speedup, val set 1.365x speedup, step: 3
Epoch 14/300 |loss: 0.005228| train set 1.327x speedup, test set 1.331x speedup, val set 0.892x speedup, step: 4
Epoch 15/300 |loss: 0.004959| train set 1.481x speedup, test set 1.334x speedup, val set 1.372x speedup, step: 1
Epoch 16/300 |loss: 0.004636| train set 1.421x speedup, test set 1.367x speedup, val set 1.505x speedup, step: 1
Epoch 17/300 |loss: 0.004411| train set 1.363x speedup, test set 1.371x speedup, val set 1.530x speedup, step: 1
Epoch 18/300 |loss: 0.004337| train set 2.505x speedup, test set 1.357x speedup, val set 1.522x speedup, step: 2
Epoch 19/300 |loss: 0.004097| train set 1.363x speedup, test set 2.357x speedup, val set 0.901x speedup, step: 3
Epoch 20/300 |loss: 0.004868| train set 2.180x speedup, test set 2.200x speedup, val set 1.352x speedup, step: 4
Epoch 21/300 |loss: 0.003899| train set 1.419x speedup, test set 1.435x speedup, val set 1.375x speedup, step: 5
Epoch 22/300 |loss: 0.003633| train set 2.481x speedup, test set 2.214x speedup, val set 0.917x speedup, step: 6
Epoch 23/300 |loss: 0.003874| train set 2.369x speedup, test set 2.422x speedup, val set 1.570x speedup, step: 1
Epoch 24/300 |loss: 0.004479| train set 2.528x speedup, test set 2.229x speedup, val set 1.523x speedup, step: 2
Epoch 25/300 |loss: 0.003580| train set 2.534x speedup, test set 2.242x speedup, val set 1.397x speedup, step: 3
Epoch 26/300 |loss: 0.003433| train set 2.457x speedup, test set 1.297x speedup, val set 1.376x speedup, step: 4
Epoch 27/300 |loss: 0.003510| train set 2.584x speedup, test set 1.342x speedup, val set 1.247x speedup, step: 5
Epoch 28/300 |loss: 0.003074| train set 2.588x speedup, test set 2.538x speedup, val set 1.316x speedup, step: 6
Epoch 29/300 |loss: 0.003171| train set 2.514x speedup, test set 1.297x speedup, val set 1.376x speedup, step: 7
Epoch 30/300 |loss: 0.003038| train set 2.526x speedup, test set 2.230x speedup, val set 1.391x speedup, step: 8
Epoch 31/300 |loss: 0.003158| train set 2.535x speedup, test set 1.365x speedup, val set 1.505x speedup, step: 9
Epoch 32/300 |loss: 0.002879| train set 2.514x speedup, test set 1.283x speedup, val set 1.522x speedup, step: 10
Epoch 33/300 |loss: 0.002911| train set 2.551x speedup, test set 2.180x speedup, val set 1.277x speedup, step: 11
Epoch 34/300 |loss: 0.002714| train set 2.642x speedup, test set 1.319x speedup, val set 1.391x speedup, step: 12
Epoch 35/300 |loss: 0.002553| train set 2.635x speedup, test set 2.127x speedup, val set 1.249x speedup, step: 13
Epoch 36/300 |loss: 0.002985| train set 2.586x speedup, test set 1.295x speedup, val set 1.394x speedup, step: 14
Epoch 37/300 |loss: 0.002667| train set 2.686x speedup, test set 1.329x speedup, val set 1.413x speedup, step: 15
Epoch 38/300 |loss: 0.002392| train set 2.603x speedup, test set 2.281x speedup, val set 1.249x speedup, step: 16
Epoch 39/300 |loss: 0.002310| train set 2.623x speedup, test set 2.222x speedup, val set 1.409x speedup, step: 17
Epoch 40/300 |loss: 0.002330| train set 2.682x speedup, test set 1.271x speedup, val set 1.237x speedup, step: 18
Epoch 41/300 |loss: 0.002898| train set 2.500x speedup, test set 1.383x speedup, val set 1.413x speedup, step: 19
Epoch 42/300 |loss: 0.002681| train set 2.705x speedup, test set 2.289x speedup, val set 1.249x speedup, step: 20
Epoch 43/300 |loss: 0.002621| train set 2.695x speedup, test set 2.076x speedup, val set 1.397x speedup, step: 21
Epoch 44/300 |loss: 0.002352| train set 2.542x speedup, test set 2.019x speedup, val set 1.260x speedup, step: 22
Epoch 45/300 |loss: 0.002446| train set 2.253x speedup, test set 2.327x speedup, val set 1.436x speedup, step: 23
Epoch 46/300 |loss: 0.002264| train set 2.700x speedup, test set 2.080x speedup, val set 1.267x speedup, step: 24
Epoch 47/300 |loss: 0.002213| train set 2.670x speedup, test set 2.260x speedup, val set 1.267x speedup, step: 25
Epoch 48/300 |loss: 0.002301| train set 2.559x speedup, test set 2.304x speedup, val set 1.502x speedup, step: 26
Epoch 49/300 |loss: 0.002286| train set 2.649x speedup, test set 1.361x speedup, val set 1.413x speedup, step: 27
Epoch 50/300 |loss: 0.002047| train set 2.666x speedup, test set 2.109x speedup, val set 1.400x speedup, step: 28
Epoch 51/300 |loss: 0.002051| train set 2.675x speedup, test set 2.101x speedup, val set 1.391x speedup, step: 29
Epoch 52/300 |loss: 0.001775| train set 2.655x speedup, test set 1.320x speedup, val set 1.277x speedup, step: 30
Epoch 53/300 |loss: 0.001671| train set 2.628x speedup, test set 1.318x speedup, val set 1.413x speedup, step: 31
Epoch 54/300 |loss: 0.001726| train set 2.664x speedup, test set 1.276x speedup, val set 1.400x speedup, step: 32
Epoch 55/300 |loss: 0.001754| train set 2.608x speedup, test set 2.312x speedup, val set 1.413x speedup, step: 33
Epoch 56/300 |loss: 0.001534| train set 2.616x speedup, test set 1.255x speedup, val set 1.526x speedup, step: 34
Epoch 57/300 |loss: 0.001645| train set 2.597x speedup, test set 1.271x speedup, val set 2.253x speedup, step: 1
Epoch 58/300 |loss: 0.002571| train set 2.617x speedup, test set 1.283x speedup, val set 1.526x speedup, step: 2
Epoch 59/300 |loss: 0.001629| train set 2.639x speedup, test set 2.399x speedup, val set 1.526x speedup, step: 3
Epoch 60/300 |loss: 0.001799| train set 2.522x speedup, test set 2.139x speedup, val set 1.259x speedup, step: 4
Epoch 61/300 |loss: 0.001931| train set 2.580x speedup, test set 1.906x speedup, val set 1.277x speedup, step: 5
early stopping at epoch 61
Training per epoch cost 1.200 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 7.110s, model runtime 14.126s, pg runtime 14.286s, speedup 1.011x
08, opt runtime 7.237s, model runtime 13.362s, pg runtime 17.708s, speedup 1.325x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
12, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 56.246s, pg runtime 32.939s, speedup 0.586x
18, opt runtime 7.469s, model runtime 48.776s, pg runtime 23.223s, speedup 0.476x
19, opt runtime 1.309s, model runtime 1.382s, pg runtime 1.356s, speedup 0.981x
20, opt runtime 1.340s, model runtime 1.478s, pg runtime 1.340s, speedup 0.907x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 35.538s, model runtime 70.116s, pg runtime 70.116s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 16.138s, model runtime 638.331s, pg runtime 501.793s, speedup 0.786x
36, opt runtime 16.438s, model runtime 516.443s, pg runtime 546.887s, speedup 1.059x
37, opt runtime 15.754s, model runtime 104.295s, pg runtime 15.754s, speedup 0.151x
38, opt runtime 13.961s, model runtime 103.136s, pg runtime 13.961s, speedup 0.135x
39, opt runtime 1.098s, model runtime 24.326s, pg runtime 1.100s, speedup 0.045x
40, opt runtime 1.084s, model runtime 25.616s, pg runtime 1.155s, speedup 0.045x
====================
best train speedup epoch: 42, train speedup 2.705, test speedup 2.289, val speedup 1.249
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.597, test speedup 1.271, val speedup 2.253
last model at epoch 61, train speedup 2.580, test speedup 1.906, val speedup 1.277
execution cost 0:01:51.299380
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.659768, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.532x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009289| train set 0.831x speedup, test set 1.264x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008609| train set 0.880x speedup, test set 0.937x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008019| train set 0.954x speedup, test set 1.345x speedup, val set 0.916x speedup, step: 4
Epoch 8/300 |loss: 0.007386| train set 0.930x speedup, test set 1.381x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007053| train set 0.972x speedup, test set 1.345x speedup, val set 1.452x speedup, step: 1
Epoch 10/300 |loss: 0.007185| train set 0.973x speedup, test set 2.381x speedup, val set 0.808x speedup, step: 2
Epoch 11/300 |loss: 0.006339| train set 1.224x speedup, test set 1.374x speedup, val set 1.371x speedup, step: 3
Epoch 12/300 |loss: 0.005731| train set 0.812x speedup, test set 2.359x speedup, val set 0.934x speedup, step: 4
Epoch 13/300 |loss: 0.005694| train set 1.320x speedup, test set 2.263x speedup, val set 1.509x speedup, step: 1
Epoch 14/300 |loss: 0.005332| train set 1.324x speedup, test set 1.367x speedup, val set 1.549x speedup, step: 1
Epoch 15/300 |loss: 0.005366| train set 1.384x speedup, test set 1.367x speedup, val set 1.372x speedup, step: 2
Epoch 16/300 |loss: 0.005473| train set 2.124x speedup, test set 1.376x speedup, val set 1.549x speedup, step: 1
Epoch 17/300 |loss: 0.004904| train set 1.403x speedup, test set 1.374x speedup, val set 0.783x speedup, step: 2
Epoch 18/300 |loss: 0.004812| train set 1.323x speedup, test set 1.370x speedup, val set 1.530x speedup, step: 3
Epoch 19/300 |loss: 0.004723| train set 1.380x speedup, test set 1.372x speedup, val set 0.925x speedup, step: 4
Epoch 20/300 |loss: 0.004250| train set 2.164x speedup, test set 2.382x speedup, val set 1.453x speedup, step: 5
Epoch 21/300 |loss: 0.003945| train set 1.383x speedup, test set 1.360x speedup, val set 1.453x speedup, step: 6
Epoch 22/300 |loss: 0.003792| train set 2.310x speedup, test set 2.334x speedup, val set 1.355x speedup, step: 7
Epoch 23/300 |loss: 0.003859| train set 2.421x speedup, test set 1.420x speedup, val set 1.549x speedup, step: 1
Epoch 24/300 |loss: 0.004499| train set 2.356x speedup, test set 2.316x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003689| train set 2.515x speedup, test set 1.355x speedup, val set 1.549x speedup, step: 2
Epoch 26/300 |loss: 0.003654| train set 2.452x speedup, test set 2.286x speedup, val set 1.549x speedup, step: 3
Epoch 27/300 |loss: 0.003428| train set 2.558x speedup, test set 2.326x speedup, val set 1.349x speedup, step: 4
Epoch 28/300 |loss: 0.003111| train set 2.375x speedup, test set 2.284x speedup, val set 1.333x speedup, step: 5
Epoch 29/300 |loss: 0.003148| train set 2.509x speedup, test set 2.325x speedup, val set 1.530x speedup, step: 6
Epoch 30/300 |loss: 0.003091| train set 2.565x speedup, test set 2.331x speedup, val set 1.329x speedup, step: 7
Epoch 31/300 |loss: 0.003127| train set 2.554x speedup, test set 2.280x speedup, val set 1.549x speedup, step: 8
Epoch 32/300 |loss: 0.002868| train set 2.312x speedup, test set 2.333x speedup, val set 1.522x speedup, step: 9
Epoch 33/300 |loss: 0.002944| train set 2.514x speedup, test set 2.291x speedup, val set 1.366x speedup, step: 10
Epoch 34/300 |loss: 0.002837| train set 2.643x speedup, test set 2.379x speedup, val set 1.409x speedup, step: 11
Epoch 35/300 |loss: 0.002546| train set 2.644x speedup, test set 2.309x speedup, val set 1.274x speedup, step: 12
Epoch 36/300 |loss: 0.002942| train set 2.700x speedup, test set 2.203x speedup, val set 1.526x speedup, step: 13
Epoch 37/300 |loss: 0.002702| train set 2.627x speedup, test set 2.311x speedup, val set 1.274x speedup, step: 14
Epoch 38/300 |loss: 0.002508| train set 2.575x speedup, test set 2.407x speedup, val set 1.264x speedup, step: 15
Epoch 39/300 |loss: 0.002367| train set 2.566x speedup, test set 2.262x speedup, val set 1.262x speedup, step: 16
Epoch 40/300 |loss: 0.002297| train set 2.642x speedup, test set 2.549x speedup, val set 1.366x speedup, step: 17
Epoch 41/300 |loss: 0.002439| train set 2.605x speedup, test set 2.273x speedup, val set 1.262x speedup, step: 18
Epoch 42/300 |loss: 0.002554| train set 2.718x speedup, test set 2.360x speedup, val set 1.357x speedup, step: 19
Epoch 43/300 |loss: 0.002790| train set 2.649x speedup, test set 2.550x speedup, val set 1.397x speedup, step: 20
Epoch 44/300 |loss: 0.002267| train set 2.578x speedup, test set 2.211x speedup, val set 1.259x speedup, step: 21
Epoch 45/300 |loss: 0.002357| train set 2.483x speedup, test set 2.231x speedup, val set 1.368x speedup, step: 22
Epoch 46/300 |loss: 0.002266| train set 2.406x speedup, test set 2.343x speedup, val set 1.264x speedup, step: 23
Epoch 47/300 |loss: 0.002087| train set 2.613x speedup, test set 2.563x speedup, val set 1.277x speedup, step: 24
Epoch 48/300 |loss: 0.002064| train set 2.624x speedup, test set 2.249x speedup, val set 1.366x speedup, step: 25
Epoch 49/300 |loss: 0.002215| train set 2.648x speedup, test set 2.234x speedup, val set 1.366x speedup, step: 26
Epoch 50/300 |loss: 0.001908| train set 2.631x speedup, test set 2.308x speedup, val set 1.276x speedup, step: 27
Epoch 51/300 |loss: 0.001922| train set 2.664x speedup, test set 2.321x speedup, val set 1.512x speedup, step: 28
Epoch 52/300 |loss: 0.001579| train set 2.684x speedup, test set 2.245x speedup, val set 1.522x speedup, step: 29
Epoch 53/300 |loss: 0.001499| train set 2.656x speedup, test set 2.203x speedup, val set 1.413x speedup, step: 30
Epoch 54/300 |loss: 0.001600| train set 2.526x speedup, test set 2.221x speedup, val set 1.267x speedup, step: 31
Epoch 55/300 |loss: 0.001731| train set 2.667x speedup, test set 2.155x speedup, val set 1.527x speedup, step: 32
Epoch 56/300 |loss: 0.001448| train set 2.601x speedup, test set 2.165x speedup, val set 1.523x speedup, step: 33
Epoch 57/300 |loss: 0.001619| train set 2.569x speedup, test set 2.471x speedup, val set 1.522x speedup, step: 34
Epoch 58/300 |loss: 0.002089| train set 2.663x speedup, test set 2.284x speedup, val set 1.438x speedup, step: 35
Epoch 59/300 |loss: 0.001458| train set 2.639x speedup, test set 2.067x speedup, val set 1.523x speedup, step: 36
Epoch 60/300 |loss: 0.001680| train set 2.581x speedup, test set 2.094x speedup, val set 1.523x speedup, step: 37
Epoch 61/300 |loss: 0.002082| train set 2.641x speedup, test set 1.995x speedup, val set 1.381x speedup, step: 38
early stopping at epoch 61
Training per epoch cost 1.196 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 12.431s, pg runtime 14.286s, speedup 1.149x
08, opt runtime 7.237s, model runtime 9.171s, pg runtime 17.708s, speedup 1.931x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
12, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
13, opt runtime 3.332s, model runtime 34.379s, pg runtime 21.298s, speedup 0.620x
14, opt runtime 2.995s, model runtime 33.869s, pg runtime 14.646s, speedup 0.432x
15, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
16, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 7.469s, model runtime 23.223s, pg runtime 23.223s, speedup 1.000x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 66.063s, pg runtime 70.116s, speedup 1.061x
34, opt runtime 39.191s, model runtime 76.171s, pg runtime 75.984s, speedup 0.998x
35, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
36, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
37, opt runtime 15.754s, model runtime 73.566s, pg runtime 15.754s, speedup 0.214x
38, opt runtime 13.961s, model runtime 70.701s, pg runtime 13.961s, speedup 0.197x
39, opt runtime 1.098s, model runtime 1.100s, pg runtime 1.100s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 42, train speedup 2.718, test speedup 2.360, val speedup 1.357
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 24, train speedup 2.356, test speedup 2.316, val speedup 1.549
last model at epoch 61, train speedup 2.641, test speedup 1.995, val speedup 1.381
execution cost 0:01:50.318014
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.661865, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.532x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009284| train set 0.831x speedup, test set 1.244x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008581| train set 0.880x speedup, test set 0.921x speedup, val set 0.936x speedup, step: 3
Epoch 7/300 |loss: 0.008029| train set 0.946x speedup, test set 1.342x speedup, val set 0.914x speedup, step: 4
Epoch 8/300 |loss: 0.007385| train set 0.923x speedup, test set 1.345x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007079| train set 0.974x speedup, test set 1.335x speedup, val set 1.351x speedup, step: 1
Epoch 10/300 |loss: 0.007116| train set 0.946x speedup, test set 2.276x speedup, val set 0.934x speedup, step: 2
Epoch 11/300 |loss: 0.006288| train set 1.243x speedup, test set 1.331x speedup, val set 1.371x speedup, step: 1
Epoch 12/300 |loss: 0.005721| train set 0.932x speedup, test set 2.152x speedup, val set 0.934x speedup, step: 2
Epoch 13/300 |loss: 0.005654| train set 1.333x speedup, test set 2.256x speedup, val set 1.522x speedup, step: 1
Epoch 14/300 |loss: 0.005258| train set 1.317x speedup, test set 1.357x speedup, val set 0.901x speedup, step: 2
Epoch 15/300 |loss: 0.005169| train set 1.386x speedup, test set 1.331x speedup, val set 1.386x speedup, step: 3
Epoch 16/300 |loss: 0.004770| train set 1.447x speedup, test set 1.331x speedup, val set 1.352x speedup, step: 4
Epoch 17/300 |loss: 0.004570| train set 1.377x speedup, test set 1.331x speedup, val set 0.901x speedup, step: 5
Epoch 18/300 |loss: 0.004385| train set 2.425x speedup, test set 2.446x speedup, val set 1.524x speedup, step: 1
Epoch 19/300 |loss: 0.004173| train set 1.370x speedup, test set 2.343x speedup, val set 0.901x speedup, step: 2
Epoch 20/300 |loss: 0.004939| train set 2.339x speedup, test set 1.329x speedup, val set 1.373x speedup, step: 3
Epoch 21/300 |loss: 0.003922| train set 1.372x speedup, test set 1.329x speedup, val set 1.454x speedup, step: 4
Epoch 22/300 |loss: 0.003740| train set 1.287x speedup, test set 2.086x speedup, val set 0.802x speedup, step: 5
Epoch 23/300 |loss: 0.003919| train set 2.475x speedup, test set 1.327x speedup, val set 1.534x speedup, step: 1
Epoch 24/300 |loss: 0.004441| train set 2.459x speedup, test set 2.353x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003491| train set 2.561x speedup, test set 1.324x speedup, val set 1.534x speedup, step: 2
Epoch 26/300 |loss: 0.003402| train set 2.478x speedup, test set 1.327x speedup, val set 1.355x speedup, step: 3
Epoch 27/300 |loss: 0.003401| train set 2.549x speedup, test set 1.314x speedup, val set 1.311x speedup, step: 4
Epoch 28/300 |loss: 0.003092| train set 2.568x speedup, test set 2.426x speedup, val set 0.883x speedup, step: 5
Epoch 29/300 |loss: 0.002966| train set 2.518x speedup, test set 1.329x speedup, val set 1.247x speedup, step: 6
Epoch 30/300 |loss: 0.003125| train set 2.574x speedup, test set 2.186x speedup, val set 1.349x speedup, step: 7
Epoch 31/300 |loss: 0.003533| train set 2.587x speedup, test set 1.317x speedup, val set 1.549x speedup, step: 8
Epoch 32/300 |loss: 0.002841| train set 2.530x speedup, test set 2.401x speedup, val set 1.523x speedup, step: 9
Epoch 33/300 |loss: 0.002961| train set 2.642x speedup, test set 2.317x speedup, val set 1.275x speedup, step: 10
Epoch 34/300 |loss: 0.002699| train set 2.490x speedup, test set 1.322x speedup, val set 1.391x speedup, step: 11
Epoch 35/300 |loss: 0.002549| train set 2.548x speedup, test set 2.447x speedup, val set 1.251x speedup, step: 12
Epoch 36/300 |loss: 0.002769| train set 2.521x speedup, test set 2.493x speedup, val set 1.262x speedup, step: 13
Epoch 37/300 |loss: 0.002621| train set 2.559x speedup, test set 1.413x speedup, val set 1.262x speedup, step: 14
Epoch 38/300 |loss: 0.002351| train set 2.652x speedup, test set 2.211x speedup, val set 1.251x speedup, step: 15
Epoch 39/300 |loss: 0.002232| train set 2.519x speedup, test set 2.418x speedup, val set 1.277x speedup, step: 16
Epoch 40/300 |loss: 0.002478| train set 2.376x speedup, test set 2.492x speedup, val set 1.262x speedup, step: 17
Epoch 41/300 |loss: 0.003198| train set 2.450x speedup, test set 2.096x speedup, val set 1.277x speedup, step: 18
Epoch 42/300 |loss: 0.002744| train set 2.652x speedup, test set 2.010x speedup, val set 1.267x speedup, step: 19
Epoch 43/300 |loss: 0.002756| train set 2.625x speedup, test set 2.052x speedup, val set 1.257x speedup, step: 20
early stopping at epoch 43
Training per epoch cost 1.197 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 14.126s, pg runtime 14.286s, speedup 1.011x
08, opt runtime 7.237s, model runtime 13.362s, pg runtime 17.708s, speedup 1.325x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
12, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
15, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
16, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 7.469s, model runtime 23.223s, pg runtime 23.223s, speedup 1.000x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 9.875s, pg runtime 31.210s, speedup 3.161x
24, opt runtime 6.234s, model runtime 10.545s, pg runtime 32.540s, speedup 3.086x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 70.116s, pg runtime 70.116s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
36, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
37, opt runtime 15.754s, model runtime 73.566s, pg runtime 15.754s, speedup 0.214x
38, opt runtime 13.961s, model runtime 70.701s, pg runtime 13.961s, speedup 0.197x
39, opt runtime 1.098s, model runtime 1.100s, pg runtime 1.100s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 42, train speedup 2.652, test speedup 2.010, val speedup 1.267
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 24, train speedup 2.459, test speedup 2.353, val speedup 1.549
last model at epoch 43, train speedup 2.625, test speedup 2.052, val speedup 1.257
execution cost 0:01:19.871932
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.635919, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.532x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009290| train set 0.831x speedup, test set 1.264x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008610| train set 0.880x speedup, test set 0.921x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008035| train set 0.952x speedup, test set 1.345x speedup, val set 0.908x speedup, step: 4
Epoch 8/300 |loss: 0.007386| train set 0.900x speedup, test set 1.374x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007029| train set 0.972x speedup, test set 1.338x speedup, val set 1.452x speedup, step: 1
Epoch 10/300 |loss: 0.007166| train set 0.987x speedup, test set 2.276x speedup, val set 0.783x speedup, step: 2
Epoch 11/300 |loss: 0.006284| train set 1.216x speedup, test set 1.338x speedup, val set 1.371x speedup, step: 3
Epoch 12/300 |loss: 0.005663| train set 0.966x speedup, test set 2.170x speedup, val set 0.925x speedup, step: 4
Epoch 13/300 |loss: 0.005644| train set 1.297x speedup, test set 2.256x speedup, val set 1.522x speedup, step: 1
Epoch 14/300 |loss: 0.005346| train set 1.324x speedup, test set 1.367x speedup, val set 1.508x speedup, step: 2
Epoch 15/300 |loss: 0.005075| train set 1.356x speedup, test set 1.331x speedup, val set 1.371x speedup, step: 3
Epoch 16/300 |loss: 0.004775| train set 1.364x speedup, test set 1.331x speedup, val set 1.372x speedup, step: 4
Epoch 17/300 |loss: 0.004508| train set 1.394x speedup, test set 1.400x speedup, val set 0.901x speedup, step: 5
Epoch 18/300 |loss: 0.004671| train set 2.395x speedup, test set 1.398x speedup, val set 1.522x speedup, step: 1
Epoch 19/300 |loss: 0.005245| train set 1.403x speedup, test set 1.371x speedup, val set 0.924x speedup, step: 2
Epoch 20/300 |loss: 0.004548| train set 2.492x speedup, test set 1.376x speedup, val set 1.387x speedup, step: 3
Epoch 21/300 |loss: 0.003738| train set 2.182x speedup, test set 2.346x speedup, val set 1.433x speedup, step: 4
Epoch 22/300 |loss: 0.003629| train set 2.441x speedup, test set 2.455x speedup, val set 1.453x speedup, step: 5
Epoch 23/300 |loss: 0.003925| train set 2.270x speedup, test set 1.323x speedup, val set 1.606x speedup, step: 1
Epoch 24/300 |loss: 0.004344| train set 2.551x speedup, test set 1.321x speedup, val set 1.531x speedup, step: 2
Epoch 25/300 |loss: 0.003563| train set 2.489x speedup, test set 1.325x speedup, val set 1.456x speedup, step: 3
Epoch 26/300 |loss: 0.003686| train set 2.535x speedup, test set 1.306x speedup, val set 1.508x speedup, step: 4
Epoch 27/300 |loss: 0.003337| train set 2.532x speedup, test set 1.333x speedup, val set 1.355x speedup, step: 5
Epoch 28/300 |loss: 0.003090| train set 2.583x speedup, test set 1.370x speedup, val set 1.430x speedup, step: 6
Epoch 29/300 |loss: 0.003073| train set 2.324x speedup, test set 2.218x speedup, val set 1.511x speedup, step: 7
Epoch 30/300 |loss: 0.002969| train set 2.506x speedup, test set 2.255x speedup, val set 1.522x speedup, step: 8
Epoch 31/300 |loss: 0.003046| train set 2.574x speedup, test set 1.335x speedup, val set 1.549x speedup, step: 9
Epoch 32/300 |loss: 0.002777| train set 2.455x speedup, test set 1.399x speedup, val set 1.523x speedup, step: 10
Epoch 33/300 |loss: 0.002952| train set 2.590x speedup, test set 1.368x speedup, val set 1.346x speedup, step: 11
Epoch 34/300 |loss: 0.002662| train set 2.516x speedup, test set 1.368x speedup, val set 1.375x speedup, step: 12
Epoch 35/300 |loss: 0.002411| train set 2.614x speedup, test set 1.290x speedup, val set 1.340x speedup, step: 13
Epoch 36/300 |loss: 0.002634| train set 2.641x speedup, test set 1.363x speedup, val set 1.274x speedup, step: 14
Epoch 37/300 |loss: 0.002595| train set 2.654x speedup, test set 1.322x speedup, val set 1.274x speedup, step: 15
Epoch 38/300 |loss: 0.002244| train set 2.624x speedup, test set 1.393x speedup, val set 1.267x speedup, step: 16
Epoch 39/300 |loss: 0.002143| train set 2.642x speedup, test set 1.268x speedup, val set 1.267x speedup, step: 17
Epoch 40/300 |loss: 0.002228| train set 2.600x speedup, test set 1.292x speedup, val set 1.264x speedup, step: 18
Epoch 41/300 |loss: 0.002602| train set 2.613x speedup, test set 1.307x speedup, val set 1.245x speedup, step: 19
Epoch 42/300 |loss: 0.002466| train set 2.694x speedup, test set 1.325x speedup, val set 1.725x speedup, step: 1
Epoch 43/300 |loss: 0.002431| train set 2.625x speedup, test set 1.347x speedup, val set 1.276x speedup, step: 2
Epoch 44/300 |loss: 0.001996| train set 2.626x speedup, test set 1.257x speedup, val set 1.350x speedup, step: 3
Epoch 45/300 |loss: 0.002396| train set 2.494x speedup, test set 1.267x speedup, val set 1.346x speedup, step: 4
Epoch 46/300 |loss: 0.001835| train set 2.683x speedup, test set 1.268x speedup, val set 1.721x speedup, step: 5
Epoch 47/300 |loss: 0.001841| train set 2.702x speedup, test set 1.287x speedup, val set 1.267x speedup, step: 6
Epoch 48/300 |loss: 0.001933| train set 2.670x speedup, test set 1.267x speedup, val set 1.350x speedup, step: 7
Epoch 49/300 |loss: 0.002240| train set 2.657x speedup, test set 1.288x speedup, val set 1.934x speedup, step: 1
Epoch 50/300 |loss: 0.001953| train set 2.558x speedup, test set 1.285x speedup, val set 1.894x speedup, step: 2
Epoch 51/300 |loss: 0.001805| train set 2.608x speedup, test set 1.295x speedup, val set 1.894x speedup, step: 3
Epoch 52/300 |loss: 0.001498| train set 2.564x speedup, test set 1.257x speedup, val set 1.903x speedup, step: 4
Epoch 53/300 |loss: 0.001537| train set 2.700x speedup, test set 1.262x speedup, val set 1.370x speedup, step: 5
Epoch 54/300 |loss: 0.001443| train set 2.652x speedup, test set 1.292x speedup, val set 1.245x speedup, step: 6
Epoch 55/300 |loss: 0.001484| train set 2.670x speedup, test set 1.291x speedup, val set 2.254x speedup, step: 1
Epoch 56/300 |loss: 0.001340| train set 2.479x speedup, test set 1.291x speedup, val set 1.346x speedup, step: 2
Epoch 57/300 |loss: 0.001392| train set 2.672x speedup, test set 1.262x speedup, val set 2.263x speedup, step: 1
Epoch 58/300 |loss: 0.001878| train set 2.671x speedup, test set 1.291x speedup, val set 2.263x speedup, step: 1
Epoch 59/300 |loss: 0.001354| train set 2.647x speedup, test set 1.264x speedup, val set 1.927x speedup, step: 2
Epoch 60/300 |loss: 0.001571| train set 2.576x speedup, test set 1.253x speedup, val set 1.894x speedup, step: 3
Epoch 61/300 |loss: 0.001942| train set 2.678x speedup, test set 1.284x speedup, val set 1.369x speedup, step: 4
early stopping at epoch 61
Training per epoch cost 1.200 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 38.816s, pg runtime 73.019s, speedup 1.881x
12, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 2.995s, model runtime 22.999s, pg runtime 14.646s, speedup 0.637x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
18, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
19, opt runtime 1.309s, model runtime 1.382s, pg runtime 1.356s, speedup 0.981x
20, opt runtime 1.340s, model runtime 1.478s, pg runtime 1.340s, speedup 0.907x
21, opt runtime 6.281s, model runtime 49.848s, pg runtime 6.281s, speedup 0.126x
22, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
23, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
32, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
33, opt runtime 35.538s, model runtime 41.909s, pg runtime 70.116s, speedup 1.673x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 16.138s, model runtime 638.331s, pg runtime 501.793s, speedup 0.786x
36, opt runtime 16.438s, model runtime 516.443s, pg runtime 546.887s, speedup 1.059x
37, opt runtime 15.754s, model runtime 104.295s, pg runtime 15.754s, speedup 0.151x
38, opt runtime 13.961s, model runtime 103.136s, pg runtime 13.961s, speedup 0.135x
39, opt runtime 1.098s, model runtime 1.100s, pg runtime 1.100s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 47, train speedup 2.702, test speedup 1.287, val speedup 1.267
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 58, train speedup 2.671, test speedup 1.291, val speedup 2.263
last model at epoch 61, train speedup 2.678, test speedup 1.284, val speedup 1.369
execution cost 0:01:50.412886
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.698605, and there are 3528 training samples
in channel 9
Epoch 0/300 |loss: 0.032287| train set 0.837x speedup, test set 2.614x speedup, val set 0.951x speedup, step: 1
Epoch 1/300 |loss: 0.014340| train set 0.791x speedup, test set 2.459x speedup, val set 0.990x speedup, step: 1
Epoch 2/300 |loss: 0.012260| train set 0.774x speedup, test set 2.628x speedup, val set 1.023x speedup, step: 1
Epoch 3/300 |loss: 0.011386| train set 0.780x speedup, test set 2.684x speedup, val set 1.023x speedup, step: 1
Epoch 4/300 |loss: 0.010403| train set 0.778x speedup, test set 2.532x speedup, val set 1.023x speedup, step: 1
Epoch 5/300 |loss: 0.009285| train set 0.833x speedup, test set 1.244x speedup, val set 0.908x speedup, step: 2
Epoch 6/300 |loss: 0.008576| train set 0.880x speedup, test set 0.937x speedup, val set 1.012x speedup, step: 3
Epoch 7/300 |loss: 0.008032| train set 0.946x speedup, test set 1.342x speedup, val set 0.914x speedup, step: 4
Epoch 8/300 |loss: 0.007407| train set 0.923x speedup, test set 1.345x speedup, val set 0.925x speedup, step: 5
Epoch 9/300 |loss: 0.007165| train set 0.971x speedup, test set 1.335x speedup, val set 1.429x speedup, step: 1
Epoch 10/300 |loss: 0.006887| train set 0.937x speedup, test set 2.170x speedup, val set 0.802x speedup, step: 2
Epoch 11/300 |loss: 0.006089| train set 1.238x speedup, test set 1.345x speedup, val set 0.900x speedup, step: 3
Epoch 12/300 |loss: 0.005608| train set 0.800x speedup, test set 2.232x speedup, val set 0.925x speedup, step: 4
Epoch 13/300 |loss: 0.006075| train set 1.273x speedup, test set 2.276x speedup, val set 1.340x speedup, step: 5
Epoch 14/300 |loss: 0.005342| train set 1.341x speedup, test set 1.367x speedup, val set 0.891x speedup, step: 6
Epoch 15/300 |loss: 0.005542| train set 1.277x speedup, test set 1.364x speedup, val set 0.900x speedup, step: 7
Epoch 16/300 |loss: 0.006076| train set 2.151x speedup, test set 1.373x speedup, val set 1.523x speedup, step: 1
Epoch 17/300 |loss: 0.004951| train set 1.266x speedup, test set 1.328x speedup, val set 0.801x speedup, step: 2
Epoch 18/300 |loss: 0.004386| train set 2.277x speedup, test set 1.364x speedup, val set 1.522x speedup, step: 3
Epoch 19/300 |loss: 0.005031| train set 1.317x speedup, test set 1.371x speedup, val set 0.917x speedup, step: 4
Epoch 20/300 |loss: 0.005041| train set 1.457x speedup, test set 1.372x speedup, val set 1.352x speedup, step: 5
Epoch 21/300 |loss: 0.004014| train set 1.413x speedup, test set 1.368x speedup, val set 0.922x speedup, step: 6
Epoch 22/300 |loss: 0.003862| train set 1.408x speedup, test set 2.243x speedup, val set 1.355x speedup, step: 7
Epoch 23/300 |loss: 0.004143| train set 2.498x speedup, test set 1.362x speedup, val set 1.457x speedup, step: 8
Epoch 24/300 |loss: 0.003856| train set 2.564x speedup, test set 2.370x speedup, val set 1.549x speedup, step: 1
Epoch 25/300 |loss: 0.003565| train set 2.447x speedup, test set 2.262x speedup, val set 1.549x speedup, step: 1
Epoch 26/300 |loss: 0.003705| train set 2.443x speedup, test set 1.348x speedup, val set 1.530x speedup, step: 2
Epoch 27/300 |loss: 0.003457| train set 2.396x speedup, test set 1.291x speedup, val set 1.357x speedup, step: 3
Epoch 28/300 |loss: 0.003181| train set 2.494x speedup, test set 2.351x speedup, val set 1.259x speedup, step: 4
Epoch 29/300 |loss: 0.003114| train set 2.503x speedup, test set 2.154x speedup, val set 1.511x speedup, step: 5
Epoch 30/300 |loss: 0.003280| train set 2.548x speedup, test set 2.325x speedup, val set 1.367x speedup, step: 6
Epoch 31/300 |loss: 0.003244| train set 2.590x speedup, test set 2.374x speedup, val set 1.534x speedup, step: 7
Epoch 32/300 |loss: 0.002927| train set 2.507x speedup, test set 1.433x speedup, val set 1.549x speedup, step: 1
Epoch 33/300 |loss: 0.002827| train set 2.539x speedup, test set 2.356x speedup, val set 1.277x speedup, step: 2
Epoch 34/300 |loss: 0.002865| train set 2.569x speedup, test set 1.350x speedup, val set 1.259x speedup, step: 3
Epoch 35/300 |loss: 0.002775| train set 2.582x speedup, test set 2.244x speedup, val set 0.854x speedup, step: 4
Epoch 36/300 |loss: 0.002776| train set 2.521x speedup, test set 1.401x speedup, val set 1.367x speedup, step: 5
Epoch 37/300 |loss: 0.002555| train set 2.607x speedup, test set 1.352x speedup, val set 1.262x speedup, step: 6
Epoch 38/300 |loss: 0.002489| train set 2.632x speedup, test set 1.357x speedup, val set 1.251x speedup, step: 7
Epoch 39/300 |loss: 0.002460| train set 2.559x speedup, test set 1.409x speedup, val set 1.262x speedup, step: 8
Epoch 40/300 |loss: 0.002517| train set 2.509x speedup, test set 1.435x speedup, val set 1.234x speedup, step: 9
Epoch 41/300 |loss: 0.002674| train set 2.605x speedup, test set 1.325x speedup, val set 1.277x speedup, step: 10
Epoch 42/300 |loss: 0.002700| train set 2.619x speedup, test set 2.199x speedup, val set 1.251x speedup, step: 11
Epoch 43/300 |loss: 0.002874| train set 2.710x speedup, test set 1.398x speedup, val set 1.273x speedup, step: 12
Epoch 44/300 |loss: 0.002494| train set 2.581x speedup, test set 2.198x speedup, val set 1.260x speedup, step: 13
Epoch 45/300 |loss: 0.002412| train set 2.473x speedup, test set 2.155x speedup, val set 1.360x speedup, step: 14
Epoch 46/300 |loss: 0.002081| train set 2.521x speedup, test set 1.441x speedup, val set 1.249x speedup, step: 15
Epoch 47/300 |loss: 0.002275| train set 2.531x speedup, test set 1.417x speedup, val set 0.885x speedup, step: 16
Epoch 48/300 |loss: 0.002385| train set 2.678x speedup, test set 2.130x speedup, val set 1.350x speedup, step: 17
Epoch 49/300 |loss: 0.002207| train set 2.637x speedup, test set 1.355x speedup, val set 1.267x speedup, step: 18
Epoch 50/300 |loss: 0.001884| train set 2.590x speedup, test set 1.374x speedup, val set 1.277x speedup, step: 19
Epoch 51/300 |loss: 0.002139| train set 2.650x speedup, test set 0.964x speedup, val set 1.260x speedup, step: 20
Epoch 52/300 |loss: 0.001856| train set 2.613x speedup, test set 1.094x speedup, val set 1.369x speedup, step: 21
Epoch 53/300 |loss: 0.001718| train set 2.640x speedup, test set 1.427x speedup, val set 1.436x speedup, step: 22
Epoch 54/300 |loss: 0.001664| train set 2.636x speedup, test set 1.067x speedup, val set 1.276x speedup, step: 23
Epoch 55/300 |loss: 0.001898| train set 2.674x speedup, test set 0.921x speedup, val set 0.866x speedup, step: 24
Epoch 56/300 |loss: 0.001489| train set 2.613x speedup, test set 1.076x speedup, val set 1.350x speedup, step: 25
Epoch 57/300 |loss: 0.001437| train set 2.648x speedup, test set 0.917x speedup, val set 1.888x speedup, step: 1
Epoch 58/300 |loss: 0.001938| train set 2.590x speedup, test set 1.103x speedup, val set 1.527x speedup, step: 2
Epoch 59/300 |loss: 0.001528| train set 2.668x speedup, test set 1.358x speedup, val set 0.967x speedup, step: 3
Epoch 60/300 |loss: 0.001667| train set 2.553x speedup, test set 1.322x speedup, val set 0.909x speedup, step: 4
Epoch 61/300 |loss: 0.001566| train set 2.672x speedup, test set 1.066x speedup, val set 0.900x speedup, step: 5
Epoch 62/300 |loss: 0.001240| train set 2.631x speedup, test set 1.068x speedup, val set 0.908x speedup, step: 6
Epoch 63/300 |loss: 0.001302| train set 2.689x speedup, test set 1.374x speedup, val set 0.904x speedup, step: 7
Epoch 64/300 |loss: 0.001301| train set 2.223x speedup, test set 1.343x speedup, val set 0.909x speedup, step: 8
Epoch 65/300 |loss: 0.001460| train set 2.691x speedup, test set 1.089x speedup, val set 0.882x speedup, step: 9
Epoch 66/300 |loss: 0.001188| train set 2.529x speedup, test set 1.064x speedup, val set 0.905x speedup, step: 10
Epoch 67/300 |loss: 0.001566| train set 2.717x speedup, test set 1.276x speedup, val set 1.205x speedup, step: 11
Epoch 68/300 |loss: 0.001475| train set 2.676x speedup, test set 1.065x speedup, val set 1.297x speedup, step: 12
Epoch 69/300 |loss: 0.001544| train set 2.618x speedup, test set 0.937x speedup, val set 0.914x speedup, step: 13
Epoch 70/300 |loss: 0.001586| train set 2.665x speedup, test set 1.309x speedup, val set 0.914x speedup, step: 14
Epoch 71/300 |loss: 0.001179| train set 2.642x speedup, test set 1.356x speedup, val set 0.909x speedup, step: 15
Epoch 72/300 |loss: 0.001029| train set 2.699x speedup, test set 1.224x speedup, val set 0.909x speedup, step: 16
Epoch 73/300 |loss: 0.001447| train set 2.714x speedup, test set 1.507x speedup, val set 0.908x speedup, step: 17
Epoch 74/300 |loss: 0.001028| train set 2.708x speedup, test set 1.821x speedup, val set 0.909x speedup, step: 18
Epoch 75/300 |loss: 0.000946| train set 2.674x speedup, test set 1.030x speedup, val set 0.909x speedup, step: 19
Epoch 76/300 |loss: 0.000855| train set 2.667x speedup, test set 1.507x speedup, val set 0.900x speedup, step: 20
Epoch 77/300 |loss: 0.000931| train set 2.666x speedup, test set 1.065x speedup, val set 0.860x speedup, step: 21
Epoch 78/300 |loss: 0.000926| train set 2.712x speedup, test set 1.063x speedup, val set 0.914x speedup, step: 22
Epoch 79/300 |loss: 0.000808| train set 2.772x speedup, test set 1.075x speedup, val set 0.914x speedup, step: 23
Epoch 80/300 |loss: 0.000770| train set 2.742x speedup, test set 1.330x speedup, val set 0.909x speedup, step: 24
Epoch 81/300 |loss: 0.000978| train set 2.722x speedup, test set 1.507x speedup, val set 0.872x speedup, step: 25
Epoch 82/300 |loss: 0.001088| train set 2.639x speedup, test set 1.584x speedup, val set 0.904x speedup, step: 26
Epoch 83/300 |loss: 0.000840| train set 2.754x speedup, test set 1.543x speedup, val set 0.914x speedup, step: 27
Epoch 84/300 |loss: 0.001294| train set 2.718x speedup, test set 1.540x speedup, val set 0.909x speedup, step: 28
Epoch 85/300 |loss: 0.000981| train set 2.725x speedup, test set 1.523x speedup, val set 0.914x speedup, step: 29
early stopping at epoch 85
Training per epoch cost 1.196 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 34.611s, pg runtime 18.665s, speedup 0.539x
02, opt runtime 25.356s, model runtime 38.255s, pg runtime 25.356s, speedup 0.663x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 29.763s, model runtime 99.246s, pg runtime 91.648s, speedup 0.923x
05, opt runtime 23.961s, model runtime 23.961s, pg runtime 32.278s, speedup 1.347x
06, opt runtime 19.263s, model runtime 30.418s, pg runtime 19.263s, speedup 0.633x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 60.927s, pg runtime 73.019s, speedup 1.198x
12, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 2.995s, model runtime 14.646s, pg runtime 14.646s, speedup 1.000x
15, opt runtime 47.518s, model runtime 120.739s, pg runtime 75.736s, speedup 0.627x
16, opt runtime 48.784s, model runtime 124.142s, pg runtime 78.349s, speedup 0.631x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.382s, pg runtime 1.356s, speedup 0.981x
20, opt runtime 1.340s, model runtime 1.478s, pg runtime 1.340s, speedup 0.907x
21, opt runtime 6.281s, model runtime 49.848s, pg runtime 6.281s, speedup 0.126x
22, opt runtime 25.034s, model runtime 46.104s, pg runtime 25.034s, speedup 0.543x
23, opt runtime 5.961s, model runtime 10.298s, pg runtime 31.210s, speedup 3.031x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.306s, model runtime 2.153s, pg runtime 1.306s, speedup 0.607x
26, opt runtime 1.342s, model runtime 2.085s, pg runtime 1.342s, speedup 0.644x
27, opt runtime 7.066s, model runtime 9.776s, pg runtime 7.533s, speedup 0.771x
28, opt runtime 7.268s, model runtime 10.315s, pg runtime 7.268s, speedup 0.705x
29, opt runtime 5.414s, model runtime 11.537s, pg runtime 5.414s, speedup 0.469x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 25.363s, model runtime 607.433s, pg runtime 611.327s, speedup 1.006x
32, opt runtime 24.706s, model runtime 596.799s, pg runtime 610.808s, speedup 1.023x
33, opt runtime 35.538s, model runtime 70.116s, pg runtime 70.116s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 16.138s, model runtime 501.793s, pg runtime 501.793s, speedup 1.000x
36, opt runtime 16.438s, model runtime 546.887s, pg runtime 546.887s, speedup 1.000x
37, opt runtime 15.754s, model runtime 104.295s, pg runtime 15.754s, speedup 0.151x
38, opt runtime 13.961s, model runtime 103.136s, pg runtime 13.961s, speedup 0.135x
39, opt runtime 1.098s, model runtime 1.100s, pg runtime 1.100s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 79, train speedup 2.772, test speedup 1.075, val speedup 0.914
best test speedup epoch: 3, train speedup 0.780, test speedup 2.684, val speedup 1.023
best validation speedup epoch: 57, train speedup 2.648, test speedup 0.917, val speedup 1.888
last model at epoch 85, train speedup 2.725, test speedup 1.523, val speedup 0.914
execution cost 0:02:29.411296
==================================================
