all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.320784, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023067| train set 0.693x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020860| train set 0.861x speedup, test set 0.855x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019298| train set 1.024x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016803| train set 0.954x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017498| train set 1.009x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014889| train set 1.003x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014106| train set 0.991x speedup, test set 1.012x speedup, val set 0.851x speedup, step: 5
Epoch 9/300 |loss: 0.013474| train set 0.747x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 6
Epoch 10/300 |loss: 0.013446| train set 2.391x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 7
Epoch 11/300 |loss: 0.012529| train set 1.826x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010925| train set 1.870x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010680| train set 2.236x speedup, test set 0.969x speedup, val set 0.862x speedup, step: 10
Epoch 14/300 |loss: 0.010101| train set 2.729x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.009615| train set 3.172x speedup, test set 0.969x speedup, val set 0.831x speedup, step: 12
Epoch 16/300 |loss: 0.009141| train set 2.597x speedup, test set 0.969x speedup, val set 0.827x speedup, step: 13
Epoch 17/300 |loss: 0.009464| train set 1.723x speedup, test set 0.958x speedup, val set 0.836x speedup, step: 14
Epoch 18/300 |loss: 0.008655| train set 3.161x speedup, test set 0.969x speedup, val set 0.843x speedup, step: 15
Epoch 19/300 |loss: 0.007750| train set 3.207x speedup, test set 0.974x speedup, val set 0.843x speedup, step: 16
Epoch 20/300 |loss: 0.007732| train set 2.507x speedup, test set 0.958x speedup, val set 0.852x speedup, step: 17
Epoch 21/300 |loss: 0.007045| train set 2.773x speedup, test set 0.958x speedup, val set 0.843x speedup, step: 18
Epoch 22/300 |loss: 0.006402| train set 2.937x speedup, test set 0.963x speedup, val set 0.844x speedup, step: 19
Epoch 23/300 |loss: 0.005954| train set 3.121x speedup, test set 0.973x speedup, val set 0.916x speedup, step: 20
Epoch 24/300 |loss: 0.006932| train set 2.683x speedup, test set 0.969x speedup, val set 0.815x speedup, step: 21
Epoch 25/300 |loss: 0.006256| train set 2.812x speedup, test set 0.974x speedup, val set 0.822x speedup, step: 22
Epoch 26/300 |loss: 0.005421| train set 2.720x speedup, test set 0.974x speedup, val set 0.823x speedup, step: 23
Epoch 27/300 |loss: 0.006132| train set 2.643x speedup, test set 0.969x speedup, val set 0.911x speedup, step: 24
Epoch 28/300 |loss: 0.005233| train set 3.145x speedup, test set 0.969x speedup, val set 0.908x speedup, step: 25
Epoch 29/300 |loss: 0.005009| train set 3.168x speedup, test set 0.938x speedup, val set 0.831x speedup, step: 26
Epoch 30/300 |loss: 0.005289| train set 3.155x speedup, test set 0.974x speedup, val set 0.910x speedup, step: 27
Epoch 31/300 |loss: 0.004465| train set 2.781x speedup, test set 0.974x speedup, val set 0.822x speedup, step: 28
Epoch 32/300 |loss: 0.004295| train set 2.504x speedup, test set 0.969x speedup, val set 0.890x speedup, step: 29
Epoch 33/300 |loss: 0.004132| train set 3.239x speedup, test set 0.969x speedup, val set 0.906x speedup, step: 30
Epoch 34/300 |loss: 0.004238| train set 3.054x speedup, test set 0.938x speedup, val set 0.973x speedup, step: 31
Epoch 35/300 |loss: 0.005776| train set 3.284x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 32
Epoch 36/300 |loss: 0.003462| train set 3.237x speedup, test set 0.943x speedup, val set 0.890x speedup, step: 33
Epoch 37/300 |loss: 0.003552| train set 2.783x speedup, test set 0.927x speedup, val set 0.909x speedup, step: 34
Epoch 38/300 |loss: 0.004206| train set 3.091x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 35
Epoch 39/300 |loss: 0.004353| train set 3.259x speedup, test set 0.927x speedup, val set 0.890x speedup, step: 36
Epoch 40/300 |loss: 0.003725| train set 3.286x speedup, test set 0.932x speedup, val set 0.890x speedup, step: 37
Epoch 41/300 |loss: 0.003059| train set 3.112x speedup, test set 0.943x speedup, val set 0.808x speedup, step: 38
Epoch 42/300 |loss: 0.003385| train set 3.163x speedup, test set 0.932x speedup, val set 0.808x speedup, step: 39
Epoch 43/300 |loss: 0.003399| train set 3.199x speedup, test set 0.943x speedup, val set 0.890x speedup, step: 40
Epoch 44/300 |loss: 0.003088| train set 3.280x speedup, test set 0.943x speedup, val set 0.888x speedup, step: 41
Epoch 45/300 |loss: 0.002549| train set 3.118x speedup, test set 0.932x speedup, val set 0.811x speedup, step: 42
Epoch 46/300 |loss: 0.002867| train set 3.149x speedup, test set 0.938x speedup, val set 0.789x speedup, step: 43
Epoch 47/300 |loss: 0.002820| train set 3.127x speedup, test set 0.927x speedup, val set 0.810x speedup, step: 44
Epoch 48/300 |loss: 0.002874| train set 3.277x speedup, test set 0.938x speedup, val set 0.810x speedup, step: 45
Epoch 49/300 |loss: 0.002682| train set 3.084x speedup, test set 0.927x speedup, val set 0.865x speedup, step: 46
Epoch 50/300 |loss: 0.002669| train set 3.334x speedup, test set 0.900x speedup, val set 0.808x speedup, step: 47
Epoch 51/300 |loss: 0.003016| train set 3.223x speedup, test set 0.938x speedup, val set 0.810x speedup, step: 48
Epoch 52/300 |loss: 0.002497| train set 3.310x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 49
Epoch 53/300 |loss: 0.002460| train set 3.360x speedup, test set 0.896x speedup, val set 0.888x speedup, step: 50
Epoch 54/300 |loss: 0.003105| train set 3.155x speedup, test set 0.938x speedup, val set 0.718x speedup, step: 51
Epoch 55/300 |loss: 0.003092| train set 3.157x speedup, test set 0.927x speedup, val set 0.716x speedup, step: 52
early stopping at epoch 55
Training per epoch cost 2.440 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 53, train speedup 3.360, test speedup 0.896, val speedup 0.888
best test speedup epoch: 2, train speedup 0.693, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.024, test speedup 6.351, val speedup 1.339
last model at epoch 55, train speedup 3.157, test speedup 0.927, val speedup 0.716
execution cost 0:03:57.730766
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.381762, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023060| train set 0.692x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020869| train set 0.866x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019233| train set 1.023x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016793| train set 0.987x speedup, test set 0.952x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017262| train set 0.960x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014923| train set 1.016x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014120| train set 0.996x speedup, test set 1.012x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013607| train set 0.775x speedup, test set 1.012x speedup, val set 0.856x speedup, step: 6
Epoch 10/300 |loss: 0.013154| train set 2.204x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 7
Epoch 11/300 |loss: 0.012085| train set 1.984x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011357| train set 2.069x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010737| train set 2.410x speedup, test set 0.969x speedup, val set 0.862x speedup, step: 10
Epoch 14/300 |loss: 0.010532| train set 2.324x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009530| train set 2.782x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 12
Epoch 16/300 |loss: 0.009254| train set 2.321x speedup, test set 0.958x speedup, val set 0.831x speedup, step: 13
Epoch 17/300 |loss: 0.009097| train set 1.943x speedup, test set 0.958x speedup, val set 0.861x speedup, step: 14
Epoch 18/300 |loss: 0.008648| train set 3.263x speedup, test set 0.982x speedup, val set 0.844x speedup, step: 15
Epoch 19/300 |loss: 0.007898| train set 3.024x speedup, test set 0.914x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.008213| train set 2.107x speedup, test set 0.914x speedup, val set 0.858x speedup, step: 17
Epoch 21/300 |loss: 0.007263| train set 2.614x speedup, test set 0.914x speedup, val set 0.859x speedup, step: 18
Epoch 22/300 |loss: 0.006620| train set 3.023x speedup, test set 0.958x speedup, val set 0.909x speedup, step: 19
Epoch 23/300 |loss: 0.006097| train set 3.059x speedup, test set 0.958x speedup, val set 0.860x speedup, step: 20
Epoch 24/300 |loss: 0.007171| train set 2.694x speedup, test set 0.914x speedup, val set 0.815x speedup, step: 21
Epoch 25/300 |loss: 0.006546| train set 2.659x speedup, test set 0.914x speedup, val set 0.838x speedup, step: 22
Epoch 26/300 |loss: 0.005842| train set 2.723x speedup, test set 0.914x speedup, val set 0.823x speedup, step: 23
Epoch 27/300 |loss: 0.005715| train set 2.546x speedup, test set 0.914x speedup, val set 0.906x speedup, step: 24
Epoch 28/300 |loss: 0.005799| train set 3.004x speedup, test set 0.958x speedup, val set 0.859x speedup, step: 25
Epoch 29/300 |loss: 0.005099| train set 3.159x speedup, test set 0.914x speedup, val set 0.906x speedup, step: 26
Epoch 30/300 |loss: 0.005177| train set 3.124x speedup, test set 0.914x speedup, val set 0.840x speedup, step: 27
Epoch 31/300 |loss: 0.004784| train set 2.678x speedup, test set 0.914x speedup, val set 0.838x speedup, step: 28
Epoch 32/300 |loss: 0.004821| train set 3.171x speedup, test set 0.958x speedup, val set 0.932x speedup, step: 29
Epoch 33/300 |loss: 0.005212| train set 3.206x speedup, test set 0.958x speedup, val set 0.907x speedup, step: 30
Epoch 34/300 |loss: 0.004508| train set 3.189x speedup, test set 0.952x speedup, val set 0.910x speedup, step: 31
Epoch 35/300 |loss: 0.004293| train set 3.176x speedup, test set 0.922x speedup, val set 0.906x speedup, step: 32
Epoch 36/300 |loss: 0.003258| train set 3.251x speedup, test set 0.952x speedup, val set 0.823x speedup, step: 33
Epoch 37/300 |loss: 0.003577| train set 3.142x speedup, test set 0.958x speedup, val set 0.893x speedup, step: 34
Epoch 38/300 |loss: 0.004736| train set 3.135x speedup, test set 0.952x speedup, val set 0.891x speedup, step: 35
Epoch 39/300 |loss: 0.004668| train set 3.254x speedup, test set 0.927x speedup, val set 0.836x speedup, step: 36
Epoch 40/300 |loss: 0.004102| train set 3.255x speedup, test set 0.927x speedup, val set 0.908x speedup, step: 37
Epoch 41/300 |loss: 0.003034| train set 3.116x speedup, test set 0.931x speedup, val set 0.893x speedup, step: 38
Epoch 42/300 |loss: 0.003151| train set 3.210x speedup, test set 0.927x speedup, val set 0.892x speedup, step: 39
Epoch 43/300 |loss: 0.003427| train set 3.186x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 40
Epoch 44/300 |loss: 0.003437| train set 3.271x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 41
Epoch 45/300 |loss: 0.002591| train set 3.342x speedup, test set 0.927x speedup, val set 0.890x speedup, step: 42
Epoch 46/300 |loss: 0.003001| train set 3.245x speedup, test set 0.927x speedup, val set 0.908x speedup, step: 43
Epoch 47/300 |loss: 0.003325| train set 3.268x speedup, test set 0.927x speedup, val set 0.754x speedup, step: 44
Epoch 48/300 |loss: 0.003014| train set 3.217x speedup, test set 0.927x speedup, val set 0.838x speedup, step: 45
Epoch 49/300 |loss: 0.002775| train set 3.366x speedup, test set 0.927x speedup, val set 0.811x speedup, step: 46
Epoch 50/300 |loss: 0.002815| train set 3.302x speedup, test set 0.927x speedup, val set 0.808x speedup, step: 47
Epoch 51/300 |loss: 0.003642| train set 3.219x speedup, test set 0.924x speedup, val set 0.809x speedup, step: 48
Epoch 52/300 |loss: 0.002787| train set 3.314x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 49
Epoch 53/300 |loss: 0.002463| train set 3.341x speedup, test set 0.927x speedup, val set 0.910x speedup, step: 50
Epoch 54/300 |loss: 0.002572| train set 3.167x speedup, test set 0.927x speedup, val set 0.733x speedup, step: 51
Epoch 55/300 |loss: 0.002766| train set 3.252x speedup, test set 0.927x speedup, val set 0.810x speedup, step: 52
Epoch 56/300 |loss: 0.002830| train set 3.265x speedup, test set 0.927x speedup, val set 0.733x speedup, step: 53
Epoch 57/300 |loss: 0.002422| train set 3.230x speedup, test set 0.927x speedup, val set 0.733x speedup, step: 54
Epoch 58/300 |loss: 0.002347| train set 3.307x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 55
Epoch 59/300 |loss: 0.002333| train set 3.313x speedup, test set 0.927x speedup, val set 0.734x speedup, step: 56
Epoch 60/300 |loss: 0.002207| train set 3.267x speedup, test set 0.927x speedup, val set 0.813x speedup, step: 57
Epoch 61/300 |loss: 0.002355| train set 3.266x speedup, test set 0.922x speedup, val set 0.881x speedup, step: 58
Epoch 62/300 |loss: 0.002256| train set 3.308x speedup, test set 0.927x speedup, val set 0.732x speedup, step: 59
Epoch 63/300 |loss: 0.002220| train set 3.294x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 60
Epoch 64/300 |loss: 0.002096| train set 3.314x speedup, test set 0.922x speedup, val set 0.801x speedup, step: 61
Epoch 65/300 |loss: 0.001999| train set 3.243x speedup, test set 0.927x speedup, val set 0.813x speedup, step: 62
Epoch 66/300 |loss: 0.002001| train set 3.353x speedup, test set 0.927x speedup, val set 0.733x speedup, step: 63
Epoch 67/300 |loss: 0.002399| train set 3.241x speedup, test set 0.927x speedup, val set 0.894x speedup, step: 64
Epoch 68/300 |loss: 0.002051| train set 3.246x speedup, test set 0.927x speedup, val set 0.792x speedup, step: 65
Epoch 69/300 |loss: 0.002101| train set 3.257x speedup, test set 0.922x speedup, val set 0.911x speedup, step: 66
Epoch 70/300 |loss: 0.001893| train set 3.319x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 67
Epoch 71/300 |loss: 0.002010| train set 3.114x speedup, test set 0.927x speedup, val set 0.813x speedup, step: 68
Epoch 72/300 |loss: 0.001840| train set 3.381x speedup, test set 0.927x speedup, val set 0.910x speedup, step: 69
Epoch 73/300 |loss: 0.002075| train set 3.340x speedup, test set 0.927x speedup, val set 0.912x speedup, step: 70
Epoch 74/300 |loss: 0.002082| train set 3.291x speedup, test set 0.927x speedup, val set 0.811x speedup, step: 71
early stopping at epoch 74
Training per epoch cost 2.338 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 72, train speedup 3.381, test speedup 0.927, val speedup 0.910
best test speedup epoch: 2, train speedup 0.692, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.023, test speedup 6.351, val speedup 1.396
last model at epoch 74, train speedup 3.291, test speedup 0.927, val speedup 0.811
execution cost 0:04:58.974019
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.355942, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019281| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016858| train set 0.977x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017525| train set 0.967x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014925| train set 0.995x speedup, test set 1.012x speedup, val set 0.861x speedup, step: 4
Epoch 8/300 |loss: 0.014166| train set 0.991x speedup, test set 1.012x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013807| train set 0.728x speedup, test set 1.012x speedup, val set 0.859x speedup, step: 6
Epoch 10/300 |loss: 0.013574| train set 2.210x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.012831| train set 1.871x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011282| train set 1.757x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010747| train set 2.236x speedup, test set 0.969x speedup, val set 0.865x speedup, step: 10
Epoch 14/300 |loss: 0.010497| train set 2.384x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.009539| train set 3.139x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009271| train set 2.508x speedup, test set 0.952x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.009483| train set 1.805x speedup, test set 0.958x speedup, val set 0.858x speedup, step: 14
Epoch 18/300 |loss: 0.009534| train set 2.970x speedup, test set 0.969x speedup, val set 0.842x speedup, step: 15
Epoch 19/300 |loss: 0.008260| train set 3.123x speedup, test set 0.952x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.008290| train set 2.492x speedup, test set 0.958x speedup, val set 0.840x speedup, step: 17
Epoch 21/300 |loss: 0.007262| train set 2.848x speedup, test set 0.914x speedup, val set 0.836x speedup, step: 18
Epoch 22/300 |loss: 0.006850| train set 3.001x speedup, test set 0.958x speedup, val set 0.911x speedup, step: 19
Epoch 23/300 |loss: 0.006109| train set 3.108x speedup, test set 0.914x speedup, val set 0.910x speedup, step: 20
Epoch 24/300 |loss: 0.006837| train set 2.613x speedup, test set 0.952x speedup, val set 0.833x speedup, step: 21
Epoch 25/300 |loss: 0.006462| train set 3.022x speedup, test set 0.952x speedup, val set 0.838x speedup, step: 22
Epoch 26/300 |loss: 0.005728| train set 2.674x speedup, test set 0.952x speedup, val set 0.838x speedup, step: 23
Epoch 27/300 |loss: 0.005949| train set 2.713x speedup, test set 0.952x speedup, val set 0.900x speedup, step: 24
Epoch 28/300 |loss: 0.005567| train set 3.059x speedup, test set 0.952x speedup, val set 0.924x speedup, step: 25
Epoch 29/300 |loss: 0.005213| train set 3.098x speedup, test set 0.952x speedup, val set 0.906x speedup, step: 26
Epoch 30/300 |loss: 0.005183| train set 3.102x speedup, test set 0.958x speedup, val set 0.909x speedup, step: 27
Epoch 31/300 |loss: 0.004442| train set 2.762x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 28
Epoch 32/300 |loss: 0.004313| train set 2.935x speedup, test set 0.914x speedup, val set 0.898x speedup, step: 29
Epoch 33/300 |loss: 0.004329| train set 3.271x speedup, test set 0.952x speedup, val set 0.908x speedup, step: 30
Epoch 34/300 |loss: 0.004133| train set 2.729x speedup, test set 0.952x speedup, val set 0.912x speedup, step: 31
Epoch 35/300 |loss: 0.005527| train set 3.172x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 32
Epoch 36/300 |loss: 0.003753| train set 3.152x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 33
Epoch 37/300 |loss: 0.003655| train set 2.541x speedup, test set 0.922x speedup, val set 0.907x speedup, step: 34
Epoch 38/300 |loss: 0.004138| train set 2.828x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 35
Epoch 39/300 |loss: 0.004030| train set 3.247x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 36
Epoch 40/300 |loss: 0.003717| train set 3.333x speedup, test set 0.922x speedup, val set 0.909x speedup, step: 37
Epoch 41/300 |loss: 0.003154| train set 3.122x speedup, test set 0.922x speedup, val set 0.911x speedup, step: 38
Epoch 42/300 |loss: 0.003485| train set 3.218x speedup, test set 0.922x speedup, val set 0.906x speedup, step: 39
Epoch 43/300 |loss: 0.003394| train set 3.301x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 40
Epoch 44/300 |loss: 0.003249| train set 3.300x speedup, test set 0.922x speedup, val set 0.883x speedup, step: 41
Epoch 45/300 |loss: 0.002699| train set 3.316x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 42
Epoch 46/300 |loss: 0.002743| train set 3.224x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 43
Epoch 47/300 |loss: 0.002751| train set 3.060x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 44
Epoch 48/300 |loss: 0.003015| train set 3.257x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 45
Epoch 49/300 |loss: 0.002697| train set 3.321x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 46
Epoch 50/300 |loss: 0.002886| train set 3.379x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 47
Epoch 51/300 |loss: 0.002901| train set 3.312x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 48
Epoch 52/300 |loss: 0.002597| train set 3.325x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 49
Epoch 53/300 |loss: 0.002477| train set 3.360x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 50
Epoch 54/300 |loss: 0.002596| train set 3.234x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 51
Epoch 55/300 |loss: 0.002622| train set 3.256x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 52
Epoch 56/300 |loss: 0.002614| train set 3.284x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 53
Epoch 57/300 |loss: 0.002657| train set 3.242x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 54
Epoch 58/300 |loss: 0.002340| train set 3.143x speedup, test set 0.922x speedup, val set 0.813x speedup, step: 55
Epoch 59/300 |loss: 0.002528| train set 3.071x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 56
Epoch 60/300 |loss: 0.002175| train set 3.375x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 57
Epoch 61/300 |loss: 0.002232| train set 3.195x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 58
Epoch 62/300 |loss: 0.002391| train set 3.219x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 59
Epoch 63/300 |loss: 0.002441| train set 3.244x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 60
Epoch 64/300 |loss: 0.002251| train set 3.311x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 61
Epoch 65/300 |loss: 0.002046| train set 3.110x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 62
Epoch 66/300 |loss: 0.002036| train set 3.243x speedup, test set 0.922x speedup, val set 0.808x speedup, step: 63
Epoch 67/300 |loss: 0.002731| train set 3.199x speedup, test set 0.922x speedup, val set 0.813x speedup, step: 64
Epoch 68/300 |loss: 0.002228| train set 3.248x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 65
Epoch 69/300 |loss: 0.001989| train set 3.212x speedup, test set 0.922x speedup, val set 0.909x speedup, step: 66
Epoch 70/300 |loss: 0.002189| train set 3.399x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 67
Epoch 71/300 |loss: 0.002397| train set 3.192x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 68
Epoch 72/300 |loss: 0.002310| train set 3.299x speedup, test set 0.922x speedup, val set 0.813x speedup, step: 69
Epoch 73/300 |loss: 0.002149| train set 3.168x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 70
Epoch 74/300 |loss: 0.002047| train set 3.333x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 71
early stopping at epoch 74
Training per epoch cost 2.364 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 70, train speedup 3.399, test speedup 0.922, val speedup 0.893
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 74, train speedup 3.333, test speedup 0.922, val speedup 0.811
execution cost 0:05:02.384169
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.187115, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020854| train set 0.870x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019231| train set 1.040x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016921| train set 0.990x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017500| train set 0.991x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014786| train set 1.027x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014246| train set 1.001x speedup, test set 1.012x speedup, val set 0.850x speedup, step: 5
Epoch 9/300 |loss: 0.013827| train set 0.745x speedup, test set 1.012x speedup, val set 0.835x speedup, step: 6
Epoch 10/300 |loss: 0.013638| train set 2.253x speedup, test set 0.969x speedup, val set 0.853x speedup, step: 7
Epoch 11/300 |loss: 0.012558| train set 1.848x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010826| train set 2.047x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010629| train set 2.340x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 10
Epoch 14/300 |loss: 0.010252| train set 2.357x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009646| train set 2.774x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009524| train set 2.331x speedup, test set 0.969x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.009252| train set 1.820x speedup, test set 0.958x speedup, val set 0.861x speedup, step: 14
Epoch 18/300 |loss: 0.008835| train set 3.054x speedup, test set 0.969x speedup, val set 0.843x speedup, step: 15
Epoch 19/300 |loss: 0.007831| train set 3.105x speedup, test set 0.914x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.007720| train set 2.463x speedup, test set 0.914x speedup, val set 0.828x speedup, step: 17
Epoch 21/300 |loss: 0.007137| train set 2.562x speedup, test set 0.914x speedup, val set 0.838x speedup, step: 18
Epoch 22/300 |loss: 0.006443| train set 2.931x speedup, test set 0.914x speedup, val set 0.911x speedup, step: 19
Epoch 23/300 |loss: 0.005701| train set 3.143x speedup, test set 0.914x speedup, val set 0.840x speedup, step: 20
Epoch 24/300 |loss: 0.006755| train set 2.803x speedup, test set 3.563x speedup, val set 0.818x speedup, step: 21
Epoch 25/300 |loss: 0.006138| train set 3.003x speedup, test set 0.919x speedup, val set 0.840x speedup, step: 22
Epoch 26/300 |loss: 0.005428| train set 2.622x speedup, test set 3.638x speedup, val set 0.824x speedup, step: 23
Epoch 27/300 |loss: 0.005583| train set 2.901x speedup, test set 3.563x speedup, val set 0.908x speedup, step: 24
Epoch 28/300 |loss: 0.005404| train set 3.139x speedup, test set 0.886x speedup, val set 0.903x speedup, step: 25
Epoch 29/300 |loss: 0.005079| train set 2.967x speedup, test set 0.886x speedup, val set 0.910x speedup, step: 26
Epoch 30/300 |loss: 0.005305| train set 2.750x speedup, test set 3.563x speedup, val set 0.909x speedup, step: 27
Epoch 31/300 |loss: 0.004927| train set 3.053x speedup, test set 0.886x speedup, val set 0.838x speedup, step: 28
Epoch 32/300 |loss: 0.004471| train set 3.062x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 29
Epoch 33/300 |loss: 0.004594| train set 3.110x speedup, test set 0.922x speedup, val set 0.909x speedup, step: 30
Epoch 34/300 |loss: 0.004165| train set 3.182x speedup, test set 0.938x speedup, val set 0.912x speedup, step: 31
Epoch 35/300 |loss: 0.003884| train set 3.200x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 32
Epoch 36/300 |loss: 0.003183| train set 3.198x speedup, test set 0.938x speedup, val set 0.912x speedup, step: 33
Epoch 37/300 |loss: 0.003221| train set 3.125x speedup, test set 0.938x speedup, val set 0.912x speedup, step: 34
Epoch 38/300 |loss: 0.004463| train set 3.205x speedup, test set 0.922x speedup, val set 0.895x speedup, step: 35
Epoch 39/300 |loss: 0.004644| train set 3.141x speedup, test set 0.938x speedup, val set 0.917x speedup, step: 36
Epoch 40/300 |loss: 0.003604| train set 3.221x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 37
Epoch 41/300 |loss: 0.002754| train set 3.111x speedup, test set 0.922x speedup, val set 0.895x speedup, step: 38
Epoch 42/300 |loss: 0.003385| train set 3.154x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 39
Epoch 43/300 |loss: 0.003579| train set 3.317x speedup, test set 0.927x speedup, val set 0.910x speedup, step: 40
Epoch 44/300 |loss: 0.003092| train set 3.190x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 41
Epoch 45/300 |loss: 0.002536| train set 3.341x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 42
Epoch 46/300 |loss: 0.002560| train set 3.221x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 43
Epoch 47/300 |loss: 0.002765| train set 3.069x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 44
Epoch 48/300 |loss: 0.002715| train set 3.262x speedup, test set 0.938x speedup, val set 0.908x speedup, step: 45
Epoch 49/300 |loss: 0.002322| train set 3.331x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 46
Epoch 50/300 |loss: 0.002572| train set 3.301x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 47
Epoch 51/300 |loss: 0.003270| train set 3.327x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 48
Epoch 52/300 |loss: 0.002593| train set 3.294x speedup, test set 0.922x speedup, val set 0.895x speedup, step: 49
Epoch 53/300 |loss: 0.002514| train set 3.295x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 50
Epoch 54/300 |loss: 0.002317| train set 3.143x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 51
Epoch 55/300 |loss: 0.002816| train set 3.355x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 52
Epoch 56/300 |loss: 0.002707| train set 3.190x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 53
Epoch 57/300 |loss: 0.002351| train set 3.250x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 54
Epoch 58/300 |loss: 0.002285| train set 3.331x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 55
Epoch 59/300 |loss: 0.002101| train set 3.345x speedup, test set 0.922x speedup, val set 0.871x speedup, step: 56
Epoch 60/300 |loss: 0.002150| train set 3.283x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 57
Epoch 61/300 |loss: 0.002148| train set 3.276x speedup, test set 0.922x speedup, val set 0.891x speedup, step: 58
Epoch 62/300 |loss: 0.002036| train set 3.308x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 59
Epoch 63/300 |loss: 0.002068| train set 3.265x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 60
Epoch 64/300 |loss: 0.001891| train set 3.279x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 61
Epoch 65/300 |loss: 0.001764| train set 3.363x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 62
Epoch 66/300 |loss: 0.001756| train set 3.212x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 63
Epoch 67/300 |loss: 0.002153| train set 3.161x speedup, test set 0.922x speedup, val set 0.887x speedup, step: 64
Epoch 68/300 |loss: 0.001890| train set 3.287x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 65
Epoch 69/300 |loss: 0.001715| train set 3.251x speedup, test set 0.922x speedup, val set 0.887x speedup, step: 66
Epoch 70/300 |loss: 0.001821| train set 3.376x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 67
Epoch 71/300 |loss: 0.001799| train set 3.209x speedup, test set 0.922x speedup, val set 0.742x speedup, step: 68
Epoch 72/300 |loss: 0.001827| train set 3.363x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 69
Epoch 73/300 |loss: 0.002076| train set 3.305x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 70
Epoch 74/300 |loss: 0.002078| train set 3.146x speedup, test set 0.922x speedup, val set 0.886x speedup, step: 71
early stopping at epoch 74
Training per epoch cost 2.271 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 70, train speedup 3.376, test speedup 0.922, val speedup 0.868
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.040, test speedup 6.351, val speedup 1.396
last model at epoch 74, train speedup 3.146, test speedup 0.922, val speedup 0.886
execution cost 0:04:42.533299
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.349512, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020854| train set 0.870x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019231| train set 1.040x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016921| train set 0.990x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017501| train set 0.991x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014805| train set 1.020x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014267| train set 0.995x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.014065| train set 0.742x speedup, test set 1.012x speedup, val set 0.859x speedup, step: 6
Epoch 10/300 |loss: 0.013992| train set 2.252x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.011894| train set 2.040x speedup, test set 0.969x speedup, val set 0.847x speedup, step: 8
Epoch 12/300 |loss: 0.010832| train set 2.208x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 9
Epoch 13/300 |loss: 0.010811| train set 2.443x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 10
Epoch 14/300 |loss: 0.010239| train set 2.321x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009854| train set 3.112x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009008| train set 2.645x speedup, test set 0.969x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.009577| train set 1.683x speedup, test set 0.974x speedup, val set 0.852x speedup, step: 14
Epoch 18/300 |loss: 0.008967| train set 2.945x speedup, test set 0.969x speedup, val set 0.842x speedup, step: 15
Epoch 19/300 |loss: 0.007736| train set 3.076x speedup, test set 0.969x speedup, val set 0.838x speedup, step: 16
Epoch 20/300 |loss: 0.007767| train set 2.462x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 17
Epoch 21/300 |loss: 0.007122| train set 2.706x speedup, test set 0.914x speedup, val set 0.846x speedup, step: 18
Epoch 22/300 |loss: 0.006566| train set 3.000x speedup, test set 0.969x speedup, val set 0.917x speedup, step: 19
Epoch 23/300 |loss: 0.005861| train set 3.142x speedup, test set 0.914x speedup, val set 0.846x speedup, step: 20
Epoch 24/300 |loss: 0.006502| train set 2.782x speedup, test set 0.914x speedup, val set 0.816x speedup, step: 21
Epoch 25/300 |loss: 0.006244| train set 2.762x speedup, test set 0.914x speedup, val set 0.646x speedup, step: 22
Epoch 26/300 |loss: 0.005370| train set 2.345x speedup, test set 0.969x speedup, val set 0.822x speedup, step: 23
Epoch 27/300 |loss: 0.006017| train set 2.940x speedup, test set 0.914x speedup, val set 0.900x speedup, step: 24
Epoch 28/300 |loss: 0.004957| train set 3.185x speedup, test set 0.914x speedup, val set 0.831x speedup, step: 25
Epoch 29/300 |loss: 0.005069| train set 3.303x speedup, test set 0.914x speedup, val set 0.904x speedup, step: 26
Epoch 30/300 |loss: 0.004893| train set 2.817x speedup, test set 0.914x speedup, val set 0.909x speedup, step: 27
Epoch 31/300 |loss: 0.004349| train set 2.857x speedup, test set 0.914x speedup, val set 0.844x speedup, step: 28
Epoch 32/300 |loss: 0.004327| train set 3.086x speedup, test set 0.914x speedup, val set 0.844x speedup, step: 29
Epoch 33/300 |loss: 0.004557| train set 3.079x speedup, test set 0.914x speedup, val set 0.906x speedup, step: 30
Epoch 34/300 |loss: 0.003805| train set 3.141x speedup, test set 0.914x speedup, val set 0.910x speedup, step: 31
Epoch 35/300 |loss: 0.004102| train set 2.914x speedup, test set 0.914x speedup, val set 0.906x speedup, step: 32
Epoch 36/300 |loss: 0.003291| train set 3.145x speedup, test set 0.886x speedup, val set 0.908x speedup, step: 33
Epoch 37/300 |loss: 0.003293| train set 2.796x speedup, test set 0.886x speedup, val set 0.912x speedup, step: 34
Epoch 38/300 |loss: 0.004290| train set 3.220x speedup, test set 0.886x speedup, val set 0.915x speedup, step: 35
Epoch 39/300 |loss: 0.004372| train set 3.171x speedup, test set 0.886x speedup, val set 0.910x speedup, step: 36
Epoch 40/300 |loss: 0.003700| train set 3.238x speedup, test set 0.886x speedup, val set 0.917x speedup, step: 37
Epoch 41/300 |loss: 0.003093| train set 3.056x speedup, test set 0.886x speedup, val set 0.918x speedup, step: 38
Epoch 42/300 |loss: 0.003366| train set 3.187x speedup, test set 0.886x speedup, val set 0.913x speedup, step: 39
Epoch 43/300 |loss: 0.003045| train set 3.263x speedup, test set 0.886x speedup, val set 0.908x speedup, step: 40
Epoch 44/300 |loss: 0.003271| train set 3.283x speedup, test set 0.886x speedup, val set 0.890x speedup, step: 41
Epoch 45/300 |loss: 0.002636| train set 3.289x speedup, test set 0.938x speedup, val set 0.916x speedup, step: 42
Epoch 46/300 |loss: 0.002713| train set 3.237x speedup, test set 0.886x speedup, val set 0.805x speedup, step: 43
Epoch 47/300 |loss: 0.003121| train set 3.002x speedup, test set 0.886x speedup, val set 0.916x speedup, step: 44
Epoch 48/300 |loss: 0.003063| train set 3.277x speedup, test set 0.886x speedup, val set 0.836x speedup, step: 45
Epoch 49/300 |loss: 0.002610| train set 3.343x speedup, test set 0.938x speedup, val set 0.868x speedup, step: 46
Epoch 50/300 |loss: 0.003051| train set 3.306x speedup, test set 0.886x speedup, val set 0.917x speedup, step: 47
Epoch 51/300 |loss: 0.003329| train set 3.371x speedup, test set 0.938x speedup, val set 0.916x speedup, step: 48
Epoch 52/300 |loss: 0.002616| train set 3.204x speedup, test set 0.922x speedup, val set 0.915x speedup, step: 49
Epoch 53/300 |loss: 0.002592| train set 3.335x speedup, test set 0.922x speedup, val set 0.891x speedup, step: 50
Epoch 54/300 |loss: 0.002546| train set 3.016x speedup, test set 0.938x speedup, val set 0.870x speedup, step: 51
Epoch 55/300 |loss: 0.002880| train set 3.297x speedup, test set 0.922x speedup, val set 0.916x speedup, step: 52
Epoch 56/300 |loss: 0.002879| train set 3.181x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 53
Epoch 57/300 |loss: 0.002282| train set 3.246x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 54
Epoch 58/300 |loss: 0.002337| train set 3.265x speedup, test set 0.922x speedup, val set 0.917x speedup, step: 55
Epoch 59/300 |loss: 0.002387| train set 3.297x speedup, test set 0.922x speedup, val set 0.917x speedup, step: 56
Epoch 60/300 |loss: 0.002164| train set 3.349x speedup, test set 0.922x speedup, val set 0.888x speedup, step: 57
Epoch 61/300 |loss: 0.002290| train set 3.197x speedup, test set 0.938x speedup, val set 0.868x speedup, step: 58
Epoch 62/300 |loss: 0.002134| train set 3.244x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 59
Epoch 63/300 |loss: 0.002332| train set 3.395x speedup, test set 0.938x speedup, val set 0.823x speedup, step: 60
Epoch 64/300 |loss: 0.002132| train set 3.290x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 61
Epoch 65/300 |loss: 0.001924| train set 3.288x speedup, test set 0.938x speedup, val set 0.868x speedup, step: 62
Epoch 66/300 |loss: 0.001880| train set 3.327x speedup, test set 0.938x speedup, val set 0.866x speedup, step: 63
Epoch 67/300 |loss: 0.002077| train set 3.226x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 64
Epoch 68/300 |loss: 0.001921| train set 3.220x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 65
Epoch 69/300 |loss: 0.002075| train set 3.240x speedup, test set 0.938x speedup, val set 0.891x speedup, step: 66
Epoch 70/300 |loss: 0.002066| train set 3.373x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 67
Epoch 71/300 |loss: 0.002283| train set 2.983x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 68
Epoch 72/300 |loss: 0.002240| train set 3.263x speedup, test set 0.938x speedup, val set 0.868x speedup, step: 69
Epoch 73/300 |loss: 0.002249| train set 3.298x speedup, test set 0.938x speedup, val set 0.917x speedup, step: 70
early stopping at epoch 73
Training per epoch cost 2.287 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 63, train speedup 3.395, test speedup 0.938, val speedup 0.823
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.040, test speedup 6.351, val speedup 1.396
last model at epoch 73, train speedup 3.298, test speedup 0.938, val speedup 0.917
execution cost 0:04:43.012239
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.833982, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020854| train set 0.870x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019231| train set 1.040x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016921| train set 0.990x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017500| train set 0.991x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014782| train set 1.023x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014320| train set 1.828x speedup, test set 1.012x speedup, val set 0.847x speedup, step: 5
Epoch 9/300 |loss: 0.014144| train set 0.741x speedup, test set 1.012x speedup, val set 0.859x speedup, step: 6
Epoch 10/300 |loss: 0.014108| train set 1.898x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.011926| train set 2.168x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010857| train set 2.036x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010749| train set 2.289x speedup, test set 0.969x speedup, val set 0.922x speedup, step: 10
Epoch 14/300 |loss: 0.010377| train set 2.338x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 11
Epoch 15/300 |loss: 0.009935| train set 3.122x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009044| train set 2.761x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 13
Epoch 17/300 |loss: 0.009649| train set 1.723x speedup, test set 0.958x speedup, val set 0.850x speedup, step: 14
Epoch 18/300 |loss: 0.009284| train set 3.018x speedup, test set 0.969x speedup, val set 0.836x speedup, step: 15
Epoch 19/300 |loss: 0.008063| train set 3.075x speedup, test set 0.914x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.007755| train set 2.376x speedup, test set 0.958x speedup, val set 0.850x speedup, step: 17
Epoch 21/300 |loss: 0.006939| train set 2.590x speedup, test set 0.914x speedup, val set 0.836x speedup, step: 18
Epoch 22/300 |loss: 0.006537| train set 2.956x speedup, test set 0.969x speedup, val set 0.908x speedup, step: 19
Epoch 23/300 |loss: 0.006015| train set 3.092x speedup, test set 0.914x speedup, val set 0.833x speedup, step: 20
Epoch 24/300 |loss: 0.006656| train set 2.836x speedup, test set 0.969x speedup, val set 0.900x speedup, step: 21
Epoch 25/300 |loss: 0.006593| train set 2.586x speedup, test set 0.914x speedup, val set 0.838x speedup, step: 22
Epoch 26/300 |loss: 0.005497| train set 2.608x speedup, test set 0.969x speedup, val set 0.832x speedup, step: 23
Epoch 27/300 |loss: 0.006020| train set 3.092x speedup, test set 0.914x speedup, val set 0.900x speedup, step: 24
Epoch 28/300 |loss: 0.005184| train set 3.180x speedup, test set 0.914x speedup, val set 0.924x speedup, step: 25
Epoch 29/300 |loss: 0.004588| train set 3.249x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 26
Epoch 30/300 |loss: 0.004703| train set 2.689x speedup, test set 0.914x speedup, val set 0.911x speedup, step: 27
Epoch 31/300 |loss: 0.004800| train set 2.809x speedup, test set 0.914x speedup, val set 0.838x speedup, step: 28
Epoch 32/300 |loss: 0.004296| train set 3.088x speedup, test set 0.914x speedup, val set 0.894x speedup, step: 29
Epoch 33/300 |loss: 0.004128| train set 3.251x speedup, test set 0.914x speedup, val set 0.906x speedup, step: 30
Epoch 34/300 |loss: 0.003765| train set 3.217x speedup, test set 0.914x speedup, val set 0.895x speedup, step: 31
Epoch 35/300 |loss: 0.004219| train set 3.246x speedup, test set 0.914x speedup, val set 0.894x speedup, step: 32
Epoch 36/300 |loss: 0.003511| train set 3.121x speedup, test set 0.914x speedup, val set 0.893x speedup, step: 33
Epoch 37/300 |loss: 0.003210| train set 3.160x speedup, test set 0.914x speedup, val set 0.895x speedup, step: 34
Epoch 38/300 |loss: 0.004445| train set 2.904x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 35
Epoch 39/300 |loss: 0.004546| train set 3.189x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 36
Epoch 40/300 |loss: 0.003533| train set 3.293x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 37
Epoch 41/300 |loss: 0.003086| train set 3.183x speedup, test set 0.914x speedup, val set 0.892x speedup, step: 38
Epoch 42/300 |loss: 0.003317| train set 3.182x speedup, test set 0.886x speedup, val set 0.890x speedup, step: 39
Epoch 43/300 |loss: 0.003893| train set 3.255x speedup, test set 0.891x speedup, val set 0.910x speedup, step: 40
Epoch 44/300 |loss: 0.003372| train set 3.349x speedup, test set 0.914x speedup, val set 0.890x speedup, step: 41
Epoch 45/300 |loss: 0.002681| train set 3.362x speedup, test set 0.914x speedup, val set 0.890x speedup, step: 42
Epoch 46/300 |loss: 0.002707| train set 3.340x speedup, test set 0.886x speedup, val set 0.892x speedup, step: 43
Epoch 47/300 |loss: 0.002791| train set 3.145x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 44
Epoch 48/300 |loss: 0.003112| train set 3.246x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 45
Epoch 49/300 |loss: 0.002687| train set 3.335x speedup, test set 0.938x speedup, val set 0.910x speedup, step: 46
Epoch 50/300 |loss: 0.002524| train set 3.278x speedup, test set 0.886x speedup, val set 0.890x speedup, step: 47
Epoch 51/300 |loss: 0.003481| train set 3.258x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 48
Epoch 52/300 |loss: 0.002837| train set 3.305x speedup, test set 0.938x speedup, val set 0.893x speedup, step: 49
Epoch 53/300 |loss: 0.002588| train set 3.303x speedup, test set 0.922x speedup, val set 0.917x speedup, step: 50
Epoch 54/300 |loss: 0.002629| train set 2.963x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 51
Epoch 55/300 |loss: 0.002603| train set 3.387x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 52
Epoch 56/300 |loss: 0.002578| train set 3.164x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 53
Epoch 57/300 |loss: 0.002432| train set 3.308x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 54
Epoch 58/300 |loss: 0.002517| train set 3.388x speedup, test set 0.952x speedup, val set 0.893x speedup, step: 55
Epoch 59/300 |loss: 0.002540| train set 3.355x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 56
Epoch 60/300 |loss: 0.002165| train set 3.233x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 57
Epoch 61/300 |loss: 0.002401| train set 3.325x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 58
Epoch 62/300 |loss: 0.002016| train set 3.265x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 59
Epoch 63/300 |loss: 0.002165| train set 3.374x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 60
Epoch 64/300 |loss: 0.002158| train set 3.291x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 61
Epoch 65/300 |loss: 0.002181| train set 3.314x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 62
Epoch 66/300 |loss: 0.002186| train set 3.227x speedup, test set 0.938x speedup, val set 0.893x speedup, step: 63
Epoch 67/300 |loss: 0.002590| train set 3.120x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 64
Epoch 68/300 |loss: 0.002159| train set 3.262x speedup, test set 0.922x speedup, val set 0.917x speedup, step: 65
Epoch 69/300 |loss: 0.002226| train set 3.186x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 66
Epoch 70/300 |loss: 0.002185| train set 3.396x speedup, test set 0.896x speedup, val set 0.890x speedup, step: 67
Epoch 71/300 |loss: 0.002146| train set 3.321x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 68
early stopping at epoch 71
Training per epoch cost 2.274 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 70, train speedup 3.396, test speedup 0.896, val speedup 0.890
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.040, test speedup 6.351, val speedup 1.396
last model at epoch 71, train speedup 3.321, test speedup 0.922, val speedup 0.893
execution cost 0:04:32.065624
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.200031, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019281| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016859| train set 0.977x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017539| train set 0.978x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014961| train set 1.008x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014015| train set 0.992x speedup, test set 1.012x speedup, val set 0.850x speedup, step: 5
Epoch 9/300 |loss: 0.013568| train set 0.746x speedup, test set 0.969x speedup, val set 0.832x speedup, step: 6
Epoch 10/300 |loss: 0.013471| train set 2.212x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.012925| train set 1.839x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011118| train set 1.889x speedup, test set 0.969x speedup, val set 0.847x speedup, step: 9
Epoch 13/300 |loss: 0.010726| train set 2.129x speedup, test set 0.969x speedup, val set 0.863x speedup, step: 10
Epoch 14/300 |loss: 0.010361| train set 2.473x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.009707| train set 3.112x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009616| train set 2.745x speedup, test set 0.952x speedup, val set 0.836x speedup, step: 13
Epoch 17/300 |loss: 0.009507| train set 2.127x speedup, test set 0.958x speedup, val set 0.859x speedup, step: 14
Epoch 18/300 |loss: 0.009003| train set 3.075x speedup, test set 0.969x speedup, val set 0.842x speedup, step: 15
Epoch 19/300 |loss: 0.007924| train set 2.994x speedup, test set 0.969x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.008466| train set 2.326x speedup, test set 0.958x speedup, val set 0.858x speedup, step: 17
Epoch 21/300 |loss: 0.007326| train set 2.603x speedup, test set 0.914x speedup, val set 0.838x speedup, step: 18
Epoch 22/300 |loss: 0.006491| train set 2.871x speedup, test set 0.969x speedup, val set 0.908x speedup, step: 19
Epoch 23/300 |loss: 0.005625| train set 3.193x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 20
Epoch 24/300 |loss: 0.006451| train set 2.824x speedup, test set 0.914x speedup, val set 0.910x speedup, step: 21
Epoch 25/300 |loss: 0.007029| train set 2.785x speedup, test set 0.914x speedup, val set 0.831x speedup, step: 22
Epoch 26/300 |loss: 0.005763| train set 2.470x speedup, test set 0.886x speedup, val set 0.754x speedup, step: 23
Epoch 27/300 |loss: 0.005493| train set 2.583x speedup, test set 0.914x speedup, val set 0.686x speedup, step: 24
Epoch 28/300 |loss: 0.005126| train set 3.256x speedup, test set 0.886x speedup, val set 0.900x speedup, step: 25
Epoch 29/300 |loss: 0.005110| train set 3.194x speedup, test set 0.914x speedup, val set 0.687x speedup, step: 26
Epoch 30/300 |loss: 0.004543| train set 2.936x speedup, test set 0.952x speedup, val set 0.909x speedup, step: 27
Epoch 31/300 |loss: 0.004219| train set 2.821x speedup, test set 0.914x speedup, val set 0.672x speedup, step: 28
Epoch 32/300 |loss: 0.004513| train set 2.502x speedup, test set 0.914x speedup, val set 0.810x speedup, step: 29
Epoch 33/300 |loss: 0.004342| train set 3.219x speedup, test set 0.952x speedup, val set 0.908x speedup, step: 30
Epoch 34/300 |loss: 0.003986| train set 3.216x speedup, test set 0.952x speedup, val set 0.912x speedup, step: 31
Epoch 35/300 |loss: 0.004711| train set 3.096x speedup, test set 0.922x speedup, val set 0.809x speedup, step: 32
Epoch 36/300 |loss: 0.003481| train set 3.060x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 33
Epoch 37/300 |loss: 0.003282| train set 3.106x speedup, test set 0.922x speedup, val set 0.871x speedup, step: 34
Epoch 38/300 |loss: 0.005211| train set 2.843x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 35
Epoch 39/300 |loss: 0.003954| train set 3.203x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 36
Epoch 40/300 |loss: 0.003755| train set 3.273x speedup, test set 0.922x speedup, val set 0.882x speedup, step: 37
Epoch 41/300 |loss: 0.002877| train set 3.121x speedup, test set 0.922x speedup, val set 0.687x speedup, step: 38
Epoch 42/300 |loss: 0.003315| train set 3.257x speedup, test set 0.922x speedup, val set 0.809x speedup, step: 39
Epoch 43/300 |loss: 0.003807| train set 3.263x speedup, test set 0.922x speedup, val set 0.791x speedup, step: 40
Epoch 44/300 |loss: 0.003249| train set 3.231x speedup, test set 0.922x speedup, val set 0.783x speedup, step: 41
Epoch 45/300 |loss: 0.002703| train set 3.356x speedup, test set 0.922x speedup, val set 0.866x speedup, step: 42
Epoch 46/300 |loss: 0.002623| train set 3.256x speedup, test set 0.922x speedup, val set 0.865x speedup, step: 43
Epoch 47/300 |loss: 0.002749| train set 3.230x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 44
Epoch 48/300 |loss: 0.002933| train set 3.247x speedup, test set 0.922x speedup, val set 0.808x speedup, step: 45
Epoch 49/300 |loss: 0.002438| train set 3.317x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 46
Epoch 50/300 |loss: 0.002681| train set 3.192x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 47
Epoch 51/300 |loss: 0.003294| train set 3.373x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 48
Epoch 52/300 |loss: 0.002763| train set 3.296x speedup, test set 0.922x speedup, val set 0.789x speedup, step: 49
Epoch 53/300 |loss: 0.002546| train set 3.305x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 50
Epoch 54/300 |loss: 0.002841| train set 3.009x speedup, test set 0.922x speedup, val set 0.866x speedup, step: 51
Epoch 55/300 |loss: 0.002729| train set 3.306x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 52
early stopping at epoch 55
Training per epoch cost 2.398 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 51, train speedup 3.373, test speedup 0.922, val speedup 0.890
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 55, train speedup 3.306, test speedup 0.922, val speedup 0.790
execution cost 0:03:54.292628
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.387863, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019301| train set 1.048x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016924| train set 0.970x speedup, test set 0.974x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017548| train set 0.980x speedup, test set 1.018x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014969| train set 1.003x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014168| train set 0.985x speedup, test set 1.012x speedup, val set 0.851x speedup, step: 5
Epoch 9/300 |loss: 0.013593| train set 0.734x speedup, test set 1.012x speedup, val set 0.832x speedup, step: 6
Epoch 10/300 |loss: 0.013259| train set 2.029x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.012339| train set 1.966x speedup, test set 0.969x speedup, val set 0.829x speedup, step: 8
Epoch 12/300 |loss: 0.010847| train set 2.172x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010559| train set 2.403x speedup, test set 0.969x speedup, val set 0.863x speedup, step: 10
Epoch 14/300 |loss: 0.010065| train set 2.533x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009296| train set 3.013x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 12
Epoch 16/300 |loss: 0.009032| train set 2.663x speedup, test set 1.012x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.009192| train set 1.722x speedup, test set 0.958x speedup, val set 0.859x speedup, step: 14
Epoch 18/300 |loss: 0.008679| train set 3.002x speedup, test set 1.018x speedup, val set 0.842x speedup, step: 15
Epoch 19/300 |loss: 0.007545| train set 3.043x speedup, test set 0.969x speedup, val set 0.844x speedup, step: 16
Epoch 20/300 |loss: 0.007456| train set 2.368x speedup, test set 0.958x speedup, val set 0.860x speedup, step: 17
Epoch 21/300 |loss: 0.006996| train set 2.567x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 18
Epoch 22/300 |loss: 0.006013| train set 2.961x speedup, test set 0.958x speedup, val set 0.908x speedup, step: 19
Epoch 23/300 |loss: 0.005750| train set 3.213x speedup, test set 0.958x speedup, val set 0.846x speedup, step: 20
Epoch 24/300 |loss: 0.006687| train set 2.707x speedup, test set 0.958x speedup, val set 0.817x speedup, step: 21
Epoch 25/300 |loss: 0.006121| train set 2.888x speedup, test set 0.958x speedup, val set 0.840x speedup, step: 22
Epoch 26/300 |loss: 0.005116| train set 2.807x speedup, test set 0.955x speedup, val set 0.824x speedup, step: 23
Epoch 27/300 |loss: 0.005426| train set 2.737x speedup, test set 0.958x speedup, val set 0.839x speedup, step: 24
Epoch 28/300 |loss: 0.004983| train set 3.194x speedup, test set 0.924x speedup, val set 0.852x speedup, step: 25
Epoch 29/300 |loss: 0.004952| train set 3.252x speedup, test set 0.952x speedup, val set 0.839x speedup, step: 26
Epoch 30/300 |loss: 0.004500| train set 2.772x speedup, test set 0.958x speedup, val set 0.839x speedup, step: 27
Epoch 31/300 |loss: 0.004318| train set 2.426x speedup, test set 0.955x speedup, val set 0.821x speedup, step: 28
Epoch 32/300 |loss: 0.004535| train set 3.103x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 29
Epoch 33/300 |loss: 0.004593| train set 3.133x speedup, test set 0.949x speedup, val set 0.836x speedup, step: 30
Epoch 34/300 |loss: 0.003951| train set 2.936x speedup, test set 0.949x speedup, val set 0.839x speedup, step: 31
Epoch 35/300 |loss: 0.004903| train set 3.200x speedup, test set 0.922x speedup, val set 0.886x speedup, step: 32
Epoch 36/300 |loss: 0.003544| train set 3.088x speedup, test set 0.949x speedup, val set 0.837x speedup, step: 33
Epoch 37/300 |loss: 0.003304| train set 3.185x speedup, test set 0.949x speedup, val set 0.841x speedup, step: 34
Epoch 38/300 |loss: 0.004260| train set 3.164x speedup, test set 0.922x speedup, val set 0.840x speedup, step: 35
Epoch 39/300 |loss: 0.004281| train set 3.273x speedup, test set 0.922x speedup, val set 0.839x speedup, step: 36
Epoch 40/300 |loss: 0.004016| train set 3.261x speedup, test set 0.922x speedup, val set 0.840x speedup, step: 37
Epoch 41/300 |loss: 0.002947| train set 3.205x speedup, test set 0.922x speedup, val set 0.838x speedup, step: 38
Epoch 42/300 |loss: 0.003500| train set 3.271x speedup, test set 0.949x speedup, val set 0.838x speedup, step: 39
Epoch 43/300 |loss: 0.003328| train set 3.286x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 40
Epoch 44/300 |loss: 0.003109| train set 3.349x speedup, test set 0.922x speedup, val set 0.838x speedup, step: 41
Epoch 45/300 |loss: 0.002561| train set 3.349x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 42
Epoch 46/300 |loss: 0.002618| train set 3.005x speedup, test set 0.922x speedup, val set 0.819x speedup, step: 43
Epoch 47/300 |loss: 0.002722| train set 3.084x speedup, test set 0.922x speedup, val set 0.838x speedup, step: 44
Epoch 48/300 |loss: 0.002802| train set 3.280x speedup, test set 0.938x speedup, val set 0.838x speedup, step: 45
Epoch 49/300 |loss: 0.002655| train set 3.254x speedup, test set 0.922x speedup, val set 0.840x speedup, step: 46
Epoch 50/300 |loss: 0.002522| train set 3.308x speedup, test set 0.922x speedup, val set 0.838x speedup, step: 47
Epoch 51/300 |loss: 0.002842| train set 3.077x speedup, test set 0.922x speedup, val set 0.754x speedup, step: 48
Epoch 52/300 |loss: 0.002670| train set 3.314x speedup, test set 0.922x speedup, val set 0.838x speedup, step: 49
Epoch 53/300 |loss: 0.002455| train set 3.293x speedup, test set 0.922x speedup, val set 0.838x speedup, step: 50
Epoch 54/300 |loss: 0.002995| train set 3.214x speedup, test set 0.922x speedup, val set 0.754x speedup, step: 51
Epoch 55/300 |loss: 0.002981| train set 3.324x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 52
early stopping at epoch 55
Training per epoch cost 2.433 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 44, train speedup 3.349, test speedup 0.922, val speedup 0.838
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.048, test speedup 6.351, val speedup 1.339
last model at epoch 55, train speedup 3.324, test speedup 0.922, val speedup 0.810
execution cost 0:03:59.475285
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.385707, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019281| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016859| train set 0.977x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017531| train set 0.960x speedup, test set 1.018x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014964| train set 1.025x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014061| train set 1.003x speedup, test set 1.012x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013370| train set 0.757x speedup, test set 1.012x speedup, val set 0.832x speedup, step: 6
Epoch 10/300 |loss: 0.013524| train set 2.589x speedup, test set 0.969x speedup, val set 0.862x speedup, step: 7
Epoch 11/300 |loss: 0.012930| train set 2.167x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 8
Epoch 12/300 |loss: 0.011009| train set 1.858x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010535| train set 2.260x speedup, test set 0.969x speedup, val set 0.933x speedup, step: 10
Epoch 14/300 |loss: 0.010224| train set 2.642x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009488| train set 2.581x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 12
Epoch 16/300 |loss: 0.009424| train set 2.723x speedup, test set 0.969x speedup, val set 0.849x speedup, step: 13
Epoch 17/300 |loss: 0.009055| train set 1.730x speedup, test set 0.958x speedup, val set 0.850x speedup, step: 14
Epoch 18/300 |loss: 0.008818| train set 3.097x speedup, test set 0.969x speedup, val set 0.836x speedup, step: 15
Epoch 19/300 |loss: 0.007931| train set 3.073x speedup, test set 0.974x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.007831| train set 2.349x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 17
Epoch 21/300 |loss: 0.007158| train set 2.412x speedup, test set 0.963x speedup, val set 0.833x speedup, step: 18
Epoch 22/300 |loss: 0.006614| train set 3.087x speedup, test set 0.974x speedup, val set 0.908x speedup, step: 19
Epoch 23/300 |loss: 0.006026| train set 3.169x speedup, test set 0.914x speedup, val set 0.839x speedup, step: 20
Epoch 24/300 |loss: 0.007168| train set 2.709x speedup, test set 0.969x speedup, val set 0.817x speedup, step: 21
Epoch 25/300 |loss: 0.006277| train set 2.579x speedup, test set 0.943x speedup, val set 0.823x speedup, step: 22
Epoch 26/300 |loss: 0.005483| train set 2.478x speedup, test set 0.943x speedup, val set 0.823x speedup, step: 23
Epoch 27/300 |loss: 0.005959| train set 2.704x speedup, test set 0.969x speedup, val set 0.686x speedup, step: 24
Epoch 28/300 |loss: 0.005088| train set 3.185x speedup, test set 0.969x speedup, val set 0.900x speedup, step: 25
Epoch 29/300 |loss: 0.005245| train set 3.109x speedup, test set 0.922x speedup, val set 0.888x speedup, step: 26
Epoch 30/300 |loss: 0.004895| train set 3.112x speedup, test set 0.938x speedup, val set 0.839x speedup, step: 27
Epoch 31/300 |loss: 0.004560| train set 2.861x speedup, test set 0.938x speedup, val set 0.821x speedup, step: 28
Epoch 32/300 |loss: 0.004464| train set 2.997x speedup, test set 0.969x speedup, val set 0.809x speedup, step: 29
Epoch 33/300 |loss: 0.004349| train set 3.254x speedup, test set 0.938x speedup, val set 0.908x speedup, step: 30
Epoch 34/300 |loss: 0.004475| train set 3.024x speedup, test set 0.969x speedup, val set 0.893x speedup, step: 31
Epoch 35/300 |loss: 0.006011| train set 3.126x speedup, test set 0.938x speedup, val set 0.909x speedup, step: 32
Epoch 36/300 |loss: 0.004027| train set 3.196x speedup, test set 0.969x speedup, val set 0.892x speedup, step: 33
Epoch 37/300 |loss: 0.003660| train set 2.727x speedup, test set 0.958x speedup, val set 0.907x speedup, step: 34
Epoch 38/300 |loss: 0.004448| train set 3.259x speedup, test set 0.927x speedup, val set 0.890x speedup, step: 35
Epoch 39/300 |loss: 0.004022| train set 3.253x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 36
Epoch 40/300 |loss: 0.003603| train set 3.343x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 37
Epoch 41/300 |loss: 0.003156| train set 3.103x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 38
Epoch 42/300 |loss: 0.003565| train set 3.173x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 39
Epoch 43/300 |loss: 0.003463| train set 3.239x speedup, test set 0.943x speedup, val set 0.890x speedup, step: 40
Epoch 44/300 |loss: 0.003247| train set 3.186x speedup, test set 0.938x speedup, val set 0.687x speedup, step: 41
Epoch 45/300 |loss: 0.002719| train set 3.357x speedup, test set 0.938x speedup, val set 0.687x speedup, step: 42
Epoch 46/300 |loss: 0.002869| train set 3.298x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 43
Epoch 47/300 |loss: 0.003065| train set 3.158x speedup, test set 0.938x speedup, val set 0.824x speedup, step: 44
Epoch 48/300 |loss: 0.002888| train set 3.275x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 45
Epoch 49/300 |loss: 0.002616| train set 3.291x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 46
Epoch 50/300 |loss: 0.003075| train set 3.164x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 47
Epoch 51/300 |loss: 0.003043| train set 3.253x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 48
Epoch 52/300 |loss: 0.002688| train set 3.337x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 49
Epoch 53/300 |loss: 0.002407| train set 3.357x speedup, test set 0.922x speedup, val set 0.907x speedup, step: 50
Epoch 54/300 |loss: 0.003106| train set 3.226x speedup, test set 0.938x speedup, val set 0.810x speedup, step: 51
Epoch 55/300 |loss: 0.002903| train set 3.388x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 52
early stopping at epoch 55
Training per epoch cost 2.417 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 55, train speedup 3.388, test speedup 0.922, val speedup 0.810
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 55, train speedup 3.388, test speedup 0.922, val speedup 0.810
execution cost 0:03:56.663105
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:01.125144, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019281| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016859| train set 0.977x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017531| train set 0.960x speedup, test set 1.018x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014964| train set 1.025x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014056| train set 1.003x speedup, test set 1.012x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013339| train set 0.758x speedup, test set 1.012x speedup, val set 0.859x speedup, step: 6
Epoch 10/300 |loss: 0.013615| train set 1.551x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 7
Epoch 11/300 |loss: 0.012947| train set 2.324x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011089| train set 1.882x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010552| train set 2.391x speedup, test set 0.969x speedup, val set 0.933x speedup, step: 10
Epoch 14/300 |loss: 0.010674| train set 2.316x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009509| train set 2.989x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009492| train set 2.586x speedup, test set 0.958x speedup, val set 0.827x speedup, step: 13
Epoch 17/300 |loss: 0.009220| train set 1.838x speedup, test set 0.914x speedup, val set 0.861x speedup, step: 14
Epoch 18/300 |loss: 0.008965| train set 2.826x speedup, test set 0.974x speedup, val set 0.845x speedup, step: 15
Epoch 19/300 |loss: 0.007846| train set 3.130x speedup, test set 0.914x speedup, val set 0.843x speedup, step: 16
Epoch 20/300 |loss: 0.007684| train set 2.477x speedup, test set 0.914x speedup, val set 0.860x speedup, step: 17
Epoch 21/300 |loss: 0.006984| train set 2.618x speedup, test set 0.914x speedup, val set 0.909x speedup, step: 18
Epoch 22/300 |loss: 0.006314| train set 2.978x speedup, test set 0.919x speedup, val set 0.912x speedup, step: 19
Epoch 23/300 |loss: 0.005711| train set 3.045x speedup, test set 0.919x speedup, val set 0.917x speedup, step: 20
Epoch 24/300 |loss: 0.007138| train set 2.705x speedup, test set 0.952x speedup, val set 0.885x speedup, step: 21
Epoch 25/300 |loss: 0.006152| train set 2.665x speedup, test set 0.919x speedup, val set 0.690x speedup, step: 22
Epoch 26/300 |loss: 0.005282| train set 2.413x speedup, test set 0.919x speedup, val set 0.824x speedup, step: 23
Epoch 27/300 |loss: 0.005731| train set 2.938x speedup, test set 0.914x speedup, val set 0.909x speedup, step: 24
Epoch 28/300 |loss: 0.005172| train set 3.186x speedup, test set 0.952x speedup, val set 0.899x speedup, step: 25
Epoch 29/300 |loss: 0.005344| train set 3.301x speedup, test set 0.952x speedup, val set 0.917x speedup, step: 26
Epoch 30/300 |loss: 0.004767| train set 3.015x speedup, test set 0.969x speedup, val set 0.912x speedup, step: 27
Epoch 31/300 |loss: 0.004242| train set 2.952x speedup, test set 0.969x speedup, val set 0.822x speedup, step: 28
Epoch 32/300 |loss: 0.004268| train set 2.807x speedup, test set 0.969x speedup, val set 0.893x speedup, step: 29
Epoch 33/300 |loss: 0.004312| train set 3.183x speedup, test set 0.952x speedup, val set 0.906x speedup, step: 30
Epoch 34/300 |loss: 0.004157| train set 2.984x speedup, test set 0.969x speedup, val set 0.912x speedup, step: 31
Epoch 35/300 |loss: 0.005658| train set 3.189x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 32
Epoch 36/300 |loss: 0.003472| train set 3.208x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 33
Epoch 37/300 |loss: 0.003400| train set 3.052x speedup, test set 0.922x speedup, val set 0.909x speedup, step: 34
Epoch 38/300 |loss: 0.004660| train set 3.262x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 35
Epoch 39/300 |loss: 0.004186| train set 3.224x speedup, test set 0.922x speedup, val set 0.840x speedup, step: 36
Epoch 40/300 |loss: 0.004125| train set 3.231x speedup, test set 0.922x speedup, val set 0.906x speedup, step: 37
Epoch 41/300 |loss: 0.003043| train set 3.070x speedup, test set 0.922x speedup, val set 0.907x speedup, step: 38
Epoch 42/300 |loss: 0.003540| train set 3.177x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 39
Epoch 43/300 |loss: 0.003509| train set 3.197x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 40
Epoch 44/300 |loss: 0.003363| train set 3.237x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 41
Epoch 45/300 |loss: 0.002795| train set 3.355x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 42
Epoch 46/300 |loss: 0.003163| train set 3.066x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 43
Epoch 47/300 |loss: 0.003056| train set 3.264x speedup, test set 0.922x speedup, val set 0.825x speedup, step: 44
Epoch 48/300 |loss: 0.002973| train set 3.280x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 45
Epoch 49/300 |loss: 0.002759| train set 3.263x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 46
Epoch 50/300 |loss: 0.003241| train set 3.377x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 47
Epoch 51/300 |loss: 0.003740| train set 3.237x speedup, test set 0.927x speedup, val set 0.893x speedup, step: 48
Epoch 52/300 |loss: 0.002707| train set 3.290x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 49
Epoch 53/300 |loss: 0.002537| train set 3.351x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 50
Epoch 54/300 |loss: 0.002575| train set 3.157x speedup, test set 0.927x speedup, val set 0.823x speedup, step: 51
Epoch 55/300 |loss: 0.002539| train set 3.363x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 52
Epoch 56/300 |loss: 0.002663| train set 3.307x speedup, test set 0.922x speedup, val set 0.646x speedup, step: 53
Epoch 57/300 |loss: 0.002446| train set 3.157x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 54
Epoch 58/300 |loss: 0.002386| train set 3.263x speedup, test set 0.922x speedup, val set 0.907x speedup, step: 55
Epoch 59/300 |loss: 0.002490| train set 3.277x speedup, test set 0.922x speedup, val set 0.835x speedup, step: 56
Epoch 60/300 |loss: 0.002180| train set 3.277x speedup, test set 0.922x speedup, val set 0.825x speedup, step: 57
Epoch 61/300 |loss: 0.002430| train set 3.138x speedup, test set 0.922x speedup, val set 0.835x speedup, step: 58
Epoch 62/300 |loss: 0.002077| train set 3.223x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 59
Epoch 63/300 |loss: 0.002259| train set 3.326x speedup, test set 0.922x speedup, val set 0.824x speedup, step: 60
Epoch 64/300 |loss: 0.002275| train set 3.237x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 61
Epoch 65/300 |loss: 0.002098| train set 3.218x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 62
Epoch 66/300 |loss: 0.001999| train set 3.319x speedup, test set 0.922x speedup, val set 0.631x speedup, step: 63
Epoch 67/300 |loss: 0.002385| train set 3.311x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 64
Epoch 68/300 |loss: 0.002075| train set 3.284x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 65
Epoch 69/300 |loss: 0.002046| train set 3.267x speedup, test set 0.922x speedup, val set 0.835x speedup, step: 66
Epoch 70/300 |loss: 0.002096| train set 3.379x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 67
Epoch 71/300 |loss: 0.002114| train set 3.256x speedup, test set 0.922x speedup, val set 0.837x speedup, step: 68
early stopping at epoch 71
Training per epoch cost 2.412 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 70, train speedup 3.379, test speedup 0.922, val speedup 0.893
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 71, train speedup 3.256, test speedup 0.922, val speedup 0.837
execution cost 0:05:00.963758
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.762279, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020854| train set 0.870x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019274| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016915| train set 1.010x speedup, test set 0.952x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017419| train set 1.013x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014847| train set 1.043x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014103| train set 0.972x speedup, test set 0.952x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013377| train set 0.741x speedup, test set 0.969x speedup, val set 0.832x speedup, step: 6
Epoch 10/300 |loss: 0.013411| train set 2.268x speedup, test set 0.969x speedup, val set 0.853x speedup, step: 7
Epoch 11/300 |loss: 0.013036| train set 1.978x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011205| train set 1.893x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010484| train set 2.263x speedup, test set 0.969x speedup, val set 0.864x speedup, step: 10
Epoch 14/300 |loss: 0.010677| train set 2.348x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009440| train set 2.782x speedup, test set 0.958x speedup, val set 0.858x speedup, step: 12
Epoch 16/300 |loss: 0.009423| train set 2.474x speedup, test set 0.958x speedup, val set 0.857x speedup, step: 13
Epoch 17/300 |loss: 0.008845| train set 1.727x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 14
Epoch 18/300 |loss: 0.008735| train set 3.232x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 15
Epoch 19/300 |loss: 0.007820| train set 2.649x speedup, test set 0.914x speedup, val set 0.844x speedup, step: 16
Epoch 20/300 |loss: 0.007888| train set 2.326x speedup, test set 0.958x speedup, val set 0.860x speedup, step: 17
Epoch 21/300 |loss: 0.007261| train set 2.699x speedup, test set 0.914x speedup, val set 0.846x speedup, step: 18
Epoch 22/300 |loss: 0.006547| train set 2.997x speedup, test set 0.943x speedup, val set 0.917x speedup, step: 19
Epoch 23/300 |loss: 0.006003| train set 3.088x speedup, test set 0.958x speedup, val set 0.846x speedup, step: 20
Epoch 24/300 |loss: 0.006767| train set 2.759x speedup, test set 0.914x speedup, val set 0.917x speedup, step: 21
Epoch 25/300 |loss: 0.006357| train set 3.116x speedup, test set 0.914x speedup, val set 0.845x speedup, step: 22
Epoch 26/300 |loss: 0.005797| train set 2.874x speedup, test set 0.914x speedup, val set 0.824x speedup, step: 23
Epoch 27/300 |loss: 0.005390| train set 2.958x speedup, test set 0.914x speedup, val set 0.917x speedup, step: 24
Epoch 28/300 |loss: 0.005489| train set 3.246x speedup, test set 0.952x speedup, val set 0.934x speedup, step: 25
Epoch 29/300 |loss: 0.005108| train set 3.267x speedup, test set 0.914x speedup, val set 0.917x speedup, step: 26
Epoch 30/300 |loss: 0.005091| train set 3.039x speedup, test set 0.919x speedup, val set 0.909x speedup, step: 27
Epoch 31/300 |loss: 0.004359| train set 2.868x speedup, test set 0.914x speedup, val set 0.890x speedup, step: 28
Epoch 32/300 |loss: 0.004585| train set 2.689x speedup, test set 0.958x speedup, val set 0.688x speedup, step: 29
Epoch 33/300 |loss: 0.004890| train set 3.335x speedup, test set 0.952x speedup, val set 0.688x speedup, step: 30
Epoch 34/300 |loss: 0.004059| train set 3.286x speedup, test set 0.952x speedup, val set 0.908x speedup, step: 31
Epoch 35/300 |loss: 0.004891| train set 3.255x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 32
Epoch 36/300 |loss: 0.003521| train set 3.243x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 33
Epoch 37/300 |loss: 0.003538| train set 3.133x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 34
Epoch 38/300 |loss: 0.004896| train set 2.826x speedup, test set 0.952x speedup, val set 0.690x speedup, step: 35
Epoch 39/300 |loss: 0.003956| train set 3.207x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 36
Epoch 40/300 |loss: 0.003720| train set 3.282x speedup, test set 0.952x speedup, val set 0.810x speedup, step: 37
Epoch 41/300 |loss: 0.003098| train set 3.118x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 38
Epoch 42/300 |loss: 0.003591| train set 3.151x speedup, test set 0.922x speedup, val set 0.688x speedup, step: 39
Epoch 43/300 |loss: 0.004008| train set 3.302x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 40
Epoch 44/300 |loss: 0.003376| train set 3.322x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 41
Epoch 45/300 |loss: 0.002715| train set 3.364x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 42
Epoch 46/300 |loss: 0.002799| train set 3.309x speedup, test set 0.922x speedup, val set 0.674x speedup, step: 43
Epoch 47/300 |loss: 0.002956| train set 3.052x speedup, test set 0.922x speedup, val set 0.687x speedup, step: 44
Epoch 48/300 |loss: 0.003238| train set 3.243x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 45
Epoch 49/300 |loss: 0.002514| train set 3.348x speedup, test set 0.922x speedup, val set 0.911x speedup, step: 46
Epoch 50/300 |loss: 0.002722| train set 3.342x speedup, test set 0.922x speedup, val set 0.687x speedup, step: 47
Epoch 51/300 |loss: 0.003072| train set 3.233x speedup, test set 0.927x speedup, val set 0.687x speedup, step: 48
Epoch 52/300 |loss: 0.002717| train set 3.228x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 49
Epoch 53/300 |loss: 0.003029| train set 3.257x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 50
Epoch 54/300 |loss: 0.002648| train set 3.161x speedup, test set 0.922x speedup, val set 0.687x speedup, step: 51
Epoch 55/300 |loss: 0.002777| train set 3.374x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 52
Epoch 56/300 |loss: 0.002790| train set 3.255x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 53
Epoch 57/300 |loss: 0.002392| train set 3.266x speedup, test set 0.922x speedup, val set 0.674x speedup, step: 54
Epoch 58/300 |loss: 0.002359| train set 3.257x speedup, test set 0.922x speedup, val set 0.793x speedup, step: 55
Epoch 59/300 |loss: 0.002526| train set 3.300x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 56
Epoch 60/300 |loss: 0.002103| train set 3.241x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 57
Epoch 61/300 |loss: 0.002340| train set 3.258x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 58
Epoch 62/300 |loss: 0.002146| train set 3.272x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 59
Epoch 63/300 |loss: 0.002416| train set 3.230x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 60
Epoch 64/300 |loss: 0.002283| train set 3.312x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 61
Epoch 65/300 |loss: 0.002043| train set 3.250x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 62
Epoch 66/300 |loss: 0.002223| train set 3.319x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 63
Epoch 67/300 |loss: 0.002978| train set 3.319x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 64
Epoch 68/300 |loss: 0.002217| train set 3.289x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 65
Epoch 69/300 |loss: 0.002018| train set 3.292x speedup, test set 0.922x speedup, val set 0.793x speedup, step: 66
Epoch 70/300 |loss: 0.002213| train set 3.344x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 67
Epoch 71/300 |loss: 0.002098| train set 3.227x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 68
Epoch 72/300 |loss: 0.002242| train set 3.190x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 69
Epoch 73/300 |loss: 0.002272| train set 3.353x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 70
Epoch 74/300 |loss: 0.002054| train set 3.278x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 71
early stopping at epoch 74
Training per epoch cost 1.381 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 55, train speedup 3.374, test speedup 0.922, val speedup 0.810
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 74, train speedup 3.278, test speedup 0.922, val speedup 0.811
execution cost 0:02:36.241390
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.792102, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019281| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016859| train set 0.977x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017531| train set 0.960x speedup, test set 1.018x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014892| train set 1.022x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014084| train set 0.997x speedup, test set 1.012x speedup, val set 0.850x speedup, step: 5
Epoch 9/300 |loss: 0.013452| train set 0.744x speedup, test set 1.012x speedup, val set 0.856x speedup, step: 6
Epoch 10/300 |loss: 0.013587| train set 2.338x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.012925| train set 2.396x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010982| train set 1.853x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010602| train set 2.391x speedup, test set 0.969x speedup, val set 0.862x speedup, step: 10
Epoch 14/300 |loss: 0.010385| train set 2.469x speedup, test set 0.974x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009481| train set 2.780x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009127| train set 2.705x speedup, test set 1.012x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.009809| train set 1.709x speedup, test set 0.963x speedup, val set 0.852x speedup, step: 14
Epoch 18/300 |loss: 0.010105| train set 3.002x speedup, test set 0.958x speedup, val set 0.830x speedup, step: 15
Epoch 19/300 |loss: 0.008223| train set 3.083x speedup, test set 0.919x speedup, val set 0.836x speedup, step: 16
Epoch 20/300 |loss: 0.009055| train set 2.983x speedup, test set 0.963x speedup, val set 0.850x speedup, step: 17
Epoch 21/300 |loss: 0.007138| train set 2.700x speedup, test set 0.958x speedup, val set 0.846x speedup, step: 18
Epoch 22/300 |loss: 0.006497| train set 3.162x speedup, test set 0.974x speedup, val set 0.843x speedup, step: 19
Epoch 23/300 |loss: 0.006117| train set 3.110x speedup, test set 0.919x speedup, val set 0.848x speedup, step: 20
Epoch 24/300 |loss: 0.007225| train set 2.697x speedup, test set 0.958x speedup, val set 0.825x speedup, step: 21
Epoch 25/300 |loss: 0.007514| train set 2.620x speedup, test set 0.891x speedup, val set 0.846x speedup, step: 22
Epoch 26/300 |loss: 0.005983| train set 2.850x speedup, test set 0.891x speedup, val set 0.823x speedup, step: 23
Epoch 27/300 |loss: 0.005385| train set 2.761x speedup, test set 0.927x speedup, val set 0.917x speedup, step: 24
Epoch 28/300 |loss: 0.005060| train set 3.038x speedup, test set 0.938x speedup, val set 0.850x speedup, step: 25
Epoch 29/300 |loss: 0.004442| train set 3.221x speedup, test set 0.922x speedup, val set 0.839x speedup, step: 26
Epoch 30/300 |loss: 0.005066| train set 3.048x speedup, test set 0.886x speedup, val set 0.860x speedup, step: 27
Epoch 31/300 |loss: 0.004556| train set 2.880x speedup, test set 0.938x speedup, val set 0.839x speedup, step: 28
Epoch 32/300 |loss: 0.004687| train set 2.847x speedup, test set 0.891x speedup, val set 0.648x speedup, step: 29
Epoch 33/300 |loss: 0.004311| train set 3.090x speedup, test set 0.938x speedup, val set 0.837x speedup, step: 30
Epoch 34/300 |loss: 0.004329| train set 3.022x speedup, test set 0.922x speedup, val set 0.840x speedup, step: 31
Epoch 35/300 |loss: 0.003885| train set 2.993x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 32
Epoch 36/300 |loss: 0.003339| train set 3.231x speedup, test set 0.922x speedup, val set 0.840x speedup, step: 33
Epoch 37/300 |loss: 0.003357| train set 3.051x speedup, test set 0.922x speedup, val set 0.841x speedup, step: 34
Epoch 38/300 |loss: 0.004799| train set 2.997x speedup, test set 0.922x speedup, val set 0.837x speedup, step: 35
Epoch 39/300 |loss: 0.003770| train set 3.297x speedup, test set 0.922x speedup, val set 0.835x speedup, step: 36
Epoch 40/300 |loss: 0.003357| train set 3.320x speedup, test set 0.922x speedup, val set 0.917x speedup, step: 37
Epoch 41/300 |loss: 0.002869| train set 3.195x speedup, test set 0.927x speedup, val set 0.837x speedup, step: 38
Epoch 42/300 |loss: 0.003585| train set 3.271x speedup, test set 0.922x speedup, val set 0.840x speedup, step: 39
Epoch 43/300 |loss: 0.003474| train set 3.351x speedup, test set 0.927x speedup, val set 0.910x speedup, step: 40
Epoch 44/300 |loss: 0.003103| train set 3.239x speedup, test set 0.922x speedup, val set 0.824x speedup, step: 41
Epoch 45/300 |loss: 0.002541| train set 3.352x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 42
Epoch 46/300 |loss: 0.002681| train set 3.353x speedup, test set 0.922x speedup, val set 0.824x speedup, step: 43
Epoch 47/300 |loss: 0.002653| train set 3.087x speedup, test set 0.922x speedup, val set 0.835x speedup, step: 44
Epoch 48/300 |loss: 0.002816| train set 3.303x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 45
Epoch 49/300 |loss: 0.002527| train set 3.360x speedup, test set 0.927x speedup, val set 0.910x speedup, step: 46
Epoch 50/300 |loss: 0.002700| train set 3.218x speedup, test set 0.922x speedup, val set 0.837x speedup, step: 47
Epoch 51/300 |loss: 0.003309| train set 3.143x speedup, test set 0.927x speedup, val set 0.821x speedup, step: 48
Epoch 52/300 |loss: 0.002803| train set 3.280x speedup, test set 0.922x speedup, val set 0.918x speedup, step: 49
Epoch 53/300 |loss: 0.002614| train set 3.333x speedup, test set 0.922x speedup, val set 0.917x speedup, step: 50
Epoch 54/300 |loss: 0.002588| train set 3.123x speedup, test set 0.922x speedup, val set 0.738x speedup, step: 51
early stopping at epoch 54
Training per epoch cost 1.386 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 49, train speedup 3.360, test speedup 0.927, val speedup 0.910
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 54, train speedup 3.123, test speedup 0.922, val speedup 0.738
execution cost 0:01:54.447639
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.782660, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023060| train set 0.692x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020869| train set 0.866x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019227| train set 1.023x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016774| train set 0.965x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017288| train set 0.960x speedup, test set 1.018x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014923| train set 1.016x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.013938| train set 0.998x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013358| train set 0.754x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 6
Epoch 10/300 |loss: 0.013573| train set 1.419x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 7
Epoch 11/300 |loss: 0.012754| train set 1.837x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010971| train set 1.944x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010694| train set 2.330x speedup, test set 0.969x speedup, val set 0.863x speedup, step: 10
Epoch 14/300 |loss: 0.010085| train set 2.732x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009586| train set 3.069x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009275| train set 2.579x speedup, test set 0.969x speedup, val set 0.833x speedup, step: 13
Epoch 17/300 |loss: 0.008897| train set 1.704x speedup, test set 0.958x speedup, val set 0.866x speedup, step: 14
Epoch 18/300 |loss: 0.008769| train set 2.919x speedup, test set 1.000x speedup, val set 0.842x speedup, step: 15
Epoch 19/300 |loss: 0.007482| train set 2.729x speedup, test set 1.012x speedup, val set 0.844x speedup, step: 16
Epoch 20/300 |loss: 0.007186| train set 2.596x speedup, test set 0.969x speedup, val set 0.858x speedup, step: 17
Epoch 21/300 |loss: 0.007012| train set 2.549x speedup, test set 0.958x speedup, val set 0.913x speedup, step: 18
Epoch 22/300 |loss: 0.006219| train set 2.950x speedup, test set 0.969x speedup, val set 0.916x speedup, step: 19
Epoch 23/300 |loss: 0.005485| train set 3.163x speedup, test set 0.969x speedup, val set 0.845x speedup, step: 20
Epoch 24/300 |loss: 0.006510| train set 3.042x speedup, test set 0.969x speedup, val set 0.810x speedup, step: 21
Epoch 25/300 |loss: 0.005938| train set 3.079x speedup, test set 0.969x speedup, val set 0.909x speedup, step: 22
Epoch 26/300 |loss: 0.005132| train set 2.630x speedup, test set 0.966x speedup, val set 0.906x speedup, step: 23
Epoch 27/300 |loss: 0.005269| train set 2.712x speedup, test set 0.969x speedup, val set 0.909x speedup, step: 24
Epoch 28/300 |loss: 0.004868| train set 3.026x speedup, test set 0.969x speedup, val set 0.935x speedup, step: 25
Epoch 29/300 |loss: 0.004677| train set 3.213x speedup, test set 0.969x speedup, val set 0.890x speedup, step: 26
Epoch 30/300 |loss: 0.004182| train set 2.934x speedup, test set 0.966x speedup, val set 0.909x speedup, step: 27
Epoch 31/300 |loss: 0.004327| train set 3.025x speedup, test set 0.969x speedup, val set 0.888x speedup, step: 28
Epoch 32/300 |loss: 0.004381| train set 3.123x speedup, test set 0.966x speedup, val set 0.932x speedup, step: 29
Epoch 33/300 |loss: 0.005140| train set 3.163x speedup, test set 0.966x speedup, val set 0.908x speedup, step: 30
Epoch 34/300 |loss: 0.003755| train set 2.874x speedup, test set 0.966x speedup, val set 0.910x speedup, step: 31
Epoch 35/300 |loss: 0.003712| train set 2.872x speedup, test set 0.961x speedup, val set 0.909x speedup, step: 32
Epoch 36/300 |loss: 0.003153| train set 3.175x speedup, test set 0.966x speedup, val set 0.909x speedup, step: 33
Epoch 37/300 |loss: 0.003225| train set 2.772x speedup, test set 0.938x speedup, val set 0.912x speedup, step: 34
Epoch 38/300 |loss: 0.004843| train set 3.254x speedup, test set 0.966x speedup, val set 0.912x speedup, step: 35
Epoch 39/300 |loss: 0.004326| train set 3.087x speedup, test set 0.938x speedup, val set 0.906x speedup, step: 36
early stopping at epoch 39
Training per epoch cost 1.385 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 38, train speedup 3.254, test speedup 0.966, val speedup 0.912
best test speedup epoch: 2, train speedup 0.692, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.023, test speedup 6.351, val speedup 1.396
last model at epoch 39, train speedup 3.087, test speedup 0.938, val speedup 0.906
execution cost 0:01:25.892926
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.848627, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023063| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020843| train set 0.871x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019141| train set 1.024x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016672| train set 0.955x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017239| train set 0.962x speedup, test set 0.994x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.015007| train set 1.036x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.013954| train set 0.995x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 5
Epoch 9/300 |loss: 0.013224| train set 1.003x speedup, test set 0.969x speedup, val set 0.833x speedup, step: 6
Epoch 10/300 |loss: 0.013492| train set 2.443x speedup, test set 0.969x speedup, val set 0.853x speedup, step: 7
Epoch 11/300 |loss: 0.012513| train set 1.855x speedup, test set 0.969x speedup, val set 0.847x speedup, step: 8
Epoch 12/300 |loss: 0.010699| train set 1.865x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010600| train set 2.412x speedup, test set 0.969x speedup, val set 0.861x speedup, step: 10
Epoch 14/300 |loss: 0.010107| train set 2.699x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 11
Epoch 15/300 |loss: 0.009331| train set 3.188x speedup, test set 0.969x speedup, val set 0.837x speedup, step: 12
Epoch 16/300 |loss: 0.009054| train set 2.586x speedup, test set 0.969x speedup, val set 0.829x speedup, step: 13
Epoch 17/300 |loss: 0.009795| train set 1.956x speedup, test set 0.969x speedup, val set 0.844x speedup, step: 14
Epoch 18/300 |loss: 0.009796| train set 3.026x speedup, test set 0.958x speedup, val set 0.831x speedup, step: 15
Epoch 19/300 |loss: 0.007854| train set 3.185x speedup, test set 0.952x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.008038| train set 2.596x speedup, test set 0.969x speedup, val set 0.840x speedup, step: 17
Epoch 21/300 |loss: 0.006870| train set 2.600x speedup, test set 0.958x speedup, val set 0.845x speedup, step: 18
Epoch 22/300 |loss: 0.006301| train set 3.022x speedup, test set 0.969x speedup, val set 0.913x speedup, step: 19
Epoch 23/300 |loss: 0.005592| train set 3.008x speedup, test set 0.969x speedup, val set 0.846x speedup, step: 20
Epoch 24/300 |loss: 0.006742| train set 2.761x speedup, test set 0.952x speedup, val set 0.846x speedup, step: 21
Epoch 25/300 |loss: 0.006219| train set 2.978x speedup, test set 0.914x speedup, val set 0.824x speedup, step: 22
Epoch 26/300 |loss: 0.005633| train set 2.684x speedup, test set 0.969x speedup, val set 0.844x speedup, step: 23
Epoch 27/300 |loss: 0.005500| train set 2.544x speedup, test set 0.952x speedup, val set 0.919x speedup, step: 24
Epoch 28/300 |loss: 0.005817| train set 3.182x speedup, test set 0.952x speedup, val set 0.908x speedup, step: 25
Epoch 29/300 |loss: 0.005561| train set 3.228x speedup, test set 0.952x speedup, val set 0.917x speedup, step: 26
Epoch 30/300 |loss: 0.004864| train set 3.013x speedup, test set 0.969x speedup, val set 0.917x speedup, step: 27
Epoch 31/300 |loss: 0.004815| train set 2.731x speedup, test set 0.952x speedup, val set 0.825x speedup, step: 28
Epoch 32/300 |loss: 0.004525| train set 2.743x speedup, test set 0.969x speedup, val set 0.840x speedup, step: 29
Epoch 33/300 |loss: 0.004651| train set 3.250x speedup, test set 0.952x speedup, val set 0.909x speedup, step: 30
Epoch 34/300 |loss: 0.004236| train set 3.006x speedup, test set 0.952x speedup, val set 0.920x speedup, step: 31
Epoch 35/300 |loss: 0.005669| train set 3.195x speedup, test set 0.952x speedup, val set 0.916x speedup, step: 32
Epoch 36/300 |loss: 0.003831| train set 3.210x speedup, test set 0.952x speedup, val set 0.846x speedup, step: 33
Epoch 37/300 |loss: 0.003742| train set 2.742x speedup, test set 0.952x speedup, val set 0.912x speedup, step: 34
Epoch 38/300 |loss: 0.004321| train set 3.176x speedup, test set 0.952x speedup, val set 0.826x speedup, step: 35
Epoch 39/300 |loss: 0.003957| train set 3.227x speedup, test set 0.952x speedup, val set 0.811x speedup, step: 36
Epoch 40/300 |loss: 0.003981| train set 3.193x speedup, test set 0.952x speedup, val set 0.894x speedup, step: 37
Epoch 41/300 |loss: 0.003188| train set 3.102x speedup, test set 0.952x speedup, val set 0.799x speedup, step: 38
Epoch 42/300 |loss: 0.004051| train set 3.164x speedup, test set 0.952x speedup, val set 0.838x speedup, step: 39
Epoch 43/300 |loss: 0.004142| train set 3.186x speedup, test set 0.952x speedup, val set 0.844x speedup, step: 40
Epoch 44/300 |loss: 0.003553| train set 3.152x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 41
Epoch 45/300 |loss: 0.002862| train set 3.303x speedup, test set 0.957x speedup, val set 0.799x speedup, step: 42
Epoch 46/300 |loss: 0.002897| train set 3.060x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 43
Epoch 47/300 |loss: 0.003035| train set 3.192x speedup, test set 0.952x speedup, val set 0.803x speedup, step: 44
Epoch 48/300 |loss: 0.002985| train set 3.222x speedup, test set 0.957x speedup, val set 0.799x speedup, step: 45
Epoch 49/300 |loss: 0.002600| train set 3.316x speedup, test set 0.957x speedup, val set 0.780x speedup, step: 46
Epoch 50/300 |loss: 0.002892| train set 3.294x speedup, test set 0.969x speedup, val set 0.733x speedup, step: 47
Epoch 51/300 |loss: 0.003461| train set 3.180x speedup, test set 0.952x speedup, val set 0.797x speedup, step: 48
Epoch 52/300 |loss: 0.002679| train set 3.254x speedup, test set 0.952x speedup, val set 0.717x speedup, step: 49
Epoch 53/300 |loss: 0.002304| train set 3.328x speedup, test set 0.952x speedup, val set 0.717x speedup, step: 50
Epoch 54/300 |loss: 0.002445| train set 3.227x speedup, test set 0.969x speedup, val set 0.716x speedup, step: 51
Epoch 55/300 |loss: 0.002691| train set 3.341x speedup, test set 0.952x speedup, val set 0.733x speedup, step: 52
Epoch 56/300 |loss: 0.002596| train set 3.238x speedup, test set 0.952x speedup, val set 0.733x speedup, step: 53
Epoch 57/300 |loss: 0.002422| train set 3.175x speedup, test set 0.952x speedup, val set 0.717x speedup, step: 54
Epoch 58/300 |loss: 0.002373| train set 3.379x speedup, test set 0.952x speedup, val set 0.717x speedup, step: 55
Epoch 59/300 |loss: 0.002390| train set 3.298x speedup, test set 0.922x speedup, val set 0.718x speedup, step: 56
Epoch 60/300 |loss: 0.002184| train set 3.349x speedup, test set 0.957x speedup, val set 0.718x speedup, step: 57
Epoch 61/300 |loss: 0.002203| train set 3.310x speedup, test set 0.952x speedup, val set 0.715x speedup, step: 58
Epoch 62/300 |loss: 0.002158| train set 3.110x speedup, test set 0.952x speedup, val set 0.717x speedup, step: 59
Epoch 63/300 |loss: 0.002475| train set 3.268x speedup, test set 0.922x speedup, val set 0.716x speedup, step: 60
Epoch 64/300 |loss: 0.002161| train set 3.324x speedup, test set 0.922x speedup, val set 0.717x speedup, step: 61
Epoch 65/300 |loss: 0.002040| train set 3.272x speedup, test set 0.922x speedup, val set 0.716x speedup, step: 62
Epoch 66/300 |loss: 0.001985| train set 3.270x speedup, test set 0.922x speedup, val set 0.716x speedup, step: 63
Epoch 67/300 |loss: 0.002859| train set 3.122x speedup, test set 0.922x speedup, val set 0.719x speedup, step: 64
Epoch 68/300 |loss: 0.002246| train set 3.304x speedup, test set 0.922x speedup, val set 0.733x speedup, step: 65
Epoch 69/300 |loss: 0.002039| train set 3.133x speedup, test set 0.927x speedup, val set 0.716x speedup, step: 66
Epoch 70/300 |loss: 0.002056| train set 3.373x speedup, test set 0.922x speedup, val set 0.718x speedup, step: 67
Epoch 71/300 |loss: 0.002027| train set 3.138x speedup, test set 0.922x speedup, val set 0.718x speedup, step: 68
Epoch 72/300 |loss: 0.002049| train set 3.359x speedup, test set 0.922x speedup, val set 0.730x speedup, step: 69
Epoch 73/300 |loss: 0.002066| train set 3.307x speedup, test set 0.922x speedup, val set 0.717x speedup, step: 70
Epoch 74/300 |loss: 0.002008| train set 3.165x speedup, test set 0.922x speedup, val set 0.734x speedup, step: 71
Epoch 75/300 |loss: 0.001963| train set 3.271x speedup, test set 0.927x speedup, val set 0.732x speedup, step: 72
Epoch 76/300 |loss: 0.001895| train set 3.161x speedup, test set 0.922x speedup, val set 0.716x speedup, step: 73
Epoch 77/300 |loss: 0.001853| train set 3.289x speedup, test set 0.922x speedup, val set 0.754x speedup, step: 74
Epoch 78/300 |loss: 0.001881| train set 3.313x speedup, test set 0.922x speedup, val set 0.716x speedup, step: 75
Epoch 79/300 |loss: 0.001613| train set 3.350x speedup, test set 0.922x speedup, val set 0.813x speedup, step: 76
Epoch 80/300 |loss: 0.002029| train set 3.341x speedup, test set 0.922x speedup, val set 0.717x speedup, step: 77
Epoch 81/300 |loss: 0.001854| train set 3.320x speedup, test set 0.927x speedup, val set 0.735x speedup, step: 78
Epoch 82/300 |loss: 0.001808| train set 3.326x speedup, test set 0.927x speedup, val set 0.732x speedup, step: 79
Epoch 83/300 |loss: 0.001877| train set 3.395x speedup, test set 0.942x speedup, val set 0.716x speedup, step: 80
Epoch 84/300 |loss: 0.001934| train set 3.284x speedup, test set 0.938x speedup, val set 0.717x speedup, step: 81
Epoch 85/300 |loss: 0.001600| train set 3.182x speedup, test set 0.942x speedup, val set 0.797x speedup, step: 82
Epoch 86/300 |loss: 0.001829| train set 3.319x speedup, test set 3.766x speedup, val set 0.733x speedup, step: 83
Epoch 87/300 |loss: 0.001614| train set 3.183x speedup, test set 0.938x speedup, val set 0.813x speedup, step: 84
Epoch 88/300 |loss: 0.001980| train set 3.290x speedup, test set 0.922x speedup, val set 0.738x speedup, step: 85
early stopping at epoch 88
Training per epoch cost 1.355 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 83, train speedup 3.395, test speedup 0.942, val speedup 0.716
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.024, test speedup 6.351, val speedup 1.396
last model at epoch 88, train speedup 3.290, test speedup 0.922, val speedup 0.738
execution cost 0:02:59.391594
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.764310, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020854| train set 0.870x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019231| train set 1.040x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016921| train set 0.990x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017500| train set 0.991x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014782| train set 1.023x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014320| train set 1.828x speedup, test set 1.012x speedup, val set 0.847x speedup, step: 5
Epoch 9/300 |loss: 0.014144| train set 0.741x speedup, test set 1.012x speedup, val set 0.859x speedup, step: 6
Epoch 10/300 |loss: 0.014110| train set 1.896x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.011936| train set 2.167x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010825| train set 1.881x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010860| train set 2.322x speedup, test set 0.969x speedup, val set 0.863x speedup, step: 10
Epoch 14/300 |loss: 0.010092| train set 2.135x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009922| train set 2.888x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009081| train set 2.694x speedup, test set 0.969x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.010643| train set 1.967x speedup, test set 0.958x speedup, val set 0.839x speedup, step: 14
Epoch 18/300 |loss: 0.009825| train set 3.001x speedup, test set 0.958x speedup, val set 0.830x speedup, step: 15
Epoch 19/300 |loss: 0.008225| train set 3.126x speedup, test set 0.958x speedup, val set 0.836x speedup, step: 16
Epoch 20/300 |loss: 0.008351| train set 2.267x speedup, test set 0.958x speedup, val set 0.850x speedup, step: 17
Epoch 21/300 |loss: 0.007036| train set 3.093x speedup, test set 0.958x speedup, val set 0.844x speedup, step: 18
Epoch 22/300 |loss: 0.006528| train set 2.972x speedup, test set 0.958x speedup, val set 0.917x speedup, step: 19
Epoch 23/300 |loss: 0.005923| train set 3.086x speedup, test set 0.958x speedup, val set 0.908x speedup, step: 20
Epoch 24/300 |loss: 0.006911| train set 2.762x speedup, test set 0.958x speedup, val set 0.900x speedup, step: 21
Epoch 25/300 |loss: 0.006250| train set 2.944x speedup, test set 0.969x speedup, val set 0.838x speedup, step: 22
Epoch 26/300 |loss: 0.005511| train set 2.916x speedup, test set 0.914x speedup, val set 0.815x speedup, step: 23
Epoch 27/300 |loss: 0.005048| train set 2.754x speedup, test set 0.969x speedup, val set 0.900x speedup, step: 24
Epoch 28/300 |loss: 0.004742| train set 3.147x speedup, test set 0.969x speedup, val set 0.922x speedup, step: 25
Epoch 29/300 |loss: 0.004850| train set 3.043x speedup, test set 0.952x speedup, val set 0.836x speedup, step: 26
Epoch 30/300 |loss: 0.004837| train set 2.987x speedup, test set 0.969x speedup, val set 0.909x speedup, step: 27
Epoch 31/300 |loss: 0.004377| train set 2.849x speedup, test set 0.969x speedup, val set 0.844x speedup, step: 28
Epoch 32/300 |loss: 0.004490| train set 2.912x speedup, test set 0.969x speedup, val set 0.915x speedup, step: 29
Epoch 33/300 |loss: 0.004900| train set 3.161x speedup, test set 0.969x speedup, val set 0.909x speedup, step: 30
Epoch 34/300 |loss: 0.004183| train set 3.141x speedup, test set 0.969x speedup, val set 0.838x speedup, step: 31
Epoch 35/300 |loss: 0.003729| train set 3.201x speedup, test set 0.969x speedup, val set 0.890x speedup, step: 32
Epoch 36/300 |loss: 0.003241| train set 3.262x speedup, test set 0.969x speedup, val set 0.891x speedup, step: 33
Epoch 37/300 |loss: 0.003410| train set 2.735x speedup, test set 0.969x speedup, val set 0.825x speedup, step: 34
Epoch 38/300 |loss: 0.005363| train set 3.201x speedup, test set 0.969x speedup, val set 0.890x speedup, step: 35
Epoch 39/300 |loss: 0.003886| train set 3.208x speedup, test set 0.952x speedup, val set 0.890x speedup, step: 36
Epoch 40/300 |loss: 0.003699| train set 3.243x speedup, test set 0.952x speedup, val set 0.891x speedup, step: 37
Epoch 41/300 |loss: 0.003116| train set 3.248x speedup, test set 0.969x speedup, val set 0.915x speedup, step: 38
Epoch 42/300 |loss: 0.003082| train set 3.191x speedup, test set 0.958x speedup, val set 0.917x speedup, step: 39
Epoch 43/300 |loss: 0.003418| train set 3.251x speedup, test set 0.952x speedup, val set 0.911x speedup, step: 40
Epoch 44/300 |loss: 0.003075| train set 3.219x speedup, test set 0.952x speedup, val set 0.890x speedup, step: 41
Epoch 45/300 |loss: 0.002594| train set 3.310x speedup, test set 0.958x speedup, val set 0.893x speedup, step: 42
Epoch 46/300 |loss: 0.002621| train set 3.241x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 43
Epoch 47/300 |loss: 0.002869| train set 2.998x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 44
Epoch 48/300 |loss: 0.002818| train set 3.285x speedup, test set 0.952x speedup, val set 0.908x speedup, step: 45
Epoch 49/300 |loss: 0.002439| train set 3.302x speedup, test set 0.952x speedup, val set 0.893x speedup, step: 46
Epoch 50/300 |loss: 0.002842| train set 3.185x speedup, test set 0.952x speedup, val set 0.917x speedup, step: 47
Epoch 51/300 |loss: 0.003598| train set 3.271x speedup, test set 0.952x speedup, val set 0.918x speedup, step: 48
Epoch 52/300 |loss: 0.002773| train set 3.254x speedup, test set 0.922x speedup, val set 0.918x speedup, step: 49
Epoch 53/300 |loss: 0.002454| train set 3.255x speedup, test set 0.922x speedup, val set 0.915x speedup, step: 50
Epoch 54/300 |loss: 0.002738| train set 3.111x speedup, test set 0.938x speedup, val set 0.893x speedup, step: 51
Epoch 55/300 |loss: 0.002771| train set 3.267x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 52
early stopping at epoch 55
Training per epoch cost 1.356 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 45, train speedup 3.310, test speedup 0.958, val speedup 0.893
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.040, test speedup 6.351, val speedup 1.396
last model at epoch 55, train speedup 3.267, test speedup 0.922, val speedup 0.890
execution cost 0:01:56.254848
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.774373, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019301| train set 1.048x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016924| train set 0.970x speedup, test set 0.974x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017548| train set 0.980x speedup, test set 1.018x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014957| train set 1.004x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014416| train set 0.957x speedup, test set 1.012x speedup, val set 0.851x speedup, step: 5
Epoch 9/300 |loss: 0.014551| train set 0.997x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 6
Epoch 10/300 |loss: 0.014058| train set 1.881x speedup, test set 0.958x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.011709| train set 2.494x speedup, test set 0.969x speedup, val set 0.847x speedup, step: 8
Epoch 12/300 |loss: 0.010952| train set 2.040x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010867| train set 2.396x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 10
Epoch 14/300 |loss: 0.010515| train set 2.314x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009506| train set 3.152x speedup, test set 0.958x speedup, val set 0.847x speedup, step: 12
Epoch 16/300 |loss: 0.008946| train set 2.439x speedup, test set 0.963x speedup, val set 0.837x speedup, step: 13
Epoch 17/300 |loss: 0.009385| train set 1.846x speedup, test set 0.963x speedup, val set 0.859x speedup, step: 14
Epoch 18/300 |loss: 0.008655| train set 2.908x speedup, test set 0.963x speedup, val set 0.847x speedup, step: 15
Epoch 19/300 |loss: 0.007478| train set 3.163x speedup, test set 0.963x speedup, val set 0.836x speedup, step: 16
Epoch 20/300 |loss: 0.007390| train set 2.590x speedup, test set 0.958x speedup, val set 0.860x speedup, step: 17
Epoch 21/300 |loss: 0.006620| train set 2.764x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 18
Epoch 22/300 |loss: 0.006089| train set 3.162x speedup, test set 0.963x speedup, val set 0.900x speedup, step: 19
Epoch 23/300 |loss: 0.005378| train set 3.167x speedup, test set 0.958x speedup, val set 0.846x speedup, step: 20
Epoch 24/300 |loss: 0.005946| train set 2.745x speedup, test set 0.952x speedup, val set 0.839x speedup, step: 21
Epoch 25/300 |loss: 0.005643| train set 2.780x speedup, test set 0.958x speedup, val set 0.839x speedup, step: 22
Epoch 26/300 |loss: 0.004918| train set 2.459x speedup, test set 0.958x speedup, val set 0.840x speedup, step: 23
Epoch 27/300 |loss: 0.004933| train set 3.123x speedup, test set 0.958x speedup, val set 0.836x speedup, step: 24
Epoch 28/300 |loss: 0.004754| train set 3.167x speedup, test set 0.958x speedup, val set 0.830x speedup, step: 25
Epoch 29/300 |loss: 0.004543| train set 3.240x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 26
Epoch 30/300 |loss: 0.004161| train set 3.006x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 27
Epoch 31/300 |loss: 0.004222| train set 2.453x speedup, test set 0.958x speedup, val set 0.836x speedup, step: 28
Epoch 32/300 |loss: 0.004371| train set 2.926x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 29
Epoch 33/300 |loss: 0.004767| train set 3.274x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 30
Epoch 34/300 |loss: 0.003895| train set 3.243x speedup, test set 0.958x speedup, val set 0.842x speedup, step: 31
Epoch 35/300 |loss: 0.004360| train set 3.182x speedup, test set 0.958x speedup, val set 0.910x speedup, step: 32
Epoch 36/300 |loss: 0.003433| train set 3.230x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 33
Epoch 37/300 |loss: 0.003435| train set 3.163x speedup, test set 0.958x speedup, val set 0.841x speedup, step: 34
Epoch 38/300 |loss: 0.004445| train set 3.130x speedup, test set 0.952x speedup, val set 0.840x speedup, step: 35
Epoch 39/300 |loss: 0.004186| train set 3.215x speedup, test set 0.952x speedup, val set 0.835x speedup, step: 36
early stopping at epoch 39
Training per epoch cost 1.365 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 33, train speedup 3.274, test speedup 0.958, val speedup 0.838
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.048, test speedup 6.351, val speedup 1.339
last model at epoch 39, train speedup 3.215, test speedup 0.952, val speedup 0.835
execution cost 0:01:25.581640
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.803993, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023063| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020843| train set 0.871x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019141| train set 1.024x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016673| train set 0.962x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017276| train set 0.993x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014856| train set 1.020x speedup, test set 1.012x speedup, val set 0.861x speedup, step: 4
Epoch 8/300 |loss: 0.014095| train set 0.984x speedup, test set 1.012x speedup, val set 0.850x speedup, step: 5
Epoch 9/300 |loss: 0.013444| train set 0.733x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 6
Epoch 10/300 |loss: 0.013282| train set 2.217x speedup, test set 0.969x speedup, val set 0.853x speedup, step: 7
Epoch 11/300 |loss: 0.012363| train set 2.007x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010923| train set 2.023x speedup, test set 0.969x speedup, val set 0.858x speedup, step: 9
Epoch 13/300 |loss: 0.010865| train set 2.119x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 10
Epoch 14/300 |loss: 0.010006| train set 2.689x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009704| train set 3.052x speedup, test set 0.969x speedup, val set 0.831x speedup, step: 12
Epoch 16/300 |loss: 0.009302| train set 2.550x speedup, test set 0.925x speedup, val set 0.842x speedup, step: 13
Epoch 17/300 |loss: 0.009106| train set 1.709x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 14
Epoch 18/300 |loss: 0.009070| train set 3.021x speedup, test set 0.969x speedup, val set 0.836x speedup, step: 15
Epoch 19/300 |loss: 0.007869| train set 3.111x speedup, test set 0.969x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.007621| train set 2.600x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 17
Epoch 21/300 |loss: 0.007064| train set 2.422x speedup, test set 0.969x speedup, val set 0.836x speedup, step: 18
Epoch 22/300 |loss: 0.006752| train set 2.935x speedup, test set 0.969x speedup, val set 0.846x speedup, step: 19
Epoch 23/300 |loss: 0.005687| train set 3.055x speedup, test set 0.969x speedup, val set 0.842x speedup, step: 20
Epoch 24/300 |loss: 0.006290| train set 2.726x speedup, test set 0.969x speedup, val set 0.901x speedup, step: 21
Epoch 25/300 |loss: 0.006422| train set 3.137x speedup, test set 0.969x speedup, val set 0.838x speedup, step: 22
Epoch 26/300 |loss: 0.005404| train set 2.902x speedup, test set 0.969x speedup, val set 0.823x speedup, step: 23
Epoch 27/300 |loss: 0.005604| train set 2.662x speedup, test set 0.969x speedup, val set 0.898x speedup, step: 24
Epoch 28/300 |loss: 0.005136| train set 3.305x speedup, test set 0.938x speedup, val set 0.925x speedup, step: 25
Epoch 29/300 |loss: 0.004954| train set 3.194x speedup, test set 0.969x speedup, val set 0.824x speedup, step: 26
Epoch 30/300 |loss: 0.004733| train set 2.963x speedup, test set 0.938x speedup, val set 0.934x speedup, step: 27
Epoch 31/300 |loss: 0.004314| train set 2.999x speedup, test set 0.969x speedup, val set 0.836x speedup, step: 28
Epoch 32/300 |loss: 0.004202| train set 2.633x speedup, test set 0.969x speedup, val set 0.910x speedup, step: 29
Epoch 33/300 |loss: 0.004073| train set 3.175x speedup, test set 0.969x speedup, val set 0.908x speedup, step: 30
Epoch 34/300 |loss: 0.004162| train set 2.725x speedup, test set 0.969x speedup, val set 0.912x speedup, step: 31
Epoch 35/300 |loss: 0.005264| train set 3.179x speedup, test set 0.938x speedup, val set 0.910x speedup, step: 32
Epoch 36/300 |loss: 0.003336| train set 3.203x speedup, test set 0.969x speedup, val set 0.910x speedup, step: 33
Epoch 37/300 |loss: 0.003420| train set 3.093x speedup, test set 0.969x speedup, val set 0.912x speedup, step: 34
Epoch 38/300 |loss: 0.005489| train set 2.950x speedup, test set 0.969x speedup, val set 0.912x speedup, step: 35
Epoch 39/300 |loss: 0.003826| train set 3.242x speedup, test set 0.938x speedup, val set 0.908x speedup, step: 36
Epoch 40/300 |loss: 0.003429| train set 3.239x speedup, test set 0.938x speedup, val set 0.911x speedup, step: 37
Epoch 41/300 |loss: 0.002925| train set 3.118x speedup, test set 0.938x speedup, val set 0.910x speedup, step: 38
Epoch 42/300 |loss: 0.003345| train set 3.213x speedup, test set 0.938x speedup, val set 0.911x speedup, step: 39
Epoch 43/300 |loss: 0.003281| train set 3.153x speedup, test set 0.969x speedup, val set 0.911x speedup, step: 40
Epoch 44/300 |loss: 0.003210| train set 3.250x speedup, test set 0.969x speedup, val set 0.689x speedup, step: 41
Epoch 45/300 |loss: 0.002557| train set 3.370x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 42
Epoch 46/300 |loss: 0.002585| train set 3.349x speedup, test set 0.969x speedup, val set 0.908x speedup, step: 43
Epoch 47/300 |loss: 0.002653| train set 2.908x speedup, test set 0.969x speedup, val set 0.892x speedup, step: 44
Epoch 48/300 |loss: 0.002835| train set 3.259x speedup, test set 0.938x speedup, val set 0.893x speedup, step: 45
Epoch 49/300 |loss: 0.002444| train set 3.313x speedup, test set 0.969x speedup, val set 0.912x speedup, step: 46
Epoch 50/300 |loss: 0.002640| train set 3.317x speedup, test set 0.969x speedup, val set 0.811x speedup, step: 47
Epoch 51/300 |loss: 0.002791| train set 3.293x speedup, test set 0.969x speedup, val set 1.085x speedup, step: 48
Epoch 52/300 |loss: 0.002386| train set 3.248x speedup, test set 0.969x speedup, val set 0.813x speedup, step: 49
Epoch 53/300 |loss: 0.002277| train set 3.361x speedup, test set 0.969x speedup, val set 0.810x speedup, step: 50
Epoch 54/300 |loss: 0.002403| train set 3.199x speedup, test set 0.969x speedup, val set 0.792x speedup, step: 51
Epoch 55/300 |loss: 0.002477| train set 3.292x speedup, test set 0.969x speedup, val set 0.811x speedup, step: 52
Epoch 56/300 |loss: 0.002336| train set 3.319x speedup, test set 0.969x speedup, val set 0.812x speedup, step: 53
Epoch 57/300 |loss: 0.002325| train set 3.213x speedup, test set 0.969x speedup, val set 0.812x speedup, step: 54
Epoch 58/300 |loss: 0.002127| train set 3.263x speedup, test set 0.952x speedup, val set 0.813x speedup, step: 55
Epoch 59/300 |loss: 0.002209| train set 3.113x speedup, test set 0.938x speedup, val set 0.813x speedup, step: 56
Epoch 60/300 |loss: 0.001914| train set 3.332x speedup, test set 0.969x speedup, val set 0.812x speedup, step: 57
Epoch 61/300 |loss: 0.002095| train set 3.329x speedup, test set 0.969x speedup, val set 0.813x speedup, step: 58
Epoch 62/300 |loss: 0.002109| train set 3.296x speedup, test set 0.952x speedup, val set 0.811x speedup, step: 59
Epoch 63/300 |loss: 0.002278| train set 3.326x speedup, test set 0.969x speedup, val set 0.812x speedup, step: 60
Epoch 64/300 |loss: 0.002083| train set 3.269x speedup, test set 0.969x speedup, val set 0.812x speedup, step: 61
Epoch 65/300 |loss: 0.002084| train set 3.326x speedup, test set 0.938x speedup, val set 0.811x speedup, step: 62
Epoch 66/300 |loss: 0.001995| train set 3.228x speedup, test set 0.969x speedup, val set 0.788x speedup, step: 63
Epoch 67/300 |loss: 0.002371| train set 3.183x speedup, test set 0.969x speedup, val set 0.811x speedup, step: 64
Epoch 68/300 |loss: 0.001908| train set 3.329x speedup, test set 0.969x speedup, val set 0.734x speedup, step: 65
Epoch 69/300 |loss: 0.001853| train set 3.273x speedup, test set 0.969x speedup, val set 0.858x speedup, step: 66
Epoch 70/300 |loss: 0.002085| train set 3.334x speedup, test set 0.925x speedup, val set 0.812x speedup, step: 67
Epoch 71/300 |loss: 0.002349| train set 3.261x speedup, test set 0.952x speedup, val set 0.877x speedup, step: 68
Epoch 72/300 |loss: 0.002107| train set 3.339x speedup, test set 0.896x speedup, val set 0.812x speedup, step: 69
Epoch 73/300 |loss: 0.001971| train set 3.200x speedup, test set 0.938x speedup, val set 0.735x speedup, step: 70
Epoch 74/300 |loss: 0.001808| train set 3.301x speedup, test set 0.952x speedup, val set 0.810x speedup, step: 71
Epoch 75/300 |loss: 0.001964| train set 3.239x speedup, test set 0.952x speedup, val set 0.812x speedup, step: 72
Epoch 76/300 |loss: 0.001651| train set 3.309x speedup, test set 0.952x speedup, val set 0.858x speedup, step: 73
Epoch 77/300 |loss: 0.001719| train set 3.316x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 74
Epoch 78/300 |loss: 0.001793| train set 3.021x speedup, test set 0.952x speedup, val set 0.812x speedup, step: 75
Epoch 79/300 |loss: 0.001621| train set 3.370x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 76
Epoch 80/300 |loss: 0.001905| train set 3.364x speedup, test set 0.952x speedup, val set 0.732x speedup, step: 77
Epoch 81/300 |loss: 0.001878| train set 3.280x speedup, test set 0.922x speedup, val set 0.733x speedup, step: 78
Epoch 82/300 |loss: 0.001617| train set 3.305x speedup, test set 0.922x speedup, val set 0.732x speedup, step: 79
Epoch 83/300 |loss: 0.001715| train set 3.334x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 80
Epoch 84/300 |loss: 0.001698| train set 3.241x speedup, test set 0.938x speedup, val set 0.879x speedup, step: 81
Epoch 85/300 |loss: 0.001457| train set 3.240x speedup, test set 0.922x speedup, val set 0.788x speedup, step: 82
Epoch 86/300 |loss: 0.001687| train set 3.324x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 83
Epoch 87/300 |loss: 0.001551| train set 3.294x speedup, test set 0.922x speedup, val set 0.733x speedup, step: 84
Epoch 88/300 |loss: 0.002026| train set 3.351x speedup, test set 3.695x speedup, val set 0.811x speedup, step: 85
Epoch 89/300 |loss: 0.001713| train set 3.331x speedup, test set 0.922x speedup, val set 0.878x speedup, step: 86
Epoch 90/300 |loss: 0.001805| train set 3.268x speedup, test set 0.922x speedup, val set 0.976x speedup, step: 87
Epoch 91/300 |loss: 0.001986| train set 3.209x speedup, test set 0.922x speedup, val set 0.769x speedup, step: 88
early stopping at epoch 91
Training per epoch cost 1.363 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 79, train speedup 3.370, test speedup 0.922, val speedup 0.812
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.024, test speedup 6.351, val speedup 1.396
last model at epoch 91, train speedup 3.209, test speedup 0.922, val speedup 0.769
execution cost 0:03:02.836554
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.747645, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023067| train set 0.693x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020860| train set 0.861x speedup, test set 0.855x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019298| train set 1.024x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016803| train set 0.954x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017498| train set 1.009x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014889| train set 1.003x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014105| train set 0.991x speedup, test set 1.012x speedup, val set 0.851x speedup, step: 5
Epoch 9/300 |loss: 0.013462| train set 0.747x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 6
Epoch 10/300 |loss: 0.013448| train set 2.391x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 7
Epoch 11/300 |loss: 0.012567| train set 1.906x speedup, test set 0.969x speedup, val set 0.829x speedup, step: 8
Epoch 12/300 |loss: 0.010816| train set 1.871x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010720| train set 2.260x speedup, test set 0.969x speedup, val set 0.862x speedup, step: 10
Epoch 14/300 |loss: 0.010090| train set 2.588x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.009921| train set 3.259x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 12
Epoch 16/300 |loss: 0.009371| train set 2.750x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 13
Epoch 17/300 |loss: 0.008982| train set 1.707x speedup, test set 0.969x speedup, val set 0.858x speedup, step: 14
Epoch 18/300 |loss: 0.008989| train set 2.959x speedup, test set 0.969x speedup, val set 0.836x speedup, step: 15
Epoch 19/300 |loss: 0.008032| train set 2.800x speedup, test set 0.969x speedup, val set 0.843x speedup, step: 16
Epoch 20/300 |loss: 0.008057| train set 2.523x speedup, test set 0.958x speedup, val set 0.852x speedup, step: 17
Epoch 21/300 |loss: 0.007054| train set 2.648x speedup, test set 0.969x speedup, val set 0.838x speedup, step: 18
Epoch 22/300 |loss: 0.006375| train set 3.094x speedup, test set 0.958x speedup, val set 0.846x speedup, step: 19
Epoch 23/300 |loss: 0.005786| train set 3.125x speedup, test set 0.958x speedup, val set 0.832x speedup, step: 20
Epoch 24/300 |loss: 0.006660| train set 2.821x speedup, test set 0.952x speedup, val set 0.881x speedup, step: 21
Epoch 25/300 |loss: 0.006826| train set 2.599x speedup, test set 0.969x speedup, val set 0.816x speedup, step: 22
Epoch 26/300 |loss: 0.005369| train set 2.812x speedup, test set 0.969x speedup, val set 0.908x speedup, step: 23
Epoch 27/300 |loss: 0.005721| train set 2.905x speedup, test set 0.969x speedup, val set 0.917x speedup, step: 24
Epoch 28/300 |loss: 0.005123| train set 3.312x speedup, test set 0.954x speedup, val set 0.899x speedup, step: 25
Epoch 29/300 |loss: 0.004776| train set 3.167x speedup, test set 0.952x speedup, val set 0.888x speedup, step: 26
Epoch 30/300 |loss: 0.004510| train set 3.045x speedup, test set 0.958x speedup, val set 0.889x speedup, step: 27
Epoch 31/300 |loss: 0.004485| train set 2.997x speedup, test set 0.938x speedup, val set 0.887x speedup, step: 28
Epoch 32/300 |loss: 0.004346| train set 2.979x speedup, test set 0.958x speedup, val set 0.906x speedup, step: 29
Epoch 33/300 |loss: 0.004670| train set 3.217x speedup, test set 0.927x speedup, val set 0.882x speedup, step: 30
Epoch 34/300 |loss: 0.003928| train set 2.940x speedup, test set 0.938x speedup, val set 0.912x speedup, step: 31
Epoch 35/300 |loss: 0.004869| train set 3.130x speedup, test set 0.927x speedup, val set 0.888x speedup, step: 32
Epoch 36/300 |loss: 0.003486| train set 3.162x speedup, test set 0.927x speedup, val set 0.866x speedup, step: 33
Epoch 37/300 |loss: 0.003363| train set 3.029x speedup, test set 0.927x speedup, val set 0.908x speedup, step: 34
Epoch 38/300 |loss: 0.005160| train set 2.963x speedup, test set 0.922x speedup, val set 0.918x speedup, step: 35
Epoch 39/300 |loss: 0.004254| train set 3.239x speedup, test set 0.922x speedup, val set 0.907x speedup, step: 36
Epoch 40/300 |loss: 0.003998| train set 3.256x speedup, test set 0.927x speedup, val set 0.914x speedup, step: 37
Epoch 41/300 |loss: 0.003144| train set 3.226x speedup, test set 0.922x speedup, val set 0.791x speedup, step: 38
Epoch 42/300 |loss: 0.003493| train set 3.094x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 39
Epoch 43/300 |loss: 0.003603| train set 3.257x speedup, test set 0.927x speedup, val set 0.867x speedup, step: 40
Epoch 44/300 |loss: 0.003081| train set 3.255x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 41
Epoch 45/300 |loss: 0.002683| train set 3.333x speedup, test set 0.932x speedup, val set 0.791x speedup, step: 42
Epoch 46/300 |loss: 0.002789| train set 3.306x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 43
Epoch 47/300 |loss: 0.002687| train set 3.194x speedup, test set 0.927x speedup, val set 0.790x speedup, step: 44
Epoch 48/300 |loss: 0.003026| train set 3.274x speedup, test set 0.926x speedup, val set 0.790x speedup, step: 45
Epoch 49/300 |loss: 0.002861| train set 3.248x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 46
Epoch 50/300 |loss: 0.002693| train set 3.343x speedup, test set 0.929x speedup, val set 0.791x speedup, step: 47
Epoch 51/300 |loss: 0.002908| train set 3.343x speedup, test set 0.929x speedup, val set 0.790x speedup, step: 48
Epoch 52/300 |loss: 0.002619| train set 3.143x speedup, test set 0.932x speedup, val set 0.791x speedup, step: 49
Epoch 53/300 |loss: 0.002415| train set 3.330x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 50
Epoch 54/300 |loss: 0.002777| train set 3.237x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 51
Epoch 55/300 |loss: 0.002652| train set 3.149x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 52
Epoch 56/300 |loss: 0.002725| train set 3.244x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 53
Epoch 57/300 |loss: 0.002502| train set 3.040x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 54
Epoch 58/300 |loss: 0.002450| train set 3.184x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 55
Epoch 59/300 |loss: 0.002482| train set 3.340x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 56
Epoch 60/300 |loss: 0.002089| train set 3.381x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 57
Epoch 61/300 |loss: 0.002418| train set 3.280x speedup, test set 0.932x speedup, val set 0.790x speedup, step: 58
Epoch 62/300 |loss: 0.002500| train set 3.182x speedup, test set 0.932x speedup, val set 0.792x speedup, step: 59
early stopping at epoch 62
Training per epoch cost 1.347 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 60, train speedup 3.381, test speedup 0.932, val speedup 0.790
best test speedup epoch: 2, train speedup 0.693, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.024, test speedup 6.351, val speedup 1.339
last model at epoch 62, train speedup 3.182, test speedup 0.932, val speedup 0.792
execution cost 0:02:07.991227
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.750538, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019301| train set 1.048x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016924| train set 0.970x speedup, test set 0.974x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017548| train set 0.980x speedup, test set 1.018x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014957| train set 1.004x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014403| train set 0.957x speedup, test set 1.012x speedup, val set 0.851x speedup, step: 5
Epoch 9/300 |loss: 0.014498| train set 0.729x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 6
Epoch 10/300 |loss: 0.013891| train set 1.857x speedup, test set 0.974x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.011811| train set 2.210x speedup, test set 0.969x speedup, val set 0.847x speedup, step: 8
Epoch 12/300 |loss: 0.011081| train set 2.226x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010859| train set 2.226x speedup, test set 0.969x speedup, val set 0.863x speedup, step: 10
Epoch 14/300 |loss: 0.010779| train set 2.625x speedup, test set 0.974x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009462| train set 3.186x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.008911| train set 2.483x speedup, test set 0.958x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.009213| train set 1.723x speedup, test set 0.963x speedup, val set 0.852x speedup, step: 14
Epoch 18/300 |loss: 0.008556| train set 2.745x speedup, test set 0.958x speedup, val set 0.844x speedup, step: 15
Epoch 19/300 |loss: 0.007709| train set 3.079x speedup, test set 0.958x speedup, val set 0.842x speedup, step: 16
Epoch 20/300 |loss: 0.007356| train set 2.668x speedup, test set 0.958x speedup, val set 0.858x speedup, step: 17
Epoch 21/300 |loss: 0.007119| train set 2.608x speedup, test set 0.958x speedup, val set 0.842x speedup, step: 18
Epoch 22/300 |loss: 0.006150| train set 3.003x speedup, test set 0.963x speedup, val set 0.838x speedup, step: 19
Epoch 23/300 |loss: 0.005416| train set 3.095x speedup, test set 0.958x speedup, val set 0.846x speedup, step: 20
Epoch 24/300 |loss: 0.006149| train set 2.903x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 21
Epoch 25/300 |loss: 0.006099| train set 2.648x speedup, test set 0.958x speedup, val set 0.846x speedup, step: 22
Epoch 26/300 |loss: 0.005042| train set 2.444x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 23
Epoch 27/300 |loss: 0.004660| train set 2.732x speedup, test set 0.958x speedup, val set 0.839x speedup, step: 24
Epoch 28/300 |loss: 0.004882| train set 3.074x speedup, test set 0.958x speedup, val set 0.830x speedup, step: 25
Epoch 29/300 |loss: 0.004387| train set 3.258x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 26
Epoch 30/300 |loss: 0.004184| train set 3.153x speedup, test set 0.958x speedup, val set 0.817x speedup, step: 27
Epoch 31/300 |loss: 0.004188| train set 2.682x speedup, test set 0.958x speedup, val set 0.803x speedup, step: 28
Epoch 32/300 |loss: 0.004427| train set 3.045x speedup, test set 0.958x speedup, val set 0.910x speedup, step: 29
Epoch 33/300 |loss: 0.005011| train set 3.082x speedup, test set 0.963x speedup, val set 0.819x speedup, step: 30
Epoch 34/300 |loss: 0.004059| train set 2.822x speedup, test set 0.963x speedup, val set 0.840x speedup, step: 31
Epoch 35/300 |loss: 0.004065| train set 3.028x speedup, test set 0.958x speedup, val set 0.804x speedup, step: 32
Epoch 36/300 |loss: 0.003288| train set 3.233x speedup, test set 0.958x speedup, val set 0.824x speedup, step: 33
Epoch 37/300 |loss: 0.003368| train set 3.234x speedup, test set 0.958x speedup, val set 0.885x speedup, step: 34
Epoch 38/300 |loss: 0.004233| train set 3.246x speedup, test set 0.958x speedup, val set 0.846x speedup, step: 35
Epoch 39/300 |loss: 0.004449| train set 3.293x speedup, test set 0.952x speedup, val set 0.910x speedup, step: 36
early stopping at epoch 39
Training per epoch cost 1.354 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 39, train speedup 3.293, test speedup 0.952, val speedup 0.910
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.048, test speedup 6.351, val speedup 1.339
last model at epoch 39, train speedup 3.293, test speedup 0.952, val speedup 0.910
execution cost 0:01:23.009020
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.781822, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023067| train set 0.693x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020860| train set 0.861x speedup, test set 0.855x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019298| train set 1.024x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016806| train set 0.962x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017461| train set 1.008x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014928| train set 0.970x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.013970| train set 0.940x speedup, test set 1.012x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013332| train set 1.004x speedup, test set 1.012x speedup, val set 0.835x speedup, step: 6
Epoch 10/300 |loss: 0.013526| train set 2.270x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.012849| train set 1.836x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010981| train set 1.874x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010753| train set 2.243x speedup, test set 0.969x speedup, val set 0.858x speedup, step: 10
Epoch 14/300 |loss: 0.010057| train set 2.566x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.009980| train set 3.161x speedup, test set 0.969x speedup, val set 0.858x speedup, step: 12
Epoch 16/300 |loss: 0.009455| train set 2.601x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 13
Epoch 17/300 |loss: 0.009664| train set 1.793x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 14
Epoch 18/300 |loss: 0.009280| train set 3.055x speedup, test set 0.969x speedup, val set 0.840x speedup, step: 15
Epoch 19/300 |loss: 0.008524| train set 3.176x speedup, test set 0.969x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.008807| train set 2.581x speedup, test set 0.969x speedup, val set 0.836x speedup, step: 17
Epoch 21/300 |loss: 0.007294| train set 2.614x speedup, test set 0.969x speedup, val set 0.836x speedup, step: 18
Epoch 22/300 |loss: 0.006557| train set 3.056x speedup, test set 0.969x speedup, val set 0.916x speedup, step: 19
Epoch 23/300 |loss: 0.006086| train set 3.109x speedup, test set 0.969x speedup, val set 0.909x speedup, step: 20
Epoch 24/300 |loss: 0.007493| train set 2.796x speedup, test set 0.969x speedup, val set 0.836x speedup, step: 21
Epoch 25/300 |loss: 0.006833| train set 3.031x speedup, test set 0.969x speedup, val set 0.844x speedup, step: 22
Epoch 26/300 |loss: 0.005540| train set 2.717x speedup, test set 0.969x speedup, val set 0.844x speedup, step: 23
Epoch 27/300 |loss: 0.005458| train set 2.746x speedup, test set 0.969x speedup, val set 0.985x speedup, step: 24
Epoch 28/300 |loss: 0.005524| train set 3.086x speedup, test set 0.969x speedup, val set 0.922x speedup, step: 25
Epoch 29/300 |loss: 0.005419| train set 3.176x speedup, test set 0.969x speedup, val set 0.907x speedup, step: 26
Epoch 30/300 |loss: 0.005223| train set 3.046x speedup, test set 0.969x speedup, val set 0.891x speedup, step: 27
Epoch 31/300 |loss: 0.004834| train set 2.959x speedup, test set 0.969x speedup, val set 0.914x speedup, step: 28
Epoch 32/300 |loss: 0.004285| train set 3.089x speedup, test set 0.969x speedup, val set 0.907x speedup, step: 29
Epoch 33/300 |loss: 0.004276| train set 3.210x speedup, test set 0.969x speedup, val set 0.905x speedup, step: 30
Epoch 34/300 |loss: 0.004277| train set 2.851x speedup, test set 0.969x speedup, val set 0.855x speedup, step: 31
Epoch 35/300 |loss: 0.006012| train set 2.638x speedup, test set 0.969x speedup, val set 0.885x speedup, step: 32
Epoch 36/300 |loss: 0.003932| train set 3.167x speedup, test set 0.952x speedup, val set 0.868x speedup, step: 33
Epoch 37/300 |loss: 0.003765| train set 3.116x speedup, test set 0.969x speedup, val set 0.910x speedup, step: 34
Epoch 38/300 |loss: 0.004108| train set 3.074x speedup, test set 0.952x speedup, val set 0.916x speedup, step: 35
Epoch 39/300 |loss: 0.004368| train set 3.250x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 36
Epoch 40/300 |loss: 0.004219| train set 3.270x speedup, test set 0.952x speedup, val set 0.914x speedup, step: 37
Epoch 41/300 |loss: 0.003116| train set 2.950x speedup, test set 0.952x speedup, val set 0.894x speedup, step: 38
Epoch 42/300 |loss: 0.003723| train set 3.119x speedup, test set 0.969x speedup, val set 0.868x speedup, step: 39
Epoch 43/300 |loss: 0.003747| train set 3.226x speedup, test set 0.952x speedup, val set 0.886x speedup, step: 40
Epoch 44/300 |loss: 0.003226| train set 3.075x speedup, test set 0.952x speedup, val set 0.870x speedup, step: 41
Epoch 45/300 |loss: 0.002962| train set 3.366x speedup, test set 0.952x speedup, val set 0.891x speedup, step: 42
Epoch 46/300 |loss: 0.002938| train set 3.260x speedup, test set 0.952x speedup, val set 0.867x speedup, step: 43
Epoch 47/300 |loss: 0.003142| train set 3.106x speedup, test set 0.952x speedup, val set 0.891x speedup, step: 44
Epoch 48/300 |loss: 0.003101| train set 3.168x speedup, test set 0.952x speedup, val set 0.891x speedup, step: 45
Epoch 49/300 |loss: 0.002678| train set 3.093x speedup, test set 0.952x speedup, val set 0.886x speedup, step: 46
Epoch 50/300 |loss: 0.002788| train set 3.277x speedup, test set 0.952x speedup, val set 0.867x speedup, step: 47
Epoch 51/300 |loss: 0.003400| train set 3.311x speedup, test set 0.952x speedup, val set 0.893x speedup, step: 48
Epoch 52/300 |loss: 0.002885| train set 3.034x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 49
Epoch 53/300 |loss: 0.002728| train set 3.277x speedup, test set 0.922x speedup, val set 0.891x speedup, step: 50
Epoch 54/300 |loss: 0.002748| train set 3.198x speedup, test set 0.922x speedup, val set 0.891x speedup, step: 51
Epoch 55/300 |loss: 0.002723| train set 3.331x speedup, test set 0.952x speedup, val set 0.891x speedup, step: 52
Epoch 56/300 |loss: 0.002824| train set 3.316x speedup, test set 0.952x speedup, val set 0.792x speedup, step: 53
Epoch 57/300 |loss: 0.002655| train set 3.205x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 54
Epoch 58/300 |loss: 0.002467| train set 3.360x speedup, test set 0.952x speedup, val set 0.885x speedup, step: 55
Epoch 59/300 |loss: 0.002602| train set 3.231x speedup, test set 0.922x speedup, val set 0.887x speedup, step: 56
Epoch 60/300 |loss: 0.002529| train set 3.256x speedup, test set 0.952x speedup, val set 0.893x speedup, step: 57
Epoch 61/300 |loss: 0.002376| train set 3.212x speedup, test set 0.952x speedup, val set 0.868x speedup, step: 58
Epoch 62/300 |loss: 0.002365| train set 3.210x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 59
Epoch 63/300 |loss: 0.002398| train set 3.308x speedup, test set 0.952x speedup, val set 0.870x speedup, step: 60
Epoch 64/300 |loss: 0.002238| train set 3.292x speedup, test set 0.952x speedup, val set 0.870x speedup, step: 61
Epoch 65/300 |loss: 0.002339| train set 3.251x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 62
Epoch 66/300 |loss: 0.002414| train set 3.330x speedup, test set 0.922x speedup, val set 0.809x speedup, step: 63
Epoch 67/300 |loss: 0.002671| train set 3.045x speedup, test set 0.952x speedup, val set 0.888x speedup, step: 64
Epoch 68/300 |loss: 0.002382| train set 3.186x speedup, test set 0.922x speedup, val set 0.917x speedup, step: 65
Epoch 69/300 |loss: 0.002185| train set 3.308x speedup, test set 0.952x speedup, val set 0.886x speedup, step: 66
Epoch 70/300 |loss: 0.002360| train set 3.365x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 67
Epoch 71/300 |loss: 0.002231| train set 3.201x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 68
Epoch 72/300 |loss: 0.002424| train set 3.362x speedup, test set 0.922x speedup, val set 0.920x speedup, step: 69
Epoch 73/300 |loss: 0.002303| train set 3.241x speedup, test set 0.922x speedup, val set 0.919x speedup, step: 70
early stopping at epoch 73
Training per epoch cost 1.352 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 45, train speedup 3.366, test speedup 0.952, val speedup 0.891
best test speedup epoch: 2, train speedup 0.693, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.024, test speedup 6.351, val speedup 1.339
last model at epoch 73, train speedup 3.241, test speedup 0.922, val speedup 0.919
execution cost 0:02:28.495521
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.750570, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023063| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020843| train set 0.871x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019141| train set 1.024x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016673| train set 0.955x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017247| train set 0.937x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.015009| train set 1.033x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.013873| train set 0.991x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013157| train set 0.749x speedup, test set 0.969x speedup, val set 0.832x speedup, step: 6
Epoch 10/300 |loss: 0.013673| train set 2.235x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 7
Epoch 11/300 |loss: 0.013038| train set 2.260x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011058| train set 1.859x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010835| train set 2.405x speedup, test set 0.969x speedup, val set 0.865x speedup, step: 10
Epoch 14/300 |loss: 0.009954| train set 2.768x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.009444| train set 3.094x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009369| train set 2.606x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 13
Epoch 17/300 |loss: 0.009009| train set 1.738x speedup, test set 0.969x speedup, val set 0.840x speedup, step: 14
Epoch 18/300 |loss: 0.008715| train set 3.116x speedup, test set 0.969x speedup, val set 0.843x speedup, step: 15
Epoch 19/300 |loss: 0.007714| train set 3.122x speedup, test set 0.969x speedup, val set 0.839x speedup, step: 16
Epoch 20/300 |loss: 0.007639| train set 2.487x speedup, test set 0.958x speedup, val set 0.840x speedup, step: 17
Epoch 21/300 |loss: 0.006877| train set 2.741x speedup, test set 0.958x speedup, val set 0.836x speedup, step: 18
Epoch 22/300 |loss: 0.006262| train set 2.986x speedup, test set 0.969x speedup, val set 1.107x speedup, step: 19
Epoch 23/300 |loss: 0.005619| train set 3.155x speedup, test set 0.969x speedup, val set 0.840x speedup, step: 20
Epoch 24/300 |loss: 0.006750| train set 3.191x speedup, test set 0.969x speedup, val set 0.905x speedup, step: 21
Epoch 25/300 |loss: 0.008143| train set 2.605x speedup, test set 0.969x speedup, val set 0.866x speedup, step: 22
Epoch 26/300 |loss: 0.006165| train set 2.953x speedup, test set 0.969x speedup, val set 0.817x speedup, step: 23
Epoch 27/300 |loss: 0.005452| train set 2.765x speedup, test set 0.969x speedup, val set 1.110x speedup, step: 24
Epoch 28/300 |loss: 0.005066| train set 3.285x speedup, test set 0.938x speedup, val set 0.932x speedup, step: 25
Epoch 29/300 |loss: 0.004903| train set 3.216x speedup, test set 0.938x speedup, val set 0.906x speedup, step: 26
Epoch 30/300 |loss: 0.004453| train set 3.278x speedup, test set 0.938x speedup, val set 0.908x speedup, step: 27
Epoch 31/300 |loss: 0.004848| train set 3.080x speedup, test set 0.938x speedup, val set 0.802x speedup, step: 28
Epoch 32/300 |loss: 0.004374| train set 3.063x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 29
Epoch 33/300 |loss: 0.004030| train set 3.235x speedup, test set 0.938x speedup, val set 0.909x speedup, step: 30
Epoch 34/300 |loss: 0.003691| train set 2.975x speedup, test set 0.938x speedup, val set 0.909x speedup, step: 31
Epoch 35/300 |loss: 0.004251| train set 3.226x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 32
Epoch 36/300 |loss: 0.003312| train set 3.263x speedup, test set 0.938x speedup, val set 0.893x speedup, step: 33
Epoch 37/300 |loss: 0.003499| train set 3.185x speedup, test set 0.938x speedup, val set 0.908x speedup, step: 34
Epoch 38/300 |loss: 0.004621| train set 3.345x speedup, test set 0.938x speedup, val set 0.893x speedup, step: 35
Epoch 39/300 |loss: 0.003739| train set 3.247x speedup, test set 0.938x speedup, val set 0.836x speedup, step: 36
Epoch 40/300 |loss: 0.003507| train set 3.262x speedup, test set 0.938x speedup, val set 0.808x speedup, step: 37
Epoch 41/300 |loss: 0.003048| train set 3.108x speedup, test set 0.938x speedup, val set 0.810x speedup, step: 38
Epoch 42/300 |loss: 0.003474| train set 3.157x speedup, test set 0.938x speedup, val set 0.752x speedup, step: 39
Epoch 43/300 |loss: 0.003532| train set 3.305x speedup, test set 0.938x speedup, val set 0.908x speedup, step: 40
Epoch 44/300 |loss: 0.003071| train set 3.240x speedup, test set 0.938x speedup, val set 0.824x speedup, step: 41
Epoch 45/300 |loss: 0.002710| train set 3.327x speedup, test set 0.942x speedup, val set 0.890x speedup, step: 42
Epoch 46/300 |loss: 0.002615| train set 3.334x speedup, test set 0.938x speedup, val set 0.792x speedup, step: 43
Epoch 47/300 |loss: 0.002709| train set 3.217x speedup, test set 0.938x speedup, val set 0.825x speedup, step: 44
Epoch 48/300 |loss: 0.002746| train set 3.203x speedup, test set 0.942x speedup, val set 0.823x speedup, step: 45
Epoch 49/300 |loss: 0.002345| train set 3.245x speedup, test set 0.938x speedup, val set 0.792x speedup, step: 46
Epoch 50/300 |loss: 0.002887| train set 3.179x speedup, test set 0.942x speedup, val set 0.813x speedup, step: 47
Epoch 51/300 |loss: 0.002998| train set 3.178x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 48
Epoch 52/300 |loss: 0.002718| train set 3.021x speedup, test set 0.938x speedup, val set 0.870x speedup, step: 49
Epoch 53/300 |loss: 0.002525| train set 3.300x speedup, test set 0.938x speedup, val set 0.862x speedup, step: 50
Epoch 54/300 |loss: 0.002514| train set 3.112x speedup, test set 0.938x speedup, val set 0.869x speedup, step: 51
Epoch 55/300 |loss: 0.002679| train set 3.361x speedup, test set 0.938x speedup, val set 0.810x speedup, step: 52
Epoch 56/300 |loss: 0.002677| train set 3.264x speedup, test set 0.938x speedup, val set 0.792x speedup, step: 53
Epoch 57/300 |loss: 0.002403| train set 3.357x speedup, test set 0.938x speedup, val set 0.786x speedup, step: 54
Epoch 58/300 |loss: 0.002223| train set 3.287x speedup, test set 0.938x speedup, val set 0.810x speedup, step: 55
Epoch 59/300 |loss: 0.002253| train set 3.371x speedup, test set 0.938x speedup, val set 0.812x speedup, step: 56
Epoch 60/300 |loss: 0.002056| train set 3.368x speedup, test set 0.938x speedup, val set 0.868x speedup, step: 57
Epoch 61/300 |loss: 0.002341| train set 3.257x speedup, test set 0.938x speedup, val set 0.808x speedup, step: 58
Epoch 62/300 |loss: 0.002182| train set 3.362x speedup, test set 0.938x speedup, val set 0.887x speedup, step: 59
Epoch 63/300 |loss: 0.002286| train set 3.310x speedup, test set 0.938x speedup, val set 0.869x speedup, step: 60
Epoch 64/300 |loss: 0.002173| train set 3.277x speedup, test set 0.938x speedup, val set 0.811x speedup, step: 61
Epoch 65/300 |loss: 0.001922| train set 3.254x speedup, test set 0.938x speedup, val set 0.792x speedup, step: 62
Epoch 66/300 |loss: 0.001841| train set 3.307x speedup, test set 0.938x speedup, val set 0.809x speedup, step: 63
Epoch 67/300 |loss: 0.002554| train set 3.230x speedup, test set 0.938x speedup, val set 0.793x speedup, step: 64
Epoch 68/300 |loss: 0.002017| train set 3.332x speedup, test set 0.938x speedup, val set 0.867x speedup, step: 65
Epoch 69/300 |loss: 0.002012| train set 3.207x speedup, test set 0.938x speedup, val set 0.792x speedup, step: 66
Epoch 70/300 |loss: 0.002132| train set 3.323x speedup, test set 0.938x speedup, val set 0.812x speedup, step: 67
Epoch 71/300 |loss: 0.002135| train set 3.179x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 68
Epoch 72/300 |loss: 0.002104| train set 3.277x speedup, test set 0.938x speedup, val set 0.828x speedup, step: 69
Epoch 73/300 |loss: 0.002211| train set 3.283x speedup, test set 0.938x speedup, val set 0.892x speedup, step: 70
Epoch 74/300 |loss: 0.001902| train set 3.204x speedup, test set 0.938x speedup, val set 0.811x speedup, step: 71
Epoch 75/300 |loss: 0.001881| train set 3.300x speedup, test set 0.938x speedup, val set 0.810x speedup, step: 72
early stopping at epoch 75
Training per epoch cost 1.336 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 59, train speedup 3.371, test speedup 0.938, val speedup 0.812
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.024, test speedup 6.351, val speedup 1.396
last model at epoch 75, train speedup 3.300, test speedup 0.938, val speedup 0.810
execution cost 0:02:30.811208
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.751907, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023067| train set 0.693x speedup, test set 10.685x speedup, val set 0.431x speedup, step: 1
Epoch 3/300 |loss: 0.020871| train set 0.861x speedup, test set 0.855x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019268| train set 1.038x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016769| train set 0.971x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017274| train set 1.013x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014942| train set 1.021x speedup, test set 1.012x speedup, val set 0.861x speedup, step: 4
Epoch 8/300 |loss: 0.014081| train set 0.938x speedup, test set 0.994x speedup, val set 0.850x speedup, step: 5
Epoch 9/300 |loss: 0.013620| train set 0.730x speedup, test set 1.012x speedup, val set 0.859x speedup, step: 6
Epoch 10/300 |loss: 0.013375| train set 2.267x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 7
Epoch 11/300 |loss: 0.012430| train set 1.856x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011106| train set 1.851x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010806| train set 2.129x speedup, test set 0.969x speedup, val set 0.863x speedup, step: 10
Epoch 14/300 |loss: 0.010071| train set 2.712x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.009862| train set 3.134x speedup, test set 0.969x speedup, val set 0.858x speedup, step: 12
Epoch 16/300 |loss: 0.008884| train set 2.487x speedup, test set 0.969x speedup, val set 0.833x speedup, step: 13
Epoch 17/300 |loss: 0.010414| train set 1.750x speedup, test set 0.961x speedup, val set 0.845x speedup, step: 14
Epoch 18/300 |loss: 0.009869| train set 2.985x speedup, test set 0.958x speedup, val set 0.857x speedup, step: 15
Epoch 19/300 |loss: 0.008058| train set 2.870x speedup, test set 0.958x speedup, val set 0.843x speedup, step: 16
Epoch 20/300 |loss: 0.008608| train set 2.964x speedup, test set 0.958x speedup, val set 0.856x speedup, step: 17
Epoch 21/300 |loss: 0.007030| train set 2.713x speedup, test set 0.914x speedup, val set 0.843x speedup, step: 18
Epoch 22/300 |loss: 0.006542| train set 3.010x speedup, test set 0.958x speedup, val set 0.916x speedup, step: 19
Epoch 23/300 |loss: 0.006059| train set 3.184x speedup, test set 0.914x speedup, val set 0.916x speedup, step: 20
Epoch 24/300 |loss: 0.007308| train set 2.793x speedup, test set 0.952x speedup, val set 0.906x speedup, step: 21
Epoch 25/300 |loss: 0.007484| train set 2.682x speedup, test set 0.914x speedup, val set 0.842x speedup, step: 22
Epoch 26/300 |loss: 0.005978| train set 2.856x speedup, test set 0.914x speedup, val set 0.838x speedup, step: 23
Epoch 27/300 |loss: 0.005537| train set 2.968x speedup, test set 0.914x speedup, val set 0.916x speedup, step: 24
Epoch 28/300 |loss: 0.005030| train set 3.238x speedup, test set 0.952x speedup, val set 0.910x speedup, step: 25
Epoch 29/300 |loss: 0.004908| train set 3.105x speedup, test set 0.952x speedup, val set 0.890x speedup, step: 26
Epoch 30/300 |loss: 0.004947| train set 3.117x speedup, test set 1.014x speedup, val set 0.689x speedup, step: 27
Epoch 31/300 |loss: 0.004905| train set 2.977x speedup, test set 4.229x speedup, val set 0.645x speedup, step: 28
Epoch 32/300 |loss: 0.004568| train set 3.145x speedup, test set 0.922x speedup, val set 0.688x speedup, step: 29
Epoch 33/300 |loss: 0.004576| train set 3.213x speedup, test set 1.281x speedup, val set 0.838x speedup, step: 30
Epoch 34/300 |loss: 0.004530| train set 3.078x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 31
Epoch 35/300 |loss: 0.004541| train set 3.269x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 32
Epoch 36/300 |loss: 0.003385| train set 3.166x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 33
Epoch 37/300 |loss: 0.003428| train set 3.100x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 34
Epoch 38/300 |loss: 0.005754| train set 2.733x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 35
Epoch 39/300 |loss: 0.004136| train set 3.112x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 36
Epoch 40/300 |loss: 0.003909| train set 3.275x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 37
Epoch 41/300 |loss: 0.003011| train set 3.095x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 38
Epoch 42/300 |loss: 0.003404| train set 3.175x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 39
Epoch 43/300 |loss: 0.003512| train set 3.219x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 40
Epoch 44/300 |loss: 0.003162| train set 3.235x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 41
Epoch 45/300 |loss: 0.002699| train set 3.357x speedup, test set 0.922x speedup, val set 0.913x speedup, step: 42
Epoch 46/300 |loss: 0.002672| train set 3.239x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 43
Epoch 47/300 |loss: 0.002773| train set 3.168x speedup, test set 0.922x speedup, val set 0.740x speedup, step: 44
Epoch 48/300 |loss: 0.003062| train set 3.325x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 45
Epoch 49/300 |loss: 0.002568| train set 3.380x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 46
Epoch 50/300 |loss: 0.002756| train set 3.208x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 47
Epoch 51/300 |loss: 0.003290| train set 3.341x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 48
Epoch 52/300 |loss: 0.002714| train set 3.107x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 49
Epoch 53/300 |loss: 0.002482| train set 3.362x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 50
Epoch 54/300 |loss: 0.002534| train set 3.315x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 51
Epoch 55/300 |loss: 0.002866| train set 3.330x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 52
Epoch 56/300 |loss: 0.002668| train set 3.245x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 53
Epoch 57/300 |loss: 0.002642| train set 3.203x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 54
Epoch 58/300 |loss: 0.002446| train set 3.287x speedup, test set 0.922x speedup, val set 0.891x speedup, step: 55
Epoch 59/300 |loss: 0.002369| train set 3.345x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 56
Epoch 60/300 |loss: 0.002101| train set 3.346x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 57
Epoch 61/300 |loss: 0.002410| train set 3.154x speedup, test set 0.922x speedup, val set 0.866x speedup, step: 58
Epoch 62/300 |loss: 0.002152| train set 3.304x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 59
Epoch 63/300 |loss: 0.002144| train set 3.248x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 60
Epoch 64/300 |loss: 0.002115| train set 3.302x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 61
Epoch 65/300 |loss: 0.002095| train set 3.216x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 62
Epoch 66/300 |loss: 0.001948| train set 3.187x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 63
Epoch 67/300 |loss: 0.002540| train set 3.182x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 64
Epoch 68/300 |loss: 0.002146| train set 3.155x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 65
Epoch 69/300 |loss: 0.002102| train set 3.292x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 66
early stopping at epoch 69
Training per epoch cost 1.299 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 49, train speedup 3.380, test speedup 0.922, val speedup 0.890
best test speedup epoch: 2, train speedup 0.693, test speedup 10.685, val speedup 0.431
best validation speedup epoch: 4, train speedup 1.038, test speedup 6.351, val speedup 1.396
last model at epoch 69, train speedup 3.292, test speedup 0.922, val speedup 0.790
execution cost 0:02:14.947601
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.774769, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020854| train set 0.870x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019274| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016915| train set 1.010x speedup, test set 0.952x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017443| train set 1.009x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014830| train set 1.038x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014183| train set 0.995x speedup, test set 1.012x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013736| train set 0.732x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 6
Epoch 10/300 |loss: 0.013390| train set 2.195x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 7
Epoch 11/300 |loss: 0.012709| train set 1.951x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 8
Epoch 12/300 |loss: 0.011029| train set 1.882x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010699| train set 2.111x speedup, test set 0.969x speedup, val set 0.863x speedup, step: 10
Epoch 14/300 |loss: 0.010721| train set 2.354x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.009415| train set 3.143x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009071| train set 2.560x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 13
Epoch 17/300 |loss: 0.009694| train set 1.793x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 14
Epoch 18/300 |loss: 0.009728| train set 3.018x speedup, test set 0.958x speedup, val set 0.844x speedup, step: 15
Epoch 19/300 |loss: 0.008350| train set 3.028x speedup, test set 0.914x speedup, val set 0.843x speedup, step: 16
Epoch 20/300 |loss: 0.008626| train set 2.870x speedup, test set 0.914x speedup, val set 0.850x speedup, step: 17
Epoch 21/300 |loss: 0.007049| train set 2.550x speedup, test set 0.914x speedup, val set 0.846x speedup, step: 18
Epoch 22/300 |loss: 0.006560| train set 2.870x speedup, test set 0.969x speedup, val set 0.845x speedup, step: 19
Epoch 23/300 |loss: 0.006247| train set 3.112x speedup, test set 0.914x speedup, val set 0.846x speedup, step: 20
Epoch 24/300 |loss: 0.007413| train set 2.833x speedup, test set 0.952x speedup, val set 0.836x speedup, step: 21
Epoch 25/300 |loss: 0.007640| train set 2.938x speedup, test set 0.914x speedup, val set 0.844x speedup, step: 22
Epoch 26/300 |loss: 0.005906| train set 2.934x speedup, test set 0.914x speedup, val set 0.815x speedup, step: 23
Epoch 27/300 |loss: 0.005521| train set 2.987x speedup, test set 0.914x speedup, val set 0.910x speedup, step: 24
Epoch 28/300 |loss: 0.005157| train set 3.132x speedup, test set 0.952x speedup, val set 0.937x speedup, step: 25
Epoch 29/300 |loss: 0.004694| train set 3.233x speedup, test set 0.914x speedup, val set 0.839x speedup, step: 26
Epoch 30/300 |loss: 0.005071| train set 3.145x speedup, test set 0.914x speedup, val set 0.842x speedup, step: 27
Epoch 31/300 |loss: 0.004581| train set 2.830x speedup, test set 0.914x speedup, val set 0.822x speedup, step: 28
Epoch 32/300 |loss: 0.004688| train set 2.859x speedup, test set 0.914x speedup, val set 0.910x speedup, step: 29
Epoch 33/300 |loss: 0.005009| train set 3.215x speedup, test set 0.952x speedup, val set 0.839x speedup, step: 30
Epoch 34/300 |loss: 0.004594| train set 2.709x speedup, test set 0.952x speedup, val set 0.841x speedup, step: 31
Epoch 35/300 |loss: 0.004859| train set 3.144x speedup, test set 0.952x speedup, val set 0.912x speedup, step: 32
Epoch 36/300 |loss: 0.003586| train set 3.066x speedup, test set 0.952x speedup, val set 0.893x speedup, step: 33
Epoch 37/300 |loss: 0.003608| train set 2.791x speedup, test set 0.952x speedup, val set 0.827x speedup, step: 34
Epoch 38/300 |loss: 0.004784| train set 3.090x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 35
Epoch 39/300 |loss: 0.003878| train set 3.108x speedup, test set 0.952x speedup, val set 0.893x speedup, step: 36
Epoch 40/300 |loss: 0.003857| train set 3.263x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 37
Epoch 41/300 |loss: 0.003052| train set 3.099x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 38
Epoch 42/300 |loss: 0.003459| train set 3.198x speedup, test set 0.952x speedup, val set 0.646x speedup, step: 39
Epoch 43/300 |loss: 0.003887| train set 3.235x speedup, test set 0.952x speedup, val set 0.840x speedup, step: 40
Epoch 44/300 |loss: 0.003726| train set 3.286x speedup, test set 0.952x speedup, val set 0.648x speedup, step: 41
Epoch 45/300 |loss: 0.002950| train set 3.259x speedup, test set 0.952x speedup, val set 0.896x speedup, step: 42
Epoch 46/300 |loss: 0.002862| train set 3.248x speedup, test set 0.952x speedup, val set 0.647x speedup, step: 43
Epoch 47/300 |loss: 0.002882| train set 3.061x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 44
Epoch 48/300 |loss: 0.003110| train set 3.194x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 45
Epoch 49/300 |loss: 0.002646| train set 3.294x speedup, test set 0.952x speedup, val set 0.895x speedup, step: 46
Epoch 50/300 |loss: 0.003129| train set 3.343x speedup, test set 0.952x speedup, val set 0.688x speedup, step: 47
Epoch 51/300 |loss: 0.003348| train set 3.289x speedup, test set 0.952x speedup, val set 0.817x speedup, step: 48
Epoch 52/300 |loss: 0.002588| train set 3.307x speedup, test set 0.952x speedup, val set 0.896x speedup, step: 49
Epoch 53/300 |loss: 0.002430| train set 3.390x speedup, test set 0.952x speedup, val set 0.810x speedup, step: 50
Epoch 54/300 |loss: 0.002399| train set 3.219x speedup, test set 0.952x speedup, val set 0.800x speedup, step: 51
Epoch 55/300 |loss: 0.002624| train set 3.345x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 52
Epoch 56/300 |loss: 0.002753| train set 3.285x speedup, test set 0.952x speedup, val set 0.738x speedup, step: 53
Epoch 57/300 |loss: 0.002580| train set 3.319x speedup, test set 0.952x speedup, val set 0.755x speedup, step: 54
Epoch 58/300 |loss: 0.002394| train set 3.371x speedup, test set 0.952x speedup, val set 0.893x speedup, step: 55
Epoch 59/300 |loss: 0.002435| train set 3.283x speedup, test set 0.952x speedup, val set 0.825x speedup, step: 56
Epoch 60/300 |loss: 0.002165| train set 3.294x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 57
Epoch 61/300 |loss: 0.002276| train set 3.325x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 58
Epoch 62/300 |loss: 0.002385| train set 3.350x speedup, test set 0.952x speedup, val set 0.688x speedup, step: 59
Epoch 63/300 |loss: 0.002444| train set 3.222x speedup, test set 0.952x speedup, val set 0.804x speedup, step: 60
Epoch 64/300 |loss: 0.002208| train set 3.269x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 61
Epoch 65/300 |loss: 0.002185| train set 3.184x speedup, test set 0.952x speedup, val set 0.733x speedup, step: 62
Epoch 66/300 |loss: 0.002170| train set 3.275x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 63
Epoch 67/300 |loss: 0.002329| train set 3.338x speedup, test set 0.952x speedup, val set 0.831x speedup, step: 64
Epoch 68/300 |loss: 0.002121| train set 3.227x speedup, test set 0.952x speedup, val set 0.755x speedup, step: 65
Epoch 69/300 |loss: 0.002377| train set 3.258x speedup, test set 0.952x speedup, val set 0.801x speedup, step: 66
Epoch 70/300 |loss: 0.002188| train set 3.348x speedup, test set 0.952x speedup, val set 0.733x speedup, step: 67
Epoch 71/300 |loss: 0.001972| train set 3.239x speedup, test set 0.952x speedup, val set 0.755x speedup, step: 68
Epoch 72/300 |loss: 0.002163| train set 3.246x speedup, test set 0.922x speedup, val set 0.731x speedup, step: 69
Epoch 73/300 |loss: 0.002238| train set 3.282x speedup, test set 0.952x speedup, val set 0.734x speedup, step: 70
Epoch 74/300 |loss: 0.002070| train set 3.319x speedup, test set 0.952x speedup, val set 0.734x speedup, step: 71
Epoch 75/300 |loss: 0.002135| train set 3.167x speedup, test set 0.952x speedup, val set 0.732x speedup, step: 72
Epoch 76/300 |loss: 0.001998| train set 3.337x speedup, test set 0.922x speedup, val set 0.754x speedup, step: 73
Epoch 77/300 |loss: 0.001917| train set 3.246x speedup, test set 0.922x speedup, val set 0.830x speedup, step: 74
Epoch 78/300 |loss: 0.001972| train set 3.181x speedup, test set 0.952x speedup, val set 0.825x speedup, step: 75
Epoch 79/300 |loss: 0.001896| train set 3.316x speedup, test set 0.922x speedup, val set 0.801x speedup, step: 76
Epoch 80/300 |loss: 0.002042| train set 3.271x speedup, test set 0.922x speedup, val set 0.732x speedup, step: 77
Epoch 81/300 |loss: 0.001986| train set 3.280x speedup, test set 0.952x speedup, val set 0.799x speedup, step: 78
Epoch 82/300 |loss: 0.001955| train set 3.299x speedup, test set 0.922x speedup, val set 0.733x speedup, step: 79
Epoch 83/300 |loss: 0.002190| train set 3.231x speedup, test set 0.952x speedup, val set 0.800x speedup, step: 80
Epoch 84/300 |loss: 0.002003| train set 3.293x speedup, test set 0.952x speedup, val set 0.825x speedup, step: 81
Epoch 85/300 |loss: 0.001713| train set 3.374x speedup, test set 0.922x speedup, val set 0.733x speedup, step: 82
Epoch 86/300 |loss: 0.001874| train set 3.309x speedup, test set 0.922x speedup, val set 0.800x speedup, step: 83
Epoch 87/300 |loss: 0.001786| train set 3.349x speedup, test set 0.922x speedup, val set 0.735x speedup, step: 84
Epoch 88/300 |loss: 0.002388| train set 3.252x speedup, test set 0.922x speedup, val set 0.755x speedup, step: 85
Epoch 89/300 |loss: 0.001970| train set 3.297x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 86
Epoch 90/300 |loss: 0.001860| train set 3.240x speedup, test set 0.922x speedup, val set 0.734x speedup, step: 87
Epoch 91/300 |loss: 0.002086| train set 3.301x speedup, test set 0.922x speedup, val set 0.733x speedup, step: 88
Epoch 92/300 |loss: 0.001989| train set 3.341x speedup, test set 0.922x speedup, val set 0.734x speedup, step: 89
Epoch 93/300 |loss: 0.001827| train set 3.225x speedup, test set 0.922x speedup, val set 0.733x speedup, step: 90
Epoch 94/300 |loss: 0.001787| train set 3.330x speedup, test set 0.922x speedup, val set 0.801x speedup, step: 91
early stopping at epoch 94
Training per epoch cost 1.310 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 53, train speedup 3.390, test speedup 0.952, val speedup 0.810
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 94, train speedup 3.330, test speedup 0.922, val speedup 0.801
execution cost 0:03:01.503846
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.754875, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023063| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020843| train set 0.871x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019141| train set 1.024x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016673| train set 0.955x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017247| train set 0.937x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.015009| train set 1.033x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.013873| train set 0.991x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013153| train set 0.749x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 6
Epoch 10/300 |loss: 0.013632| train set 2.342x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 7
Epoch 11/300 |loss: 0.012874| train set 2.091x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011026| train set 1.764x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010566| train set 2.467x speedup, test set 0.969x speedup, val set 0.865x speedup, step: 10
Epoch 14/300 |loss: 0.009990| train set 2.727x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.009603| train set 3.019x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009505| train set 2.422x speedup, test set 0.969x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.008963| train set 1.728x speedup, test set 0.945x speedup, val set 0.860x speedup, step: 14
Epoch 18/300 |loss: 0.008804| train set 3.118x speedup, test set 0.969x speedup, val set 0.844x speedup, step: 15
Epoch 19/300 |loss: 0.007807| train set 3.165x speedup, test set 0.958x speedup, val set 0.843x speedup, step: 16
Epoch 20/300 |loss: 0.007474| train set 2.550x speedup, test set 0.958x speedup, val set 0.860x speedup, step: 17
Epoch 21/300 |loss: 0.006948| train set 2.683x speedup, test set 0.958x speedup, val set 0.836x speedup, step: 18
Epoch 22/300 |loss: 0.006552| train set 2.955x speedup, test set 0.969x speedup, val set 0.910x speedup, step: 19
Epoch 23/300 |loss: 0.005826| train set 3.248x speedup, test set 0.969x speedup, val set 0.841x speedup, step: 20
Epoch 24/300 |loss: 0.006562| train set 2.734x speedup, test set 0.969x speedup, val set 0.883x speedup, step: 21
Epoch 25/300 |loss: 0.007476| train set 2.675x speedup, test set 0.914x speedup, val set 0.838x speedup, step: 22
Epoch 26/300 |loss: 0.005757| train set 2.908x speedup, test set 0.969x speedup, val set 0.823x speedup, step: 23
Epoch 27/300 |loss: 0.005854| train set 2.737x speedup, test set 0.969x speedup, val set 0.909x speedup, step: 24
Epoch 28/300 |loss: 0.005925| train set 2.868x speedup, test set 0.969x speedup, val set 0.935x speedup, step: 25
Epoch 29/300 |loss: 0.004846| train set 3.241x speedup, test set 0.969x speedup, val set 0.910x speedup, step: 26
Epoch 30/300 |loss: 0.005541| train set 3.061x speedup, test set 0.969x speedup, val set 0.838x speedup, step: 27
Epoch 31/300 |loss: 0.004663| train set 2.880x speedup, test set 0.969x speedup, val set 0.801x speedup, step: 28
Epoch 32/300 |loss: 0.004397| train set 3.217x speedup, test set 0.969x speedup, val set 0.908x speedup, step: 29
Epoch 33/300 |loss: 0.005153| train set 3.164x speedup, test set 0.969x speedup, val set 0.909x speedup, step: 30
Epoch 34/300 |loss: 0.004110| train set 3.202x speedup, test set 0.969x speedup, val set 0.840x speedup, step: 31
Epoch 35/300 |loss: 0.004145| train set 3.138x speedup, test set 0.952x speedup, val set 0.892x speedup, step: 32
Epoch 36/300 |loss: 0.003370| train set 3.188x speedup, test set 0.969x speedup, val set 0.824x speedup, step: 33
Epoch 37/300 |loss: 0.003347| train set 3.138x speedup, test set 0.922x speedup, val set 0.886x speedup, step: 34
Epoch 38/300 |loss: 0.004726| train set 2.817x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 35
Epoch 39/300 |loss: 0.004088| train set 3.125x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 36
Epoch 40/300 |loss: 0.003696| train set 3.217x speedup, test set 0.922x speedup, val set 0.889x speedup, step: 37
Epoch 41/300 |loss: 0.003120| train set 3.176x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 38
Epoch 42/300 |loss: 0.003503| train set 3.116x speedup, test set 0.938x speedup, val set 0.823x speedup, step: 39
Epoch 43/300 |loss: 0.003633| train set 3.268x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 40
Epoch 44/300 |loss: 0.003409| train set 3.229x speedup, test set 0.922x speedup, val set 0.825x speedup, step: 41
Epoch 45/300 |loss: 0.002646| train set 3.280x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 42
Epoch 46/300 |loss: 0.002650| train set 3.247x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 43
Epoch 47/300 |loss: 0.003045| train set 3.153x speedup, test set 0.922x speedup, val set 0.754x speedup, step: 44
Epoch 48/300 |loss: 0.002984| train set 3.197x speedup, test set 0.922x speedup, val set 0.803x speedup, step: 45
Epoch 49/300 |loss: 0.002446| train set 3.187x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 46
Epoch 50/300 |loss: 0.002822| train set 3.259x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 47
Epoch 51/300 |loss: 0.003088| train set 3.296x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 48
Epoch 52/300 |loss: 0.002552| train set 3.269x speedup, test set 0.922x speedup, val set 0.813x speedup, step: 49
Epoch 53/300 |loss: 0.002495| train set 3.339x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 50
Epoch 54/300 |loss: 0.002622| train set 3.175x speedup, test set 0.938x speedup, val set 0.790x speedup, step: 51
Epoch 55/300 |loss: 0.002581| train set 3.296x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 52
Epoch 56/300 |loss: 0.002609| train set 3.266x speedup, test set 0.922x speedup, val set 0.793x speedup, step: 53
Epoch 57/300 |loss: 0.002331| train set 3.189x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 54
Epoch 58/300 |loss: 0.002290| train set 3.344x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 55
Epoch 59/300 |loss: 0.002272| train set 3.306x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 56
Epoch 60/300 |loss: 0.002063| train set 3.386x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 57
Epoch 61/300 |loss: 0.002390| train set 3.361x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 58
Epoch 62/300 |loss: 0.002317| train set 3.320x speedup, test set 0.922x speedup, val set 0.867x speedup, step: 59
Epoch 63/300 |loss: 0.002249| train set 3.311x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 60
Epoch 64/300 |loss: 0.002149| train set 3.321x speedup, test set 0.922x speedup, val set 0.868x speedup, step: 61
Epoch 65/300 |loss: 0.002028| train set 3.292x speedup, test set 0.922x speedup, val set 0.779x speedup, step: 62
Epoch 66/300 |loss: 0.001987| train set 3.308x speedup, test set 0.922x speedup, val set 0.732x speedup, step: 63
Epoch 67/300 |loss: 0.002865| train set 3.217x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 64
Epoch 68/300 |loss: 0.002187| train set 3.309x speedup, test set 0.922x speedup, val set 0.779x speedup, step: 65
Epoch 69/300 |loss: 0.002010| train set 3.201x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 66
Epoch 70/300 |loss: 0.002186| train set 3.361x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 67
Epoch 71/300 |loss: 0.002219| train set 3.271x speedup, test set 0.922x speedup, val set 0.793x speedup, step: 68
Epoch 72/300 |loss: 0.002408| train set 3.412x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 69
Epoch 73/300 |loss: 0.002406| train set 3.309x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 70
early stopping at epoch 73
Training per epoch cost 1.301 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 72, train speedup 3.412, test speedup 0.922, val speedup 0.792
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.024, test speedup 6.351, val speedup 1.396
last model at epoch 73, train speedup 3.309, test speedup 0.922, val speedup 0.792
execution cost 0:02:22.443103
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.766327, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019301| train set 1.048x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016908| train set 0.974x speedup, test set 0.969x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017512| train set 1.917x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.015004| train set 1.006x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.013977| train set 0.974x speedup, test set 0.994x speedup, val set 0.847x speedup, step: 5
Epoch 9/300 |loss: 0.013163| train set 0.733x speedup, test set 1.012x speedup, val set 0.833x speedup, step: 6
Epoch 10/300 |loss: 0.013867| train set 2.229x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 7
Epoch 11/300 |loss: 0.013104| train set 2.188x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 8
Epoch 12/300 |loss: 0.011290| train set 1.852x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010314| train set 2.289x speedup, test set 0.969x speedup, val set 0.864x speedup, step: 10
Epoch 14/300 |loss: 0.010591| train set 2.738x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009425| train set 3.167x speedup, test set 0.958x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009076| train set 2.576x speedup, test set 0.919x speedup, val set 0.838x speedup, step: 13
Epoch 17/300 |loss: 0.008883| train set 1.731x speedup, test set 1.000x speedup, val set 0.861x speedup, step: 14
Epoch 18/300 |loss: 0.008815| train set 3.089x speedup, test set 0.952x speedup, val set 0.838x speedup, step: 15
Epoch 19/300 |loss: 0.007706| train set 3.219x speedup, test set 0.958x speedup, val set 0.857x speedup, step: 16
Epoch 20/300 |loss: 0.007769| train set 2.569x speedup, test set 0.914x speedup, val set 0.859x speedup, step: 17
Epoch 21/300 |loss: 0.006692| train set 3.063x speedup, test set 0.919x speedup, val set 0.846x speedup, step: 18
Epoch 22/300 |loss: 0.006336| train set 3.048x speedup, test set 0.914x speedup, val set 0.844x speedup, step: 19
Epoch 23/300 |loss: 0.005727| train set 3.131x speedup, test set 0.914x speedup, val set 0.839x speedup, step: 20
Epoch 24/300 |loss: 0.006854| train set 2.702x speedup, test set 0.958x speedup, val set 0.815x speedup, step: 21
Epoch 25/300 |loss: 0.006238| train set 2.823x speedup, test set 0.914x speedup, val set 0.647x speedup, step: 22
Epoch 26/300 |loss: 0.005225| train set 2.591x speedup, test set 0.886x speedup, val set 0.840x speedup, step: 23
Epoch 27/300 |loss: 0.005469| train set 2.778x speedup, test set 0.914x speedup, val set 0.839x speedup, step: 24
Epoch 28/300 |loss: 0.004743| train set 3.012x speedup, test set 0.943x speedup, val set 0.840x speedup, step: 25
Epoch 29/300 |loss: 0.004778| train set 3.163x speedup, test set 0.891x speedup, val set 0.842x speedup, step: 26
Epoch 30/300 |loss: 0.004671| train set 3.136x speedup, test set 0.938x speedup, val set 0.841x speedup, step: 27
Epoch 31/300 |loss: 0.004546| train set 2.874x speedup, test set 0.886x speedup, val set 0.838x speedup, step: 28
Epoch 32/300 |loss: 0.004514| train set 3.149x speedup, test set 0.938x speedup, val set 0.840x speedup, step: 29
Epoch 33/300 |loss: 0.004675| train set 3.198x speedup, test set 0.927x speedup, val set 0.841x speedup, step: 30
Epoch 34/300 |loss: 0.003944| train set 3.159x speedup, test set 0.938x speedup, val set 0.846x speedup, step: 31
Epoch 35/300 |loss: 0.003790| train set 3.153x speedup, test set 0.886x speedup, val set 0.840x speedup, step: 32
Epoch 36/300 |loss: 0.003575| train set 3.164x speedup, test set 0.922x speedup, val set 0.825x speedup, step: 33
Epoch 37/300 |loss: 0.003500| train set 2.740x speedup, test set 0.922x speedup, val set 0.841x speedup, step: 34
Epoch 38/300 |loss: 0.004212| train set 3.224x speedup, test set 0.922x speedup, val set 0.837x speedup, step: 35
Epoch 39/300 |loss: 0.004042| train set 3.251x speedup, test set 0.922x speedup, val set 0.826x speedup, step: 36
Epoch 40/300 |loss: 0.004228| train set 3.205x speedup, test set 0.922x speedup, val set 0.837x speedup, step: 37
Epoch 41/300 |loss: 0.002915| train set 3.065x speedup, test set 0.938x speedup, val set 0.825x speedup, step: 38
Epoch 42/300 |loss: 0.003124| train set 3.231x speedup, test set 0.922x speedup, val set 0.838x speedup, step: 39
Epoch 43/300 |loss: 0.003254| train set 3.228x speedup, test set 0.922x speedup, val set 0.838x speedup, step: 40
Epoch 44/300 |loss: 0.003242| train set 3.309x speedup, test set 0.922x speedup, val set 0.825x speedup, step: 41
Epoch 45/300 |loss: 0.002523| train set 3.282x speedup, test set 0.922x speedup, val set 0.896x speedup, step: 42
Epoch 46/300 |loss: 0.002925| train set 3.207x speedup, test set 0.938x speedup, val set 0.838x speedup, step: 43
Epoch 47/300 |loss: 0.002888| train set 3.235x speedup, test set 0.938x speedup, val set 0.826x speedup, step: 44
Epoch 48/300 |loss: 0.002783| train set 3.249x speedup, test set 0.886x speedup, val set 0.838x speedup, step: 45
Epoch 49/300 |loss: 0.002461| train set 3.284x speedup, test set 0.938x speedup, val set 0.825x speedup, step: 46
Epoch 50/300 |loss: 0.002456| train set 3.274x speedup, test set 0.922x speedup, val set 0.837x speedup, step: 47
Epoch 51/300 |loss: 0.003023| train set 3.200x speedup, test set 0.922x speedup, val set 0.824x speedup, step: 48
Epoch 52/300 |loss: 0.002644| train set 3.221x speedup, test set 0.938x speedup, val set 0.840x speedup, step: 49
Epoch 53/300 |loss: 0.002364| train set 3.306x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 50
Epoch 54/300 |loss: 0.002319| train set 3.200x speedup, test set 0.922x speedup, val set 0.824x speedup, step: 51
Epoch 55/300 |loss: 0.002389| train set 3.286x speedup, test set 0.938x speedup, val set 0.823x speedup, step: 52
Epoch 56/300 |loss: 0.002362| train set 3.244x speedup, test set 0.938x speedup, val set 0.754x speedup, step: 53
Epoch 57/300 |loss: 0.002130| train set 3.135x speedup, test set 0.938x speedup, val set 0.755x speedup, step: 54
Epoch 58/300 |loss: 0.002113| train set 3.335x speedup, test set 0.938x speedup, val set 0.894x speedup, step: 55
Epoch 59/300 |loss: 0.002177| train set 3.323x speedup, test set 0.922x speedup, val set 0.825x speedup, step: 56
Epoch 60/300 |loss: 0.001969| train set 3.201x speedup, test set 0.938x speedup, val set 0.824x speedup, step: 57
Epoch 61/300 |loss: 0.002093| train set 3.276x speedup, test set 0.922x speedup, val set 0.826x speedup, step: 58
Epoch 62/300 |loss: 0.002152| train set 3.206x speedup, test set 1.004x speedup, val set 0.835x speedup, step: 59
Epoch 63/300 |loss: 0.002001| train set 3.315x speedup, test set 0.922x speedup, val set 0.825x speedup, step: 60
Epoch 64/300 |loss: 0.002012| train set 3.284x speedup, test set 0.922x speedup, val set 0.825x speedup, step: 61
Epoch 65/300 |loss: 0.001993| train set 3.210x speedup, test set 0.922x speedup, val set 0.824x speedup, step: 62
Epoch 66/300 |loss: 0.001834| train set 3.280x speedup, test set 0.938x speedup, val set 0.824x speedup, step: 63
Epoch 67/300 |loss: 0.002155| train set 3.262x speedup, test set 0.938x speedup, val set 0.826x speedup, step: 64
Epoch 68/300 |loss: 0.001838| train set 3.344x speedup, test set 0.938x speedup, val set 0.824x speedup, step: 65
Epoch 69/300 |loss: 0.001912| train set 3.320x speedup, test set 0.987x speedup, val set 0.822x speedup, step: 66
Epoch 70/300 |loss: 0.002128| train set 3.361x speedup, test set 0.938x speedup, val set 0.825x speedup, step: 67
Epoch 71/300 |loss: 0.002377| train set 3.184x speedup, test set 0.922x speedup, val set 0.845x speedup, step: 68
Epoch 72/300 |loss: 0.002086| train set 3.352x speedup, test set 5.218x speedup, val set 0.826x speedup, step: 69
early stopping at epoch 72
Training per epoch cost 1.305 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 70, train speedup 3.361, test speedup 0.938, val speedup 0.825
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.048, test speedup 6.351, val speedup 1.339
last model at epoch 72, train speedup 3.352, test speedup 5.218, val speedup 0.826
execution cost 0:02:20.642412
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.754390, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023063| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020843| train set 0.871x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019143| train set 1.025x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016740| train set 0.955x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017464| train set 1.003x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014929| train set 1.019x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.013867| train set 1.015x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013326| train set 0.730x speedup, test set 1.012x speedup, val set 0.832x speedup, step: 6
Epoch 10/300 |loss: 0.013669| train set 1.062x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 7
Epoch 11/300 |loss: 0.012851| train set 2.000x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011255| train set 1.772x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010534| train set 2.213x speedup, test set 0.969x speedup, val set 0.863x speedup, step: 10
Epoch 14/300 |loss: 0.010988| train set 2.558x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009639| train set 3.007x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009578| train set 2.321x speedup, test set 0.958x speedup, val set 0.850x speedup, step: 13
Epoch 17/300 |loss: 0.008964| train set 1.691x speedup, test set 0.958x speedup, val set 0.852x speedup, step: 14
Epoch 18/300 |loss: 0.009464| train set 2.969x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 15
Epoch 19/300 |loss: 0.008251| train set 2.848x speedup, test set 0.958x speedup, val set 0.832x speedup, step: 16
Epoch 20/300 |loss: 0.008500| train set 3.030x speedup, test set 0.958x speedup, val set 0.852x speedup, step: 17
Epoch 21/300 |loss: 0.007438| train set 2.923x speedup, test set 0.958x speedup, val set 0.842x speedup, step: 18
Epoch 22/300 |loss: 0.006703| train set 2.896x speedup, test set 0.969x speedup, val set 0.846x speedup, step: 19
Epoch 23/300 |loss: 0.005879| train set 3.067x speedup, test set 0.958x speedup, val set 0.837x speedup, step: 20
Epoch 24/300 |loss: 0.006915| train set 2.822x speedup, test set 0.914x speedup, val set 0.839x speedup, step: 21
Epoch 25/300 |loss: 0.006308| train set 2.657x speedup, test set 0.914x speedup, val set 0.822x speedup, step: 22
Epoch 26/300 |loss: 0.005595| train set 2.438x speedup, test set 0.886x speedup, val set 0.823x speedup, step: 23
Epoch 27/300 |loss: 0.005310| train set 2.467x speedup, test set 0.886x speedup, val set 0.909x speedup, step: 24
Epoch 28/300 |loss: 0.005300| train set 3.077x speedup, test set 0.922x speedup, val set 0.922x speedup, step: 25
Epoch 29/300 |loss: 0.005306| train set 3.189x speedup, test set 0.927x speedup, val set 0.888x speedup, step: 26
Epoch 30/300 |loss: 0.005355| train set 2.884x speedup, test set 0.927x speedup, val set 0.839x speedup, step: 27
Epoch 31/300 |loss: 0.004414| train set 2.842x speedup, test set 0.886x speedup, val set 0.822x speedup, step: 28
Epoch 32/300 |loss: 0.004156| train set 3.046x speedup, test set 0.927x speedup, val set 0.907x speedup, step: 29
Epoch 33/300 |loss: 0.004917| train set 3.153x speedup, test set 0.927x speedup, val set 0.906x speedup, step: 30
Epoch 34/300 |loss: 0.004012| train set 3.024x speedup, test set 0.927x speedup, val set 0.847x speedup, step: 31
Epoch 35/300 |loss: 0.003931| train set 3.029x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 32
Epoch 36/300 |loss: 0.003419| train set 3.057x speedup, test set 0.922x speedup, val set 0.931x speedup, step: 33
Epoch 37/300 |loss: 0.003305| train set 3.074x speedup, test set 0.922x speedup, val set 0.839x speedup, step: 34
Epoch 38/300 |loss: 0.004474| train set 2.857x speedup, test set 0.922x speedup, val set 0.844x speedup, step: 35
Epoch 39/300 |loss: 0.004220| train set 3.105x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 36
Epoch 40/300 |loss: 0.003940| train set 3.205x speedup, test set 0.922x speedup, val set 0.917x speedup, step: 37
Epoch 41/300 |loss: 0.002868| train set 3.054x speedup, test set 0.922x speedup, val set 0.844x speedup, step: 38
Epoch 42/300 |loss: 0.003236| train set 3.168x speedup, test set 0.922x speedup, val set 0.755x speedup, step: 39
Epoch 43/300 |loss: 0.003431| train set 3.257x speedup, test set 0.922x speedup, val set 0.915x speedup, step: 40
Epoch 44/300 |loss: 0.003059| train set 3.229x speedup, test set 0.922x speedup, val set 0.754x speedup, step: 41
Epoch 45/300 |loss: 0.002599| train set 3.312x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 42
Epoch 46/300 |loss: 0.002740| train set 3.272x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 43
Epoch 47/300 |loss: 0.002905| train set 2.867x speedup, test set 0.922x speedup, val set 0.646x speedup, step: 44
Epoch 48/300 |loss: 0.002978| train set 3.214x speedup, test set 0.922x speedup, val set 0.823x speedup, step: 45
Epoch 49/300 |loss: 0.002537| train set 3.301x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 46
Epoch 50/300 |loss: 0.002627| train set 3.261x speedup, test set 0.922x speedup, val set 0.907x speedup, step: 47
Epoch 51/300 |loss: 0.003016| train set 3.145x speedup, test set 0.922x speedup, val set 0.905x speedup, step: 48
Epoch 52/300 |loss: 0.002828| train set 2.930x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 49
Epoch 53/300 |loss: 0.002573| train set 3.267x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 50
Epoch 54/300 |loss: 0.002791| train set 3.239x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 51
Epoch 55/300 |loss: 0.002751| train set 3.334x speedup, test set 0.922x speedup, val set 0.687x speedup, step: 52
early stopping at epoch 55
Training per epoch cost 1.311 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 55, train speedup 3.334, test speedup 0.922, val speedup 0.687
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.025, test speedup 6.351, val speedup 1.396
last model at epoch 55, train speedup 3.334, test speedup 0.922, val speedup 0.687
execution cost 0:01:50.449742
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.746208, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020854| train set 0.870x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019274| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016915| train set 1.010x speedup, test set 0.952x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017419| train set 1.013x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014847| train set 1.043x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014113| train set 0.979x speedup, test set 0.952x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013389| train set 1.018x speedup, test set 0.969x speedup, val set 0.832x speedup, step: 6
Epoch 10/300 |loss: 0.013376| train set 2.213x speedup, test set 0.969x speedup, val set 0.853x speedup, step: 7
Epoch 11/300 |loss: 0.013072| train set 1.893x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.011119| train set 1.853x speedup, test set 0.969x speedup, val set 0.859x speedup, step: 9
Epoch 13/300 |loss: 0.010526| train set 2.211x speedup, test set 0.969x speedup, val set 0.864x speedup, step: 10
Epoch 14/300 |loss: 0.010231| train set 2.352x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009685| train set 2.836x speedup, test set 0.958x speedup, val set 0.858x speedup, step: 12
Epoch 16/300 |loss: 0.009262| train set 2.303x speedup, test set 0.958x speedup, val set 0.836x speedup, step: 13
Epoch 17/300 |loss: 0.009195| train set 1.687x speedup, test set 0.958x speedup, val set 0.840x speedup, step: 14
Epoch 18/300 |loss: 0.008896| train set 2.966x speedup, test set 0.969x speedup, val set 0.840x speedup, step: 15
Epoch 19/300 |loss: 0.008095| train set 2.890x speedup, test set 0.969x speedup, val set 0.844x speedup, step: 16
Epoch 20/300 |loss: 0.007730| train set 2.190x speedup, test set 0.958x speedup, val set 0.838x speedup, step: 17
Epoch 21/300 |loss: 0.007707| train set 2.584x speedup, test set 0.957x speedup, val set 0.840x speedup, step: 18
Epoch 22/300 |loss: 0.006792| train set 2.775x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 19
Epoch 23/300 |loss: 0.005891| train set 3.011x speedup, test set 0.969x speedup, val set 0.837x speedup, step: 20
Epoch 24/300 |loss: 0.006920| train set 2.807x speedup, test set 0.914x speedup, val set 0.818x speedup, step: 21
Epoch 25/300 |loss: 0.006504| train set 2.773x speedup, test set 0.952x speedup, val set 0.837x speedup, step: 22
Epoch 26/300 |loss: 0.005857| train set 3.080x speedup, test set 0.922x speedup, val set 0.838x speedup, step: 23
Epoch 27/300 |loss: 0.005598| train set 2.726x speedup, test set 0.914x speedup, val set 0.909x speedup, step: 24
Epoch 28/300 |loss: 0.005362| train set 3.213x speedup, test set 0.922x speedup, val set 0.927x speedup, step: 25
Epoch 29/300 |loss: 0.004926| train set 3.170x speedup, test set 0.952x speedup, val set 0.835x speedup, step: 26
Epoch 30/300 |loss: 0.005153| train set 3.068x speedup, test set 0.886x speedup, val set 0.912x speedup, step: 27
Epoch 31/300 |loss: 0.004786| train set 2.860x speedup, test set 0.886x speedup, val set 0.646x speedup, step: 28
Epoch 32/300 |loss: 0.004576| train set 3.040x speedup, test set 0.886x speedup, val set 0.890x speedup, step: 29
Epoch 33/300 |loss: 0.005230| train set 3.163x speedup, test set 0.922x speedup, val set 0.907x speedup, step: 30
Epoch 34/300 |loss: 0.004403| train set 3.120x speedup, test set 0.938x speedup, val set 0.909x speedup, step: 31
Epoch 35/300 |loss: 0.004359| train set 3.190x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 32
Epoch 36/300 |loss: 0.003432| train set 3.242x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 33
Epoch 37/300 |loss: 0.003607| train set 2.972x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 34
Epoch 38/300 |loss: 0.005090| train set 2.952x speedup, test set 0.922x speedup, val set 0.688x speedup, step: 35
Epoch 39/300 |loss: 0.004273| train set 3.253x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 36
Epoch 40/300 |loss: 0.003917| train set 3.261x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 37
Epoch 41/300 |loss: 0.003015| train set 3.121x speedup, test set 0.922x speedup, val set 0.905x speedup, step: 38
Epoch 42/300 |loss: 0.003741| train set 3.155x speedup, test set 0.922x speedup, val set 0.687x speedup, step: 39
Epoch 43/300 |loss: 0.003538| train set 3.257x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 40
Epoch 44/300 |loss: 0.003219| train set 3.273x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 41
Epoch 45/300 |loss: 0.002670| train set 3.334x speedup, test set 0.922x speedup, val set 0.886x speedup, step: 42
Epoch 46/300 |loss: 0.002801| train set 3.350x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 43
Epoch 47/300 |loss: 0.002956| train set 3.104x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 44
Epoch 48/300 |loss: 0.002974| train set 3.178x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 45
Epoch 49/300 |loss: 0.002448| train set 3.287x speedup, test set 0.922x speedup, val set 0.887x speedup, step: 46
Epoch 50/300 |loss: 0.002868| train set 3.196x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 47
Epoch 51/300 |loss: 0.003535| train set 3.257x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 48
Epoch 52/300 |loss: 0.002748| train set 3.199x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 49
Epoch 53/300 |loss: 0.002393| train set 3.295x speedup, test set 0.922x speedup, val set 0.887x speedup, step: 50
Epoch 54/300 |loss: 0.002556| train set 3.203x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 51
Epoch 55/300 |loss: 0.002596| train set 3.301x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 52
Epoch 56/300 |loss: 0.002616| train set 3.270x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 53
Epoch 57/300 |loss: 0.002323| train set 3.229x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 54
Epoch 58/300 |loss: 0.002154| train set 3.292x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 55
Epoch 59/300 |loss: 0.002307| train set 3.235x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 56
Epoch 60/300 |loss: 0.001911| train set 3.371x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 57
Epoch 61/300 |loss: 0.002148| train set 3.210x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 58
Epoch 62/300 |loss: 0.002285| train set 3.226x speedup, test set 0.938x speedup, val set 0.811x speedup, step: 59
Epoch 63/300 |loss: 0.002201| train set 3.220x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 60
Epoch 64/300 |loss: 0.002090| train set 3.348x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 61
Epoch 65/300 |loss: 0.001972| train set 3.246x speedup, test set 0.938x speedup, val set 0.790x speedup, step: 62
Epoch 66/300 |loss: 0.002122| train set 3.326x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 63
Epoch 67/300 |loss: 0.002352| train set 3.127x speedup, test set 0.922x speedup, val set 0.895x speedup, step: 64
Epoch 68/300 |loss: 0.002048| train set 3.296x speedup, test set 0.922x speedup, val set 0.888x speedup, step: 65
Epoch 69/300 |loss: 0.001980| train set 3.327x speedup, test set 0.922x speedup, val set 0.790x speedup, step: 66
early stopping at epoch 69
Training per epoch cost 1.297 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 60, train speedup 3.371, test speedup 0.922, val speedup 0.790
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 69, train speedup 3.327, test speedup 0.922, val speedup 0.790
execution cost 0:02:14.318435
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.751840, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.685x speedup, test set 10.685x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020854| train set 0.870x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019231| train set 1.040x speedup, test set 6.351x speedup, val set 1.396x speedup, step: 1
Epoch 5/300 |loss: 0.016921| train set 0.990x speedup, test set 0.952x speedup, val set 0.766x speedup, step: 2
Epoch 6/300 |loss: 0.017501| train set 0.991x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014805| train set 1.020x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014272| train set 1.843x speedup, test set 0.969x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.014033| train set 1.019x speedup, test set 1.012x speedup, val set 0.859x speedup, step: 6
Epoch 10/300 |loss: 0.014093| train set 2.249x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.011860| train set 1.860x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010908| train set 2.205x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 9
Epoch 13/300 |loss: 0.010595| train set 2.308x speedup, test set 0.969x speedup, val set 0.933x speedup, step: 10
Epoch 14/300 |loss: 0.010730| train set 2.601x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009530| train set 3.056x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 12
Epoch 16/300 |loss: 0.009405| train set 2.544x speedup, test set 0.969x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.009775| train set 1.809x speedup, test set 0.963x speedup, val set 0.859x speedup, step: 14
Epoch 18/300 |loss: 0.009477| train set 3.021x speedup, test set 0.958x speedup, val set 0.836x speedup, step: 15
Epoch 19/300 |loss: 0.008319| train set 3.133x speedup, test set 0.914x speedup, val set 0.837x speedup, step: 16
Epoch 20/300 |loss: 0.007860| train set 2.338x speedup, test set 0.958x speedup, val set 0.852x speedup, step: 17
Epoch 21/300 |loss: 0.007370| train set 2.747x speedup, test set 0.914x speedup, val set 0.846x speedup, step: 18
Epoch 22/300 |loss: 0.006821| train set 2.988x speedup, test set 0.914x speedup, val set 0.913x speedup, step: 19
Epoch 23/300 |loss: 0.006149| train set 3.097x speedup, test set 0.914x speedup, val set 0.918x speedup, step: 20
Epoch 24/300 |loss: 0.006980| train set 2.791x speedup, test set 0.914x speedup, val set 0.916x speedup, step: 21
Epoch 25/300 |loss: 0.006726| train set 2.812x speedup, test set 0.919x speedup, val set 0.844x speedup, step: 22
Epoch 26/300 |loss: 0.005646| train set 2.718x speedup, test set 0.914x speedup, val set 0.815x speedup, step: 23
Epoch 27/300 |loss: 0.005626| train set 2.607x speedup, test set 0.914x speedup, val set 0.907x speedup, step: 24
Epoch 28/300 |loss: 0.005328| train set 3.159x speedup, test set 0.914x speedup, val set 0.906x speedup, step: 25
Epoch 29/300 |loss: 0.004966| train set 3.046x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 26
Epoch 30/300 |loss: 0.005206| train set 2.991x speedup, test set 0.914x speedup, val set 0.909x speedup, step: 27
Epoch 31/300 |loss: 0.004926| train set 3.088x speedup, test set 0.914x speedup, val set 0.913x speedup, step: 28
Epoch 32/300 |loss: 0.004851| train set 2.997x speedup, test set 0.914x speedup, val set 0.906x speedup, step: 29
Epoch 33/300 |loss: 0.004424| train set 3.187x speedup, test set 0.969x speedup, val set 0.906x speedup, step: 30
Epoch 34/300 |loss: 0.004277| train set 3.218x speedup, test set 0.969x speedup, val set 0.912x speedup, step: 31
Epoch 35/300 |loss: 0.004506| train set 3.166x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 32
Epoch 36/300 |loss: 0.003430| train set 3.193x speedup, test set 0.886x speedup, val set 0.891x speedup, step: 33
Epoch 37/300 |loss: 0.003482| train set 2.984x speedup, test set 0.938x speedup, val set 0.912x speedup, step: 34
Epoch 38/300 |loss: 0.005316| train set 3.057x speedup, test set 0.952x speedup, val set 0.688x speedup, step: 35
Epoch 39/300 |loss: 0.004856| train set 3.217x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 36
Epoch 40/300 |loss: 0.003862| train set 3.245x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 37
Epoch 41/300 |loss: 0.003145| train set 3.225x speedup, test set 0.938x speedup, val set 0.905x speedup, step: 38
Epoch 42/300 |loss: 0.003664| train set 2.968x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 39
Epoch 43/300 |loss: 0.004530| train set 3.158x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 40
Epoch 44/300 |loss: 0.003814| train set 3.326x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 41
Epoch 45/300 |loss: 0.002739| train set 3.336x speedup, test set 0.922x speedup, val set 0.892x speedup, step: 42
Epoch 46/300 |loss: 0.003012| train set 3.166x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 43
Epoch 47/300 |loss: 0.003052| train set 3.323x speedup, test set 0.922x speedup, val set 0.911x speedup, step: 44
Epoch 48/300 |loss: 0.002792| train set 3.240x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 45
Epoch 49/300 |loss: 0.002498| train set 3.301x speedup, test set 0.922x speedup, val set 0.895x speedup, step: 46
Epoch 50/300 |loss: 0.002503| train set 3.280x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 47
Epoch 51/300 |loss: 0.003187| train set 3.337x speedup, test set 0.922x speedup, val set 0.917x speedup, step: 48
Epoch 52/300 |loss: 0.002757| train set 3.251x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 49
Epoch 53/300 |loss: 0.002795| train set 3.307x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 50
Epoch 54/300 |loss: 0.002848| train set 3.213x speedup, test set 0.922x speedup, val set 0.870x speedup, step: 51
early stopping at epoch 54
Training per epoch cost 1.310 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 51, train speedup 3.337, test speedup 0.922, val speedup 0.917
best test speedup epoch: 2, train speedup 0.685, test speedup 10.685, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.040, test speedup 6.351, val speedup 1.396
last model at epoch 54, train speedup 3.213, test speedup 0.922, val speedup 0.870
execution cost 0:01:48.336356
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.803219, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019281| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016859| train set 0.977x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017542| train set 0.978x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014980| train set 1.002x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014008| train set 0.981x speedup, test set 1.012x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013559| train set 1.027x speedup, test set 1.012x speedup, val set 0.832x speedup, step: 6
Epoch 10/300 |loss: 0.013217| train set 2.329x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.012730| train set 1.837x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010968| train set 1.883x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 9
Epoch 13/300 |loss: 0.010783| train set 2.381x speedup, test set 0.969x speedup, val set 0.861x speedup, step: 10
Epoch 14/300 |loss: 0.010111| train set 2.713x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 11
Epoch 15/300 |loss: 0.009842| train set 3.110x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 12
Epoch 16/300 |loss: 0.009042| train set 2.547x speedup, test set 0.969x speedup, val set 0.830x speedup, step: 13
Epoch 17/300 |loss: 0.010162| train set 1.719x speedup, test set 0.958x speedup, val set 0.859x speedup, step: 14
Epoch 18/300 |loss: 0.009560| train set 2.958x speedup, test set 0.914x speedup, val set 0.836x speedup, step: 15
Epoch 19/300 |loss: 0.007944| train set 3.101x speedup, test set 0.974x speedup, val set 0.838x speedup, step: 16
Epoch 20/300 |loss: 0.007653| train set 2.622x speedup, test set 0.969x speedup, val set 0.860x speedup, step: 17
Epoch 21/300 |loss: 0.006778| train set 2.640x speedup, test set 0.914x speedup, val set 0.842x speedup, step: 18
Epoch 22/300 |loss: 0.006550| train set 3.050x speedup, test set 0.969x speedup, val set 0.847x speedup, step: 19
Epoch 23/300 |loss: 0.005853| train set 3.175x speedup, test set 0.914x speedup, val set 0.833x speedup, step: 20
Epoch 24/300 |loss: 0.006837| train set 2.825x speedup, test set 0.952x speedup, val set 0.838x speedup, step: 21
Epoch 25/300 |loss: 0.006904| train set 2.883x speedup, test set 0.914x speedup, val set 0.846x speedup, step: 22
Epoch 26/300 |loss: 0.005804| train set 2.930x speedup, test set 0.886x speedup, val set 0.838x speedup, step: 23
Epoch 27/300 |loss: 0.005139| train set 3.267x speedup, test set 0.886x speedup, val set 0.910x speedup, step: 24
Epoch 28/300 |loss: 0.005300| train set 3.267x speedup, test set 0.886x speedup, val set 0.906x speedup, step: 25
Epoch 29/300 |loss: 0.005034| train set 3.206x speedup, test set 0.914x speedup, val set 0.910x speedup, step: 26
Epoch 30/300 |loss: 0.004780| train set 3.088x speedup, test set 0.886x speedup, val set 0.841x speedup, step: 27
Epoch 31/300 |loss: 0.004600| train set 3.060x speedup, test set 0.969x speedup, val set 0.641x speedup, step: 28
Epoch 32/300 |loss: 0.004682| train set 3.096x speedup, test set 0.914x speedup, val set 0.908x speedup, step: 29
Epoch 33/300 |loss: 0.004740| train set 3.197x speedup, test set 0.922x speedup, val set 0.906x speedup, step: 30
Epoch 34/300 |loss: 0.004444| train set 3.192x speedup, test set 0.969x speedup, val set 0.840x speedup, step: 31
Epoch 35/300 |loss: 0.004057| train set 3.284x speedup, test set 0.886x speedup, val set 0.892x speedup, step: 32
Epoch 36/300 |loss: 0.003365| train set 3.171x speedup, test set 0.922x speedup, val set 0.909x speedup, step: 33
Epoch 37/300 |loss: 0.003425| train set 2.647x speedup, test set 0.927x speedup, val set 0.827x speedup, step: 34
Epoch 38/300 |loss: 0.004494| train set 2.807x speedup, test set 0.922x speedup, val set 0.813x speedup, step: 35
Epoch 39/300 |loss: 0.003770| train set 3.284x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 36
Epoch 40/300 |loss: 0.003500| train set 3.269x speedup, test set 0.922x speedup, val set 0.687x speedup, step: 37
Epoch 41/300 |loss: 0.002804| train set 3.238x speedup, test set 0.922x speedup, val set 0.688x speedup, step: 38
Epoch 42/300 |loss: 0.003392| train set 3.182x speedup, test set 0.922x speedup, val set 0.688x speedup, step: 39
Epoch 43/300 |loss: 0.003460| train set 3.283x speedup, test set 0.922x speedup, val set 0.689x speedup, step: 40
Epoch 44/300 |loss: 0.003114| train set 3.299x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 41
Epoch 45/300 |loss: 0.002603| train set 3.352x speedup, test set 0.922x speedup, val set 0.689x speedup, step: 42
Epoch 46/300 |loss: 0.002565| train set 3.239x speedup, test set 0.922x speedup, val set 0.687x speedup, step: 43
Epoch 47/300 |loss: 0.002569| train set 3.142x speedup, test set 0.922x speedup, val set 0.688x speedup, step: 44
Epoch 48/300 |loss: 0.002884| train set 3.234x speedup, test set 0.922x speedup, val set 0.755x speedup, step: 45
Epoch 49/300 |loss: 0.002524| train set 3.299x speedup, test set 0.922x speedup, val set 0.890x speedup, step: 46
Epoch 50/300 |loss: 0.002701| train set 3.292x speedup, test set 0.922x speedup, val set 0.689x speedup, step: 47
Epoch 51/300 |loss: 0.003200| train set 3.239x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 48
Epoch 52/300 |loss: 0.002617| train set 3.023x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 49
Epoch 53/300 |loss: 0.002603| train set 3.317x speedup, test set 0.922x speedup, val set 0.810x speedup, step: 50
Epoch 54/300 |loss: 0.002801| train set 2.902x speedup, test set 0.922x speedup, val set 0.811x speedup, step: 51
early stopping at epoch 54
Training per epoch cost 1.311 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 45, train speedup 3.352, test speedup 0.922, val speedup 0.689
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 54, train speedup 2.902, test speedup 0.922, val speedup 0.811
execution cost 0:01:48.928152
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
construct training samples cost 0:00:00.763181, and there are 3822 training samples
in channel 9
Epoch 0/300 |loss: 0.048414| train set 0.911x speedup, test set 6.604x speedup, val set 0.428x speedup, step: 1
Epoch 1/300 |loss: 0.025898| train set 0.896x speedup, test set 7.236x speedup, val set 0.428x speedup, step: 1
Epoch 2/300 |loss: 0.023064| train set 0.690x speedup, test set 10.628x speedup, val set 0.433x speedup, step: 1
Epoch 3/300 |loss: 0.020874| train set 0.872x speedup, test set 6.441x speedup, val set 0.406x speedup, step: 2
Epoch 4/300 |loss: 0.019281| train set 1.047x speedup, test set 6.351x speedup, val set 1.339x speedup, step: 1
Epoch 5/300 |loss: 0.016859| train set 0.977x speedup, test set 0.969x speedup, val set 0.835x speedup, step: 2
Epoch 6/300 |loss: 0.017542| train set 0.978x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 3
Epoch 7/300 |loss: 0.014980| train set 1.002x speedup, test set 1.012x speedup, val set 0.860x speedup, step: 4
Epoch 8/300 |loss: 0.014008| train set 0.981x speedup, test set 1.012x speedup, val set 0.854x speedup, step: 5
Epoch 9/300 |loss: 0.013559| train set 1.027x speedup, test set 1.012x speedup, val set 0.832x speedup, step: 6
Epoch 10/300 |loss: 0.013223| train set 2.329x speedup, test set 0.969x speedup, val set 0.851x speedup, step: 7
Epoch 11/300 |loss: 0.012728| train set 1.838x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 8
Epoch 12/300 |loss: 0.010969| train set 2.107x speedup, test set 0.969x speedup, val set 0.856x speedup, step: 9
Epoch 13/300 |loss: 0.010971| train set 2.161x speedup, test set 0.969x speedup, val set 0.865x speedup, step: 10
Epoch 14/300 |loss: 0.009789| train set 2.377x speedup, test set 0.969x speedup, val set 0.850x speedup, step: 11
Epoch 15/300 |loss: 0.010121| train set 3.078x speedup, test set 0.969x speedup, val set 0.852x speedup, step: 12
Epoch 16/300 |loss: 0.009526| train set 2.416x speedup, test set 0.952x speedup, val set 0.857x speedup, step: 13
Epoch 17/300 |loss: 0.008615| train set 1.674x speedup, test set 0.958x speedup, val set 0.852x speedup, step: 14
Epoch 18/300 |loss: 0.008748| train set 2.937x speedup, test set 0.969x speedup, val set 0.842x speedup, step: 15
Epoch 19/300 |loss: 0.007608| train set 3.005x speedup, test set 0.974x speedup, val set 0.839x speedup, step: 16
Epoch 20/300 |loss: 0.007347| train set 2.871x speedup, test set 0.958x speedup, val set 0.860x speedup, step: 17
Epoch 21/300 |loss: 0.007173| train set 3.084x speedup, test set 0.914x speedup, val set 0.859x speedup, step: 18
Epoch 22/300 |loss: 0.006209| train set 3.015x speedup, test set 0.914x speedup, val set 0.847x speedup, step: 19
Epoch 23/300 |loss: 0.005410| train set 3.213x speedup, test set 0.914x speedup, val set 0.842x speedup, step: 20
Epoch 24/300 |loss: 0.007117| train set 2.861x speedup, test set 0.919x speedup, val set 0.830x speedup, step: 21
Epoch 25/300 |loss: 0.006260| train set 2.667x speedup, test set 0.914x speedup, val set 0.841x speedup, step: 22
Epoch 26/300 |loss: 0.005339| train set 2.537x speedup, test set 0.969x speedup, val set 0.817x speedup, step: 23
Epoch 27/300 |loss: 0.005892| train set 2.517x speedup, test set 0.914x speedup, val set 0.909x speedup, step: 24
Epoch 28/300 |loss: 0.005156| train set 3.173x speedup, test set 0.922x speedup, val set 0.927x speedup, step: 25
Epoch 29/300 |loss: 0.005118| train set 3.181x speedup, test set 0.886x speedup, val set 0.906x speedup, step: 26
Epoch 30/300 |loss: 0.004661| train set 3.166x speedup, test set 0.886x speedup, val set 0.912x speedup, step: 27
Epoch 31/300 |loss: 0.004516| train set 2.777x speedup, test set 0.938x speedup, val set 0.823x speedup, step: 28
Epoch 32/300 |loss: 0.004359| train set 3.000x speedup, test set 0.886x speedup, val set 0.824x speedup, step: 29
Epoch 33/300 |loss: 0.004619| train set 3.228x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 30
Epoch 34/300 |loss: 0.004428| train set 3.098x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 31
Epoch 35/300 |loss: 0.005412| train set 3.054x speedup, test set 0.922x speedup, val set 0.825x speedup, step: 32
Epoch 36/300 |loss: 0.003613| train set 3.150x speedup, test set 0.938x speedup, val set 0.890x speedup, step: 33
Epoch 37/300 |loss: 0.003389| train set 2.763x speedup, test set 0.922x speedup, val set 0.840x speedup, step: 34
Epoch 38/300 |loss: 0.003795| train set 3.242x speedup, test set 0.969x speedup, val set 0.813x speedup, step: 35
Epoch 39/300 |loss: 0.004014| train set 3.183x speedup, test set 0.922x speedup, val set 0.842x speedup, step: 36
Epoch 40/300 |loss: 0.003668| train set 3.314x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 37
Epoch 41/300 |loss: 0.002859| train set 3.171x speedup, test set 0.938x speedup, val set 0.910x speedup, step: 38
Epoch 42/300 |loss: 0.003344| train set 3.260x speedup, test set 0.938x speedup, val set 0.840x speedup, step: 39
Epoch 43/300 |loss: 0.003073| train set 3.298x speedup, test set 0.922x speedup, val set 0.910x speedup, step: 40
Epoch 44/300 |loss: 0.003216| train set 3.271x speedup, test set 0.922x speedup, val set 0.754x speedup, step: 41
Epoch 45/300 |loss: 0.002658| train set 3.357x speedup, test set 0.938x speedup, val set 0.910x speedup, step: 42
Epoch 46/300 |loss: 0.002721| train set 3.228x speedup, test set 0.938x speedup, val set 0.687x speedup, step: 43
Epoch 47/300 |loss: 0.002929| train set 3.043x speedup, test set 0.938x speedup, val set 0.838x speedup, step: 44
Epoch 48/300 |loss: 0.002810| train set 3.217x speedup, test set 0.922x speedup, val set 0.754x speedup, step: 45
Epoch 49/300 |loss: 0.002408| train set 3.347x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 46
Epoch 50/300 |loss: 0.002926| train set 3.273x speedup, test set 0.922x speedup, val set 0.756x speedup, step: 47
Epoch 51/300 |loss: 0.003534| train set 3.212x speedup, test set 0.922x speedup, val set 0.893x speedup, step: 48
Epoch 52/300 |loss: 0.002691| train set 3.237x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 49
Epoch 53/300 |loss: 0.002284| train set 3.322x speedup, test set 0.922x speedup, val set 0.908x speedup, step: 50
Epoch 54/300 |loss: 0.002605| train set 3.201x speedup, test set 0.922x speedup, val set 0.812x speedup, step: 51
Epoch 55/300 |loss: 0.002704| train set 3.289x speedup, test set 0.922x speedup, val set 0.896x speedup, step: 52
Epoch 56/300 |loss: 0.002759| train set 3.317x speedup, test set 0.922x speedup, val set 0.755x speedup, step: 53
Epoch 57/300 |loss: 0.002429| train set 3.173x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 54
Epoch 58/300 |loss: 0.002293| train set 3.237x speedup, test set 0.922x speedup, val set 0.911x speedup, step: 55
Epoch 59/300 |loss: 0.002290| train set 3.346x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 56
Epoch 60/300 |loss: 0.002137| train set 3.212x speedup, test set 0.922x speedup, val set 0.911x speedup, step: 57
Epoch 61/300 |loss: 0.002301| train set 3.290x speedup, test set 0.922x speedup, val set 0.813x speedup, step: 58
Epoch 62/300 |loss: 0.002198| train set 3.276x speedup, test set 0.922x speedup, val set 0.912x speedup, step: 59
Epoch 63/300 |loss: 0.002251| train set 3.366x speedup, test set 0.922x speedup, val set 0.792x speedup, step: 60
Epoch 64/300 |loss: 0.002170| train set 3.360x speedup, test set 0.922x speedup, val set 0.689x speedup, step: 61
Epoch 65/300 |loss: 0.002058| train set 3.221x speedup, test set 0.922x speedup, val set 0.690x speedup, step: 62
Epoch 66/300 |loss: 0.002194| train set 3.318x speedup, test set 0.922x speedup, val set 0.881x speedup, step: 63
Epoch 67/300 |loss: 0.003180| train set 3.084x speedup, test set 0.922x speedup, val set 0.911x speedup, step: 64
Epoch 68/300 |loss: 0.002400| train set 3.243x speedup, test set 0.922x speedup, val set 0.882x speedup, step: 65
early stopping at epoch 68
Training per epoch cost 1.309 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
22, opt runtime 7.096s, model runtime 10.477s, pg runtime 7.096s, speedup 0.677x
23, opt runtime 7.063s, model runtime 10.006s, pg runtime 7.063s, speedup 0.706x
24, opt runtime 7.268s, model runtime 10.574s, pg runtime 7.268s, speedup 0.687x
25, opt runtime 6.854s, model runtime 10.847s, pg runtime 6.854s, speedup 0.632x
26, opt runtime 6.905s, model runtime 10.527s, pg runtime 6.905s, speedup 0.656x
27, opt runtime 6.663s, model runtime 10.451s, pg runtime 6.663s, speedup 0.637x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 7.066s, model runtime 10.449s, pg runtime 7.533s, speedup 0.721x
30, opt runtime 6.961s, model runtime 10.511s, pg runtime 6.961s, speedup 0.662x
31, opt runtime 16.268s, model runtime 18.255s, pg runtime 432.766s, speedup 23.707x
32, opt runtime 15.120s, model runtime 15.120s, pg runtime 566.078s, speedup 37.440x
33, opt runtime 16.639s, model runtime 17.885s, pg runtime 462.544s, speedup 25.862x
34, opt runtime 16.280s, model runtime 18.051s, pg runtime 634.990s, speedup 35.177x
35, opt runtime 16.528s, model runtime 17.951s, pg runtime 620.762s, speedup 34.581x
36, opt runtime 18.690s, model runtime 19.533s, pg runtime 651.942s, speedup 33.376x
37, opt runtime 16.438s, model runtime 19.535s, pg runtime 546.887s, speedup 27.995x
38, opt runtime 16.138s, model runtime 17.327s, pg runtime 501.793s, speedup 28.960x
39, opt runtime 16.770s, model runtime 17.966s, pg runtime 594.754s, speedup 33.104x
40, opt runtime 16.305s, model runtime 17.918s, pg runtime 436.168s, speedup 24.342x
====================
best train speedup epoch: 63, train speedup 3.366, test speedup 0.922, val speedup 0.792
best test speedup epoch: 2, train speedup 0.690, test speedup 10.628, val speedup 0.433
best validation speedup epoch: 4, train speedup 1.047, test speedup 6.351, val speedup 1.339
last model at epoch 68, train speedup 3.243, test speedup 0.922, val speedup 0.882
execution cost 0:02:14.140576
==================================================
