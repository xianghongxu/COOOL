all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.263966, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455478| train set 1.126x speedup, test set 2.247x speedup, val set 1.034x speedup, step: 1, train time 18.50 s
Epoch 1/50 |loss: 0.367341| train set 1.797x speedup, test set 2.352x speedup, val set 0.979x speedup, step: 2, train time 16.11 s
Epoch 2/50 |loss: 0.329643| train set 2.238x speedup, test set 1.153x speedup, val set 1.009x speedup, step: 3, train time 15.82 s
Epoch 3/50 |loss: 0.302115| train set 2.478x speedup, test set 1.225x speedup, val set 1.009x speedup, step: 4, train time 16.33 s
Epoch 4/50 |loss: 0.268214| train set 2.449x speedup, test set 1.311x speedup, val set 1.008x speedup, step: 1, train time 15.91 s
Epoch 5/50 |loss: 0.256607| train set 2.386x speedup, test set 1.239x speedup, val set 1.010x speedup, step: 2, train time 15.92 s
Epoch 6/50 |loss: 0.240609| train set 2.307x speedup, test set 1.309x speedup, val set 1.051x speedup, step: 3, train time 15.72 s
Epoch 7/50 |loss: 0.233792| train set 2.579x speedup, test set 1.272x speedup, val set 1.619x speedup, step: 4, train time 15.91 s
Epoch 8/50 |loss: 0.222009| train set 2.675x speedup, test set 2.225x speedup, val set 1.010x speedup, step: 5, train time 16.01 s
Epoch 9/50 |loss: 0.217265| train set 2.675x speedup, test set 2.497x speedup, val set 1.012x speedup, step: 1, train time 16.12 s
Epoch 10/50 |loss: 0.211472| train set 2.500x speedup, test set 2.343x speedup, val set 1.643x speedup, step: 2, train time 16.03 s
Epoch 11/50 |loss: 0.206270| train set 2.660x speedup, test set 2.381x speedup, val set 1.643x speedup, step: 3, train time 15.92 s
Epoch 12/50 |loss: 0.201899| train set 2.574x speedup, test set 2.267x speedup, val set 1.053x speedup, step: 4, train time 15.72 s
Epoch 13/50 |loss: 0.190583| train set 2.658x speedup, test set 2.206x speedup, val set 1.643x speedup, step: 5, train time 15.73 s
Epoch 14/50 |loss: 0.188256| train set 2.704x speedup, test set 2.046x speedup, val set 1.643x speedup, step: 1, train time 15.94 s
Epoch 15/50 |loss: 0.182061| train set 2.746x speedup, test set 2.148x speedup, val set 1.012x speedup, step: 2, train time 15.92 s
Epoch 16/50 |loss: 0.172182| train set 2.750x speedup, test set 2.149x speedup, val set 1.012x speedup, step: 3, train time 16.00 s
Epoch 17/50 |loss: 0.166286| train set 2.714x speedup, test set 2.069x speedup, val set 1.016x speedup, step: 4, train time 16.24 s
Epoch 18/50 |loss: 0.163167| train set 2.748x speedup, test set 2.179x speedup, val set 1.015x speedup, step: 5, train time 15.92 s
Epoch 19/50 |loss: 0.167694| train set 2.717x speedup, test set 2.069x speedup, val set 1.648x speedup, step: 1, train time 16.03 s
Epoch 20/50 |loss: 0.162386| train set 2.669x speedup, test set 1.289x speedup, val set 1.012x speedup, step: 2, train time 16.00 s
Epoch 21/50 |loss: 0.155067| train set 2.686x speedup, test set 2.206x speedup, val set 1.011x speedup, step: 3, train time 15.74 s
Epoch 22/50 |loss: 0.155905| train set 2.723x speedup, test set 1.362x speedup, val set 1.624x speedup, step: 4, train time 16.04 s
Epoch 23/50 |loss: 0.146083| train set 2.615x speedup, test set 2.266x speedup, val set 1.048x speedup, step: 5, train time 16.01 s
Epoch 24/50 |loss: 0.147081| train set 2.801x speedup, test set 2.050x speedup, val set 1.015x speedup, step: 6, train time 15.95 s
Epoch 25/50 |loss: 0.147539| train set 2.787x speedup, test set 2.181x speedup, val set 1.010x speedup, step: 7, train time 15.94 s
Epoch 26/50 |loss: 0.143259| train set 2.768x speedup, test set 1.297x speedup, val set 1.010x speedup, step: 8, train time 16.02 s
Epoch 27/50 |loss: 0.137100| train set 2.688x speedup, test set 2.233x speedup, val set 1.012x speedup, step: 9, train time 16.13 s
Epoch 28/50 |loss: 0.137194| train set 2.738x speedup, test set 2.152x speedup, val set 1.010x speedup, step: 10, train time 15.93 s
Epoch 29/50 |loss: 0.133799| train set 2.815x speedup, test set 2.181x speedup, val set 1.010x speedup, step: 11, train time 15.84 s
Epoch 30/50 |loss: 0.136325| train set 2.791x speedup, test set 2.056x speedup, val set 1.015x speedup, step: 12, train time 15.73 s
Epoch 31/50 |loss: 0.137022| train set 2.757x speedup, test set 2.193x speedup, val set 1.005x speedup, step: 13, train time 15.92 s
Epoch 32/50 |loss: 0.129972| train set 2.739x speedup, test set 2.181x speedup, val set 1.005x speedup, step: 14, train time 15.88 s
Epoch 33/50 |loss: 0.127945| train set 2.821x speedup, test set 2.225x speedup, val set 1.048x speedup, step: 15, train time 16.02 s
Epoch 34/50 |loss: 0.127781| train set 2.715x speedup, test set 1.283x speedup, val set 1.007x speedup, step: 16, train time 16.03 s
Epoch 35/50 |loss: 0.122789| train set 2.795x speedup, test set 1.271x speedup, val set 1.010x speedup, step: 17, train time 15.83 s
Epoch 36/50 |loss: 0.128396| train set 2.786x speedup, test set 2.211x speedup, val set 1.006x speedup, step: 18, train time 15.92 s
Epoch 37/50 |loss: 0.119581| train set 2.797x speedup, test set 1.297x speedup, val set 1.005x speedup, step: 19, train time 15.92 s
Epoch 38/50 |loss: 0.120668| train set 2.805x speedup, test set 2.095x speedup, val set 1.010x speedup, step: 20, train time 15.99 s
Epoch 39/50 |loss: 0.119013| train set 2.509x speedup, test set 2.059x speedup, val set 1.050x speedup, step: 21, train time 15.65 s
Epoch 40/50 |loss: 0.116494| train set 2.646x speedup, test set 2.109x speedup, val set 1.007x speedup, step: 22, train time 15.50 s
Epoch 41/50 |loss: 0.113352| train set 2.762x speedup, test set 2.066x speedup, val set 1.013x speedup, step: 23, train time 15.51 s
Epoch 42/50 |loss: 0.114757| train set 2.797x speedup, test set 2.153x speedup, val set 1.006x speedup, step: 24, train time 15.49 s
Epoch 43/50 |loss: 0.114855| train set 2.821x speedup, test set 1.296x speedup, val set 0.998x speedup, step: 25, train time 15.52 s
Epoch 44/50 |loss: 0.119011| train set 2.856x speedup, test set 2.187x speedup, val set 1.007x speedup, step: 26, train time 15.50 s
Epoch 45/50 |loss: 0.113868| train set 2.687x speedup, test set 1.243x speedup, val set 1.050x speedup, step: 27, train time 15.53 s
Epoch 46/50 |loss: 0.111500| train set 2.830x speedup, test set 2.118x speedup, val set 1.005x speedup, step: 28, train time 15.41 s
Epoch 47/50 |loss: 0.122366| train set 2.834x speedup, test set 2.249x speedup, val set 1.005x speedup, step: 29, train time 15.51 s
Epoch 48/50 |loss: 0.108773| train set 2.685x speedup, test set 2.184x speedup, val set 1.050x speedup, step: 30, train time 15.59 s
Epoch 49/50 |loss: 0.106776| train set 2.763x speedup, test set 1.257x speedup, val set 1.012x speedup, step: 31, train time 15.39 s
Training per epoch cost 15.905 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 49.702s, pg runtime 32.278s, speedup 0.649x
06, opt runtime 21.143s, model runtime 55.527s, pg runtime 21.143s, speedup 0.381x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 29.303s, pg runtime 22.482s, speedup 0.767x
22, opt runtime 6.519s, model runtime 44.915s, pg runtime 6.519s, speedup 0.145x
23, opt runtime 6.250s, model runtime 11.757s, pg runtime 32.969s, speedup 2.804x
24, opt runtime 5.961s, model runtime 11.448s, pg runtime 31.210s, speedup 2.726x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 44, train speedup 2.856, test speedup 2.187, val speedup 1.007
best test speedup epoch: 9, train speedup 2.675, test speedup 2.497, val speedup 1.012
best validation speedup epoch: 19, train speedup 2.717, test speedup 2.069, val speedup 1.648
last model at epoch 49, train speedup 2.763, test speedup 1.257, val speedup 1.012
execution cost 0:14:33.086312
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.733083, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455074| train set 1.106x speedup, test set 2.281x speedup, val set 1.034x speedup, step: 1, train time 17.13 s
Epoch 1/50 |loss: 0.366666| train set 2.052x speedup, test set 2.458x speedup, val set 1.555x speedup, step: 2, train time 15.51 s
Epoch 2/50 |loss: 0.330293| train set 2.216x speedup, test set 2.349x speedup, val set 1.003x speedup, step: 3, train time 15.34 s
Epoch 3/50 |loss: 0.304858| train set 2.334x speedup, test set 1.291x speedup, val set 1.009x speedup, step: 4, train time 16.22 s
Epoch 4/50 |loss: 0.273103| train set 2.262x speedup, test set 2.284x speedup, val set 1.053x speedup, step: 1, train time 15.51 s
Epoch 5/50 |loss: 0.264807| train set 2.376x speedup, test set 2.178x speedup, val set 1.047x speedup, step: 2, train time 15.34 s
Epoch 6/50 |loss: 0.246490| train set 2.094x speedup, test set 2.085x speedup, val set 0.926x speedup, step: 3, train time 15.41 s
Epoch 7/50 |loss: 0.241928| train set 2.637x speedup, test set 1.600x speedup, val set 1.664x speedup, step: 4, train time 15.43 s
Epoch 8/50 |loss: 0.228399| train set 2.555x speedup, test set 1.460x speedup, val set 1.010x speedup, step: 5, train time 15.51 s
Epoch 9/50 |loss: 0.223988| train set 2.410x speedup, test set 1.027x speedup, val set 1.647x speedup, step: 1, train time 15.51 s
Epoch 10/50 |loss: 0.220129| train set 2.537x speedup, test set 1.005x speedup, val set 1.660x speedup, step: 2, train time 15.44 s
Epoch 11/50 |loss: 0.215427| train set 2.738x speedup, test set 2.267x speedup, val set 2.062x speedup, step: 3, train time 15.51 s
Epoch 12/50 |loss: 0.207163| train set 2.725x speedup, test set 2.345x speedup, val set 1.053x speedup, step: 4, train time 15.51 s
Epoch 13/50 |loss: 0.198547| train set 2.731x speedup, test set 2.182x speedup, val set 1.643x speedup, step: 5, train time 15.40 s
Epoch 14/50 |loss: 0.190892| train set 2.779x speedup, test set 2.122x speedup, val set 1.660x speedup, step: 1, train time 15.40 s
Epoch 15/50 |loss: 0.189956| train set 2.727x speedup, test set 2.199x speedup, val set 1.152x speedup, step: 2, train time 15.50 s
Epoch 16/50 |loss: 0.181549| train set 2.557x speedup, test set 2.309x speedup, val set 1.010x speedup, step: 3, train time 15.43 s
Epoch 17/50 |loss: 0.170664| train set 2.793x speedup, test set 1.575x speedup, val set 1.664x speedup, step: 4, train time 15.59 s
Epoch 18/50 |loss: 0.167079| train set 2.747x speedup, test set 1.547x speedup, val set 1.013x speedup, step: 5, train time 15.42 s
Epoch 19/50 |loss: 0.172662| train set 2.769x speedup, test set 1.554x speedup, val set 2.251x speedup, step: 1, train time 15.53 s
Epoch 20/50 |loss: 0.172317| train set 2.677x speedup, test set 2.167x speedup, val set 1.154x speedup, step: 2, train time 15.39 s
Epoch 21/50 |loss: 0.160231| train set 2.716x speedup, test set 2.120x speedup, val set 2.089x speedup, step: 3, train time 15.53 s
Epoch 22/50 |loss: 0.162057| train set 2.733x speedup, test set 2.072x speedup, val set 1.648x speedup, step: 4, train time 15.41 s
Epoch 23/50 |loss: 0.148799| train set 2.718x speedup, test set 2.246x speedup, val set 1.152x speedup, step: 5, train time 15.44 s
Epoch 24/50 |loss: 0.152513| train set 2.730x speedup, test set 1.517x speedup, val set 1.152x speedup, step: 6, train time 15.42 s
Epoch 25/50 |loss: 0.155237| train set 2.826x speedup, test set 2.203x speedup, val set 1.007x speedup, step: 7, train time 15.50 s
Epoch 26/50 |loss: 0.148103| train set 2.747x speedup, test set 2.246x speedup, val set 1.211x speedup, step: 8, train time 15.42 s
Epoch 27/50 |loss: 0.144190| train set 2.768x speedup, test set 2.258x speedup, val set 1.154x speedup, step: 9, train time 15.42 s
Epoch 28/50 |loss: 0.142555| train set 2.671x speedup, test set 2.287x speedup, val set 1.204x speedup, step: 10, train time 15.42 s
Epoch 29/50 |loss: 0.136569| train set 2.821x speedup, test set 2.244x speedup, val set 1.635x speedup, step: 11, train time 15.41 s
Epoch 30/50 |loss: 0.141436| train set 2.796x speedup, test set 2.270x speedup, val set 1.012x speedup, step: 12, train time 15.52 s
Epoch 31/50 |loss: 0.141842| train set 2.768x speedup, test set 2.086x speedup, val set 0.967x speedup, step: 13, train time 15.41 s
Epoch 32/50 |loss: 0.132578| train set 2.746x speedup, test set 2.179x speedup, val set 1.048x speedup, step: 14, train time 15.62 s
Epoch 33/50 |loss: 0.129334| train set 2.814x speedup, test set 2.268x speedup, val set 1.012x speedup, step: 15, train time 15.61 s
Epoch 34/50 |loss: 0.133019| train set 2.803x speedup, test set 2.114x speedup, val set 1.012x speedup, step: 16, train time 15.59 s
Epoch 35/50 |loss: 0.128930| train set 2.736x speedup, test set 2.295x speedup, val set 1.010x speedup, step: 17, train time 15.45 s
Epoch 36/50 |loss: 0.132286| train set 2.706x speedup, test set 2.269x speedup, val set 1.753x speedup, step: 18, train time 15.23 s
Epoch 37/50 |loss: 0.127473| train set 2.780x speedup, test set 2.242x speedup, val set 1.012x speedup, step: 19, train time 15.52 s
Epoch 38/50 |loss: 0.127696| train set 2.784x speedup, test set 2.206x speedup, val set 1.156x speedup, step: 20, train time 15.52 s
Epoch 39/50 |loss: 0.125773| train set 2.788x speedup, test set 2.106x speedup, val set 1.154x speedup, step: 21, train time 15.49 s
Epoch 40/50 |loss: 0.120738| train set 2.809x speedup, test set 2.203x speedup, val set 2.043x speedup, step: 22, train time 15.42 s
Epoch 41/50 |loss: 0.118488| train set 2.802x speedup, test set 2.142x speedup, val set 1.154x speedup, step: 23, train time 15.41 s
Epoch 42/50 |loss: 0.118288| train set 2.824x speedup, test set 2.324x speedup, val set 1.148x speedup, step: 24, train time 15.50 s
Epoch 43/50 |loss: 0.122196| train set 2.780x speedup, test set 2.203x speedup, val set 1.050x speedup, step: 25, train time 15.23 s
Epoch 44/50 |loss: 0.122996| train set 2.857x speedup, test set 2.268x speedup, val set 1.148x speedup, step: 26, train time 15.23 s
Epoch 45/50 |loss: 0.121238| train set 2.709x speedup, test set 2.092x speedup, val set 1.053x speedup, step: 27, train time 15.33 s
Epoch 46/50 |loss: 0.112029| train set 2.740x speedup, test set 2.137x speedup, val set 1.148x speedup, step: 28, train time 15.42 s
Epoch 47/50 |loss: 0.119954| train set 2.813x speedup, test set 2.203x speedup, val set 1.007x speedup, step: 29, train time 15.22 s
Epoch 48/50 |loss: 0.115566| train set 2.747x speedup, test set 2.050x speedup, val set 1.007x speedup, step: 30, train time 15.52 s
Epoch 49/50 |loss: 0.109933| train set 2.820x speedup, test set 2.243x speedup, val set 1.007x speedup, step: 31, train time 15.40 s
Training per epoch cost 15.492 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 39.889s, pg runtime 16.134s, speedup 0.404x
08, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 38.252s, pg runtime 23.223s, speedup 0.607x
18, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.646s, pg runtime 5.362s, speedup 0.950x
30, opt runtime 5.572s, model runtime 5.971s, pg runtime 5.572s, speedup 0.933x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 406.510s, pg runtime 651.942s, speedup 1.604x
36, opt runtime 16.639s, model runtime 335.627s, pg runtime 462.544s, speedup 1.378x
37, opt runtime 11.120s, model runtime 52.165s, pg runtime 11.120s, speedup 0.213x
38, opt runtime 18.262s, model runtime 47.388s, pg runtime 18.262s, speedup 0.385x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 44, train speedup 2.857, test speedup 2.268, val speedup 1.148
best test speedup epoch: 1, train speedup 2.052, test speedup 2.458, val speedup 1.555
best validation speedup epoch: 19, train speedup 2.769, test speedup 1.554, val speedup 2.251
last model at epoch 49, train speedup 2.820, test speedup 2.243, val speedup 1.007
execution cost 0:14:02.588184
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.327427, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455616| train set 1.125x speedup, test set 2.513x speedup, val set 0.986x speedup, step: 1, train time 18.72 s
Epoch 1/50 |loss: 0.366320| train set 2.098x speedup, test set 2.609x speedup, val set 1.456x speedup, step: 2, train time 16.19 s
Epoch 2/50 |loss: 0.330514| train set 2.165x speedup, test set 1.318x speedup, val set 1.002x speedup, step: 3, train time 16.33 s
Epoch 3/50 |loss: 0.306172| train set 2.240x speedup, test set 1.213x speedup, val set 1.002x speedup, step: 4, train time 17.01 s
Epoch 4/50 |loss: 0.274316| train set 2.076x speedup, test set 1.333x speedup, val set 1.057x speedup, step: 1, train time 15.96 s
Epoch 5/50 |loss: 0.262829| train set 2.191x speedup, test set 1.316x speedup, val set 1.006x speedup, step: 2, train time 16.11 s
Epoch 6/50 |loss: 0.242495| train set 2.210x speedup, test set 1.223x speedup, val set 1.055x speedup, step: 3, train time 16.05 s
Epoch 7/50 |loss: 0.236644| train set 2.640x speedup, test set 1.329x speedup, val set 1.011x speedup, step: 4, train time 15.91 s
Epoch 8/50 |loss: 0.225204| train set 2.543x speedup, test set 1.264x speedup, val set 1.010x speedup, step: 5, train time 16.01 s
Epoch 9/50 |loss: 0.222812| train set 2.548x speedup, test set 1.299x speedup, val set 1.642x speedup, step: 1, train time 16.00 s
Epoch 10/50 |loss: 0.214310| train set 2.661x speedup, test set 1.016x speedup, val set 1.009x speedup, step: 2, train time 16.00 s
Epoch 11/50 |loss: 0.206948| train set 2.754x speedup, test set 2.263x speedup, val set 1.143x speedup, step: 3, train time 15.99 s
Epoch 12/50 |loss: 0.200959| train set 2.639x speedup, test set 2.217x speedup, val set 1.216x speedup, step: 4, train time 16.15 s
Epoch 13/50 |loss: 0.191810| train set 2.771x speedup, test set 1.388x speedup, val set 1.647x speedup, step: 5, train time 16.02 s
Epoch 14/50 |loss: 0.188912| train set 2.685x speedup, test set 2.180x speedup, val set 2.056x speedup, step: 1, train time 15.93 s
Epoch 15/50 |loss: 0.178944| train set 2.750x speedup, test set 2.327x speedup, val set 2.056x speedup, step: 2, train time 16.00 s
Epoch 16/50 |loss: 0.171269| train set 2.776x speedup, test set 2.235x speedup, val set 1.012x speedup, step: 3, train time 16.10 s
Epoch 17/50 |loss: 0.165670| train set 2.720x speedup, test set 2.206x speedup, val set 1.163x speedup, step: 4, train time 16.03 s
Epoch 18/50 |loss: 0.161817| train set 2.529x speedup, test set 2.366x speedup, val set 1.058x speedup, step: 5, train time 15.85 s
Epoch 19/50 |loss: 0.165607| train set 2.745x speedup, test set 2.203x speedup, val set 1.648x speedup, step: 6, train time 16.02 s
Epoch 20/50 |loss: 0.162673| train set 2.677x speedup, test set 2.199x speedup, val set 1.050x speedup, step: 7, train time 15.99 s
Epoch 21/50 |loss: 0.156631| train set 2.647x speedup, test set 2.263x speedup, val set 1.158x speedup, step: 8, train time 16.11 s
Epoch 22/50 |loss: 0.154036| train set 2.559x speedup, test set 2.408x speedup, val set 1.159x speedup, step: 9, train time 16.12 s
Epoch 23/50 |loss: 0.145860| train set 2.740x speedup, test set 2.312x speedup, val set 1.154x speedup, step: 10, train time 16.12 s
Epoch 24/50 |loss: 0.145207| train set 2.628x speedup, test set 2.139x speedup, val set 1.152x speedup, step: 11, train time 16.02 s
Epoch 25/50 |loss: 0.146678| train set 2.830x speedup, test set 2.249x speedup, val set 1.148x speedup, step: 12, train time 16.20 s
Epoch 26/50 |loss: 0.144513| train set 2.777x speedup, test set 2.294x speedup, val set 1.211x speedup, step: 13, train time 16.15 s
Epoch 27/50 |loss: 0.135310| train set 2.761x speedup, test set 2.260x speedup, val set 1.148x speedup, step: 14, train time 16.11 s
Epoch 28/50 |loss: 0.136767| train set 2.675x speedup, test set 2.203x speedup, val set 1.204x speedup, step: 15, train time 16.12 s
Epoch 29/50 |loss: 0.130922| train set 2.809x speedup, test set 2.247x speedup, val set 1.159x speedup, step: 16, train time 15.93 s
Epoch 30/50 |loss: 0.135105| train set 2.776x speedup, test set 2.258x speedup, val set 1.148x speedup, step: 17, train time 16.10 s
Epoch 31/50 |loss: 0.131510| train set 2.811x speedup, test set 2.284x speedup, val set 1.010x speedup, step: 18, train time 16.03 s
Epoch 32/50 |loss: 0.125994| train set 2.740x speedup, test set 2.251x speedup, val set 1.007x speedup, step: 19, train time 16.00 s
Epoch 33/50 |loss: 0.127222| train set 2.804x speedup, test set 2.312x speedup, val set 1.204x speedup, step: 20, train time 16.03 s
Epoch 34/50 |loss: 0.129154| train set 2.755x speedup, test set 2.304x speedup, val set 1.148x speedup, step: 21, train time 15.94 s
Epoch 35/50 |loss: 0.127678| train set 2.801x speedup, test set 2.401x speedup, val set 1.010x speedup, step: 22, train time 15.91 s
Epoch 36/50 |loss: 0.125365| train set 2.786x speedup, test set 2.270x speedup, val set 2.042x speedup, step: 23, train time 16.10 s
Epoch 37/50 |loss: 0.120903| train set 2.786x speedup, test set 2.284x speedup, val set 1.148x speedup, step: 24, train time 16.13 s
Epoch 38/50 |loss: 0.120911| train set 2.776x speedup, test set 1.308x speedup, val set 1.146x speedup, step: 25, train time 16.12 s
Epoch 39/50 |loss: 0.116179| train set 2.709x speedup, test set 2.295x speedup, val set 1.148x speedup, step: 26, train time 16.06 s
Epoch 40/50 |loss: 0.116538| train set 2.841x speedup, test set 2.383x speedup, val set 1.007x speedup, step: 27, train time 15.91 s
Epoch 41/50 |loss: 0.113363| train set 2.790x speedup, test set 1.550x speedup, val set 1.148x speedup, step: 28, train time 15.72 s
Epoch 42/50 |loss: 0.114683| train set 2.838x speedup, test set 2.383x speedup, val set 2.041x speedup, step: 29, train time 15.97 s
Epoch 43/50 |loss: 0.118197| train set 2.822x speedup, test set 1.336x speedup, val set 1.152x speedup, step: 30, train time 16.14 s
Epoch 44/50 |loss: 0.119867| train set 2.857x speedup, test set 2.229x speedup, val set 1.148x speedup, step: 31, train time 16.12 s
Epoch 45/50 |loss: 0.116131| train set 2.743x speedup, test set 2.261x speedup, val set 1.204x speedup, step: 32, train time 16.31 s
Epoch 46/50 |loss: 0.112018| train set 2.831x speedup, test set 2.321x speedup, val set 1.152x speedup, step: 33, train time 16.31 s
Epoch 47/50 |loss: 0.113702| train set 2.840x speedup, test set 2.287x speedup, val set 1.148x speedup, step: 34, train time 16.40 s
Epoch 48/50 |loss: 0.108612| train set 2.693x speedup, test set 2.346x speedup, val set 1.148x speedup, step: 35, train time 16.13 s
Epoch 49/50 |loss: 0.103526| train set 2.821x speedup, test set 2.268x speedup, val set 1.007x speedup, step: 36, train time 15.93 s
Training per epoch cost 16.132 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 85.447s, pg runtime 85.447s, speedup 1.000x
12, opt runtime 25.043s, model runtime 73.019s, pg runtime 73.019s, speedup 1.000x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.360s, pg runtime 1.214s, speedup 0.892x
20, opt runtime 1.353s, model runtime 1.610s, pg runtime 1.380s, speedup 0.858x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 11.757s, pg runtime 32.969s, speedup 2.804x
24, opt runtime 5.961s, model runtime 11.448s, pg runtime 31.210s, speedup 2.726x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 44, train speedup 2.857, test speedup 2.229, val speedup 1.148
best test speedup epoch: 1, train speedup 2.098, test speedup 2.609, val speedup 1.456
best validation speedup epoch: 14, train speedup 2.685, test speedup 2.180, val speedup 2.056
last model at epoch 49, train speedup 2.821, test speedup 2.268, val speedup 1.007
execution cost 0:14:46.503825
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.332627, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455247| train set 1.130x speedup, test set 2.425x speedup, val set 1.034x speedup, step: 1, train time 18.45 s
Epoch 1/50 |loss: 0.365878| train set 2.218x speedup, test set 2.377x speedup, val set 1.738x speedup, step: 2, train time 16.10 s
Epoch 2/50 |loss: 0.330361| train set 2.236x speedup, test set 0.874x speedup, val set 1.001x speedup, step: 3, train time 15.93 s
Epoch 3/50 |loss: 0.304759| train set 2.242x speedup, test set 1.424x speedup, val set 1.009x speedup, step: 4, train time 16.61 s
Epoch 4/50 |loss: 0.273376| train set 2.464x speedup, test set 1.595x speedup, val set 1.010x speedup, step: 1, train time 15.82 s
Epoch 5/50 |loss: 0.262021| train set 2.471x speedup, test set 0.909x speedup, val set 1.001x speedup, step: 2, train time 15.81 s
Epoch 6/50 |loss: 0.241407| train set 2.205x speedup, test set 0.989x speedup, val set 0.926x speedup, step: 3, train time 16.03 s
Epoch 7/50 |loss: 0.237193| train set 2.626x speedup, test set 1.369x speedup, val set 1.666x speedup, step: 4, train time 15.93 s
Epoch 8/50 |loss: 0.225104| train set 2.633x speedup, test set 1.525x speedup, val set 0.893x speedup, step: 5, train time 15.75 s
Epoch 9/50 |loss: 0.219785| train set 2.454x speedup, test set 0.991x speedup, val set 1.010x speedup, step: 1, train time 15.83 s
Epoch 10/50 |loss: 0.214796| train set 2.576x speedup, test set 1.559x speedup, val set 1.643x speedup, step: 2, train time 15.80 s
Epoch 11/50 |loss: 0.209434| train set 2.712x speedup, test set 1.552x speedup, val set 2.063x speedup, step: 3, train time 15.83 s
Epoch 12/50 |loss: 0.204592| train set 2.656x speedup, test set 1.335x speedup, val set 1.043x speedup, step: 4, train time 15.94 s
Epoch 13/50 |loss: 0.196002| train set 2.710x speedup, test set 1.502x speedup, val set 1.644x speedup, step: 5, train time 15.92 s
Epoch 14/50 |loss: 0.189679| train set 2.509x speedup, test set 2.121x speedup, val set 1.639x speedup, step: 1, train time 15.92 s
Epoch 15/50 |loss: 0.182408| train set 2.761x speedup, test set 1.494x speedup, val set 1.010x speedup, step: 2, train time 15.88 s
Epoch 16/50 |loss: 0.171622| train set 2.543x speedup, test set 2.257x speedup, val set 1.010x speedup, step: 3, train time 15.90 s
Epoch 17/50 |loss: 0.168095| train set 2.687x speedup, test set 1.269x speedup, val set 1.008x speedup, step: 4, train time 15.84 s
Epoch 18/50 |loss: 0.161759| train set 2.747x speedup, test set 1.314x speedup, val set 1.008x speedup, step: 5, train time 15.85 s
Epoch 19/50 |loss: 0.169517| train set 2.517x speedup, test set 1.459x speedup, val set 1.012x speedup, step: 6, train time 15.92 s
Epoch 20/50 |loss: 0.162860| train set 2.663x speedup, test set 1.274x speedup, val set 0.945x speedup, step: 7, train time 16.02 s
Epoch 21/50 |loss: 0.156653| train set 2.764x speedup, test set 2.279x speedup, val set 1.643x speedup, step: 8, train time 15.82 s
Epoch 22/50 |loss: 0.157871| train set 2.762x speedup, test set 1.268x speedup, val set 1.010x speedup, step: 9, train time 15.94 s
Epoch 23/50 |loss: 0.146444| train set 2.665x speedup, test set 2.102x speedup, val set 1.010x speedup, step: 10, train time 15.93 s
Epoch 24/50 |loss: 0.149246| train set 2.520x speedup, test set 1.285x speedup, val set 1.010x speedup, step: 11, train time 15.93 s
Epoch 25/50 |loss: 0.147896| train set 2.771x speedup, test set 2.248x speedup, val set 1.010x speedup, step: 12, train time 16.10 s
Epoch 26/50 |loss: 0.144307| train set 2.753x speedup, test set 0.978x speedup, val set 1.049x speedup, step: 13, train time 15.93 s
Epoch 27/50 |loss: 0.137492| train set 2.750x speedup, test set 2.070x speedup, val set 1.012x speedup, step: 14, train time 15.93 s
Epoch 28/50 |loss: 0.137175| train set 2.712x speedup, test set 2.217x speedup, val set 1.012x speedup, step: 15, train time 16.04 s
Epoch 29/50 |loss: 0.131202| train set 2.821x speedup, test set 1.192x speedup, val set 1.005x speedup, step: 16, train time 15.92 s
Epoch 30/50 |loss: 0.139370| train set 2.789x speedup, test set 1.242x speedup, val set 1.012x speedup, step: 17, train time 15.94 s
Epoch 31/50 |loss: 0.134471| train set 2.747x speedup, test set 2.213x speedup, val set 1.009x speedup, step: 18, train time 15.85 s
Epoch 32/50 |loss: 0.124663| train set 2.612x speedup, test set 0.997x speedup, val set 1.048x speedup, step: 19, train time 16.12 s
Epoch 33/50 |loss: 0.126911| train set 2.803x speedup, test set 1.232x speedup, val set 1.012x speedup, step: 20, train time 15.74 s
Epoch 34/50 |loss: 0.126897| train set 2.806x speedup, test set 2.133x speedup, val set 1.007x speedup, step: 21, train time 15.44 s
Epoch 35/50 |loss: 0.125674| train set 2.821x speedup, test set 2.382x speedup, val set 0.978x speedup, step: 22, train time 15.42 s
Epoch 36/50 |loss: 0.130988| train set 2.684x speedup, test set 1.438x speedup, val set 1.050x speedup, step: 23, train time 15.41 s
Epoch 37/50 |loss: 0.122823| train set 2.781x speedup, test set 1.538x speedup, val set 1.005x speedup, step: 24, train time 15.43 s
Epoch 38/50 |loss: 0.120599| train set 2.779x speedup, test set 2.092x speedup, val set 1.008x speedup, step: 25, train time 15.53 s
Epoch 39/50 |loss: 0.121020| train set 2.808x speedup, test set 1.219x speedup, val set 0.937x speedup, step: 26, train time 15.42 s
Epoch 40/50 |loss: 0.117941| train set 2.658x speedup, test set 2.165x speedup, val set 1.005x speedup, step: 27, train time 15.59 s
Epoch 41/50 |loss: 0.113722| train set 2.820x speedup, test set 2.290x speedup, val set 1.049x speedup, step: 28, train time 15.72 s
Epoch 42/50 |loss: 0.116159| train set 2.866x speedup, test set 2.366x speedup, val set 1.007x speedup, step: 29, train time 15.49 s
Epoch 43/50 |loss: 0.116870| train set 2.737x speedup, test set 1.282x speedup, val set 1.001x speedup, step: 30, train time 15.61 s
Epoch 44/50 |loss: 0.123380| train set 2.867x speedup, test set 2.175x speedup, val set 1.010x speedup, step: 31, train time 15.82 s
Epoch 45/50 |loss: 0.115598| train set 2.784x speedup, test set 2.195x speedup, val set 1.049x speedup, step: 32, train time 15.61 s
Epoch 46/50 |loss: 0.111195| train set 2.752x speedup, test set 2.157x speedup, val set 1.005x speedup, step: 33, train time 15.54 s
Epoch 47/50 |loss: 0.117153| train set 2.766x speedup, test set 2.309x speedup, val set 1.005x speedup, step: 34, train time 15.52 s
Epoch 48/50 |loss: 0.110646| train set 2.801x speedup, test set 1.275x speedup, val set 0.978x speedup, step: 35, train time 15.62 s
Epoch 49/50 |loss: 0.109940| train set 2.809x speedup, test set 1.246x speedup, val set 1.050x speedup, step: 36, train time 15.53 s
Training per epoch cost 15.859 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 49.702s, pg runtime 32.278s, speedup 0.649x
06, opt runtime 21.143s, model runtime 55.527s, pg runtime 21.143s, speedup 0.381x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.214s, pg runtime 1.214s, speedup 1.000x
20, opt runtime 1.353s, model runtime 1.380s, pg runtime 1.380s, speedup 1.000x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 44, train speedup 2.867, test speedup 2.175, val speedup 1.010
best test speedup epoch: 0, train speedup 1.130, test speedup 2.425, val speedup 1.034
best validation speedup epoch: 14, train speedup 2.509, test speedup 2.121, val speedup 1.639
last model at epoch 49, train speedup 2.809, test speedup 1.246, val speedup 1.050
execution cost 0:14:29.649838
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.058524, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455070| train set 1.120x speedup, test set 1.649x speedup, val set 1.026x speedup, step: 1, train time 18.79 s
Epoch 1/50 |loss: 0.368439| train set 1.952x speedup, test set 2.770x speedup, val set 0.977x speedup, step: 2, train time 16.40 s
Epoch 2/50 |loss: 0.331519| train set 2.199x speedup, test set 0.951x speedup, val set 1.009x speedup, step: 3, train time 16.32 s
Epoch 3/50 |loss: 0.308735| train set 2.352x speedup, test set 1.220x speedup, val set 0.893x speedup, step: 4, train time 16.65 s
Epoch 4/50 |loss: 0.273317| train set 2.284x speedup, test set 1.546x speedup, val set 1.010x speedup, step: 1, train time 16.41 s
Epoch 5/50 |loss: 0.264366| train set 2.443x speedup, test set 2.195x speedup, val set 1.010x speedup, step: 2, train time 16.11 s
Epoch 6/50 |loss: 0.243768| train set 2.299x speedup, test set 2.200x speedup, val set 1.053x speedup, step: 3, train time 16.31 s
Epoch 7/50 |loss: 0.241329| train set 2.578x speedup, test set 1.313x speedup, val set 1.011x speedup, step: 4, train time 16.20 s
Epoch 8/50 |loss: 0.225305| train set 2.435x speedup, test set 1.266x speedup, val set 1.642x speedup, step: 5, train time 16.04 s
Epoch 9/50 |loss: 0.218340| train set 2.385x speedup, test set 1.369x speedup, val set 0.865x speedup, step: 6, train time 16.21 s
Epoch 10/50 |loss: 0.217274| train set 2.433x speedup, test set 1.307x speedup, val set 0.866x speedup, step: 7, train time 16.12 s
Epoch 11/50 |loss: 0.212405| train set 2.726x speedup, test set 1.307x speedup, val set 1.648x speedup, step: 8, train time 16.12 s
Epoch 12/50 |loss: 0.203001| train set 2.679x speedup, test set 1.331x speedup, val set 1.211x speedup, step: 9, train time 16.03 s
Epoch 13/50 |loss: 0.195282| train set 2.657x speedup, test set 1.335x speedup, val set 1.648x speedup, step: 10, train time 16.11 s
Epoch 14/50 |loss: 0.191901| train set 2.777x speedup, test set 1.268x speedup, val set 1.010x speedup, step: 1, train time 16.34 s
Epoch 15/50 |loss: 0.186177| train set 2.777x speedup, test set 1.337x speedup, val set 1.643x speedup, step: 2, train time 16.21 s
Epoch 16/50 |loss: 0.175564| train set 2.565x speedup, test set 1.368x speedup, val set 1.648x speedup, step: 3, train time 16.16 s
Epoch 17/50 |loss: 0.167789| train set 2.694x speedup, test set 1.369x speedup, val set 1.163x speedup, step: 4, train time 16.02 s
Epoch 18/50 |loss: 0.167214| train set 2.616x speedup, test set 1.333x speedup, val set 1.011x speedup, step: 5, train time 16.21 s
Epoch 19/50 |loss: 0.171942| train set 2.787x speedup, test set 1.383x speedup, val set 1.648x speedup, step: 1, train time 16.31 s
Epoch 20/50 |loss: 0.169050| train set 2.719x speedup, test set 1.394x speedup, val set 1.055x speedup, step: 2, train time 16.30 s
Epoch 21/50 |loss: 0.160843| train set 2.792x speedup, test set 1.383x speedup, val set 1.018x speedup, step: 3, train time 16.33 s
Epoch 22/50 |loss: 0.162722| train set 2.752x speedup, test set 0.943x speedup, val set 1.055x speedup, step: 4, train time 16.34 s
Epoch 23/50 |loss: 0.149699| train set 2.751x speedup, test set 1.394x speedup, val set 1.012x speedup, step: 5, train time 16.22 s
Epoch 24/50 |loss: 0.154920| train set 2.730x speedup, test set 0.952x speedup, val set 1.018x speedup, step: 6, train time 16.45 s
Epoch 25/50 |loss: 0.150119| train set 2.804x speedup, test set 1.392x speedup, val set 1.012x speedup, step: 7, train time 16.24 s
Epoch 26/50 |loss: 0.146216| train set 2.730x speedup, test set 1.335x speedup, val set 1.211x speedup, step: 8, train time 16.30 s
Epoch 27/50 |loss: 0.142764| train set 2.740x speedup, test set 1.319x speedup, val set 1.012x speedup, step: 9, train time 16.32 s
Epoch 28/50 |loss: 0.142078| train set 2.728x speedup, test set 1.379x speedup, val set 1.055x speedup, step: 10, train time 16.42 s
Epoch 29/50 |loss: 0.135446| train set 2.810x speedup, test set 1.335x speedup, val set 1.012x speedup, step: 11, train time 16.34 s
Epoch 30/50 |loss: 0.139767| train set 2.801x speedup, test set 1.343x speedup, val set 1.012x speedup, step: 12, train time 16.13 s
Epoch 31/50 |loss: 0.140236| train set 2.796x speedup, test set 1.342x speedup, val set 1.012x speedup, step: 13, train time 16.50 s
Epoch 32/50 |loss: 0.129821| train set 2.741x speedup, test set 1.385x speedup, val set 1.055x speedup, step: 14, train time 16.30 s
Epoch 33/50 |loss: 0.130177| train set 2.818x speedup, test set 1.339x speedup, val set 1.012x speedup, step: 15, train time 16.24 s
Epoch 34/50 |loss: 0.130025| train set 2.769x speedup, test set 1.326x speedup, val set 1.648x speedup, step: 1, train time 16.31 s
Epoch 35/50 |loss: 0.132585| train set 2.765x speedup, test set 1.394x speedup, val set 1.648x speedup, step: 2, train time 16.21 s
Epoch 36/50 |loss: 0.127866| train set 2.751x speedup, test set 1.321x speedup, val set 1.643x speedup, step: 3, train time 16.34 s
Epoch 37/50 |loss: 0.122916| train set 2.761x speedup, test set 1.335x speedup, val set 1.012x speedup, step: 4, train time 15.85 s
Epoch 38/50 |loss: 0.122326| train set 2.817x speedup, test set 0.929x speedup, val set 1.012x speedup, step: 5, train time 16.12 s
Epoch 39/50 |loss: 0.124401| train set 2.599x speedup, test set 1.285x speedup, val set 1.055x speedup, step: 6, train time 16.12 s
Epoch 40/50 |loss: 0.119371| train set 2.709x speedup, test set 1.343x speedup, val set 1.648x speedup, step: 7, train time 16.13 s
Epoch 41/50 |loss: 0.119699| train set 2.746x speedup, test set 1.394x speedup, val set 2.091x speedup, step: 8, train time 16.11 s
Epoch 42/50 |loss: 0.119568| train set 2.732x speedup, test set 2.155x speedup, val set 1.148x speedup, step: 9, train time 16.33 s
Epoch 43/50 |loss: 0.119322| train set 2.781x speedup, test set 1.326x speedup, val set 1.208x speedup, step: 10, train time 16.22 s
Epoch 44/50 |loss: 0.123409| train set 2.805x speedup, test set 1.326x speedup, val set 1.055x speedup, step: 11, train time 16.23 s
Epoch 45/50 |loss: 0.115947| train set 2.759x speedup, test set 1.326x speedup, val set 1.202x speedup, step: 12, train time 16.41 s
Epoch 46/50 |loss: 0.110246| train set 2.829x speedup, test set 2.153x speedup, val set 1.018x speedup, step: 13, train time 16.31 s
Epoch 47/50 |loss: 0.115723| train set 2.835x speedup, test set 2.118x speedup, val set 1.012x speedup, step: 14, train time 16.33 s
Epoch 48/50 |loss: 0.112323| train set 2.751x speedup, test set 1.326x speedup, val set 1.204x speedup, step: 15, train time 16.38 s
Epoch 49/50 |loss: 0.109500| train set 2.820x speedup, test set 2.154x speedup, val set 1.648x speedup, step: 1, train time 16.44 s
Training per epoch cost 16.306 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.403s, pg runtime 1.214s, speedup 0.865x
20, opt runtime 1.353s, model runtime 1.540s, pg runtime 1.380s, speedup 0.896x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
32, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
33, opt runtime 38.718s, model runtime 44.369s, pg runtime 69.421s, speedup 1.565x
34, opt runtime 35.527s, model runtime 47.936s, pg runtime 71.730s, speedup 1.496x
35, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
36, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 47, train speedup 2.835, test speedup 2.118, val speedup 1.012
best test speedup epoch: 1, train speedup 1.952, test speedup 2.770, val speedup 0.977
best validation speedup epoch: 49, train speedup 2.820, test speedup 2.154, val speedup 1.648
last model at epoch 49, train speedup 2.820, test speedup 2.154, val speedup 1.648
execution cost 0:14:56.892117
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.235628, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455734| train set 1.124x speedup, test set 1.302x speedup, val set 1.034x speedup, step: 1, train time 18.99 s
Epoch 1/50 |loss: 0.366967| train set 2.004x speedup, test set 2.373x speedup, val set 1.045x speedup, step: 2, train time 16.44 s
Epoch 2/50 |loss: 0.334890| train set 2.359x speedup, test set 2.182x speedup, val set 1.045x speedup, step: 3, train time 16.33 s
Epoch 3/50 |loss: 0.304121| train set 2.243x speedup, test set 1.278x speedup, val set 1.009x speedup, step: 4, train time 17.10 s
Epoch 4/50 |loss: 0.273083| train set 2.265x speedup, test set 1.328x speedup, val set 1.055x speedup, step: 1, train time 16.32 s
Epoch 5/50 |loss: 0.263363| train set 2.344x speedup, test set 0.911x speedup, val set 1.053x speedup, step: 2, train time 16.22 s
Epoch 6/50 |loss: 0.243260| train set 2.293x speedup, test set 2.165x speedup, val set 1.053x speedup, step: 3, train time 16.33 s
Epoch 7/50 |loss: 0.239216| train set 2.660x speedup, test set 1.344x speedup, val set 1.010x speedup, step: 4, train time 16.12 s
Epoch 8/50 |loss: 0.227392| train set 2.653x speedup, test set 1.285x speedup, val set 0.927x speedup, step: 5, train time 16.20 s
Epoch 9/50 |loss: 0.217373| train set 2.635x speedup, test set 1.022x speedup, val set 1.647x speedup, step: 1, train time 16.31 s
Epoch 10/50 |loss: 0.214810| train set 2.673x speedup, test set 1.087x speedup, val set 1.664x speedup, step: 2, train time 16.29 s
Epoch 11/50 |loss: 0.208733| train set 2.737x speedup, test set 2.449x speedup, val set 1.011x speedup, step: 3, train time 16.23 s
Epoch 12/50 |loss: 0.202559| train set 2.689x speedup, test set 2.450x speedup, val set 1.045x speedup, step: 4, train time 16.23 s
Epoch 13/50 |loss: 0.191109| train set 2.670x speedup, test set 1.277x speedup, val set 1.151x speedup, step: 5, train time 16.20 s
Epoch 14/50 |loss: 0.187526| train set 2.704x speedup, test set 1.909x speedup, val set 1.010x speedup, step: 6, train time 16.13 s
Epoch 15/50 |loss: 0.182276| train set 2.758x speedup, test set 2.233x speedup, val set 1.010x speedup, step: 7, train time 16.31 s
Epoch 16/50 |loss: 0.174057| train set 2.764x speedup, test set 2.352x speedup, val set 1.012x speedup, step: 8, train time 16.43 s
Epoch 17/50 |loss: 0.168264| train set 2.703x speedup, test set 2.033x speedup, val set 1.163x speedup, step: 9, train time 16.30 s
Epoch 18/50 |loss: 0.164973| train set 2.724x speedup, test set 1.275x speedup, val set 1.049x speedup, step: 10, train time 16.12 s
Epoch 19/50 |loss: 0.163004| train set 2.732x speedup, test set 2.277x speedup, val set 1.648x speedup, step: 1, train time 16.30 s
Epoch 20/50 |loss: 0.160437| train set 2.673x speedup, test set 2.207x speedup, val set 1.050x speedup, step: 2, train time 16.19 s
Epoch 21/50 |loss: 0.160546| train set 2.800x speedup, test set 2.424x speedup, val set 1.018x speedup, step: 3, train time 16.25 s
Epoch 22/50 |loss: 0.156566| train set 2.741x speedup, test set 2.216x speedup, val set 1.624x speedup, step: 4, train time 16.31 s
Epoch 23/50 |loss: 0.146843| train set 2.558x speedup, test set 2.154x speedup, val set 1.048x speedup, step: 5, train time 16.35 s
Epoch 24/50 |loss: 0.147531| train set 2.670x speedup, test set 1.293x speedup, val set 1.010x speedup, step: 6, train time 16.11 s
Epoch 25/50 |loss: 0.149171| train set 2.824x speedup, test set 2.442x speedup, val set 1.048x speedup, step: 7, train time 16.23 s
Epoch 26/50 |loss: 0.143278| train set 2.787x speedup, test set 2.268x speedup, val set 1.007x speedup, step: 8, train time 16.32 s
Epoch 27/50 |loss: 0.135902| train set 2.739x speedup, test set 2.020x speedup, val set 1.148x speedup, step: 9, train time 16.13 s
Epoch 28/50 |loss: 0.137961| train set 2.740x speedup, test set 2.342x speedup, val set 1.055x speedup, step: 10, train time 16.31 s
Epoch 29/50 |loss: 0.129911| train set 2.805x speedup, test set 2.109x speedup, val set 1.050x speedup, step: 11, train time 16.12 s
Epoch 30/50 |loss: 0.136887| train set 2.823x speedup, test set 2.125x speedup, val set 1.050x speedup, step: 12, train time 16.31 s
Epoch 31/50 |loss: 0.130030| train set 2.785x speedup, test set 2.446x speedup, val set 1.048x speedup, step: 13, train time 16.20 s
Epoch 32/50 |loss: 0.128120| train set 2.647x speedup, test set 1.328x speedup, val set 1.050x speedup, step: 14, train time 15.82 s
Epoch 33/50 |loss: 0.128912| train set 2.824x speedup, test set 1.328x speedup, val set 1.097x speedup, step: 15, train time 16.03 s
Epoch 34/50 |loss: 0.128617| train set 2.836x speedup, test set 2.109x speedup, val set 1.010x speedup, step: 16, train time 15.91 s
Epoch 35/50 |loss: 0.125295| train set 2.768x speedup, test set 2.473x speedup, val set 1.050x speedup, step: 17, train time 16.10 s
Epoch 36/50 |loss: 0.126124| train set 2.747x speedup, test set 1.323x speedup, val set 1.007x speedup, step: 18, train time 15.94 s
Epoch 37/50 |loss: 0.121690| train set 2.834x speedup, test set 1.338x speedup, val set 1.007x speedup, step: 19, train time 16.12 s
Epoch 38/50 |loss: 0.118088| train set 2.844x speedup, test set 2.429x speedup, val set 1.007x speedup, step: 20, train time 15.92 s
Epoch 39/50 |loss: 0.118820| train set 2.816x speedup, test set 2.269x speedup, val set 1.005x speedup, step: 21, train time 16.03 s
Epoch 40/50 |loss: 0.114421| train set 2.840x speedup, test set 2.477x speedup, val set 1.007x speedup, step: 22, train time 16.13 s
Epoch 41/50 |loss: 0.112927| train set 2.830x speedup, test set 2.473x speedup, val set 1.156x speedup, step: 23, train time 16.12 s
Epoch 42/50 |loss: 0.118826| train set 2.823x speedup, test set 2.567x speedup, val set 1.007x speedup, step: 24, train time 16.15 s
Epoch 43/50 |loss: 0.113898| train set 2.822x speedup, test set 2.311x speedup, val set 1.050x speedup, step: 25, train time 15.96 s
Epoch 44/50 |loss: 0.117856| train set 2.749x speedup, test set 2.336x speedup, val set 1.010x speedup, step: 26, train time 16.34 s
Epoch 45/50 |loss: 0.117260| train set 2.734x speedup, test set 2.442x speedup, val set 1.007x speedup, step: 27, train time 16.32 s
Epoch 46/50 |loss: 0.111044| train set 2.737x speedup, test set 2.473x speedup, val set 1.010x speedup, step: 28, train time 16.21 s
Epoch 47/50 |loss: 0.114473| train set 2.830x speedup, test set 2.446x speedup, val set 1.005x speedup, step: 29, train time 16.30 s
Epoch 48/50 |loss: 0.108818| train set 2.759x speedup, test set 1.338x speedup, val set 1.007x speedup, step: 30, train time 16.42 s
Epoch 49/50 |loss: 0.107040| train set 2.816x speedup, test set 2.382x speedup, val set 1.050x speedup, step: 31, train time 16.51 s
Training per epoch cost 16.281 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 85.447s, pg runtime 85.447s, speedup 1.000x
12, opt runtime 25.043s, model runtime 73.019s, pg runtime 73.019s, speedup 1.000x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.214s, pg runtime 1.214s, speedup 1.000x
20, opt runtime 1.353s, model runtime 1.380s, pg runtime 1.380s, speedup 1.000x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
36, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
37, opt runtime 11.120s, model runtime 52.165s, pg runtime 11.120s, speedup 0.213x
38, opt runtime 18.262s, model runtime 47.388s, pg runtime 18.262s, speedup 0.385x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 38, train speedup 2.844, test speedup 2.429, val speedup 1.007
best test speedup epoch: 42, train speedup 2.823, test speedup 2.567, val speedup 1.007
best validation speedup epoch: 19, train speedup 2.732, test speedup 2.277, val speedup 1.648
last model at epoch 49, train speedup 2.816, test speedup 2.382, val speedup 1.050
execution cost 0:14:54.314424
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.851058, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455493| train set 1.103x speedup, test set 1.368x speedup, val set 1.034x speedup, step: 1, train time 18.63 s
Epoch 1/50 |loss: 0.366161| train set 1.854x speedup, test set 2.652x speedup, val set 0.977x speedup, step: 2, train time 16.42 s
Epoch 2/50 |loss: 0.330007| train set 2.288x speedup, test set 1.377x speedup, val set 1.003x speedup, step: 3, train time 16.43 s
Epoch 3/50 |loss: 0.304795| train set 2.097x speedup, test set 1.205x speedup, val set 1.045x speedup, step: 4, train time 17.02 s
Epoch 4/50 |loss: 0.274080| train set 2.628x speedup, test set 1.382x speedup, val set 1.010x speedup, step: 1, train time 16.22 s
Epoch 5/50 |loss: 0.258300| train set 2.348x speedup, test set 0.912x speedup, val set 1.010x speedup, step: 2, train time 16.42 s
Epoch 6/50 |loss: 0.242267| train set 2.219x speedup, test set 1.290x speedup, val set 1.209x speedup, step: 3, train time 16.22 s
Epoch 7/50 |loss: 0.238985| train set 2.577x speedup, test set 2.422x speedup, val set 1.648x speedup, step: 4, train time 16.21 s
Epoch 8/50 |loss: 0.229280| train set 2.592x speedup, test set 1.283x speedup, val set 1.142x speedup, step: 5, train time 16.23 s
Epoch 9/50 |loss: 0.221806| train set 2.357x speedup, test set 0.917x speedup, val set 1.001x speedup, step: 6, train time 16.12 s
Epoch 10/50 |loss: 0.218984| train set 2.506x speedup, test set 1.254x speedup, val set 2.092x speedup, step: 7, train time 16.32 s
Epoch 11/50 |loss: 0.210954| train set 2.737x speedup, test set 1.276x speedup, val set 2.053x speedup, step: 8, train time 16.13 s
Epoch 12/50 |loss: 0.200289| train set 2.418x speedup, test set 0.920x speedup, val set 1.045x speedup, step: 9, train time 16.30 s
Epoch 13/50 |loss: 0.195018| train set 2.743x speedup, test set 1.284x speedup, val set 1.647x speedup, step: 10, train time 16.23 s
Epoch 14/50 |loss: 0.190922| train set 2.720x speedup, test set 2.264x speedup, val set 1.643x speedup, step: 1, train time 16.22 s
Epoch 15/50 |loss: 0.188380| train set 2.709x speedup, test set 2.182x speedup, val set 1.643x speedup, step: 2, train time 16.13 s
Epoch 16/50 |loss: 0.176063| train set 2.763x speedup, test set 2.159x speedup, val set 1.003x speedup, step: 3, train time 16.22 s
Epoch 17/50 |loss: 0.166508| train set 2.698x speedup, test set 2.272x speedup, val set 2.091x speedup, step: 4, train time 16.22 s
Epoch 18/50 |loss: 0.164533| train set 2.716x speedup, test set 1.351x speedup, val set 1.213x speedup, step: 5, train time 16.41 s
Epoch 19/50 |loss: 0.169847| train set 2.718x speedup, test set 0.919x speedup, val set 1.154x speedup, step: 6, train time 16.23 s
Epoch 20/50 |loss: 0.170344| train set 2.666x speedup, test set 2.204x speedup, val set 1.211x speedup, step: 7, train time 16.40 s
Epoch 21/50 |loss: 0.157205| train set 2.704x speedup, test set 2.095x speedup, val set 1.151x speedup, step: 8, train time 16.31 s
Epoch 22/50 |loss: 0.157282| train set 2.619x speedup, test set 2.057x speedup, val set 2.063x speedup, step: 9, train time 16.49 s
Epoch 23/50 |loss: 0.146824| train set 2.639x speedup, test set 2.142x speedup, val set 1.053x speedup, step: 10, train time 16.32 s
Epoch 24/50 |loss: 0.150206| train set 2.721x speedup, test set 0.887x speedup, val set 1.158x speedup, step: 11, train time 16.40 s
Epoch 25/50 |loss: 0.147513| train set 2.839x speedup, test set 1.236x speedup, val set 1.154x speedup, step: 12, train time 16.41 s
Epoch 26/50 |loss: 0.146986| train set 2.755x speedup, test set 1.285x speedup, val set 1.158x speedup, step: 13, train time 16.31 s
Epoch 27/50 |loss: 0.140714| train set 2.710x speedup, test set 1.960x speedup, val set 1.154x speedup, step: 14, train time 15.83 s
Epoch 28/50 |loss: 0.140192| train set 2.744x speedup, test set 2.232x speedup, val set 1.011x speedup, step: 15, train time 16.02 s
Epoch 29/50 |loss: 0.131730| train set 2.826x speedup, test set 1.304x speedup, val set 2.063x speedup, step: 1, train time 16.21 s
Epoch 30/50 |loss: 0.137583| train set 2.788x speedup, test set 2.270x speedup, val set 1.154x speedup, step: 2, train time 16.11 s
Epoch 31/50 |loss: 0.133971| train set 2.775x speedup, test set 2.270x speedup, val set 1.010x speedup, step: 3, train time 16.13 s
Epoch 32/50 |loss: 0.127277| train set 2.730x speedup, test set 0.881x speedup, val set 1.050x speedup, step: 4, train time 16.10 s
Epoch 33/50 |loss: 0.133035| train set 2.771x speedup, test set 2.127x speedup, val set 1.211x speedup, step: 5, train time 16.33 s
Epoch 34/50 |loss: 0.128281| train set 2.728x speedup, test set 2.061x speedup, val set 2.063x speedup, step: 1, train time 16.31 s
Epoch 35/50 |loss: 0.127347| train set 2.789x speedup, test set 0.907x speedup, val set 1.648x speedup, step: 2, train time 16.20 s
Epoch 36/50 |loss: 0.128888| train set 2.783x speedup, test set 1.324x speedup, val set 1.643x speedup, step: 3, train time 16.15 s
Epoch 37/50 |loss: 0.120694| train set 2.832x speedup, test set 2.113x speedup, val set 1.154x speedup, step: 4, train time 16.16 s
Epoch 38/50 |loss: 0.122474| train set 2.785x speedup, test set 2.229x speedup, val set 1.648x speedup, step: 5, train time 16.14 s
Epoch 39/50 |loss: 0.120287| train set 2.817x speedup, test set 2.207x speedup, val set 1.211x speedup, step: 6, train time 16.34 s
Epoch 40/50 |loss: 0.118190| train set 2.841x speedup, test set 2.081x speedup, val set 1.012x speedup, step: 7, train time 16.12 s
Epoch 41/50 |loss: 0.116507| train set 2.760x speedup, test set 1.156x speedup, val set 1.012x speedup, step: 8, train time 16.21 s
Epoch 42/50 |loss: 0.116884| train set 2.866x speedup, test set 2.149x speedup, val set 1.012x speedup, step: 9, train time 16.22 s
Epoch 43/50 |loss: 0.117392| train set 2.842x speedup, test set 2.232x speedup, val set 1.053x speedup, step: 10, train time 16.12 s
Epoch 44/50 |loss: 0.121037| train set 2.820x speedup, test set 1.008x speedup, val set 1.012x speedup, step: 11, train time 16.31 s
Epoch 45/50 |loss: 0.114193| train set 2.752x speedup, test set 2.075x speedup, val set 1.055x speedup, step: 12, train time 16.13 s
Epoch 46/50 |loss: 0.112052| train set 2.805x speedup, test set 2.229x speedup, val set 1.012x speedup, step: 13, train time 16.22 s
Epoch 47/50 |loss: 0.121559| train set 2.823x speedup, test set 2.211x speedup, val set 1.012x speedup, step: 14, train time 16.43 s
Epoch 48/50 |loss: 0.111584| train set 2.655x speedup, test set 2.047x speedup, val set 1.012x speedup, step: 15, train time 16.16 s
Epoch 49/50 |loss: 0.108739| train set 2.794x speedup, test set 2.288x speedup, val set 1.012x speedup, step: 16, train time 16.51 s
Training per epoch cost 16.309 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 39.889s, pg runtime 16.134s, speedup 0.404x
08, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 5.961s, model runtime 11.695s, pg runtime 31.210s, speedup 2.669x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.404s, model runtime 1.404s, pg runtime 1.404s, speedup 1.000x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
36, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 42, train speedup 2.866, test speedup 2.149, val speedup 1.012
best test speedup epoch: 1, train speedup 1.854, test speedup 2.652, val speedup 0.977
best validation speedup epoch: 34, train speedup 2.728, test speedup 2.061, val speedup 2.063
last model at epoch 49, train speedup 2.794, test speedup 2.288, val speedup 1.012
execution cost 0:14:57.352489
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.139670, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454448| train set 1.104x speedup, test set 2.264x speedup, val set 1.034x speedup, step: 1, train time 18.61 s
Epoch 1/50 |loss: 0.366050| train set 2.068x speedup, test set 2.349x speedup, val set 0.974x speedup, step: 2, train time 15.92 s
Epoch 2/50 |loss: 0.330155| train set 2.270x speedup, test set 2.491x speedup, val set 1.003x speedup, step: 3, train time 15.82 s
Epoch 3/50 |loss: 0.301961| train set 2.444x speedup, test set 1.229x speedup, val set 1.002x speedup, step: 4, train time 16.55 s
Epoch 4/50 |loss: 0.270903| train set 2.375x speedup, test set 1.342x speedup, val set 1.055x speedup, step: 1, train time 15.92 s
Epoch 5/50 |loss: 0.260080| train set 2.395x speedup, test set 1.533x speedup, val set 1.002x speedup, step: 2, train time 16.01 s
Epoch 6/50 |loss: 0.241801| train set 2.235x speedup, test set 1.511x speedup, val set 1.051x speedup, step: 3, train time 15.89 s
Epoch 7/50 |loss: 0.235038| train set 2.774x speedup, test set 2.305x speedup, val set 1.623x speedup, step: 4, train time 15.83 s
Epoch 8/50 |loss: 0.223979| train set 2.431x speedup, test set 1.429x speedup, val set 0.893x speedup, step: 5, train time 15.75 s
Epoch 9/50 |loss: 0.218058| train set 2.695x speedup, test set 1.455x speedup, val set 1.012x speedup, step: 6, train time 15.80 s
Epoch 10/50 |loss: 0.210623| train set 2.552x speedup, test set 1.675x speedup, val set 1.010x speedup, step: 7, train time 15.74 s
Epoch 11/50 |loss: 0.205110| train set 2.739x speedup, test set 2.404x speedup, val set 1.624x speedup, step: 8, train time 16.01 s
Epoch 12/50 |loss: 0.199793| train set 2.492x speedup, test set 1.370x speedup, val set 1.055x speedup, step: 9, train time 15.99 s
Epoch 13/50 |loss: 0.189607| train set 2.701x speedup, test set 1.553x speedup, val set 1.018x speedup, step: 10, train time 15.92 s
Epoch 14/50 |loss: 0.185385| train set 2.594x speedup, test set 2.209x speedup, val set 1.010x speedup, step: 11, train time 15.86 s
Epoch 15/50 |loss: 0.181128| train set 2.731x speedup, test set 1.495x speedup, val set 1.048x speedup, step: 12, train time 16.11 s
Epoch 16/50 |loss: 0.172972| train set 2.755x speedup, test set 1.460x speedup, val set 1.012x speedup, step: 13, train time 16.02 s
Epoch 17/50 |loss: 0.161739| train set 2.716x speedup, test set 1.503x speedup, val set 1.018x speedup, step: 14, train time 15.94 s
Epoch 18/50 |loss: 0.164110| train set 2.716x speedup, test set 1.543x speedup, val set 1.008x speedup, step: 15, train time 15.93 s
Epoch 19/50 |loss: 0.161718| train set 2.711x speedup, test set 1.543x speedup, val set 1.635x speedup, step: 1, train time 15.93 s
Epoch 20/50 |loss: 0.163030| train set 2.665x speedup, test set 1.471x speedup, val set 1.055x speedup, step: 2, train time 15.93 s
Epoch 21/50 |loss: 0.154803| train set 2.708x speedup, test set 1.433x speedup, val set 1.013x speedup, step: 3, train time 15.92 s
Epoch 22/50 |loss: 0.153013| train set 2.400x speedup, test set 2.035x speedup, val set 1.053x speedup, step: 4, train time 16.02 s
Epoch 23/50 |loss: 0.145080| train set 2.666x speedup, test set 1.322x speedup, val set 1.005x speedup, step: 5, train time 16.13 s
Epoch 24/50 |loss: 0.150724| train set 2.581x speedup, test set 1.471x speedup, val set 1.017x speedup, step: 6, train time 15.83 s
Epoch 25/50 |loss: 0.148708| train set 2.796x speedup, test set 1.544x speedup, val set 1.007x speedup, step: 7, train time 16.31 s
Epoch 26/50 |loss: 0.142971| train set 2.532x speedup, test set 1.455x speedup, val set 1.095x speedup, step: 8, train time 16.04 s
Epoch 27/50 |loss: 0.139270| train set 2.750x speedup, test set 2.294x speedup, val set 1.012x speedup, step: 9, train time 16.21 s
Epoch 28/50 |loss: 0.139090| train set 2.742x speedup, test set 1.544x speedup, val set 1.055x speedup, step: 10, train time 16.23 s
Epoch 29/50 |loss: 0.132820| train set 2.834x speedup, test set 1.514x speedup, val set 1.007x speedup, step: 11, train time 16.20 s
Epoch 30/50 |loss: 0.137202| train set 2.790x speedup, test set 1.313x speedup, val set 1.007x speedup, step: 12, train time 16.14 s
Epoch 31/50 |loss: 0.136452| train set 2.772x speedup, test set 1.514x speedup, val set 1.005x speedup, step: 13, train time 16.21 s
Epoch 32/50 |loss: 0.127493| train set 2.762x speedup, test set 1.556x speedup, val set 1.050x speedup, step: 14, train time 16.31 s
Epoch 33/50 |loss: 0.127425| train set 2.769x speedup, test set 1.534x speedup, val set 1.097x speedup, step: 15, train time 16.22 s
Epoch 34/50 |loss: 0.132598| train set 2.754x speedup, test set 1.307x speedup, val set 1.007x speedup, step: 16, train time 16.20 s
Epoch 35/50 |loss: 0.130292| train set 2.774x speedup, test set 1.328x speedup, val set 0.978x speedup, step: 17, train time 16.15 s
Epoch 36/50 |loss: 0.128260| train set 2.762x speedup, test set 1.557x speedup, val set 1.048x speedup, step: 18, train time 16.32 s
Epoch 37/50 |loss: 0.122306| train set 2.787x speedup, test set 1.526x speedup, val set 1.007x speedup, step: 19, train time 16.51 s
Epoch 38/50 |loss: 0.123652| train set 2.789x speedup, test set 1.330x speedup, val set 1.005x speedup, step: 20, train time 16.40 s
Epoch 39/50 |loss: 0.126076| train set 2.707x speedup, test set 1.555x speedup, val set 0.977x speedup, step: 21, train time 16.40 s
Epoch 40/50 |loss: 0.116045| train set 2.840x speedup, test set 1.330x speedup, val set 1.007x speedup, step: 22, train time 16.19 s
Epoch 41/50 |loss: 0.115868| train set 2.789x speedup, test set 1.526x speedup, val set 1.007x speedup, step: 23, train time 16.32 s
Epoch 42/50 |loss: 0.118173| train set 2.805x speedup, test set 2.298x speedup, val set 1.007x speedup, step: 24, train time 16.23 s
Epoch 43/50 |loss: 0.117465| train set 2.796x speedup, test set 1.320x speedup, val set 1.008x speedup, step: 25, train time 16.32 s
Epoch 44/50 |loss: 0.123234| train set 2.807x speedup, test set 2.284x speedup, val set 1.008x speedup, step: 26, train time 16.31 s
Epoch 45/50 |loss: 0.117103| train set 2.716x speedup, test set 1.555x speedup, val set 1.005x speedup, step: 27, train time 16.39 s
Epoch 46/50 |loss: 0.109971| train set 2.815x speedup, test set 2.253x speedup, val set 1.015x speedup, step: 28, train time 16.34 s
Epoch 47/50 |loss: 0.119243| train set 2.837x speedup, test set 2.306x speedup, val set 1.007x speedup, step: 29, train time 16.34 s
Epoch 48/50 |loss: 0.112187| train set 2.637x speedup, test set 1.329x speedup, val set 1.048x speedup, step: 30, train time 16.69 s
Epoch 49/50 |loss: 0.108299| train set 2.790x speedup, test set 1.329x speedup, val set 1.013x speedup, step: 31, train time 16.53 s
Training per epoch cost 16.178 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 39.889s, pg runtime 16.134s, speedup 0.404x
08, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 38.252s, pg runtime 23.223s, speedup 0.607x
18, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.757s, pg runtime 32.969s, speedup 2.804x
24, opt runtime 5.961s, model runtime 11.448s, pg runtime 31.210s, speedup 2.726x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.404s, model runtime 1.404s, pg runtime 1.404s, speedup 1.000x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 406.510s, pg runtime 651.942s, speedup 1.604x
36, opt runtime 16.639s, model runtime 335.627s, pg runtime 462.544s, speedup 1.378x
37, opt runtime 11.120s, model runtime 52.165s, pg runtime 11.120s, speedup 0.213x
38, opt runtime 18.262s, model runtime 47.388s, pg runtime 18.262s, speedup 0.385x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 40, train speedup 2.840, test speedup 1.330, val speedup 1.007
best test speedup epoch: 2, train speedup 2.270, test speedup 2.491, val speedup 1.003
best validation speedup epoch: 19, train speedup 2.711, test speedup 1.543, val speedup 1.635
last model at epoch 49, train speedup 2.790, test speedup 1.329, val speedup 1.013
execution cost 0:14:48.820689
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.153569, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455193| train set 1.136x speedup, test set 2.562x speedup, val set 0.986x speedup, step: 1, train time 18.78 s
Epoch 1/50 |loss: 0.369793| train set 1.773x speedup, test set 2.389x speedup, val set 0.979x speedup, step: 2, train time 16.32 s
Epoch 2/50 |loss: 0.333692| train set 1.980x speedup, test set 1.016x speedup, val set 1.045x speedup, step: 3, train time 16.52 s
Epoch 3/50 |loss: 0.304625| train set 2.062x speedup, test set 1.221x speedup, val set 1.045x speedup, step: 4, train time 17.22 s
Epoch 4/50 |loss: 0.275761| train set 2.407x speedup, test set 1.509x speedup, val set 1.002x speedup, step: 1, train time 16.21 s
Epoch 5/50 |loss: 0.263092| train set 2.466x speedup, test set 0.880x speedup, val set 1.001x speedup, step: 2, train time 16.20 s
Epoch 6/50 |loss: 0.243195| train set 2.383x speedup, test set 2.013x speedup, val set 1.106x speedup, step: 3, train time 16.13 s
Epoch 7/50 |loss: 0.237117| train set 2.745x speedup, test set 0.917x speedup, val set 1.154x speedup, step: 4, train time 16.22 s
Epoch 8/50 |loss: 0.226755| train set 2.588x speedup, test set 1.227x speedup, val set 1.152x speedup, step: 5, train time 16.21 s
Epoch 9/50 |loss: 0.220767| train set 2.567x speedup, test set 0.867x speedup, val set 1.053x speedup, step: 1, train time 16.20 s
Epoch 10/50 |loss: 0.214767| train set 2.519x speedup, test set 1.261x speedup, val set 1.158x speedup, step: 2, train time 16.12 s
Epoch 11/50 |loss: 0.209340| train set 2.737x speedup, test set 1.264x speedup, val set 2.062x speedup, step: 3, train time 16.14 s
Epoch 12/50 |loss: 0.203250| train set 2.633x speedup, test set 1.215x speedup, val set 1.211x speedup, step: 4, train time 15.82 s
Epoch 13/50 |loss: 0.194550| train set 2.695x speedup, test set 1.253x speedup, val set 2.089x speedup, step: 5, train time 15.94 s
Epoch 14/50 |loss: 0.189121| train set 2.676x speedup, test set 2.055x speedup, val set 2.056x speedup, step: 1, train time 15.94 s
Epoch 15/50 |loss: 0.185368| train set 2.746x speedup, test set 1.269x speedup, val set 1.208x speedup, step: 2, train time 16.02 s
Epoch 16/50 |loss: 0.173205| train set 2.765x speedup, test set 1.254x speedup, val set 1.154x speedup, step: 3, train time 16.12 s
Epoch 17/50 |loss: 0.166182| train set 2.754x speedup, test set 1.222x speedup, val set 1.163x speedup, step: 4, train time 16.11 s
Epoch 18/50 |loss: 0.165654| train set 2.544x speedup, test set 1.255x speedup, val set 1.051x speedup, step: 5, train time 15.95 s
Epoch 19/50 |loss: 0.171427| train set 2.730x speedup, test set 1.222x speedup, val set 2.251x speedup, step: 1, train time 16.23 s
Epoch 20/50 |loss: 0.170306| train set 2.642x speedup, test set 1.262x speedup, val set 1.204x speedup, step: 2, train time 16.12 s
Epoch 21/50 |loss: 0.163280| train set 2.727x speedup, test set 1.266x speedup, val set 1.154x speedup, step: 3, train time 16.04 s
Epoch 22/50 |loss: 0.156708| train set 2.741x speedup, test set 1.262x speedup, val set 1.154x speedup, step: 4, train time 16.12 s
Epoch 23/50 |loss: 0.144594| train set 2.751x speedup, test set 1.262x speedup, val set 1.005x speedup, step: 5, train time 16.33 s
Epoch 24/50 |loss: 0.147135| train set 2.515x speedup, test set 1.262x speedup, val set 1.052x speedup, step: 6, train time 16.32 s
Epoch 25/50 |loss: 0.149753| train set 2.803x speedup, test set 1.221x speedup, val set 1.148x speedup, step: 7, train time 16.30 s
Epoch 26/50 |loss: 0.145658| train set 2.530x speedup, test set 1.221x speedup, val set 1.204x speedup, step: 8, train time 16.00 s
Epoch 27/50 |loss: 0.137992| train set 2.701x speedup, test set 1.276x speedup, val set 1.148x speedup, step: 9, train time 16.04 s
Epoch 28/50 |loss: 0.136975| train set 2.756x speedup, test set 2.171x speedup, val set 1.204x speedup, step: 10, train time 16.22 s
Epoch 29/50 |loss: 0.133297| train set 2.801x speedup, test set 1.265x speedup, val set 2.043x speedup, step: 11, train time 16.02 s
Epoch 30/50 |loss: 0.135723| train set 2.789x speedup, test set 1.262x speedup, val set 1.148x speedup, step: 12, train time 16.21 s
Epoch 31/50 |loss: 0.134035| train set 2.782x speedup, test set 1.259x speedup, val set 1.148x speedup, step: 13, train time 16.21 s
Epoch 32/50 |loss: 0.126973| train set 2.736x speedup, test set 1.228x speedup, val set 1.204x speedup, step: 14, train time 16.40 s
Epoch 33/50 |loss: 0.130343| train set 2.811x speedup, test set 1.266x speedup, val set 1.204x speedup, step: 15, train time 16.35 s
Epoch 34/50 |loss: 0.128306| train set 2.789x speedup, test set 1.310x speedup, val set 1.148x speedup, step: 16, train time 16.40 s
Epoch 35/50 |loss: 0.127906| train set 2.774x speedup, test set 2.223x speedup, val set 1.635x speedup, step: 17, train time 16.32 s
Epoch 36/50 |loss: 0.127260| train set 2.761x speedup, test set 1.266x speedup, val set 1.204x speedup, step: 18, train time 16.40 s
Epoch 37/50 |loss: 0.120363| train set 2.788x speedup, test set 1.214x speedup, val set 1.148x speedup, step: 19, train time 16.43 s
Epoch 38/50 |loss: 0.118529| train set 2.793x speedup, test set 1.237x speedup, val set 1.146x speedup, step: 20, train time 16.34 s
Epoch 39/50 |loss: 0.118111| train set 2.599x speedup, test set 1.266x speedup, val set 1.204x speedup, step: 21, train time 16.32 s
Epoch 40/50 |loss: 0.118184| train set 2.842x speedup, test set 1.221x speedup, val set 1.148x speedup, step: 22, train time 16.52 s
Epoch 41/50 |loss: 0.114846| train set 2.785x speedup, test set 1.222x speedup, val set 1.148x speedup, step: 23, train time 16.42 s
Epoch 42/50 |loss: 0.113613| train set 2.830x speedup, test set 2.270x speedup, val set 2.043x speedup, step: 24, train time 16.51 s
Epoch 43/50 |loss: 0.113378| train set 2.838x speedup, test set 1.255x speedup, val set 1.204x speedup, step: 25, train time 16.23 s
Epoch 44/50 |loss: 0.116541| train set 2.832x speedup, test set 0.891x speedup, val set 1.048x speedup, step: 26, train time 16.42 s
Epoch 45/50 |loss: 0.115215| train set 2.730x speedup, test set 1.262x speedup, val set 1.209x speedup, step: 27, train time 16.44 s
Epoch 46/50 |loss: 0.109762| train set 2.816x speedup, test set 2.157x speedup, val set 1.148x speedup, step: 28, train time 16.32 s
Epoch 47/50 |loss: 0.112671| train set 2.795x speedup, test set 1.253x speedup, val set 1.148x speedup, step: 29, train time 16.33 s
Epoch 48/50 |loss: 0.110041| train set 2.778x speedup, test set 1.287x speedup, val set 1.148x speedup, step: 30, train time 16.24 s
Epoch 49/50 |loss: 0.105553| train set 2.790x speedup, test set 1.262x speedup, val set 1.007x speedup, step: 31, train time 16.41 s
Training per epoch cost 16.303 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 93.826s, pg runtime 92.131s, speedup 0.982x
04, opt runtime 29.502s, model runtime 110.289s, pg runtime 112.305s, speedup 1.018x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.634s, pg runtime 1.214s, speedup 0.743x
20, opt runtime 1.353s, model runtime 1.837s, pg runtime 1.380s, speedup 0.752x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.404s, model runtime 1.404s, pg runtime 1.404s, speedup 1.000x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 637.615s, pg runtime 651.942s, speedup 1.022x
36, opt runtime 16.639s, model runtime 576.339s, pg runtime 462.544s, speedup 0.803x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 40, train speedup 2.842, test speedup 1.221, val speedup 1.148
best test speedup epoch: 0, train speedup 1.136, test speedup 2.562, val speedup 0.986
best validation speedup epoch: 19, train speedup 2.730, test speedup 1.222, val speedup 2.251
last model at epoch 49, train speedup 2.790, test speedup 1.262, val speedup 1.007
execution cost 0:14:56.820724
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:01.236841, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454333| train set 1.102x speedup, test set 1.347x speedup, val set 1.034x speedup, step: 1, train time 18.68 s
Epoch 1/50 |loss: 0.367319| train set 2.053x speedup, test set 2.672x speedup, val set 1.555x speedup, step: 2, train time 15.90 s
Epoch 2/50 |loss: 0.331005| train set 2.123x speedup, test set 1.334x speedup, val set 1.002x speedup, step: 3, train time 15.91 s
Epoch 3/50 |loss: 0.303231| train set 2.259x speedup, test set 1.010x speedup, val set 1.009x speedup, step: 4, train time 16.83 s
Epoch 4/50 |loss: 0.272882| train set 2.594x speedup, test set 1.030x speedup, val set 1.010x speedup, step: 1, train time 16.11 s
Epoch 5/50 |loss: 0.261752| train set 2.195x speedup, test set 1.507x speedup, val set 1.049x speedup, step: 2, train time 15.80 s
Epoch 6/50 |loss: 0.240997| train set 2.381x speedup, test set 2.160x speedup, val set 1.051x speedup, step: 3, train time 15.93 s
Epoch 7/50 |loss: 0.236725| train set 2.553x speedup, test set 1.282x speedup, val set 1.011x speedup, step: 4, train time 15.82 s
Epoch 8/50 |loss: 0.222905| train set 2.587x speedup, test set 1.190x speedup, val set 1.010x speedup, step: 5, train time 15.95 s
Epoch 9/50 |loss: 0.216758| train set 2.668x speedup, test set 1.478x speedup, val set 1.006x speedup, step: 6, train time 15.84 s
Epoch 10/50 |loss: 0.213921| train set 2.669x speedup, test set 1.502x speedup, val set 1.136x speedup, step: 7, train time 15.92 s
Epoch 11/50 |loss: 0.210306| train set 2.723x speedup, test set 1.589x speedup, val set 2.062x speedup, step: 8, train time 16.13 s
Epoch 12/50 |loss: 0.199116| train set 2.731x speedup, test set 1.209x speedup, val set 1.055x speedup, step: 9, train time 15.95 s
Epoch 13/50 |loss: 0.189168| train set 2.691x speedup, test set 1.546x speedup, val set 2.062x speedup, step: 10, train time 16.10 s
Epoch 14/50 |loss: 0.190348| train set 2.690x speedup, test set 1.136x speedup, val set 2.056x speedup, step: 1, train time 16.00 s
Epoch 15/50 |loss: 0.184559| train set 2.760x speedup, test set 1.334x speedup, val set 1.010x speedup, step: 2, train time 16.11 s
Epoch 16/50 |loss: 0.172833| train set 2.793x speedup, test set 1.136x speedup, val set 1.012x speedup, step: 3, train time 16.48 s
Epoch 17/50 |loss: 0.164958| train set 2.601x speedup, test set 1.351x speedup, val set 1.151x speedup, step: 4, train time 16.30 s
Epoch 18/50 |loss: 0.161426| train set 2.722x speedup, test set 1.667x speedup, val set 1.206x speedup, step: 5, train time 16.35 s
Epoch 19/50 |loss: 0.165653| train set 2.736x speedup, test set 1.506x speedup, val set 2.043x speedup, step: 6, train time 16.40 s
Epoch 20/50 |loss: 0.164373| train set 2.667x speedup, test set 1.256x speedup, val set 1.209x speedup, step: 7, train time 16.32 s
Epoch 21/50 |loss: 0.158924| train set 2.789x speedup, test set 1.164x speedup, val set 1.148x speedup, step: 8, train time 16.33 s
Epoch 22/50 |loss: 0.157800| train set 2.733x speedup, test set 1.181x speedup, val set 2.056x speedup, step: 9, train time 16.20 s
Epoch 23/50 |loss: 0.146837| train set 2.734x speedup, test set 2.200x speedup, val set 1.008x speedup, step: 10, train time 16.30 s
Epoch 24/50 |loss: 0.152541| train set 2.708x speedup, test set 1.534x speedup, val set 1.152x speedup, step: 11, train time 16.22 s
Epoch 25/50 |loss: 0.147189| train set 2.800x speedup, test set 1.256x speedup, val set 1.148x speedup, step: 12, train time 16.33 s
Epoch 26/50 |loss: 0.143929| train set 2.786x speedup, test set 1.454x speedup, val set 1.148x speedup, step: 13, train time 16.20 s
Epoch 27/50 |loss: 0.138635| train set 2.745x speedup, test set 1.868x speedup, val set 1.148x speedup, step: 14, train time 15.81 s
Epoch 28/50 |loss: 0.139247| train set 2.760x speedup, test set 1.513x speedup, val set 2.227x speedup, step: 15, train time 15.85 s
Epoch 29/50 |loss: 0.131099| train set 2.803x speedup, test set 2.159x speedup, val set 1.148x speedup, step: 16, train time 15.81 s
Epoch 30/50 |loss: 0.138014| train set 2.775x speedup, test set 1.477x speedup, val set 1.148x speedup, step: 17, train time 16.13 s
Epoch 31/50 |loss: 0.135014| train set 2.775x speedup, test set 1.456x speedup, val set 1.146x speedup, step: 18, train time 16.24 s
Epoch 32/50 |loss: 0.128928| train set 2.790x speedup, test set 1.447x speedup, val set 1.148x speedup, step: 19, train time 16.30 s
Epoch 33/50 |loss: 0.127344| train set 2.795x speedup, test set 1.457x speedup, val set 1.188x speedup, step: 20, train time 16.23 s
Epoch 34/50 |loss: 0.128348| train set 2.794x speedup, test set 1.860x speedup, val set 1.133x speedup, step: 21, train time 16.33 s
Epoch 35/50 |loss: 0.127122| train set 2.809x speedup, test set 2.246x speedup, val set 1.204x speedup, step: 22, train time 16.25 s
Epoch 36/50 |loss: 0.132602| train set 2.785x speedup, test set 1.888x speedup, val set 1.148x speedup, step: 23, train time 16.15 s
Epoch 37/50 |loss: 0.123719| train set 2.841x speedup, test set 1.442x speedup, val set 2.043x speedup, step: 24, train time 16.22 s
Epoch 38/50 |loss: 0.122484| train set 2.793x speedup, test set 2.214x speedup, val set 1.150x speedup, step: 25, train time 16.25 s
Epoch 39/50 |loss: 0.117272| train set 2.840x speedup, test set 2.174x speedup, val set 1.146x speedup, step: 26, train time 16.30 s
Epoch 40/50 |loss: 0.117609| train set 2.840x speedup, test set 2.151x speedup, val set 1.148x speedup, step: 27, train time 16.25 s
Epoch 41/50 |loss: 0.118329| train set 2.788x speedup, test set 1.468x speedup, val set 1.148x speedup, step: 28, train time 16.33 s
Epoch 42/50 |loss: 0.120667| train set 2.850x speedup, test set 2.217x speedup, val set 1.148x speedup, step: 29, train time 16.22 s
Epoch 43/50 |loss: 0.117011| train set 2.765x speedup, test set 2.118x speedup, val set 1.148x speedup, step: 30, train time 16.24 s
Epoch 44/50 |loss: 0.120554| train set 2.857x speedup, test set 2.099x speedup, val set 1.133x speedup, step: 31, train time 16.21 s
Epoch 45/50 |loss: 0.115597| train set 2.741x speedup, test set 2.124x speedup, val set 1.152x speedup, step: 32, train time 16.22 s
Epoch 46/50 |loss: 0.109918| train set 2.817x speedup, test set 2.138x speedup, val set 1.148x speedup, step: 33, train time 16.31 s
Epoch 47/50 |loss: 0.117261| train set 2.725x speedup, test set 2.155x speedup, val set 1.148x speedup, step: 34, train time 16.33 s
Epoch 48/50 |loss: 0.112637| train set 2.772x speedup, test set 2.067x speedup, val set 1.209x speedup, step: 35, train time 16.34 s
Epoch 49/50 |loss: 0.108231| train set 2.820x speedup, test set 2.127x speedup, val set 2.043x speedup, step: 36, train time 16.32 s
Training per epoch cost 16.221 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 93.826s, pg runtime 92.131s, speedup 0.982x
04, opt runtime 29.502s, model runtime 110.289s, pg runtime 112.305s, speedup 1.018x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 39.889s, pg runtime 16.134s, speedup 0.404x
08, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 153.196s, pg runtime 23.223s, speedup 0.152x
18, opt runtime 10.788s, model runtime 149.188s, pg runtime 32.939s, speedup 0.221x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 637.615s, pg runtime 651.942s, speedup 1.022x
36, opt runtime 16.639s, model runtime 576.339s, pg runtime 462.544s, speedup 0.803x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 44, train speedup 2.857, test speedup 2.099, val speedup 1.133
best test speedup epoch: 1, train speedup 2.053, test speedup 2.672, val speedup 1.555
best validation speedup epoch: 14, train speedup 2.690, test speedup 1.136, val speedup 2.056
last model at epoch 49, train speedup 2.820, test speedup 2.127, val speedup 2.043
execution cost 0:14:52.453561
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.729935, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454166| train set 1.086x speedup, test set 2.509x speedup, val set 1.034x speedup, step: 1, train time 10.59 s
Epoch 1/50 |loss: 0.367064| train set 1.969x speedup, test set 2.561x speedup, val set 0.973x speedup, step: 2, train time 9.41 s
Epoch 2/50 |loss: 0.330186| train set 2.262x speedup, test set 1.154x speedup, val set 1.009x speedup, step: 3, train time 9.22 s
Epoch 3/50 |loss: 0.302937| train set 2.201x speedup, test set 2.226x speedup, val set 1.002x speedup, step: 4, train time 9.90 s
Epoch 4/50 |loss: 0.269312| train set 2.160x speedup, test set 1.010x speedup, val set 1.053x speedup, step: 1, train time 9.12 s
Epoch 5/50 |loss: 0.258710| train set 2.481x speedup, test set 2.218x speedup, val set 1.001x speedup, step: 2, train time 8.98 s
Epoch 6/50 |loss: 0.245006| train set 2.466x speedup, test set 1.518x speedup, val set 1.051x speedup, step: 3, train time 9.29 s
Epoch 7/50 |loss: 0.235861| train set 2.647x speedup, test set 1.600x speedup, val set 1.647x speedup, step: 4, train time 8.99 s
Epoch 8/50 |loss: 0.226685| train set 2.521x speedup, test set 1.533x speedup, val set 1.760x speedup, step: 5, train time 9.10 s
Epoch 9/50 |loss: 0.219061| train set 2.535x speedup, test set 1.576x speedup, val set 1.053x speedup, step: 1, train time 8.91 s
Epoch 10/50 |loss: 0.216295| train set 2.606x speedup, test set 1.619x speedup, val set 1.648x speedup, step: 2, train time 8.91 s
Epoch 11/50 |loss: 0.211524| train set 2.747x speedup, test set 1.634x speedup, val set 1.647x speedup, step: 3, train time 9.10 s
Epoch 12/50 |loss: 0.205445| train set 2.668x speedup, test set 2.425x speedup, val set 1.055x speedup, step: 4, train time 9.30 s
Epoch 13/50 |loss: 0.195491| train set 2.644x speedup, test set 1.669x speedup, val set 1.648x speedup, step: 5, train time 9.20 s
Epoch 14/50 |loss: 0.191000| train set 2.706x speedup, test set 2.251x speedup, val set 1.643x speedup, step: 1, train time 9.11 s
Epoch 15/50 |loss: 0.186846| train set 2.777x speedup, test set 1.601x speedup, val set 1.050x speedup, step: 2, train time 9.40 s
Epoch 16/50 |loss: 0.174504| train set 2.755x speedup, test set 1.668x speedup, val set 1.012x speedup, step: 3, train time 8.92 s
Epoch 17/50 |loss: 0.166911| train set 2.681x speedup, test set 1.533x speedup, val set 1.665x speedup, step: 4, train time 9.30 s
Epoch 18/50 |loss: 0.165367| train set 2.718x speedup, test set 1.606x speedup, val set 1.012x speedup, step: 5, train time 9.30 s
Epoch 19/50 |loss: 0.170085| train set 2.794x speedup, test set 1.523x speedup, val set 1.648x speedup, step: 1, train time 9.13 s
Epoch 20/50 |loss: 0.167396| train set 2.538x speedup, test set 1.593x speedup, val set 1.055x speedup, step: 2, train time 9.12 s
Epoch 21/50 |loss: 0.159955| train set 2.748x speedup, test set 1.608x speedup, val set 1.012x speedup, step: 3, train time 9.10 s
Epoch 22/50 |loss: 0.157744| train set 2.827x speedup, test set 1.675x speedup, val set 1.648x speedup, step: 4, train time 9.53 s
Epoch 23/50 |loss: 0.149483| train set 2.753x speedup, test set 1.500x speedup, val set 1.050x speedup, step: 5, train time 9.50 s
Epoch 24/50 |loss: 0.151021| train set 2.607x speedup, test set 1.526x speedup, val set 1.009x speedup, step: 6, train time 9.20 s
Epoch 25/50 |loss: 0.152863| train set 2.775x speedup, test set 1.491x speedup, val set 1.007x speedup, step: 7, train time 9.22 s
Epoch 26/50 |loss: 0.145201| train set 2.775x speedup, test set 1.533x speedup, val set 1.048x speedup, step: 8, train time 8.94 s
Epoch 27/50 |loss: 0.140044| train set 2.712x speedup, test set 1.588x speedup, val set 1.012x speedup, step: 9, train time 9.21 s
Epoch 28/50 |loss: 0.140851| train set 2.728x speedup, test set 1.494x speedup, val set 1.635x speedup, step: 10, train time 9.19 s
Epoch 29/50 |loss: 0.132542| train set 2.809x speedup, test set 1.573x speedup, val set 1.753x speedup, step: 1, train time 9.30 s
Epoch 30/50 |loss: 0.141612| train set 2.795x speedup, test set 1.466x speedup, val set 1.049x speedup, step: 2, train time 9.42 s
Epoch 31/50 |loss: 0.135258| train set 2.786x speedup, test set 2.218x speedup, val set 1.048x speedup, step: 3, train time 9.51 s
Epoch 32/50 |loss: 0.129652| train set 2.738x speedup, test set 1.483x speedup, val set 1.053x speedup, step: 4, train time 9.12 s
Epoch 33/50 |loss: 0.132589| train set 2.804x speedup, test set 1.525x speedup, val set 1.635x speedup, step: 5, train time 9.21 s
Epoch 34/50 |loss: 0.133999| train set 2.751x speedup, test set 1.502x speedup, val set 1.010x speedup, step: 6, train time 9.21 s
Epoch 35/50 |loss: 0.127188| train set 2.777x speedup, test set 1.512x speedup, val set 1.648x speedup, step: 7, train time 8.91 s
Epoch 36/50 |loss: 0.128702| train set 2.786x speedup, test set 1.502x speedup, val set 1.648x speedup, step: 8, train time 9.08 s
Epoch 37/50 |loss: 0.121809| train set 2.835x speedup, test set 1.536x speedup, val set 1.007x speedup, step: 9, train time 9.10 s
Epoch 38/50 |loss: 0.122711| train set 2.836x speedup, test set 2.175x speedup, val set 1.626x speedup, step: 10, train time 9.00 s
Epoch 39/50 |loss: 0.123186| train set 2.835x speedup, test set 2.237x speedup, val set 1.053x speedup, step: 11, train time 9.10 s
Epoch 40/50 |loss: 0.118023| train set 2.770x speedup, test set 1.544x speedup, val set 1.635x speedup, step: 12, train time 9.10 s
Epoch 41/50 |loss: 0.116020| train set 2.811x speedup, test set 1.483x speedup, val set 1.007x speedup, step: 13, train time 9.02 s
Epoch 42/50 |loss: 0.120766| train set 2.857x speedup, test set 1.576x speedup, val set 1.007x speedup, step: 14, train time 9.42 s
Epoch 43/50 |loss: 0.114943| train set 2.825x speedup, test set 2.191x speedup, val set 1.635x speedup, step: 15, train time 9.04 s
Epoch 44/50 |loss: 0.120870| train set 2.830x speedup, test set 1.544x speedup, val set 1.635x speedup, step: 16, train time 9.11 s
Epoch 45/50 |loss: 0.115884| train set 2.782x speedup, test set 2.259x speedup, val set 1.007x speedup, step: 17, train time 8.91 s
Epoch 46/50 |loss: 0.109721| train set 2.816x speedup, test set 2.239x speedup, val set 1.635x speedup, step: 18, train time 9.32 s
Epoch 47/50 |loss: 0.114386| train set 2.841x speedup, test set 2.311x speedup, val set 1.007x speedup, step: 19, train time 9.01 s
Epoch 48/50 |loss: 0.112570| train set 2.763x speedup, test set 2.253x speedup, val set 1.007x speedup, step: 20, train time 9.29 s
Epoch 49/50 |loss: 0.109005| train set 2.820x speedup, test set 2.191x speedup, val set 1.643x speedup, step: 21, train time 8.98 s
Training per epoch cost 9.207 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
18, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
19, opt runtime 1.148s, model runtime 1.310s, pg runtime 1.214s, speedup 0.926x
20, opt runtime 1.353s, model runtime 1.472s, pg runtime 1.380s, speedup 0.938x
21, opt runtime 22.482s, model runtime 29.334s, pg runtime 22.482s, speedup 0.766x
22, opt runtime 6.519s, model runtime 14.361s, pg runtime 6.519s, speedup 0.454x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 71.962s, pg runtime 69.421s, speedup 0.965x
34, opt runtime 35.527s, model runtime 62.822s, pg runtime 71.730s, speedup 1.142x
35, opt runtime 18.690s, model runtime 406.510s, pg runtime 651.942s, speedup 1.604x
36, opt runtime 16.639s, model runtime 335.627s, pg runtime 462.544s, speedup 1.378x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 42, train speedup 2.857, test speedup 1.576, val speedup 1.007
best test speedup epoch: 1, train speedup 1.969, test speedup 2.561, val speedup 0.973
best validation speedup epoch: 29, train speedup 2.809, test speedup 1.573, val speedup 1.753
last model at epoch 49, train speedup 2.820, test speedup 2.191, val speedup 1.643
execution cost 0:08:12.250659
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.720085, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.453887| train set 1.101x speedup, test set 2.544x speedup, val set 1.034x speedup, step: 1, train time 10.53 s
Epoch 1/50 |loss: 0.367225| train set 1.983x speedup, test set 2.464x speedup, val set 0.979x speedup, step: 2, train time 9.09 s
Epoch 2/50 |loss: 0.333732| train set 2.154x speedup, test set 0.868x speedup, val set 1.003x speedup, step: 3, train time 9.30 s
Epoch 3/50 |loss: 0.303241| train set 2.335x speedup, test set 1.036x speedup, val set 1.009x speedup, step: 4, train time 9.59 s
Epoch 4/50 |loss: 0.272838| train set 2.377x speedup, test set 1.007x speedup, val set 1.056x speedup, step: 1, train time 9.00 s
Epoch 5/50 |loss: 0.258954| train set 2.333x speedup, test set 1.275x speedup, val set 1.006x speedup, step: 2, train time 9.19 s
Epoch 6/50 |loss: 0.241356| train set 2.287x speedup, test set 0.876x speedup, val set 1.208x speedup, step: 3, train time 9.02 s
Epoch 7/50 |loss: 0.237048| train set 2.708x speedup, test set 2.268x speedup, val set 1.647x speedup, step: 4, train time 9.22 s
Epoch 8/50 |loss: 0.225788| train set 2.761x speedup, test set 1.307x speedup, val set 1.643x speedup, step: 5, train time 9.12 s
Epoch 9/50 |loss: 0.220414| train set 2.198x speedup, test set 0.927x speedup, val set 1.006x speedup, step: 6, train time 9.42 s
Epoch 10/50 |loss: 0.219005| train set 2.688x speedup, test set 1.454x speedup, val set 2.054x speedup, step: 7, train time 9.20 s
Epoch 11/50 |loss: 0.207006| train set 2.749x speedup, test set 0.913x speedup, val set 2.063x speedup, step: 8, train time 8.91 s
Epoch 12/50 |loss: 0.198835| train set 2.797x speedup, test set 2.120x speedup, val set 1.198x speedup, step: 9, train time 8.92 s
Epoch 13/50 |loss: 0.194714| train set 2.720x speedup, test set 0.916x speedup, val set 2.026x speedup, step: 10, train time 9.03 s
Epoch 14/50 |loss: 0.189059| train set 2.710x speedup, test set 2.290x speedup, val set 2.056x speedup, step: 1, train time 9.09 s
Epoch 15/50 |loss: 0.187342| train set 2.758x speedup, test set 2.390x speedup, val set 2.222x speedup, step: 2, train time 8.94 s
Epoch 16/50 |loss: 0.175783| train set 2.572x speedup, test set 1.252x speedup, val set 1.154x speedup, step: 3, train time 9.21 s
Epoch 17/50 |loss: 0.166246| train set 2.681x speedup, test set 1.335x speedup, val set 1.163x speedup, step: 4, train time 8.91 s
Epoch 18/50 |loss: 0.167070| train set 2.634x speedup, test set 2.300x speedup, val set 1.206x speedup, step: 5, train time 9.21 s
Epoch 19/50 |loss: 0.171790| train set 2.745x speedup, test set 2.228x speedup, val set 2.231x speedup, step: 1, train time 9.21 s
Epoch 20/50 |loss: 0.167020| train set 2.678x speedup, test set 0.890x speedup, val set 1.204x speedup, step: 2, train time 9.11 s
Epoch 21/50 |loss: 0.156411| train set 2.815x speedup, test set 0.909x speedup, val set 1.012x speedup, step: 3, train time 9.10 s
Epoch 22/50 |loss: 0.156172| train set 2.735x speedup, test set 1.329x speedup, val set 2.243x speedup, step: 4, train time 9.13 s
Epoch 23/50 |loss: 0.149965| train set 2.582x speedup, test set 0.922x speedup, val set 1.048x speedup, step: 5, train time 9.10 s
Epoch 24/50 |loss: 0.150006| train set 2.584x speedup, test set 1.265x speedup, val set 1.005x speedup, step: 6, train time 9.49 s
Epoch 25/50 |loss: 0.151872| train set 2.777x speedup, test set 2.187x speedup, val set 1.048x speedup, step: 7, train time 9.20 s
Epoch 26/50 |loss: 0.143563| train set 2.777x speedup, test set 1.248x speedup, val set 1.148x speedup, step: 8, train time 9.21 s
Epoch 27/50 |loss: 0.141038| train set 2.743x speedup, test set 0.887x speedup, val set 1.012x speedup, step: 9, train time 9.19 s
Epoch 28/50 |loss: 0.142028| train set 2.749x speedup, test set 2.355x speedup, val set 1.109x speedup, step: 10, train time 9.20 s
Epoch 29/50 |loss: 0.133299| train set 2.761x speedup, test set 1.262x speedup, val set 1.050x speedup, step: 11, train time 9.29 s
Epoch 30/50 |loss: 0.142195| train set 2.699x speedup, test set 0.882x speedup, val set 1.267x speedup, step: 12, train time 8.83 s
Epoch 31/50 |loss: 0.139524| train set 2.787x speedup, test set 1.248x speedup, val set 1.005x speedup, step: 13, train time 9.22 s
Epoch 32/50 |loss: 0.127034| train set 2.731x speedup, test set 0.882x speedup, val set 1.050x speedup, step: 14, train time 9.19 s
Epoch 33/50 |loss: 0.136028| train set 2.773x speedup, test set 1.430x speedup, val set 1.097x speedup, step: 15, train time 9.40 s
Epoch 34/50 |loss: 0.131885| train set 2.815x speedup, test set 1.264x speedup, val set 1.148x speedup, step: 16, train time 9.05 s
Epoch 35/50 |loss: 0.130406| train set 2.624x speedup, test set 0.909x speedup, val set 1.050x speedup, step: 17, train time 9.09 s
Epoch 36/50 |loss: 0.127729| train set 2.776x speedup, test set 1.250x speedup, val set 1.205x speedup, step: 18, train time 9.20 s
Epoch 37/50 |loss: 0.121946| train set 2.784x speedup, test set 0.879x speedup, val set 1.148x speedup, step: 19, train time 9.39 s
Epoch 38/50 |loss: 0.123513| train set 2.787x speedup, test set 1.272x speedup, val set 2.222x speedup, step: 20, train time 9.11 s
Epoch 39/50 |loss: 0.125093| train set 2.435x speedup, test set 1.221x speedup, val set 1.050x speedup, step: 21, train time 9.21 s
Epoch 40/50 |loss: 0.119232| train set 2.626x speedup, test set 0.970x speedup, val set 1.007x speedup, step: 22, train time 9.20 s
Epoch 41/50 |loss: 0.116744| train set 2.757x speedup, test set 1.218x speedup, val set 1.148x speedup, step: 23, train time 8.99 s
Epoch 42/50 |loss: 0.122123| train set 2.866x speedup, test set 2.299x speedup, val set 1.148x speedup, step: 24, train time 9.60 s
Epoch 43/50 |loss: 0.117509| train set 2.748x speedup, test set 1.278x speedup, val set 1.201x speedup, step: 25, train time 9.49 s
Epoch 44/50 |loss: 0.119257| train set 2.868x speedup, test set 0.857x speedup, val set 1.063x speedup, step: 26, train time 9.32 s
Epoch 45/50 |loss: 0.114919| train set 2.737x speedup, test set 1.228x speedup, val set 1.148x speedup, step: 27, train time 9.03 s
Epoch 46/50 |loss: 0.113246| train set 2.771x speedup, test set 1.257x speedup, val set 1.148x speedup, step: 28, train time 9.12 s
Epoch 47/50 |loss: 0.115143| train set 2.834x speedup, test set 0.887x speedup, val set 1.005x speedup, step: 29, train time 9.00 s
Epoch 48/50 |loss: 0.109689| train set 2.755x speedup, test set 0.863x speedup, val set 1.050x speedup, step: 30, train time 9.00 s
Epoch 49/50 |loss: 0.111688| train set 2.805x speedup, test set 1.237x speedup, val set 1.635x speedup, step: 31, train time 9.49 s
Training per epoch cost 9.201 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 39.889s, pg runtime 16.134s, speedup 0.404x
08, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 29.303s, pg runtime 22.482s, speedup 0.767x
22, opt runtime 6.519s, model runtime 44.915s, pg runtime 6.519s, speedup 0.145x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.404s, model runtime 1.404s, pg runtime 1.404s, speedup 1.000x
27, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
28, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
37, opt runtime 11.120s, model runtime 52.165s, pg runtime 11.120s, speedup 0.213x
38, opt runtime 18.262s, model runtime 47.388s, pg runtime 18.262s, speedup 0.385x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 44, train speedup 2.868, test speedup 0.857, val speedup 1.063
best test speedup epoch: 0, train speedup 1.101, test speedup 2.544, val speedup 1.034
best validation speedup epoch: 19, train speedup 2.745, test speedup 2.228, val speedup 2.231
last model at epoch 49, train speedup 2.805, test speedup 1.237, val speedup 1.635
execution cost 0:08:11.849607
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.713893, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455219| train set 1.139x speedup, test set 2.299x speedup, val set 1.026x speedup, step: 1, train time 10.34 s
Epoch 1/50 |loss: 0.367901| train set 1.967x speedup, test set 2.676x speedup, val set 0.977x speedup, step: 2, train time 9.29 s
Epoch 2/50 |loss: 0.332184| train set 2.149x speedup, test set 1.314x speedup, val set 0.998x speedup, step: 3, train time 8.81 s
Epoch 3/50 |loss: 0.305570| train set 2.420x speedup, test set 1.372x speedup, val set 1.009x speedup, step: 4, train time 9.72 s
Epoch 4/50 |loss: 0.274829| train set 2.486x speedup, test set 2.261x speedup, val set 1.045x speedup, step: 1, train time 9.11 s
Epoch 5/50 |loss: 0.265294| train set 2.310x speedup, test set 1.226x speedup, val set 1.051x speedup, step: 2, train time 9.31 s
Epoch 6/50 |loss: 0.246146| train set 2.183x speedup, test set 2.192x speedup, val set 1.051x speedup, step: 3, train time 9.21 s
Epoch 7/50 |loss: 0.240076| train set 2.732x speedup, test set 2.191x speedup, val set 1.643x speedup, step: 4, train time 8.93 s
Epoch 8/50 |loss: 0.232103| train set 2.611x speedup, test set 2.098x speedup, val set 1.053x speedup, step: 5, train time 9.44 s
Epoch 9/50 |loss: 0.222343| train set 2.450x speedup, test set 2.216x speedup, val set 0.896x speedup, step: 6, train time 9.41 s
Epoch 10/50 |loss: 0.218038| train set 2.572x speedup, test set 1.988x speedup, val set 1.665x speedup, step: 7, train time 9.18 s
Epoch 11/50 |loss: 0.213342| train set 2.749x speedup, test set 1.715x speedup, val set 1.648x speedup, step: 8, train time 9.10 s
Epoch 12/50 |loss: 0.206084| train set 2.633x speedup, test set 2.093x speedup, val set 1.059x speedup, step: 9, train time 9.12 s
Epoch 13/50 |loss: 0.193908| train set 2.712x speedup, test set 2.451x speedup, val set 2.091x speedup, step: 10, train time 9.39 s
Epoch 14/50 |loss: 0.193577| train set 2.772x speedup, test set 2.227x speedup, val set 1.643x speedup, step: 1, train time 9.10 s
Epoch 15/50 |loss: 0.186553| train set 2.732x speedup, test set 1.910x speedup, val set 1.648x speedup, step: 2, train time 9.61 s
Epoch 16/50 |loss: 0.176570| train set 2.762x speedup, test set 2.010x speedup, val set 1.641x speedup, step: 3, train time 9.30 s
Epoch 17/50 |loss: 0.167215| train set 2.709x speedup, test set 2.083x speedup, val set 1.641x speedup, step: 4, train time 9.32 s
Epoch 18/50 |loss: 0.167105| train set 2.724x speedup, test set 2.439x speedup, val set 1.055x speedup, step: 5, train time 9.42 s
Epoch 19/50 |loss: 0.168623| train set 2.754x speedup, test set 2.072x speedup, val set 1.648x speedup, step: 1, train time 9.29 s
Epoch 20/50 |loss: 0.169555| train set 2.585x speedup, test set 2.216x speedup, val set 1.053x speedup, step: 2, train time 9.29 s
Epoch 21/50 |loss: 0.159584| train set 2.804x speedup, test set 2.159x speedup, val set 1.012x speedup, step: 3, train time 9.93 s
Epoch 22/50 |loss: 0.156911| train set 2.727x speedup, test set 2.178x speedup, val set 1.624x speedup, step: 4, train time 9.69 s
Epoch 23/50 |loss: 0.147595| train set 2.649x speedup, test set 2.217x speedup, val set 1.053x speedup, step: 5, train time 9.32 s
Epoch 24/50 |loss: 0.153105| train set 2.348x speedup, test set 2.082x speedup, val set 1.050x speedup, step: 6, train time 9.09 s
Epoch 25/50 |loss: 0.152976| train set 2.719x speedup, test set 2.077x speedup, val set 1.053x speedup, step: 7, train time 9.09 s
Epoch 26/50 |loss: 0.145125| train set 2.791x speedup, test set 2.207x speedup, val set 1.053x speedup, step: 8, train time 9.20 s
Epoch 27/50 |loss: 0.140979| train set 2.746x speedup, test set 2.178x speedup, val set 1.012x speedup, step: 9, train time 8.92 s
Epoch 28/50 |loss: 0.140548| train set 2.763x speedup, test set 2.141x speedup, val set 1.648x speedup, step: 10, train time 9.30 s
Epoch 29/50 |loss: 0.132772| train set 2.809x speedup, test set 2.181x speedup, val set 1.648x speedup, step: 1, train time 9.19 s
Epoch 30/50 |loss: 0.137249| train set 2.814x speedup, test set 1.259x speedup, val set 1.648x speedup, step: 2, train time 8.99 s
Epoch 31/50 |loss: 0.135171| train set 2.739x speedup, test set 2.309x speedup, val set 0.866x speedup, step: 3, train time 9.20 s
Epoch 32/50 |loss: 0.125832| train set 2.613x speedup, test set 2.242x speedup, val set 1.050x speedup, step: 4, train time 9.06 s
Epoch 33/50 |loss: 0.130238| train set 2.806x speedup, test set 1.316x speedup, val set 1.648x speedup, step: 5, train time 9.02 s
Epoch 34/50 |loss: 0.124900| train set 2.765x speedup, test set 2.308x speedup, val set 1.635x speedup, step: 6, train time 9.32 s
Epoch 35/50 |loss: 0.129808| train set 2.845x speedup, test set 2.282x speedup, val set 1.766x speedup, step: 7, train time 9.10 s
Epoch 36/50 |loss: 0.127083| train set 2.783x speedup, test set 2.240x speedup, val set 1.753x speedup, step: 8, train time 9.12 s
Epoch 37/50 |loss: 0.120123| train set 2.780x speedup, test set 2.216x speedup, val set 1.648x speedup, step: 9, train time 9.12 s
Epoch 38/50 |loss: 0.119281| train set 2.785x speedup, test set 2.163x speedup, val set 1.748x speedup, step: 10, train time 9.22 s
Epoch 39/50 |loss: 0.121292| train set 2.663x speedup, test set 2.308x speedup, val set 1.050x speedup, step: 11, train time 9.29 s
Epoch 40/50 |loss: 0.118212| train set 2.841x speedup, test set 2.071x speedup, val set 1.648x speedup, step: 12, train time 8.83 s
Epoch 41/50 |loss: 0.112995| train set 2.791x speedup, test set 2.250x speedup, val set 1.647x speedup, step: 13, train time 9.09 s
Epoch 42/50 |loss: 0.114354| train set 2.866x speedup, test set 2.379x speedup, val set 1.635x speedup, step: 14, train time 9.19 s
Epoch 43/50 |loss: 0.112172| train set 2.756x speedup, test set 1.307x speedup, val set 1.766x speedup, step: 15, train time 9.19 s
Epoch 44/50 |loss: 0.114931| train set 2.805x speedup, test set 2.142x speedup, val set 1.635x speedup, step: 16, train time 9.31 s
Epoch 45/50 |loss: 0.115557| train set 2.778x speedup, test set 2.218x speedup, val set 1.751x speedup, step: 17, train time 9.10 s
Epoch 46/50 |loss: 0.110196| train set 2.817x speedup, test set 2.216x speedup, val set 1.635x speedup, step: 18, train time 9.22 s
Epoch 47/50 |loss: 0.114201| train set 2.805x speedup, test set 2.243x speedup, val set 1.635x speedup, step: 19, train time 9.11 s
Epoch 48/50 |loss: 0.106484| train set 2.678x speedup, test set 2.282x speedup, val set 1.050x speedup, step: 20, train time 9.41 s
Epoch 49/50 |loss: 0.104170| train set 2.846x speedup, test set 1.288x speedup, val set 1.648x speedup, step: 1, train time 9.30 s
Training per epoch cost 9.253 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 38.252s, pg runtime 23.223s, speedup 0.607x
18, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 22.482s, pg runtime 22.482s, speedup 1.000x
22, opt runtime 6.519s, model runtime 6.519s, pg runtime 6.519s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 5.961s, model runtime 11.695s, pg runtime 31.210s, speedup 2.669x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 10.662s, pg runtime 5.362s, speedup 0.503x
30, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
36, opt runtime 16.639s, model runtime 462.544s, pg runtime 462.544s, speedup 1.000x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 1.013s, pg runtime 0.912s, speedup 0.900x
40, opt runtime 0.873s, model runtime 1.074s, pg runtime 0.873s, speedup 0.812x
====================
best train speedup epoch: 42, train speedup 2.866, test speedup 2.379, val speedup 1.635
best test speedup epoch: 1, train speedup 1.967, test speedup 2.676, val speedup 0.977
best validation speedup epoch: 49, train speedup 2.846, test speedup 1.288, val speedup 1.648
last model at epoch 49, train speedup 2.846, test speedup 1.288, val speedup 1.648
execution cost 0:08:14.897169
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.724658, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454283| train set 1.104x speedup, test set 2.708x speedup, val set 1.029x speedup, step: 1, train time 10.37 s
Epoch 1/50 |loss: 0.366929| train set 1.963x speedup, test set 2.513x speedup, val set 0.977x speedup, step: 2, train time 9.00 s
Epoch 2/50 |loss: 0.335922| train set 2.222x speedup, test set 1.274x speedup, val set 1.012x speedup, step: 3, train time 9.00 s
Epoch 3/50 |loss: 0.306666| train set 2.262x speedup, test set 1.190x speedup, val set 1.009x speedup, step: 4, train time 9.50 s
Epoch 4/50 |loss: 0.274541| train set 2.242x speedup, test set 1.026x speedup, val set 1.053x speedup, step: 1, train time 8.80 s
Epoch 5/50 |loss: 0.263312| train set 2.136x speedup, test set 0.880x speedup, val set 1.048x speedup, step: 2, train time 9.08 s
Epoch 6/50 |loss: 0.244564| train set 2.449x speedup, test set 1.149x speedup, val set 1.208x speedup, step: 3, train time 9.41 s
Epoch 7/50 |loss: 0.238378| train set 2.668x speedup, test set 1.010x speedup, val set 1.154x speedup, step: 4, train time 8.91 s
Epoch 8/50 |loss: 0.226565| train set 2.592x speedup, test set 1.143x speedup, val set 1.638x speedup, step: 5, train time 9.09 s
Epoch 9/50 |loss: 0.220385| train set 2.602x speedup, test set 0.899x speedup, val set 1.055x speedup, step: 1, train time 9.00 s
Epoch 10/50 |loss: 0.216180| train set 2.560x speedup, test set 0.977x speedup, val set 1.647x speedup, step: 2, train time 9.08 s
Epoch 11/50 |loss: 0.213282| train set 2.599x speedup, test set 1.010x speedup, val set 2.062x speedup, step: 3, train time 8.91 s
Epoch 12/50 |loss: 0.205370| train set 2.543x speedup, test set 0.886x speedup, val set 1.055x speedup, step: 4, train time 9.40 s
Epoch 13/50 |loss: 0.194268| train set 2.789x speedup, test set 1.223x speedup, val set 2.062x speedup, step: 5, train time 9.01 s
Epoch 14/50 |loss: 0.188567| train set 2.768x speedup, test set 1.896x speedup, val set 2.056x speedup, step: 1, train time 9.10 s
Epoch 15/50 |loss: 0.185739| train set 2.783x speedup, test set 1.176x speedup, val set 1.152x speedup, step: 2, train time 9.19 s
Epoch 16/50 |loss: 0.176110| train set 2.767x speedup, test set 2.176x speedup, val set 1.012x speedup, step: 3, train time 9.11 s
Epoch 17/50 |loss: 0.168380| train set 2.698x speedup, test set 1.181x speedup, val set 1.163x speedup, step: 4, train time 9.03 s
Epoch 18/50 |loss: 0.165674| train set 2.666x speedup, test set 2.253x speedup, val set 1.158x speedup, step: 5, train time 8.82 s
Epoch 19/50 |loss: 0.167143| train set 2.727x speedup, test set 2.088x speedup, val set 1.648x speedup, step: 6, train time 9.08 s
Epoch 20/50 |loss: 0.171841| train set 2.496x speedup, test set 1.257x speedup, val set 1.059x speedup, step: 7, train time 9.21 s
Epoch 21/50 |loss: 0.159087| train set 2.766x speedup, test set 1.237x speedup, val set 2.062x speedup, step: 8, train time 8.90 s
Epoch 22/50 |loss: 0.156243| train set 2.723x speedup, test set 1.187x speedup, val set 1.158x speedup, step: 9, train time 9.19 s
Epoch 23/50 |loss: 0.148731| train set 2.661x speedup, test set 0.846x speedup, val set 1.053x speedup, step: 10, train time 9.13 s
Epoch 24/50 |loss: 0.152694| train set 2.618x speedup, test set 1.224x speedup, val set 2.062x speedup, step: 1, train time 9.00 s
Epoch 25/50 |loss: 0.155236| train set 2.725x speedup, test set 2.093x speedup, val set 1.152x speedup, step: 2, train time 9.11 s
Epoch 26/50 |loss: 0.145147| train set 2.781x speedup, test set 2.058x speedup, val set 1.152x speedup, step: 3, train time 8.91 s
Epoch 27/50 |loss: 0.145725| train set 2.739x speedup, test set 1.902x speedup, val set 1.011x speedup, step: 4, train time 9.11 s
Epoch 28/50 |loss: 0.142166| train set 2.744x speedup, test set 2.259x speedup, val set 1.055x speedup, step: 5, train time 9.10 s
Epoch 29/50 |loss: 0.135542| train set 2.775x speedup, test set 0.972x speedup, val set 2.062x speedup, step: 1, train time 9.01 s
Epoch 30/50 |loss: 0.141465| train set 2.779x speedup, test set 1.902x speedup, val set 1.015x speedup, step: 2, train time 9.31 s
Epoch 31/50 |loss: 0.138649| train set 2.802x speedup, test set 2.129x speedup, val set 1.001x speedup, step: 3, train time 9.11 s
Epoch 32/50 |loss: 0.132719| train set 2.661x speedup, test set 2.074x speedup, val set 1.053x speedup, step: 4, train time 9.00 s
Epoch 33/50 |loss: 0.130487| train set 2.806x speedup, test set 2.115x speedup, val set 1.011x speedup, step: 5, train time 9.32 s
Epoch 34/50 |loss: 0.133216| train set 2.757x speedup, test set 2.126x speedup, val set 1.010x speedup, step: 6, train time 9.51 s
Epoch 35/50 |loss: 0.129249| train set 2.790x speedup, test set 1.232x speedup, val set 1.059x speedup, step: 7, train time 9.09 s
Epoch 36/50 |loss: 0.130273| train set 2.667x speedup, test set 2.086x speedup, val set 1.011x speedup, step: 8, train time 9.42 s
Epoch 37/50 |loss: 0.125711| train set 2.805x speedup, test set 2.117x speedup, val set 1.648x speedup, step: 9, train time 9.07 s
Epoch 38/50 |loss: 0.127148| train set 2.787x speedup, test set 1.856x speedup, val set 1.013x speedup, step: 10, train time 9.11 s
Epoch 39/50 |loss: 0.124186| train set 2.842x speedup, test set 2.087x speedup, val set 1.012x speedup, step: 11, train time 9.18 s
Epoch 40/50 |loss: 0.117805| train set 2.841x speedup, test set 2.053x speedup, val set 1.010x speedup, step: 12, train time 9.32 s
Epoch 41/50 |loss: 0.120411| train set 2.802x speedup, test set 2.092x speedup, val set 1.011x speedup, step: 13, train time 8.90 s
Epoch 42/50 |loss: 0.117969| train set 2.763x speedup, test set 2.133x speedup, val set 1.012x speedup, step: 14, train time 9.00 s
Epoch 43/50 |loss: 0.117223| train set 2.788x speedup, test set 2.129x speedup, val set 1.059x speedup, step: 15, train time 9.02 s
Epoch 44/50 |loss: 0.122807| train set 2.786x speedup, test set 1.224x speedup, val set 1.015x speedup, step: 16, train time 9.21 s
Epoch 45/50 |loss: 0.120207| train set 2.738x speedup, test set 2.082x speedup, val set 1.635x speedup, step: 17, train time 9.03 s
Epoch 46/50 |loss: 0.110810| train set 2.810x speedup, test set 2.066x speedup, val set 1.015x speedup, step: 18, train time 9.22 s
Epoch 47/50 |loss: 0.120027| train set 2.823x speedup, test set 2.063x speedup, val set 1.012x speedup, step: 19, train time 8.82 s
Epoch 48/50 |loss: 0.115322| train set 2.662x speedup, test set 2.034x speedup, val set 1.053x speedup, step: 20, train time 9.19 s
Epoch 49/50 |loss: 0.109457| train set 2.672x speedup, test set 2.063x speedup, val set 1.643x speedup, step: 21, train time 9.09 s
Training per epoch cost 9.131 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 49.702s, pg runtime 32.278s, speedup 0.649x
06, opt runtime 21.143s, model runtime 55.527s, pg runtime 21.143s, speedup 0.381x
07, opt runtime 6.460s, model runtime 34.333s, pg runtime 16.134s, speedup 0.470x
08, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.634s, pg runtime 1.214s, speedup 0.743x
20, opt runtime 1.353s, model runtime 1.837s, pg runtime 1.380s, speedup 0.752x
21, opt runtime 22.482s, model runtime 29.303s, pg runtime 22.482s, speedup 0.767x
22, opt runtime 6.519s, model runtime 44.915s, pg runtime 6.519s, speedup 0.145x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.404s, model runtime 1.404s, pg runtime 1.404s, speedup 1.000x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 593.507s, pg runtime 608.707s, speedup 1.026x
32, opt runtime 24.706s, model runtime 591.577s, pg runtime 610.808s, speedup 1.033x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 406.510s, pg runtime 651.942s, speedup 1.604x
36, opt runtime 16.639s, model runtime 335.627s, pg runtime 462.544s, speedup 1.378x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 39, train speedup 2.842, test speedup 2.087, val speedup 1.012
best test speedup epoch: 0, train speedup 1.104, test speedup 2.708, val speedup 1.029
best validation speedup epoch: 29, train speedup 2.775, test speedup 0.972, val speedup 2.062
last model at epoch 49, train speedup 2.672, test speedup 2.063, val speedup 1.643
execution cost 0:08:09.439503
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.740600, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454931| train set 1.093x speedup, test set 2.381x speedup, val set 1.034x speedup, step: 1, train time 10.17 s
Epoch 1/50 |loss: 0.369738| train set 2.024x speedup, test set 2.415x speedup, val set 0.977x speedup, step: 2, train time 9.10 s
Epoch 2/50 |loss: 0.334861| train set 2.101x speedup, test set 0.885x speedup, val set 1.045x speedup, step: 3, train time 9.08 s
Epoch 3/50 |loss: 0.308828| train set 2.023x speedup, test set 0.959x speedup, val set 1.045x speedup, step: 4, train time 9.60 s
Epoch 4/50 |loss: 0.274765| train set 2.467x speedup, test set 0.926x speedup, val set 1.011x speedup, step: 1, train time 9.30 s
Epoch 5/50 |loss: 0.263501| train set 2.489x speedup, test set 0.928x speedup, val set 1.006x speedup, step: 2, train time 9.21 s
Epoch 6/50 |loss: 0.243096| train set 2.247x speedup, test set 0.937x speedup, val set 1.053x speedup, step: 3, train time 9.21 s
Epoch 7/50 |loss: 0.240141| train set 2.794x speedup, test set 1.355x speedup, val set 1.623x speedup, step: 4, train time 9.41 s
Epoch 8/50 |loss: 0.224913| train set 2.471x speedup, test set 1.026x speedup, val set 1.661x speedup, step: 5, train time 9.00 s
Epoch 9/50 |loss: 0.221765| train set 2.552x speedup, test set 1.264x speedup, val set 1.015x speedup, step: 1, train time 9.30 s
Epoch 10/50 |loss: 0.215781| train set 2.565x speedup, test set 1.506x speedup, val set 1.644x speedup, step: 2, train time 9.27 s
Epoch 11/50 |loss: 0.212784| train set 2.739x speedup, test set 2.373x speedup, val set 2.091x speedup, step: 3, train time 9.20 s
Epoch 12/50 |loss: 0.204121| train set 2.545x speedup, test set 1.308x speedup, val set 1.055x speedup, step: 4, train time 9.32 s
Epoch 13/50 |loss: 0.191197| train set 2.653x speedup, test set 1.334x speedup, val set 1.665x speedup, step: 5, train time 9.21 s
Epoch 14/50 |loss: 0.191290| train set 2.687x speedup, test set 2.124x speedup, val set 1.643x speedup, step: 1, train time 9.10 s
Epoch 15/50 |loss: 0.185798| train set 2.761x speedup, test set 2.270x speedup, val set 1.643x speedup, step: 2, train time 9.30 s
Epoch 16/50 |loss: 0.174164| train set 2.787x speedup, test set 2.339x speedup, val set 1.012x speedup, step: 3, train time 9.10 s
Epoch 17/50 |loss: 0.167064| train set 2.723x speedup, test set 2.216x speedup, val set 1.154x speedup, step: 4, train time 9.22 s
Epoch 18/50 |loss: 0.163172| train set 2.745x speedup, test set 2.342x speedup, val set 1.209x speedup, step: 5, train time 9.00 s
Epoch 19/50 |loss: 0.172177| train set 2.741x speedup, test set 2.170x speedup, val set 1.648x speedup, step: 1, train time 9.30 s
Epoch 20/50 |loss: 0.169008| train set 2.454x speedup, test set 2.115x speedup, val set 1.055x speedup, step: 2, train time 8.92 s
Epoch 21/50 |loss: 0.159044| train set 2.720x speedup, test set 2.312x speedup, val set 2.063x speedup, step: 3, train time 9.40 s
Epoch 22/50 |loss: 0.157401| train set 2.744x speedup, test set 1.351x speedup, val set 1.003x speedup, step: 4, train time 9.02 s
Epoch 23/50 |loss: 0.145519| train set 2.652x speedup, test set 2.161x speedup, val set 1.148x speedup, step: 5, train time 9.21 s
Epoch 24/50 |loss: 0.148146| train set 2.687x speedup, test set 1.564x speedup, val set 1.010x speedup, step: 6, train time 9.25 s
Epoch 25/50 |loss: 0.147509| train set 2.780x speedup, test set 1.289x speedup, val set 1.148x speedup, step: 7, train time 8.93 s
Epoch 26/50 |loss: 0.144339| train set 2.782x speedup, test set 1.559x speedup, val set 1.152x speedup, step: 8, train time 9.10 s
Epoch 27/50 |loss: 0.142035| train set 2.739x speedup, test set 2.160x speedup, val set 1.154x speedup, step: 9, train time 9.10 s
Epoch 28/50 |loss: 0.138454| train set 2.737x speedup, test set 2.338x speedup, val set 1.148x speedup, step: 10, train time 9.20 s
Epoch 29/50 |loss: 0.134309| train set 2.782x speedup, test set 1.306x speedup, val set 2.063x speedup, step: 1, train time 8.91 s
Epoch 30/50 |loss: 0.137921| train set 2.782x speedup, test set 1.303x speedup, val set 1.205x speedup, step: 2, train time 9.21 s
Epoch 31/50 |loss: 0.133668| train set 2.771x speedup, test set 1.226x speedup, val set 1.146x speedup, step: 3, train time 9.70 s
Epoch 32/50 |loss: 0.128344| train set 2.738x speedup, test set 1.226x speedup, val set 1.050x speedup, step: 4, train time 8.93 s
Epoch 33/50 |loss: 0.130643| train set 2.771x speedup, test set 1.276x speedup, val set 0.931x speedup, step: 5, train time 9.30 s
Epoch 34/50 |loss: 0.129199| train set 2.762x speedup, test set 2.209x speedup, val set 1.154x speedup, step: 6, train time 8.89 s
Epoch 35/50 |loss: 0.125979| train set 2.731x speedup, test set 1.348x speedup, val set 1.648x speedup, step: 7, train time 9.11 s
Epoch 36/50 |loss: 0.129442| train set 2.745x speedup, test set 1.325x speedup, val set 1.753x speedup, step: 8, train time 9.03 s
Epoch 37/50 |loss: 0.122260| train set 2.781x speedup, test set 2.296x speedup, val set 1.635x speedup, step: 9, train time 9.18 s
Epoch 38/50 |loss: 0.117057| train set 2.809x speedup, test set 2.235x speedup, val set 1.648x speedup, step: 10, train time 9.30 s
Epoch 39/50 |loss: 0.118323| train set 2.835x speedup, test set 1.286x speedup, val set 1.211x speedup, step: 11, train time 9.12 s
Epoch 40/50 |loss: 0.120245| train set 2.841x speedup, test set 2.388x speedup, val set 1.648x speedup, step: 12, train time 9.11 s
Epoch 41/50 |loss: 0.113091| train set 2.795x speedup, test set 2.328x speedup, val set 2.043x speedup, step: 13, train time 9.10 s
Epoch 42/50 |loss: 0.113378| train set 2.821x speedup, test set 2.442x speedup, val set 1.010x speedup, step: 14, train time 9.12 s
Epoch 43/50 |loss: 0.117656| train set 2.806x speedup, test set 1.283x speedup, val set 1.201x speedup, step: 15, train time 9.38 s
Epoch 44/50 |loss: 0.117615| train set 2.832x speedup, test set 2.209x speedup, val set 1.007x speedup, step: 16, train time 9.59 s
Epoch 45/50 |loss: 0.116128| train set 2.689x speedup, test set 1.363x speedup, val set 1.148x speedup, step: 17, train time 8.90 s
Epoch 46/50 |loss: 0.109711| train set 2.806x speedup, test set 1.360x speedup, val set 2.043x speedup, step: 18, train time 9.11 s
Epoch 47/50 |loss: 0.109366| train set 2.834x speedup, test set 2.297x speedup, val set 1.007x speedup, step: 19, train time 9.20 s
Epoch 48/50 |loss: 0.108937| train set 2.777x speedup, test set 2.087x speedup, val set 1.007x speedup, step: 20, train time 9.23 s
Epoch 49/50 |loss: 0.108788| train set 2.797x speedup, test set 2.139x speedup, val set 1.648x speedup, step: 21, train time 9.20 s
Training per epoch cost 9.203 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 26.845s, pg runtime 23.223s, speedup 0.865x
18, opt runtime 10.788s, model runtime 28.501s, pg runtime 32.939s, speedup 1.156x
19, opt runtime 1.148s, model runtime 1.403s, pg runtime 1.214s, speedup 0.865x
20, opt runtime 1.353s, model runtime 1.540s, pg runtime 1.380s, speedup 0.896x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 24.079s, pg runtime 608.707s, speedup 25.279x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 38.718s, model runtime 44.369s, pg runtime 69.421s, speedup 1.565x
34, opt runtime 35.527s, model runtime 47.936s, pg runtime 71.730s, speedup 1.496x
35, opt runtime 18.690s, model runtime 637.615s, pg runtime 651.942s, speedup 1.022x
36, opt runtime 16.639s, model runtime 576.339s, pg runtime 462.544s, speedup 0.803x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 40, train speedup 2.841, test speedup 2.388, val speedup 1.648
best test speedup epoch: 42, train speedup 2.821, test speedup 2.442, val speedup 1.010
best validation speedup epoch: 29, train speedup 2.782, test speedup 1.306, val speedup 2.063
last model at epoch 49, train speedup 2.797, test speedup 2.139, val speedup 1.648
execution cost 0:08:13.737727
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.732766, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.453382| train set 1.109x speedup, test set 1.623x speedup, val set 1.033x speedup, step: 1, train time 10.15 s
Epoch 1/50 |loss: 0.367179| train set 2.006x speedup, test set 2.366x speedup, val set 0.977x speedup, step: 2, train time 9.40 s
Epoch 2/50 |loss: 0.330337| train set 2.178x speedup, test set 1.300x speedup, val set 1.045x speedup, step: 3, train time 9.18 s
Epoch 3/50 |loss: 0.302725| train set 1.991x speedup, test set 0.992x speedup, val set 0.888x speedup, step: 4, train time 9.51 s
Epoch 4/50 |loss: 0.271795| train set 2.164x speedup, test set 2.392x speedup, val set 1.056x speedup, step: 1, train time 9.41 s
Epoch 5/50 |loss: 0.261674| train set 1.976x speedup, test set 1.213x speedup, val set 1.045x speedup, step: 2, train time 9.20 s
Epoch 6/50 |loss: 0.244204| train set 2.295x speedup, test set 2.277x speedup, val set 1.056x speedup, step: 3, train time 8.82 s
Epoch 7/50 |loss: 0.240607| train set 2.679x speedup, test set 1.311x speedup, val set 1.011x speedup, step: 4, train time 8.90 s
Epoch 8/50 |loss: 0.226271| train set 2.347x speedup, test set 1.983x speedup, val set 1.053x speedup, step: 5, train time 9.11 s
Epoch 9/50 |loss: 0.221863| train set 2.394x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 6, train time 9.39 s
Epoch 10/50 |loss: 0.218066| train set 2.641x speedup, test set 1.863x speedup, val set 1.016x speedup, step: 7, train time 9.28 s
Epoch 11/50 |loss: 0.209313| train set 2.758x speedup, test set 2.209x speedup, val set 1.647x speedup, step: 8, train time 9.12 s
Epoch 12/50 |loss: 0.202807| train set 2.529x speedup, test set 2.120x speedup, val set 1.045x speedup, step: 9, train time 9.09 s
Epoch 13/50 |loss: 0.191615| train set 2.750x speedup, test set 2.193x speedup, val set 1.647x speedup, step: 10, train time 9.30 s
Epoch 14/50 |loss: 0.188783| train set 2.711x speedup, test set 2.212x speedup, val set 1.010x speedup, step: 11, train time 9.20 s
Epoch 15/50 |loss: 0.186168| train set 2.758x speedup, test set 2.068x speedup, val set 1.010x speedup, step: 12, train time 8.93 s
Epoch 16/50 |loss: 0.175233| train set 2.764x speedup, test set 1.908x speedup, val set 1.001x speedup, step: 13, train time 9.10 s
Epoch 17/50 |loss: 0.166888| train set 2.706x speedup, test set 2.155x speedup, val set 1.016x speedup, step: 14, train time 9.08 s
Epoch 18/50 |loss: 0.165684| train set 2.721x speedup, test set 1.528x speedup, val set 1.008x speedup, step: 15, train time 9.41 s
Epoch 19/50 |loss: 0.168601| train set 2.573x speedup, test set 2.104x speedup, val set 1.055x speedup, step: 16, train time 9.20 s
Epoch 20/50 |loss: 0.161358| train set 2.524x speedup, test set 2.109x speedup, val set 1.055x speedup, step: 17, train time 9.10 s
Epoch 21/50 |loss: 0.155358| train set 2.679x speedup, test set 2.081x speedup, val set 1.011x speedup, step: 18, train time 9.29 s
Epoch 22/50 |loss: 0.153649| train set 2.797x speedup, test set 2.186x speedup, val set 1.002x speedup, step: 19, train time 9.00 s
Epoch 23/50 |loss: 0.146212| train set 2.640x speedup, test set 2.003x speedup, val set 1.050x speedup, step: 20, train time 9.40 s
Epoch 24/50 |loss: 0.147025| train set 2.628x speedup, test set 2.004x speedup, val set 1.007x speedup, step: 21, train time 9.09 s
Epoch 25/50 |loss: 0.143678| train set 2.815x speedup, test set 1.952x speedup, val set 1.007x speedup, step: 22, train time 9.02 s
Epoch 26/50 |loss: 0.142293| train set 2.795x speedup, test set 2.005x speedup, val set 1.047x speedup, step: 23, train time 9.09 s
Epoch 27/50 |loss: 0.139058| train set 2.685x speedup, test set 2.012x speedup, val set 1.012x speedup, step: 24, train time 9.23 s
Epoch 28/50 |loss: 0.138751| train set 2.742x speedup, test set 2.268x speedup, val set 1.006x speedup, step: 25, train time 9.24 s
Epoch 29/50 |loss: 0.132458| train set 2.803x speedup, test set 2.210x speedup, val set 1.050x speedup, step: 26, train time 9.01 s
Epoch 30/50 |loss: 0.135636| train set 2.809x speedup, test set 2.399x speedup, val set 1.012x speedup, step: 27, train time 8.99 s
Epoch 31/50 |loss: 0.130277| train set 2.779x speedup, test set 2.371x speedup, val set 1.007x speedup, step: 28, train time 8.99 s
Epoch 32/50 |loss: 0.124638| train set 2.494x speedup, test set 2.179x speedup, val set 1.050x speedup, step: 29, train time 9.31 s
Epoch 33/50 |loss: 0.125332| train set 2.791x speedup, test set 2.266x speedup, val set 1.049x speedup, step: 30, train time 9.09 s
Epoch 34/50 |loss: 0.127224| train set 2.737x speedup, test set 2.125x speedup, val set 1.010x speedup, step: 31, train time 9.00 s
Epoch 35/50 |loss: 0.121953| train set 2.783x speedup, test set 2.258x speedup, val set 1.055x speedup, step: 32, train time 8.81 s
Epoch 36/50 |loss: 0.124890| train set 2.761x speedup, test set 2.134x speedup, val set 1.006x speedup, step: 33, train time 9.19 s
Epoch 37/50 |loss: 0.119845| train set 2.817x speedup, test set 2.266x speedup, val set 1.007x speedup, step: 34, train time 9.41 s
Epoch 38/50 |loss: 0.116689| train set 2.803x speedup, test set 2.325x speedup, val set 1.007x speedup, step: 35, train time 9.00 s
Epoch 39/50 |loss: 0.115181| train set 2.596x speedup, test set 2.029x speedup, val set 1.050x speedup, step: 36, train time 9.00 s
Epoch 40/50 |loss: 0.116946| train set 2.842x speedup, test set 2.183x speedup, val set 1.005x speedup, step: 37, train time 9.21 s
Epoch 41/50 |loss: 0.112860| train set 2.826x speedup, test set 2.183x speedup, val set 1.007x speedup, step: 38, train time 9.11 s
Epoch 42/50 |loss: 0.121529| train set 2.811x speedup, test set 2.292x speedup, val set 1.007x speedup, step: 39, train time 9.40 s
Epoch 43/50 |loss: 0.111707| train set 2.794x speedup, test set 2.141x speedup, val set 1.055x speedup, step: 40, train time 9.22 s
Epoch 44/50 |loss: 0.118204| train set 2.766x speedup, test set 2.073x speedup, val set 1.050x speedup, step: 41, train time 9.29 s
Epoch 45/50 |loss: 0.109127| train set 2.751x speedup, test set 2.233x speedup, val set 1.007x speedup, step: 42, train time 9.19 s
Epoch 46/50 |loss: 0.103012| train set 2.751x speedup, test set 2.188x speedup, val set 1.010x speedup, step: 43, train time 9.30 s
Epoch 47/50 |loss: 0.110988| train set 2.823x speedup, test set 2.266x speedup, val set 1.007x speedup, step: 44, train time 9.08 s
Epoch 48/50 |loss: 0.109831| train set 2.766x speedup, test set 2.360x speedup, val set 1.050x speedup, step: 45, train time 8.92 s
Epoch 49/50 |loss: 0.102318| train set 2.793x speedup, test set 1.358x speedup, val set 1.012x speedup, step: 46, train time 9.12 s
Training per epoch cost 9.178 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 40.230s, pg runtime 92.131s, speedup 2.290x
04, opt runtime 29.502s, model runtime 47.174s, pg runtime 112.305s, speedup 2.381x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 39.889s, pg runtime 16.134s, speedup 0.404x
08, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
09, opt runtime 3.944s, model runtime 12.042s, pg runtime 3.944s, speedup 0.328x
10, opt runtime 3.603s, model runtime 12.640s, pg runtime 3.603s, speedup 0.285x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.404s, model runtime 1.404s, pg runtime 1.404s, speedup 1.000x
27, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
28, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
32, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
37, opt runtime 11.120s, model runtime 52.165s, pg runtime 11.120s, speedup 0.213x
38, opt runtime 18.262s, model runtime 47.388s, pg runtime 18.262s, speedup 0.385x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 40, train speedup 2.842, test speedup 2.183, val speedup 1.005
best test speedup epoch: 30, train speedup 2.809, test speedup 2.399, val speedup 1.012
best validation speedup epoch: 4, train speedup 2.164, test speedup 2.392, val speedup 1.056
last model at epoch 49, train speedup 2.793, test speedup 1.358, val speedup 1.012
execution cost 0:08:11.023961
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.752255, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454536| train set 1.086x speedup, test set 2.766x speedup, val set 1.034x speedup, step: 1, train time 10.20 s
Epoch 1/50 |loss: 0.368375| train set 2.020x speedup, test set 2.551x speedup, val set 0.976x speedup, step: 2, train time 9.01 s
Epoch 2/50 |loss: 0.330914| train set 2.184x speedup, test set 1.365x speedup, val set 1.002x speedup, step: 3, train time 9.10 s
Epoch 3/50 |loss: 0.303440| train set 2.301x speedup, test set 1.254x speedup, val set 1.009x speedup, step: 4, train time 9.60 s
Epoch 4/50 |loss: 0.272774| train set 2.213x speedup, test set 1.060x speedup, val set 1.010x speedup, step: 1, train time 9.00 s
Epoch 5/50 |loss: 0.263097| train set 2.349x speedup, test set 1.023x speedup, val set 1.055x speedup, step: 2, train time 8.80 s
Epoch 6/50 |loss: 0.244542| train set 2.166x speedup, test set 1.243x speedup, val set 1.208x speedup, step: 3, train time 9.11 s
Epoch 7/50 |loss: 0.237788| train set 2.753x speedup, test set 0.935x speedup, val set 1.011x speedup, step: 4, train time 9.30 s
Epoch 8/50 |loss: 0.227079| train set 2.442x speedup, test set 0.858x speedup, val set 1.642x speedup, step: 5, train time 9.03 s
Epoch 9/50 |loss: 0.221518| train set 2.647x speedup, test set 0.989x speedup, val set 1.642x speedup, step: 1, train time 8.93 s
Epoch 10/50 |loss: 0.220028| train set 2.651x speedup, test set 1.018x speedup, val set 2.062x speedup, step: 2, train time 9.01 s
Epoch 11/50 |loss: 0.208084| train set 2.739x speedup, test set 2.441x speedup, val set 2.064x speedup, step: 3, train time 9.21 s
Epoch 12/50 |loss: 0.204787| train set 2.640x speedup, test set 0.950x speedup, val set 1.198x speedup, step: 4, train time 8.99 s
Epoch 13/50 |loss: 0.192768| train set 2.690x speedup, test set 0.896x speedup, val set 2.025x speedup, step: 5, train time 9.13 s
Epoch 14/50 |loss: 0.193890| train set 2.779x speedup, test set 2.259x speedup, val set 1.643x speedup, step: 1, train time 9.19 s
Epoch 15/50 |loss: 0.186815| train set 2.761x speedup, test set 2.126x speedup, val set 1.048x speedup, step: 2, train time 9.31 s
Epoch 16/50 |loss: 0.175084| train set 2.775x speedup, test set 2.325x speedup, val set 1.623x speedup, step: 3, train time 9.00 s
Epoch 17/50 |loss: 0.168069| train set 2.765x speedup, test set 2.299x speedup, val set 2.089x speedup, step: 4, train time 9.31 s
Epoch 18/50 |loss: 0.165556| train set 2.638x speedup, test set 1.544x speedup, val set 1.005x speedup, step: 5, train time 9.11 s
Epoch 19/50 |loss: 0.169470| train set 2.717x speedup, test set 1.555x speedup, val set 1.635x speedup, step: 6, train time 8.91 s
Epoch 20/50 |loss: 0.170562| train set 2.710x speedup, test set 2.329x speedup, val set 1.007x speedup, step: 7, train time 9.00 s
Epoch 21/50 |loss: 0.159909| train set 2.707x speedup, test set 2.207x speedup, val set 1.011x speedup, step: 8, train time 8.91 s
Epoch 22/50 |loss: 0.159480| train set 2.776x speedup, test set 1.575x speedup, val set 1.012x speedup, step: 9, train time 9.22 s
Epoch 23/50 |loss: 0.149215| train set 2.637x speedup, test set 2.193x speedup, val set 1.007x speedup, step: 10, train time 9.01 s
Epoch 24/50 |loss: 0.151811| train set 2.606x speedup, test set 0.981x speedup, val set 1.010x speedup, step: 11, train time 9.22 s
Epoch 25/50 |loss: 0.154048| train set 2.712x speedup, test set 1.525x speedup, val set 1.007x speedup, step: 12, train time 9.32 s
Epoch 26/50 |loss: 0.148516| train set 2.728x speedup, test set 1.528x speedup, val set 1.006x speedup, step: 13, train time 9.10 s
Epoch 27/50 |loss: 0.146925| train set 2.758x speedup, test set 1.453x speedup, val set 1.007x speedup, step: 14, train time 9.21 s
Epoch 28/50 |loss: 0.141035| train set 2.728x speedup, test set 1.535x speedup, val set 1.006x speedup, step: 15, train time 8.91 s
Epoch 29/50 |loss: 0.135000| train set 2.773x speedup, test set 1.607x speedup, val set 1.007x speedup, step: 16, train time 8.79 s
Epoch 30/50 |loss: 0.142789| train set 2.772x speedup, test set 1.562x speedup, val set 1.007x speedup, step: 17, train time 9.23 s
Epoch 31/50 |loss: 0.142282| train set 2.706x speedup, test set 1.555x speedup, val set 1.004x speedup, step: 18, train time 9.01 s
Epoch 32/50 |loss: 0.129280| train set 2.630x speedup, test set 1.659x speedup, val set 1.007x speedup, step: 19, train time 9.21 s
Epoch 33/50 |loss: 0.130319| train set 2.813x speedup, test set 1.535x speedup, val set 1.050x speedup, step: 20, train time 9.00 s
Epoch 34/50 |loss: 0.132848| train set 2.737x speedup, test set 1.474x speedup, val set 1.007x speedup, step: 21, train time 8.81 s
Epoch 35/50 |loss: 0.127993| train set 2.669x speedup, test set 1.575x speedup, val set 1.007x speedup, step: 22, train time 8.90 s
Epoch 36/50 |loss: 0.132354| train set 2.762x speedup, test set 1.536x speedup, val set 1.007x speedup, step: 23, train time 9.12 s
Epoch 37/50 |loss: 0.127402| train set 2.754x speedup, test set 1.558x speedup, val set 1.007x speedup, step: 24, train time 9.00 s
Epoch 38/50 |loss: 0.123268| train set 2.762x speedup, test set 1.535x speedup, val set 1.005x speedup, step: 25, train time 9.10 s
Epoch 39/50 |loss: 0.122711| train set 2.788x speedup, test set 1.563x speedup, val set 1.007x speedup, step: 26, train time 9.10 s
Epoch 40/50 |loss: 0.119822| train set 2.772x speedup, test set 1.524x speedup, val set 1.007x speedup, step: 27, train time 9.21 s
Epoch 41/50 |loss: 0.118230| train set 2.805x speedup, test set 1.516x speedup, val set 1.013x speedup, step: 28, train time 8.83 s
Epoch 42/50 |loss: 0.120051| train set 2.866x speedup, test set 1.516x speedup, val set 1.007x speedup, step: 29, train time 8.91 s
Epoch 43/50 |loss: 0.117153| train set 2.834x speedup, test set 1.517x speedup, val set 1.050x speedup, step: 30, train time 9.11 s
Epoch 44/50 |loss: 0.121458| train set 2.857x speedup, test set 1.506x speedup, val set 1.048x speedup, step: 31, train time 9.03 s
Epoch 45/50 |loss: 0.118420| train set 2.716x speedup, test set 1.535x speedup, val set 1.010x speedup, step: 32, train time 8.80 s
Epoch 46/50 |loss: 0.113593| train set 2.831x speedup, test set 2.215x speedup, val set 1.007x speedup, step: 33, train time 9.10 s
Epoch 47/50 |loss: 0.115681| train set 2.831x speedup, test set 1.575x speedup, val set 1.007x speedup, step: 34, train time 8.91 s
Epoch 48/50 |loss: 0.113670| train set 2.764x speedup, test set 2.346x speedup, val set 1.007x speedup, step: 35, train time 9.02 s
Epoch 49/50 |loss: 0.108890| train set 2.762x speedup, test set 2.175x speedup, val set 1.635x speedup, step: 36, train time 9.31 s
Training per epoch cost 9.093 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
32, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
36, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
37, opt runtime 11.120s, model runtime 52.165s, pg runtime 11.120s, speedup 0.213x
38, opt runtime 18.262s, model runtime 47.388s, pg runtime 18.262s, speedup 0.385x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 42, train speedup 2.866, test speedup 1.516, val speedup 1.007
best test speedup epoch: 0, train speedup 1.086, test speedup 2.766, val speedup 1.034
best validation speedup epoch: 14, train speedup 2.779, test speedup 2.259, val speedup 1.643
last model at epoch 49, train speedup 2.762, test speedup 2.175, val speedup 1.635
execution cost 0:08:07.783717
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.725938, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454526| train set 1.086x speedup, test set 2.717x speedup, val set 1.034x speedup, step: 1, train time 10.40 s
Epoch 1/50 |loss: 0.367891| train set 2.178x speedup, test set 2.604x speedup, val set 1.738x speedup, step: 2, train time 9.31 s
Epoch 2/50 |loss: 0.329642| train set 2.323x speedup, test set 0.887x speedup, val set 1.009x speedup, step: 3, train time 9.00 s
Epoch 3/50 |loss: 0.305059| train set 2.417x speedup, test set 1.265x speedup, val set 1.009x speedup, step: 4, train time 9.50 s
Epoch 4/50 |loss: 0.273171| train set 2.312x speedup, test set 1.337x speedup, val set 1.045x speedup, step: 1, train time 9.38 s
Epoch 5/50 |loss: 0.261306| train set 2.299x speedup, test set 1.359x speedup, val set 1.015x speedup, step: 2, train time 9.21 s
Epoch 6/50 |loss: 0.242365| train set 2.216x speedup, test set 2.127x speedup, val set 1.208x speedup, step: 3, train time 9.30 s
Epoch 7/50 |loss: 0.236646| train set 2.464x speedup, test set 2.453x speedup, val set 1.002x speedup, step: 4, train time 9.12 s
Epoch 8/50 |loss: 0.225442| train set 2.679x speedup, test set 2.466x speedup, val set 1.002x speedup, step: 5, train time 9.10 s
Epoch 9/50 |loss: 0.222806| train set 2.550x speedup, test set 2.534x speedup, val set 1.011x speedup, step: 6, train time 8.91 s
Epoch 10/50 |loss: 0.214507| train set 2.552x speedup, test set 1.288x speedup, val set 1.632x speedup, step: 7, train time 8.81 s
Epoch 11/50 |loss: 0.211131| train set 2.738x speedup, test set 2.414x speedup, val set 1.011x speedup, step: 8, train time 9.60 s
Epoch 12/50 |loss: 0.205746| train set 2.608x speedup, test set 1.341x speedup, val set 1.045x speedup, step: 9, train time 9.42 s
Epoch 13/50 |loss: 0.191723| train set 2.639x speedup, test set 1.344x speedup, val set 1.154x speedup, step: 10, train time 9.20 s
Epoch 14/50 |loss: 0.192455| train set 2.704x speedup, test set 2.395x speedup, val set 1.156x speedup, step: 1, train time 9.20 s
Epoch 15/50 |loss: 0.186336| train set 2.749x speedup, test set 2.242x speedup, val set 1.648x speedup, step: 2, train time 9.61 s
Epoch 16/50 |loss: 0.175995| train set 2.780x speedup, test set 2.170x speedup, val set 1.648x speedup, step: 3, train time 9.19 s
Epoch 17/50 |loss: 0.166772| train set 2.760x speedup, test set 2.265x speedup, val set 1.018x speedup, step: 4, train time 9.60 s
Epoch 18/50 |loss: 0.165312| train set 2.658x speedup, test set 2.351x speedup, val set 1.059x speedup, step: 5, train time 9.22 s
Epoch 19/50 |loss: 0.170760| train set 2.737x speedup, test set 2.257x speedup, val set 1.648x speedup, step: 1, train time 9.09 s
Epoch 20/50 |loss: 0.169078| train set 2.612x speedup, test set 2.233x speedup, val set 1.055x speedup, step: 2, train time 9.29 s
Epoch 21/50 |loss: 0.164211| train set 2.671x speedup, test set 2.187x speedup, val set 1.648x speedup, step: 3, train time 9.00 s
Epoch 22/50 |loss: 0.158508| train set 2.741x speedup, test set 2.195x speedup, val set 1.012x speedup, step: 4, train time 9.21 s
Epoch 23/50 |loss: 0.145367| train set 2.665x speedup, test set 2.265x speedup, val set 1.015x speedup, step: 5, train time 9.11 s
Epoch 24/50 |loss: 0.151338| train set 2.612x speedup, test set 2.280x speedup, val set 1.015x speedup, step: 6, train time 9.50 s
Epoch 25/50 |loss: 0.146759| train set 2.767x speedup, test set 2.442x speedup, val set 1.635x speedup, step: 7, train time 9.52 s
Epoch 26/50 |loss: 0.146297| train set 2.751x speedup, test set 2.241x speedup, val set 1.010x speedup, step: 8, train time 9.31 s
Epoch 27/50 |loss: 0.142308| train set 2.739x speedup, test set 2.265x speedup, val set 1.015x speedup, step: 9, train time 9.22 s
Epoch 28/50 |loss: 0.141443| train set 2.747x speedup, test set 2.368x speedup, val set 1.015x speedup, step: 10, train time 9.09 s
Epoch 29/50 |loss: 0.131239| train set 2.820x speedup, test set 2.242x speedup, val set 1.635x speedup, step: 11, train time 9.11 s
Epoch 30/50 |loss: 0.138112| train set 2.826x speedup, test set 2.267x speedup, val set 1.015x speedup, step: 12, train time 9.31 s
Epoch 31/50 |loss: 0.135340| train set 2.771x speedup, test set 2.248x speedup, val set 1.015x speedup, step: 13, train time 9.29 s
Epoch 32/50 |loss: 0.129188| train set 2.735x speedup, test set 2.225x speedup, val set 1.053x speedup, step: 14, train time 8.99 s
Epoch 33/50 |loss: 0.130531| train set 2.828x speedup, test set 2.290x speedup, val set 1.766x speedup, step: 15, train time 8.98 s
Epoch 34/50 |loss: 0.126541| train set 2.696x speedup, test set 2.251x speedup, val set 1.635x speedup, step: 16, train time 9.20 s
Epoch 35/50 |loss: 0.129969| train set 2.735x speedup, test set 2.290x speedup, val set 1.766x speedup, step: 17, train time 8.99 s
Epoch 36/50 |loss: 0.127989| train set 2.783x speedup, test set 2.248x speedup, val set 1.635x speedup, step: 18, train time 9.38 s
Epoch 37/50 |loss: 0.120658| train set 2.786x speedup, test set 2.267x speedup, val set 1.010x speedup, step: 19, train time 9.10 s
Epoch 38/50 |loss: 0.119361| train set 2.698x speedup, test set 2.154x speedup, val set 1.643x speedup, step: 20, train time 9.39 s
Epoch 39/50 |loss: 0.118729| train set 2.833x speedup, test set 2.248x speedup, val set 1.053x speedup, step: 21, train time 9.21 s
Epoch 40/50 |loss: 0.117675| train set 2.746x speedup, test set 2.248x speedup, val set 1.648x speedup, step: 22, train time 9.50 s
Epoch 41/50 |loss: 0.115990| train set 2.776x speedup, test set 2.244x speedup, val set 1.635x speedup, step: 23, train time 9.00 s
Epoch 42/50 |loss: 0.116670| train set 2.812x speedup, test set 2.059x speedup, val set 1.635x speedup, step: 24, train time 9.19 s
Epoch 43/50 |loss: 0.116783| train set 2.828x speedup, test set 2.267x speedup, val set 1.766x speedup, step: 25, train time 9.11 s
Epoch 44/50 |loss: 0.118497| train set 2.786x speedup, test set 2.251x speedup, val set 1.635x speedup, step: 26, train time 9.10 s
Epoch 45/50 |loss: 0.111928| train set 2.756x speedup, test set 2.244x speedup, val set 1.053x speedup, step: 27, train time 9.00 s
Epoch 46/50 |loss: 0.109738| train set 2.816x speedup, test set 2.297x speedup, val set 1.010x speedup, step: 28, train time 9.00 s
Epoch 47/50 |loss: 0.115863| train set 2.831x speedup, test set 2.275x speedup, val set 2.043x speedup, step: 29, train time 9.13 s
Epoch 48/50 |loss: 0.114920| train set 2.742x speedup, test set 2.294x speedup, val set 1.010x speedup, step: 30, train time 9.10 s
Epoch 49/50 |loss: 0.104538| train set 2.818x speedup, test set 2.267x speedup, val set 1.635x speedup, step: 31, train time 9.09 s
Training per epoch cost 9.232 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 93.826s, pg runtime 92.131s, speedup 0.982x
04, opt runtime 29.502s, model runtime 110.289s, pg runtime 112.305s, speedup 1.018x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.403s, pg runtime 1.214s, speedup 0.865x
20, opt runtime 1.353s, model runtime 1.540s, pg runtime 1.380s, speedup 0.896x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
32, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
37, opt runtime 11.120s, model runtime 52.165s, pg runtime 11.120s, speedup 0.213x
38, opt runtime 18.262s, model runtime 47.388s, pg runtime 18.262s, speedup 0.385x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 39, train speedup 2.833, test speedup 2.248, val speedup 1.053
best test speedup epoch: 0, train speedup 1.086, test speedup 2.717, val speedup 1.034
best validation speedup epoch: 19, train speedup 2.737, test speedup 2.257, val speedup 1.648
last model at epoch 49, train speedup 2.818, test speedup 2.267, val speedup 1.635
execution cost 0:08:14.223722
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.754901, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454521| train set 1.091x speedup, test set 1.343x speedup, val set 1.033x speedup, step: 1, train time 10.18 s
Epoch 1/50 |loss: 0.369224| train set 1.866x speedup, test set 2.555x speedup, val set 0.979x speedup, step: 2, train time 9.01 s
Epoch 2/50 |loss: 0.335987| train set 2.221x speedup, test set 1.313x speedup, val set 1.641x speedup, step: 3, train time 9.18 s
Epoch 3/50 |loss: 0.308013| train set 2.173x speedup, test set 1.224x speedup, val set 0.927x speedup, step: 4, train time 9.50 s
Epoch 4/50 |loss: 0.274883| train set 2.347x speedup, test set 1.328x speedup, val set 1.147x speedup, step: 1, train time 9.00 s
Epoch 5/50 |loss: 0.264259| train set 2.282x speedup, test set 1.484x speedup, val set 1.055x speedup, step: 2, train time 9.10 s
Epoch 6/50 |loss: 0.244028| train set 2.217x speedup, test set 2.008x speedup, val set 1.208x speedup, step: 3, train time 8.98 s
Epoch 7/50 |loss: 0.238660| train set 2.340x speedup, test set 1.288x speedup, val set 1.011x speedup, step: 4, train time 9.22 s
Epoch 8/50 |loss: 0.228990| train set 2.580x speedup, test set 1.556x speedup, val set 1.051x speedup, step: 5, train time 8.90 s
Epoch 9/50 |loss: 0.221484| train set 2.675x speedup, test set 1.288x speedup, val set 1.055x speedup, step: 6, train time 8.81 s
Epoch 10/50 |loss: 0.214785| train set 2.553x speedup, test set 1.484x speedup, val set 1.643x speedup, step: 7, train time 9.00 s
Epoch 11/50 |loss: 0.212986| train set 2.735x speedup, test set 1.482x speedup, val set 2.062x speedup, step: 8, train time 8.91 s
Epoch 12/50 |loss: 0.203781| train set 2.512x speedup, test set 1.213x speedup, val set 1.045x speedup, step: 9, train time 9.08 s
Epoch 13/50 |loss: 0.194470| train set 2.678x speedup, test set 1.239x speedup, val set 1.640x speedup, step: 10, train time 9.09 s
Epoch 14/50 |loss: 0.189826| train set 2.697x speedup, test set 1.912x speedup, val set 1.643x speedup, step: 1, train time 8.91 s
Epoch 15/50 |loss: 0.186039| train set 2.760x speedup, test set 2.317x speedup, val set 1.010x speedup, step: 2, train time 8.69 s
Epoch 16/50 |loss: 0.173654| train set 2.798x speedup, test set 1.172x speedup, val set 1.003x speedup, step: 3, train time 9.01 s
Epoch 17/50 |loss: 0.168514| train set 2.670x speedup, test set 0.945x speedup, val set 1.017x speedup, step: 4, train time 8.92 s
Epoch 18/50 |loss: 0.164566| train set 2.643x speedup, test set 1.924x speedup, val set 1.047x speedup, step: 5, train time 9.01 s
Epoch 19/50 |loss: 0.168011| train set 2.747x speedup, test set 2.144x speedup, val set 1.012x speedup, step: 6, train time 9.02 s
Epoch 20/50 |loss: 0.163314| train set 2.646x speedup, test set 2.144x speedup, val set 1.055x speedup, step: 7, train time 8.81 s
Epoch 21/50 |loss: 0.159380| train set 2.643x speedup, test set 1.164x speedup, val set 1.648x speedup, step: 8, train time 9.30 s
Epoch 22/50 |loss: 0.156912| train set 2.700x speedup, test set 1.177x speedup, val set 1.647x speedup, step: 9, train time 8.98 s
Epoch 23/50 |loss: 0.145891| train set 2.725x speedup, test set 1.172x speedup, val set 1.005x speedup, step: 10, train time 9.19 s
Epoch 24/50 |loss: 0.148262| train set 2.736x speedup, test set 1.232x speedup, val set 0.998x speedup, step: 11, train time 9.09 s
Epoch 25/50 |loss: 0.148947| train set 2.778x speedup, test set 1.256x speedup, val set 1.053x speedup, step: 12, train time 9.10 s
Epoch 26/50 |loss: 0.149409| train set 2.791x speedup, test set 1.177x speedup, val set 1.008x speedup, step: 13, train time 9.22 s
Epoch 27/50 |loss: 0.141151| train set 2.742x speedup, test set 1.910x speedup, val set 1.012x speedup, step: 14, train time 8.91 s
Epoch 28/50 |loss: 0.141578| train set 2.728x speedup, test set 1.913x speedup, val set 1.053x speedup, step: 15, train time 8.71 s
Epoch 29/50 |loss: 0.131422| train set 2.806x speedup, test set 1.173x speedup, val set 1.631x speedup, step: 16, train time 9.10 s
Epoch 30/50 |loss: 0.135188| train set 2.781x speedup, test set 1.929x speedup, val set 1.048x speedup, step: 17, train time 8.92 s
Epoch 31/50 |loss: 0.134252| train set 2.805x speedup, test set 1.172x speedup, val set 1.007x speedup, step: 18, train time 8.90 s
Epoch 32/50 |loss: 0.126971| train set 2.730x speedup, test set 1.941x speedup, val set 1.052x speedup, step: 19, train time 9.02 s
Epoch 33/50 |loss: 0.131777| train set 2.832x speedup, test set 1.177x speedup, val set 1.750x speedup, step: 20, train time 9.39 s
Epoch 34/50 |loss: 0.125510| train set 2.751x speedup, test set 1.929x speedup, val set 1.007x speedup, step: 21, train time 9.02 s
Epoch 35/50 |loss: 0.128365| train set 2.727x speedup, test set 1.177x speedup, val set 0.978x speedup, step: 22, train time 9.01 s
Epoch 36/50 |loss: 0.124352| train set 2.772x speedup, test set 1.172x speedup, val set 1.631x speedup, step: 23, train time 9.05 s
Epoch 37/50 |loss: 0.122303| train set 2.782x speedup, test set 1.927x speedup, val set 1.635x speedup, step: 24, train time 9.31 s
Epoch 38/50 |loss: 0.121523| train set 2.805x speedup, test set 1.931x speedup, val set 1.007x speedup, step: 25, train time 9.09 s
Epoch 39/50 |loss: 0.119676| train set 2.843x speedup, test set 1.173x speedup, val set 0.978x speedup, step: 26, train time 9.04 s
Epoch 40/50 |loss: 0.114003| train set 2.841x speedup, test set 1.173x speedup, val set 1.648x speedup, step: 27, train time 8.91 s
Epoch 41/50 |loss: 0.114218| train set 2.752x speedup, test set 2.168x speedup, val set 1.747x speedup, step: 28, train time 9.43 s
Epoch 42/50 |loss: 0.116537| train set 2.757x speedup, test set 1.978x speedup, val set 1.006x speedup, step: 29, train time 8.74 s
Epoch 43/50 |loss: 0.113382| train set 2.784x speedup, test set 1.913x speedup, val set 0.981x speedup, step: 30, train time 8.80 s
Epoch 44/50 |loss: 0.115281| train set 2.787x speedup, test set 1.932x speedup, val set 1.635x speedup, step: 31, train time 9.21 s
Epoch 45/50 |loss: 0.116149| train set 2.711x speedup, test set 1.930x speedup, val set 1.053x speedup, step: 32, train time 9.20 s
Epoch 46/50 |loss: 0.108377| train set 2.715x speedup, test set 1.932x speedup, val set 1.635x speedup, step: 33, train time 8.92 s
Epoch 47/50 |loss: 0.115550| train set 2.738x speedup, test set 1.927x speedup, val set 1.050x speedup, step: 34, train time 9.20 s
Epoch 48/50 |loss: 0.108525| train set 2.811x speedup, test set 2.050x speedup, val set 1.010x speedup, step: 35, train time 9.20 s
Epoch 49/50 |loss: 0.106079| train set 2.765x speedup, test set 1.173x speedup, val set 1.635x speedup, step: 36, train time 8.99 s
Training per epoch cost 9.065 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 153.196s, pg runtime 23.223s, speedup 0.152x
18, opt runtime 10.788s, model runtime 149.188s, pg runtime 32.939s, speedup 0.221x
19, opt runtime 1.148s, model runtime 1.942s, pg runtime 1.214s, speedup 0.625x
20, opt runtime 1.353s, model runtime 1.938s, pg runtime 1.380s, speedup 0.712x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
32, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
36, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 3.349s, pg runtime 0.912s, speedup 0.272x
40, opt runtime 0.873s, model runtime 3.070s, pg runtime 0.873s, speedup 0.284x
====================
best train speedup epoch: 39, train speedup 2.843, test speedup 1.173, val speedup 0.978
best test speedup epoch: 1, train speedup 1.866, test speedup 2.555, val speedup 0.979
best validation speedup epoch: 14, train speedup 2.697, test speedup 1.912, val speedup 1.643
last model at epoch 49, train speedup 2.765, test speedup 1.173, val speedup 1.635
execution cost 0:08:05.454742
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.755819, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454922| train set 1.086x speedup, test set 2.533x speedup, val set 1.034x speedup, step: 1, train time 10.25 s
Epoch 1/50 |loss: 0.368237| train set 2.143x speedup, test set 2.529x speedup, val set 1.551x speedup, step: 2, train time 9.21 s
Epoch 2/50 |loss: 0.330559| train set 2.163x speedup, test set 1.334x speedup, val set 1.009x speedup, step: 3, train time 9.09 s
Epoch 3/50 |loss: 0.304792| train set 2.250x speedup, test set 1.269x speedup, val set 1.009x speedup, step: 4, train time 9.58 s
Epoch 4/50 |loss: 0.272723| train set 2.459x speedup, test set 1.278x speedup, val set 1.053x speedup, step: 1, train time 9.22 s
Epoch 5/50 |loss: 0.265125| train set 2.471x speedup, test set 1.316x speedup, val set 1.002x speedup, step: 2, train time 9.31 s
Epoch 6/50 |loss: 0.243995| train set 2.179x speedup, test set 1.209x speedup, val set 1.053x speedup, step: 3, train time 9.11 s
Epoch 7/50 |loss: 0.241977| train set 2.664x speedup, test set 1.313x speedup, val set 1.647x speedup, step: 4, train time 9.51 s
Epoch 8/50 |loss: 0.229135| train set 2.607x speedup, test set 2.234x speedup, val set 1.010x speedup, step: 5, train time 9.32 s
Epoch 9/50 |loss: 0.225054| train set 2.666x speedup, test set 2.085x speedup, val set 1.635x speedup, step: 1, train time 9.21 s
Epoch 10/50 |loss: 0.218103| train set 2.560x speedup, test set 2.204x speedup, val set 1.665x speedup, step: 2, train time 9.28 s
Epoch 11/50 |loss: 0.215168| train set 2.696x speedup, test set 2.240x speedup, val set 1.634x speedup, step: 3, train time 9.10 s
Epoch 12/50 |loss: 0.203827| train set 2.428x speedup, test set 2.244x speedup, val set 1.059x speedup, step: 4, train time 9.40 s
Epoch 13/50 |loss: 0.197809| train set 2.647x speedup, test set 2.257x speedup, val set 1.018x speedup, step: 5, train time 9.29 s
Epoch 14/50 |loss: 0.194940| train set 2.731x speedup, test set 2.105x speedup, val set 1.639x speedup, step: 1, train time 9.09 s
Epoch 15/50 |loss: 0.188786| train set 2.758x speedup, test set 1.293x speedup, val set 1.010x speedup, step: 2, train time 8.99 s
Epoch 16/50 |loss: 0.176959| train set 2.760x speedup, test set 1.280x speedup, val set 1.018x speedup, step: 3, train time 9.41 s
Epoch 17/50 |loss: 0.170624| train set 2.765x speedup, test set 1.287x speedup, val set 1.163x speedup, step: 4, train time 9.18 s
Epoch 18/50 |loss: 0.167522| train set 2.768x speedup, test set 1.297x speedup, val set 1.010x speedup, step: 5, train time 9.02 s
Epoch 19/50 |loss: 0.169137| train set 2.751x speedup, test set 2.231x speedup, val set 1.635x speedup, step: 6, train time 9.20 s
Epoch 20/50 |loss: 0.167931| train set 2.560x speedup, test set 2.325x speedup, val set 1.053x speedup, step: 7, train time 9.11 s
Epoch 21/50 |loss: 0.161641| train set 2.828x speedup, test set 2.275x speedup, val set 1.013x speedup, step: 8, train time 9.21 s
Epoch 22/50 |loss: 0.160767| train set 2.617x speedup, test set 2.318x speedup, val set 1.746x speedup, step: 9, train time 9.19 s
Epoch 23/50 |loss: 0.150832| train set 2.661x speedup, test set 2.317x speedup, val set 1.005x speedup, step: 10, train time 9.28 s
Epoch 24/50 |loss: 0.154730| train set 2.439x speedup, test set 1.280x speedup, val set 1.009x speedup, step: 11, train time 8.91 s
Epoch 25/50 |loss: 0.148971| train set 2.824x speedup, test set 2.273x speedup, val set 1.007x speedup, step: 12, train time 9.12 s
Epoch 26/50 |loss: 0.146441| train set 2.584x speedup, test set 1.229x speedup, val set 1.050x speedup, step: 13, train time 9.39 s
Epoch 27/50 |loss: 0.145543| train set 2.753x speedup, test set 1.242x speedup, val set 1.007x speedup, step: 14, train time 8.91 s
Epoch 28/50 |loss: 0.141241| train set 2.483x speedup, test set 2.217x speedup, val set 1.050x speedup, step: 15, train time 9.53 s
Epoch 29/50 |loss: 0.136453| train set 2.810x speedup, test set 1.247x speedup, val set 1.635x speedup, step: 16, train time 9.30 s
Epoch 30/50 |loss: 0.144202| train set 2.814x speedup, test set 1.229x speedup, val set 1.007x speedup, step: 17, train time 9.01 s
Epoch 31/50 |loss: 0.140431| train set 2.763x speedup, test set 1.280x speedup, val set 1.005x speedup, step: 18, train time 9.11 s
Epoch 32/50 |loss: 0.131577| train set 2.609x speedup, test set 2.165x speedup, val set 1.007x speedup, step: 19, train time 9.09 s
Epoch 33/50 |loss: 0.133090| train set 2.811x speedup, test set 2.162x speedup, val set 1.007x speedup, step: 20, train time 9.31 s
Epoch 34/50 |loss: 0.130973| train set 2.822x speedup, test set 2.241x speedup, val set 1.013x speedup, step: 21, train time 9.29 s
Epoch 35/50 |loss: 0.132528| train set 2.733x speedup, test set 1.283x speedup, val set 1.635x speedup, step: 22, train time 8.83 s
Epoch 36/50 |loss: 0.127076| train set 2.764x speedup, test set 2.178x speedup, val set 1.007x speedup, step: 23, train time 8.99 s
Epoch 37/50 |loss: 0.123936| train set 2.784x speedup, test set 2.186x speedup, val set 1.007x speedup, step: 24, train time 9.09 s
Epoch 38/50 |loss: 0.127297| train set 2.755x speedup, test set 2.073x speedup, val set 1.630x speedup, step: 25, train time 9.49 s
Epoch 39/50 |loss: 0.123816| train set 2.816x speedup, test set 2.268x speedup, val set 1.007x speedup, step: 26, train time 8.81 s
Epoch 40/50 |loss: 0.117507| train set 2.841x speedup, test set 2.216x speedup, val set 1.007x speedup, step: 27, train time 9.22 s
Epoch 41/50 |loss: 0.120745| train set 2.720x speedup, test set 2.386x speedup, val set 1.007x speedup, step: 28, train time 9.31 s
Epoch 42/50 |loss: 0.119309| train set 2.843x speedup, test set 2.199x speedup, val set 1.007x speedup, step: 29, train time 9.50 s
Epoch 43/50 |loss: 0.114960| train set 2.844x speedup, test set 2.442x speedup, val set 1.007x speedup, step: 30, train time 9.41 s
Epoch 44/50 |loss: 0.121233| train set 2.856x speedup, test set 2.048x speedup, val set 1.635x speedup, step: 31, train time 8.79 s
Epoch 45/50 |loss: 0.117183| train set 2.753x speedup, test set 2.261x speedup, val set 1.010x speedup, step: 32, train time 9.21 s
Epoch 46/50 |loss: 0.108583| train set 2.815x speedup, test set 2.271x speedup, val set 1.017x speedup, step: 33, train time 9.30 s
Epoch 47/50 |loss: 0.111397| train set 2.801x speedup, test set 1.641x speedup, val set 1.007x speedup, step: 34, train time 9.18 s
Epoch 48/50 |loss: 0.116022| train set 2.769x speedup, test set 2.248x speedup, val set 1.007x speedup, step: 35, train time 9.21 s
Epoch 49/50 |loss: 0.108969| train set 2.809x speedup, test set 2.208x speedup, val set 1.007x speedup, step: 36, train time 8.92 s
Training per epoch cost 9.216 s
Optimal speedup on test set is 5.622x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
04, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
07, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
08, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
09, opt runtime 3.944s, model runtime 3.944s, pg runtime 3.944s, speedup 1.000x
10, opt runtime 3.603s, model runtime 3.603s, pg runtime 3.603s, speedup 1.000x
11, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
12, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
13, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
14, opt runtime 3.449s, model runtime 4.406s, pg runtime 14.824s, speedup 3.365x
15, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
18, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
19, opt runtime 1.148s, model runtime 1.214s, pg runtime 1.214s, speedup 1.000x
20, opt runtime 1.353s, model runtime 1.380s, pg runtime 1.380s, speedup 1.000x
21, opt runtime 22.482s, model runtime 28.453s, pg runtime 22.482s, speedup 0.790x
22, opt runtime 6.519s, model runtime 30.772s, pg runtime 6.519s, speedup 0.212x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.404s, model runtime 2.441s, pg runtime 1.404s, speedup 0.575x
27, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
28, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
29, opt runtime 5.362s, model runtime 5.362s, pg runtime 5.362s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
32, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
33, opt runtime 38.718s, model runtime 85.791s, pg runtime 69.421s, speedup 0.809x
34, opt runtime 35.527s, model runtime 105.138s, pg runtime 71.730s, speedup 0.682x
35, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
36, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
37, opt runtime 11.120s, model runtime 102.925s, pg runtime 11.120s, speedup 0.108x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 0.912s, model runtime 12.526s, pg runtime 0.912s, speedup 0.073x
40, opt runtime 0.873s, model runtime 11.469s, pg runtime 0.873s, speedup 0.076x
====================
best train speedup epoch: 44, train speedup 2.856, test speedup 2.048, val speedup 1.635
best test speedup epoch: 0, train speedup 1.086, test speedup 2.533, val speedup 1.034
best validation speedup epoch: 14, train speedup 2.731, test speedup 2.105, val speedup 1.639
last model at epoch 49, train speedup 2.809, test speedup 2.208, val speedup 1.007
execution cost 0:08:12.623146
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.720286, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454539| train set 1.086x speedup, test set 2.440x speedup, val set 1.025x speedup, step: 1, train time 9.85 s
Epoch 1/50 |loss: 0.367406| train set 1.922x speedup, test set 2.391x speedup, val set 0.979x speedup, step: 2, train time 8.70 s
Epoch 2/50 |loss: 0.330793| train set 2.263x speedup, test set 2.427x speedup, val set 1.002x speedup, step: 3, train time 9.22 s
Epoch 3/50 |loss: 0.305064| train set 2.290x speedup, test set 2.231x speedup, val set 1.009x speedup, step: 4, train time 9.61 s
Epoch 4/50 |loss: 0.271460| train set 2.376x speedup, test set 1.747x speedup, val set 1.048x speedup, step: 1, train time 9.21 s
Epoch 5/50 |loss: 0.262508| train set 2.484x speedup, test set 1.239x speedup, val set 1.004x speedup, step: 2, train time 8.80 s
Epoch 6/50 |loss: 0.244746| train set 2.193x speedup, test set 1.546x speedup, val set 1.208x speedup, step: 3, train time 9.00 s
Epoch 7/50 |loss: 0.236448| train set 2.646x speedup, test set 2.264x speedup, val set 1.007x speedup, step: 4, train time 9.10 s
Epoch 8/50 |loss: 0.222830| train set 2.563x speedup, test set 2.183x speedup, val set 1.152x speedup, step: 5, train time 9.32 s
Epoch 9/50 |loss: 0.218431| train set 2.351x speedup, test set 1.549x speedup, val set 1.010x speedup, step: 6, train time 9.34 s
Epoch 10/50 |loss: 0.214886| train set 2.673x speedup, test set 1.567x speedup, val set 1.163x speedup, step: 7, train time 9.19 s
Epoch 11/50 |loss: 0.206526| train set 2.764x speedup, test set 2.261x speedup, val set 1.154x speedup, step: 8, train time 8.70 s
Epoch 12/50 |loss: 0.199503| train set 2.646x speedup, test set 1.341x speedup, val set 1.055x speedup, step: 9, train time 8.70 s
Epoch 13/50 |loss: 0.192092| train set 2.701x speedup, test set 2.282x speedup, val set 2.089x speedup, step: 10, train time 8.59 s
Epoch 14/50 |loss: 0.192234| train set 2.713x speedup, test set 2.325x speedup, val set 1.165x speedup, step: 1, train time 8.89 s
Epoch 15/50 |loss: 0.182056| train set 2.751x speedup, test set 2.225x speedup, val set 1.161x speedup, step: 2, train time 8.69 s
Epoch 16/50 |loss: 0.171521| train set 2.730x speedup, test set 2.284x speedup, val set 1.154x speedup, step: 3, train time 8.82 s
Epoch 17/50 |loss: 0.166983| train set 2.739x speedup, test set 1.501x speedup, val set 1.163x speedup, step: 4, train time 8.79 s
Epoch 18/50 |loss: 0.163837| train set 2.739x speedup, test set 1.568x speedup, val set 1.146x speedup, step: 5, train time 8.81 s
Epoch 19/50 |loss: 0.168554| train set 2.758x speedup, test set 2.225x speedup, val set 1.050x speedup, step: 6, train time 9.11 s
Epoch 20/50 |loss: 0.166915| train set 2.763x speedup, test set 2.136x speedup, val set 1.204x speedup, step: 7, train time 10.71 s
Epoch 21/50 |loss: 0.161055| train set 2.755x speedup, test set 2.132x speedup, val set 1.018x speedup, step: 8, train time 9.29 s
Epoch 22/50 |loss: 0.153156| train set 2.698x speedup, test set 2.246x speedup, val set 1.053x speedup, step: 9, train time 10.31 s
Epoch 23/50 |loss: 0.147770| train set 2.628x speedup, test set 1.329x speedup, val set 1.264x speedup, step: 10, train time 9.21 s
Epoch 24/50 |loss: 0.151484| train set 2.620x speedup, test set 2.238x speedup, val set 1.052x speedup, step: 11, train time 9.04 s
Epoch 25/50 |loss: 0.152389| train set 2.779x speedup, test set 2.191x speedup, val set 1.148x speedup, step: 12, train time 8.90 s
Epoch 26/50 |loss: 0.146226| train set 2.762x speedup, test set 2.249x speedup, val set 1.204x speedup, step: 13, train time 8.81 s
Epoch 27/50 |loss: 0.140489| train set 2.745x speedup, test set 2.293x speedup, val set 1.148x speedup, step: 14, train time 8.81 s
Epoch 28/50 |loss: 0.139069| train set 2.785x speedup, test set 2.212x speedup, val set 1.204x speedup, step: 15, train time 8.90 s
Epoch 29/50 |loss: 0.133380| train set 2.763x speedup, test set 2.258x speedup, val set 1.210x speedup, step: 1, train time 9.20 s
Epoch 30/50 |loss: 0.140804| train set 2.783x speedup, test set 2.185x speedup, val set 1.053x speedup, step: 2, train time 8.93 s
Epoch 31/50 |loss: 0.137976| train set 2.764x speedup, test set 2.201x speedup, val set 1.146x speedup, step: 3, train time 9.02 s
Epoch 32/50 |loss: 0.127878| train set 2.760x speedup, test set 2.147x speedup, val set 1.148x speedup, step: 4, train time 9.21 s
Epoch 33/50 |loss: 0.130037| train set 2.787x speedup, test set 2.111x speedup, val set 1.204x speedup, step: 5, train time 9.09 s
Epoch 34/50 |loss: 0.128398| train set 2.794x speedup, test set 2.240x speedup, val set 1.005x speedup, step: 6, train time 8.81 s
Epoch 35/50 |loss: 0.128382| train set 2.767x speedup, test set 2.240x speedup, val set 1.204x speedup, step: 7, train time 8.92 s
Epoch 36/50 |loss: 0.128857| train set 2.758x speedup, test set 2.258x speedup, val set 1.148x speedup, step: 8, train time 8.80 s
Epoch 37/50 |loss: 0.121296| train set 2.816x speedup, test set 2.241x speedup, val set 1.157x speedup, step: 9, train time 9.09 s
Epoch 38/50 |loss: 0.123448| train set 2.721x speedup, test set 2.240x speedup, val set 1.204x speedup, step: 10, train time 9.21 s
Epoch 39/50 |loss: 0.121634| train set 2.578x speedup, test set 2.201x speedup, val set 1.204x speedup, step: 11, train time 8.79 s
Epoch 40/50 |loss: 0.117511| train set 2.781x speedup, test set 2.258x speedup, val set 1.156x speedup, step: 12, train time 9.23 s
Epoch 41/50 |loss: 0.116892| train set 2.794x speedup, test set 2.184x speedup, val set 2.037x speedup, step: 13, train time 8.90 s
Epoch 42/50 |loss: 0.117335| train set 2.821x speedup, test set 2.240x speedup, val set 1.204x speedup, step: 14, train time 8.83 s
Epoch 43/50 |loss: 0.118736| train set 2.824x speedup, test set 2.239x speedup, val set 1.148x speedup, step: 15, train time 9.09 s
Epoch 44/50 |loss: 0.125738| train set 2.857x speedup, test set 2.229x speedup, val set 1.005x speedup, step: 16, train time 9.01 s
Epoch 45/50 |loss: 0.117207| train set 2.716x speedup, test set 2.229x speedup, val set 1.204x speedup, step: 17, train time 8.81 s
Epoch 46/50 |loss: 0.107516| train set 2.781x speedup, test set 2.200x speedup, val set 1.013x speedup, step: 18, train time 8.91 s
Epoch 47/50 |loss: 0.118988| train set 2.834x speedup, test set 2.240x speedup, val set 1.148x speedup, step: 19, train time 8.99 s
Epoch 48/50 |loss: 0.112317| train set 2.764x speedup, test set 2.240x speedup, val set 1.204x speedup, step: 20, train time 9.11 s
Epoch 49/50 |loss: 0.104807| train set 2.814x speedup, test set 2.240x speedup, val set 1.007x speedup, step: 21, train time 8.90 s
Training per epoch cost 9.066 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
18, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 2.482s, pg runtime 1.306s, speedup 0.526x
26, opt runtime 1.342s, model runtime 2.395s, pg runtime 1.342s, speedup 0.561x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 47.614s, pg runtime 70.116s, speedup 1.473x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
36, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
37, opt runtime 15.754s, model runtime 117.458s, pg runtime 15.754s, speedup 0.134x
38, opt runtime 13.961s, model runtime 116.476s, pg runtime 13.961s, speedup 0.120x
39, opt runtime 1.098s, model runtime 12.301s, pg runtime 1.100s, speedup 0.089x
40, opt runtime 1.084s, model runtime 13.180s, pg runtime 1.155s, speedup 0.088x
====================
best train speedup epoch: 44, train speedup 2.857, test speedup 2.229, val speedup 1.005
best test speedup epoch: 0, train speedup 1.086, test speedup 2.440, val speedup 1.025
best validation speedup epoch: 29, train speedup 2.763, test speedup 2.258, val speedup 1.210
last model at epoch 49, train speedup 2.814, test speedup 2.240, val speedup 1.007
execution cost 0:08:05.937797
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.706814, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454067| train set 1.131x speedup, test set 2.452x speedup, val set 1.034x speedup, step: 1, train time 9.94 s
Epoch 1/50 |loss: 0.368131| train set 1.822x speedup, test set 1.299x speedup, val set 0.977x speedup, step: 2, train time 8.90 s
Epoch 2/50 |loss: 0.330521| train set 2.141x speedup, test set 1.343x speedup, val set 1.003x speedup, step: 3, train time 8.92 s
Epoch 3/50 |loss: 0.300051| train set 2.231x speedup, test set 1.000x speedup, val set 0.893x speedup, step: 4, train time 9.89 s
Epoch 4/50 |loss: 0.268960| train set 2.191x speedup, test set 1.001x speedup, val set 1.051x speedup, step: 1, train time 8.80 s
Epoch 5/50 |loss: 0.261360| train set 2.407x speedup, test set 1.315x speedup, val set 1.010x speedup, step: 2, train time 9.22 s
Epoch 6/50 |loss: 0.240444| train set 2.357x speedup, test set 0.982x speedup, val set 1.051x speedup, step: 3, train time 8.90 s
Epoch 7/50 |loss: 0.233210| train set 2.634x speedup, test set 1.004x speedup, val set 1.648x speedup, step: 4, train time 9.21 s
Epoch 8/50 |loss: 0.222976| train set 2.611x speedup, test set 0.988x speedup, val set 1.008x speedup, step: 5, train time 8.72 s
Epoch 9/50 |loss: 0.217070| train set 2.629x speedup, test set 1.073x speedup, val set 1.010x speedup, step: 6, train time 9.30 s
Epoch 10/50 |loss: 0.212937| train set 2.683x speedup, test set 2.135x speedup, val set 1.635x speedup, step: 7, train time 9.21 s
Epoch 11/50 |loss: 0.210530| train set 2.738x speedup, test set 1.248x speedup, val set 1.666x speedup, step: 8, train time 8.90 s
Epoch 12/50 |loss: 0.197160| train set 2.791x speedup, test set 1.239x speedup, val set 1.766x speedup, step: 9, train time 9.15 s
Epoch 13/50 |loss: 0.193857| train set 2.731x speedup, test set 1.250x speedup, val set 1.665x speedup, step: 10, train time 9.80 s
Epoch 14/50 |loss: 0.186876| train set 2.758x speedup, test set 1.247x speedup, val set 1.643x speedup, step: 1, train time 9.22 s
Epoch 15/50 |loss: 0.182610| train set 2.782x speedup, test set 1.255x speedup, val set 1.748x speedup, step: 2, train time 9.71 s
Epoch 16/50 |loss: 0.173702| train set 2.573x speedup, test set 0.890x speedup, val set 1.018x speedup, step: 3, train time 8.91 s
Epoch 17/50 |loss: 0.164986| train set 2.838x speedup, test set 1.248x speedup, val set 1.665x speedup, step: 4, train time 8.92 s
Epoch 18/50 |loss: 0.161626| train set 2.773x speedup, test set 1.248x speedup, val set 1.007x speedup, step: 5, train time 9.22 s
Epoch 19/50 |loss: 0.165823| train set 2.750x speedup, test set 1.249x speedup, val set 1.648x speedup, step: 1, train time 9.12 s
Epoch 20/50 |loss: 0.164041| train set 2.580x speedup, test set 1.202x speedup, val set 1.055x speedup, step: 2, train time 9.01 s
Epoch 21/50 |loss: 0.155809| train set 2.764x speedup, test set 1.251x speedup, val set 1.665x speedup, step: 3, train time 9.00 s
Epoch 22/50 |loss: 0.155335| train set 2.766x speedup, test set 1.255x speedup, val set 1.643x speedup, step: 4, train time 9.00 s
Epoch 23/50 |loss: 0.144321| train set 2.721x speedup, test set 1.192x speedup, val set 1.050x speedup, step: 5, train time 9.01 s
Epoch 24/50 |loss: 0.148040| train set 2.625x speedup, test set 0.985x speedup, val set 1.751x speedup, step: 1, train time 8.59 s
Epoch 25/50 |loss: 0.146352| train set 2.830x speedup, test set 0.985x speedup, val set 1.635x speedup, step: 2, train time 9.02 s
Epoch 26/50 |loss: 0.146313| train set 2.530x speedup, test set 1.185x speedup, val set 1.050x speedup, step: 3, train time 8.89 s
Epoch 27/50 |loss: 0.141813| train set 2.745x speedup, test set 1.215x speedup, val set 1.018x speedup, step: 4, train time 8.52 s
Epoch 28/50 |loss: 0.140576| train set 2.735x speedup, test set 1.257x speedup, val set 1.766x speedup, step: 5, train time 9.04 s
Epoch 29/50 |loss: 0.130334| train set 2.753x speedup, test set 1.166x speedup, val set 1.753x speedup, step: 1, train time 9.13 s
Epoch 30/50 |loss: 0.139981| train set 2.810x speedup, test set 0.974x speedup, val set 1.753x speedup, step: 2, train time 8.92 s
Epoch 31/50 |loss: 0.136480| train set 2.802x speedup, test set 1.239x speedup, val set 1.048x speedup, step: 3, train time 8.53 s
Epoch 32/50 |loss: 0.127498| train set 2.733x speedup, test set 0.876x speedup, val set 1.053x speedup, step: 4, train time 9.41 s
Epoch 33/50 |loss: 0.129168| train set 2.818x speedup, test set 0.876x speedup, val set 1.753x speedup, step: 5, train time 9.42 s
Epoch 34/50 |loss: 0.132874| train set 2.737x speedup, test set 1.234x speedup, val set 1.013x speedup, step: 6, train time 8.91 s
Epoch 35/50 |loss: 0.129234| train set 2.836x speedup, test set 0.985x speedup, val set 1.635x speedup, step: 7, train time 9.12 s
Epoch 36/50 |loss: 0.125166| train set 2.738x speedup, test set 1.230x speedup, val set 1.050x speedup, step: 8, train time 8.88 s
Epoch 37/50 |loss: 0.123175| train set 2.741x speedup, test set 1.200x speedup, val set 1.635x speedup, step: 9, train time 9.01 s
Epoch 38/50 |loss: 0.122790| train set 2.806x speedup, test set 0.885x speedup, val set 1.630x speedup, step: 10, train time 9.11 s
Epoch 39/50 |loss: 0.121361| train set 2.558x speedup, test set 2.055x speedup, val set 1.050x speedup, step: 11, train time 8.81 s
Epoch 40/50 |loss: 0.117636| train set 2.841x speedup, test set 2.035x speedup, val set 1.635x speedup, step: 12, train time 9.11 s
Epoch 41/50 |loss: 0.114818| train set 2.815x speedup, test set 2.131x speedup, val set 1.011x speedup, step: 13, train time 8.99 s
Epoch 42/50 |loss: 0.116663| train set 2.847x speedup, test set 2.069x speedup, val set 1.635x speedup, step: 14, train time 8.90 s
Epoch 43/50 |loss: 0.116732| train set 2.799x speedup, test set 0.900x speedup, val set 1.635x speedup, step: 15, train time 9.01 s
Epoch 44/50 |loss: 0.117849| train set 2.845x speedup, test set 0.876x speedup, val set 1.635x speedup, step: 16, train time 8.82 s
Epoch 45/50 |loss: 0.116116| train set 2.740x speedup, test set 0.946x speedup, val set 1.010x speedup, step: 17, train time 8.71 s
Epoch 46/50 |loss: 0.109968| train set 2.835x speedup, test set 2.136x speedup, val set 1.635x speedup, step: 18, train time 9.21 s
Epoch 47/50 |loss: 0.116204| train set 2.806x speedup, test set 1.542x speedup, val set 1.635x speedup, step: 19, train time 9.19 s
Epoch 48/50 |loss: 0.111092| train set 2.657x speedup, test set 0.876x speedup, val set 1.053x speedup, step: 20, train time 9.00 s
Epoch 49/50 |loss: 0.107700| train set 2.821x speedup, test set 1.263x speedup, val set 1.635x speedup, step: 21, train time 9.01 s
Training per epoch cost 9.065 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 7.110s, model runtime 35.678s, pg runtime 14.286s, speedup 0.400x
08, opt runtime 7.237s, model runtime 39.132s, pg runtime 17.708s, speedup 0.453x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
18, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
19, opt runtime 1.309s, model runtime 1.687s, pg runtime 1.356s, speedup 0.804x
20, opt runtime 1.340s, model runtime 1.855s, pg runtime 1.340s, speedup 0.722x
21, opt runtime 6.281s, model runtime 34.017s, pg runtime 6.281s, speedup 0.185x
22, opt runtime 25.034s, model runtime 37.819s, pg runtime 25.034s, speedup 0.662x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 2.482s, pg runtime 1.306s, speedup 0.526x
26, opt runtime 1.342s, model runtime 2.395s, pg runtime 1.342s, speedup 0.561x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 582.756s, pg runtime 611.327s, speedup 1.049x
32, opt runtime 24.706s, model runtime 591.577s, pg runtime 610.808s, speedup 1.033x
33, opt runtime 35.538s, model runtime 94.699s, pg runtime 70.116s, speedup 0.740x
34, opt runtime 39.191s, model runtime 90.336s, pg runtime 75.984s, speedup 0.841x
35, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
36, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
37, opt runtime 15.754s, model runtime 117.458s, pg runtime 15.754s, speedup 0.134x
38, opt runtime 13.961s, model runtime 116.476s, pg runtime 13.961s, speedup 0.120x
39, opt runtime 1.098s, model runtime 12.301s, pg runtime 1.100s, speedup 0.089x
40, opt runtime 1.084s, model runtime 13.180s, pg runtime 1.155s, speedup 0.088x
====================
best train speedup epoch: 42, train speedup 2.847, test speedup 2.069, val speedup 1.635
best test speedup epoch: 0, train speedup 1.131, test speedup 2.452, val speedup 1.034
best validation speedup epoch: 29, train speedup 2.753, test speedup 1.166, val speedup 1.753
last model at epoch 49, train speedup 2.821, test speedup 1.263, val speedup 1.635
execution cost 0:08:05.442796
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.751170, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454804| train set 1.113x speedup, test set 1.412x speedup, val set 1.034x speedup, step: 1, train time 10.03 s
Epoch 1/50 |loss: 0.368849| train set 1.959x speedup, test set 2.320x speedup, val set 1.555x speedup, step: 2, train time 9.01 s
Epoch 2/50 |loss: 0.335458| train set 2.223x speedup, test set 1.257x speedup, val set 1.001x speedup, step: 3, train time 8.89 s
Epoch 3/50 |loss: 0.306255| train set 2.421x speedup, test set 1.251x speedup, val set 1.009x speedup, step: 4, train time 9.78 s
Epoch 4/50 |loss: 0.272652| train set 2.377x speedup, test set 1.244x speedup, val set 1.053x speedup, step: 1, train time 9.00 s
Epoch 5/50 |loss: 0.261284| train set 2.162x speedup, test set 1.272x speedup, val set 1.053x speedup, step: 2, train time 9.31 s
Epoch 6/50 |loss: 0.243059| train set 2.284x speedup, test set 1.265x speedup, val set 1.208x speedup, step: 3, train time 8.91 s
Epoch 7/50 |loss: 0.237407| train set 2.686x speedup, test set 2.227x speedup, val set 1.623x speedup, step: 4, train time 8.68 s
Epoch 8/50 |loss: 0.223761| train set 2.666x speedup, test set 1.239x speedup, val set 1.152x speedup, step: 5, train time 9.11 s
Epoch 9/50 |loss: 0.218836| train set 2.552x speedup, test set 0.977x speedup, val set 1.010x speedup, step: 6, train time 9.00 s
Epoch 10/50 |loss: 0.214135| train set 2.630x speedup, test set 0.975x speedup, val set 2.062x speedup, step: 7, train time 8.71 s
Epoch 11/50 |loss: 0.208511| train set 2.721x speedup, test set 1.015x speedup, val set 2.025x speedup, step: 8, train time 8.92 s
Epoch 12/50 |loss: 0.204911| train set 2.576x speedup, test set 2.273x speedup, val set 1.198x speedup, step: 9, train time 9.00 s
Epoch 13/50 |loss: 0.189150| train set 2.790x speedup, test set 2.162x speedup, val set 2.062x speedup, step: 10, train time 8.94 s
Epoch 14/50 |loss: 0.190980| train set 2.723x speedup, test set 1.221x speedup, val set 1.643x speedup, step: 1, train time 8.92 s
Epoch 15/50 |loss: 0.183717| train set 2.774x speedup, test set 1.510x speedup, val set 1.152x speedup, step: 2, train time 8.90 s
Epoch 16/50 |loss: 0.174649| train set 2.774x speedup, test set 2.065x speedup, val set 1.152x speedup, step: 3, train time 9.09 s
Epoch 17/50 |loss: 0.167184| train set 2.694x speedup, test set 1.475x speedup, val set 1.163x speedup, step: 4, train time 9.21 s
Epoch 18/50 |loss: 0.161427| train set 2.745x speedup, test set 2.290x speedup, val set 1.008x speedup, step: 5, train time 8.80 s
Epoch 19/50 |loss: 0.169177| train set 2.697x speedup, test set 1.509x speedup, val set 2.063x speedup, step: 1, train time 8.88 s
Epoch 20/50 |loss: 0.166936| train set 2.639x speedup, test set 2.077x speedup, val set 1.055x speedup, step: 2, train time 8.93 s
Epoch 21/50 |loss: 0.159602| train set 2.800x speedup, test set 1.245x speedup, val set 1.017x speedup, step: 3, train time 8.83 s
Epoch 22/50 |loss: 0.152302| train set 2.488x speedup, test set 2.131x speedup, val set 1.093x speedup, step: 4, train time 8.91 s
Epoch 23/50 |loss: 0.145995| train set 2.707x speedup, test set 1.480x speedup, val set 1.047x speedup, step: 5, train time 9.20 s
Epoch 24/50 |loss: 0.147326| train set 2.498x speedup, test set 0.982x speedup, val set 1.048x speedup, step: 6, train time 9.00 s
Epoch 25/50 |loss: 0.149599| train set 2.749x speedup, test set 2.108x speedup, val set 1.148x speedup, step: 7, train time 8.80 s
Epoch 26/50 |loss: 0.144011| train set 2.820x speedup, test set 1.497x speedup, val set 1.267x speedup, step: 8, train time 9.21 s
Epoch 27/50 |loss: 0.143694| train set 2.748x speedup, test set 2.095x speedup, val set 1.005x speedup, step: 9, train time 8.91 s
Epoch 28/50 |loss: 0.135569| train set 2.734x speedup, test set 2.133x speedup, val set 1.010x speedup, step: 10, train time 8.73 s
Epoch 29/50 |loss: 0.130975| train set 2.690x speedup, test set 1.932x speedup, val set 1.049x speedup, step: 11, train time 9.11 s
Epoch 30/50 |loss: 0.138191| train set 2.760x speedup, test set 2.049x speedup, val set 1.010x speedup, step: 12, train time 9.10 s
Epoch 31/50 |loss: 0.132286| train set 2.770x speedup, test set 2.031x speedup, val set 1.093x speedup, step: 13, train time 9.10 s
Epoch 32/50 |loss: 0.126177| train set 2.736x speedup, test set 1.959x speedup, val set 1.095x speedup, step: 14, train time 8.89 s
Epoch 33/50 |loss: 0.131907| train set 2.790x speedup, test set 2.049x speedup, val set 1.049x speedup, step: 15, train time 8.91 s
Epoch 34/50 |loss: 0.129214| train set 2.742x speedup, test set 2.047x speedup, val set 1.007x speedup, step: 16, train time 8.89 s
Epoch 35/50 |loss: 0.126829| train set 2.794x speedup, test set 1.224x speedup, val set 1.010x speedup, step: 17, train time 8.72 s
Epoch 36/50 |loss: 0.126556| train set 2.762x speedup, test set 2.035x speedup, val set 1.005x speedup, step: 18, train time 9.41 s
Epoch 37/50 |loss: 0.121744| train set 2.750x speedup, test set 2.049x speedup, val set 1.005x speedup, step: 19, train time 9.01 s
Epoch 38/50 |loss: 0.121274| train set 2.802x speedup, test set 2.123x speedup, val set 1.047x speedup, step: 20, train time 8.92 s
Epoch 39/50 |loss: 0.120371| train set 2.748x speedup, test set 2.032x speedup, val set 1.046x speedup, step: 21, train time 9.01 s
Epoch 40/50 |loss: 0.117898| train set 2.711x speedup, test set 1.224x speedup, val set 1.047x speedup, step: 22, train time 9.02 s
Epoch 41/50 |loss: 0.114409| train set 2.792x speedup, test set 2.079x speedup, val set 1.005x speedup, step: 23, train time 8.80 s
Epoch 42/50 |loss: 0.114968| train set 2.849x speedup, test set 2.116x speedup, val set 1.005x speedup, step: 24, train time 8.91 s
Epoch 43/50 |loss: 0.117104| train set 2.799x speedup, test set 2.090x speedup, val set 1.053x speedup, step: 25, train time 9.12 s
Epoch 44/50 |loss: 0.119455| train set 2.752x speedup, test set 1.205x speedup, val set 1.005x speedup, step: 26, train time 8.80 s
Epoch 45/50 |loss: 0.118114| train set 2.736x speedup, test set 2.155x speedup, val set 1.046x speedup, step: 27, train time 9.02 s
Epoch 46/50 |loss: 0.108949| train set 2.744x speedup, test set 2.155x speedup, val set 1.005x speedup, step: 28, train time 9.00 s
Epoch 47/50 |loss: 0.114255| train set 2.835x speedup, test set 2.137x speedup, val set 1.005x speedup, step: 29, train time 8.90 s
Epoch 48/50 |loss: 0.111369| train set 2.679x speedup, test set 2.103x speedup, val set 1.005x speedup, step: 30, train time 8.70 s
Epoch 49/50 |loss: 0.107900| train set 2.787x speedup, test set 2.090x speedup, val set 1.049x speedup, step: 31, train time 9.02 s
Training per epoch cost 8.999 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 7.469s, model runtime 38.252s, pg runtime 23.223s, speedup 0.607x
19, opt runtime 1.309s, model runtime 1.871s, pg runtime 1.356s, speedup 0.725x
20, opt runtime 1.340s, model runtime 1.865s, pg runtime 1.340s, speedup 0.719x
21, opt runtime 6.281s, model runtime 33.174s, pg runtime 6.281s, speedup 0.189x
22, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
23, opt runtime 5.961s, model runtime 11.448s, pg runtime 31.210s, speedup 2.726x
24, opt runtime 6.234s, model runtime 11.767s, pg runtime 32.540s, speedup 2.765x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 5.780s, pg runtime 5.414s, speedup 0.937x
30, opt runtime 5.572s, model runtime 5.971s, pg runtime 5.572s, speedup 0.933x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 94.699s, pg runtime 70.116s, speedup 0.740x
34, opt runtime 39.191s, model runtime 90.336s, pg runtime 75.984s, speedup 0.841x
35, opt runtime 16.138s, model runtime 338.316s, pg runtime 501.793s, speedup 1.483x
36, opt runtime 16.438s, model runtime 372.713s, pg runtime 546.887s, speedup 1.467x
37, opt runtime 15.754s, model runtime 117.458s, pg runtime 15.754s, speedup 0.134x
38, opt runtime 13.961s, model runtime 116.476s, pg runtime 13.961s, speedup 0.120x
39, opt runtime 1.098s, model runtime 3.195s, pg runtime 1.100s, speedup 0.344x
40, opt runtime 1.084s, model runtime 3.471s, pg runtime 1.155s, speedup 0.333x
====================
best train speedup epoch: 42, train speedup 2.849, test speedup 2.116, val speedup 1.005
best test speedup epoch: 1, train speedup 1.959, test speedup 2.320, val speedup 1.555
best validation speedup epoch: 19, train speedup 2.697, test speedup 1.509, val speedup 2.063
last model at epoch 49, train speedup 2.787, test speedup 2.090, val speedup 1.049
execution cost 0:08:01.174164
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.693460, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454438| train set 1.088x speedup, test set 1.345x speedup, val set 1.034x speedup, step: 1, train time 10.05 s
Epoch 1/50 |loss: 0.366727| train set 2.023x speedup, test set 2.803x speedup, val set 0.976x speedup, step: 2, train time 8.89 s
Epoch 2/50 |loss: 0.333310| train set 2.176x speedup, test set 0.863x speedup, val set 1.009x speedup, step: 3, train time 9.37 s
Epoch 3/50 |loss: 0.303676| train set 2.225x speedup, test set 0.996x speedup, val set 1.009x speedup, step: 4, train time 9.01 s
Epoch 4/50 |loss: 0.274344| train set 2.485x speedup, test set 1.517x speedup, val set 1.002x speedup, step: 1, train time 9.19 s
Epoch 5/50 |loss: 0.262575| train set 2.275x speedup, test set 0.999x speedup, val set 1.002x speedup, step: 2, train time 8.92 s
Epoch 6/50 |loss: 0.243407| train set 2.281x speedup, test set 1.451x speedup, val set 1.208x speedup, step: 3, train time 8.90 s
Epoch 7/50 |loss: 0.238761| train set 2.743x speedup, test set 1.574x speedup, val set 1.642x speedup, step: 4, train time 8.90 s
Epoch 8/50 |loss: 0.224155| train set 2.753x speedup, test set 1.540x speedup, val set 1.010x speedup, step: 5, train time 8.89 s
Epoch 9/50 |loss: 0.220766| train set 2.546x speedup, test set 0.979x speedup, val set 1.011x speedup, step: 1, train time 8.82 s
Epoch 10/50 |loss: 0.214966| train set 2.597x speedup, test set 1.450x speedup, val set 1.648x speedup, step: 2, train time 8.91 s
Epoch 11/50 |loss: 0.208336| train set 2.674x speedup, test set 1.562x speedup, val set 1.648x speedup, step: 3, train time 9.08 s
Epoch 12/50 |loss: 0.203791| train set 2.568x speedup, test set 2.077x speedup, val set 1.059x speedup, step: 4, train time 8.91 s
Epoch 13/50 |loss: 0.193548| train set 2.690x speedup, test set 0.975x speedup, val set 1.641x speedup, step: 5, train time 8.91 s
Epoch 14/50 |loss: 0.190272| train set 2.579x speedup, test set 1.459x speedup, val set 1.643x speedup, step: 1, train time 8.80 s
Epoch 15/50 |loss: 0.185084| train set 2.783x speedup, test set 1.488x speedup, val set 1.012x speedup, step: 2, train time 8.74 s
Epoch 16/50 |loss: 0.174422| train set 2.739x speedup, test set 1.824x speedup, val set 1.015x speedup, step: 3, train time 9.11 s
Epoch 17/50 |loss: 0.167639| train set 2.734x speedup, test set 0.928x speedup, val set 1.008x speedup, step: 4, train time 8.81 s
Epoch 18/50 |loss: 0.166479| train set 2.748x speedup, test set 1.461x speedup, val set 1.013x speedup, step: 5, train time 9.22 s
Epoch 19/50 |loss: 0.169717| train set 2.755x speedup, test set 0.984x speedup, val set 1.648x speedup, step: 1, train time 8.93 s
Epoch 20/50 |loss: 0.163705| train set 2.782x speedup, test set 1.475x speedup, val set 1.057x speedup, step: 2, train time 8.82 s
Epoch 21/50 |loss: 0.160979| train set 2.645x speedup, test set 2.175x speedup, val set 1.018x speedup, step: 3, train time 8.81 s
Epoch 22/50 |loss: 0.154636| train set 2.721x speedup, test set 1.440x speedup, val set 1.012x speedup, step: 4, train time 8.53 s
Epoch 23/50 |loss: 0.147368| train set 2.716x speedup, test set 2.191x speedup, val set 1.010x speedup, step: 5, train time 8.91 s
Epoch 24/50 |loss: 0.152468| train set 2.604x speedup, test set 1.462x speedup, val set 0.999x speedup, step: 6, train time 9.18 s
Epoch 25/50 |loss: 0.150426| train set 2.810x speedup, test set 1.516x speedup, val set 0.994x speedup, step: 7, train time 9.01 s
Epoch 26/50 |loss: 0.146816| train set 2.769x speedup, test set 1.532x speedup, val set 0.994x speedup, step: 8, train time 8.90 s
Epoch 27/50 |loss: 0.141464| train set 2.756x speedup, test set 2.172x speedup, val set 1.018x speedup, step: 9, train time 8.99 s
Epoch 28/50 |loss: 0.142301| train set 2.614x speedup, test set 1.483x speedup, val set 1.037x speedup, step: 10, train time 8.91 s
Epoch 29/50 |loss: 0.132482| train set 2.805x speedup, test set 2.178x speedup, val set 0.995x speedup, step: 11, train time 9.02 s
Epoch 30/50 |loss: 0.137995| train set 2.787x speedup, test set 1.353x speedup, val set 1.012x speedup, step: 12, train time 8.80 s
Epoch 31/50 |loss: 0.140188| train set 2.658x speedup, test set 2.191x speedup, val set 1.010x speedup, step: 13, train time 8.99 s
Epoch 32/50 |loss: 0.131246| train set 2.513x speedup, test set 1.518x speedup, val set 1.036x speedup, step: 14, train time 8.91 s
Epoch 33/50 |loss: 0.129745| train set 2.821x speedup, test set 2.023x speedup, val set 1.012x speedup, step: 15, train time 8.79 s
Epoch 34/50 |loss: 0.129326| train set 2.800x speedup, test set 1.534x speedup, val set 0.994x speedup, step: 16, train time 8.91 s
Epoch 35/50 |loss: 0.124853| train set 2.781x speedup, test set 2.175x speedup, val set 0.995x speedup, step: 17, train time 9.31 s
Epoch 36/50 |loss: 0.130713| train set 2.756x speedup, test set 2.192x speedup, val set 0.995x speedup, step: 18, train time 8.92 s
Epoch 37/50 |loss: 0.123882| train set 2.767x speedup, test set 2.191x speedup, val set 1.605x speedup, step: 19, train time 8.80 s
Epoch 38/50 |loss: 0.123441| train set 2.786x speedup, test set 2.191x speedup, val set 0.994x speedup, step: 20, train time 9.10 s
Epoch 39/50 |loss: 0.119336| train set 2.805x speedup, test set 2.225x speedup, val set 1.010x speedup, step: 21, train time 9.21 s
Epoch 40/50 |loss: 0.118279| train set 2.771x speedup, test set 1.523x speedup, val set 0.995x speedup, step: 22, train time 8.90 s
Epoch 41/50 |loss: 0.115646| train set 2.777x speedup, test set 1.540x speedup, val set 1.007x speedup, step: 23, train time 8.81 s
Epoch 42/50 |loss: 0.118502| train set 2.795x speedup, test set 1.984x speedup, val set 1.007x speedup, step: 24, train time 8.92 s
Epoch 43/50 |loss: 0.118843| train set 2.787x speedup, test set 1.460x speedup, val set 0.994x speedup, step: 25, train time 8.82 s
Epoch 44/50 |loss: 0.121956| train set 2.787x speedup, test set 2.226x speedup, val set 0.994x speedup, step: 26, train time 8.91 s
Epoch 45/50 |loss: 0.117306| train set 2.687x speedup, test set 2.191x speedup, val set 1.007x speedup, step: 27, train time 8.72 s
Epoch 46/50 |loss: 0.110352| train set 2.815x speedup, test set 2.163x speedup, val set 1.012x speedup, step: 28, train time 8.72 s
Epoch 47/50 |loss: 0.115895| train set 2.832x speedup, test set 1.909x speedup, val set 1.007x speedup, step: 29, train time 8.90 s
Epoch 48/50 |loss: 0.108302| train set 2.635x speedup, test set 2.225x speedup, val set 0.994x speedup, step: 30, train time 9.21 s
Epoch 49/50 |loss: 0.109083| train set 2.778x speedup, test set 2.191x speedup, val set 0.995x speedup, step: 31, train time 8.73 s
Training per epoch cost 8.957 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
18, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
19, opt runtime 1.309s, model runtime 1.871s, pg runtime 1.356s, speedup 0.725x
20, opt runtime 1.340s, model runtime 1.865s, pg runtime 1.340s, speedup 0.719x
21, opt runtime 6.281s, model runtime 22.977s, pg runtime 6.281s, speedup 0.273x
22, opt runtime 25.034s, model runtime 31.752s, pg runtime 25.034s, speedup 0.788x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 2.482s, pg runtime 1.306s, speedup 0.526x
26, opt runtime 1.342s, model runtime 2.395s, pg runtime 1.342s, speedup 0.561x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 582.756s, pg runtime 611.327s, speedup 1.049x
32, opt runtime 24.706s, model runtime 591.577s, pg runtime 610.808s, speedup 1.033x
33, opt runtime 35.538s, model runtime 94.699s, pg runtime 70.116s, speedup 0.740x
34, opt runtime 39.191s, model runtime 90.336s, pg runtime 75.984s, speedup 0.841x
35, opt runtime 16.138s, model runtime 338.316s, pg runtime 501.793s, speedup 1.483x
36, opt runtime 16.438s, model runtime 372.713s, pg runtime 546.887s, speedup 1.467x
37, opt runtime 15.754s, model runtime 117.458s, pg runtime 15.754s, speedup 0.134x
38, opt runtime 13.961s, model runtime 116.476s, pg runtime 13.961s, speedup 0.120x
39, opt runtime 1.098s, model runtime 12.301s, pg runtime 1.100s, speedup 0.089x
40, opt runtime 1.084s, model runtime 13.180s, pg runtime 1.155s, speedup 0.088x
====================
best train speedup epoch: 47, train speedup 2.832, test speedup 1.909, val speedup 1.007
best test speedup epoch: 1, train speedup 2.023, test speedup 2.803, val speedup 0.976
best validation speedup epoch: 19, train speedup 2.755, test speedup 0.984, val speedup 1.648
last model at epoch 49, train speedup 2.778, test speedup 2.191, val speedup 0.995
execution cost 0:07:59.154052
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.757138, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454436| train set 1.145x speedup, test set 2.364x speedup, val set 1.033x speedup, step: 1, train time 10.17 s
Epoch 1/50 |loss: 0.369238| train set 2.044x speedup, test set 1.267x speedup, val set 0.977x speedup, step: 2, train time 8.92 s
Epoch 2/50 |loss: 0.336365| train set 2.183x speedup, test set 1.223x speedup, val set 1.640x speedup, step: 3, train time 9.01 s
Epoch 3/50 |loss: 0.305856| train set 1.969x speedup, test set 1.234x speedup, val set 0.893x speedup, step: 4, train time 9.64 s
Epoch 4/50 |loss: 0.274265| train set 2.044x speedup, test set 0.990x speedup, val set 1.048x speedup, step: 1, train time 9.50 s
Epoch 5/50 |loss: 0.262790| train set 2.358x speedup, test set 1.517x speedup, val set 1.001x speedup, step: 2, train time 8.81 s
Epoch 6/50 |loss: 0.245882| train set 2.213x speedup, test set 1.008x speedup, val set 1.051x speedup, step: 3, train time 8.92 s
Epoch 7/50 |loss: 0.240827| train set 2.596x speedup, test set 1.044x speedup, val set 1.623x speedup, step: 4, train time 8.92 s
Epoch 8/50 |loss: 0.225745| train set 2.566x speedup, test set 1.261x speedup, val set 1.008x speedup, step: 5, train time 8.81 s
Epoch 9/50 |loss: 0.221123| train set 2.291x speedup, test set 0.990x speedup, val set 1.010x speedup, step: 6, train time 9.23 s
Epoch 10/50 |loss: 0.216917| train set 2.585x speedup, test set 0.952x speedup, val set 1.154x speedup, step: 7, train time 9.59 s
Epoch 11/50 |loss: 0.207437| train set 2.714x speedup, test set 0.965x speedup, val set 1.016x speedup, step: 8, train time 8.99 s
Epoch 12/50 |loss: 0.201003| train set 2.740x speedup, test set 1.244x speedup, val set 1.198x speedup, step: 9, train time 8.90 s
Epoch 13/50 |loss: 0.194528| train set 2.686x speedup, test set 0.980x speedup, val set 2.091x speedup, step: 10, train time 8.82 s
Epoch 14/50 |loss: 0.191023| train set 2.511x speedup, test set 1.220x speedup, val set 1.639x speedup, step: 1, train time 8.99 s
Epoch 15/50 |loss: 0.184079| train set 2.720x speedup, test set 1.254x speedup, val set 1.643x speedup, step: 2, train time 8.71 s
Epoch 16/50 |loss: 0.173192| train set 2.756x speedup, test set 1.251x speedup, val set 1.010x speedup, step: 3, train time 9.11 s
Epoch 17/50 |loss: 0.169260| train set 2.734x speedup, test set 1.223x speedup, val set 1.163x speedup, step: 4, train time 9.60 s
Epoch 18/50 |loss: 0.166310| train set 2.774x speedup, test set 1.591x speedup, val set 1.048x speedup, step: 5, train time 8.81 s
Epoch 19/50 |loss: 0.168756| train set 2.571x speedup, test set 1.268x speedup, val set 1.766x speedup, step: 1, train time 9.10 s
Epoch 20/50 |loss: 0.168770| train set 2.640x speedup, test set 2.235x speedup, val set 1.005x speedup, step: 2, train time 8.89 s
Epoch 21/50 |loss: 0.158259| train set 2.740x speedup, test set 2.232x speedup, val set 1.018x speedup, step: 3, train time 9.31 s
Epoch 22/50 |loss: 0.161014| train set 2.753x speedup, test set 2.232x speedup, val set 1.012x speedup, step: 4, train time 9.10 s
Epoch 23/50 |loss: 0.144633| train set 2.743x speedup, test set 2.086x speedup, val set 1.005x speedup, step: 5, train time 9.11 s
Epoch 24/50 |loss: 0.151717| train set 2.531x speedup, test set 2.040x speedup, val set 0.996x speedup, step: 6, train time 9.01 s
Epoch 25/50 |loss: 0.153129| train set 2.801x speedup, test set 1.543x speedup, val set 1.007x speedup, step: 7, train time 9.09 s
Epoch 26/50 |loss: 0.145727| train set 2.791x speedup, test set 2.081x speedup, val set 1.046x speedup, step: 8, train time 8.71 s
Epoch 27/50 |loss: 0.142571| train set 2.750x speedup, test set 2.091x speedup, val set 1.006x speedup, step: 9, train time 9.20 s
Epoch 28/50 |loss: 0.136743| train set 2.752x speedup, test set 2.177x speedup, val set 1.005x speedup, step: 10, train time 8.91 s
Epoch 29/50 |loss: 0.133065| train set 2.817x speedup, test set 2.088x speedup, val set 1.050x speedup, step: 11, train time 9.30 s
Epoch 30/50 |loss: 0.140216| train set 2.782x speedup, test set 2.037x speedup, val set 1.005x speedup, step: 12, train time 9.22 s
Epoch 31/50 |loss: 0.134921| train set 2.781x speedup, test set 2.088x speedup, val set 1.005x speedup, step: 13, train time 9.30 s
Epoch 32/50 |loss: 0.127254| train set 2.605x speedup, test set 2.040x speedup, val set 1.050x speedup, step: 14, train time 9.21 s
Epoch 33/50 |loss: 0.131267| train set 2.812x speedup, test set 2.236x speedup, val set 1.005x speedup, step: 15, train time 8.79 s
Epoch 34/50 |loss: 0.131935| train set 2.780x speedup, test set 2.102x speedup, val set 1.007x speedup, step: 16, train time 8.81 s
Epoch 35/50 |loss: 0.129121| train set 2.772x speedup, test set 2.086x speedup, val set 1.005x speedup, step: 17, train time 9.01 s
Epoch 36/50 |loss: 0.126754| train set 2.787x speedup, test set 2.088x speedup, val set 1.010x speedup, step: 18, train time 9.09 s
Epoch 37/50 |loss: 0.121928| train set 2.779x speedup, test set 2.235x speedup, val set 1.005x speedup, step: 19, train time 9.00 s
Epoch 38/50 |loss: 0.119931| train set 2.778x speedup, test set 2.107x speedup, val set 1.008x speedup, step: 20, train time 8.93 s
Epoch 39/50 |loss: 0.122206| train set 2.843x speedup, test set 2.091x speedup, val set 1.048x speedup, step: 21, train time 9.02 s
Epoch 40/50 |loss: 0.117508| train set 2.839x speedup, test set 2.088x speedup, val set 1.005x speedup, step: 22, train time 8.82 s
Epoch 41/50 |loss: 0.119369| train set 2.778x speedup, test set 2.091x speedup, val set 1.007x speedup, step: 23, train time 8.92 s
Epoch 42/50 |loss: 0.117105| train set 2.806x speedup, test set 2.232x speedup, val set 1.007x speedup, step: 24, train time 9.11 s
Epoch 43/50 |loss: 0.114479| train set 2.812x speedup, test set 2.104x speedup, val set 1.053x speedup, step: 25, train time 8.91 s
Epoch 44/50 |loss: 0.122156| train set 2.831x speedup, test set 2.052x speedup, val set 1.007x speedup, step: 26, train time 9.21 s
Epoch 45/50 |loss: 0.117527| train set 2.714x speedup, test set 2.091x speedup, val set 1.005x speedup, step: 27, train time 8.81 s
Epoch 46/50 |loss: 0.108889| train set 2.696x speedup, test set 2.085x speedup, val set 1.005x speedup, step: 28, train time 8.90 s
Epoch 47/50 |loss: 0.114163| train set 2.833x speedup, test set 2.232x speedup, val set 1.007x speedup, step: 29, train time 9.10 s
Epoch 48/50 |loss: 0.110363| train set 2.704x speedup, test set 2.086x speedup, val set 1.005x speedup, step: 30, train time 8.93 s
Epoch 49/50 |loss: 0.104650| train set 2.809x speedup, test set 2.091x speedup, val set 1.007x speedup, step: 31, train time 9.02 s
Training per epoch cost 9.066 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 49.702s, pg runtime 32.278s, speedup 0.649x
06, opt runtime 19.263s, model runtime 52.565s, pg runtime 19.263s, speedup 0.366x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
18, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
19, opt runtime 1.309s, model runtime 1.871s, pg runtime 1.356s, speedup 0.725x
20, opt runtime 1.340s, model runtime 1.865s, pg runtime 1.340s, speedup 0.719x
21, opt runtime 6.281s, model runtime 33.174s, pg runtime 6.281s, speedup 0.189x
22, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 2.482s, pg runtime 1.306s, speedup 0.526x
26, opt runtime 1.342s, model runtime 2.395s, pg runtime 1.342s, speedup 0.561x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 6.567s, pg runtime 5.414s, speedup 0.824x
30, opt runtime 5.572s, model runtime 6.580s, pg runtime 5.572s, speedup 0.847x
31, opt runtime 25.363s, model runtime 582.756s, pg runtime 611.327s, speedup 1.049x
32, opt runtime 24.706s, model runtime 591.577s, pg runtime 610.808s, speedup 1.033x
33, opt runtime 35.538s, model runtime 94.699s, pg runtime 70.116s, speedup 0.740x
34, opt runtime 39.191s, model runtime 90.336s, pg runtime 75.984s, speedup 0.841x
35, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
36, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
37, opt runtime 15.754s, model runtime 72.187s, pg runtime 15.754s, speedup 0.218x
38, opt runtime 13.961s, model runtime 59.559s, pg runtime 13.961s, speedup 0.234x
39, opt runtime 1.098s, model runtime 12.301s, pg runtime 1.100s, speedup 0.089x
40, opt runtime 1.084s, model runtime 13.180s, pg runtime 1.155s, speedup 0.088x
====================
best train speedup epoch: 39, train speedup 2.843, test speedup 2.091, val speedup 1.048
best test speedup epoch: 0, train speedup 1.145, test speedup 2.364, val speedup 1.033
best validation speedup epoch: 19, train speedup 2.571, test speedup 1.268, val speedup 1.766
last model at epoch 49, train speedup 2.809, test speedup 2.091, val speedup 1.007
execution cost 0:08:05.856319
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.715329, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454399| train set 1.134x speedup, test set 2.284x speedup, val set 1.034x speedup, step: 1, train time 10.15 s
Epoch 1/50 |loss: 0.368753| train set 2.193x speedup, test set 2.152x speedup, val set 1.551x speedup, step: 2, train time 9.22 s
Epoch 2/50 |loss: 0.334620| train set 2.217x speedup, test set 1.988x speedup, val set 1.003x speedup, step: 3, train time 8.82 s
Epoch 3/50 |loss: 0.306112| train set 2.148x speedup, test set 0.978x speedup, val set 1.009x speedup, step: 4, train time 9.70 s
Epoch 4/50 |loss: 0.271844| train set 2.479x speedup, test set 1.534x speedup, val set 1.045x speedup, step: 1, train time 9.40 s
Epoch 5/50 |loss: 0.259944| train set 2.459x speedup, test set 1.526x speedup, val set 1.001x speedup, step: 2, train time 9.21 s
Epoch 6/50 |loss: 0.240841| train set 2.187x speedup, test set 2.175x speedup, val set 1.051x speedup, step: 3, train time 9.09 s
Epoch 7/50 |loss: 0.238871| train set 2.732x speedup, test set 1.266x speedup, val set 1.647x speedup, step: 4, train time 8.81 s
Epoch 8/50 |loss: 0.224707| train set 2.634x speedup, test set 1.279x speedup, val set 1.010x speedup, step: 5, train time 9.31 s
Epoch 9/50 |loss: 0.220181| train set 2.644x speedup, test set 0.895x speedup, val set 1.012x speedup, step: 6, train time 9.21 s
Epoch 10/50 |loss: 0.214985| train set 2.535x speedup, test set 1.332x speedup, val set 1.648x speedup, step: 7, train time 9.09 s
Epoch 11/50 |loss: 0.210430| train set 2.746x speedup, test set 1.300x speedup, val set 1.648x speedup, step: 8, train time 9.10 s
Epoch 12/50 |loss: 0.202050| train set 2.506x speedup, test set 1.294x speedup, val set 1.059x speedup, step: 9, train time 8.71 s
Epoch 13/50 |loss: 0.195816| train set 2.798x speedup, test set 0.911x speedup, val set 1.648x speedup, step: 10, train time 9.11 s
Epoch 14/50 |loss: 0.191177| train set 2.784x speedup, test set 1.300x speedup, val set 1.643x speedup, step: 1, train time 9.20 s
Epoch 15/50 |loss: 0.189859| train set 2.727x speedup, test set 1.046x speedup, val set 1.095x speedup, step: 2, train time 8.92 s
Epoch 16/50 |loss: 0.175562| train set 2.762x speedup, test set 1.314x speedup, val set 1.012x speedup, step: 3, train time 8.99 s
Epoch 17/50 |loss: 0.169724| train set 2.711x speedup, test set 1.620x speedup, val set 1.017x speedup, step: 4, train time 9.02 s
Epoch 18/50 |loss: 0.165548| train set 2.748x speedup, test set 1.613x speedup, val set 1.007x speedup, step: 5, train time 8.89 s
Epoch 19/50 |loss: 0.172370| train set 2.753x speedup, test set 1.007x speedup, val set 1.635x speedup, step: 6, train time 8.70 s
Epoch 20/50 |loss: 0.162074| train set 2.745x speedup, test set 1.285x speedup, val set 1.012x speedup, step: 7, train time 8.92 s
Epoch 21/50 |loss: 0.160250| train set 2.774x speedup, test set 0.907x speedup, val set 1.007x speedup, step: 8, train time 8.89 s
Epoch 22/50 |loss: 0.160088| train set 2.824x speedup, test set 1.331x speedup, val set 1.010x speedup, step: 9, train time 8.82 s
Epoch 23/50 |loss: 0.147401| train set 2.634x speedup, test set 0.895x speedup, val set 1.049x speedup, step: 10, train time 8.99 s
Epoch 24/50 |loss: 0.151327| train set 2.723x speedup, test set 1.209x speedup, val set 1.010x speedup, step: 11, train time 8.91 s
Epoch 25/50 |loss: 0.149181| train set 2.777x speedup, test set 1.289x speedup, val set 1.007x speedup, step: 12, train time 9.00 s
Epoch 26/50 |loss: 0.146298| train set 2.777x speedup, test set 2.393x speedup, val set 1.053x speedup, step: 13, train time 8.79 s
Epoch 27/50 |loss: 0.143602| train set 2.743x speedup, test set 2.164x speedup, val set 1.007x speedup, step: 14, train time 8.90 s
Epoch 28/50 |loss: 0.142813| train set 2.731x speedup, test set 1.287x speedup, val set 1.005x speedup, step: 15, train time 8.89 s
Epoch 29/50 |loss: 0.133008| train set 2.775x speedup, test set 2.303x speedup, val set 1.050x speedup, step: 16, train time 8.79 s
Epoch 30/50 |loss: 0.139830| train set 2.784x speedup, test set 1.326x speedup, val set 1.007x speedup, step: 17, train time 8.92 s
Epoch 31/50 |loss: 0.135913| train set 2.802x speedup, test set 2.063x speedup, val set 1.005x speedup, step: 18, train time 9.12 s
Epoch 32/50 |loss: 0.128354| train set 2.736x speedup, test set 1.289x speedup, val set 1.007x speedup, step: 19, train time 8.89 s
Epoch 33/50 |loss: 0.133028| train set 2.833x speedup, test set 1.283x speedup, val set 1.050x speedup, step: 20, train time 8.82 s
Epoch 34/50 |loss: 0.129734| train set 2.805x speedup, test set 1.279x speedup, val set 1.007x speedup, step: 21, train time 9.09 s
Epoch 35/50 |loss: 0.130663| train set 2.804x speedup, test set 1.286x speedup, val set 1.007x speedup, step: 22, train time 9.20 s
Epoch 36/50 |loss: 0.130222| train set 2.759x speedup, test set 1.307x speedup, val set 1.005x speedup, step: 23, train time 8.63 s
Epoch 37/50 |loss: 0.121768| train set 2.783x speedup, test set 1.283x speedup, val set 1.007x speedup, step: 24, train time 8.93 s
Epoch 38/50 |loss: 0.122522| train set 2.799x speedup, test set 1.244x speedup, val set 1.007x speedup, step: 25, train time 9.11 s
Epoch 39/50 |loss: 0.120963| train set 2.685x speedup, test set 2.043x speedup, val set 1.050x speedup, step: 26, train time 8.91 s
Epoch 40/50 |loss: 0.118734| train set 2.838x speedup, test set 2.144x speedup, val set 1.007x speedup, step: 27, train time 9.71 s
Epoch 41/50 |loss: 0.117896| train set 2.750x speedup, test set 1.282x speedup, val set 1.007x speedup, step: 28, train time 9.19 s
Epoch 42/50 |loss: 0.119203| train set 2.832x speedup, test set 2.006x speedup, val set 1.007x speedup, step: 29, train time 9.23 s
Epoch 43/50 |loss: 0.117305| train set 2.798x speedup, test set 2.245x speedup, val set 1.053x speedup, step: 30, train time 9.21 s
Epoch 44/50 |loss: 0.120378| train set 2.832x speedup, test set 2.106x speedup, val set 1.007x speedup, step: 31, train time 9.21 s
Epoch 45/50 |loss: 0.121283| train set 2.713x speedup, test set 2.106x speedup, val set 1.007x speedup, step: 32, train time 9.00 s
Epoch 46/50 |loss: 0.112159| train set 2.801x speedup, test set 1.249x speedup, val set 1.007x speedup, step: 33, train time 8.80 s
Epoch 47/50 |loss: 0.111631| train set 2.749x speedup, test set 1.298x speedup, val set 1.007x speedup, step: 34, train time 8.99 s
Epoch 48/50 |loss: 0.108566| train set 2.765x speedup, test set 2.229x speedup, val set 1.007x speedup, step: 35, train time 9.11 s
Epoch 49/50 |loss: 0.108615| train set 2.813x speedup, test set 2.131x speedup, val set 1.050x speedup, step: 36, train time 9.31 s
Training per epoch cost 9.060 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 7.110s, model runtime 35.678s, pg runtime 14.286s, speedup 0.400x
08, opt runtime 7.237s, model runtime 39.132s, pg runtime 17.708s, speedup 0.453x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
18, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
19, opt runtime 1.309s, model runtime 1.871s, pg runtime 1.356s, speedup 0.725x
20, opt runtime 1.340s, model runtime 1.865s, pg runtime 1.340s, speedup 0.719x
21, opt runtime 6.281s, model runtime 34.017s, pg runtime 6.281s, speedup 0.185x
22, opt runtime 25.034s, model runtime 37.819s, pg runtime 25.034s, speedup 0.662x
23, opt runtime 5.961s, model runtime 11.448s, pg runtime 31.210s, speedup 2.726x
24, opt runtime 6.234s, model runtime 11.767s, pg runtime 32.540s, speedup 2.765x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 47.614s, pg runtime 70.116s, speedup 1.473x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 16.138s, model runtime 572.741s, pg runtime 501.793s, speedup 0.876x
36, opt runtime 16.438s, model runtime 583.941s, pg runtime 546.887s, speedup 0.937x
37, opt runtime 15.754s, model runtime 72.187s, pg runtime 15.754s, speedup 0.218x
38, opt runtime 13.961s, model runtime 59.559s, pg runtime 13.961s, speedup 0.234x
39, opt runtime 1.098s, model runtime 3.195s, pg runtime 1.100s, speedup 0.344x
40, opt runtime 1.084s, model runtime 3.471s, pg runtime 1.155s, speedup 0.333x
====================
best train speedup epoch: 40, train speedup 2.838, test speedup 2.144, val speedup 1.007
best test speedup epoch: 26, train speedup 2.777, test speedup 2.393, val speedup 1.053
best validation speedup epoch: 14, train speedup 2.784, test speedup 1.300, val speedup 1.643
last model at epoch 49, train speedup 2.813, test speedup 2.131, val speedup 1.050
execution cost 0:08:04.306702
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.731007, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455056| train set 1.121x speedup, test set 2.222x speedup, val set 1.034x speedup, step: 1, train time 10.17 s
Epoch 1/50 |loss: 0.369224| train set 1.877x speedup, test set 2.425x speedup, val set 0.974x speedup, step: 2, train time 8.69 s
Epoch 2/50 |loss: 0.332054| train set 2.239x speedup, test set 1.335x speedup, val set 1.045x speedup, step: 3, train time 8.92 s
Epoch 3/50 |loss: 0.305575| train set 2.414x speedup, test set 1.274x speedup, val set 1.009x speedup, step: 4, train time 9.21 s
Epoch 4/50 |loss: 0.271001| train set 2.374x speedup, test set 1.270x speedup, val set 1.013x speedup, step: 1, train time 9.31 s
Epoch 5/50 |loss: 0.264078| train set 2.076x speedup, test set 1.295x speedup, val set 1.015x speedup, step: 2, train time 8.98 s
Epoch 6/50 |loss: 0.243747| train set 2.219x speedup, test set 1.205x speedup, val set 1.208x speedup, step: 3, train time 8.80 s
Epoch 7/50 |loss: 0.237081| train set 2.645x speedup, test set 1.273x speedup, val set 1.623x speedup, step: 4, train time 9.09 s
Epoch 8/50 |loss: 0.227615| train set 2.623x speedup, test set 1.331x speedup, val set 1.642x speedup, step: 5, train time 9.20 s
Epoch 9/50 |loss: 0.221816| train set 2.563x speedup, test set 1.352x speedup, val set 1.053x speedup, step: 1, train time 8.89 s
Epoch 10/50 |loss: 0.213089| train set 2.494x speedup, test set 1.607x speedup, val set 1.648x speedup, step: 2, train time 9.40 s
Epoch 11/50 |loss: 0.209570| train set 2.747x speedup, test set 1.252x speedup, val set 1.647x speedup, step: 3, train time 9.10 s
Epoch 12/50 |loss: 0.206930| train set 2.584x speedup, test set 1.353x speedup, val set 1.059x speedup, step: 4, train time 8.88 s
Epoch 13/50 |loss: 0.193911| train set 2.788x speedup, test set 1.244x speedup, val set 1.641x speedup, step: 5, train time 9.01 s
Epoch 14/50 |loss: 0.189906| train set 2.771x speedup, test set 2.014x speedup, val set 2.056x speedup, step: 1, train time 9.40 s
Epoch 15/50 |loss: 0.191519| train set 2.732x speedup, test set 2.400x speedup, val set 1.010x speedup, step: 2, train time 8.81 s
Epoch 16/50 |loss: 0.172995| train set 2.821x speedup, test set 1.785x speedup, val set 1.648x speedup, step: 3, train time 8.91 s
Epoch 17/50 |loss: 0.168680| train set 2.753x speedup, test set 1.149x speedup, val set 1.163x speedup, step: 4, train time 8.80 s
Epoch 18/50 |loss: 0.163738| train set 2.675x speedup, test set 1.346x speedup, val set 1.057x speedup, step: 5, train time 8.83 s
Epoch 19/50 |loss: 0.172976| train set 2.431x speedup, test set 1.274x speedup, val set 1.766x speedup, step: 6, train time 8.80 s
Epoch 20/50 |loss: 0.173448| train set 2.656x speedup, test set 0.888x speedup, val set 1.059x speedup, step: 7, train time 9.40 s
Epoch 21/50 |loss: 0.156648| train set 2.724x speedup, test set 1.221x speedup, val set 1.012x speedup, step: 8, train time 9.10 s
Epoch 22/50 |loss: 0.154060| train set 2.584x speedup, test set 2.227x speedup, val set 1.643x speedup, step: 9, train time 8.82 s
Epoch 23/50 |loss: 0.148083| train set 2.645x speedup, test set 0.913x speedup, val set 1.048x speedup, step: 10, train time 9.01 s
Epoch 24/50 |loss: 0.146134| train set 2.600x speedup, test set 1.201x speedup, val set 1.009x speedup, step: 11, train time 9.11 s
Epoch 25/50 |loss: 0.152968| train set 2.801x speedup, test set 2.075x speedup, val set 1.005x speedup, step: 12, train time 9.21 s
Epoch 26/50 |loss: 0.147560| train set 2.797x speedup, test set 1.224x speedup, val set 1.012x speedup, step: 13, train time 9.04 s
Epoch 27/50 |loss: 0.140398| train set 2.746x speedup, test set 2.097x speedup, val set 1.154x speedup, step: 14, train time 9.19 s
Epoch 28/50 |loss: 0.140480| train set 2.773x speedup, test set 2.070x speedup, val set 1.635x speedup, step: 15, train time 9.21 s
Epoch 29/50 |loss: 0.132039| train set 2.771x speedup, test set 1.236x speedup, val set 1.005x speedup, step: 16, train time 8.81 s
Epoch 30/50 |loss: 0.135962| train set 2.800x speedup, test set 2.079x speedup, val set 1.010x speedup, step: 17, train time 8.89 s
Epoch 31/50 |loss: 0.139433| train set 2.580x speedup, test set 2.224x speedup, val set 1.007x speedup, step: 18, train time 9.09 s
Epoch 32/50 |loss: 0.126902| train set 2.735x speedup, test set 2.150x speedup, val set 1.007x speedup, step: 19, train time 8.92 s
Epoch 33/50 |loss: 0.130713| train set 2.817x speedup, test set 1.299x speedup, val set 1.050x speedup, step: 20, train time 9.02 s
Epoch 34/50 |loss: 0.128429| train set 2.766x speedup, test set 2.142x speedup, val set 1.601x speedup, step: 21, train time 9.11 s
Epoch 35/50 |loss: 0.126973| train set 2.732x speedup, test set 2.258x speedup, val set 1.631x speedup, step: 22, train time 8.91 s
Epoch 36/50 |loss: 0.130130| train set 2.760x speedup, test set 2.137x speedup, val set 1.748x speedup, step: 23, train time 8.82 s
Epoch 37/50 |loss: 0.120717| train set 2.823x speedup, test set 2.185x speedup, val set 1.005x speedup, step: 24, train time 8.72 s
Epoch 38/50 |loss: 0.125552| train set 2.774x speedup, test set 2.215x speedup, val set 1.047x speedup, step: 25, train time 8.92 s
Epoch 39/50 |loss: 0.119928| train set 2.811x speedup, test set 2.122x speedup, val set 1.005x speedup, step: 26, train time 8.82 s
Epoch 40/50 |loss: 0.118266| train set 2.841x speedup, test set 2.195x speedup, val set 1.626x speedup, step: 27, train time 8.50 s
Epoch 41/50 |loss: 0.116427| train set 2.809x speedup, test set 1.493x speedup, val set 2.043x speedup, step: 28, train time 8.91 s
Epoch 42/50 |loss: 0.118209| train set 2.864x speedup, test set 2.293x speedup, val set 2.043x speedup, step: 29, train time 8.90 s
Epoch 43/50 |loss: 0.116568| train set 2.800x speedup, test set 2.138x speedup, val set 2.222x speedup, step: 30, train time 9.17 s
Epoch 44/50 |loss: 0.120651| train set 2.829x speedup, test set 2.224x speedup, val set 1.601x speedup, step: 31, train time 9.03 s
Epoch 45/50 |loss: 0.117238| train set 2.686x speedup, test set 2.207x speedup, val set 1.053x speedup, step: 32, train time 8.98 s
Epoch 46/50 |loss: 0.110124| train set 2.805x speedup, test set 2.279x speedup, val set 1.010x speedup, step: 33, train time 9.13 s
Epoch 47/50 |loss: 0.114278| train set 2.833x speedup, test set 2.153x speedup, val set 1.007x speedup, step: 34, train time 8.79 s
Epoch 48/50 |loss: 0.110064| train set 2.657x speedup, test set 2.204x speedup, val set 1.053x speedup, step: 35, train time 9.20 s
Epoch 49/50 |loss: 0.105418| train set 2.757x speedup, test set 2.205x speedup, val set 1.753x speedup, step: 36, train time 8.91 s
Training per epoch cost 9.018 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 7.110s, model runtime 35.678s, pg runtime 14.286s, speedup 0.400x
08, opt runtime 7.237s, model runtime 39.132s, pg runtime 17.708s, speedup 0.453x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
18, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
19, opt runtime 1.309s, model runtime 1.510s, pg runtime 1.356s, speedup 0.898x
20, opt runtime 1.340s, model runtime 1.587s, pg runtime 1.340s, speedup 0.844x
21, opt runtime 6.281s, model runtime 34.017s, pg runtime 6.281s, speedup 0.185x
22, opt runtime 25.034s, model runtime 37.819s, pg runtime 25.034s, speedup 0.662x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 2.482s, pg runtime 1.306s, speedup 0.526x
26, opt runtime 1.342s, model runtime 2.395s, pg runtime 1.342s, speedup 0.561x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 6.567s, pg runtime 5.414s, speedup 0.824x
30, opt runtime 5.572s, model runtime 6.580s, pg runtime 5.572s, speedup 0.847x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 94.699s, pg runtime 70.116s, speedup 0.740x
34, opt runtime 39.191s, model runtime 90.336s, pg runtime 75.984s, speedup 0.841x
35, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
36, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
37, opt runtime 15.754s, model runtime 117.458s, pg runtime 15.754s, speedup 0.134x
38, opt runtime 13.961s, model runtime 116.476s, pg runtime 13.961s, speedup 0.120x
39, opt runtime 1.098s, model runtime 12.301s, pg runtime 1.100s, speedup 0.089x
40, opt runtime 1.084s, model runtime 13.180s, pg runtime 1.155s, speedup 0.088x
====================
best train speedup epoch: 42, train speedup 2.864, test speedup 2.293, val speedup 2.043
best test speedup epoch: 1, train speedup 1.877, test speedup 2.425, val speedup 0.974
best validation speedup epoch: 14, train speedup 2.771, test speedup 2.014, val speedup 2.056
last model at epoch 49, train speedup 2.757, test speedup 2.205, val speedup 1.753
execution cost 0:08:02.744819
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.743353, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454716| train set 1.109x speedup, test set 2.372x speedup, val set 1.034x speedup, step: 1, train time 10.01 s
Epoch 1/50 |loss: 0.368434| train set 1.887x speedup, test set 2.212x speedup, val set 0.977x speedup, step: 2, train time 8.70 s
Epoch 2/50 |loss: 0.332066| train set 2.410x speedup, test set 1.384x speedup, val set 1.002x speedup, step: 3, train time 8.99 s
Epoch 3/50 |loss: 0.304116| train set 2.379x speedup, test set 1.301x speedup, val set 1.009x speedup, step: 4, train time 9.81 s
Epoch 4/50 |loss: 0.270748| train set 2.377x speedup, test set 0.912x speedup, val set 1.048x speedup, step: 1, train time 8.90 s
Epoch 5/50 |loss: 0.263408| train set 2.163x speedup, test set 1.347x speedup, val set 0.981x speedup, step: 2, train time 8.91 s
Epoch 6/50 |loss: 0.243630| train set 2.228x speedup, test set 2.350x speedup, val set 1.051x speedup, step: 3, train time 8.73 s
Epoch 7/50 |loss: 0.239484| train set 2.685x speedup, test set 1.332x speedup, val set 1.642x speedup, step: 4, train time 8.81 s
Epoch 8/50 |loss: 0.226103| train set 2.594x speedup, test set 1.032x speedup, val set 1.623x speedup, step: 5, train time 8.61 s
Epoch 9/50 |loss: 0.223105| train set 2.438x speedup, test set 1.042x speedup, val set 1.011x speedup, step: 6, train time 9.12 s
Epoch 10/50 |loss: 0.215179| train set 2.686x speedup, test set 0.999x speedup, val set 1.647x speedup, step: 7, train time 8.93 s
Epoch 11/50 |loss: 0.209086| train set 2.685x speedup, test set 1.037x speedup, val set 1.647x speedup, step: 8, train time 9.12 s
Epoch 12/50 |loss: 0.198936| train set 2.620x speedup, test set 2.282x speedup, val set 1.055x speedup, step: 9, train time 9.10 s
Epoch 13/50 |loss: 0.192453| train set 2.605x speedup, test set 1.551x speedup, val set 1.640x speedup, step: 10, train time 9.11 s
Epoch 14/50 |loss: 0.188791| train set 2.772x speedup, test set 2.169x speedup, val set 1.660x speedup, step: 1, train time 9.11 s
Epoch 15/50 |loss: 0.185489| train set 2.772x speedup, test set 2.111x speedup, val set 1.012x speedup, step: 2, train time 9.20 s
Epoch 16/50 |loss: 0.176416| train set 2.758x speedup, test set 2.185x speedup, val set 1.012x speedup, step: 3, train time 8.91 s
Epoch 17/50 |loss: 0.166924| train set 2.746x speedup, test set 2.292x speedup, val set 1.016x speedup, step: 4, train time 8.92 s
Epoch 18/50 |loss: 0.166219| train set 2.749x speedup, test set 2.290x speedup, val set 1.057x speedup, step: 5, train time 9.21 s
Epoch 19/50 |loss: 0.170477| train set 2.418x speedup, test set 1.288x speedup, val set 1.766x speedup, step: 1, train time 9.90 s
Epoch 20/50 |loss: 0.168182| train set 2.668x speedup, test set 2.192x speedup, val set 1.055x speedup, step: 2, train time 9.30 s
Epoch 21/50 |loss: 0.163726| train set 2.761x speedup, test set 2.188x speedup, val set 1.665x speedup, step: 3, train time 9.09 s
Epoch 22/50 |loss: 0.157021| train set 2.828x speedup, test set 2.085x speedup, val set 1.055x speedup, step: 4, train time 9.11 s
Epoch 23/50 |loss: 0.148825| train set 2.675x speedup, test set 2.230x speedup, val set 1.007x speedup, step: 5, train time 8.93 s
Epoch 24/50 |loss: 0.153773| train set 2.634x speedup, test set 2.088x speedup, val set 1.049x speedup, step: 6, train time 8.62 s
Epoch 25/50 |loss: 0.155161| train set 2.838x speedup, test set 2.228x speedup, val set 1.012x speedup, step: 7, train time 9.21 s
Epoch 26/50 |loss: 0.147351| train set 2.785x speedup, test set 2.001x speedup, val set 1.002x speedup, step: 8, train time 9.49 s
Epoch 27/50 |loss: 0.141275| train set 2.740x speedup, test set 2.037x speedup, val set 1.012x speedup, step: 9, train time 9.20 s
Epoch 28/50 |loss: 0.142487| train set 2.737x speedup, test set 2.243x speedup, val set 1.750x speedup, step: 10, train time 9.34 s
Epoch 29/50 |loss: 0.136426| train set 2.762x speedup, test set 2.047x speedup, val set 1.631x speedup, step: 11, train time 10.23 s
Epoch 30/50 |loss: 0.145210| train set 2.795x speedup, test set 2.164x speedup, val set 1.055x speedup, step: 12, train time 9.21 s
Epoch 31/50 |loss: 0.138558| train set 2.748x speedup, test set 2.077x speedup, val set 1.010x speedup, step: 13, train time 9.11 s
Epoch 32/50 |loss: 0.130417| train set 2.736x speedup, test set 2.063x speedup, val set 1.050x speedup, step: 14, train time 8.90 s
Epoch 33/50 |loss: 0.136498| train set 2.839x speedup, test set 2.236x speedup, val set 1.766x speedup, step: 15, train time 8.93 s
Epoch 34/50 |loss: 0.135952| train set 2.784x speedup, test set 2.107x speedup, val set 1.007x speedup, step: 16, train time 9.00 s
Epoch 35/50 |loss: 0.133652| train set 2.761x speedup, test set 2.267x speedup, val set 1.050x speedup, step: 17, train time 9.29 s
Epoch 36/50 |loss: 0.130248| train set 2.776x speedup, test set 2.063x speedup, val set 1.746x speedup, step: 18, train time 10.31 s
Epoch 37/50 |loss: 0.123804| train set 2.781x speedup, test set 2.048x speedup, val set 1.631x speedup, step: 19, train time 8.71 s
Epoch 38/50 |loss: 0.124641| train set 2.805x speedup, test set 2.281x speedup, val set 1.012x speedup, step: 20, train time 9.09 s
Epoch 39/50 |loss: 0.126970| train set 2.448x speedup, test set 1.996x speedup, val set 1.050x speedup, step: 21, train time 9.31 s
Epoch 40/50 |loss: 0.119687| train set 2.834x speedup, test set 2.119x speedup, val set 1.635x speedup, step: 22, train time 9.11 s
Epoch 41/50 |loss: 0.120634| train set 2.783x speedup, test set 2.165x speedup, val set 1.648x speedup, step: 23, train time 8.80 s
Epoch 42/50 |loss: 0.116757| train set 2.842x speedup, test set 2.277x speedup, val set 1.148x speedup, step: 24, train time 9.12 s
Epoch 43/50 |loss: 0.123433| train set 2.795x speedup, test set 2.245x speedup, val set 1.766x speedup, step: 25, train time 9.11 s
Epoch 44/50 |loss: 0.123071| train set 2.854x speedup, test set 2.119x speedup, val set 1.055x speedup, step: 26, train time 9.21 s
Epoch 45/50 |loss: 0.121035| train set 2.755x speedup, test set 2.119x speedup, val set 1.204x speedup, step: 27, train time 8.91 s
Epoch 46/50 |loss: 0.114599| train set 2.806x speedup, test set 2.135x speedup, val set 1.005x speedup, step: 28, train time 9.48 s
Epoch 47/50 |loss: 0.119219| train set 2.811x speedup, test set 2.227x speedup, val set 1.050x speedup, step: 29, train time 9.01 s
Epoch 48/50 |loss: 0.115559| train set 2.766x speedup, test set 2.119x speedup, val set 0.978x speedup, step: 30, train time 9.03 s
Epoch 49/50 |loss: 0.108232| train set 2.796x speedup, test set 2.335x speedup, val set 1.648x speedup, step: 31, train time 9.01 s
Training per epoch cost 9.145 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
18, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
19, opt runtime 1.309s, model runtime 1.548s, pg runtime 1.356s, speedup 0.876x
20, opt runtime 1.340s, model runtime 1.530s, pg runtime 1.340s, speedup 0.876x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 2.482s, pg runtime 1.306s, speedup 0.526x
26, opt runtime 1.342s, model runtime 2.395s, pg runtime 1.342s, speedup 0.561x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
32, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
33, opt runtime 35.538s, model runtime 94.699s, pg runtime 70.116s, speedup 0.740x
34, opt runtime 39.191s, model runtime 90.336s, pg runtime 75.984s, speedup 0.841x
35, opt runtime 16.138s, model runtime 572.741s, pg runtime 501.793s, speedup 0.876x
36, opt runtime 16.438s, model runtime 583.941s, pg runtime 546.887s, speedup 0.937x
37, opt runtime 15.754s, model runtime 72.187s, pg runtime 15.754s, speedup 0.218x
38, opt runtime 13.961s, model runtime 59.559s, pg runtime 13.961s, speedup 0.234x
39, opt runtime 1.098s, model runtime 12.301s, pg runtime 1.100s, speedup 0.089x
40, opt runtime 1.084s, model runtime 13.180s, pg runtime 1.155s, speedup 0.088x
====================
best train speedup epoch: 44, train speedup 2.854, test speedup 2.119, val speedup 1.055
best test speedup epoch: 0, train speedup 1.109, test speedup 2.372, val speedup 1.034
best validation speedup epoch: 19, train speedup 2.418, test speedup 1.288, val speedup 1.766
last model at epoch 49, train speedup 2.796, test speedup 2.335, val speedup 1.648
execution cost 0:08:09.969361
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.717936, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.454032| train set 1.081x speedup, test set 1.356x speedup, val set 1.024x speedup, step: 1, train time 9.95 s
Epoch 1/50 |loss: 0.366510| train set 2.054x speedup, test set 1.391x speedup, val set 0.977x speedup, step: 2, train time 9.21 s
Epoch 2/50 |loss: 0.328457| train set 2.182x speedup, test set 1.263x speedup, val set 1.045x speedup, step: 3, train time 9.19 s
Epoch 3/50 |loss: 0.300374| train set 2.434x speedup, test set 1.214x speedup, val set 1.009x speedup, step: 4, train time 9.80 s
Epoch 4/50 |loss: 0.270870| train set 2.052x speedup, test set 1.083x speedup, val set 1.043x speedup, step: 1, train time 9.02 s
Epoch 5/50 |loss: 0.258614| train set 2.409x speedup, test set 1.298x speedup, val set 1.001x speedup, step: 2, train time 8.72 s
Epoch 6/50 |loss: 0.243409| train set 2.130x speedup, test set 1.396x speedup, val set 1.051x speedup, step: 3, train time 9.21 s
Epoch 7/50 |loss: 0.235642| train set 2.621x speedup, test set 0.970x speedup, val set 1.010x speedup, step: 4, train time 8.92 s
Epoch 8/50 |loss: 0.223947| train set 2.475x speedup, test set 1.207x speedup, val set 1.638x speedup, step: 5, train time 9.01 s
Epoch 9/50 |loss: 0.216797| train set 2.539x speedup, test set 0.971x speedup, val set 1.010x speedup, step: 6, train time 8.71 s
Epoch 10/50 |loss: 0.209860| train set 2.525x speedup, test set 1.247x speedup, val set 1.644x speedup, step: 7, train time 9.20 s
Epoch 11/50 |loss: 0.209611| train set 2.750x speedup, test set 1.300x speedup, val set 1.623x speedup, step: 8, train time 9.18 s
Epoch 12/50 |loss: 0.201449| train set 2.452x speedup, test set 1.230x speedup, val set 1.045x speedup, step: 9, train time 8.91 s
Epoch 13/50 |loss: 0.193758| train set 2.728x speedup, test set 1.286x speedup, val set 1.660x speedup, step: 10, train time 9.02 s
Epoch 14/50 |loss: 0.193471| train set 2.755x speedup, test set 2.084x speedup, val set 1.639x speedup, step: 1, train time 9.21 s
Epoch 15/50 |loss: 0.184081| train set 2.766x speedup, test set 1.273x speedup, val set 1.010x speedup, step: 2, train time 9.40 s
Epoch 16/50 |loss: 0.175681| train set 2.611x speedup, test set 1.201x speedup, val set 1.010x speedup, step: 3, train time 9.20 s
Epoch 17/50 |loss: 0.166024| train set 2.760x speedup, test set 0.995x speedup, val set 1.017x speedup, step: 4, train time 9.20 s
Epoch 18/50 |loss: 0.163463| train set 2.742x speedup, test set 1.263x speedup, val set 1.001x speedup, step: 5, train time 9.22 s
Epoch 19/50 |loss: 0.169026| train set 2.753x speedup, test set 1.203x speedup, val set 1.766x speedup, step: 1, train time 9.20 s
Epoch 20/50 |loss: 0.164883| train set 2.597x speedup, test set 1.223x speedup, val set 1.048x speedup, step: 2, train time 9.19 s
Epoch 21/50 |loss: 0.157157| train set 2.809x speedup, test set 1.241x speedup, val set 1.010x speedup, step: 3, train time 9.40 s
Epoch 22/50 |loss: 0.153832| train set 2.715x speedup, test set 1.285x speedup, val set 1.644x speedup, step: 4, train time 9.09 s
Epoch 23/50 |loss: 0.147740| train set 2.720x speedup, test set 1.260x speedup, val set 1.048x speedup, step: 5, train time 9.11 s
Epoch 24/50 |loss: 0.150495| train set 2.730x speedup, test set 0.992x speedup, val set 1.005x speedup, step: 6, train time 8.92 s
Epoch 25/50 |loss: 0.149684| train set 2.805x speedup, test set 1.241x speedup, val set 1.003x speedup, step: 7, train time 9.31 s
Epoch 26/50 |loss: 0.148818| train set 2.802x speedup, test set 1.006x speedup, val set 1.006x speedup, step: 8, train time 9.11 s
Epoch 27/50 |loss: 0.140669| train set 2.738x speedup, test set 1.296x speedup, val set 1.005x speedup, step: 9, train time 9.00 s
Epoch 28/50 |loss: 0.140771| train set 2.455x speedup, test set 1.255x speedup, val set 1.049x speedup, step: 10, train time 9.62 s
Epoch 29/50 |loss: 0.137488| train set 2.781x speedup, test set 1.239x speedup, val set 1.005x speedup, step: 11, train time 9.32 s
Epoch 30/50 |loss: 0.138751| train set 2.785x speedup, test set 1.244x speedup, val set 1.005x speedup, step: 12, train time 9.10 s
Epoch 31/50 |loss: 0.139415| train set 2.763x speedup, test set 1.240x speedup, val set 1.003x speedup, step: 13, train time 8.99 s
Epoch 32/50 |loss: 0.130294| train set 2.732x speedup, test set 0.996x speedup, val set 1.005x speedup, step: 14, train time 8.72 s
Epoch 33/50 |loss: 0.131054| train set 2.803x speedup, test set 1.000x speedup, val set 1.055x speedup, step: 15, train time 9.18 s
Epoch 34/50 |loss: 0.135022| train set 2.600x speedup, test set 1.225x speedup, val set 1.005x speedup, step: 16, train time 9.11 s
Epoch 35/50 |loss: 0.134980| train set 2.847x speedup, test set 1.266x speedup, val set 1.005x speedup, step: 17, train time 9.19 s
Epoch 36/50 |loss: 0.131120| train set 2.745x speedup, test set 1.239x speedup, val set 1.003x speedup, step: 18, train time 9.21 s
Epoch 37/50 |loss: 0.126276| train set 2.805x speedup, test set 0.993x speedup, val set 1.005x speedup, step: 19, train time 9.20 s
Epoch 38/50 |loss: 0.125042| train set 2.803x speedup, test set 1.264x speedup, val set 1.630x speedup, step: 20, train time 9.04 s
Epoch 39/50 |loss: 0.122166| train set 2.555x speedup, test set 1.223x speedup, val set 1.050x speedup, step: 21, train time 8.81 s
Epoch 40/50 |loss: 0.117711| train set 2.842x speedup, test set 1.222x speedup, val set 1.005x speedup, step: 22, train time 8.73 s
Epoch 41/50 |loss: 0.116020| train set 2.797x speedup, test set 1.275x speedup, val set 1.005x speedup, step: 23, train time 9.10 s
Epoch 42/50 |loss: 0.122286| train set 2.821x speedup, test set 2.210x speedup, val set 1.148x speedup, step: 24, train time 9.01 s
Epoch 43/50 |loss: 0.118018| train set 2.767x speedup, test set 1.203x speedup, val set 1.046x speedup, step: 25, train time 9.11 s
Epoch 44/50 |loss: 0.123483| train set 2.831x speedup, test set 1.964x speedup, val set 1.631x speedup, step: 26, train time 9.01 s
Epoch 45/50 |loss: 0.120058| train set 2.663x speedup, test set 1.207x speedup, val set 1.005x speedup, step: 27, train time 9.09 s
Epoch 46/50 |loss: 0.112221| train set 2.522x speedup, test set 1.196x speedup, val set 1.005x speedup, step: 28, train time 9.21 s
Epoch 47/50 |loss: 0.115729| train set 2.836x speedup, test set 1.209x speedup, val set 1.005x speedup, step: 29, train time 9.03 s
Epoch 48/50 |loss: 0.113678| train set 2.767x speedup, test set 1.229x speedup, val set 1.048x speedup, step: 30, train time 9.52 s
Epoch 49/50 |loss: 0.111673| train set 2.814x speedup, test set 0.883x speedup, val set 1.005x speedup, step: 31, train time 9.31 s
Training per epoch cost 9.145 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 49.702s, pg runtime 32.278s, speedup 0.649x
06, opt runtime 19.263s, model runtime 52.565s, pg runtime 19.263s, speedup 0.366x
07, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
08, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
09, opt runtime 4.881s, model runtime 8.677s, pg runtime 4.881s, speedup 0.563x
10, opt runtime 5.086s, model runtime 8.418s, pg runtime 5.086s, speedup 0.604x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 67.320s, pg runtime 32.939s, speedup 0.489x
18, opt runtime 7.469s, model runtime 53.877s, pg runtime 23.223s, speedup 0.431x
19, opt runtime 1.309s, model runtime 1.871s, pg runtime 1.356s, speedup 0.725x
20, opt runtime 1.340s, model runtime 1.865s, pg runtime 1.340s, speedup 0.719x
21, opt runtime 6.281s, model runtime 34.017s, pg runtime 6.281s, speedup 0.185x
22, opt runtime 25.034s, model runtime 37.819s, pg runtime 25.034s, speedup 0.662x
23, opt runtime 5.961s, model runtime 18.248s, pg runtime 31.210s, speedup 1.710x
24, opt runtime 6.234s, model runtime 17.977s, pg runtime 32.540s, speedup 1.810x
25, opt runtime 1.306s, model runtime 2.482s, pg runtime 1.306s, speedup 0.526x
26, opt runtime 1.342s, model runtime 2.395s, pg runtime 1.342s, speedup 0.561x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 582.756s, pg runtime 611.327s, speedup 1.049x
32, opt runtime 24.706s, model runtime 591.577s, pg runtime 610.808s, speedup 1.033x
33, opt runtime 35.538s, model runtime 94.699s, pg runtime 70.116s, speedup 0.740x
34, opt runtime 39.191s, model runtime 90.336s, pg runtime 75.984s, speedup 0.841x
35, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
36, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
37, opt runtime 15.754s, model runtime 117.458s, pg runtime 15.754s, speedup 0.134x
38, opt runtime 13.961s, model runtime 116.476s, pg runtime 13.961s, speedup 0.120x
39, opt runtime 1.098s, model runtime 12.301s, pg runtime 1.100s, speedup 0.089x
40, opt runtime 1.084s, model runtime 13.180s, pg runtime 1.155s, speedup 0.088x
====================
best train speedup epoch: 35, train speedup 2.847, test speedup 1.266, val speedup 1.005
best test speedup epoch: 42, train speedup 2.821, test speedup 2.210, val speedup 1.148
best validation speedup epoch: 19, train speedup 2.753, test speedup 1.203, val speedup 1.766
last model at epoch 49, train speedup 2.814, test speedup 0.883, val speedup 1.005
execution cost 0:08:09.119160
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
(72, 49, 3)
(72, 49)
construct training samples cost 0:00:00.698651, and there are 12821 training samples
in channel 9
Epoch 0/50 |loss: 0.455604| train set 1.076x speedup, test set 2.208x speedup, val set 1.034x speedup, step: 1, train time 10.65 s
Epoch 1/50 |loss: 0.367911| train set 1.831x speedup, test set 2.283x speedup, val set 0.974x speedup, step: 2, train time 9.01 s
Epoch 2/50 |loss: 0.331398| train set 2.165x speedup, test set 1.232x speedup, val set 1.045x speedup, step: 3, train time 9.00 s
Epoch 3/50 |loss: 0.303289| train set 2.117x speedup, test set 1.254x speedup, val set 1.002x speedup, step: 4, train time 10.00 s
Epoch 4/50 |loss: 0.270725| train set 2.529x speedup, test set 1.353x speedup, val set 1.008x speedup, step: 1, train time 9.10 s
Epoch 5/50 |loss: 0.262382| train set 2.332x speedup, test set 2.188x speedup, val set 1.002x speedup, step: 2, train time 9.08 s
Epoch 6/50 |loss: 0.243333| train set 2.192x speedup, test set 1.985x speedup, val set 1.051x speedup, step: 3, train time 9.50 s
Epoch 7/50 |loss: 0.240175| train set 2.640x speedup, test set 1.305x speedup, val set 1.623x speedup, step: 4, train time 8.80 s
Epoch 8/50 |loss: 0.226823| train set 2.577x speedup, test set 2.141x speedup, val set 1.003x speedup, step: 5, train time 9.00 s
Epoch 9/50 |loss: 0.218966| train set 2.554x speedup, test set 2.071x speedup, val set 1.012x speedup, step: 1, train time 9.29 s
Epoch 10/50 |loss: 0.217974| train set 2.605x speedup, test set 1.995x speedup, val set 1.648x speedup, step: 2, train time 9.10 s
Epoch 11/50 |loss: 0.211825| train set 2.685x speedup, test set 2.182x speedup, val set 1.012x speedup, step: 3, train time 9.19 s
Epoch 12/50 |loss: 0.200266| train set 2.731x speedup, test set 2.322x speedup, val set 1.045x speedup, step: 4, train time 8.72 s
Epoch 13/50 |loss: 0.188793| train set 2.644x speedup, test set 2.146x speedup, val set 1.665x speedup, step: 5, train time 9.10 s
Epoch 14/50 |loss: 0.187034| train set 2.708x speedup, test set 2.129x speedup, val set 1.643x speedup, step: 1, train time 8.83 s
Epoch 15/50 |loss: 0.181546| train set 2.759x speedup, test set 2.162x speedup, val set 1.010x speedup, step: 2, train time 9.21 s
Epoch 16/50 |loss: 0.173327| train set 2.596x speedup, test set 2.129x speedup, val set 1.015x speedup, step: 3, train time 9.13 s
Epoch 17/50 |loss: 0.166124| train set 2.734x speedup, test set 2.161x speedup, val set 1.017x speedup, step: 4, train time 8.92 s
Epoch 18/50 |loss: 0.168752| train set 2.614x speedup, test set 2.191x speedup, val set 1.057x speedup, step: 5, train time 9.30 s
Epoch 19/50 |loss: 0.166518| train set 2.781x speedup, test set 2.168x speedup, val set 1.648x speedup, step: 1, train time 9.00 s
Epoch 20/50 |loss: 0.166823| train set 2.687x speedup, test set 2.173x speedup, val set 1.015x speedup, step: 2, train time 8.90 s
Epoch 21/50 |loss: 0.158114| train set 2.797x speedup, test set 2.162x speedup, val set 1.009x speedup, step: 3, train time 9.41 s
Epoch 22/50 |loss: 0.158990| train set 2.728x speedup, test set 2.145x speedup, val set 1.003x speedup, step: 4, train time 9.02 s
Epoch 23/50 |loss: 0.146880| train set 2.653x speedup, test set 2.122x speedup, val set 1.012x speedup, step: 5, train time 9.12 s
Epoch 24/50 |loss: 0.150228| train set 2.444x speedup, test set 2.110x speedup, val set 1.007x speedup, step: 6, train time 9.23 s
Epoch 25/50 |loss: 0.152871| train set 2.770x speedup, test set 2.188x speedup, val set 1.012x speedup, step: 7, train time 9.32 s
Epoch 26/50 |loss: 0.144041| train set 2.484x speedup, test set 2.068x speedup, val set 1.050x speedup, step: 8, train time 8.71 s
Epoch 27/50 |loss: 0.140203| train set 2.741x speedup, test set 2.054x speedup, val set 1.012x speedup, step: 9, train time 8.84 s
Epoch 28/50 |loss: 0.138855| train set 2.728x speedup, test set 2.135x speedup, val set 1.055x speedup, step: 10, train time 9.51 s
Epoch 29/50 |loss: 0.135354| train set 2.799x speedup, test set 2.247x speedup, val set 1.648x speedup, step: 1, train time 9.01 s
Epoch 30/50 |loss: 0.136726| train set 2.804x speedup, test set 2.135x speedup, val set 1.010x speedup, step: 2, train time 9.00 s
Epoch 31/50 |loss: 0.142925| train set 2.730x speedup, test set 2.256x speedup, val set 1.007x speedup, step: 3, train time 9.00 s
Epoch 32/50 |loss: 0.128187| train set 2.737x speedup, test set 2.062x speedup, val set 1.007x speedup, step: 4, train time 9.01 s
Epoch 33/50 |loss: 0.131881| train set 2.797x speedup, test set 2.135x speedup, val set 1.012x speedup, step: 5, train time 9.11 s
Epoch 34/50 |loss: 0.134561| train set 2.689x speedup, test set 2.233x speedup, val set 1.007x speedup, step: 6, train time 9.12 s
Epoch 35/50 |loss: 0.127940| train set 2.764x speedup, test set 2.135x speedup, val set 1.012x speedup, step: 7, train time 9.20 s
Epoch 36/50 |loss: 0.128554| train set 2.578x speedup, test set 2.123x speedup, val set 1.055x speedup, step: 8, train time 8.91 s
Epoch 37/50 |loss: 0.125022| train set 2.780x speedup, test set 2.135x speedup, val set 1.154x speedup, step: 9, train time 9.11 s
Epoch 38/50 |loss: 0.123225| train set 2.780x speedup, test set 2.119x speedup, val set 1.012x speedup, step: 10, train time 9.12 s
Epoch 39/50 |loss: 0.122524| train set 2.557x speedup, test set 2.135x speedup, val set 1.055x speedup, step: 11, train time 9.03 s
Epoch 40/50 |loss: 0.118822| train set 2.636x speedup, test set 2.135x speedup, val set 1.012x speedup, step: 12, train time 9.33 s
Epoch 41/50 |loss: 0.118510| train set 2.784x speedup, test set 2.123x speedup, val set 1.010x speedup, step: 13, train time 8.83 s
Epoch 42/50 |loss: 0.118811| train set 2.829x speedup, test set 2.189x speedup, val set 1.007x speedup, step: 14, train time 9.23 s
Epoch 43/50 |loss: 0.117884| train set 2.730x speedup, test set 2.136x speedup, val set 1.055x speedup, step: 15, train time 8.92 s
Epoch 44/50 |loss: 0.119820| train set 2.845x speedup, test set 2.135x speedup, val set 1.154x speedup, step: 16, train time 9.20 s
Epoch 45/50 |loss: 0.119527| train set 2.741x speedup, test set 2.107x speedup, val set 1.050x speedup, step: 17, train time 9.22 s
Epoch 46/50 |loss: 0.119553| train set 2.718x speedup, test set 2.135x speedup, val set 1.012x speedup, step: 18, train time 9.10 s
Epoch 47/50 |loss: 0.118635| train set 2.834x speedup, test set 2.054x speedup, val set 1.012x speedup, step: 19, train time 9.21 s
Epoch 48/50 |loss: 0.112999| train set 2.760x speedup, test set 2.239x speedup, val set 1.007x speedup, step: 20, train time 9.12 s
Epoch 49/50 |loss: 0.110518| train set 2.771x speedup, test set 2.079x speedup, val set 1.648x speedup, step: 1, train time 9.19 s
Training per epoch cost 9.139 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
05, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 7.110s, model runtime 35.678s, pg runtime 14.286s, speedup 0.400x
08, opt runtime 7.237s, model runtime 39.132s, pg runtime 17.708s, speedup 0.453x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 70.442s, pg runtime 73.019s, speedup 1.037x
12, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 2.995s, model runtime 4.213s, pg runtime 14.646s, speedup 3.477x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 7.469s, model runtime 38.252s, pg runtime 23.223s, speedup 0.607x
19, opt runtime 1.309s, model runtime 1.548s, pg runtime 1.356s, speedup 0.876x
20, opt runtime 1.340s, model runtime 1.530s, pg runtime 1.340s, speedup 0.876x
21, opt runtime 6.281s, model runtime 22.977s, pg runtime 6.281s, speedup 0.273x
22, opt runtime 25.034s, model runtime 31.752s, pg runtime 25.034s, speedup 0.788x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 2.482s, pg runtime 1.306s, speedup 0.526x
26, opt runtime 1.342s, model runtime 2.395s, pg runtime 1.342s, speedup 0.561x
27, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
28, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 94.699s, pg runtime 70.116s, speedup 0.740x
34, opt runtime 39.191s, model runtime 90.336s, pg runtime 75.984s, speedup 0.841x
35, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
36, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
37, opt runtime 15.754s, model runtime 117.458s, pg runtime 15.754s, speedup 0.134x
38, opt runtime 13.961s, model runtime 116.476s, pg runtime 13.961s, speedup 0.120x
39, opt runtime 1.098s, model runtime 3.195s, pg runtime 1.100s, speedup 0.344x
40, opt runtime 1.084s, model runtime 3.471s, pg runtime 1.155s, speedup 0.333x
====================
best train speedup epoch: 44, train speedup 2.845, test speedup 2.135, val speedup 1.154
best test speedup epoch: 12, train speedup 2.731, test speedup 2.322, val speedup 1.045
best validation speedup epoch: 49, train speedup 2.771, test speedup 2.079, val speedup 1.648
last model at epoch 49, train speedup 2.771, test speedup 2.079, val speedup 1.648
execution cost 0:08:10.227156
==================================================
