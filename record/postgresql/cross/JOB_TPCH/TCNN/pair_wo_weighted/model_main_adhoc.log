all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.968913, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426515| train set 2.287x speedup, test set 4.730x speedup, val set 0.782x speedup, step: 1, train time 20.04 s
Epoch 1/50 |loss: 0.346244| train set 2.434x speedup, test set 4.730x speedup, val set 0.727x speedup, step: 2, train time 18.31 s
Epoch 2/50 |loss: 0.317800| train set 2.310x speedup, test set 5.035x speedup, val set 0.907x speedup, step: 3, train time 17.31 s
Epoch 3/50 |loss: 0.295274| train set 2.653x speedup, test set 5.981x speedup, val set 0.900x speedup, step: 4, train time 17.51 s
Epoch 4/50 |loss: 0.277086| train set 2.988x speedup, test set 5.981x speedup, val set 1.863x speedup, step: 1, train time 17.28 s
Epoch 5/50 |loss: 0.255628| train set 2.773x speedup, test set 4.940x speedup, val set 0.910x speedup, step: 2, train time 17.29 s
Epoch 6/50 |loss: 0.242238| train set 2.674x speedup, test set 4.940x speedup, val set 0.910x speedup, step: 3, train time 17.22 s
Epoch 7/50 |loss: 0.238324| train set 3.042x speedup, test set 1.311x speedup, val set 1.711x speedup, step: 4, train time 17.13 s
Epoch 8/50 |loss: 0.228360| train set 3.255x speedup, test set 5.035x speedup, val set 1.041x speedup, step: 5, train time 17.00 s
Epoch 9/50 |loss: 0.225417| train set 3.098x speedup, test set 4.940x speedup, val set 0.901x speedup, step: 6, train time 16.92 s
Epoch 10/50 |loss: 0.211382| train set 2.832x speedup, test set 4.940x speedup, val set 1.008x speedup, step: 7, train time 17.00 s
Epoch 11/50 |loss: 0.207258| train set 3.258x speedup, test set 4.940x speedup, val set 1.001x speedup, step: 8, train time 16.93 s
Epoch 12/50 |loss: 0.201973| train set 2.845x speedup, test set 4.940x speedup, val set 0.901x speedup, step: 9, train time 16.93 s
Epoch 13/50 |loss: 0.198499| train set 3.004x speedup, test set 5.080x speedup, val set 0.727x speedup, step: 10, train time 16.97 s
Epoch 14/50 |loss: 0.192244| train set 3.205x speedup, test set 5.080x speedup, val set 1.032x speedup, step: 11, train time 16.91 s
Epoch 15/50 |loss: 0.188918| train set 3.136x speedup, test set 5.110x speedup, val set 1.005x speedup, step: 12, train time 16.99 s
Epoch 16/50 |loss: 0.179435| train set 3.152x speedup, test set 5.110x speedup, val set 1.001x speedup, step: 13, train time 17.02 s
Epoch 17/50 |loss: 0.180180| train set 3.175x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 14, train time 17.19 s
Epoch 18/50 |loss: 0.174364| train set 3.021x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 15, train time 16.98 s
Epoch 19/50 |loss: 0.172763| train set 3.223x speedup, test set 5.080x speedup, val set 0.901x speedup, step: 16, train time 17.01 s
Epoch 20/50 |loss: 0.166212| train set 3.196x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 17, train time 17.33 s
Epoch 21/50 |loss: 0.161892| train set 3.210x speedup, test set 5.105x speedup, val set 0.910x speedup, step: 18, train time 17.11 s
Epoch 22/50 |loss: 0.162531| train set 3.230x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 19, train time 17.17 s
Epoch 23/50 |loss: 0.153739| train set 3.295x speedup, test set 5.080x speedup, val set 0.715x speedup, step: 20, train time 17.21 s
Epoch 24/50 |loss: 0.148466| train set 3.088x speedup, test set 5.110x speedup, val set 0.701x speedup, step: 21, train time 17.09 s
Epoch 25/50 |loss: 0.150714| train set 2.908x speedup, test set 5.080x speedup, val set 0.975x speedup, step: 22, train time 17.28 s
Epoch 26/50 |loss: 0.147547| train set 3.033x speedup, test set 5.080x speedup, val set 0.948x speedup, step: 23, train time 17.28 s
Epoch 27/50 |loss: 0.147085| train set 3.211x speedup, test set 5.080x speedup, val set 1.007x speedup, step: 24, train time 17.29 s
Epoch 28/50 |loss: 0.142301| train set 3.335x speedup, test set 5.182x speedup, val set 0.775x speedup, step: 25, train time 17.31 s
Epoch 29/50 |loss: 0.140839| train set 3.285x speedup, test set 5.080x speedup, val set 0.699x speedup, step: 26, train time 17.10 s
Epoch 30/50 |loss: 0.135776| train set 3.240x speedup, test set 5.080x speedup, val set 1.002x speedup, step: 27, train time 16.91 s
Epoch 31/50 |loss: 0.137652| train set 3.199x speedup, test set 4.881x speedup, val set 0.977x speedup, step: 28, train time 17.20 s
Epoch 32/50 |loss: 0.130770| train set 3.383x speedup, test set 5.080x speedup, val set 1.002x speedup, step: 29, train time 17.02 s
Epoch 33/50 |loss: 0.130228| train set 3.278x speedup, test set 4.881x speedup, val set 0.977x speedup, step: 30, train time 17.13 s
Epoch 34/50 |loss: 0.127800| train set 3.411x speedup, test set 5.080x speedup, val set 0.701x speedup, step: 31, train time 17.12 s
Epoch 35/50 |loss: 0.126216| train set 3.369x speedup, test set 5.080x speedup, val set 0.716x speedup, step: 32, train time 17.32 s
Epoch 36/50 |loss: 0.127746| train set 3.374x speedup, test set 4.881x speedup, val set 0.727x speedup, step: 33, train time 17.22 s
Epoch 37/50 |loss: 0.127043| train set 3.225x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 34, train time 17.40 s
Epoch 38/50 |loss: 0.124098| train set 3.158x speedup, test set 5.080x speedup, val set 0.701x speedup, step: 35, train time 17.30 s
Epoch 39/50 |loss: 0.120196| train set 3.217x speedup, test set 4.904x speedup, val set 0.715x speedup, step: 36, train time 17.42 s
Epoch 40/50 |loss: 0.124405| train set 3.422x speedup, test set 5.080x speedup, val set 0.957x speedup, step: 37, train time 17.21 s
Epoch 41/50 |loss: 0.119949| train set 3.186x speedup, test set 5.110x speedup, val set 0.977x speedup, step: 38, train time 17.48 s
Epoch 42/50 |loss: 0.117851| train set 3.471x speedup, test set 5.080x speedup, val set 0.700x speedup, step: 39, train time 17.20 s
Epoch 43/50 |loss: 0.116530| train set 3.358x speedup, test set 5.080x speedup, val set 1.019x speedup, step: 40, train time 17.29 s
Epoch 44/50 |loss: 0.116095| train set 3.307x speedup, test set 5.080x speedup, val set 1.006x speedup, step: 41, train time 17.41 s
Epoch 45/50 |loss: 0.111138| train set 3.254x speedup, test set 5.080x speedup, val set 0.775x speedup, step: 42, train time 17.38 s
Epoch 46/50 |loss: 0.108275| train set 3.343x speedup, test set 5.080x speedup, val set 0.701x speedup, step: 43, train time 17.51 s
Epoch 47/50 |loss: 0.107925| train set 3.336x speedup, test set 5.080x speedup, val set 0.794x speedup, step: 44, train time 17.50 s
Epoch 48/50 |loss: 0.110975| train set 3.418x speedup, test set 5.080x speedup, val set 0.794x speedup, step: 45, train time 17.39 s
Epoch 49/50 |loss: 0.107733| train set 3.445x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 46, train time 17.41 s
Training per epoch cost 17.279 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 42, train speedup 3.471, test speedup 5.080, val speedup 0.700
best test speedup epoch: 3, train speedup 2.653, test speedup 5.981, val speedup 0.900
best validation speedup epoch: 4, train speedup 2.988, test speedup 5.981, val speedup 1.863
last model at epoch 49, train speedup 3.445, test speedup 5.080, val speedup 0.977
execution cost 0:15:54.310725
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.167150, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427419| train set 1.448x speedup, test set 6.690x speedup, val set 0.997x speedup, step: 1, train time 18.55 s
Epoch 1/50 |loss: 0.344821| train set 2.379x speedup, test set 4.756x speedup, val set 1.031x speedup, step: 2, train time 17.42 s
Epoch 2/50 |loss: 0.315888| train set 2.322x speedup, test set 5.035x speedup, val set 0.924x speedup, step: 3, train time 16.69 s
Epoch 3/50 |loss: 0.294396| train set 2.669x speedup, test set 4.940x speedup, val set 1.398x speedup, step: 4, train time 16.70 s
Epoch 4/50 |loss: 0.274628| train set 3.065x speedup, test set 6.683x speedup, val set 1.366x speedup, step: 1, train time 16.60 s
Epoch 5/50 |loss: 0.256278| train set 2.751x speedup, test set 6.950x speedup, val set 0.901x speedup, step: 2, train time 16.59 s
Epoch 6/50 |loss: 0.239961| train set 3.019x speedup, test set 6.683x speedup, val set 0.936x speedup, step: 3, train time 16.70 s
Epoch 7/50 |loss: 0.234311| train set 3.218x speedup, test set 6.943x speedup, val set 0.885x speedup, step: 4, train time 16.69 s
Epoch 8/50 |loss: 0.225385| train set 3.400x speedup, test set 5.182x speedup, val set 1.001x speedup, step: 5, train time 16.62 s
Epoch 9/50 |loss: 0.220205| train set 2.980x speedup, test set 5.182x speedup, val set 0.908x speedup, step: 6, train time 16.68 s
Epoch 10/50 |loss: 0.204638| train set 2.823x speedup, test set 5.182x speedup, val set 0.985x speedup, step: 7, train time 16.80 s
Epoch 11/50 |loss: 0.202339| train set 3.269x speedup, test set 5.213x speedup, val set 1.002x speedup, step: 8, train time 16.52 s
Epoch 12/50 |loss: 0.199814| train set 2.762x speedup, test set 4.881x speedup, val set 0.898x speedup, step: 9, train time 16.62 s
Epoch 13/50 |loss: 0.194000| train set 3.087x speedup, test set 4.881x speedup, val set 0.441x speedup, step: 10, train time 16.72 s
Epoch 14/50 |loss: 0.191231| train set 3.342x speedup, test set 6.234x speedup, val set 0.975x speedup, step: 11, train time 16.50 s
Epoch 15/50 |loss: 0.182842| train set 3.122x speedup, test set 4.908x speedup, val set 0.985x speedup, step: 12, train time 16.52 s
Epoch 16/50 |loss: 0.176761| train set 3.237x speedup, test set 4.908x speedup, val set 1.011x speedup, step: 13, train time 16.60 s
Epoch 17/50 |loss: 0.178698| train set 3.187x speedup, test set 5.182x speedup, val set 0.701x speedup, step: 14, train time 16.60 s
Epoch 18/50 |loss: 0.174023| train set 3.224x speedup, test set 5.182x speedup, val set 0.900x speedup, step: 15, train time 16.69 s
Epoch 19/50 |loss: 0.171514| train set 3.279x speedup, test set 5.213x speedup, val set 0.661x speedup, step: 16, train time 16.51 s
Epoch 20/50 |loss: 0.165208| train set 3.211x speedup, test set 6.234x speedup, val set 0.975x speedup, step: 17, train time 16.41 s
Epoch 21/50 |loss: 0.159437| train set 3.043x speedup, test set 5.213x speedup, val set 0.901x speedup, step: 18, train time 16.42 s
Epoch 22/50 |loss: 0.160588| train set 3.295x speedup, test set 5.213x speedup, val set 0.948x speedup, step: 19, train time 16.50 s
Epoch 23/50 |loss: 0.155342| train set 3.200x speedup, test set 5.213x speedup, val set 0.948x speedup, step: 20, train time 16.52 s
Epoch 24/50 |loss: 0.147533| train set 2.853x speedup, test set 5.213x speedup, val set 0.701x speedup, step: 21, train time 16.51 s
Epoch 25/50 |loss: 0.151563| train set 3.249x speedup, test set 4.908x speedup, val set 0.977x speedup, step: 22, train time 16.21 s
Epoch 26/50 |loss: 0.149452| train set 3.135x speedup, test set 6.234x speedup, val set 0.901x speedup, step: 23, train time 16.31 s
Epoch 27/50 |loss: 0.145974| train set 3.216x speedup, test set 6.234x speedup, val set 0.977x speedup, step: 24, train time 16.40 s
Epoch 28/50 |loss: 0.141579| train set 3.379x speedup, test set 5.213x speedup, val set 0.949x speedup, step: 25, train time 16.60 s
Epoch 29/50 |loss: 0.143635| train set 3.108x speedup, test set 5.213x speedup, val set 0.948x speedup, step: 26, train time 16.50 s
Epoch 30/50 |loss: 0.140538| train set 3.274x speedup, test set 5.213x speedup, val set 0.948x speedup, step: 27, train time 16.43 s
Epoch 31/50 |loss: 0.138489| train set 3.210x speedup, test set 5.213x speedup, val set 0.700x speedup, step: 28, train time 16.41 s
Epoch 32/50 |loss: 0.128510| train set 3.276x speedup, test set 6.234x speedup, val set 0.975x speedup, step: 29, train time 16.40 s
Epoch 33/50 |loss: 0.132210| train set 3.269x speedup, test set 6.234x speedup, val set 0.949x speedup, step: 30, train time 16.40 s
Epoch 34/50 |loss: 0.131429| train set 3.338x speedup, test set 5.213x speedup, val set 0.701x speedup, step: 31, train time 16.51 s
Epoch 35/50 |loss: 0.127705| train set 3.216x speedup, test set 6.234x speedup, val set 0.731x speedup, step: 32, train time 16.59 s
Epoch 36/50 |loss: 0.131403| train set 3.344x speedup, test set 6.234x speedup, val set 0.715x speedup, step: 33, train time 16.41 s
Epoch 37/50 |loss: 0.127697| train set 3.389x speedup, test set 6.234x speedup, val set 1.007x speedup, step: 34, train time 16.38 s
Epoch 38/50 |loss: 0.129611| train set 3.008x speedup, test set 6.234x speedup, val set 0.716x speedup, step: 35, train time 16.43 s
Epoch 39/50 |loss: 0.120734| train set 3.149x speedup, test set 6.234x speedup, val set 0.731x speedup, step: 36, train time 16.31 s
Epoch 40/50 |loss: 0.124483| train set 3.362x speedup, test set 5.213x speedup, val set 0.975x speedup, step: 37, train time 16.50 s
Epoch 41/50 |loss: 0.120965| train set 3.153x speedup, test set 6.234x speedup, val set 0.701x speedup, step: 38, train time 16.42 s
Epoch 42/50 |loss: 0.122258| train set 3.449x speedup, test set 5.213x speedup, val set 0.700x speedup, step: 39, train time 16.27 s
Epoch 43/50 |loss: 0.116453| train set 3.381x speedup, test set 5.213x speedup, val set 0.701x speedup, step: 40, train time 16.32 s
Epoch 44/50 |loss: 0.120490| train set 3.181x speedup, test set 6.234x speedup, val set 0.701x speedup, step: 41, train time 16.50 s
Epoch 45/50 |loss: 0.114093| train set 3.261x speedup, test set 5.213x speedup, val set 0.701x speedup, step: 42, train time 16.41 s
Epoch 46/50 |loss: 0.109818| train set 3.411x speedup, test set 5.213x speedup, val set 0.701x speedup, step: 43, train time 16.49 s
Epoch 47/50 |loss: 0.110215| train set 3.152x speedup, test set 5.213x speedup, val set 0.700x speedup, step: 44, train time 16.31 s
Epoch 48/50 |loss: 0.114114| train set 3.354x speedup, test set 5.213x speedup, val set 0.776x speedup, step: 45, train time 16.41 s
Epoch 49/50 |loss: 0.109376| train set 3.390x speedup, test set 6.234x speedup, val set 1.003x speedup, step: 46, train time 16.50 s
Training per epoch cost 16.562 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 8.427s, pg runtime 17.708s, speedup 2.101x
12, opt runtime 6.284s, model runtime 7.202s, pg runtime 31.019s, speedup 4.307x
13, opt runtime 7.851s, model runtime 7.851s, pg runtime 13.622s, speedup 1.735x
14, opt runtime 7.442s, model runtime 8.035s, pg runtime 14.838s, speedup 1.847x
15, opt runtime 7.110s, model runtime 7.841s, pg runtime 14.286s, speedup 1.822x
16, opt runtime 6.810s, model runtime 7.859s, pg runtime 13.796s, speedup 1.755x
17, opt runtime 6.460s, model runtime 7.335s, pg runtime 16.134s, speedup 2.200x
18, opt runtime 6.656s, model runtime 7.351s, pg runtime 15.260s, speedup 2.076x
19, opt runtime 7.913s, model runtime 7.913s, pg runtime 15.548s, speedup 1.965x
20, opt runtime 7.377s, model runtime 7.377s, pg runtime 28.655s, speedup 3.885x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 42, train speedup 3.449, test speedup 5.213, val speedup 0.700
best test speedup epoch: 5, train speedup 2.751, test speedup 6.950, val speedup 0.901
best validation speedup epoch: 4, train speedup 3.065, test speedup 6.683, val speedup 1.366
last model at epoch 49, train speedup 3.390, test speedup 6.234, val speedup 1.003
execution cost 0:15:07.655728
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.888905, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425360| train set 1.496x speedup, test set 0.847x speedup, val set 0.801x speedup, step: 1, train time 18.52 s
Epoch 1/50 |loss: 0.344849| train set 2.369x speedup, test set 4.730x speedup, val set 0.730x speedup, step: 2, train time 17.12 s
Epoch 2/50 |loss: 0.314469| train set 2.354x speedup, test set 6.690x speedup, val set 0.984x speedup, step: 3, train time 16.40 s
Epoch 3/50 |loss: 0.292663| train set 2.617x speedup, test set 5.981x speedup, val set 0.926x speedup, step: 4, train time 16.40 s
Epoch 4/50 |loss: 0.278586| train set 2.683x speedup, test set 4.730x speedup, val set 1.768x speedup, step: 1, train time 16.41 s
Epoch 5/50 |loss: 0.255769| train set 2.723x speedup, test set 5.981x speedup, val set 1.022x speedup, step: 2, train time 16.30 s
Epoch 6/50 |loss: 0.239597| train set 3.066x speedup, test set 6.189x speedup, val set 0.936x speedup, step: 3, train time 16.37 s
Epoch 7/50 |loss: 0.235549| train set 3.028x speedup, test set 6.189x speedup, val set 1.003x speedup, step: 4, train time 16.31 s
Epoch 8/50 |loss: 0.224037| train set 3.352x speedup, test set 6.189x speedup, val set 0.998x speedup, step: 5, train time 16.49 s
Epoch 9/50 |loss: 0.221832| train set 2.984x speedup, test set 4.881x speedup, val set 0.910x speedup, step: 6, train time 16.41 s
Epoch 10/50 |loss: 0.207296| train set 2.666x speedup, test set 6.189x speedup, val set 0.910x speedup, step: 7, train time 16.41 s
Epoch 11/50 |loss: 0.200858| train set 3.176x speedup, test set 5.182x speedup, val set 1.019x speedup, step: 8, train time 16.51 s
Epoch 12/50 |loss: 0.201853| train set 2.726x speedup, test set 4.881x speedup, val set 0.885x speedup, step: 9, train time 16.50 s
Epoch 13/50 |loss: 0.194896| train set 2.838x speedup, test set 6.943x speedup, val set 0.886x speedup, step: 10, train time 16.48 s
Epoch 14/50 |loss: 0.189096| train set 3.299x speedup, test set 1.306x speedup, val set 0.886x speedup, step: 11, train time 16.39 s
Epoch 15/50 |loss: 0.185277| train set 3.238x speedup, test set 4.678x speedup, val set 0.988x speedup, step: 12, train time 16.42 s
Epoch 16/50 |loss: 0.175623| train set 3.043x speedup, test set 6.943x speedup, val set 0.988x speedup, step: 13, train time 16.49 s
Epoch 17/50 |loss: 0.178468| train set 3.180x speedup, test set 4.678x speedup, val set 0.886x speedup, step: 14, train time 16.59 s
Epoch 18/50 |loss: 0.172014| train set 3.166x speedup, test set 4.678x speedup, val set 0.886x speedup, step: 15, train time 16.69 s
Epoch 19/50 |loss: 0.171261| train set 3.300x speedup, test set 6.943x speedup, val set 0.910x speedup, step: 16, train time 16.59 s
Epoch 20/50 |loss: 0.165989| train set 3.194x speedup, test set 6.943x speedup, val set 0.886x speedup, step: 17, train time 16.42 s
Epoch 21/50 |loss: 0.159600| train set 3.184x speedup, test set 4.830x speedup, val set 0.908x speedup, step: 18, train time 16.43 s
Epoch 22/50 |loss: 0.162230| train set 3.262x speedup, test set 4.678x speedup, val set 0.733x speedup, step: 19, train time 16.41 s
Epoch 23/50 |loss: 0.153267| train set 3.080x speedup, test set 3.641x speedup, val set 0.783x speedup, step: 20, train time 16.50 s
Epoch 24/50 |loss: 0.148096| train set 2.933x speedup, test set 3.641x speedup, val set 0.783x speedup, step: 21, train time 16.43 s
Epoch 25/50 |loss: 0.152275| train set 3.283x speedup, test set 3.641x speedup, val set 0.783x speedup, step: 22, train time 16.20 s
Epoch 26/50 |loss: 0.149046| train set 2.872x speedup, test set 4.323x speedup, val set 0.886x speedup, step: 23, train time 16.31 s
Epoch 27/50 |loss: 0.148462| train set 3.226x speedup, test set 3.806x speedup, val set 0.783x speedup, step: 24, train time 16.50 s
Epoch 28/50 |loss: 0.139253| train set 3.203x speedup, test set 3.641x speedup, val set 0.783x speedup, step: 25, train time 16.31 s
Epoch 29/50 |loss: 0.144902| train set 3.120x speedup, test set 3.792x speedup, val set 0.886x speedup, step: 26, train time 16.41 s
Epoch 30/50 |loss: 0.137260| train set 3.133x speedup, test set 3.641x speedup, val set 0.783x speedup, step: 27, train time 16.40 s
Epoch 31/50 |loss: 0.143086| train set 3.419x speedup, test set 3.792x speedup, val set 0.959x speedup, step: 28, train time 16.21 s
Epoch 32/50 |loss: 0.131694| train set 3.370x speedup, test set 3.641x speedup, val set 0.886x speedup, step: 29, train time 16.39 s
Epoch 33/50 |loss: 0.134088| train set 3.280x speedup, test set 3.641x speedup, val set 0.886x speedup, step: 30, train time 16.39 s
Epoch 34/50 |loss: 0.130289| train set 3.289x speedup, test set 3.641x speedup, val set 0.986x speedup, step: 31, train time 16.28 s
Epoch 35/50 |loss: 0.127852| train set 3.359x speedup, test set 3.792x speedup, val set 0.988x speedup, step: 32, train time 15.40 s
Epoch 36/50 |loss: 0.127596| train set 3.351x speedup, test set 3.641x speedup, val set 0.783x speedup, step: 33, train time 10.19 s
Epoch 37/50 |loss: 0.127983| train set 3.224x speedup, test set 3.641x speedup, val set 0.959x speedup, step: 34, train time 12.20 s
Epoch 38/50 |loss: 0.126708| train set 3.218x speedup, test set 3.641x speedup, val set 0.782x speedup, step: 35, train time 16.40 s
Epoch 39/50 |loss: 0.121627| train set 3.344x speedup, test set 3.641x speedup, val set 0.947x speedup, step: 36, train time 16.51 s
Epoch 40/50 |loss: 0.125116| train set 3.465x speedup, test set 3.792x speedup, val set 0.783x speedup, step: 37, train time 16.40 s
Epoch 41/50 |loss: 0.119820| train set 3.287x speedup, test set 3.641x speedup, val set 0.733x speedup, step: 38, train time 16.30 s
Epoch 42/50 |loss: 0.120658| train set 3.289x speedup, test set 5.110x speedup, val set 1.264x speedup, step: 39, train time 16.39 s
Epoch 43/50 |loss: 0.120225| train set 3.360x speedup, test set 3.792x speedup, val set 0.782x speedup, step: 40, train time 16.50 s
Epoch 44/50 |loss: 0.116522| train set 3.167x speedup, test set 3.641x speedup, val set 0.910x speedup, step: 41, train time 16.49 s
Epoch 45/50 |loss: 0.115257| train set 3.471x speedup, test set 3.792x speedup, val set 0.783x speedup, step: 42, train time 16.39 s
Epoch 46/50 |loss: 0.111553| train set 3.282x speedup, test set 3.792x speedup, val set 0.959x speedup, step: 43, train time 16.39 s
Epoch 47/50 |loss: 0.113351| train set 3.308x speedup, test set 3.641x speedup, val set 1.267x speedup, step: 44, train time 16.41 s
Epoch 48/50 |loss: 0.115064| train set 3.456x speedup, test set 4.908x speedup, val set 1.267x speedup, step: 45, train time 16.52 s
Epoch 49/50 |loss: 0.108641| train set 3.391x speedup, test set 4.678x speedup, val set 0.988x speedup, step: 46, train time 16.37 s
Training per epoch cost 16.245 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 40.999s, pg runtime 17.708s, speedup 0.432x
12, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
13, opt runtime 7.851s, model runtime 48.810s, pg runtime 13.622s, speedup 0.279x
14, opt runtime 7.442s, model runtime 54.724s, pg runtime 14.838s, speedup 0.271x
15, opt runtime 7.110s, model runtime 47.392s, pg runtime 14.286s, speedup 0.301x
16, opt runtime 6.810s, model runtime 41.706s, pg runtime 13.796s, speedup 0.331x
17, opt runtime 6.460s, model runtime 34.333s, pg runtime 16.134s, speedup 0.470x
18, opt runtime 6.656s, model runtime 36.884s, pg runtime 15.260s, speedup 0.414x
19, opt runtime 7.913s, model runtime 52.768s, pg runtime 15.548s, speedup 0.295x
20, opt runtime 7.377s, model runtime 37.574s, pg runtime 28.655s, speedup 0.763x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 45, train speedup 3.471, test speedup 3.792, val speedup 0.783
best test speedup epoch: 13, train speedup 2.838, test speedup 6.943, val speedup 0.886
best validation speedup epoch: 4, train speedup 2.683, test speedup 4.730, val speedup 1.768
last model at epoch 49, train speedup 3.391, test speedup 4.678, val speedup 0.988
execution cost 0:14:47.691131
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.476166, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427586| train set 2.296x speedup, test set 4.730x speedup, val set 0.782x speedup, step: 1, train time 19.63 s
Epoch 1/50 |loss: 0.347819| train set 2.310x speedup, test set 4.756x speedup, val set 0.801x speedup, step: 2, train time 18.19 s
Epoch 2/50 |loss: 0.318796| train set 2.358x speedup, test set 4.730x speedup, val set 0.973x speedup, step: 3, train time 17.27 s
Epoch 3/50 |loss: 0.294261| train set 2.792x speedup, test set 5.981x speedup, val set 0.926x speedup, step: 4, train time 16.89 s
Epoch 4/50 |loss: 0.275534| train set 2.988x speedup, test set 1.395x speedup, val set 1.030x speedup, step: 1, train time 16.81 s
Epoch 5/50 |loss: 0.257162| train set 2.591x speedup, test set 4.730x speedup, val set 1.015x speedup, step: 2, train time 17.00 s
Epoch 6/50 |loss: 0.241058| train set 3.100x speedup, test set 1.327x speedup, val set 1.015x speedup, step: 3, train time 17.09 s
Epoch 7/50 |loss: 0.232135| train set 3.052x speedup, test set 6.189x speedup, val set 0.985x speedup, step: 4, train time 17.18 s
Epoch 8/50 |loss: 0.224127| train set 3.086x speedup, test set 5.182x speedup, val set 0.945x speedup, step: 5, train time 16.82 s
Epoch 9/50 |loss: 0.220476| train set 3.141x speedup, test set 5.182x speedup, val set 0.955x speedup, step: 6, train time 17.08 s
Epoch 10/50 |loss: 0.206392| train set 2.876x speedup, test set 5.182x speedup, val set 0.984x speedup, step: 7, train time 16.91 s
Epoch 11/50 |loss: 0.199912| train set 3.157x speedup, test set 5.182x speedup, val set 1.113x speedup, step: 8, train time 16.81 s
Epoch 12/50 |loss: 0.198704| train set 2.565x speedup, test set 1.327x speedup, val set 0.984x speedup, step: 9, train time 17.11 s
Epoch 13/50 |loss: 0.193347| train set 3.009x speedup, test set 1.327x speedup, val set 0.956x speedup, step: 10, train time 16.82 s
Epoch 14/50 |loss: 0.190872| train set 3.304x speedup, test set 1.327x speedup, val set 1.075x speedup, step: 1, train time 16.90 s
Epoch 15/50 |loss: 0.188441| train set 3.297x speedup, test set 5.213x speedup, val set 1.075x speedup, step: 2, train time 16.70 s
Epoch 16/50 |loss: 0.173320| train set 3.272x speedup, test set 5.182x speedup, val set 1.107x speedup, step: 3, train time 16.94 s
Epoch 17/50 |loss: 0.178247| train set 2.828x speedup, test set 5.182x speedup, val set 1.042x speedup, step: 4, train time 16.61 s
Epoch 18/50 |loss: 0.173882| train set 2.997x speedup, test set 5.182x speedup, val set 0.877x speedup, step: 5, train time 16.71 s
Epoch 19/50 |loss: 0.170001| train set 3.386x speedup, test set 5.182x speedup, val set 1.010x speedup, step: 6, train time 16.83 s
Epoch 20/50 |loss: 0.165345| train set 3.059x speedup, test set 5.182x speedup, val set 1.043x speedup, step: 7, train time 17.19 s
Epoch 21/50 |loss: 0.159461| train set 3.193x speedup, test set 5.182x speedup, val set 0.910x speedup, step: 8, train time 16.98 s
Epoch 22/50 |loss: 0.157312| train set 3.172x speedup, test set 5.213x speedup, val set 0.986x speedup, step: 9, train time 17.13 s
Epoch 23/50 |loss: 0.153002| train set 3.419x speedup, test set 5.182x speedup, val set 1.043x speedup, step: 10, train time 17.19 s
Epoch 24/50 |loss: 0.144807| train set 2.968x speedup, test set 5.213x speedup, val set 1.077x speedup, step: 1, train time 17.19 s
Epoch 25/50 |loss: 0.151519| train set 3.295x speedup, test set 5.213x speedup, val set 0.946x speedup, step: 2, train time 17.08 s
Epoch 26/50 |loss: 0.146740| train set 2.699x speedup, test set 5.213x speedup, val set 0.956x speedup, step: 3, train time 17.10 s
Epoch 27/50 |loss: 0.140351| train set 3.408x speedup, test set 5.213x speedup, val set 0.977x speedup, step: 4, train time 17.00 s
Epoch 28/50 |loss: 0.138127| train set 3.347x speedup, test set 5.182x speedup, val set 1.043x speedup, step: 5, train time 17.18 s
Epoch 29/50 |loss: 0.141495| train set 3.266x speedup, test set 5.182x speedup, val set 0.949x speedup, step: 6, train time 17.21 s
Epoch 30/50 |loss: 0.136806| train set 3.229x speedup, test set 5.213x speedup, val set 0.959x speedup, step: 7, train time 16.90 s
Epoch 31/50 |loss: 0.136872| train set 3.330x speedup, test set 5.213x speedup, val set 0.946x speedup, step: 8, train time 16.72 s
Epoch 32/50 |loss: 0.129374| train set 3.368x speedup, test set 5.213x speedup, val set 0.441x speedup, step: 9, train time 16.78 s
Epoch 33/50 |loss: 0.126852| train set 3.357x speedup, test set 7.000x speedup, val set 1.043x speedup, step: 10, train time 16.78 s
Epoch 34/50 |loss: 0.128320| train set 3.429x speedup, test set 5.213x speedup, val set 0.955x speedup, step: 11, train time 16.53 s
Epoch 35/50 |loss: 0.122829| train set 3.354x speedup, test set 5.213x speedup, val set 1.040x speedup, step: 12, train time 16.60 s
Epoch 36/50 |loss: 0.124961| train set 3.362x speedup, test set 5.182x speedup, val set 0.425x speedup, step: 13, train time 16.60 s
Epoch 37/50 |loss: 0.122422| train set 3.347x speedup, test set 5.213x speedup, val set 1.043x speedup, step: 14, train time 16.61 s
Epoch 38/50 |loss: 0.119731| train set 3.149x speedup, test set 5.213x speedup, val set 0.877x speedup, step: 15, train time 16.52 s
Epoch 39/50 |loss: 0.118143| train set 3.401x speedup, test set 5.213x speedup, val set 0.441x speedup, step: 16, train time 16.60 s
Epoch 40/50 |loss: 0.119846| train set 3.290x speedup, test set 5.213x speedup, val set 1.043x speedup, step: 17, train time 16.51 s
Epoch 41/50 |loss: 0.117558| train set 3.323x speedup, test set 5.213x speedup, val set 1.043x speedup, step: 18, train time 16.70 s
Epoch 42/50 |loss: 0.116865| train set 3.336x speedup, test set 5.213x speedup, val set 1.040x speedup, step: 19, train time 16.51 s
Epoch 43/50 |loss: 0.116955| train set 3.387x speedup, test set 5.213x speedup, val set 1.043x speedup, step: 20, train time 16.80 s
Epoch 44/50 |loss: 0.113591| train set 3.178x speedup, test set 5.110x speedup, val set 1.077x speedup, step: 1, train time 16.68 s
Epoch 45/50 |loss: 0.108833| train set 3.228x speedup, test set 5.182x speedup, val set 0.949x speedup, step: 2, train time 16.68 s
Epoch 46/50 |loss: 0.105778| train set 3.472x speedup, test set 5.213x speedup, val set 0.948x speedup, step: 3, train time 16.60 s
Epoch 47/50 |loss: 0.106551| train set 3.347x speedup, test set 5.213x speedup, val set 0.776x speedup, step: 4, train time 16.60 s
Epoch 48/50 |loss: 0.111848| train set 3.419x speedup, test set 5.213x speedup, val set 1.043x speedup, step: 5, train time 16.70 s
Epoch 49/50 |loss: 0.107675| train set 3.453x speedup, test set 5.182x speedup, val set 0.441x speedup, step: 6, train time 16.59 s
Training per epoch cost 16.931 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 27.212s, pg runtime 17.708s, speedup 0.651x
12, opt runtime 6.284s, model runtime 27.699s, pg runtime 31.019s, speedup 1.120x
13, opt runtime 7.851s, model runtime 50.910s, pg runtime 13.622s, speedup 0.268x
14, opt runtime 7.442s, model runtime 46.719s, pg runtime 14.838s, speedup 0.318x
15, opt runtime 7.110s, model runtime 47.988s, pg runtime 14.286s, speedup 0.298x
16, opt runtime 6.810s, model runtime 51.478s, pg runtime 13.796s, speedup 0.268x
17, opt runtime 6.460s, model runtime 26.481s, pg runtime 16.134s, speedup 0.609x
18, opt runtime 6.656s, model runtime 29.910s, pg runtime 15.260s, speedup 0.510x
19, opt runtime 7.913s, model runtime 48.858s, pg runtime 15.548s, speedup 0.318x
20, opt runtime 7.377s, model runtime 31.774s, pg runtime 28.655s, speedup 0.902x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 46, train speedup 3.472, test speedup 5.213, val speedup 0.948
best test speedup epoch: 33, train speedup 3.357, test speedup 7.000, val speedup 1.043
best validation speedup epoch: 44, train speedup 3.178, test speedup 5.110, val speedup 1.077
last model at epoch 49, train speedup 3.453, test speedup 5.182, val speedup 0.441
execution cost 0:15:32.785392
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.488690, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425102| train set 2.294x speedup, test set 4.730x speedup, val set 0.793x speedup, step: 1, train time 19.78 s
Epoch 1/50 |loss: 0.343360| train set 2.335x speedup, test set 4.756x speedup, val set 0.730x speedup, step: 2, train time 18.10 s
Epoch 2/50 |loss: 0.315679| train set 2.392x speedup, test set 5.035x speedup, val set 1.016x speedup, step: 3, train time 17.09 s
Epoch 3/50 |loss: 0.293297| train set 2.504x speedup, test set 5.981x speedup, val set 0.994x speedup, step: 4, train time 17.12 s
Epoch 4/50 |loss: 0.274113| train set 2.900x speedup, test set 5.065x speedup, val set 1.004x speedup, step: 1, train time 17.01 s
Epoch 5/50 |loss: 0.254446| train set 2.556x speedup, test set 5.035x speedup, val set 1.015x speedup, step: 2, train time 16.99 s
Epoch 6/50 |loss: 0.239258| train set 2.641x speedup, test set 4.622x speedup, val set 1.013x speedup, step: 3, train time 16.94 s
Epoch 7/50 |loss: 0.233924| train set 3.168x speedup, test set 5.213x speedup, val set 0.973x speedup, step: 4, train time 16.99 s
Epoch 8/50 |loss: 0.223551| train set 3.277x speedup, test set 5.182x speedup, val set 0.954x speedup, step: 5, train time 17.01 s
Epoch 9/50 |loss: 0.222409| train set 3.248x speedup, test set 5.182x speedup, val set 0.956x speedup, step: 6, train time 17.01 s
Epoch 10/50 |loss: 0.208677| train set 2.780x speedup, test set 5.182x speedup, val set 1.008x speedup, step: 7, train time 16.94 s
Epoch 11/50 |loss: 0.200889| train set 3.114x speedup, test set 5.182x speedup, val set 1.076x speedup, step: 8, train time 17.01 s
Epoch 12/50 |loss: 0.200103| train set 3.040x speedup, test set 5.182x speedup, val set 0.983x speedup, step: 9, train time 16.80 s
Epoch 13/50 |loss: 0.194841| train set 2.972x speedup, test set 5.182x speedup, val set 0.956x speedup, step: 10, train time 16.92 s
Epoch 14/50 |loss: 0.189585| train set 3.326x speedup, test set 5.182x speedup, val set 1.105x speedup, step: 1, train time 16.60 s
Epoch 15/50 |loss: 0.183047| train set 3.063x speedup, test set 5.213x speedup, val set 1.094x speedup, step: 2, train time 16.60 s
Epoch 16/50 |loss: 0.175683| train set 3.176x speedup, test set 5.182x speedup, val set 0.750x speedup, step: 3, train time 16.59 s
Epoch 17/50 |loss: 0.178110| train set 3.011x speedup, test set 5.182x speedup, val set 0.836x speedup, step: 4, train time 16.62 s
Epoch 18/50 |loss: 0.170872| train set 3.181x speedup, test set 5.182x speedup, val set 1.075x speedup, step: 5, train time 16.60 s
Epoch 19/50 |loss: 0.167740| train set 3.158x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 6, train time 16.50 s
Epoch 20/50 |loss: 0.161780| train set 3.264x speedup, test set 5.182x speedup, val set 0.959x speedup, step: 7, train time 16.60 s
Epoch 21/50 |loss: 0.154311| train set 3.012x speedup, test set 5.182x speedup, val set 0.705x speedup, step: 8, train time 16.58 s
Epoch 22/50 |loss: 0.155396| train set 3.310x speedup, test set 5.182x speedup, val set 1.077x speedup, step: 9, train time 16.62 s
Epoch 23/50 |loss: 0.149733| train set 3.309x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 10, train time 16.61 s
Epoch 24/50 |loss: 0.142040| train set 3.395x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 11, train time 16.59 s
Epoch 25/50 |loss: 0.146250| train set 3.294x speedup, test set 5.182x speedup, val set 0.750x speedup, step: 12, train time 16.58 s
Epoch 26/50 |loss: 0.144971| train set 3.014x speedup, test set 5.182x speedup, val set 0.956x speedup, step: 13, train time 16.69 s
Epoch 27/50 |loss: 0.142961| train set 3.407x speedup, test set 5.182x speedup, val set 0.703x speedup, step: 14, train time 16.63 s
Epoch 28/50 |loss: 0.134110| train set 3.225x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 15, train time 16.69 s
Epoch 29/50 |loss: 0.136964| train set 3.133x speedup, test set 5.182x speedup, val set 0.707x speedup, step: 16, train time 16.50 s
Epoch 30/50 |loss: 0.130945| train set 3.262x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 17, train time 16.62 s
Epoch 31/50 |loss: 0.135425| train set 3.198x speedup, test set 5.182x speedup, val set 0.706x speedup, step: 18, train time 16.49 s
Epoch 32/50 |loss: 0.126507| train set 3.325x speedup, test set 4.699x speedup, val set 0.751x speedup, step: 19, train time 16.61 s
Epoch 33/50 |loss: 0.124010| train set 3.314x speedup, test set 5.182x speedup, val set 0.959x speedup, step: 20, train time 16.63 s
Epoch 34/50 |loss: 0.127671| train set 3.375x speedup, test set 5.182x speedup, val set 0.704x speedup, step: 21, train time 16.70 s
Epoch 35/50 |loss: 0.121957| train set 3.367x speedup, test set 5.182x speedup, val set 0.707x speedup, step: 22, train time 16.64 s
Epoch 36/50 |loss: 0.126187| train set 3.395x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 23, train time 16.51 s
Epoch 37/50 |loss: 0.123127| train set 3.184x speedup, test set 5.182x speedup, val set 0.769x speedup, step: 24, train time 16.71 s
Epoch 38/50 |loss: 0.119739| train set 3.337x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 25, train time 16.51 s
Epoch 39/50 |loss: 0.116823| train set 3.395x speedup, test set 5.182x speedup, val set 0.704x speedup, step: 26, train time 16.52 s
Epoch 40/50 |loss: 0.118728| train set 3.347x speedup, test set 5.182x speedup, val set 1.077x speedup, step: 27, train time 16.50 s
Epoch 41/50 |loss: 0.116382| train set 3.354x speedup, test set 4.745x speedup, val set 0.783x speedup, step: 28, train time 16.62 s
Epoch 42/50 |loss: 0.116185| train set 3.491x speedup, test set 5.182x speedup, val set 0.707x speedup, step: 29, train time 16.60 s
Epoch 43/50 |loss: 0.114922| train set 3.417x speedup, test set 3.806x speedup, val set 0.707x speedup, step: 30, train time 16.70 s
Epoch 44/50 |loss: 0.111140| train set 3.317x speedup, test set 3.806x speedup, val set 0.945x speedup, step: 31, train time 16.69 s
Epoch 45/50 |loss: 0.107695| train set 3.262x speedup, test set 5.182x speedup, val set 0.707x speedup, step: 32, train time 16.50 s
Epoch 46/50 |loss: 0.107385| train set 3.489x speedup, test set 3.806x speedup, val set 0.707x speedup, step: 33, train time 16.60 s
Epoch 47/50 |loss: 0.109497| train set 3.213x speedup, test set 3.806x speedup, val set 0.706x speedup, step: 34, train time 16.49 s
Epoch 48/50 |loss: 0.110643| train set 3.449x speedup, test set 3.806x speedup, val set 1.991x speedup, step: 35, train time 16.53 s
Epoch 49/50 |loss: 0.108268| train set 3.435x speedup, test set 3.806x speedup, val set 0.703x speedup, step: 36, train time 16.50 s
Training per epoch cost 16.780 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 36.429s, pg runtime 17.708s, speedup 0.486x
12, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
13, opt runtime 7.851s, model runtime 30.956s, pg runtime 13.622s, speedup 0.440x
14, opt runtime 7.442s, model runtime 32.816s, pg runtime 14.838s, speedup 0.452x
15, opt runtime 7.110s, model runtime 38.849s, pg runtime 14.286s, speedup 0.368x
16, opt runtime 6.810s, model runtime 39.840s, pg runtime 13.796s, speedup 0.346x
17, opt runtime 6.460s, model runtime 33.445s, pg runtime 16.134s, speedup 0.482x
18, opt runtime 6.656s, model runtime 39.236s, pg runtime 15.260s, speedup 0.389x
19, opt runtime 7.913s, model runtime 32.779s, pg runtime 15.548s, speedup 0.474x
20, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 42, train speedup 3.491, test speedup 5.182, val speedup 0.707
best test speedup epoch: 3, train speedup 2.504, test speedup 5.981, val speedup 0.994
best validation speedup epoch: 14, train speedup 3.326, test speedup 5.182, val speedup 1.105
last model at epoch 49, train speedup 3.435, test speedup 3.806, val speedup 0.703
execution cost 0:15:22.170713
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.230426, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425473| train set 2.288x speedup, test set 4.730x speedup, val set 0.801x speedup, step: 1, train time 19.87 s
Epoch 1/50 |loss: 0.344093| train set 2.235x speedup, test set 0.847x speedup, val set 0.801x speedup, step: 2, train time 18.01 s
Epoch 2/50 |loss: 0.316923| train set 2.353x speedup, test set 6.690x speedup, val set 1.015x speedup, step: 3, train time 16.78 s
Epoch 3/50 |loss: 0.293737| train set 2.625x speedup, test set 6.690x speedup, val set 0.926x speedup, step: 4, train time 16.60 s
Epoch 4/50 |loss: 0.276541| train set 2.603x speedup, test set 5.981x speedup, val set 1.691x speedup, step: 1, train time 16.51 s
Epoch 5/50 |loss: 0.258190| train set 2.598x speedup, test set 5.035x speedup, val set 0.926x speedup, step: 2, train time 16.50 s
Epoch 6/50 |loss: 0.241542| train set 2.581x speedup, test set 5.080x speedup, val set 0.936x speedup, step: 3, train time 16.50 s
Epoch 7/50 |loss: 0.238569| train set 2.895x speedup, test set 5.080x speedup, val set 0.876x speedup, step: 4, train time 16.64 s
Epoch 8/50 |loss: 0.227362| train set 3.138x speedup, test set 5.182x speedup, val set 0.876x speedup, step: 5, train time 16.58 s
Epoch 9/50 |loss: 0.225331| train set 3.094x speedup, test set 5.182x speedup, val set 0.885x speedup, step: 6, train time 16.59 s
Epoch 10/50 |loss: 0.210273| train set 2.667x speedup, test set 4.323x speedup, val set 0.885x speedup, step: 7, train time 16.60 s
Epoch 11/50 |loss: 0.208599| train set 3.264x speedup, test set 0.860x speedup, val set 1.046x speedup, step: 8, train time 16.59 s
Epoch 12/50 |loss: 0.202878| train set 2.741x speedup, test set 5.080x speedup, val set 0.910x speedup, step: 9, train time 16.59 s
Epoch 13/50 |loss: 0.197074| train set 2.949x speedup, test set 5.080x speedup, val set 0.885x speedup, step: 10, train time 16.50 s
Epoch 14/50 |loss: 0.194106| train set 3.297x speedup, test set 4.323x speedup, val set 0.886x speedup, step: 11, train time 16.59 s
Epoch 15/50 |loss: 0.187439| train set 3.104x speedup, test set 4.323x speedup, val set 0.988x speedup, step: 12, train time 16.51 s
Epoch 16/50 |loss: 0.177292| train set 3.351x speedup, test set 3.751x speedup, val set 0.781x speedup, step: 13, train time 16.70 s
Epoch 17/50 |loss: 0.179246| train set 2.749x speedup, test set 5.182x speedup, val set 0.802x speedup, step: 14, train time 16.41 s
Epoch 18/50 |loss: 0.175892| train set 3.221x speedup, test set 5.182x speedup, val set 0.909x speedup, step: 15, train time 16.62 s
Epoch 19/50 |loss: 0.172693| train set 3.265x speedup, test set 5.182x speedup, val set 0.733x speedup, step: 16, train time 16.42 s
Epoch 20/50 |loss: 0.164374| train set 3.214x speedup, test set 5.182x speedup, val set 0.886x speedup, step: 17, train time 16.60 s
Epoch 21/50 |loss: 0.159458| train set 3.024x speedup, test set 5.213x speedup, val set 0.885x speedup, step: 18, train time 16.33 s
Epoch 22/50 |loss: 0.161450| train set 3.268x speedup, test set 5.182x speedup, val set 0.886x speedup, step: 19, train time 16.50 s
Epoch 23/50 |loss: 0.153830| train set 3.361x speedup, test set 5.182x speedup, val set 0.749x speedup, step: 20, train time 16.41 s
Epoch 24/50 |loss: 0.143848| train set 3.021x speedup, test set 3.806x speedup, val set 0.801x speedup, step: 21, train time 16.52 s
Epoch 25/50 |loss: 0.149573| train set 3.238x speedup, test set 5.182x speedup, val set 0.781x speedup, step: 22, train time 16.69 s
Epoch 26/50 |loss: 0.150495| train set 2.865x speedup, test set 5.213x speedup, val set 0.749x speedup, step: 23, train time 16.42 s
Epoch 27/50 |loss: 0.146348| train set 3.358x speedup, test set 3.806x speedup, val set 0.959x speedup, step: 24, train time 16.59 s
Epoch 28/50 |loss: 0.139127| train set 3.180x speedup, test set 5.182x speedup, val set 0.801x speedup, step: 25, train time 16.53 s
Epoch 29/50 |loss: 0.141316| train set 3.093x speedup, test set 3.806x speedup, val set 0.959x speedup, step: 26, train time 16.61 s
Epoch 30/50 |loss: 0.135205| train set 3.210x speedup, test set 3.806x speedup, val set 0.987x speedup, step: 27, train time 16.62 s
Epoch 31/50 |loss: 0.138874| train set 3.144x speedup, test set 5.110x speedup, val set 1.016x speedup, step: 28, train time 16.58 s
Epoch 32/50 |loss: 0.129507| train set 3.430x speedup, test set 5.110x speedup, val set 0.987x speedup, step: 29, train time 16.50 s
Epoch 33/50 |loss: 0.130296| train set 3.266x speedup, test set 4.881x speedup, val set 0.987x speedup, step: 30, train time 16.68 s
Epoch 34/50 |loss: 0.130736| train set 3.351x speedup, test set 5.182x speedup, val set 0.799x speedup, step: 31, train time 16.50 s
Epoch 35/50 |loss: 0.124904| train set 3.366x speedup, test set 3.806x speedup, val set 0.801x speedup, step: 32, train time 16.60 s
Epoch 36/50 |loss: 0.128443| train set 3.330x speedup, test set 3.751x speedup, val set 0.733x speedup, step: 33, train time 16.51 s
Epoch 37/50 |loss: 0.125251| train set 3.376x speedup, test set 5.213x speedup, val set 1.018x speedup, step: 34, train time 16.59 s
Epoch 38/50 |loss: 0.122721| train set 3.345x speedup, test set 5.080x speedup, val set 0.749x speedup, step: 35, train time 16.50 s
Epoch 39/50 |loss: 0.116862| train set 3.041x speedup, test set 4.881x speedup, val set 0.987x speedup, step: 36, train time 16.39 s
Epoch 40/50 |loss: 0.122599| train set 3.467x speedup, test set 5.213x speedup, val set 0.987x speedup, step: 37, train time 16.68 s
Epoch 41/50 |loss: 0.118526| train set 3.278x speedup, test set 5.213x speedup, val set 0.801x speedup, step: 38, train time 16.52 s
Epoch 42/50 |loss: 0.117062| train set 3.458x speedup, test set 5.182x speedup, val set 0.781x speedup, step: 39, train time 16.58 s
Epoch 43/50 |loss: 0.118063| train set 3.361x speedup, test set 3.806x speedup, val set 0.783x speedup, step: 40, train time 16.58 s
Epoch 44/50 |loss: 0.115656| train set 3.322x speedup, test set 5.182x speedup, val set 0.987x speedup, step: 41, train time 16.60 s
Epoch 45/50 |loss: 0.109312| train set 3.261x speedup, test set 3.806x speedup, val set 0.987x speedup, step: 42, train time 16.59 s
Epoch 46/50 |loss: 0.108409| train set 3.477x speedup, test set 5.182x speedup, val set 0.987x speedup, step: 43, train time 16.62 s
Epoch 47/50 |loss: 0.111987| train set 3.379x speedup, test set 3.751x speedup, val set 0.801x speedup, step: 44, train time 16.70 s
Epoch 48/50 |loss: 0.113902| train set 3.411x speedup, test set 5.110x speedup, val set 0.801x speedup, step: 45, train time 16.69 s
Epoch 49/50 |loss: 0.108922| train set 3.397x speedup, test set 3.751x speedup, val set 0.984x speedup, step: 46, train time 16.50 s
Training per epoch cost 16.656 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 46, train speedup 3.477, test speedup 5.182, val speedup 0.987
best test speedup epoch: 2, train speedup 2.353, test speedup 6.690, val speedup 1.015
best validation speedup epoch: 4, train speedup 2.603, test speedup 5.981, val speedup 1.691
last model at epoch 49, train speedup 3.397, test speedup 3.751, val speedup 0.984
execution cost 0:15:12.824224
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.159076, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426361| train set 1.498x speedup, test set 0.847x speedup, val set 0.793x speedup, step: 1, train time 19.47 s
Epoch 1/50 |loss: 0.347774| train set 2.337x speedup, test set 0.894x speedup, val set 0.904x speedup, step: 2, train time 18.42 s
Epoch 2/50 |loss: 0.315562| train set 2.384x speedup, test set 0.856x speedup, val set 1.015x speedup, step: 3, train time 17.11 s
Epoch 3/50 |loss: 0.293334| train set 2.656x speedup, test set 5.035x speedup, val set 1.398x speedup, step: 4, train time 17.28 s
Epoch 4/50 |loss: 0.274804| train set 2.820x speedup, test set 4.221x speedup, val set 1.691x speedup, step: 1, train time 17.01 s
Epoch 5/50 |loss: 0.256775| train set 2.735x speedup, test set 1.415x speedup, val set 0.973x speedup, step: 2, train time 17.18 s
Epoch 6/50 |loss: 0.241358| train set 2.969x speedup, test set 4.622x speedup, val set 1.015x speedup, step: 3, train time 17.00 s
Epoch 7/50 |loss: 0.235896| train set 2.811x speedup, test set 5.035x speedup, val set 1.015x speedup, step: 4, train time 17.11 s
Epoch 8/50 |loss: 0.225377| train set 3.407x speedup, test set 5.060x speedup, val set 0.996x speedup, step: 5, train time 17.17 s
Epoch 9/50 |loss: 0.222202| train set 3.124x speedup, test set 5.065x speedup, val set 0.936x speedup, step: 6, train time 16.98 s
Epoch 10/50 |loss: 0.208848| train set 2.831x speedup, test set 5.035x speedup, val set 0.985x speedup, step: 7, train time 17.00 s
Epoch 11/50 |loss: 0.201163| train set 3.033x speedup, test set 5.065x speedup, val set 1.077x speedup, step: 8, train time 16.99 s
Epoch 12/50 |loss: 0.200727| train set 3.076x speedup, test set 5.213x speedup, val set 0.983x speedup, step: 9, train time 16.98 s
Epoch 13/50 |loss: 0.193366| train set 3.104x speedup, test set 6.735x speedup, val set 0.900x speedup, step: 10, train time 16.71 s
Epoch 14/50 |loss: 0.190515| train set 3.317x speedup, test set 5.213x speedup, val set 0.977x speedup, step: 11, train time 16.57 s
Epoch 15/50 |loss: 0.188881| train set 3.334x speedup, test set 5.213x speedup, val set 0.986x speedup, step: 12, train time 16.42 s
Epoch 16/50 |loss: 0.175063| train set 3.138x speedup, test set 5.213x speedup, val set 0.986x speedup, step: 13, train time 16.59 s
Epoch 17/50 |loss: 0.178428| train set 2.957x speedup, test set 5.182x speedup, val set 0.897x speedup, step: 14, train time 16.60 s
Epoch 18/50 |loss: 0.171451| train set 3.215x speedup, test set 6.234x speedup, val set 0.901x speedup, step: 15, train time 15.89 s
Epoch 19/50 |loss: 0.166600| train set 3.205x speedup, test set 5.213x speedup, val set 0.977x speedup, step: 16, train time 16.51 s
Epoch 20/50 |loss: 0.164491| train set 2.999x speedup, test set 5.213x speedup, val set 0.901x speedup, step: 17, train time 16.61 s
Epoch 21/50 |loss: 0.157677| train set 2.877x speedup, test set 5.213x speedup, val set 1.007x speedup, step: 18, train time 16.43 s
Epoch 22/50 |loss: 0.161763| train set 3.299x speedup, test set 6.234x speedup, val set 1.007x speedup, step: 19, train time 16.62 s
Epoch 23/50 |loss: 0.151285| train set 3.066x speedup, test set 5.213x speedup, val set 0.742x speedup, step: 20, train time 16.62 s
Epoch 24/50 |loss: 0.145851| train set 2.780x speedup, test set 5.213x speedup, val set 0.977x speedup, step: 21, train time 16.51 s
Epoch 25/50 |loss: 0.149005| train set 3.101x speedup, test set 5.186x speedup, val set 0.974x speedup, step: 22, train time 16.71 s
Epoch 26/50 |loss: 0.144902| train set 2.737x speedup, test set 5.213x speedup, val set 0.926x speedup, step: 23, train time 16.52 s
Epoch 27/50 |loss: 0.143508| train set 3.366x speedup, test set 6.234x speedup, val set 1.007x speedup, step: 24, train time 16.70 s
Epoch 28/50 |loss: 0.136765| train set 3.231x speedup, test set 6.234x speedup, val set 1.005x speedup, step: 25, train time 16.60 s
Epoch 29/50 |loss: 0.140699| train set 3.318x speedup, test set 6.234x speedup, val set 1.007x speedup, step: 26, train time 16.77 s
Epoch 30/50 |loss: 0.132810| train set 3.227x speedup, test set 6.234x speedup, val set 1.007x speedup, step: 27, train time 16.63 s
Epoch 31/50 |loss: 0.133909| train set 3.209x speedup, test set 6.234x speedup, val set 1.005x speedup, step: 28, train time 16.60 s
Epoch 32/50 |loss: 0.127279| train set 3.393x speedup, test set 5.186x speedup, val set 1.007x speedup, step: 29, train time 16.50 s
Epoch 33/50 |loss: 0.130341| train set 3.311x speedup, test set 5.186x speedup, val set 0.977x speedup, step: 30, train time 16.60 s
Epoch 34/50 |loss: 0.126612| train set 3.260x speedup, test set 6.234x speedup, val set 1.007x speedup, step: 31, train time 16.63 s
Epoch 35/50 |loss: 0.123585| train set 3.357x speedup, test set 5.186x speedup, val set 1.016x speedup, step: 32, train time 16.50 s
Epoch 36/50 |loss: 0.125555| train set 3.398x speedup, test set 6.234x speedup, val set 0.716x speedup, step: 33, train time 16.59 s
Epoch 37/50 |loss: 0.123843| train set 3.285x speedup, test set 5.186x speedup, val set 1.006x speedup, step: 34, train time 16.60 s
Epoch 38/50 |loss: 0.123722| train set 3.011x speedup, test set 6.234x speedup, val set 0.674x speedup, step: 35, train time 16.53 s
Epoch 39/50 |loss: 0.117122| train set 3.087x speedup, test set 5.186x speedup, val set 1.007x speedup, step: 36, train time 16.60 s
Epoch 40/50 |loss: 0.121888| train set 3.464x speedup, test set 5.186x speedup, val set 1.007x speedup, step: 37, train time 16.80 s
Epoch 41/50 |loss: 0.115879| train set 3.168x speedup, test set 6.234x speedup, val set 0.722x speedup, step: 38, train time 16.60 s
Epoch 42/50 |loss: 0.114006| train set 3.320x speedup, test set 6.234x speedup, val set 0.715x speedup, step: 39, train time 16.69 s
Epoch 43/50 |loss: 0.117495| train set 3.381x speedup, test set 6.234x speedup, val set 1.019x speedup, step: 40, train time 16.71 s
Epoch 44/50 |loss: 0.110975| train set 3.322x speedup, test set 6.234x speedup, val set 1.019x speedup, step: 41, train time 16.60 s
Epoch 45/50 |loss: 0.106639| train set 3.360x speedup, test set 6.234x speedup, val set 1.007x speedup, step: 42, train time 16.61 s
Epoch 46/50 |loss: 0.107275| train set 3.302x speedup, test set 6.234x speedup, val set 1.007x speedup, step: 43, train time 16.61 s
Epoch 47/50 |loss: 0.109638| train set 3.364x speedup, test set 6.234x speedup, val set 0.716x speedup, step: 44, train time 16.50 s
Epoch 48/50 |loss: 0.113515| train set 3.446x speedup, test set 5.186x speedup, val set 0.716x speedup, step: 45, train time 16.53 s
Epoch 49/50 |loss: 0.107196| train set 3.408x speedup, test set 6.234x speedup, val set 0.715x speedup, step: 46, train time 16.51 s
Training per epoch cost 16.780 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 40, train speedup 3.464, test speedup 5.186, val speedup 1.007
best test speedup epoch: 13, train speedup 3.104, test speedup 6.735, val speedup 0.900
best validation speedup epoch: 4, train speedup 2.820, test speedup 4.221, val speedup 1.691
last model at epoch 49, train speedup 3.408, test speedup 6.234, val speedup 0.715
execution cost 0:15:22.234413
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.482951, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.424415| train set 2.288x speedup, test set 0.856x speedup, val set 0.801x speedup, step: 1, train time 19.63 s
Epoch 1/50 |loss: 0.346373| train set 2.397x speedup, test set 4.730x speedup, val set 0.730x speedup, step: 2, train time 18.10 s
Epoch 2/50 |loss: 0.316185| train set 2.455x speedup, test set 5.981x speedup, val set 0.930x speedup, step: 3, train time 17.10 s
Epoch 3/50 |loss: 0.296439| train set 2.571x speedup, test set 6.023x speedup, val set 0.916x speedup, step: 4, train time 17.01 s
Epoch 4/50 |loss: 0.275981| train set 2.655x speedup, test set 5.981x speedup, val set 1.770x speedup, step: 1, train time 17.10 s
Epoch 5/50 |loss: 0.256830| train set 3.166x speedup, test set 5.981x speedup, val set 0.926x speedup, step: 2, train time 17.02 s
Epoch 6/50 |loss: 0.242756| train set 2.740x speedup, test set 6.023x speedup, val set 0.936x speedup, step: 3, train time 17.20 s
Epoch 7/50 |loss: 0.236100| train set 2.905x speedup, test set 6.683x speedup, val set 0.985x speedup, step: 4, train time 17.29 s
Epoch 8/50 |loss: 0.226678| train set 3.169x speedup, test set 5.182x speedup, val set 0.956x speedup, step: 5, train time 17.01 s
Epoch 9/50 |loss: 0.222399| train set 3.086x speedup, test set 5.182x speedup, val set 0.901x speedup, step: 6, train time 17.12 s
Epoch 10/50 |loss: 0.209319| train set 2.663x speedup, test set 5.182x speedup, val set 0.910x speedup, step: 7, train time 17.12 s
Epoch 11/50 |loss: 0.201712| train set 3.005x speedup, test set 5.182x speedup, val set 1.146x speedup, step: 8, train time 17.02 s
Epoch 12/50 |loss: 0.202259| train set 2.598x speedup, test set 5.182x speedup, val set 0.936x speedup, step: 9, train time 17.05 s
Epoch 13/50 |loss: 0.193291| train set 2.770x speedup, test set 5.182x speedup, val set 0.743x speedup, step: 10, train time 17.21 s
Epoch 14/50 |loss: 0.190424| train set 2.862x speedup, test set 5.182x speedup, val set 1.107x speedup, step: 11, train time 17.28 s
Epoch 15/50 |loss: 0.187355| train set 3.357x speedup, test set 5.213x speedup, val set 0.999x speedup, step: 12, train time 17.20 s
Epoch 16/50 |loss: 0.175243| train set 3.172x speedup, test set 5.213x speedup, val set 0.999x speedup, step: 13, train time 17.37 s
Epoch 17/50 |loss: 0.177494| train set 3.003x speedup, test set 5.182x speedup, val set 0.789x speedup, step: 14, train time 17.12 s
Epoch 18/50 |loss: 0.174915| train set 3.191x speedup, test set 5.182x speedup, val set 0.901x speedup, step: 15, train time 17.31 s
Epoch 19/50 |loss: 0.169595| train set 3.232x speedup, test set 5.208x speedup, val set 1.043x speedup, step: 16, train time 17.54 s
Epoch 20/50 |loss: 0.165235| train set 3.228x speedup, test set 5.213x speedup, val set 1.112x speedup, step: 17, train time 17.58 s
Epoch 21/50 |loss: 0.160076| train set 3.046x speedup, test set 5.213x speedup, val set 1.016x speedup, step: 18, train time 17.64 s
Epoch 22/50 |loss: 0.160370| train set 3.196x speedup, test set 5.213x speedup, val set 1.036x speedup, step: 19, train time 17.62 s
Epoch 23/50 |loss: 0.152093| train set 3.296x speedup, test set 5.213x speedup, val set 0.769x speedup, step: 20, train time 17.51 s
Epoch 24/50 |loss: 0.147205| train set 3.131x speedup, test set 5.213x speedup, val set 1.146x speedup, step: 21, train time 17.51 s
Epoch 25/50 |loss: 0.151469| train set 3.228x speedup, test set 5.182x speedup, val set 1.007x speedup, step: 22, train time 17.48 s
Epoch 26/50 |loss: 0.147982| train set 2.871x speedup, test set 5.213x speedup, val set 0.985x speedup, step: 23, train time 17.52 s
Epoch 27/50 |loss: 0.146062| train set 3.214x speedup, test set 5.213x speedup, val set 1.007x speedup, step: 24, train time 17.34 s
Epoch 28/50 |loss: 0.139844| train set 3.398x speedup, test set 5.213x speedup, val set 1.033x speedup, step: 25, train time 17.50 s
Epoch 29/50 |loss: 0.138919| train set 3.124x speedup, test set 5.213x speedup, val set 1.019x speedup, step: 26, train time 17.49 s
Epoch 30/50 |loss: 0.136259| train set 3.269x speedup, test set 5.213x speedup, val set 1.019x speedup, step: 27, train time 17.60 s
Epoch 31/50 |loss: 0.136971| train set 3.210x speedup, test set 5.213x speedup, val set 1.017x speedup, step: 28, train time 17.51 s
Epoch 32/50 |loss: 0.129509| train set 3.396x speedup, test set 5.213x speedup, val set 0.977x speedup, step: 29, train time 17.60 s
Epoch 33/50 |loss: 0.131436| train set 3.295x speedup, test set 5.213x speedup, val set 0.901x speedup, step: 30, train time 17.73 s
Epoch 34/50 |loss: 0.131713| train set 3.295x speedup, test set 5.213x speedup, val set 1.031x speedup, step: 31, train time 17.59 s
Epoch 35/50 |loss: 0.128085| train set 3.366x speedup, test set 5.213x speedup, val set 1.114x speedup, step: 32, train time 17.53 s
Epoch 36/50 |loss: 0.129474| train set 3.321x speedup, test set 5.213x speedup, val set 0.977x speedup, step: 33, train time 17.60 s
Epoch 37/50 |loss: 0.124682| train set 3.349x speedup, test set 5.213x speedup, val set 1.006x speedup, step: 34, train time 17.69 s
Epoch 38/50 |loss: 0.123199| train set 3.176x speedup, test set 5.213x speedup, val set 1.007x speedup, step: 35, train time 17.59 s
Epoch 39/50 |loss: 0.120126| train set 3.340x speedup, test set 5.213x speedup, val set 1.017x speedup, step: 36, train time 17.70 s
Epoch 40/50 |loss: 0.126172| train set 3.473x speedup, test set 5.213x speedup, val set 0.975x speedup, step: 37, train time 17.52 s
Epoch 41/50 |loss: 0.115099| train set 3.320x speedup, test set 5.213x speedup, val set 1.007x speedup, step: 38, train time 17.52 s
Epoch 42/50 |loss: 0.115913| train set 3.468x speedup, test set 5.213x speedup, val set 0.986x speedup, step: 39, train time 17.70 s
Epoch 43/50 |loss: 0.116821| train set 3.358x speedup, test set 5.213x speedup, val set 1.007x speedup, step: 40, train time 17.68 s
Epoch 44/50 |loss: 0.116330| train set 3.235x speedup, test set 5.213x speedup, val set 1.007x speedup, step: 41, train time 17.52 s
Epoch 45/50 |loss: 0.111060| train set 3.213x speedup, test set 5.213x speedup, val set 1.007x speedup, step: 42, train time 17.63 s
Epoch 46/50 |loss: 0.110507| train set 3.402x speedup, test set 5.213x speedup, val set 0.977x speedup, step: 43, train time 17.60 s
Epoch 47/50 |loss: 0.111186| train set 3.443x speedup, test set 5.213x speedup, val set 1.007x speedup, step: 44, train time 17.59 s
Epoch 48/50 |loss: 0.110781| train set 3.457x speedup, test set 5.213x speedup, val set 1.031x speedup, step: 45, train time 17.62 s
Epoch 49/50 |loss: 0.109447| train set 3.496x speedup, test set 5.213x speedup, val set 1.004x speedup, step: 46, train time 17.61 s
Training per epoch cost 17.483 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 49, train speedup 3.496, test speedup 5.213, val speedup 1.004
best test speedup epoch: 7, train speedup 2.905, test speedup 6.683, val speedup 0.985
best validation speedup epoch: 4, train speedup 2.655, test speedup 5.981, val speedup 1.770
last model at epoch 49, train speedup 3.496, test speedup 5.213, val speedup 1.004
execution cost 0:16:06.552527
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.160278, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.424303| train set 2.286x speedup, test set 4.730x speedup, val set 0.801x speedup, step: 1, train time 18.60 s
Epoch 1/50 |loss: 0.345417| train set 1.585x speedup, test set 0.847x speedup, val set 0.801x speedup, step: 2, train time 17.52 s
Epoch 2/50 |loss: 0.318076| train set 2.365x speedup, test set 5.035x speedup, val set 0.936x speedup, step: 3, train time 16.81 s
Epoch 3/50 |loss: 0.296943| train set 2.631x speedup, test set 5.035x speedup, val set 0.926x speedup, step: 4, train time 16.71 s
Epoch 4/50 |loss: 0.274928| train set 2.755x speedup, test set 5.065x speedup, val set 0.856x speedup, step: 1, train time 16.82 s
Epoch 5/50 |loss: 0.254609| train set 2.724x speedup, test set 5.035x speedup, val set 0.985x speedup, step: 2, train time 16.68 s
Epoch 6/50 |loss: 0.238656| train set 2.691x speedup, test set 5.182x speedup, val set 1.015x speedup, step: 3, train time 16.43 s
Epoch 7/50 |loss: 0.236872| train set 2.832x speedup, test set 1.317x speedup, val set 0.866x speedup, step: 4, train time 16.42 s
Epoch 8/50 |loss: 0.225942| train set 3.265x speedup, test set 5.035x speedup, val set 0.996x speedup, step: 5, train time 16.60 s
Epoch 9/50 |loss: 0.222681| train set 2.921x speedup, test set 5.182x speedup, val set 1.015x speedup, step: 1, train time 16.61 s
Epoch 10/50 |loss: 0.210973| train set 2.713x speedup, test set 5.182x speedup, val set 0.985x speedup, step: 2, train time 16.57 s
Epoch 11/50 |loss: 0.205781| train set 3.259x speedup, test set 5.182x speedup, val set 1.076x speedup, step: 3, train time 16.70 s
Epoch 12/50 |loss: 0.200586| train set 2.594x speedup, test set 5.213x speedup, val set 0.985x speedup, step: 4, train time 16.59 s
Epoch 13/50 |loss: 0.197479| train set 2.862x speedup, test set 5.182x speedup, val set 0.901x speedup, step: 5, train time 16.80 s
Epoch 14/50 |loss: 0.195015| train set 3.373x speedup, test set 5.182x speedup, val set 0.975x speedup, step: 6, train time 16.51 s
Epoch 15/50 |loss: 0.186203| train set 3.065x speedup, test set 5.065x speedup, val set 1.107x speedup, step: 7, train time 16.60 s
Epoch 16/50 |loss: 0.177335| train set 3.244x speedup, test set 5.213x speedup, val set 1.074x speedup, step: 8, train time 16.50 s
Epoch 17/50 |loss: 0.178644| train set 3.003x speedup, test set 5.182x speedup, val set 0.977x speedup, step: 9, train time 16.54 s
Epoch 18/50 |loss: 0.175611| train set 3.139x speedup, test set 5.182x speedup, val set 0.947x speedup, step: 10, train time 16.59 s
Epoch 19/50 |loss: 0.172929| train set 3.207x speedup, test set 5.182x speedup, val set 0.647x speedup, step: 11, train time 16.52 s
Epoch 20/50 |loss: 0.166892| train set 3.212x speedup, test set 5.182x speedup, val set 0.977x speedup, step: 12, train time 16.51 s
Epoch 21/50 |loss: 0.161373| train set 2.901x speedup, test set 5.213x speedup, val set 0.976x speedup, step: 13, train time 16.70 s
Epoch 22/50 |loss: 0.163168| train set 3.182x speedup, test set 5.213x speedup, val set 0.900x speedup, step: 14, train time 16.61 s
Epoch 23/50 |loss: 0.155220| train set 3.398x speedup, test set 5.182x speedup, val set 0.686x speedup, step: 15, train time 16.70 s
Epoch 24/50 |loss: 0.149592| train set 3.167x speedup, test set 5.182x speedup, val set 0.686x speedup, step: 16, train time 16.59 s
Epoch 25/50 |loss: 0.152231| train set 3.173x speedup, test set 5.213x speedup, val set 0.946x speedup, step: 17, train time 16.58 s
Epoch 26/50 |loss: 0.151410| train set 2.840x speedup, test set 5.213x speedup, val set 0.901x speedup, step: 18, train time 16.63 s
Epoch 27/50 |loss: 0.148072| train set 3.208x speedup, test set 5.182x speedup, val set 0.977x speedup, step: 19, train time 16.51 s
Epoch 28/50 |loss: 0.139541| train set 3.383x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 20, train time 16.69 s
Epoch 29/50 |loss: 0.147592| train set 3.122x speedup, test set 5.213x speedup, val set 0.751x speedup, step: 21, train time 16.58 s
Epoch 30/50 |loss: 0.138995| train set 3.231x speedup, test set 5.213x speedup, val set 0.959x speedup, step: 22, train time 16.71 s
Epoch 31/50 |loss: 0.140930| train set 3.330x speedup, test set 5.213x speedup, val set 0.977x speedup, step: 23, train time 16.43 s
Epoch 32/50 |loss: 0.134273| train set 3.387x speedup, test set 5.182x speedup, val set 0.949x speedup, step: 24, train time 16.42 s
Epoch 33/50 |loss: 0.134925| train set 3.342x speedup, test set 5.155x speedup, val set 0.899x speedup, step: 25, train time 16.60 s
Epoch 34/50 |loss: 0.134135| train set 3.382x speedup, test set 5.182x speedup, val set 0.977x speedup, step: 26, train time 16.49 s
Epoch 35/50 |loss: 0.130647| train set 3.218x speedup, test set 5.213x speedup, val set 0.837x speedup, step: 27, train time 16.60 s
Epoch 36/50 |loss: 0.134384| train set 3.344x speedup, test set 5.182x speedup, val set 0.749x speedup, step: 28, train time 16.68 s
Epoch 37/50 |loss: 0.129925| train set 3.062x speedup, test set 5.186x speedup, val set 1.077x speedup, step: 29, train time 16.49 s
Epoch 38/50 |loss: 0.125650| train set 3.147x speedup, test set 5.213x speedup, val set 0.901x speedup, step: 30, train time 16.58 s
Epoch 39/50 |loss: 0.125044| train set 3.336x speedup, test set 5.186x speedup, val set 0.988x speedup, step: 31, train time 16.59 s
Epoch 40/50 |loss: 0.128834| train set 3.464x speedup, test set 5.213x speedup, val set 1.267x speedup, step: 32, train time 16.59 s
Epoch 41/50 |loss: 0.125159| train set 3.340x speedup, test set 5.213x speedup, val set 0.775x speedup, step: 33, train time 16.41 s
Epoch 42/50 |loss: 0.121505| train set 3.467x speedup, test set 5.213x speedup, val set 0.750x speedup, step: 34, train time 16.40 s
Epoch 43/50 |loss: 0.123100| train set 3.355x speedup, test set 5.213x speedup, val set 1.805x speedup, step: 35, train time 16.52 s
Epoch 44/50 |loss: 0.120170| train set 3.295x speedup, test set 5.155x speedup, val set 1.042x speedup, step: 1, train time 16.61 s
Epoch 45/50 |loss: 0.117254| train set 3.236x speedup, test set 5.182x speedup, val set 0.977x speedup, step: 2, train time 16.49 s
Epoch 46/50 |loss: 0.113493| train set 3.487x speedup, test set 5.213x speedup, val set 1.910x speedup, step: 3, train time 16.67 s
Epoch 47/50 |loss: 0.113769| train set 3.220x speedup, test set 5.186x speedup, val set 0.959x speedup, step: 4, train time 16.49 s
Epoch 48/50 |loss: 0.114462| train set 3.463x speedup, test set 5.213x speedup, val set 1.267x speedup, step: 5, train time 16.69 s
Epoch 49/50 |loss: 0.111720| train set 3.332x speedup, test set 5.213x speedup, val set 2.023x speedup, step: 1, train time 16.42 s
Training per epoch cost 16.642 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 36.429s, pg runtime 17.708s, speedup 0.486x
12, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
13, opt runtime 7.851s, model runtime 30.956s, pg runtime 13.622s, speedup 0.440x
14, opt runtime 7.442s, model runtime 32.816s, pg runtime 14.838s, speedup 0.452x
15, opt runtime 7.110s, model runtime 38.849s, pg runtime 14.286s, speedup 0.368x
16, opt runtime 6.810s, model runtime 39.840s, pg runtime 13.796s, speedup 0.346x
17, opt runtime 6.460s, model runtime 33.445s, pg runtime 16.134s, speedup 0.482x
18, opt runtime 6.656s, model runtime 39.236s, pg runtime 15.260s, speedup 0.389x
19, opt runtime 7.913s, model runtime 32.779s, pg runtime 15.548s, speedup 0.474x
20, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 46, train speedup 3.487, test speedup 5.213, val speedup 1.910
best test speedup epoch: 12, train speedup 2.594, test speedup 5.213, val speedup 0.985
best validation speedup epoch: 49, train speedup 3.332, test speedup 5.213, val speedup 2.023
last model at epoch 49, train speedup 3.332, test speedup 5.213, val speedup 2.023
execution cost 0:15:10.562875
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.530317, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427291| train set 2.259x speedup, test set 6.690x speedup, val set 0.793x speedup, step: 1, train time 19.69 s
Epoch 1/50 |loss: 0.346771| train set 2.467x speedup, test set 4.730x speedup, val set 0.801x speedup, step: 2, train time 18.22 s
Epoch 2/50 |loss: 0.315488| train set 2.408x speedup, test set 5.981x speedup, val set 1.015x speedup, step: 3, train time 16.79 s
Epoch 3/50 |loss: 0.295910| train set 2.591x speedup, test set 5.981x speedup, val set 0.926x speedup, step: 4, train time 16.69 s
Epoch 4/50 |loss: 0.277024| train set 2.636x speedup, test set 5.981x speedup, val set 1.022x speedup, step: 1, train time 16.60 s
Epoch 5/50 |loss: 0.258347| train set 2.751x speedup, test set 5.981x speedup, val set 0.926x speedup, step: 2, train time 16.50 s
Epoch 6/50 |loss: 0.241116| train set 3.071x speedup, test set 5.080x speedup, val set 1.003x speedup, step: 3, train time 16.50 s
Epoch 7/50 |loss: 0.237499| train set 3.033x speedup, test set 4.940x speedup, val set 1.003x speedup, step: 4, train time 16.60 s
Epoch 8/50 |loss: 0.224664| train set 3.054x speedup, test set 6.189x speedup, val set 0.998x speedup, step: 5, train time 16.48 s
Epoch 9/50 |loss: 0.222094| train set 2.933x speedup, test set 4.881x speedup, val set 0.926x speedup, step: 6, train time 16.40 s
Epoch 10/50 |loss: 0.206112| train set 2.831x speedup, test set 5.080x speedup, val set 0.910x speedup, step: 7, train time 16.49 s
Epoch 11/50 |loss: 0.199171| train set 3.134x speedup, test set 6.950x speedup, val set 0.977x speedup, step: 8, train time 16.42 s
Epoch 12/50 |loss: 0.201132| train set 2.735x speedup, test set 5.080x speedup, val set 0.781x speedup, step: 9, train time 16.61 s
Epoch 13/50 |loss: 0.195850| train set 3.090x speedup, test set 4.881x speedup, val set 0.886x speedup, step: 10, train time 16.61 s
Epoch 14/50 |loss: 0.188601| train set 3.182x speedup, test set 6.950x speedup, val set 0.959x speedup, step: 11, train time 16.51 s
Epoch 15/50 |loss: 0.184863| train set 3.233x speedup, test set 6.990x speedup, val set 1.013x speedup, step: 12, train time 16.69 s
Epoch 16/50 |loss: 0.176072| train set 3.181x speedup, test set 6.943x speedup, val set 0.959x speedup, step: 13, train time 16.68 s
Epoch 17/50 |loss: 0.175784| train set 3.177x speedup, test set 4.678x speedup, val set 0.988x speedup, step: 14, train time 16.62 s
Epoch 18/50 |loss: 0.172654| train set 3.131x speedup, test set 6.943x speedup, val set 0.886x speedup, step: 15, train time 16.60 s
Epoch 19/50 |loss: 0.167141| train set 3.155x speedup, test set 4.881x speedup, val set 0.705x speedup, step: 16, train time 16.62 s
Epoch 20/50 |loss: 0.163756| train set 3.269x speedup, test set 4.881x speedup, val set 0.886x speedup, step: 17, train time 16.60 s
Epoch 21/50 |loss: 0.156917| train set 3.251x speedup, test set 6.943x speedup, val set 0.910x speedup, step: 18, train time 16.62 s
Epoch 22/50 |loss: 0.159802| train set 3.313x speedup, test set 4.558x speedup, val set 0.910x speedup, step: 19, train time 16.48 s
Epoch 23/50 |loss: 0.152334| train set 3.017x speedup, test set 3.641x speedup, val set 0.733x speedup, step: 20, train time 16.69 s
Epoch 24/50 |loss: 0.145583| train set 3.262x speedup, test set 3.641x speedup, val set 0.707x speedup, step: 21, train time 16.60 s
Epoch 25/50 |loss: 0.148917| train set 3.235x speedup, test set 3.641x speedup, val set 0.781x speedup, step: 22, train time 16.61 s
Epoch 26/50 |loss: 0.148684| train set 2.859x speedup, test set 3.641x speedup, val set 0.733x speedup, step: 23, train time 16.68 s
Epoch 27/50 |loss: 0.143960| train set 3.255x speedup, test set 4.323x speedup, val set 0.910x speedup, step: 24, train time 16.62 s
Epoch 28/50 |loss: 0.139364| train set 3.256x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 25, train time 16.61 s
Epoch 29/50 |loss: 0.141597| train set 3.105x speedup, test set 3.641x speedup, val set 0.733x speedup, step: 26, train time 16.61 s
Epoch 30/50 |loss: 0.137306| train set 3.329x speedup, test set 3.641x speedup, val set 0.886x speedup, step: 27, train time 16.79 s
Epoch 31/50 |loss: 0.136980| train set 3.247x speedup, test set 3.641x speedup, val set 0.986x speedup, step: 28, train time 16.69 s
Epoch 32/50 |loss: 0.130016| train set 3.359x speedup, test set 3.641x speedup, val set 0.885x speedup, step: 29, train time 16.71 s
Epoch 33/50 |loss: 0.130789| train set 3.326x speedup, test set 4.881x speedup, val set 0.910x speedup, step: 30, train time 16.70 s
Epoch 34/50 |loss: 0.131296| train set 3.328x speedup, test set 4.881x speedup, val set 0.782x speedup, step: 31, train time 16.58 s
Epoch 35/50 |loss: 0.128137| train set 3.300x speedup, test set 4.881x speedup, val set 0.781x speedup, step: 32, train time 16.69 s
Epoch 36/50 |loss: 0.128719| train set 3.334x speedup, test set 3.641x speedup, val set 0.731x speedup, step: 33, train time 16.59 s
Epoch 37/50 |loss: 0.128480| train set 3.205x speedup, test set 3.641x speedup, val set 0.782x speedup, step: 34, train time 16.79 s
Epoch 38/50 |loss: 0.125247| train set 3.217x speedup, test set 3.641x speedup, val set 0.783x speedup, step: 35, train time 16.51 s
Epoch 39/50 |loss: 0.121004| train set 3.376x speedup, test set 4.881x speedup, val set 0.782x speedup, step: 36, train time 16.60 s
Epoch 40/50 |loss: 0.123825| train set 3.466x speedup, test set 3.641x speedup, val set 0.959x speedup, step: 37, train time 16.62 s
Epoch 41/50 |loss: 0.122178| train set 3.164x speedup, test set 3.641x speedup, val set 0.733x speedup, step: 38, train time 16.70 s
Epoch 42/50 |loss: 0.121497| train set 3.465x speedup, test set 3.641x speedup, val set 0.836x speedup, step: 39, train time 16.51 s
Epoch 43/50 |loss: 0.116966| train set 3.384x speedup, test set 4.881x speedup, val set 0.783x speedup, step: 40, train time 16.73 s
Epoch 44/50 |loss: 0.117670| train set 3.203x speedup, test set 3.641x speedup, val set 0.929x speedup, step: 41, train time 16.62 s
Epoch 45/50 |loss: 0.110331| train set 3.263x speedup, test set 3.641x speedup, val set 0.783x speedup, step: 42, train time 16.60 s
Epoch 46/50 |loss: 0.112983| train set 3.282x speedup, test set 3.641x speedup, val set 1.010x speedup, step: 43, train time 16.49 s
Epoch 47/50 |loss: 0.113037| train set 3.289x speedup, test set 3.641x speedup, val set 0.783x speedup, step: 44, train time 16.50 s
Epoch 48/50 |loss: 0.115990| train set 3.289x speedup, test set 3.641x speedup, val set 0.781x speedup, step: 45, train time 16.61 s
Epoch 49/50 |loss: 0.106518| train set 3.390x speedup, test set 3.641x speedup, val set 0.988x speedup, step: 46, train time 16.60 s
Training per epoch cost 16.701 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 40, train speedup 3.466, test speedup 3.641, val speedup 0.959
best test speedup epoch: 15, train speedup 3.233, test speedup 6.990, val speedup 1.013
best validation speedup epoch: 4, train speedup 2.636, test speedup 5.981, val speedup 1.022
last model at epoch 49, train speedup 3.390, test speedup 3.641, val speedup 0.988
execution cost 0:15:17.540496
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.927212, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425499| train set 2.294x speedup, test set 4.730x speedup, val set 0.793x speedup, step: 1, train time 13.34 s
Epoch 1/50 |loss: 0.346732| train set 2.432x speedup, test set 4.756x speedup, val set 0.730x speedup, step: 2, train time 12.70 s
Epoch 2/50 |loss: 0.317031| train set 2.360x speedup, test set 5.035x speedup, val set 1.003x speedup, step: 3, train time 12.19 s
Epoch 3/50 |loss: 0.295141| train set 2.637x speedup, test set 5.035x speedup, val set 1.003x speedup, step: 4, train time 12.00 s
Epoch 4/50 |loss: 0.277512| train set 2.660x speedup, test set 5.981x speedup, val set 1.030x speedup, step: 1, train time 12.11 s
Epoch 5/50 |loss: 0.255367| train set 2.588x speedup, test set 5.035x speedup, val set 1.015x speedup, step: 2, train time 11.89 s
Epoch 6/50 |loss: 0.239182| train set 2.830x speedup, test set 5.035x speedup, val set 1.015x speedup, step: 3, train time 11.99 s
Epoch 7/50 |loss: 0.236224| train set 2.988x speedup, test set 5.981x speedup, val set 0.985x speedup, step: 4, train time 12.20 s
Epoch 8/50 |loss: 0.222409| train set 3.390x speedup, test set 5.182x speedup, val set 0.996x speedup, step: 5, train time 11.90 s
Epoch 9/50 |loss: 0.225035| train set 3.082x speedup, test set 5.035x speedup, val set 0.984x speedup, step: 6, train time 11.60 s
Epoch 10/50 |loss: 0.204355| train set 2.765x speedup, test set 5.182x speedup, val set 1.008x speedup, step: 7, train time 12.20 s
Epoch 11/50 |loss: 0.201901| train set 3.078x speedup, test set 5.182x speedup, val set 1.104x speedup, step: 8, train time 12.20 s
Epoch 12/50 |loss: 0.198586| train set 2.901x speedup, test set 5.035x speedup, val set 0.983x speedup, step: 9, train time 11.79 s
Epoch 13/50 |loss: 0.194797| train set 3.051x speedup, test set 5.080x speedup, val set 0.780x speedup, step: 10, train time 11.91 s
Epoch 14/50 |loss: 0.188860| train set 3.117x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 11, train time 12.49 s
Epoch 15/50 |loss: 0.182096| train set 3.013x speedup, test set 5.182x speedup, val set 0.807x speedup, step: 12, train time 12.10 s
Epoch 16/50 |loss: 0.173749| train set 3.140x speedup, test set 5.035x speedup, val set 0.837x speedup, step: 13, train time 12.00 s
Epoch 17/50 |loss: 0.174875| train set 3.219x speedup, test set 5.182x speedup, val set 0.836x speedup, step: 14, train time 12.32 s
Epoch 18/50 |loss: 0.169869| train set 3.153x speedup, test set 5.182x speedup, val set 1.042x speedup, step: 15, train time 12.09 s
Epoch 19/50 |loss: 0.166287| train set 3.269x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 16, train time 12.30 s
Epoch 20/50 |loss: 0.163261| train set 3.248x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 17, train time 11.91 s
Epoch 21/50 |loss: 0.158294| train set 3.078x speedup, test set 5.035x speedup, val set 0.781x speedup, step: 18, train time 11.90 s
Epoch 22/50 |loss: 0.157708| train set 3.308x speedup, test set 5.182x speedup, val set 0.710x speedup, step: 19, train time 11.71 s
Epoch 23/50 |loss: 0.152854| train set 3.155x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 20, train time 11.70 s
Epoch 24/50 |loss: 0.144075| train set 3.096x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 21, train time 12.00 s
Epoch 25/50 |loss: 0.148127| train set 3.186x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 22, train time 12.30 s
Epoch 26/50 |loss: 0.147248| train set 2.877x speedup, test set 5.182x speedup, val set 0.647x speedup, step: 23, train time 12.10 s
Epoch 27/50 |loss: 0.144190| train set 3.415x speedup, test set 5.182x speedup, val set 0.775x speedup, step: 24, train time 11.90 s
Epoch 28/50 |loss: 0.137645| train set 3.171x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 25, train time 11.91 s
Epoch 29/50 |loss: 0.142028| train set 3.134x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 26, train time 11.61 s
Epoch 30/50 |loss: 0.135000| train set 3.219x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 27, train time 11.71 s
Epoch 31/50 |loss: 0.139351| train set 3.438x speedup, test set 5.182x speedup, val set 0.977x speedup, step: 28, train time 12.40 s
Epoch 32/50 |loss: 0.129531| train set 3.286x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 29, train time 11.91 s
Epoch 33/50 |loss: 0.128918| train set 3.307x speedup, test set 5.182x speedup, val set 0.761x speedup, step: 30, train time 12.25 s
Epoch 34/50 |loss: 0.129503| train set 3.443x speedup, test set 5.182x speedup, val set 0.686x speedup, step: 31, train time 12.00 s
Epoch 35/50 |loss: 0.127246| train set 3.328x speedup, test set 5.182x speedup, val set 0.749x speedup, step: 32, train time 12.21 s
Epoch 36/50 |loss: 0.126933| train set 3.348x speedup, test set 5.182x speedup, val set 0.759x speedup, step: 33, train time 12.00 s
Epoch 37/50 |loss: 0.127156| train set 3.122x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 34, train time 11.88 s
Epoch 38/50 |loss: 0.125699| train set 3.204x speedup, test set 5.182x speedup, val set 0.751x speedup, step: 35, train time 11.78 s
Epoch 39/50 |loss: 0.117187| train set 3.198x speedup, test set 5.155x speedup, val set 0.760x speedup, step: 36, train time 12.09 s
Epoch 40/50 |loss: 0.124035| train set 3.415x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 37, train time 12.08 s
Epoch 41/50 |loss: 0.119714| train set 3.212x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 38, train time 11.99 s
Epoch 42/50 |loss: 0.116072| train set 3.468x speedup, test set 5.182x speedup, val set 0.836x speedup, step: 39, train time 11.89 s
Epoch 43/50 |loss: 0.119676| train set 3.300x speedup, test set 5.182x speedup, val set 0.850x speedup, step: 40, train time 11.80 s
Epoch 44/50 |loss: 0.117294| train set 3.190x speedup, test set 5.182x speedup, val set 0.873x speedup, step: 41, train time 12.19 s
Epoch 45/50 |loss: 0.109904| train set 3.380x speedup, test set 5.182x speedup, val set 0.775x speedup, step: 42, train time 12.31 s
Epoch 46/50 |loss: 0.107479| train set 3.520x speedup, test set 5.182x speedup, val set 0.698x speedup, step: 43, train time 12.10 s
Epoch 47/50 |loss: 0.109583| train set 3.158x speedup, test set 5.182x speedup, val set 0.775x speedup, step: 44, train time 12.10 s
Epoch 48/50 |loss: 0.115466| train set 3.422x speedup, test set 5.182x speedup, val set 0.850x speedup, step: 45, train time 12.29 s
Epoch 49/50 |loss: 0.107172| train set 3.391x speedup, test set 5.182x speedup, val set 0.772x speedup, step: 46, train time 12.03 s
Training per epoch cost 12.067 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 46, train speedup 3.520, test speedup 5.182, val speedup 0.698
best test speedup epoch: 4, train speedup 2.660, test speedup 5.981, val speedup 1.030
best validation speedup epoch: 4, train speedup 2.660, test speedup 5.981, val speedup 1.030
last model at epoch 49, train speedup 3.391, test speedup 5.182, val speedup 0.772
execution cost 0:10:47.665587
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.881544, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425048| train set 2.294x speedup, test set 4.730x speedup, val set 0.801x speedup, step: 1, train time 13.35 s
Epoch 1/50 |loss: 0.348021| train set 2.383x speedup, test set 0.847x speedup, val set 0.730x speedup, step: 2, train time 12.50 s
Epoch 2/50 |loss: 0.317432| train set 2.202x speedup, test set 6.690x speedup, val set 1.724x speedup, step: 3, train time 11.90 s
Epoch 3/50 |loss: 0.299395| train set 2.710x speedup, test set 6.690x speedup, val set 1.691x speedup, step: 4, train time 11.11 s
Epoch 4/50 |loss: 0.277462| train set 2.930x speedup, test set 6.690x speedup, val set 1.767x speedup, step: 1, train time 11.58 s
Epoch 5/50 |loss: 0.257776| train set 2.837x speedup, test set 6.690x speedup, val set 0.973x speedup, step: 2, train time 11.49 s
Epoch 6/50 |loss: 0.239922| train set 2.611x speedup, test set 6.742x speedup, val set 1.015x speedup, step: 3, train time 11.89 s
Epoch 7/50 |loss: 0.236304| train set 3.193x speedup, test set 6.950x speedup, val set 1.003x speedup, step: 4, train time 11.81 s
Epoch 8/50 |loss: 0.224102| train set 3.238x speedup, test set 6.950x speedup, val set 0.699x speedup, step: 5, train time 12.00 s
Epoch 9/50 |loss: 0.221440| train set 3.101x speedup, test set 6.690x speedup, val set 0.956x speedup, step: 6, train time 11.49 s
Epoch 10/50 |loss: 0.205019| train set 2.701x speedup, test set 5.080x speedup, val set 1.008x speedup, step: 7, train time 11.68 s
Epoch 11/50 |loss: 0.199859| train set 3.240x speedup, test set 6.950x speedup, val set 0.926x speedup, step: 8, train time 12.11 s
Epoch 12/50 |loss: 0.199136| train set 2.799x speedup, test set 5.080x speedup, val set 0.886x speedup, step: 9, train time 11.80 s
Epoch 13/50 |loss: 0.193110| train set 3.126x speedup, test set 5.080x speedup, val set 0.666x speedup, step: 10, train time 11.70 s
Epoch 14/50 |loss: 0.190108| train set 3.185x speedup, test set 5.080x speedup, val set 0.985x speedup, step: 11, train time 11.62 s
Epoch 15/50 |loss: 0.181659| train set 3.162x speedup, test set 5.110x speedup, val set 0.836x speedup, step: 12, train time 12.01 s
Epoch 16/50 |loss: 0.176445| train set 3.104x speedup, test set 5.080x speedup, val set 1.105x speedup, step: 13, train time 12.10 s
Epoch 17/50 |loss: 0.174278| train set 3.151x speedup, test set 5.080x speedup, val set 0.800x speedup, step: 14, train time 11.90 s
Epoch 18/50 |loss: 0.168071| train set 3.202x speedup, test set 5.080x speedup, val set 0.901x speedup, step: 15, train time 11.51 s
Epoch 19/50 |loss: 0.171637| train set 3.183x speedup, test set 5.080x speedup, val set 0.781x speedup, step: 16, train time 11.79 s
Epoch 20/50 |loss: 0.159036| train set 3.206x speedup, test set 5.080x speedup, val set 0.783x speedup, step: 17, train time 11.79 s
Epoch 21/50 |loss: 0.155178| train set 3.227x speedup, test set 6.189x speedup, val set 0.910x speedup, step: 18, train time 12.09 s
Epoch 22/50 |loss: 0.158405| train set 3.276x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 19, train time 11.99 s
Epoch 23/50 |loss: 0.148097| train set 3.375x speedup, test set 5.080x speedup, val set 0.750x speedup, step: 20, train time 11.80 s
Epoch 24/50 |loss: 0.141276| train set 3.029x speedup, test set 5.080x speedup, val set 0.783x speedup, step: 21, train time 11.68 s
Epoch 25/50 |loss: 0.148724| train set 3.286x speedup, test set 5.080x speedup, val set 0.781x speedup, step: 22, train time 11.60 s
Epoch 26/50 |loss: 0.145256| train set 2.990x speedup, test set 7.007x speedup, val set 0.750x speedup, step: 23, train time 12.08 s
Epoch 27/50 |loss: 0.140185| train set 3.359x speedup, test set 5.105x speedup, val set 1.007x speedup, step: 24, train time 11.70 s
Epoch 28/50 |loss: 0.137390| train set 3.371x speedup, test set 5.080x speedup, val set 0.837x speedup, step: 25, train time 11.87 s
Epoch 29/50 |loss: 0.135784| train set 3.277x speedup, test set 5.080x speedup, val set 0.800x speedup, step: 26, train time 11.98 s
Epoch 30/50 |loss: 0.134176| train set 3.356x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 27, train time 11.50 s
Epoch 31/50 |loss: 0.134954| train set 3.394x speedup, test set 5.080x speedup, val set 0.778x speedup, step: 28, train time 11.51 s
Epoch 32/50 |loss: 0.126585| train set 3.379x speedup, test set 5.080x speedup, val set 0.783x speedup, step: 29, train time 11.80 s
Epoch 33/50 |loss: 0.125089| train set 3.349x speedup, test set 5.080x speedup, val set 0.783x speedup, step: 30, train time 11.70 s
Epoch 34/50 |loss: 0.126184| train set 3.410x speedup, test set 5.080x speedup, val set 0.783x speedup, step: 31, train time 11.81 s
Epoch 35/50 |loss: 0.123801| train set 3.344x speedup, test set 5.080x speedup, val set 0.857x speedup, step: 32, train time 11.99 s
Epoch 36/50 |loss: 0.125684| train set 3.396x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 33, train time 11.58 s
Epoch 37/50 |loss: 0.121222| train set 3.179x speedup, test set 5.080x speedup, val set 0.802x speedup, step: 34, train time 11.70 s
Epoch 38/50 |loss: 0.121960| train set 3.146x speedup, test set 5.080x speedup, val set 0.750x speedup, step: 35, train time 12.07 s
Epoch 39/50 |loss: 0.114916| train set 3.375x speedup, test set 4.881x speedup, val set 0.780x speedup, step: 36, train time 11.80 s
Epoch 40/50 |loss: 0.118999| train set 3.413x speedup, test set 5.110x speedup, val set 0.801x speedup, step: 37, train time 11.51 s
Epoch 41/50 |loss: 0.114105| train set 3.354x speedup, test set 5.110x speedup, val set 0.783x speedup, step: 38, train time 11.78 s
Epoch 42/50 |loss: 0.112004| train set 3.454x speedup, test set 5.110x speedup, val set 0.781x speedup, step: 39, train time 11.90 s
Epoch 43/50 |loss: 0.115587| train set 3.392x speedup, test set 5.110x speedup, val set 0.799x speedup, step: 40, train time 11.59 s
Epoch 44/50 |loss: 0.112730| train set 3.288x speedup, test set 4.904x speedup, val set 0.750x speedup, step: 41, train time 11.91 s
Epoch 45/50 |loss: 0.107534| train set 3.261x speedup, test set 5.080x speedup, val set 0.750x speedup, step: 42, train time 11.37 s
Epoch 46/50 |loss: 0.107289| train set 3.394x speedup, test set 5.110x speedup, val set 0.780x speedup, step: 43, train time 12.41 s
Epoch 47/50 |loss: 0.108185| train set 3.252x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 44, train time 11.41 s
Epoch 48/50 |loss: 0.108321| train set 3.425x speedup, test set 4.908x speedup, val set 0.783x speedup, step: 45, train time 11.50 s
Epoch 49/50 |loss: 0.104608| train set 3.374x speedup, test set 6.189x speedup, val set 0.730x speedup, step: 46, train time 11.50 s
Training per epoch cost 11.806 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
12, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
13, opt runtime 7.851s, model runtime 10.810s, pg runtime 13.622s, speedup 1.260x
14, opt runtime 7.442s, model runtime 7.442s, pg runtime 14.838s, speedup 1.994x
15, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
16, opt runtime 6.810s, model runtime 6.810s, pg runtime 13.796s, speedup 2.026x
17, opt runtime 6.460s, model runtime 6.460s, pg runtime 16.134s, speedup 2.498x
18, opt runtime 6.656s, model runtime 6.656s, pg runtime 15.260s, speedup 2.293x
19, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
20, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 42, train speedup 3.454, test speedup 5.110, val speedup 0.781
best test speedup epoch: 26, train speedup 2.990, test speedup 7.007, val speedup 0.750
best validation speedup epoch: 4, train speedup 2.930, test speedup 6.690, val speedup 1.767
last model at epoch 49, train speedup 3.374, test speedup 6.189, val speedup 0.730
execution cost 0:10:32.537951
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.843291, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425563| train set 1.422x speedup, test set 4.730x speedup, val set 0.801x speedup, step: 1, train time 13.52 s
Epoch 1/50 |loss: 0.348508| train set 2.283x speedup, test set 4.730x speedup, val set 0.727x speedup, step: 2, train time 12.90 s
Epoch 2/50 |loss: 0.318810| train set 2.360x speedup, test set 6.690x speedup, val set 1.022x speedup, step: 3, train time 12.28 s
Epoch 3/50 |loss: 0.296747| train set 2.599x speedup, test set 5.981x speedup, val set 0.926x speedup, step: 4, train time 12.09 s
Epoch 4/50 |loss: 0.277595| train set 2.904x speedup, test set 6.023x speedup, val set 1.049x speedup, step: 1, train time 12.09 s
Epoch 5/50 |loss: 0.256897| train set 2.754x speedup, test set 5.981x speedup, val set 0.937x speedup, step: 2, train time 11.88 s
Epoch 6/50 |loss: 0.243649| train set 2.985x speedup, test set 5.981x speedup, val set 0.936x speedup, step: 3, train time 12.22 s
Epoch 7/50 |loss: 0.238953| train set 3.039x speedup, test set 6.189x speedup, val set 0.972x speedup, step: 4, train time 11.93 s
Epoch 8/50 |loss: 0.229460| train set 3.098x speedup, test set 6.189x speedup, val set 0.648x speedup, step: 5, train time 11.58 s
Epoch 9/50 |loss: 0.222754| train set 3.137x speedup, test set 5.182x speedup, val set 0.876x speedup, step: 6, train time 12.10 s
Epoch 10/50 |loss: 0.209346| train set 2.680x speedup, test set 5.182x speedup, val set 0.733x speedup, step: 7, train time 11.80 s
Epoch 11/50 |loss: 0.202675| train set 3.320x speedup, test set 5.182x speedup, val set 1.018x speedup, step: 8, train time 11.81 s
Epoch 12/50 |loss: 0.203244| train set 2.758x speedup, test set 5.182x speedup, val set 0.899x speedup, step: 9, train time 11.91 s
Epoch 13/50 |loss: 0.195616| train set 2.972x speedup, test set 6.189x speedup, val set 0.727x speedup, step: 10, train time 12.30 s
Epoch 14/50 |loss: 0.192732| train set 3.319x speedup, test set 5.182x speedup, val set 0.977x speedup, step: 11, train time 11.50 s
Epoch 15/50 |loss: 0.187570| train set 3.333x speedup, test set 6.189x speedup, val set 0.936x speedup, step: 12, train time 12.08 s
Epoch 16/50 |loss: 0.176494| train set 3.364x speedup, test set 5.182x speedup, val set 0.725x speedup, step: 13, train time 11.80 s
Epoch 17/50 |loss: 0.177717| train set 2.992x speedup, test set 6.189x speedup, val set 0.727x speedup, step: 14, train time 12.28 s
Epoch 18/50 |loss: 0.171045| train set 3.007x speedup, test set 6.189x speedup, val set 0.901x speedup, step: 15, train time 11.69 s
Epoch 19/50 |loss: 0.171696| train set 3.252x speedup, test set 6.189x speedup, val set 0.901x speedup, step: 16, train time 12.00 s
Epoch 20/50 |loss: 0.166130| train set 3.224x speedup, test set 6.189x speedup, val set 0.727x speedup, step: 17, train time 12.00 s
Epoch 21/50 |loss: 0.160907| train set 3.219x speedup, test set 6.189x speedup, val set 0.901x speedup, step: 18, train time 11.59 s
Epoch 22/50 |loss: 0.162976| train set 3.330x speedup, test set 6.189x speedup, val set 1.007x speedup, step: 19, train time 11.90 s
Epoch 23/50 |loss: 0.153964| train set 3.264x speedup, test set 6.189x speedup, val set 0.783x speedup, step: 20, train time 12.20 s
Epoch 24/50 |loss: 0.149008| train set 3.120x speedup, test set 6.189x speedup, val set 0.774x speedup, step: 21, train time 12.00 s
Epoch 25/50 |loss: 0.152008| train set 3.056x speedup, test set 6.189x speedup, val set 0.925x speedup, step: 22, train time 11.71 s
Epoch 26/50 |loss: 0.149915| train set 3.144x speedup, test set 6.189x speedup, val set 0.743x speedup, step: 23, train time 11.39 s
Epoch 27/50 |loss: 0.147216| train set 3.219x speedup, test set 6.189x speedup, val set 0.926x speedup, step: 24, train time 11.71 s
Epoch 28/50 |loss: 0.140256| train set 3.232x speedup, test set 5.182x speedup, val set 0.794x speedup, step: 25, train time 11.99 s
Epoch 29/50 |loss: 0.145756| train set 3.123x speedup, test set 6.189x speedup, val set 0.926x speedup, step: 26, train time 12.02 s
Epoch 30/50 |loss: 0.139972| train set 3.253x speedup, test set 5.182x speedup, val set 0.734x speedup, step: 27, train time 11.49 s
Epoch 31/50 |loss: 0.138617| train set 3.276x speedup, test set 6.189x speedup, val set 1.007x speedup, step: 28, train time 11.58 s
Epoch 32/50 |loss: 0.131725| train set 3.326x speedup, test set 5.443x speedup, val set 0.793x speedup, step: 29, train time 11.62 s
Epoch 33/50 |loss: 0.133781| train set 3.283x speedup, test set 6.189x speedup, val set 0.901x speedup, step: 30, train time 11.61 s
Epoch 34/50 |loss: 0.131770| train set 3.303x speedup, test set 6.189x speedup, val set 0.774x speedup, step: 31, train time 11.69 s
Epoch 35/50 |loss: 0.128453| train set 3.361x speedup, test set 5.182x speedup, val set 0.794x speedup, step: 32, train time 12.02 s
Epoch 36/50 |loss: 0.130770| train set 3.336x speedup, test set 6.189x speedup, val set 0.794x speedup, step: 33, train time 12.02 s
Epoch 37/50 |loss: 0.127137| train set 3.282x speedup, test set 6.189x speedup, val set 0.794x speedup, step: 34, train time 11.79 s
Epoch 38/50 |loss: 0.128777| train set 3.198x speedup, test set 6.189x speedup, val set 0.743x speedup, step: 35, train time 11.76 s
Epoch 39/50 |loss: 0.121616| train set 3.322x speedup, test set 6.189x speedup, val set 0.794x speedup, step: 36, train time 12.29 s
Epoch 40/50 |loss: 0.123875| train set 3.465x speedup, test set 6.189x speedup, val set 0.774x speedup, step: 37, train time 11.89 s
Epoch 41/50 |loss: 0.121245| train set 3.266x speedup, test set 6.189x speedup, val set 0.794x speedup, step: 38, train time 12.00 s
Epoch 42/50 |loss: 0.122398| train set 3.328x speedup, test set 6.189x speedup, val set 0.774x speedup, step: 39, train time 11.81 s
Epoch 43/50 |loss: 0.118227| train set 3.396x speedup, test set 6.189x speedup, val set 0.775x speedup, step: 40, train time 11.71 s
Epoch 44/50 |loss: 0.116426| train set 3.315x speedup, test set 6.189x speedup, val set 0.794x speedup, step: 41, train time 11.90 s
Epoch 45/50 |loss: 0.113137| train set 3.301x speedup, test set 6.189x speedup, val set 0.774x speedup, step: 42, train time 11.58 s
Epoch 46/50 |loss: 0.113480| train set 3.315x speedup, test set 6.189x speedup, val set 0.794x speedup, step: 43, train time 11.51 s
Epoch 47/50 |loss: 0.115220| train set 3.254x speedup, test set 6.189x speedup, val set 0.794x speedup, step: 44, train time 11.68 s
Epoch 48/50 |loss: 0.112010| train set 3.452x speedup, test set 6.189x speedup, val set 0.774x speedup, step: 45, train time 12.19 s
Epoch 49/50 |loss: 0.110795| train set 3.488x speedup, test set 6.189x speedup, val set 0.774x speedup, step: 46, train time 12.09 s
Training per epoch cost 11.930 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 49, train speedup 3.488, test speedup 6.189, val speedup 0.774
best test speedup epoch: 2, train speedup 2.360, test speedup 6.690, val speedup 1.022
best validation speedup epoch: 4, train speedup 2.904, test speedup 6.023, val speedup 1.049
last model at epoch 49, train speedup 3.488, test speedup 6.189, val speedup 0.774
execution cost 0:10:42.298206
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.864207, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425163| train set 2.280x speedup, test set 6.690x speedup, val set 0.801x speedup, step: 1, train time 13.62 s
Epoch 1/50 |loss: 0.345461| train set 2.349x speedup, test set 4.730x speedup, val set 0.890x speedup, step: 2, train time 12.42 s
Epoch 2/50 |loss: 0.316840| train set 2.273x speedup, test set 0.847x speedup, val set 0.933x speedup, step: 3, train time 12.00 s
Epoch 3/50 |loss: 0.296132| train set 2.585x speedup, test set 6.690x speedup, val set 0.926x speedup, step: 4, train time 12.02 s
Epoch 4/50 |loss: 0.274326| train set 2.907x speedup, test set 6.742x speedup, val set 0.974x speedup, step: 1, train time 11.70 s
Epoch 5/50 |loss: 0.254483| train set 2.625x speedup, test set 6.690x speedup, val set 0.936x speedup, step: 2, train time 11.49 s
Epoch 6/50 |loss: 0.239365| train set 2.755x speedup, test set 4.940x speedup, val set 0.936x speedup, step: 3, train time 12.02 s
Epoch 7/50 |loss: 0.235842| train set 2.906x speedup, test set 6.690x speedup, val set 0.936x speedup, step: 4, train time 11.79 s
Epoch 8/50 |loss: 0.222778| train set 3.068x speedup, test set 6.950x speedup, val set 0.929x speedup, step: 5, train time 12.07 s
Epoch 9/50 |loss: 0.221587| train set 3.092x speedup, test set 6.950x speedup, val set 0.936x speedup, step: 6, train time 11.41 s
Epoch 10/50 |loss: 0.205170| train set 2.813x speedup, test set 7.007x speedup, val set 0.909x speedup, step: 7, train time 11.80 s
Epoch 11/50 |loss: 0.202572| train set 3.161x speedup, test set 5.213x speedup, val set 1.019x speedup, step: 8, train time 11.89 s
Epoch 12/50 |loss: 0.199916| train set 3.015x speedup, test set 6.950x speedup, val set 0.937x speedup, step: 9, train time 11.72 s
Epoch 13/50 |loss: 0.192631| train set 2.810x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 10, train time 11.91 s
Epoch 14/50 |loss: 0.189860| train set 3.139x speedup, test set 7.007x speedup, val set 0.988x speedup, step: 1, train time 12.00 s
Epoch 15/50 |loss: 0.187389| train set 3.228x speedup, test set 7.007x speedup, val set 0.700x speedup, step: 2, train time 12.01 s
Epoch 16/50 |loss: 0.174334| train set 3.109x speedup, test set 7.007x speedup, val set 0.721x speedup, step: 3, train time 11.78 s
Epoch 17/50 |loss: 0.178415| train set 3.153x speedup, test set 5.080x speedup, val set 1.017x speedup, step: 4, train time 12.29 s
Epoch 18/50 |loss: 0.173738| train set 3.150x speedup, test set 5.110x speedup, val set 1.007x speedup, step: 5, train time 12.08 s
Epoch 19/50 |loss: 0.170308| train set 3.178x speedup, test set 6.234x speedup, val set 0.716x speedup, step: 6, train time 12.10 s
Epoch 20/50 |loss: 0.164687| train set 3.233x speedup, test set 6.234x speedup, val set 0.802x speedup, step: 7, train time 11.80 s
Epoch 21/50 |loss: 0.161543| train set 3.202x speedup, test set 7.007x speedup, val set 0.674x speedup, step: 8, train time 12.00 s
Epoch 22/50 |loss: 0.162359| train set 3.278x speedup, test set 7.007x speedup, val set 1.007x speedup, step: 9, train time 11.51 s
Epoch 23/50 |loss: 0.152656| train set 3.061x speedup, test set 7.007x speedup, val set 0.722x speedup, step: 10, train time 11.99 s
Epoch 24/50 |loss: 0.149493| train set 3.098x speedup, test set 7.007x speedup, val set 0.716x speedup, step: 11, train time 11.81 s
Epoch 25/50 |loss: 0.153844| train set 3.244x speedup, test set 5.110x speedup, val set 0.722x speedup, step: 12, train time 11.80 s
Epoch 26/50 |loss: 0.150428| train set 2.962x speedup, test set 7.007x speedup, val set 0.716x speedup, step: 13, train time 11.71 s
Epoch 27/50 |loss: 0.146732| train set 3.371x speedup, test set 7.007x speedup, val set 0.715x speedup, step: 14, train time 11.69 s
Epoch 28/50 |loss: 0.142257| train set 3.368x speedup, test set 5.213x speedup, val set 0.722x speedup, step: 15, train time 12.08 s
Epoch 29/50 |loss: 0.143773| train set 3.109x speedup, test set 7.007x speedup, val set 0.716x speedup, step: 16, train time 11.53 s
Epoch 30/50 |loss: 0.139444| train set 3.234x speedup, test set 7.007x speedup, val set 0.802x speedup, step: 17, train time 11.82 s
Epoch 31/50 |loss: 0.139435| train set 2.982x speedup, test set 7.007x speedup, val set 0.721x speedup, step: 18, train time 12.12 s
Epoch 32/50 |loss: 0.133443| train set 3.413x speedup, test set 5.110x speedup, val set 0.715x speedup, step: 19, train time 12.00 s
Epoch 33/50 |loss: 0.133402| train set 3.280x speedup, test set 5.110x speedup, val set 1.007x speedup, step: 20, train time 12.28 s
Epoch 34/50 |loss: 0.134707| train set 3.383x speedup, test set 5.110x speedup, val set 0.716x speedup, step: 21, train time 12.11 s
Epoch 35/50 |loss: 0.129511| train set 3.180x speedup, test set 5.110x speedup, val set 0.716x speedup, step: 22, train time 11.91 s
Epoch 36/50 |loss: 0.131257| train set 3.347x speedup, test set 5.110x speedup, val set 0.716x speedup, step: 23, train time 11.89 s
Epoch 37/50 |loss: 0.126661| train set 3.355x speedup, test set 5.110x speedup, val set 1.019x speedup, step: 24, train time 11.78 s
Epoch 38/50 |loss: 0.127523| train set 3.224x speedup, test set 7.007x speedup, val set 0.722x speedup, step: 25, train time 12.29 s
Epoch 39/50 |loss: 0.121448| train set 3.210x speedup, test set 5.110x speedup, val set 0.722x speedup, step: 26, train time 11.97 s
Epoch 40/50 |loss: 0.126332| train set 3.453x speedup, test set 5.110x speedup, val set 0.721x speedup, step: 27, train time 11.99 s
Epoch 41/50 |loss: 0.122166| train set 3.341x speedup, test set 5.110x speedup, val set 0.802x speedup, step: 28, train time 12.18 s
Epoch 42/50 |loss: 0.121446| train set 3.471x speedup, test set 5.110x speedup, val set 0.721x speedup, step: 29, train time 12.21 s
Epoch 43/50 |loss: 0.121552| train set 3.417x speedup, test set 6.234x speedup, val set 0.716x speedup, step: 30, train time 11.81 s
Epoch 44/50 |loss: 0.119415| train set 3.308x speedup, test set 5.110x speedup, val set 0.708x speedup, step: 31, train time 11.59 s
Epoch 45/50 |loss: 0.113232| train set 3.285x speedup, test set 6.234x speedup, val set 0.708x speedup, step: 32, train time 11.31 s
Epoch 46/50 |loss: 0.112217| train set 3.327x speedup, test set 6.234x speedup, val set 0.716x speedup, step: 33, train time 11.70 s
Epoch 47/50 |loss: 0.113301| train set 3.312x speedup, test set 6.234x speedup, val set 1.007x speedup, step: 34, train time 12.09 s
Epoch 48/50 |loss: 0.113347| train set 3.332x speedup, test set 6.234x speedup, val set 0.716x speedup, step: 35, train time 11.78 s
Epoch 49/50 |loss: 0.108862| train set 3.476x speedup, test set 6.234x speedup, val set 0.716x speedup, step: 36, train time 11.72 s
Training per epoch cost 11.932 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
12, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
13, opt runtime 7.851s, model runtime 10.810s, pg runtime 13.622s, speedup 1.260x
14, opt runtime 7.442s, model runtime 7.442s, pg runtime 14.838s, speedup 1.994x
15, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
16, opt runtime 6.810s, model runtime 6.810s, pg runtime 13.796s, speedup 2.026x
17, opt runtime 6.460s, model runtime 6.460s, pg runtime 16.134s, speedup 2.498x
18, opt runtime 6.656s, model runtime 6.656s, pg runtime 15.260s, speedup 2.293x
19, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
20, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 49, train speedup 3.476, test speedup 6.234, val speedup 0.716
best test speedup epoch: 10, train speedup 2.813, test speedup 7.007, val speedup 0.909
best validation speedup epoch: 14, train speedup 3.139, test speedup 7.007, val speedup 0.988
last model at epoch 49, train speedup 3.476, test speedup 6.234, val speedup 0.716
execution cost 0:10:40.371040
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.835245, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426717| train set 2.283x speedup, test set 4.730x speedup, val set 0.793x speedup, step: 1, train time 13.19 s
Epoch 1/50 |loss: 0.344663| train set 2.332x speedup, test set 4.756x speedup, val set 0.890x speedup, step: 2, train time 12.48 s
Epoch 2/50 |loss: 0.316045| train set 2.492x speedup, test set 6.690x speedup, val set 0.926x speedup, step: 3, train time 11.89 s
Epoch 3/50 |loss: 0.294099| train set 2.563x speedup, test set 6.690x speedup, val set 1.398x speedup, step: 4, train time 12.31 s
Epoch 4/50 |loss: 0.272247| train set 2.941x speedup, test set 6.690x speedup, val set 1.030x speedup, step: 1, train time 12.30 s
Epoch 5/50 |loss: 0.257664| train set 2.829x speedup, test set 5.035x speedup, val set 0.984x speedup, step: 2, train time 12.39 s
Epoch 6/50 |loss: 0.240149| train set 2.940x speedup, test set 5.035x speedup, val set 1.015x speedup, step: 3, train time 12.30 s
Epoch 7/50 |loss: 0.238615| train set 3.057x speedup, test set 6.690x speedup, val set 0.956x speedup, step: 4, train time 11.90 s
Epoch 8/50 |loss: 0.224527| train set 3.360x speedup, test set 5.035x speedup, val set 0.704x speedup, step: 5, train time 12.00 s
Epoch 9/50 |loss: 0.221380| train set 2.923x speedup, test set 5.035x speedup, val set 0.985x speedup, step: 6, train time 11.91 s
Epoch 10/50 |loss: 0.209442| train set 2.752x speedup, test set 6.950x speedup, val set 0.983x speedup, step: 7, train time 11.89 s
Epoch 11/50 |loss: 0.203027| train set 3.207x speedup, test set 5.182x speedup, val set 1.113x speedup, step: 8, train time 11.80 s
Epoch 12/50 |loss: 0.201992| train set 2.771x speedup, test set 4.881x speedup, val set 0.910x speedup, step: 9, train time 11.52 s
Epoch 13/50 |loss: 0.195085| train set 2.953x speedup, test set 4.881x speedup, val set 0.886x speedup, step: 10, train time 12.19 s
Epoch 14/50 |loss: 0.191010| train set 3.177x speedup, test set 5.208x speedup, val set 1.077x speedup, step: 1, train time 11.72 s
Epoch 15/50 |loss: 0.185863| train set 3.228x speedup, test set 5.213x speedup, val set 1.114x speedup, step: 2, train time 11.51 s
Epoch 16/50 |loss: 0.175283| train set 3.361x speedup, test set 5.182x speedup, val set 0.721x speedup, step: 3, train time 11.98 s
Epoch 17/50 |loss: 0.176811| train set 2.837x speedup, test set 5.182x speedup, val set 0.935x speedup, step: 4, train time 12.17 s
Epoch 18/50 |loss: 0.173247| train set 2.863x speedup, test set 3.733x speedup, val set 0.909x speedup, step: 5, train time 11.82 s
Epoch 19/50 |loss: 0.172197| train set 3.151x speedup, test set 6.950x speedup, val set 0.721x speedup, step: 6, train time 12.31 s
Epoch 20/50 |loss: 0.163146| train set 3.142x speedup, test set 3.906x speedup, val set 0.963x speedup, step: 7, train time 11.90 s
Epoch 21/50 |loss: 0.160684| train set 3.228x speedup, test set 5.182x speedup, val set 0.722x speedup, step: 8, train time 12.37 s
Epoch 22/50 |loss: 0.158083| train set 3.190x speedup, test set 3.641x speedup, val set 1.019x speedup, step: 9, train time 11.51 s
Epoch 23/50 |loss: 0.152934| train set 3.154x speedup, test set 3.806x speedup, val set 0.769x speedup, step: 10, train time 12.01 s
Epoch 24/50 |loss: 0.143791| train set 3.155x speedup, test set 3.806x speedup, val set 0.769x speedup, step: 11, train time 11.80 s
Epoch 25/50 |loss: 0.152685| train set 3.289x speedup, test set 3.806x speedup, val set 0.706x speedup, step: 12, train time 11.80 s
Epoch 26/50 |loss: 0.150061| train set 3.002x speedup, test set 3.641x speedup, val set 0.680x speedup, step: 13, train time 11.92 s
Epoch 27/50 |loss: 0.142178| train set 3.393x speedup, test set 3.641x speedup, val set 1.019x speedup, step: 14, train time 11.93 s
Epoch 28/50 |loss: 0.140506| train set 3.384x speedup, test set 3.806x speedup, val set 0.769x speedup, step: 15, train time 11.60 s
Epoch 29/50 |loss: 0.141958| train set 3.014x speedup, test set 3.806x speedup, val set 0.722x speedup, step: 16, train time 11.50 s
Epoch 30/50 |loss: 0.136647| train set 3.341x speedup, test set 3.806x speedup, val set 0.722x speedup, step: 17, train time 11.49 s
Epoch 31/50 |loss: 0.138795| train set 3.199x speedup, test set 3.641x speedup, val set 1.016x speedup, step: 18, train time 11.72 s
Epoch 32/50 |loss: 0.131510| train set 3.324x speedup, test set 3.641x speedup, val set 0.721x speedup, step: 19, train time 11.98 s
Epoch 33/50 |loss: 0.130010| train set 3.299x speedup, test set 3.641x speedup, val set 0.988x speedup, step: 20, train time 12.40 s
Epoch 34/50 |loss: 0.128222| train set 3.325x speedup, test set 3.806x speedup, val set 0.722x speedup, step: 21, train time 11.80 s
Epoch 35/50 |loss: 0.126729| train set 3.274x speedup, test set 3.641x speedup, val set 0.786x speedup, step: 22, train time 12.11 s
Epoch 36/50 |loss: 0.131258| train set 3.326x speedup, test set 3.641x speedup, val set 0.768x speedup, step: 23, train time 11.89 s
Epoch 37/50 |loss: 0.124334| train set 3.349x speedup, test set 3.641x speedup, val set 0.769x speedup, step: 24, train time 11.61 s
Epoch 38/50 |loss: 0.125376| train set 3.049x speedup, test set 3.641x speedup, val set 0.769x speedup, step: 25, train time 11.90 s
Epoch 39/50 |loss: 0.120322| train set 3.383x speedup, test set 3.641x speedup, val set 0.721x speedup, step: 26, train time 11.49 s
Epoch 40/50 |loss: 0.122156| train set 3.471x speedup, test set 5.213x speedup, val set 0.785x speedup, step: 27, train time 11.67 s
Epoch 41/50 |loss: 0.119601| train set 3.378x speedup, test set 4.908x speedup, val set 0.722x speedup, step: 28, train time 11.90 s
Epoch 42/50 |loss: 0.117766| train set 3.452x speedup, test set 3.806x speedup, val set 0.767x speedup, step: 29, train time 11.90 s
Epoch 43/50 |loss: 0.119267| train set 3.355x speedup, test set 3.806x speedup, val set 0.722x speedup, step: 30, train time 11.81 s
Epoch 44/50 |loss: 0.114764| train set 3.379x speedup, test set 3.792x speedup, val set 0.722x speedup, step: 31, train time 11.78 s
Epoch 45/50 |loss: 0.109199| train set 3.289x speedup, test set 3.806x speedup, val set 0.722x speedup, step: 32, train time 11.51 s
Epoch 46/50 |loss: 0.109888| train set 3.467x speedup, test set 3.806x speedup, val set 0.738x speedup, step: 33, train time 11.90 s
Epoch 47/50 |loss: 0.114112| train set 3.284x speedup, test set 4.908x speedup, val set 0.722x speedup, step: 34, train time 12.21 s
Epoch 48/50 |loss: 0.109771| train set 3.465x speedup, test set 3.792x speedup, val set 0.769x speedup, step: 35, train time 11.99 s
Epoch 49/50 |loss: 0.107805| train set 3.499x speedup, test set 3.806x speedup, val set 0.738x speedup, step: 36, train time 11.88 s
Training per epoch cost 11.937 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 36.429s, pg runtime 17.708s, speedup 0.486x
12, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
13, opt runtime 7.851s, model runtime 30.956s, pg runtime 13.622s, speedup 0.440x
14, opt runtime 7.442s, model runtime 32.816s, pg runtime 14.838s, speedup 0.452x
15, opt runtime 7.110s, model runtime 38.849s, pg runtime 14.286s, speedup 0.368x
16, opt runtime 6.810s, model runtime 39.840s, pg runtime 13.796s, speedup 0.346x
17, opt runtime 6.460s, model runtime 33.445s, pg runtime 16.134s, speedup 0.482x
18, opt runtime 6.656s, model runtime 39.236s, pg runtime 15.260s, speedup 0.389x
19, opt runtime 7.913s, model runtime 32.779s, pg runtime 15.548s, speedup 0.474x
20, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 49, train speedup 3.499, test speedup 3.806, val speedup 0.738
best test speedup epoch: 10, train speedup 2.752, test speedup 6.950, val speedup 0.983
best validation speedup epoch: 14, train speedup 3.177, test speedup 5.208, val speedup 1.077
last model at epoch 49, train speedup 3.499, test speedup 3.806, val speedup 0.738
execution cost 0:10:39.313146
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.868837, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425692| train set 2.293x speedup, test set 0.847x speedup, val set 0.801x speedup, step: 1, train time 13.16 s
Epoch 1/50 |loss: 0.345200| train set 2.391x speedup, test set 0.847x speedup, val set 0.724x speedup, step: 2, train time 12.30 s
Epoch 2/50 |loss: 0.314459| train set 2.402x speedup, test set 5.035x speedup, val set 1.724x speedup, step: 3, train time 12.20 s
Epoch 3/50 |loss: 0.292492| train set 2.563x speedup, test set 5.981x speedup, val set 0.926x speedup, step: 4, train time 11.90 s
Epoch 4/50 |loss: 0.272883| train set 2.617x speedup, test set 5.035x speedup, val set 1.031x speedup, step: 1, train time 11.80 s
Epoch 5/50 |loss: 0.254302| train set 2.863x speedup, test set 5.981x speedup, val set 0.910x speedup, step: 2, train time 11.21 s
Epoch 6/50 |loss: 0.237847| train set 2.979x speedup, test set 5.182x speedup, val set 0.927x speedup, step: 3, train time 11.79 s
Epoch 7/50 |loss: 0.235906| train set 3.307x speedup, test set 6.189x speedup, val set 0.897x speedup, step: 4, train time 11.92 s
Epoch 8/50 |loss: 0.223229| train set 3.326x speedup, test set 5.182x speedup, val set 1.028x speedup, step: 5, train time 11.80 s
Epoch 9/50 |loss: 0.221921| train set 3.245x speedup, test set 5.182x speedup, val set 0.945x speedup, step: 6, train time 11.82 s
Epoch 10/50 |loss: 0.208855| train set 2.675x speedup, test set 5.182x speedup, val set 0.954x speedup, step: 7, train time 11.68 s
Epoch 11/50 |loss: 0.202631| train set 3.255x speedup, test set 5.182x speedup, val set 1.009x speedup, step: 8, train time 11.80 s
Epoch 12/50 |loss: 0.202588| train set 2.829x speedup, test set 6.943x speedup, val set 0.956x speedup, step: 9, train time 11.70 s
Epoch 13/50 |loss: 0.195947| train set 3.073x speedup, test set 5.182x speedup, val set 0.886x speedup, step: 10, train time 11.79 s
Epoch 14/50 |loss: 0.192114| train set 3.299x speedup, test set 5.182x speedup, val set 0.932x speedup, step: 11, train time 11.58 s
Epoch 15/50 |loss: 0.189876| train set 3.249x speedup, test set 5.182x speedup, val set 0.852x speedup, step: 12, train time 12.27 s
Epoch 16/50 |loss: 0.175986| train set 3.227x speedup, test set 5.182x speedup, val set 0.701x speedup, step: 13, train time 11.61 s
Epoch 17/50 |loss: 0.180878| train set 3.046x speedup, test set 5.182x speedup, val set 0.659x speedup, step: 14, train time 11.90 s
Epoch 18/50 |loss: 0.172389| train set 2.965x speedup, test set 6.189x speedup, val set 0.877x speedup, step: 15, train time 11.70 s
Epoch 19/50 |loss: 0.173591| train set 3.096x speedup, test set 5.182x speedup, val set 0.705x speedup, step: 16, train time 11.58 s
Epoch 20/50 |loss: 0.169047| train set 3.154x speedup, test set 5.182x speedup, val set 0.733x speedup, step: 17, train time 12.20 s
Epoch 21/50 |loss: 0.162635| train set 3.068x speedup, test set 5.182x speedup, val set 0.910x speedup, step: 18, train time 11.90 s
Epoch 22/50 |loss: 0.163506| train set 3.157x speedup, test set 5.182x speedup, val set 0.885x speedup, step: 19, train time 12.20 s
Epoch 23/50 |loss: 0.155414| train set 3.340x speedup, test set 5.182x speedup, val set 0.661x speedup, step: 20, train time 11.81 s
Epoch 24/50 |loss: 0.149238| train set 3.016x speedup, test set 6.189x speedup, val set 0.776x speedup, step: 21, train time 11.89 s
Epoch 25/50 |loss: 0.152926| train set 3.190x speedup, test set 6.189x speedup, val set 0.727x speedup, step: 22, train time 11.71 s
Epoch 26/50 |loss: 0.150739| train set 2.868x speedup, test set 6.189x speedup, val set 0.661x speedup, step: 23, train time 11.89 s
Epoch 27/50 |loss: 0.148455| train set 3.211x speedup, test set 5.182x speedup, val set 0.666x speedup, step: 24, train time 12.00 s
Epoch 28/50 |loss: 0.143748| train set 3.234x speedup, test set 6.189x speedup, val set 0.661x speedup, step: 25, train time 11.59 s
Epoch 29/50 |loss: 0.142982| train set 3.102x speedup, test set 6.189x speedup, val set 0.666x speedup, step: 26, train time 12.08 s
Epoch 30/50 |loss: 0.140041| train set 3.178x speedup, test set 6.189x speedup, val set 0.885x speedup, step: 27, train time 11.70 s
Epoch 31/50 |loss: 0.142015| train set 3.349x speedup, test set 6.189x speedup, val set 0.706x speedup, step: 28, train time 12.01 s
Epoch 32/50 |loss: 0.131413| train set 3.283x speedup, test set 6.189x speedup, val set 0.884x speedup, step: 29, train time 11.40 s
Epoch 33/50 |loss: 0.130737| train set 3.271x speedup, test set 6.189x speedup, val set 0.886x speedup, step: 30, train time 11.51 s
Epoch 34/50 |loss: 0.131313| train set 3.319x speedup, test set 6.189x speedup, val set 0.666x speedup, step: 31, train time 12.00 s
Epoch 35/50 |loss: 0.131063| train set 3.337x speedup, test set 6.189x speedup, val set 0.876x speedup, step: 32, train time 11.31 s
Epoch 36/50 |loss: 0.128720| train set 3.351x speedup, test set 6.189x speedup, val set 0.666x speedup, step: 33, train time 12.01 s
Epoch 37/50 |loss: 0.127777| train set 3.340x speedup, test set 6.189x speedup, val set 0.988x speedup, step: 34, train time 11.58 s
Epoch 38/50 |loss: 0.125826| train set 2.875x speedup, test set 6.189x speedup, val set 0.885x speedup, step: 35, train time 11.82 s
Epoch 39/50 |loss: 0.122158| train set 3.193x speedup, test set 6.189x speedup, val set 0.707x speedup, step: 36, train time 12.00 s
Epoch 40/50 |loss: 0.122216| train set 3.441x speedup, test set 6.189x speedup, val set 0.959x speedup, step: 37, train time 11.70 s
Epoch 41/50 |loss: 0.117571| train set 3.294x speedup, test set 6.189x speedup, val set 0.666x speedup, step: 38, train time 11.80 s
Epoch 42/50 |loss: 0.117795| train set 3.245x speedup, test set 6.189x speedup, val set 0.781x speedup, step: 39, train time 11.89 s
Epoch 43/50 |loss: 0.116148| train set 3.262x speedup, test set 6.189x speedup, val set 0.706x speedup, step: 40, train time 11.66 s
Epoch 44/50 |loss: 0.114661| train set 3.323x speedup, test set 6.189x speedup, val set 0.885x speedup, step: 41, train time 12.28 s
Epoch 45/50 |loss: 0.110302| train set 3.248x speedup, test set 5.182x speedup, val set 0.666x speedup, step: 42, train time 12.08 s
Epoch 46/50 |loss: 0.110404| train set 3.507x speedup, test set 6.189x speedup, val set 0.959x speedup, step: 43, train time 11.61 s
Epoch 47/50 |loss: 0.108912| train set 3.188x speedup, test set 6.189x speedup, val set 0.959x speedup, step: 44, train time 12.09 s
Epoch 48/50 |loss: 0.114140| train set 3.454x speedup, test set 5.182x speedup, val set 0.776x speedup, step: 45, train time 11.70 s
Epoch 49/50 |loss: 0.108884| train set 3.436x speedup, test set 6.189x speedup, val set 0.886x speedup, step: 46, train time 11.78 s
Training per epoch cost 11.854 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 36.429s, pg runtime 17.708s, speedup 0.486x
12, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
13, opt runtime 7.851s, model runtime 30.956s, pg runtime 13.622s, speedup 0.440x
14, opt runtime 7.442s, model runtime 32.816s, pg runtime 14.838s, speedup 0.452x
15, opt runtime 7.110s, model runtime 38.849s, pg runtime 14.286s, speedup 0.368x
16, opt runtime 6.810s, model runtime 39.840s, pg runtime 13.796s, speedup 0.346x
17, opt runtime 6.460s, model runtime 33.445s, pg runtime 16.134s, speedup 0.482x
18, opt runtime 6.656s, model runtime 39.236s, pg runtime 15.260s, speedup 0.389x
19, opt runtime 7.913s, model runtime 32.779s, pg runtime 15.548s, speedup 0.474x
20, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 46, train speedup 3.507, test speedup 6.189, val speedup 0.959
best test speedup epoch: 12, train speedup 2.829, test speedup 6.943, val speedup 0.956
best validation speedup epoch: 4, train speedup 2.617, test speedup 5.035, val speedup 1.031
last model at epoch 49, train speedup 3.436, test speedup 6.189, val speedup 0.886
execution cost 0:10:36.068572
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.845145, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426607| train set 2.202x speedup, test set 0.847x speedup, val set 0.795x speedup, step: 1, train time 13.34 s
Epoch 1/50 |loss: 0.346520| train set 2.378x speedup, test set 0.847x speedup, val set 1.023x speedup, step: 2, train time 13.02 s
Epoch 2/50 |loss: 0.315295| train set 2.362x speedup, test set 5.035x speedup, val set 1.015x speedup, step: 3, train time 12.00 s
Epoch 3/50 |loss: 0.292318| train set 2.845x speedup, test set 5.981x speedup, val set 1.003x speedup, step: 4, train time 12.30 s
Epoch 4/50 |loss: 0.275543| train set 2.763x speedup, test set 6.023x speedup, val set 1.030x speedup, step: 1, train time 12.10 s
Epoch 5/50 |loss: 0.254107| train set 2.568x speedup, test set 4.221x speedup, val set 1.015x speedup, step: 2, train time 11.89 s
Epoch 6/50 |loss: 0.239537| train set 2.691x speedup, test set 5.981x speedup, val set 1.015x speedup, step: 3, train time 12.29 s
Epoch 7/50 |loss: 0.234224| train set 3.340x speedup, test set 5.035x speedup, val set 0.985x speedup, step: 4, train time 11.90 s
Epoch 8/50 |loss: 0.222800| train set 3.238x speedup, test set 5.981x speedup, val set 0.956x speedup, step: 5, train time 11.98 s
Epoch 9/50 |loss: 0.221858| train set 2.935x speedup, test set 5.981x speedup, val set 0.985x speedup, step: 6, train time 12.21 s
Epoch 10/50 |loss: 0.206607| train set 2.865x speedup, test set 5.981x speedup, val set 1.043x speedup, step: 7, train time 11.70 s
Epoch 11/50 |loss: 0.200468| train set 3.179x speedup, test set 5.035x speedup, val set 1.010x speedup, step: 8, train time 12.11 s
Epoch 12/50 |loss: 0.200751| train set 3.066x speedup, test set 5.981x speedup, val set 0.985x speedup, step: 9, train time 12.09 s
Epoch 13/50 |loss: 0.195735| train set 2.993x speedup, test set 5.981x speedup, val set 0.956x speedup, step: 10, train time 12.08 s
Epoch 14/50 |loss: 0.190920| train set 3.193x speedup, test set 5.035x speedup, val set 0.956x speedup, step: 11, train time 11.90 s
Epoch 15/50 |loss: 0.184952| train set 3.300x speedup, test set 5.035x speedup, val set 1.041x speedup, step: 12, train time 12.31 s
Epoch 16/50 |loss: 0.177756| train set 3.362x speedup, test set 6.189x speedup, val set 1.010x speedup, step: 13, train time 11.97 s
Epoch 17/50 |loss: 0.179917| train set 2.966x speedup, test set 5.035x speedup, val set 0.705x speedup, step: 14, train time 11.70 s
Epoch 18/50 |loss: 0.172687| train set 3.234x speedup, test set 5.182x speedup, val set 0.956x speedup, step: 15, train time 12.40 s
Epoch 19/50 |loss: 0.170371| train set 3.387x speedup, test set 5.182x speedup, val set 0.705x speedup, step: 16, train time 11.32 s
Epoch 20/50 |loss: 0.165489| train set 3.247x speedup, test set 5.182x speedup, val set 0.956x speedup, step: 17, train time 11.80 s
Epoch 21/50 |loss: 0.157802| train set 2.995x speedup, test set 5.035x speedup, val set 0.985x speedup, step: 18, train time 11.50 s
Epoch 22/50 |loss: 0.156473| train set 3.355x speedup, test set 4.323x speedup, val set 0.985x speedup, step: 19, train time 11.67 s
Epoch 23/50 |loss: 0.150609| train set 3.429x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 20, train time 11.70 s
Epoch 24/50 |loss: 0.143909| train set 3.096x speedup, test set 3.806x speedup, val set 0.769x speedup, step: 21, train time 11.81 s
Epoch 25/50 |loss: 0.149295| train set 3.404x speedup, test set 3.848x speedup, val set 1.074x speedup, step: 22, train time 11.60 s
Epoch 26/50 |loss: 0.146518| train set 3.060x speedup, test set 5.182x speedup, val set 0.985x speedup, step: 23, train time 11.68 s
Epoch 27/50 |loss: 0.139579| train set 3.244x speedup, test set 5.182x speedup, val set 1.016x speedup, step: 24, train time 11.91 s
Epoch 28/50 |loss: 0.136628| train set 3.462x speedup, test set 5.182x speedup, val set 0.985x speedup, step: 25, train time 11.98 s
Epoch 29/50 |loss: 0.142798| train set 3.152x speedup, test set 5.182x speedup, val set 0.705x speedup, step: 26, train time 12.01 s
Epoch 30/50 |loss: 0.133745| train set 3.251x speedup, test set 3.806x speedup, val set 0.790x speedup, step: 27, train time 11.91 s
Epoch 31/50 |loss: 0.131345| train set 3.167x speedup, test set 3.806x speedup, val set 1.077x speedup, step: 28, train time 11.58 s
Epoch 32/50 |loss: 0.125593| train set 3.418x speedup, test set 3.751x speedup, val set 1.043x speedup, step: 29, train time 11.80 s
Epoch 33/50 |loss: 0.124999| train set 3.325x speedup, test set 5.080x speedup, val set 1.003x speedup, step: 30, train time 12.18 s
Epoch 34/50 |loss: 0.126167| train set 3.431x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 31, train time 11.89 s
Epoch 35/50 |loss: 0.122422| train set 3.352x speedup, test set 3.751x speedup, val set 0.721x speedup, step: 32, train time 11.60 s
Epoch 36/50 |loss: 0.128775| train set 3.231x speedup, test set 5.080x speedup, val set 0.911x speedup, step: 33, train time 11.80 s
Epoch 37/50 |loss: 0.121687| train set 3.119x speedup, test set 3.751x speedup, val set 0.988x speedup, step: 34, train time 12.29 s
Epoch 38/50 |loss: 0.119360| train set 3.193x speedup, test set 3.906x speedup, val set 0.985x speedup, step: 35, train time 11.59 s
Epoch 39/50 |loss: 0.113672| train set 3.225x speedup, test set 5.110x speedup, val set 1.077x speedup, step: 1, train time 12.00 s
Epoch 40/50 |loss: 0.115491| train set 3.480x speedup, test set 3.751x speedup, val set 1.146x speedup, step: 2, train time 11.59 s
Epoch 41/50 |loss: 0.112972| train set 3.174x speedup, test set 3.751x speedup, val set 0.911x speedup, step: 3, train time 11.79 s
Epoch 42/50 |loss: 0.111696| train set 3.467x speedup, test set 5.110x speedup, val set 0.801x speedup, step: 4, train time 11.61 s
Epoch 43/50 |loss: 0.113499| train set 3.416x speedup, test set 3.751x speedup, val set 0.911x speedup, step: 5, train time 11.61 s
Epoch 44/50 |loss: 0.108996| train set 3.396x speedup, test set 3.751x speedup, val set 0.911x speedup, step: 6, train time 11.79 s
Epoch 45/50 |loss: 0.103484| train set 3.262x speedup, test set 3.806x speedup, val set 0.897x speedup, step: 7, train time 11.79 s
Epoch 46/50 |loss: 0.104910| train set 3.369x speedup, test set 3.751x speedup, val set 0.988x speedup, step: 8, train time 12.10 s
Epoch 47/50 |loss: 0.111356| train set 3.469x speedup, test set 3.848x speedup, val set 0.859x speedup, step: 9, train time 12.00 s
Epoch 48/50 |loss: 0.105609| train set 3.454x speedup, test set 4.323x speedup, val set 0.800x speedup, step: 10, train time 12.30 s
Epoch 49/50 |loss: 0.101369| train set 3.513x speedup, test set 3.751x speedup, val set 0.936x speedup, step: 11, train time 11.77 s
Training per epoch cost 11.945 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 27.212s, pg runtime 17.708s, speedup 0.651x
12, opt runtime 6.284s, model runtime 27.699s, pg runtime 31.019s, speedup 1.120x
13, opt runtime 7.851s, model runtime 50.910s, pg runtime 13.622s, speedup 0.268x
14, opt runtime 7.442s, model runtime 46.719s, pg runtime 14.838s, speedup 0.318x
15, opt runtime 7.110s, model runtime 47.988s, pg runtime 14.286s, speedup 0.298x
16, opt runtime 6.810s, model runtime 51.478s, pg runtime 13.796s, speedup 0.268x
17, opt runtime 6.460s, model runtime 26.481s, pg runtime 16.134s, speedup 0.609x
18, opt runtime 6.656s, model runtime 29.910s, pg runtime 15.260s, speedup 0.510x
19, opt runtime 7.913s, model runtime 48.858s, pg runtime 15.548s, speedup 0.318x
20, opt runtime 7.377s, model runtime 31.774s, pg runtime 28.655s, speedup 0.902x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 49, train speedup 3.513, test speedup 3.751, val speedup 0.936
best test speedup epoch: 16, train speedup 3.362, test speedup 6.189, val speedup 1.010
best validation speedup epoch: 39, train speedup 3.225, test speedup 5.110, val speedup 1.077
last model at epoch 49, train speedup 3.513, test speedup 3.751, val speedup 0.936
execution cost 0:10:41.854376
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.852070, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426377| train set 2.284x speedup, test set 0.847x speedup, val set 0.801x speedup, step: 1, train time 12.64 s
Epoch 1/50 |loss: 0.345585| train set 2.489x speedup, test set 6.742x speedup, val set 1.017x speedup, step: 2, train time 12.22 s
Epoch 2/50 |loss: 0.313896| train set 2.480x speedup, test set 6.690x speedup, val set 1.003x speedup, step: 3, train time 11.79 s
Epoch 3/50 |loss: 0.292035| train set 2.567x speedup, test set 6.690x speedup, val set 1.398x speedup, step: 4, train time 11.69 s
Epoch 4/50 |loss: 0.276957| train set 2.946x speedup, test set 6.742x speedup, val set 1.611x speedup, step: 1, train time 11.81 s
Epoch 5/50 |loss: 0.256566| train set 2.643x speedup, test set 4.956x speedup, val set 1.016x speedup, step: 2, train time 11.59 s
Epoch 6/50 |loss: 0.237946| train set 2.640x speedup, test set 6.690x speedup, val set 1.015x speedup, step: 3, train time 11.81 s
Epoch 7/50 |loss: 0.236843| train set 2.923x speedup, test set 6.950x speedup, val set 0.985x speedup, step: 4, train time 11.82 s
Epoch 8/50 |loss: 0.223602| train set 3.139x speedup, test set 6.950x speedup, val set 1.010x speedup, step: 5, train time 11.40 s
Epoch 9/50 |loss: 0.225076| train set 3.146x speedup, test set 6.950x speedup, val set 0.985x speedup, step: 6, train time 12.37 s
Epoch 10/50 |loss: 0.209511| train set 2.867x speedup, test set 6.950x speedup, val set 1.010x speedup, step: 7, train time 11.93 s
Epoch 11/50 |loss: 0.204839| train set 3.152x speedup, test set 6.950x speedup, val set 0.998x speedup, step: 8, train time 11.71 s
Epoch 12/50 |loss: 0.202092| train set 2.752x speedup, test set 5.110x speedup, val set 0.910x speedup, step: 9, train time 12.30 s
Epoch 13/50 |loss: 0.198176| train set 2.829x speedup, test set 1.408x speedup, val set 0.666x speedup, step: 10, train time 11.79 s
Epoch 14/50 |loss: 0.194014| train set 3.316x speedup, test set 7.007x speedup, val set 1.107x speedup, step: 11, train time 11.70 s
Epoch 15/50 |loss: 0.190450| train set 3.129x speedup, test set 7.007x speedup, val set 1.076x speedup, step: 12, train time 11.62 s
Epoch 16/50 |loss: 0.180745| train set 3.185x speedup, test set 7.007x speedup, val set 1.001x speedup, step: 13, train time 12.10 s
Epoch 17/50 |loss: 0.178576| train set 3.154x speedup, test set 6.950x speedup, val set 0.792x speedup, step: 14, train time 11.78 s
Epoch 18/50 |loss: 0.175950| train set 2.920x speedup, test set 6.950x speedup, val set 0.910x speedup, step: 15, train time 12.10 s
Epoch 19/50 |loss: 0.170822| train set 3.251x speedup, test set 5.080x speedup, val set 0.648x speedup, step: 16, train time 11.78 s
Epoch 20/50 |loss: 0.167981| train set 3.233x speedup, test set 5.182x speedup, val set 0.733x speedup, step: 17, train time 11.71 s
Epoch 21/50 |loss: 0.165257| train set 2.933x speedup, test set 5.182x speedup, val set 0.666x speedup, step: 18, train time 11.68 s
Epoch 22/50 |loss: 0.163218| train set 3.298x speedup, test set 5.080x speedup, val set 0.910x speedup, step: 19, train time 12.02 s
Epoch 23/50 |loss: 0.153445| train set 3.369x speedup, test set 5.182x speedup, val set 0.706x speedup, step: 20, train time 12.32 s
Epoch 24/50 |loss: 0.147566| train set 2.931x speedup, test set 5.213x speedup, val set 0.685x speedup, step: 21, train time 11.30 s
Epoch 25/50 |loss: 0.152977| train set 3.361x speedup, test set 5.080x speedup, val set 0.666x speedup, step: 22, train time 12.22 s
Epoch 26/50 |loss: 0.150520| train set 2.960x speedup, test set 6.950x speedup, val set 0.666x speedup, step: 23, train time 12.00 s
Epoch 27/50 |loss: 0.145894| train set 3.394x speedup, test set 5.213x speedup, val set 0.985x speedup, step: 24, train time 12.00 s
Epoch 28/50 |loss: 0.139806| train set 3.352x speedup, test set 5.182x speedup, val set 0.661x speedup, step: 25, train time 11.51 s
Epoch 29/50 |loss: 0.142568| train set 3.297x speedup, test set 5.182x speedup, val set 0.665x speedup, step: 26, train time 11.98 s
Epoch 30/50 |loss: 0.137270| train set 3.334x speedup, test set 5.110x speedup, val set 0.706x speedup, step: 27, train time 11.81 s
Epoch 31/50 |loss: 0.142223| train set 3.238x speedup, test set 5.080x speedup, val set 0.987x speedup, step: 28, train time 11.71 s
Epoch 32/50 |loss: 0.130151| train set 3.360x speedup, test set 5.080x speedup, val set 0.987x speedup, step: 29, train time 12.00 s
Epoch 33/50 |loss: 0.129611| train set 3.176x speedup, test set 4.881x speedup, val set 0.910x speedup, step: 30, train time 11.59 s
Epoch 34/50 |loss: 0.132540| train set 3.361x speedup, test set 5.048x speedup, val set 0.705x speedup, step: 31, train time 11.49 s
Epoch 35/50 |loss: 0.128211| train set 3.376x speedup, test set 5.048x speedup, val set 0.705x speedup, step: 32, train time 11.80 s
Epoch 36/50 |loss: 0.129225| train set 3.334x speedup, test set 4.952x speedup, val set 0.666x speedup, step: 33, train time 11.20 s
Epoch 37/50 |loss: 0.124055| train set 3.342x speedup, test set 5.110x speedup, val set 0.987x speedup, step: 34, train time 12.19 s
Epoch 38/50 |loss: 0.123358| train set 3.231x speedup, test set 5.080x speedup, val set 0.706x speedup, step: 35, train time 12.18 s
Epoch 39/50 |loss: 0.121523| train set 3.395x speedup, test set 5.110x speedup, val set 0.705x speedup, step: 36, train time 12.01 s
Epoch 40/50 |loss: 0.122954| train set 3.416x speedup, test set 5.080x speedup, val set 0.706x speedup, step: 37, train time 11.59 s
Epoch 41/50 |loss: 0.118625| train set 3.293x speedup, test set 5.080x speedup, val set 0.661x speedup, step: 38, train time 11.80 s
Epoch 42/50 |loss: 0.117323| train set 3.332x speedup, test set 5.080x speedup, val set 0.705x speedup, step: 39, train time 11.60 s
Epoch 43/50 |loss: 0.116760| train set 3.359x speedup, test set 5.182x speedup, val set 0.680x speedup, step: 40, train time 12.08 s
Epoch 44/50 |loss: 0.117216| train set 3.318x speedup, test set 5.080x speedup, val set 0.910x speedup, step: 41, train time 11.59 s
Epoch 45/50 |loss: 0.111908| train set 3.399x speedup, test set 5.080x speedup, val set 0.666x speedup, step: 42, train time 12.01 s
Epoch 46/50 |loss: 0.108900| train set 3.407x speedup, test set 5.213x speedup, val set 0.910x speedup, step: 43, train time 11.81 s
Epoch 47/50 |loss: 0.109724| train set 3.297x speedup, test set 5.080x speedup, val set 0.666x speedup, step: 44, train time 12.19 s
Epoch 48/50 |loss: 0.110781| train set 3.388x speedup, test set 5.080x speedup, val set 0.666x speedup, step: 45, train time 12.11 s
Epoch 49/50 |loss: 0.105815| train set 3.517x speedup, test set 5.080x speedup, val set 0.909x speedup, step: 46, train time 12.01 s
Training per epoch cost 11.869 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
12, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
13, opt runtime 7.851s, model runtime 10.810s, pg runtime 13.622s, speedup 1.260x
14, opt runtime 7.442s, model runtime 7.442s, pg runtime 14.838s, speedup 1.994x
15, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
16, opt runtime 6.810s, model runtime 6.810s, pg runtime 13.796s, speedup 2.026x
17, opt runtime 6.460s, model runtime 6.460s, pg runtime 16.134s, speedup 2.498x
18, opt runtime 6.656s, model runtime 6.656s, pg runtime 15.260s, speedup 2.293x
19, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
20, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 49, train speedup 3.517, test speedup 5.080, val speedup 0.909
best test speedup epoch: 14, train speedup 3.316, test speedup 7.007, val speedup 1.107
best validation speedup epoch: 4, train speedup 2.946, test speedup 6.742, val speedup 1.611
last model at epoch 49, train speedup 3.517, test speedup 5.080, val speedup 0.909
execution cost 0:10:36.292344
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.855370, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426341| train set 1.450x speedup, test set 1.295x speedup, val set 1.000x speedup, step: 1, train time 13.10 s
Epoch 1/50 |loss: 0.346212| train set 2.388x speedup, test set 5.035x speedup, val set 0.793x speedup, step: 2, train time 12.29 s
Epoch 2/50 |loss: 0.316785| train set 2.357x speedup, test set 5.035x speedup, val set 1.631x speedup, step: 3, train time 12.21 s
Epoch 3/50 |loss: 0.293999| train set 2.638x speedup, test set 5.981x speedup, val set 1.340x speedup, step: 4, train time 11.80 s
Epoch 4/50 |loss: 0.278301| train set 2.686x speedup, test set 6.189x speedup, val set 1.388x speedup, step: 1, train time 12.01 s
Epoch 5/50 |loss: 0.255290| train set 2.645x speedup, test set 5.981x speedup, val set 0.985x speedup, step: 2, train time 12.07 s
Epoch 6/50 |loss: 0.240366| train set 2.777x speedup, test set 5.981x speedup, val set 0.984x speedup, step: 3, train time 12.30 s
Epoch 7/50 |loss: 0.236423| train set 2.925x speedup, test set 5.981x speedup, val set 0.945x speedup, step: 4, train time 11.78 s
Epoch 8/50 |loss: 0.222882| train set 3.297x speedup, test set 6.189x speedup, val set 0.998x speedup, step: 5, train time 11.79 s
Epoch 9/50 |loss: 0.221830| train set 2.973x speedup, test set 6.189x speedup, val set 1.013x speedup, step: 6, train time 11.79 s
Epoch 10/50 |loss: 0.207639| train set 2.834x speedup, test set 6.189x speedup, val set 0.985x speedup, step: 7, train time 11.40 s
Epoch 11/50 |loss: 0.201553| train set 3.088x speedup, test set 5.182x speedup, val set 1.867x speedup, step: 8, train time 11.68 s
Epoch 12/50 |loss: 0.199498| train set 2.858x speedup, test set 5.080x speedup, val set 0.985x speedup, step: 9, train time 12.09 s
Epoch 13/50 |loss: 0.198889| train set 2.934x speedup, test set 5.080x speedup, val set 0.897x speedup, step: 10, train time 11.80 s
Epoch 14/50 |loss: 0.191476| train set 3.292x speedup, test set 5.080x speedup, val set 0.981x speedup, step: 11, train time 11.50 s
Epoch 15/50 |loss: 0.185308| train set 3.267x speedup, test set 5.080x speedup, val set 0.948x speedup, step: 12, train time 12.08 s
Epoch 16/50 |loss: 0.175657| train set 3.309x speedup, test set 5.080x speedup, val set 0.944x speedup, step: 13, train time 11.59 s
Epoch 17/50 |loss: 0.177947| train set 3.133x speedup, test set 5.155x speedup, val set 1.017x speedup, step: 14, train time 12.01 s
Epoch 18/50 |loss: 0.172990| train set 3.397x speedup, test set 5.080x speedup, val set 0.935x speedup, step: 15, train time 11.82 s
Epoch 19/50 |loss: 0.173795| train set 3.233x speedup, test set 5.080x speedup, val set 0.711x speedup, step: 16, train time 11.60 s
Epoch 20/50 |loss: 0.165339| train set 3.222x speedup, test set 4.881x speedup, val set 0.801x speedup, step: 17, train time 11.61 s
Epoch 21/50 |loss: 0.157901| train set 3.232x speedup, test set 4.881x speedup, val set 0.907x speedup, step: 18, train time 11.72 s
Epoch 22/50 |loss: 0.159057| train set 3.213x speedup, test set 5.080x speedup, val set 0.973x speedup, step: 19, train time 11.90 s
Epoch 23/50 |loss: 0.153430| train set 3.411x speedup, test set 4.881x speedup, val set 0.778x speedup, step: 20, train time 11.51 s
Epoch 24/50 |loss: 0.145346| train set 3.097x speedup, test set 5.080x speedup, val set 0.755x speedup, step: 21, train time 11.67 s
Epoch 25/50 |loss: 0.151285| train set 3.257x speedup, test set 4.881x speedup, val set 0.982x speedup, step: 22, train time 11.52 s
Epoch 26/50 |loss: 0.148864| train set 2.997x speedup, test set 5.080x speedup, val set 0.906x speedup, step: 23, train time 11.70 s
Epoch 27/50 |loss: 0.145508| train set 3.259x speedup, test set 5.080x speedup, val set 0.902x speedup, step: 24, train time 11.70 s
Epoch 28/50 |loss: 0.139957| train set 3.180x speedup, test set 5.080x speedup, val set 0.984x speedup, step: 25, train time 12.19 s
Epoch 29/50 |loss: 0.141854| train set 2.973x speedup, test set 4.881x speedup, val set 0.897x speedup, step: 26, train time 11.91 s
Epoch 30/50 |loss: 0.140634| train set 3.229x speedup, test set 5.080x speedup, val set 1.017x speedup, step: 27, train time 11.51 s
Epoch 31/50 |loss: 0.139282| train set 3.362x speedup, test set 4.881x speedup, val set 0.981x speedup, step: 28, train time 12.09 s
Epoch 32/50 |loss: 0.130580| train set 3.377x speedup, test set 4.881x speedup, val set 0.973x speedup, step: 29, train time 11.60 s
Epoch 33/50 |loss: 0.133107| train set 3.294x speedup, test set 4.881x speedup, val set 1.628x speedup, step: 30, train time 11.88 s
Epoch 34/50 |loss: 0.131166| train set 3.401x speedup, test set 4.881x speedup, val set 1.628x speedup, step: 1, train time 11.80 s
Epoch 35/50 |loss: 0.128295| train set 3.350x speedup, test set 4.881x speedup, val set 0.984x speedup, step: 2, train time 11.39 s
Epoch 36/50 |loss: 0.133273| train set 3.361x speedup, test set 4.881x speedup, val set 0.897x speedup, step: 3, train time 11.98 s
Epoch 37/50 |loss: 0.127654| train set 3.173x speedup, test set 4.881x speedup, val set 1.015x speedup, step: 4, train time 11.68 s
Epoch 38/50 |loss: 0.127022| train set 3.203x speedup, test set 4.881x speedup, val set 0.935x speedup, step: 5, train time 11.78 s
Epoch 39/50 |loss: 0.124429| train set 3.215x speedup, test set 4.881x speedup, val set 1.015x speedup, step: 6, train time 11.98 s
Epoch 40/50 |loss: 0.123387| train set 3.430x speedup, test set 5.155x speedup, val set 1.017x speedup, step: 7, train time 11.48 s
Epoch 41/50 |loss: 0.122186| train set 3.062x speedup, test set 4.881x speedup, val set 0.984x speedup, step: 8, train time 11.77 s
Epoch 42/50 |loss: 0.119305| train set 3.244x speedup, test set 4.881x speedup, val set 0.781x speedup, step: 9, train time 11.72 s
Epoch 43/50 |loss: 0.120314| train set 3.313x speedup, test set 4.881x speedup, val set 1.260x speedup, step: 10, train time 11.79 s
Epoch 44/50 |loss: 0.115855| train set 3.239x speedup, test set 4.881x speedup, val set 0.952x speedup, step: 11, train time 11.40 s
Epoch 45/50 |loss: 0.113799| train set 3.230x speedup, test set 4.881x speedup, val set 0.793x speedup, step: 12, train time 11.39 s
Epoch 46/50 |loss: 0.110505| train set 3.431x speedup, test set 5.080x speedup, val set 1.050x speedup, step: 13, train time 12.00 s
Epoch 47/50 |loss: 0.114020| train set 3.187x speedup, test set 4.881x speedup, val set 0.775x speedup, step: 14, train time 12.01 s
Epoch 48/50 |loss: 0.113825| train set 3.437x speedup, test set 4.881x speedup, val set 1.316x speedup, step: 15, train time 12.11 s
Epoch 49/50 |loss: 0.108908| train set 3.389x speedup, test set 5.080x speedup, val set 1.015x speedup, step: 16, train time 11.62 s
Training per epoch cost 11.823 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 37.631s, pg runtime 17.708s, speedup 0.471x
12, opt runtime 6.284s, model runtime 35.310s, pg runtime 31.019s, speedup 0.878x
13, opt runtime 7.851s, model runtime 62.937s, pg runtime 13.622s, speedup 0.216x
14, opt runtime 7.442s, model runtime 66.854s, pg runtime 14.838s, speedup 0.222x
15, opt runtime 7.110s, model runtime 43.593s, pg runtime 14.286s, speedup 0.328x
16, opt runtime 6.810s, model runtime 46.792s, pg runtime 13.796s, speedup 0.295x
17, opt runtime 6.460s, model runtime 33.108s, pg runtime 16.134s, speedup 0.487x
18, opt runtime 6.656s, model runtime 32.473s, pg runtime 15.260s, speedup 0.470x
19, opt runtime 7.913s, model runtime 43.184s, pg runtime 15.548s, speedup 0.360x
20, opt runtime 7.377s, model runtime 34.672s, pg runtime 28.655s, speedup 0.826x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 48, train speedup 3.437, test speedup 4.881, val speedup 1.316
best test speedup epoch: 4, train speedup 2.686, test speedup 6.189, val speedup 1.388
best validation speedup epoch: 34, train speedup 3.401, test speedup 4.881, val speedup 1.628
last model at epoch 49, train speedup 3.389, test speedup 5.080, val speedup 1.015
execution cost 0:10:33.954607
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.819056, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427100| train set 2.296x speedup, test set 4.730x speedup, val set 0.795x speedup, step: 1, train time 13.19 s
Epoch 1/50 |loss: 0.348644| train set 2.340x speedup, test set 4.756x speedup, val set 1.016x speedup, step: 2, train time 12.90 s
Epoch 2/50 |loss: 0.315631| train set 2.360x speedup, test set 4.756x speedup, val set 1.015x speedup, step: 3, train time 12.20 s
Epoch 3/50 |loss: 0.296709| train set 2.458x speedup, test set 6.023x speedup, val set 1.691x speedup, step: 4, train time 12.28 s
Epoch 4/50 |loss: 0.277332| train set 2.888x speedup, test set 4.756x speedup, val set 1.609x speedup, step: 1, train time 11.91 s
Epoch 5/50 |loss: 0.258899| train set 2.695x speedup, test set 5.981x speedup, val set 1.607x speedup, step: 2, train time 11.79 s
Epoch 6/50 |loss: 0.245093| train set 2.675x speedup, test set 4.886x speedup, val set 1.003x speedup, step: 3, train time 12.11 s
Epoch 7/50 |loss: 0.237951| train set 3.046x speedup, test set 6.189x speedup, val set 0.945x speedup, step: 4, train time 12.02 s
Epoch 8/50 |loss: 0.229298| train set 3.056x speedup, test set 5.182x speedup, val set 0.996x speedup, step: 5, train time 11.80 s
Epoch 9/50 |loss: 0.225462| train set 2.941x speedup, test set 6.950x speedup, val set 0.955x speedup, step: 6, train time 11.89 s
Epoch 10/50 |loss: 0.214371| train set 2.842x speedup, test set 6.950x speedup, val set 1.007x speedup, step: 7, train time 12.29 s
Epoch 11/50 |loss: 0.204407| train set 3.101x speedup, test set 6.189x speedup, val set 1.009x speedup, step: 8, train time 11.89 s
Epoch 12/50 |loss: 0.202203| train set 2.772x speedup, test set 4.859x speedup, val set 0.910x speedup, step: 9, train time 12.20 s
Epoch 13/50 |loss: 0.198480| train set 2.967x speedup, test set 4.859x speedup, val set 0.886x speedup, step: 10, train time 11.70 s
Epoch 14/50 |loss: 0.193398| train set 3.308x speedup, test set 6.234x speedup, val set 1.006x speedup, step: 11, train time 11.90 s
Epoch 15/50 |loss: 0.190238| train set 3.188x speedup, test set 6.234x speedup, val set 0.967x speedup, step: 12, train time 11.79 s
Epoch 16/50 |loss: 0.178377| train set 3.276x speedup, test set 6.234x speedup, val set 0.930x speedup, step: 13, train time 11.87 s
Epoch 17/50 |loss: 0.178554| train set 3.010x speedup, test set 6.189x speedup, val set 0.910x speedup, step: 14, train time 11.51 s
Epoch 18/50 |loss: 0.176726| train set 3.027x speedup, test set 6.234x speedup, val set 0.660x speedup, step: 15, train time 11.90 s
Epoch 19/50 |loss: 0.169607| train set 3.268x speedup, test set 6.189x speedup, val set 1.010x speedup, step: 16, train time 11.89 s
Epoch 20/50 |loss: 0.166285| train set 3.206x speedup, test set 6.234x speedup, val set 0.783x speedup, step: 17, train time 11.71 s
Epoch 21/50 |loss: 0.158791| train set 3.041x speedup, test set 6.189x speedup, val set 1.015x speedup, step: 18, train time 11.99 s
Epoch 22/50 |loss: 0.162772| train set 3.267x speedup, test set 6.189x speedup, val set 0.910x speedup, step: 19, train time 11.90 s
Epoch 23/50 |loss: 0.154685| train set 3.319x speedup, test set 6.189x speedup, val set 0.705x speedup, step: 20, train time 12.00 s
Epoch 24/50 |loss: 0.149610| train set 3.207x speedup, test set 6.189x speedup, val set 1.107x speedup, step: 21, train time 12.31 s
Epoch 25/50 |loss: 0.153120| train set 3.209x speedup, test set 6.189x speedup, val set 0.781x speedup, step: 22, train time 12.03 s
Epoch 26/50 |loss: 0.149551| train set 3.117x speedup, test set 6.189x speedup, val set 0.800x speedup, step: 23, train time 11.91 s
Epoch 27/50 |loss: 0.149584| train set 3.343x speedup, test set 6.234x speedup, val set 0.800x speedup, step: 24, train time 12.80 s
Epoch 28/50 |loss: 0.140793| train set 3.359x speedup, test set 6.189x speedup, val set 1.010x speedup, step: 25, train time 12.61 s
Epoch 29/50 |loss: 0.143106| train set 3.167x speedup, test set 6.189x speedup, val set 0.750x speedup, step: 26, train time 12.70 s
Epoch 30/50 |loss: 0.137873| train set 3.178x speedup, test set 6.189x speedup, val set 1.143x speedup, step: 27, train time 12.19 s
Epoch 31/50 |loss: 0.139975| train set 3.031x speedup, test set 6.189x speedup, val set 0.986x speedup, step: 28, train time 12.32 s
Epoch 32/50 |loss: 0.131868| train set 3.379x speedup, test set 6.189x speedup, val set 1.007x speedup, step: 29, train time 12.40 s
Epoch 33/50 |loss: 0.133251| train set 3.313x speedup, test set 6.189x speedup, val set 0.732x speedup, step: 30, train time 12.09 s
Epoch 34/50 |loss: 0.133452| train set 3.234x speedup, test set 6.189x speedup, val set 0.930x speedup, step: 31, train time 12.09 s
Epoch 35/50 |loss: 0.130486| train set 3.374x speedup, test set 6.189x speedup, val set 0.733x speedup, step: 32, train time 12.48 s
Epoch 36/50 |loss: 0.130203| train set 3.384x speedup, test set 6.189x speedup, val set 0.958x speedup, step: 33, train time 12.49 s
Epoch 37/50 |loss: 0.126306| train set 3.205x speedup, test set 6.189x speedup, val set 0.936x speedup, step: 34, train time 12.10 s
Epoch 38/50 |loss: 0.120812| train set 3.236x speedup, test set 6.189x speedup, val set 0.799x speedup, step: 35, train time 11.88 s
Epoch 39/50 |loss: 0.122805| train set 3.323x speedup, test set 4.881x speedup, val set 0.799x speedup, step: 36, train time 11.41 s
Epoch 40/50 |loss: 0.120804| train set 3.462x speedup, test set 6.189x speedup, val set 1.039x speedup, step: 37, train time 12.09 s
Epoch 41/50 |loss: 0.117952| train set 3.271x speedup, test set 4.881x speedup, val set 0.749x speedup, step: 38, train time 12.37 s
Epoch 42/50 |loss: 0.120226| train set 3.467x speedup, test set 6.189x speedup, val set 0.801x speedup, step: 39, train time 12.10 s
Epoch 43/50 |loss: 0.118874| train set 3.384x speedup, test set 6.189x speedup, val set 0.799x speedup, step: 40, train time 12.51 s
Epoch 44/50 |loss: 0.114482| train set 3.182x speedup, test set 6.189x speedup, val set 0.749x speedup, step: 41, train time 11.70 s
Epoch 45/50 |loss: 0.113177| train set 3.365x speedup, test set 6.189x speedup, val set 0.958x speedup, step: 42, train time 11.70 s
Epoch 46/50 |loss: 0.111749| train set 3.446x speedup, test set 6.189x speedup, val set 1.044x speedup, step: 43, train time 12.10 s
Epoch 47/50 |loss: 0.107508| train set 3.285x speedup, test set 6.189x speedup, val set 0.800x speedup, step: 44, train time 12.09 s
Epoch 48/50 |loss: 0.113299| train set 3.455x speedup, test set 6.189x speedup, val set 1.044x speedup, step: 45, train time 12.20 s
Epoch 49/50 |loss: 0.107681| train set 3.400x speedup, test set 6.189x speedup, val set 0.801x speedup, step: 46, train time 11.70 s
Training per epoch cost 12.100 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 40.999s, pg runtime 17.708s, speedup 0.432x
12, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
13, opt runtime 7.851s, model runtime 48.810s, pg runtime 13.622s, speedup 0.279x
14, opt runtime 7.442s, model runtime 54.724s, pg runtime 14.838s, speedup 0.271x
15, opt runtime 7.110s, model runtime 47.392s, pg runtime 14.286s, speedup 0.301x
16, opt runtime 6.810s, model runtime 41.706s, pg runtime 13.796s, speedup 0.331x
17, opt runtime 6.460s, model runtime 34.333s, pg runtime 16.134s, speedup 0.470x
18, opt runtime 6.656s, model runtime 36.884s, pg runtime 15.260s, speedup 0.414x
19, opt runtime 7.913s, model runtime 52.768s, pg runtime 15.548s, speedup 0.295x
20, opt runtime 7.377s, model runtime 37.574s, pg runtime 28.655s, speedup 0.763x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 42, train speedup 3.467, test speedup 6.189, val speedup 0.801
best test speedup epoch: 9, train speedup 2.941, test speedup 6.950, val speedup 0.955
best validation speedup epoch: 4, train speedup 2.888, test speedup 4.756, val speedup 1.609
last model at epoch 49, train speedup 3.400, test speedup 6.189, val speedup 0.801
execution cost 0:10:49.369537
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.829984, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426312| train set 2.194x speedup, test set 4.730x speedup, val set 0.796x speedup, step: 1, train time 10.85 s
Epoch 1/50 |loss: 0.346672| train set 2.295x speedup, test set 4.730x speedup, val set 0.801x speedup, step: 2, train time 9.98 s
Epoch 2/50 |loss: 0.315814| train set 2.552x speedup, test set 4.730x speedup, val set 1.016x speedup, step: 3, train time 9.02 s
Epoch 3/50 |loss: 0.292316| train set 2.604x speedup, test set 5.035x speedup, val set 0.910x speedup, step: 4, train time 9.09 s
Epoch 4/50 |loss: 0.275414| train set 2.885x speedup, test set 5.035x speedup, val set 1.609x speedup, step: 1, train time 9.19 s
Epoch 5/50 |loss: 0.255383| train set 2.749x speedup, test set 5.035x speedup, val set 1.640x speedup, step: 2, train time 9.18 s
Epoch 6/50 |loss: 0.240468| train set 2.844x speedup, test set 5.035x speedup, val set 0.985x speedup, step: 3, train time 9.29 s
Epoch 7/50 |loss: 0.236880| train set 3.067x speedup, test set 5.182x speedup, val set 0.956x speedup, step: 4, train time 9.31 s
Epoch 8/50 |loss: 0.223831| train set 3.364x speedup, test set 5.182x speedup, val set 1.008x speedup, step: 5, train time 9.41 s
Epoch 9/50 |loss: 0.222132| train set 3.150x speedup, test set 5.035x speedup, val set 0.956x speedup, step: 6, train time 9.71 s
Epoch 10/50 |loss: 0.207694| train set 2.919x speedup, test set 5.035x speedup, val set 1.077x speedup, step: 7, train time 9.09 s
Epoch 11/50 |loss: 0.200643| train set 3.171x speedup, test set 5.182x speedup, val set 0.988x speedup, step: 8, train time 9.40 s
Epoch 12/50 |loss: 0.198896| train set 2.903x speedup, test set 5.182x speedup, val set 0.779x speedup, step: 9, train time 9.33 s
Epoch 13/50 |loss: 0.196193| train set 3.055x speedup, test set 5.035x speedup, val set 0.733x speedup, step: 10, train time 9.10 s
Epoch 14/50 |loss: 0.190223| train set 3.303x speedup, test set 5.182x speedup, val set 1.014x speedup, step: 11, train time 9.20 s
Epoch 15/50 |loss: 0.189613| train set 3.220x speedup, test set 5.182x speedup, val set 0.807x speedup, step: 12, train time 9.02 s
Epoch 16/50 |loss: 0.176782| train set 3.315x speedup, test set 5.182x speedup, val set 0.836x speedup, step: 13, train time 9.21 s
Epoch 17/50 |loss: 0.175824| train set 3.007x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 14, train time 9.10 s
Epoch 18/50 |loss: 0.173061| train set 3.246x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 15, train time 9.40 s
Epoch 19/50 |loss: 0.171054| train set 3.272x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 16, train time 9.13 s
Epoch 20/50 |loss: 0.166441| train set 3.342x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 17, train time 9.40 s
Epoch 21/50 |loss: 0.159835| train set 3.008x speedup, test set 5.208x speedup, val set 0.783x speedup, step: 18, train time 9.39 s
Epoch 22/50 |loss: 0.160126| train set 3.188x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 19, train time 9.40 s
Epoch 23/50 |loss: 0.153453| train set 3.203x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 20, train time 9.40 s
Epoch 24/50 |loss: 0.147923| train set 3.149x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 21, train time 9.49 s
Epoch 25/50 |loss: 0.154062| train set 3.227x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 22, train time 9.19 s
Epoch 26/50 |loss: 0.149636| train set 2.878x speedup, test set 5.182x speedup, val set 0.782x speedup, step: 23, train time 9.38 s
Epoch 27/50 |loss: 0.147364| train set 3.223x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 24, train time 9.21 s
Epoch 28/50 |loss: 0.139731| train set 3.340x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 25, train time 9.20 s
Epoch 29/50 |loss: 0.145544| train set 3.112x speedup, test set 5.182x speedup, val set 0.707x speedup, step: 26, train time 9.02 s
Epoch 30/50 |loss: 0.140983| train set 3.213x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 27, train time 9.28 s
Epoch 31/50 |loss: 0.140336| train set 3.198x speedup, test set 5.182x speedup, val set 0.959x speedup, step: 28, train time 9.00 s
Epoch 32/50 |loss: 0.135569| train set 3.341x speedup, test set 5.182x speedup, val set 0.781x speedup, step: 29, train time 9.22 s
Epoch 33/50 |loss: 0.130997| train set 3.247x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 30, train time 9.10 s
Epoch 34/50 |loss: 0.130520| train set 3.328x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 31, train time 9.21 s
Epoch 35/50 |loss: 0.129386| train set 3.346x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 32, train time 9.09 s
Epoch 36/50 |loss: 0.133232| train set 3.410x speedup, test set 5.182x speedup, val set 0.782x speedup, step: 33, train time 9.10 s
Epoch 37/50 |loss: 0.124068| train set 3.171x speedup, test set 5.182x speedup, val set 0.959x speedup, step: 34, train time 9.10 s
Epoch 38/50 |loss: 0.125632| train set 3.171x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 35, train time 9.13 s
Epoch 39/50 |loss: 0.121269| train set 3.345x speedup, test set 5.213x speedup, val set 0.781x speedup, step: 36, train time 9.30 s
Epoch 40/50 |loss: 0.120958| train set 3.460x speedup, test set 5.182x speedup, val set 0.781x speedup, step: 37, train time 9.21 s
Epoch 41/50 |loss: 0.120619| train set 3.331x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 38, train time 9.20 s
Epoch 42/50 |loss: 0.116782| train set 3.470x speedup, test set 5.182x speedup, val set 0.836x speedup, step: 39, train time 9.11 s
Epoch 43/50 |loss: 0.119951| train set 3.257x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 40, train time 9.31 s
Epoch 44/50 |loss: 0.118138| train set 3.275x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 41, train time 8.93 s
Epoch 45/50 |loss: 0.113148| train set 3.258x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 42, train time 9.22 s
Epoch 46/50 |loss: 0.110240| train set 3.399x speedup, test set 5.182x speedup, val set 0.959x speedup, step: 43, train time 9.10 s
Epoch 47/50 |loss: 0.114958| train set 3.272x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 44, train time 9.10 s
Epoch 48/50 |loss: 0.113724| train set 3.331x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 45, train time 9.10 s
Epoch 49/50 |loss: 0.108671| train set 3.332x speedup, test set 5.182x speedup, val set 0.959x speedup, step: 46, train time 9.51 s
Training per epoch cost 9.268 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 36.429s, pg runtime 17.708s, speedup 0.486x
12, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
13, opt runtime 7.851s, model runtime 30.956s, pg runtime 13.622s, speedup 0.440x
14, opt runtime 7.442s, model runtime 32.816s, pg runtime 14.838s, speedup 0.452x
15, opt runtime 7.110s, model runtime 38.849s, pg runtime 14.286s, speedup 0.368x
16, opt runtime 6.810s, model runtime 39.840s, pg runtime 13.796s, speedup 0.346x
17, opt runtime 6.460s, model runtime 33.445s, pg runtime 16.134s, speedup 0.482x
18, opt runtime 6.656s, model runtime 39.236s, pg runtime 15.260s, speedup 0.389x
19, opt runtime 7.913s, model runtime 32.779s, pg runtime 15.548s, speedup 0.474x
20, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 42, train speedup 3.470, test speedup 5.182, val speedup 0.836
best test speedup epoch: 39, train speedup 3.345, test speedup 5.213, val speedup 0.781
best validation speedup epoch: 4, train speedup 2.885, test speedup 5.035, val speedup 1.609
last model at epoch 49, train speedup 3.332, test speedup 5.182, val speedup 0.959
execution cost 0:08:17.339605
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.792647, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426906| train set 1.469x speedup, test set 4.730x speedup, val set 0.793x speedup, step: 1, train time 10.25 s
Epoch 1/50 |loss: 0.345664| train set 2.282x speedup, test set 1.408x speedup, val set 0.730x speedup, step: 2, train time 9.91 s
Epoch 2/50 |loss: 0.315794| train set 2.376x speedup, test set 5.035x speedup, val set 1.015x speedup, step: 3, train time 9.11 s
Epoch 3/50 |loss: 0.292551| train set 2.576x speedup, test set 5.981x speedup, val set 0.910x speedup, step: 4, train time 9.20 s
Epoch 4/50 |loss: 0.273011| train set 2.749x speedup, test set 5.035x speedup, val set 0.974x speedup, step: 1, train time 9.60 s
Epoch 5/50 |loss: 0.252213| train set 2.892x speedup, test set 5.981x speedup, val set 0.900x speedup, step: 2, train time 9.39 s
Epoch 6/50 |loss: 0.237069| train set 2.580x speedup, test set 6.690x speedup, val set 0.910x speedup, step: 3, train time 9.30 s
Epoch 7/50 |loss: 0.233095| train set 3.218x speedup, test set 5.981x speedup, val set 0.973x speedup, step: 4, train time 9.19 s
Epoch 8/50 |loss: 0.218571| train set 3.264x speedup, test set 6.690x speedup, val set 1.010x speedup, step: 5, train time 9.20 s
Epoch 9/50 |loss: 0.217759| train set 3.120x speedup, test set 6.683x speedup, val set 0.973x speedup, step: 6, train time 9.11 s
Epoch 10/50 |loss: 0.204030| train set 2.931x speedup, test set 6.950x speedup, val set 0.985x speedup, step: 7, train time 9.58 s
Epoch 11/50 |loss: 0.196388| train set 3.270x speedup, test set 6.690x speedup, val set 1.013x speedup, step: 8, train time 9.61 s
Epoch 12/50 |loss: 0.194659| train set 2.949x speedup, test set 4.751x speedup, val set 0.909x speedup, step: 9, train time 9.00 s
Epoch 13/50 |loss: 0.192137| train set 3.023x speedup, test set 4.751x speedup, val set 0.732x speedup, step: 10, train time 9.31 s
Epoch 14/50 |loss: 0.187599| train set 3.306x speedup, test set 6.950x speedup, val set 1.075x speedup, step: 1, train time 9.61 s
Epoch 15/50 |loss: 0.183217| train set 3.132x speedup, test set 7.007x speedup, val set 1.044x speedup, step: 2, train time 9.30 s
Epoch 16/50 |loss: 0.174498| train set 3.110x speedup, test set 6.950x speedup, val set 0.774x speedup, step: 3, train time 9.31 s
Epoch 17/50 |loss: 0.173457| train set 3.218x speedup, test set 4.881x speedup, val set 0.977x speedup, step: 4, train time 9.20 s
Epoch 18/50 |loss: 0.169207| train set 3.242x speedup, test set 5.080x speedup, val set 0.783x speedup, step: 5, train time 9.11 s
Epoch 19/50 |loss: 0.166047| train set 3.208x speedup, test set 5.080x speedup, val set 0.727x speedup, step: 6, train time 9.39 s
Epoch 20/50 |loss: 0.163761| train set 3.153x speedup, test set 5.155x speedup, val set 0.783x speedup, step: 7, train time 9.40 s
Epoch 21/50 |loss: 0.154550| train set 3.039x speedup, test set 5.186x speedup, val set 0.974x speedup, step: 8, train time 8.92 s
Epoch 22/50 |loss: 0.158045| train set 3.298x speedup, test set 5.080x speedup, val set 0.975x speedup, step: 9, train time 9.32 s
Epoch 23/50 |loss: 0.148995| train set 3.384x speedup, test set 5.080x speedup, val set 0.776x speedup, step: 10, train time 9.20 s
Epoch 24/50 |loss: 0.142431| train set 3.134x speedup, test set 6.943x speedup, val set 0.775x speedup, step: 11, train time 9.00 s
Epoch 25/50 |loss: 0.148359| train set 3.164x speedup, test set 5.155x speedup, val set 0.975x speedup, step: 12, train time 9.19 s
Epoch 26/50 |loss: 0.142801| train set 3.031x speedup, test set 6.950x speedup, val set 0.901x speedup, step: 13, train time 9.10 s
Epoch 27/50 |loss: 0.141131| train set 3.412x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 14, train time 9.30 s
Epoch 28/50 |loss: 0.136050| train set 3.279x speedup, test set 5.080x speedup, val set 0.774x speedup, step: 15, train time 9.41 s
Epoch 29/50 |loss: 0.136820| train set 3.290x speedup, test set 5.155x speedup, val set 0.701x speedup, step: 16, train time 9.58 s
Epoch 30/50 |loss: 0.133848| train set 3.162x speedup, test set 5.080x speedup, val set 0.783x speedup, step: 17, train time 9.40 s
Epoch 31/50 |loss: 0.134175| train set 3.216x speedup, test set 5.186x speedup, val set 0.972x speedup, step: 18, train time 9.11 s
Epoch 32/50 |loss: 0.126168| train set 3.319x speedup, test set 5.155x speedup, val set 0.975x speedup, step: 19, train time 9.51 s
Epoch 33/50 |loss: 0.125709| train set 3.283x speedup, test set 5.080x speedup, val set 0.781x speedup, step: 20, train time 9.21 s
Epoch 34/50 |loss: 0.126244| train set 3.273x speedup, test set 5.080x speedup, val set 0.986x speedup, step: 21, train time 9.29 s
Epoch 35/50 |loss: 0.120087| train set 3.402x speedup, test set 5.080x speedup, val set 0.700x speedup, step: 22, train time 9.29 s
Epoch 36/50 |loss: 0.120835| train set 3.278x speedup, test set 5.155x speedup, val set 0.774x speedup, step: 23, train time 9.31 s
Epoch 37/50 |loss: 0.122292| train set 3.335x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 24, train time 9.68 s
Epoch 38/50 |loss: 0.118691| train set 3.161x speedup, test set 5.155x speedup, val set 0.774x speedup, step: 25, train time 9.30 s
Epoch 39/50 |loss: 0.116197| train set 3.213x speedup, test set 5.155x speedup, val set 0.986x speedup, step: 26, train time 9.00 s
Epoch 40/50 |loss: 0.120125| train set 3.455x speedup, test set 5.155x speedup, val set 0.781x speedup, step: 27, train time 9.12 s
Epoch 41/50 |loss: 0.112628| train set 3.284x speedup, test set 5.155x speedup, val set 0.701x speedup, step: 28, train time 9.30 s
Epoch 42/50 |loss: 0.115141| train set 3.448x speedup, test set 5.155x speedup, val set 0.781x speedup, step: 29, train time 9.59 s
Epoch 43/50 |loss: 0.112937| train set 3.395x speedup, test set 5.155x speedup, val set 0.783x speedup, step: 30, train time 9.11 s
Epoch 44/50 |loss: 0.113600| train set 3.191x speedup, test set 5.155x speedup, val set 0.776x speedup, step: 31, train time 9.21 s
Epoch 45/50 |loss: 0.103366| train set 3.247x speedup, test set 5.155x speedup, val set 0.700x speedup, step: 32, train time 9.19 s
Epoch 46/50 |loss: 0.108222| train set 3.328x speedup, test set 5.181x speedup, val set 0.698x speedup, step: 33, train time 9.32 s
Epoch 47/50 |loss: 0.107151| train set 3.265x speedup, test set 5.155x speedup, val set 0.781x speedup, step: 34, train time 9.40 s
Epoch 48/50 |loss: 0.108252| train set 3.426x speedup, test set 5.186x speedup, val set 0.781x speedup, step: 35, train time 9.20 s
Epoch 49/50 |loss: 0.106155| train set 3.417x speedup, test set 5.155x speedup, val set 0.781x speedup, step: 36, train time 9.30 s
Training per epoch cost 9.318 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
12, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
13, opt runtime 7.851s, model runtime 10.810s, pg runtime 13.622s, speedup 1.260x
14, opt runtime 7.442s, model runtime 7.442s, pg runtime 14.838s, speedup 1.994x
15, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
16, opt runtime 6.810s, model runtime 6.810s, pg runtime 13.796s, speedup 2.026x
17, opt runtime 6.460s, model runtime 6.460s, pg runtime 16.134s, speedup 2.498x
18, opt runtime 6.656s, model runtime 6.656s, pg runtime 15.260s, speedup 2.293x
19, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
20, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 40, train speedup 3.455, test speedup 5.155, val speedup 0.781
best test speedup epoch: 15, train speedup 3.132, test speedup 7.007, val speedup 1.044
best validation speedup epoch: 14, train speedup 3.306, test speedup 6.950, val speedup 1.075
last model at epoch 49, train speedup 3.417, test speedup 5.155, val speedup 0.781
execution cost 0:08:19.569274
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.802072, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426337| train set 1.433x speedup, test set 0.847x speedup, val set 0.793x speedup, step: 1, train time 10.59 s
Epoch 1/50 |loss: 0.348187| train set 2.429x speedup, test set 0.894x speedup, val set 0.903x speedup, step: 2, train time 10.10 s
Epoch 2/50 |loss: 0.317131| train set 2.356x speedup, test set 5.035x speedup, val set 1.691x speedup, step: 3, train time 9.29 s
Epoch 3/50 |loss: 0.294672| train set 2.587x speedup, test set 0.856x speedup, val set 0.903x speedup, step: 4, train time 9.80 s
Epoch 4/50 |loss: 0.276331| train set 2.806x speedup, test set 6.683x speedup, val set 1.770x speedup, step: 1, train time 9.40 s
Epoch 5/50 |loss: 0.256588| train set 2.751x speedup, test set 5.981x speedup, val set 0.985x speedup, step: 2, train time 9.30 s
Epoch 6/50 |loss: 0.241135| train set 2.739x speedup, test set 4.730x speedup, val set 1.637x speedup, step: 3, train time 9.49 s
Epoch 7/50 |loss: 0.235270| train set 3.075x speedup, test set 0.856x speedup, val set 0.984x speedup, step: 4, train time 9.19 s
Epoch 8/50 |loss: 0.224227| train set 3.131x speedup, test set 6.023x speedup, val set 1.008x speedup, step: 5, train time 9.28 s
Epoch 9/50 |loss: 0.219479| train set 3.019x speedup, test set 6.189x speedup, val set 0.956x speedup, step: 6, train time 9.30 s
Epoch 10/50 |loss: 0.205788| train set 2.724x speedup, test set 0.884x speedup, val set 0.956x speedup, step: 7, train time 9.21 s
Epoch 11/50 |loss: 0.200691| train set 3.353x speedup, test set 6.234x speedup, val set 1.013x speedup, step: 8, train time 9.40 s
Epoch 12/50 |loss: 0.197495| train set 2.806x speedup, test set 0.856x speedup, val set 0.935x speedup, step: 9, train time 9.40 s
Epoch 13/50 |loss: 0.194893| train set 3.128x speedup, test set 0.860x speedup, val set 1.142x speedup, step: 10, train time 9.30 s
Epoch 14/50 |loss: 0.189710| train set 3.189x speedup, test set 5.208x speedup, val set 1.002x speedup, step: 11, train time 9.38 s
Epoch 15/50 |loss: 0.183479| train set 3.228x speedup, test set 5.213x speedup, val set 1.906x speedup, step: 12, train time 9.89 s
Epoch 16/50 |loss: 0.175333| train set 3.350x speedup, test set 5.182x speedup, val set 0.836x speedup, step: 13, train time 9.21 s
Epoch 17/50 |loss: 0.175137| train set 2.877x speedup, test set 6.189x speedup, val set 0.850x speedup, step: 14, train time 9.41 s
Epoch 18/50 |loss: 0.169599| train set 3.224x speedup, test set 6.234x speedup, val set 1.002x speedup, step: 15, train time 9.09 s
Epoch 19/50 |loss: 0.166643| train set 3.153x speedup, test set 6.234x speedup, val set 1.029x speedup, step: 16, train time 9.40 s
Epoch 20/50 |loss: 0.163746| train set 3.219x speedup, test set 5.182x speedup, val set 0.850x speedup, step: 17, train time 9.21 s
Epoch 21/50 |loss: 0.156096| train set 3.189x speedup, test set 5.213x speedup, val set 0.984x speedup, step: 18, train time 9.11 s
Epoch 22/50 |loss: 0.160108| train set 3.248x speedup, test set 6.189x speedup, val set 1.063x speedup, step: 19, train time 9.30 s
Epoch 23/50 |loss: 0.151780| train set 3.360x speedup, test set 5.182x speedup, val set 1.267x speedup, step: 20, train time 9.38 s
Epoch 24/50 |loss: 0.144715| train set 3.050x speedup, test set 5.213x speedup, val set 0.761x speedup, step: 21, train time 10.71 s
Epoch 25/50 |loss: 0.149607| train set 3.288x speedup, test set 5.213x speedup, val set 1.264x speedup, step: 22, train time 10.09 s
Epoch 26/50 |loss: 0.147541| train set 2.992x speedup, test set 6.189x speedup, val set 0.956x speedup, step: 23, train time 9.40 s
Epoch 27/50 |loss: 0.143643| train set 3.268x speedup, test set 5.208x speedup, val set 1.319x speedup, step: 24, train time 11.58 s
Epoch 28/50 |loss: 0.139136| train set 3.192x speedup, test set 5.182x speedup, val set 1.316x speedup, step: 25, train time 10.91 s
Epoch 29/50 |loss: 0.139661| train set 3.017x speedup, test set 5.182x speedup, val set 0.761x speedup, step: 26, train time 9.79 s
Epoch 30/50 |loss: 0.134309| train set 3.159x speedup, test set 5.213x speedup, val set 0.837x speedup, step: 27, train time 9.71 s
Epoch 31/50 |loss: 0.137514| train set 3.176x speedup, test set 6.234x speedup, val set 1.267x speedup, step: 28, train time 9.12 s
Epoch 32/50 |loss: 0.130393| train set 3.316x speedup, test set 6.189x speedup, val set 1.063x speedup, step: 29, train time 9.48 s
Epoch 33/50 |loss: 0.129711| train set 3.345x speedup, test set 4.881x speedup, val set 0.859x speedup, step: 30, train time 9.40 s
Epoch 34/50 |loss: 0.127346| train set 3.341x speedup, test set 4.908x speedup, val set 0.837x speedup, step: 31, train time 9.30 s
Epoch 35/50 |loss: 0.122489| train set 3.295x speedup, test set 4.904x speedup, val set 0.873x speedup, step: 32, train time 9.31 s
Epoch 36/50 |loss: 0.126848| train set 3.367x speedup, test set 4.881x speedup, val set 0.873x speedup, step: 33, train time 9.58 s
Epoch 37/50 |loss: 0.126616| train set 3.135x speedup, test set 4.881x speedup, val set 0.859x speedup, step: 34, train time 9.20 s
Epoch 38/50 |loss: 0.124183| train set 3.214x speedup, test set 6.189x speedup, val set 0.859x speedup, step: 35, train time 9.11 s
Epoch 39/50 |loss: 0.120189| train set 3.383x speedup, test set 4.881x speedup, val set 0.849x speedup, step: 36, train time 9.02 s
Epoch 40/50 |loss: 0.123252| train set 3.470x speedup, test set 4.881x speedup, val set 1.264x speedup, step: 37, train time 9.33 s
Epoch 41/50 |loss: 0.119811| train set 3.207x speedup, test set 4.881x speedup, val set 0.873x speedup, step: 38, train time 9.21 s
Epoch 42/50 |loss: 0.114448| train set 3.476x speedup, test set 4.908x speedup, val set 0.836x speedup, step: 39, train time 9.00 s
Epoch 43/50 |loss: 0.117217| train set 3.361x speedup, test set 4.881x speedup, val set 1.319x speedup, step: 40, train time 9.20 s
Epoch 44/50 |loss: 0.116194| train set 3.303x speedup, test set 4.881x speedup, val set 1.319x speedup, step: 41, train time 9.23 s
Epoch 45/50 |loss: 0.108495| train set 3.226x speedup, test set 4.881x speedup, val set 1.267x speedup, step: 42, train time 9.12 s
Epoch 46/50 |loss: 0.109466| train set 3.408x speedup, test set 4.881x speedup, val set 0.779x speedup, step: 43, train time 9.10 s
Epoch 47/50 |loss: 0.106620| train set 3.251x speedup, test set 4.881x speedup, val set 0.873x speedup, step: 44, train time 9.40 s
Epoch 48/50 |loss: 0.114924| train set 3.378x speedup, test set 4.881x speedup, val set 0.776x speedup, step: 45, train time 9.00 s
Epoch 49/50 |loss: 0.105914| train set 3.486x speedup, test set 4.881x speedup, val set 1.267x speedup, step: 46, train time 9.11 s
Training per epoch cost 9.476 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 8.427s, pg runtime 17.708s, speedup 2.101x
12, opt runtime 6.284s, model runtime 7.202s, pg runtime 31.019s, speedup 4.307x
13, opt runtime 7.851s, model runtime 7.851s, pg runtime 13.622s, speedup 1.735x
14, opt runtime 7.442s, model runtime 8.035s, pg runtime 14.838s, speedup 1.847x
15, opt runtime 7.110s, model runtime 7.841s, pg runtime 14.286s, speedup 1.822x
16, opt runtime 6.810s, model runtime 7.859s, pg runtime 13.796s, speedup 1.755x
17, opt runtime 6.460s, model runtime 7.335s, pg runtime 16.134s, speedup 2.200x
18, opt runtime 6.656s, model runtime 7.351s, pg runtime 15.260s, speedup 2.076x
19, opt runtime 7.913s, model runtime 7.913s, pg runtime 15.548s, speedup 1.965x
20, opt runtime 7.377s, model runtime 7.377s, pg runtime 28.655s, speedup 3.885x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 49, train speedup 3.486, test speedup 4.881, val speedup 1.267
best test speedup epoch: 4, train speedup 2.806, test speedup 6.683, val speedup 1.770
best validation speedup epoch: 4, train speedup 2.806, test speedup 6.683, val speedup 1.770
last model at epoch 49, train speedup 3.486, test speedup 4.881, val speedup 1.267
execution cost 0:08:27.548188
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.807123, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427009| train set 2.352x speedup, test set 0.847x speedup, val set 0.796x speedup, step: 1, train time 10.56 s
Epoch 1/50 |loss: 0.345916| train set 2.399x speedup, test set 5.001x speedup, val set 0.801x speedup, step: 2, train time 9.79 s
Epoch 2/50 |loss: 0.318522| train set 2.488x speedup, test set 5.035x speedup, val set 1.035x speedup, step: 3, train time 9.18 s
Epoch 3/50 |loss: 0.294042| train set 2.479x speedup, test set 5.035x speedup, val set 0.916x speedup, step: 4, train time 9.10 s
Epoch 4/50 |loss: 0.277600| train set 2.639x speedup, test set 5.035x speedup, val set 1.004x speedup, step: 1, train time 9.10 s
Epoch 5/50 |loss: 0.254685| train set 2.734x speedup, test set 5.981x speedup, val set 0.926x speedup, step: 2, train time 9.09 s
Epoch 6/50 |loss: 0.240682| train set 2.825x speedup, test set 6.943x speedup, val set 0.926x speedup, step: 3, train time 9.09 s
Epoch 7/50 |loss: 0.234433| train set 3.147x speedup, test set 6.943x speedup, val set 0.877x speedup, step: 4, train time 9.18 s
Epoch 8/50 |loss: 0.223731| train set 3.338x speedup, test set 5.182x speedup, val set 0.944x speedup, step: 5, train time 9.19 s
Epoch 9/50 |loss: 0.221842| train set 3.098x speedup, test set 6.943x speedup, val set 0.900x speedup, step: 6, train time 9.30 s
Epoch 10/50 |loss: 0.205458| train set 2.701x speedup, test set 5.190x speedup, val set 0.983x speedup, step: 7, train time 9.40 s
Epoch 11/50 |loss: 0.200409| train set 3.173x speedup, test set 5.182x speedup, val set 0.910x speedup, step: 8, train time 9.32 s
Epoch 12/50 |loss: 0.199273| train set 3.014x speedup, test set 5.080x speedup, val set 0.902x speedup, step: 9, train time 9.30 s
Epoch 13/50 |loss: 0.197360| train set 3.020x speedup, test set 4.881x speedup, val set 0.877x speedup, step: 10, train time 9.31 s
Epoch 14/50 |loss: 0.190899| train set 3.304x speedup, test set 5.080x speedup, val set 0.901x speedup, step: 11, train time 9.12 s
Epoch 15/50 |loss: 0.186288| train set 3.287x speedup, test set 5.080x speedup, val set 0.852x speedup, step: 12, train time 9.29 s
Epoch 16/50 |loss: 0.176179| train set 3.071x speedup, test set 5.080x speedup, val set 0.999x speedup, step: 13, train time 9.51 s
Epoch 17/50 |loss: 0.173874| train set 3.026x speedup, test set 5.080x speedup, val set 0.909x speedup, step: 14, train time 9.30 s
Epoch 18/50 |loss: 0.172163| train set 3.107x speedup, test set 5.080x speedup, val set 0.901x speedup, step: 15, train time 9.31 s
Epoch 19/50 |loss: 0.173812| train set 3.153x speedup, test set 5.182x speedup, val set 0.901x speedup, step: 16, train time 9.41 s
Epoch 20/50 |loss: 0.163974| train set 3.220x speedup, test set 4.881x speedup, val set 0.910x speedup, step: 17, train time 9.31 s
Epoch 21/50 |loss: 0.159556| train set 2.905x speedup, test set 5.182x speedup, val set 0.910x speedup, step: 18, train time 9.41 s
Epoch 22/50 |loss: 0.159815| train set 3.189x speedup, test set 5.182x speedup, val set 0.901x speedup, step: 19, train time 9.01 s
Epoch 23/50 |loss: 0.153584| train set 3.344x speedup, test set 5.182x speedup, val set 0.666x speedup, step: 20, train time 8.92 s
Epoch 24/50 |loss: 0.144136| train set 3.174x speedup, test set 4.881x speedup, val set 0.977x speedup, step: 21, train time 9.20 s
Epoch 25/50 |loss: 0.150191| train set 3.240x speedup, test set 5.080x speedup, val set 0.727x speedup, step: 22, train time 9.21 s
Epoch 26/50 |loss: 0.146407| train set 2.868x speedup, test set 5.155x speedup, val set 0.877x speedup, step: 23, train time 9.10 s
Epoch 27/50 |loss: 0.146508| train set 3.289x speedup, test set 5.080x speedup, val set 0.901x speedup, step: 24, train time 9.30 s
Epoch 28/50 |loss: 0.138954| train set 3.220x speedup, test set 5.182x speedup, val set 0.666x speedup, step: 25, train time 9.10 s
Epoch 29/50 |loss: 0.143687| train set 3.113x speedup, test set 5.080x speedup, val set 0.661x speedup, step: 26, train time 9.39 s
Epoch 30/50 |loss: 0.136275| train set 3.323x speedup, test set 5.080x speedup, val set 0.886x speedup, step: 27, train time 9.11 s
Epoch 31/50 |loss: 0.141481| train set 3.340x speedup, test set 4.881x speedup, val set 0.706x speedup, step: 28, train time 8.90 s
Epoch 32/50 |loss: 0.127990| train set 3.278x speedup, test set 5.182x speedup, val set 0.886x speedup, step: 29, train time 9.01 s
Epoch 33/50 |loss: 0.128736| train set 3.330x speedup, test set 4.881x speedup, val set 0.886x speedup, step: 30, train time 9.32 s
Epoch 34/50 |loss: 0.130576| train set 3.346x speedup, test set 5.182x speedup, val set 1.013x speedup, step: 1, train time 9.29 s
Epoch 35/50 |loss: 0.127599| train set 3.358x speedup, test set 5.080x speedup, val set 0.959x speedup, step: 2, train time 9.10 s
Epoch 36/50 |loss: 0.129430| train set 3.350x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 3, train time 9.40 s
Epoch 37/50 |loss: 0.123410| train set 3.110x speedup, test set 5.080x speedup, val set 0.959x speedup, step: 4, train time 9.20 s
Epoch 38/50 |loss: 0.124583| train set 3.058x speedup, test set 5.182x speedup, val set 0.733x speedup, step: 5, train time 9.32 s
Epoch 39/50 |loss: 0.120138| train set 3.338x speedup, test set 4.881x speedup, val set 0.986x speedup, step: 6, train time 9.30 s
Epoch 40/50 |loss: 0.122488| train set 3.445x speedup, test set 5.080x speedup, val set 0.781x speedup, step: 7, train time 9.11 s
Epoch 41/50 |loss: 0.122329| train set 3.324x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 8, train time 9.31 s
Epoch 42/50 |loss: 0.115133| train set 3.471x speedup, test set 5.080x speedup, val set 0.957x speedup, step: 9, train time 9.31 s
Epoch 43/50 |loss: 0.116073| train set 3.395x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 10, train time 9.20 s
Epoch 44/50 |loss: 0.115285| train set 3.293x speedup, test set 5.080x speedup, val set 0.910x speedup, step: 11, train time 9.41 s
Epoch 45/50 |loss: 0.108728| train set 3.236x speedup, test set 5.080x speedup, val set 0.783x speedup, step: 12, train time 9.20 s
Epoch 46/50 |loss: 0.110091| train set 3.169x speedup, test set 5.155x speedup, val set 0.707x speedup, step: 13, train time 9.01 s
Epoch 47/50 |loss: 0.110183| train set 3.240x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 14, train time 9.29 s
Epoch 48/50 |loss: 0.111666| train set 3.430x speedup, test set 5.110x speedup, val set 0.783x speedup, step: 15, train time 9.10 s
Epoch 49/50 |loss: 0.106846| train set 3.493x speedup, test set 5.080x speedup, val set 0.733x speedup, step: 16, train time 9.20 s
Training per epoch cost 9.257 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 36.429s, pg runtime 17.708s, speedup 0.486x
12, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
13, opt runtime 7.851s, model runtime 30.956s, pg runtime 13.622s, speedup 0.440x
14, opt runtime 7.442s, model runtime 32.816s, pg runtime 14.838s, speedup 0.452x
15, opt runtime 7.110s, model runtime 38.849s, pg runtime 14.286s, speedup 0.368x
16, opt runtime 6.810s, model runtime 39.840s, pg runtime 13.796s, speedup 0.346x
17, opt runtime 6.460s, model runtime 33.445s, pg runtime 16.134s, speedup 0.482x
18, opt runtime 6.656s, model runtime 39.236s, pg runtime 15.260s, speedup 0.389x
19, opt runtime 7.913s, model runtime 32.779s, pg runtime 15.548s, speedup 0.474x
20, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 49, train speedup 3.493, test speedup 5.080, val speedup 0.733
best test speedup epoch: 6, train speedup 2.825, test speedup 6.943, val speedup 0.926
best validation speedup epoch: 34, train speedup 3.346, test speedup 5.182, val speedup 1.013
last model at epoch 49, train speedup 3.493, test speedup 5.080, val speedup 0.733
execution cost 0:08:17.386244
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.825997, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426902| train set 1.500x speedup, test set 0.847x speedup, val set 0.793x speedup, step: 1, train time 10.61 s
Epoch 1/50 |loss: 0.346569| train set 2.444x speedup, test set 0.847x speedup, val set 0.890x speedup, step: 2, train time 9.71 s
Epoch 2/50 |loss: 0.315357| train set 2.409x speedup, test set 5.035x speedup, val set 0.936x speedup, step: 3, train time 9.49 s
Epoch 3/50 |loss: 0.292620| train set 2.745x speedup, test set 5.035x speedup, val set 0.891x speedup, step: 4, train time 9.41 s
Epoch 4/50 |loss: 0.274283| train set 2.922x speedup, test set 1.317x speedup, val set 0.901x speedup, step: 1, train time 9.59 s
Epoch 5/50 |loss: 0.255993| train set 2.754x speedup, test set 5.035x speedup, val set 0.936x speedup, step: 2, train time 9.02 s
Epoch 6/50 |loss: 0.238076| train set 2.568x speedup, test set 5.065x speedup, val set 0.926x speedup, step: 3, train time 9.50 s
Epoch 7/50 |loss: 0.235156| train set 2.925x speedup, test set 1.327x speedup, val set 0.901x speedup, step: 4, train time 9.20 s
Epoch 8/50 |loss: 0.222967| train set 3.247x speedup, test set 0.856x speedup, val set 1.007x speedup, step: 5, train time 9.41 s
Epoch 9/50 |loss: 0.222765| train set 3.096x speedup, test set 5.035x speedup, val set 0.985x speedup, step: 1, train time 9.50 s
Epoch 10/50 |loss: 0.208540| train set 2.826x speedup, test set 0.860x speedup, val set 1.008x speedup, step: 2, train time 9.30 s
Epoch 11/50 |loss: 0.200183| train set 3.200x speedup, test set 5.065x speedup, val set 0.909x speedup, step: 3, train time 9.31 s
Epoch 12/50 |loss: 0.198745| train set 2.638x speedup, test set 0.860x speedup, val set 0.925x speedup, step: 4, train time 9.69 s
Epoch 13/50 |loss: 0.197011| train set 3.203x speedup, test set 5.065x speedup, val set 0.910x speedup, step: 5, train time 9.19 s
Epoch 14/50 |loss: 0.190538| train set 3.274x speedup, test set 5.213x speedup, val set 0.923x speedup, step: 6, train time 9.43 s
Epoch 15/50 |loss: 0.184893| train set 3.275x speedup, test set 5.065x speedup, val set 1.004x speedup, step: 7, train time 8.89 s
Epoch 16/50 |loss: 0.177357| train set 3.276x speedup, test set 5.213x speedup, val set 0.947x speedup, step: 8, train time 9.41 s
Epoch 17/50 |loss: 0.177840| train set 2.829x speedup, test set 5.182x speedup, val set 0.897x speedup, step: 9, train time 9.47 s
Epoch 18/50 |loss: 0.171672| train set 3.175x speedup, test set 0.860x speedup, val set 0.900x speedup, step: 10, train time 9.40 s
Epoch 19/50 |loss: 0.173263| train set 3.323x speedup, test set 5.182x speedup, val set 0.922x speedup, step: 11, train time 9.69 s
Epoch 20/50 |loss: 0.165679| train set 3.164x speedup, test set 5.035x speedup, val set 0.948x speedup, step: 12, train time 9.39 s
Epoch 21/50 |loss: 0.160369| train set 3.239x speedup, test set 5.065x speedup, val set 0.877x speedup, step: 13, train time 9.32 s
Epoch 22/50 |loss: 0.162992| train set 3.308x speedup, test set 5.213x speedup, val set 0.875x speedup, step: 14, train time 9.69 s
Epoch 23/50 |loss: 0.154498| train set 3.157x speedup, test set 5.182x speedup, val set 0.653x speedup, step: 15, train time 9.49 s
Epoch 24/50 |loss: 0.146147| train set 2.778x speedup, test set 5.213x speedup, val set 0.701x speedup, step: 16, train time 9.41 s
Epoch 25/50 |loss: 0.153287| train set 3.227x speedup, test set 5.213x speedup, val set 0.975x speedup, step: 17, train time 9.69 s
Epoch 26/50 |loss: 0.149382| train set 3.011x speedup, test set 5.182x speedup, val set 0.877x speedup, step: 18, train time 9.12 s
Epoch 27/50 |loss: 0.146720| train set 3.169x speedup, test set 5.182x speedup, val set 0.888x speedup, step: 19, train time 9.41 s
Epoch 28/50 |loss: 0.140290| train set 3.238x speedup, test set 5.065x speedup, val set 0.908x speedup, step: 20, train time 9.30 s
Epoch 29/50 |loss: 0.144348| train set 3.285x speedup, test set 5.213x speedup, val set 0.888x speedup, step: 21, train time 9.89 s
Epoch 30/50 |loss: 0.139595| train set 3.281x speedup, test set 5.213x speedup, val set 0.863x speedup, step: 22, train time 9.41 s
Epoch 31/50 |loss: 0.137943| train set 3.331x speedup, test set 5.208x speedup, val set 0.975x speedup, step: 23, train time 9.60 s
Epoch 32/50 |loss: 0.132272| train set 3.365x speedup, test set 5.213x speedup, val set 0.863x speedup, step: 24, train time 9.29 s
Epoch 33/50 |loss: 0.132348| train set 3.272x speedup, test set 5.182x speedup, val set 0.863x speedup, step: 25, train time 9.59 s
Epoch 34/50 |loss: 0.129218| train set 3.410x speedup, test set 5.182x speedup, val set 0.975x speedup, step: 26, train time 9.39 s
Epoch 35/50 |loss: 0.127544| train set 3.281x speedup, test set 5.182x speedup, val set 0.693x speedup, step: 27, train time 9.29 s
Epoch 36/50 |loss: 0.132210| train set 3.332x speedup, test set 5.182x speedup, val set 0.653x speedup, step: 28, train time 9.40 s
Epoch 37/50 |loss: 0.126728| train set 3.346x speedup, test set 5.213x speedup, val set 1.006x speedup, step: 29, train time 10.00 s
Epoch 38/50 |loss: 0.127158| train set 3.212x speedup, test set 5.182x speedup, val set 0.688x speedup, step: 30, train time 9.50 s
Epoch 39/50 |loss: 0.123303| train set 3.323x speedup, test set 5.213x speedup, val set 0.947x speedup, step: 31, train time 9.51 s
Epoch 40/50 |loss: 0.124544| train set 3.415x speedup, test set 5.213x speedup, val set 0.974x speedup, step: 32, train time 10.10 s
Epoch 41/50 |loss: 0.120822| train set 3.153x speedup, test set 5.213x speedup, val set 0.653x speedup, step: 33, train time 9.80 s
Epoch 42/50 |loss: 0.118669| train set 3.481x speedup, test set 5.213x speedup, val set 0.947x speedup, step: 34, train time 10.42 s
Epoch 43/50 |loss: 0.119621| train set 3.359x speedup, test set 5.182x speedup, val set 0.692x speedup, step: 35, train time 9.22 s
Epoch 44/50 |loss: 0.115126| train set 3.187x speedup, test set 5.182x speedup, val set 0.991x speedup, step: 1, train time 9.57 s
Epoch 45/50 |loss: 0.111282| train set 3.402x speedup, test set 5.182x speedup, val set 0.700x speedup, step: 2, train time 9.28 s
Epoch 46/50 |loss: 0.109978| train set 3.423x speedup, test set 5.213x speedup, val set 0.975x speedup, step: 3, train time 9.59 s
Epoch 47/50 |loss: 0.110965| train set 3.285x speedup, test set 5.213x speedup, val set 0.932x speedup, step: 4, train time 9.48 s
Epoch 48/50 |loss: 0.111696| train set 3.315x speedup, test set 5.213x speedup, val set 1.000x speedup, step: 5, train time 9.71 s
Epoch 49/50 |loss: 0.110883| train set 3.428x speedup, test set 5.213x speedup, val set 0.974x speedup, step: 6, train time 9.62 s
Training per epoch cost 9.514 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 36.429s, pg runtime 17.708s, speedup 0.486x
12, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
13, opt runtime 7.851s, model runtime 30.956s, pg runtime 13.622s, speedup 0.440x
14, opt runtime 7.442s, model runtime 32.816s, pg runtime 14.838s, speedup 0.452x
15, opt runtime 7.110s, model runtime 38.849s, pg runtime 14.286s, speedup 0.368x
16, opt runtime 6.810s, model runtime 39.840s, pg runtime 13.796s, speedup 0.346x
17, opt runtime 6.460s, model runtime 33.445s, pg runtime 16.134s, speedup 0.482x
18, opt runtime 6.656s, model runtime 39.236s, pg runtime 15.260s, speedup 0.389x
19, opt runtime 7.913s, model runtime 32.779s, pg runtime 15.548s, speedup 0.474x
20, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 42, train speedup 3.481, test speedup 5.213, val speedup 0.947
best test speedup epoch: 14, train speedup 3.274, test speedup 5.213, val speedup 0.923
best validation speedup epoch: 44, train speedup 3.187, test speedup 5.182, val speedup 0.991
last model at epoch 49, train speedup 3.428, test speedup 5.213, val speedup 0.974
execution cost 0:08:29.916215
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.795733, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426046| train set 2.297x speedup, test set 0.847x speedup, val set 0.812x speedup, step: 1, train time 10.82 s
Epoch 1/50 |loss: 0.346264| train set 2.072x speedup, test set 0.920x speedup, val set 0.801x speedup, step: 2, train time 9.99 s
Epoch 2/50 |loss: 0.312939| train set 2.369x speedup, test set 5.981x speedup, val set 1.015x speedup, step: 3, train time 9.48 s
Epoch 3/50 |loss: 0.291587| train set 2.622x speedup, test set 5.981x speedup, val set 1.035x speedup, step: 4, train time 9.40 s
Epoch 4/50 |loss: 0.274144| train set 2.832x speedup, test set 5.981x speedup, val set 1.064x speedup, step: 1, train time 9.68 s
Epoch 5/50 |loss: 0.253435| train set 2.770x speedup, test set 6.189x speedup, val set 1.016x speedup, step: 2, train time 9.21 s
Epoch 6/50 |loss: 0.240353| train set 2.618x speedup, test set 6.189x speedup, val set 1.016x speedup, step: 3, train time 9.70 s
Epoch 7/50 |loss: 0.233601| train set 3.188x speedup, test set 6.189x speedup, val set 1.003x speedup, step: 4, train time 9.60 s
Epoch 8/50 |loss: 0.223206| train set 3.151x speedup, test set 6.189x speedup, val set 0.714x speedup, step: 5, train time 9.48 s
Epoch 9/50 |loss: 0.220416| train set 3.246x speedup, test set 6.189x speedup, val set 1.002x speedup, step: 6, train time 9.40 s
Epoch 10/50 |loss: 0.206405| train set 2.856x speedup, test set 6.189x speedup, val set 0.956x speedup, step: 7, train time 9.20 s
Epoch 11/50 |loss: 0.200632| train set 3.263x speedup, test set 6.189x speedup, val set 1.010x speedup, step: 8, train time 9.40 s
Epoch 12/50 |loss: 0.200309| train set 3.155x speedup, test set 6.189x speedup, val set 0.985x speedup, step: 9, train time 9.61 s
Epoch 13/50 |loss: 0.195073| train set 2.961x speedup, test set 0.964x speedup, val set 0.792x speedup, step: 10, train time 9.60 s
Epoch 14/50 |loss: 0.191108| train set 3.305x speedup, test set 1.385x speedup, val set 0.956x speedup, step: 11, train time 9.50 s
Epoch 15/50 |loss: 0.187437| train set 3.342x speedup, test set 6.189x speedup, val set 0.792x speedup, step: 12, train time 9.29 s
Epoch 16/50 |loss: 0.175184| train set 3.350x speedup, test set 1.499x speedup, val set 1.127x speedup, step: 13, train time 9.20 s
Epoch 17/50 |loss: 0.175906| train set 2.801x speedup, test set 0.884x speedup, val set 0.709x speedup, step: 14, train time 9.41 s
Epoch 18/50 |loss: 0.173464| train set 2.981x speedup, test set 6.189x speedup, val set 0.792x speedup, step: 15, train time 9.61 s
Epoch 19/50 |loss: 0.166745| train set 3.293x speedup, test set 6.189x speedup, val set 0.710x speedup, step: 16, train time 10.30 s
Epoch 20/50 |loss: 0.165532| train set 3.169x speedup, test set 0.884x speedup, val set 0.792x speedup, step: 17, train time 9.80 s
Epoch 21/50 |loss: 0.159145| train set 3.036x speedup, test set 6.189x speedup, val set 0.661x speedup, step: 18, train time 10.70 s
Epoch 22/50 |loss: 0.159653| train set 3.315x speedup, test set 6.189x speedup, val set 0.727x speedup, step: 19, train time 9.60 s
Epoch 23/50 |loss: 0.150160| train set 3.354x speedup, test set 1.499x speedup, val set 0.774x speedup, step: 20, train time 9.08 s
Epoch 24/50 |loss: 0.142760| train set 3.097x speedup, test set 0.884x speedup, val set 0.774x speedup, step: 21, train time 9.22 s
Epoch 25/50 |loss: 0.150711| train set 3.275x speedup, test set 6.189x speedup, val set 0.785x speedup, step: 22, train time 9.69 s
Epoch 26/50 |loss: 0.147808| train set 2.996x speedup, test set 4.323x speedup, val set 0.806x speedup, step: 23, train time 9.31 s
Epoch 27/50 |loss: 0.144567| train set 3.430x speedup, test set 6.189x speedup, val set 0.727x speedup, step: 24, train time 9.17 s
Epoch 28/50 |loss: 0.137403| train set 3.435x speedup, test set 6.189x speedup, val set 0.661x speedup, step: 25, train time 9.19 s
Epoch 29/50 |loss: 0.140345| train set 3.278x speedup, test set 4.323x speedup, val set 0.730x speedup, step: 26, train time 9.20 s
Epoch 30/50 |loss: 0.135775| train set 3.282x speedup, test set 4.229x speedup, val set 0.733x speedup, step: 27, train time 9.19 s
Epoch 31/50 |loss: 0.138763| train set 3.210x speedup, test set 1.385x speedup, val set 0.660x speedup, step: 28, train time 9.42 s
Epoch 32/50 |loss: 0.127219| train set 3.401x speedup, test set 4.229x speedup, val set 0.674x speedup, step: 29, train time 9.18 s
Epoch 33/50 |loss: 0.129432| train set 3.302x speedup, test set 1.488x speedup, val set 0.792x speedup, step: 30, train time 9.70 s
Epoch 34/50 |loss: 0.131030| train set 3.361x speedup, test set 5.999x speedup, val set 0.663x speedup, step: 31, train time 9.31 s
Epoch 35/50 |loss: 0.123907| train set 3.367x speedup, test set 1.375x speedup, val set 0.722x speedup, step: 32, train time 9.19 s
Epoch 36/50 |loss: 0.123560| train set 3.324x speedup, test set 1.375x speedup, val set 0.674x speedup, step: 33, train time 9.20 s
Epoch 37/50 |loss: 0.122419| train set 3.185x speedup, test set 6.105x speedup, val set 0.911x speedup, step: 34, train time 9.40 s
Epoch 38/50 |loss: 0.124488| train set 3.168x speedup, test set 4.323x speedup, val set 0.760x speedup, step: 35, train time 9.19 s
Epoch 39/50 |loss: 0.117513| train set 3.387x speedup, test set 5.999x speedup, val set 0.663x speedup, step: 36, train time 9.32 s
Epoch 40/50 |loss: 0.121932| train set 3.454x speedup, test set 4.354x speedup, val set 0.871x speedup, step: 37, train time 8.91 s
Epoch 41/50 |loss: 0.116654| train set 3.358x speedup, test set 6.041x speedup, val set 0.767x speedup, step: 38, train time 9.29 s
Epoch 42/50 |loss: 0.115007| train set 3.469x speedup, test set 6.234x speedup, val set 0.787x speedup, step: 39, train time 9.41 s
Epoch 43/50 |loss: 0.117875| train set 3.434x speedup, test set 4.354x speedup, val set 0.680x speedup, step: 40, train time 9.20 s
Epoch 44/50 |loss: 0.113939| train set 3.224x speedup, test set 5.999x speedup, val set 0.674x speedup, step: 41, train time 9.40 s
Epoch 45/50 |loss: 0.109708| train set 3.398x speedup, test set 4.229x speedup, val set 0.714x speedup, step: 42, train time 9.68 s
Epoch 46/50 |loss: 0.106771| train set 3.342x speedup, test set 4.229x speedup, val set 1.006x speedup, step: 43, train time 10.11 s
Epoch 47/50 |loss: 0.108563| train set 3.266x speedup, test set 4.229x speedup, val set 0.794x speedup, step: 44, train time 10.53 s
Epoch 48/50 |loss: 0.107431| train set 3.469x speedup, test set 4.229x speedup, val set 0.727x speedup, step: 45, train time 9.29 s
Epoch 49/50 |loss: 0.105043| train set 3.419x speedup, test set 4.323x speedup, val set 0.660x speedup, step: 46, train time 9.09 s
Training per epoch cost 9.496 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 42, train speedup 3.469, test speedup 6.234, val speedup 0.787
best test speedup epoch: 42, train speedup 3.469, test speedup 6.234, val speedup 0.787
best validation speedup epoch: 4, train speedup 2.832, test speedup 5.981, val speedup 1.064
last model at epoch 49, train speedup 3.419, test speedup 4.323, val speedup 0.660
execution cost 0:08:28.892196
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.799157, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426597| train set 2.346x speedup, test set 4.730x speedup, val set 0.808x speedup, step: 1, train time 10.36 s
Epoch 1/50 |loss: 0.344871| train set 2.542x speedup, test set 6.733x speedup, val set 0.923x speedup, step: 2, train time 9.70 s
Epoch 2/50 |loss: 0.316301| train set 2.364x speedup, test set 5.035x speedup, val set 0.936x speedup, step: 3, train time 9.49 s
Epoch 3/50 |loss: 0.293283| train set 2.428x speedup, test set 6.690x speedup, val set 0.926x speedup, step: 4, train time 9.40 s
Epoch 4/50 |loss: 0.275074| train set 2.677x speedup, test set 5.035x speedup, val set 1.030x speedup, step: 1, train time 9.22 s
Epoch 5/50 |loss: 0.253428| train set 2.770x speedup, test set 5.046x speedup, val set 0.909x speedup, step: 2, train time 9.19 s
Epoch 6/50 |loss: 0.238523| train set 2.833x speedup, test set 5.080x speedup, val set 0.909x speedup, step: 3, train time 9.40 s
Epoch 7/50 |loss: 0.234879| train set 3.060x speedup, test set 5.182x speedup, val set 0.956x speedup, step: 4, train time 9.20 s
Epoch 8/50 |loss: 0.220596| train set 3.333x speedup, test set 5.182x speedup, val set 0.749x speedup, step: 5, train time 9.32 s
Epoch 9/50 |loss: 0.220733| train set 3.085x speedup, test set 5.035x speedup, val set 0.886x speedup, step: 6, train time 9.30 s
Epoch 10/50 |loss: 0.204921| train set 2.873x speedup, test set 5.182x speedup, val set 0.779x speedup, step: 7, train time 9.69 s
Epoch 11/50 |loss: 0.199087| train set 3.178x speedup, test set 5.078x speedup, val set 1.014x speedup, step: 8, train time 9.40 s
Epoch 12/50 |loss: 0.197368| train set 2.709x speedup, test set 5.182x speedup, val set 0.705x speedup, step: 9, train time 9.32 s
Epoch 13/50 |loss: 0.188889| train set 3.098x speedup, test set 5.182x speedup, val set 0.884x speedup, step: 10, train time 9.21 s
Epoch 14/50 |loss: 0.190239| train set 3.281x speedup, test set 5.213x speedup, val set 1.043x speedup, step: 1, train time 9.23 s
Epoch 15/50 |loss: 0.184821| train set 3.072x speedup, test set 5.182x speedup, val set 0.782x speedup, step: 2, train time 9.09 s
Epoch 16/50 |loss: 0.175516| train set 3.276x speedup, test set 5.213x speedup, val set 0.706x speedup, step: 3, train time 9.10 s
Epoch 17/50 |loss: 0.177875| train set 2.797x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 4, train time 10.69 s
Epoch 18/50 |loss: 0.169869| train set 3.325x speedup, test set 5.213x speedup, val set 0.877x speedup, step: 5, train time 9.20 s
Epoch 19/50 |loss: 0.168899| train set 3.377x speedup, test set 5.182x speedup, val set 0.727x speedup, step: 6, train time 10.11 s
Epoch 20/50 |loss: 0.164965| train set 3.154x speedup, test set 5.182x speedup, val set 0.775x speedup, step: 7, train time 9.30 s
Epoch 21/50 |loss: 0.157836| train set 3.230x speedup, test set 5.213x speedup, val set 0.707x speedup, step: 8, train time 9.20 s
Epoch 22/50 |loss: 0.159033| train set 3.317x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 9, train time 9.12 s
Epoch 23/50 |loss: 0.150258| train set 3.408x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 10, train time 9.28 s
Epoch 24/50 |loss: 0.146541| train set 3.137x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 11, train time 9.39 s
Epoch 25/50 |loss: 0.156534| train set 3.272x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 12, train time 9.40 s
Epoch 26/50 |loss: 0.148286| train set 3.217x speedup, test set 5.182x speedup, val set 0.812x speedup, step: 13, train time 9.30 s
Epoch 27/50 |loss: 0.144705| train set 3.351x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 14, train time 9.21 s
Epoch 28/50 |loss: 0.136378| train set 3.410x speedup, test set 5.182x speedup, val set 0.776x speedup, step: 15, train time 9.21 s
Epoch 29/50 |loss: 0.141112| train set 3.254x speedup, test set 5.213x speedup, val set 0.714x speedup, step: 16, train time 9.60 s
Epoch 30/50 |loss: 0.139891| train set 3.216x speedup, test set 5.182x speedup, val set 0.727x speedup, step: 17, train time 9.01 s
Epoch 31/50 |loss: 0.139156| train set 3.330x speedup, test set 5.182x speedup, val set 0.707x speedup, step: 18, train time 9.12 s
Epoch 32/50 |loss: 0.129216| train set 3.406x speedup, test set 5.182x speedup, val set 0.701x speedup, step: 19, train time 9.42 s
Epoch 33/50 |loss: 0.131695| train set 3.261x speedup, test set 5.182x speedup, val set 0.776x speedup, step: 20, train time 9.60 s
Epoch 34/50 |loss: 0.129350| train set 3.340x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 21, train time 9.30 s
Epoch 35/50 |loss: 0.131359| train set 3.335x speedup, test set 5.182x speedup, val set 0.776x speedup, step: 22, train time 9.51 s
Epoch 36/50 |loss: 0.130840| train set 3.346x speedup, test set 5.182x speedup, val set 0.837x speedup, step: 23, train time 9.22 s
Epoch 37/50 |loss: 0.126125| train set 3.285x speedup, test set 5.182x speedup, val set 0.802x speedup, step: 24, train time 9.60 s
Epoch 38/50 |loss: 0.124912| train set 3.191x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 25, train time 9.20 s
Epoch 39/50 |loss: 0.120487| train set 3.370x speedup, test set 5.213x speedup, val set 0.706x speedup, step: 26, train time 9.11 s
Epoch 40/50 |loss: 0.125688| train set 3.472x speedup, test set 5.182x speedup, val set 0.850x speedup, step: 27, train time 9.41 s
Epoch 41/50 |loss: 0.121775| train set 3.283x speedup, test set 5.182x speedup, val set 0.792x speedup, step: 28, train time 9.24 s
Epoch 42/50 |loss: 0.119539| train set 3.454x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 29, train time 9.48 s
Epoch 43/50 |loss: 0.119885| train set 3.434x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 30, train time 9.48 s
Epoch 44/50 |loss: 0.116993| train set 3.304x speedup, test set 5.182x speedup, val set 0.707x speedup, step: 31, train time 9.30 s
Epoch 45/50 |loss: 0.110349| train set 3.305x speedup, test set 5.182x speedup, val set 0.701x speedup, step: 32, train time 10.38 s
Epoch 46/50 |loss: 0.110775| train set 3.466x speedup, test set 5.213x speedup, val set 0.776x speedup, step: 33, train time 10.12 s
Epoch 47/50 |loss: 0.113774| train set 3.212x speedup, test set 5.182x speedup, val set 0.776x speedup, step: 34, train time 9.11 s
Epoch 48/50 |loss: 0.113360| train set 3.317x speedup, test set 5.213x speedup, val set 0.850x speedup, step: 35, train time 9.28 s
Epoch 49/50 |loss: 0.106719| train set 3.492x speedup, test set 5.182x speedup, val set 0.781x speedup, step: 36, train time 9.19 s
Training per epoch cost 9.414 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 36.429s, pg runtime 17.708s, speedup 0.486x
12, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
13, opt runtime 7.851s, model runtime 30.956s, pg runtime 13.622s, speedup 0.440x
14, opt runtime 7.442s, model runtime 32.816s, pg runtime 14.838s, speedup 0.452x
15, opt runtime 7.110s, model runtime 38.849s, pg runtime 14.286s, speedup 0.368x
16, opt runtime 6.810s, model runtime 39.840s, pg runtime 13.796s, speedup 0.346x
17, opt runtime 6.460s, model runtime 33.445s, pg runtime 16.134s, speedup 0.482x
18, opt runtime 6.656s, model runtime 39.236s, pg runtime 15.260s, speedup 0.389x
19, opt runtime 7.913s, model runtime 32.779s, pg runtime 15.548s, speedup 0.474x
20, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 49, train speedup 3.492, test speedup 5.182, val speedup 0.781
best test speedup epoch: 1, train speedup 2.542, test speedup 6.733, val speedup 0.923
best validation speedup epoch: 14, train speedup 3.281, test speedup 5.213, val speedup 1.043
last model at epoch 49, train speedup 3.492, test speedup 5.182, val speedup 0.781
execution cost 0:08:24.597712
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.845963, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426065| train set 1.491x speedup, test set 0.894x speedup, val set 0.793x speedup, step: 1, train time 10.58 s
Epoch 1/50 |loss: 0.345747| train set 1.583x speedup, test set 4.752x speedup, val set 1.044x speedup, step: 2, train time 9.71 s
Epoch 2/50 |loss: 0.318076| train set 2.469x speedup, test set 5.981x speedup, val set 1.015x speedup, step: 3, train time 9.22 s
Epoch 3/50 |loss: 0.294279| train set 2.641x speedup, test set 5.981x speedup, val set 1.003x speedup, step: 4, train time 9.28 s
Epoch 4/50 |loss: 0.275817| train set 2.891x speedup, test set 5.981x speedup, val set 0.975x speedup, step: 1, train time 9.20 s
Epoch 5/50 |loss: 0.255437| train set 2.705x speedup, test set 5.981x speedup, val set 0.926x speedup, step: 2, train time 9.49 s
Epoch 6/50 |loss: 0.240924| train set 2.988x speedup, test set 6.189x speedup, val set 0.874x speedup, step: 3, train time 9.41 s
Epoch 7/50 |loss: 0.233685| train set 3.152x speedup, test set 6.950x speedup, val set 1.608x speedup, step: 4, train time 9.19 s
Epoch 8/50 |loss: 0.221852| train set 3.316x speedup, test set 5.182x speedup, val set 1.008x speedup, step: 5, train time 9.20 s
Epoch 9/50 |loss: 0.219891| train set 2.981x speedup, test set 6.950x speedup, val set 0.955x speedup, step: 6, train time 9.10 s
Epoch 10/50 |loss: 0.204274| train set 2.757x speedup, test set 5.182x speedup, val set 0.985x speedup, step: 7, train time 9.11 s
Epoch 11/50 |loss: 0.201070| train set 3.095x speedup, test set 5.182x speedup, val set 2.030x speedup, step: 8, train time 9.10 s
Epoch 12/50 |loss: 0.197104| train set 3.007x speedup, test set 5.182x speedup, val set 0.984x speedup, step: 9, train time 9.50 s
Epoch 13/50 |loss: 0.192444| train set 3.006x speedup, test set 6.189x speedup, val set 0.705x speedup, step: 10, train time 9.10 s
Epoch 14/50 |loss: 0.190143| train set 3.268x speedup, test set 5.182x speedup, val set 0.901x speedup, step: 11, train time 9.41 s
Epoch 15/50 |loss: 0.183867| train set 3.341x speedup, test set 5.213x speedup, val set 1.909x speedup, step: 12, train time 9.02 s
Epoch 16/50 |loss: 0.172519| train set 3.318x speedup, test set 5.182x speedup, val set 1.074x speedup, step: 13, train time 9.11 s
Epoch 17/50 |loss: 0.174931| train set 3.180x speedup, test set 6.189x speedup, val set 0.697x speedup, step: 14, train time 11.11 s
Epoch 18/50 |loss: 0.168887| train set 3.182x speedup, test set 6.189x speedup, val set 0.901x speedup, step: 15, train time 9.39 s
Epoch 19/50 |loss: 0.169390| train set 3.246x speedup, test set 6.189x speedup, val set 0.705x speedup, step: 16, train time 9.92 s
Epoch 20/50 |loss: 0.165397| train set 3.215x speedup, test set 6.189x speedup, val set 0.901x speedup, step: 17, train time 9.29 s
Epoch 21/50 |loss: 0.159352| train set 3.055x speedup, test set 6.189x speedup, val set 0.901x speedup, step: 18, train time 9.10 s
Epoch 22/50 |loss: 0.157013| train set 3.176x speedup, test set 6.189x speedup, val set 0.926x speedup, step: 19, train time 9.40 s
Epoch 23/50 |loss: 0.153327| train set 3.380x speedup, test set 6.189x speedup, val set 0.697x speedup, step: 20, train time 9.39 s
Epoch 24/50 |loss: 0.143849| train set 3.135x speedup, test set 6.189x speedup, val set 0.701x speedup, step: 21, train time 9.31 s
Epoch 25/50 |loss: 0.151895| train set 3.196x speedup, test set 6.189x speedup, val set 0.899x speedup, step: 22, train time 9.40 s
Epoch 26/50 |loss: 0.148543| train set 3.150x speedup, test set 6.189x speedup, val set 0.674x speedup, step: 23, train time 9.29 s
Epoch 27/50 |loss: 0.144968| train set 3.410x speedup, test set 6.189x speedup, val set 0.658x speedup, step: 24, train time 9.21 s
Epoch 28/50 |loss: 0.139143| train set 3.400x speedup, test set 5.182x speedup, val set 0.701x speedup, step: 25, train time 9.00 s
Epoch 29/50 |loss: 0.142842| train set 3.128x speedup, test set 6.189x speedup, val set 0.661x speedup, step: 26, train time 9.30 s
Epoch 30/50 |loss: 0.135111| train set 3.137x speedup, test set 6.189x speedup, val set 1.060x speedup, step: 27, train time 9.30 s
Epoch 31/50 |loss: 0.141841| train set 3.333x speedup, test set 6.189x speedup, val set 0.693x speedup, step: 28, train time 9.18 s
Epoch 32/50 |loss: 0.128416| train set 3.380x speedup, test set 6.189x speedup, val set 0.362x speedup, step: 29, train time 9.40 s
Epoch 33/50 |loss: 0.128873| train set 3.420x speedup, test set 6.189x speedup, val set 0.658x speedup, step: 30, train time 9.21 s
Epoch 34/50 |loss: 0.127349| train set 3.282x speedup, test set 6.189x speedup, val set 0.701x speedup, step: 31, train time 9.30 s
Epoch 35/50 |loss: 0.125638| train set 3.191x speedup, test set 6.189x speedup, val set 0.674x speedup, step: 32, train time 9.31 s
Epoch 36/50 |loss: 0.128001| train set 3.379x speedup, test set 6.189x speedup, val set 0.693x speedup, step: 33, train time 9.31 s
Epoch 37/50 |loss: 0.125262| train set 3.288x speedup, test set 6.950x speedup, val set 0.379x speedup, step: 34, train time 9.27 s
Epoch 38/50 |loss: 0.124636| train set 3.147x speedup, test set 6.189x speedup, val set 0.674x speedup, step: 35, train time 9.12 s
Epoch 39/50 |loss: 0.119376| train set 3.397x speedup, test set 6.234x speedup, val set 0.378x speedup, step: 36, train time 9.27 s
Epoch 40/50 |loss: 0.125662| train set 3.461x speedup, test set 5.182x speedup, val set 1.094x speedup, step: 37, train time 9.00 s
Epoch 41/50 |loss: 0.119810| train set 3.327x speedup, test set 5.208x speedup, val set 0.672x speedup, step: 38, train time 9.08 s
Epoch 42/50 |loss: 0.118492| train set 3.467x speedup, test set 6.234x speedup, val set 0.700x speedup, step: 39, train time 9.21 s
Epoch 43/50 |loss: 0.116268| train set 3.259x speedup, test set 5.182x speedup, val set 0.708x speedup, step: 40, train time 9.20 s
Epoch 44/50 |loss: 0.116213| train set 3.315x speedup, test set 5.182x speedup, val set 0.708x speedup, step: 41, train time 9.30 s
Epoch 45/50 |loss: 0.111963| train set 3.257x speedup, test set 5.182x speedup, val set 0.693x speedup, step: 42, train time 9.19 s
Epoch 46/50 |loss: 0.110945| train set 3.454x speedup, test set 5.213x speedup, val set 0.708x speedup, step: 43, train time 9.42 s
Epoch 47/50 |loss: 0.109030| train set 3.387x speedup, test set 5.182x speedup, val set 0.716x speedup, step: 44, train time 9.20 s
Epoch 48/50 |loss: 0.114703| train set 3.468x speedup, test set 5.213x speedup, val set 0.716x speedup, step: 45, train time 9.40 s
Epoch 49/50 |loss: 0.109924| train set 3.409x speedup, test set 6.234x speedup, val set 0.669x speedup, step: 46, train time 9.41 s
Training per epoch cost 9.338 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 48, train speedup 3.468, test speedup 5.213, val speedup 0.716
best test speedup epoch: 7, train speedup 3.152, test speedup 6.950, val speedup 1.608
best validation speedup epoch: 4, train speedup 2.891, test speedup 5.981, val speedup 0.975
last model at epoch 49, train speedup 3.409, test speedup 6.234, val speedup 0.669
execution cost 0:08:20.835833
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.795867, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426580| train set 2.199x speedup, test set 0.847x speedup, val set 0.793x speedup, step: 1, train time 10.43 s
Epoch 1/50 |loss: 0.343021| train set 2.399x speedup, test set 0.894x speedup, val set 1.017x speedup, step: 2, train time 9.68 s
Epoch 2/50 |loss: 0.313692| train set 2.560x speedup, test set 5.035x speedup, val set 0.900x speedup, step: 3, train time 9.00 s
Epoch 3/50 |loss: 0.293406| train set 3.109x speedup, test set 5.035x speedup, val set 0.926x speedup, step: 4, train time 9.28 s
Epoch 4/50 |loss: 0.276574| train set 2.916x speedup, test set 6.950x speedup, val set 1.767x speedup, step: 1, train time 9.20 s
Epoch 5/50 |loss: 0.258256| train set 2.823x speedup, test set 6.943x speedup, val set 0.936x speedup, step: 2, train time 8.99 s
Epoch 6/50 |loss: 0.241088| train set 2.563x speedup, test set 5.182x speedup, val set 1.016x speedup, step: 3, train time 9.29 s
Epoch 7/50 |loss: 0.236567| train set 2.879x speedup, test set 5.080x speedup, val set 0.900x speedup, step: 4, train time 8.98 s
Epoch 8/50 |loss: 0.224876| train set 3.079x speedup, test set 6.950x speedup, val set 0.885x speedup, step: 5, train time 9.08 s
Epoch 9/50 |loss: 0.218653| train set 2.941x speedup, test set 6.683x speedup, val set 0.910x speedup, step: 6, train time 9.10 s
Epoch 10/50 |loss: 0.205797| train set 3.067x speedup, test set 6.189x speedup, val set 0.956x speedup, step: 7, train time 9.01 s
Epoch 11/50 |loss: 0.197538| train set 3.179x speedup, test set 5.080x speedup, val set 0.926x speedup, step: 8, train time 9.11 s
Epoch 12/50 |loss: 0.198269| train set 2.786x speedup, test set 5.080x speedup, val set 0.910x speedup, step: 9, train time 9.31 s
Epoch 13/50 |loss: 0.193717| train set 3.017x speedup, test set 4.940x speedup, val set 0.885x speedup, step: 10, train time 9.29 s
Epoch 14/50 |loss: 0.188618| train set 3.190x speedup, test set 5.080x speedup, val set 0.985x speedup, step: 11, train time 9.09 s
Epoch 15/50 |loss: 0.183354| train set 3.298x speedup, test set 5.080x speedup, val set 0.884x speedup, step: 12, train time 9.10 s
Epoch 16/50 |loss: 0.175508| train set 3.269x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 13, train time 9.20 s
Epoch 17/50 |loss: 0.174587| train set 2.835x speedup, test set 6.189x speedup, val set 1.025x speedup, step: 14, train time 9.21 s
Epoch 18/50 |loss: 0.171240| train set 3.089x speedup, test set 5.080x speedup, val set 0.878x speedup, step: 15, train time 9.10 s
Epoch 19/50 |loss: 0.165979| train set 3.284x speedup, test set 6.943x speedup, val set 0.727x speedup, step: 16, train time 9.21 s
Epoch 20/50 |loss: 0.163192| train set 3.048x speedup, test set 6.189x speedup, val set 0.743x speedup, step: 17, train time 9.00 s
Epoch 21/50 |loss: 0.155426| train set 2.764x speedup, test set 6.189x speedup, val set 0.936x speedup, step: 18, train time 9.40 s
Epoch 22/50 |loss: 0.158793| train set 3.322x speedup, test set 5.080x speedup, val set 0.926x speedup, step: 19, train time 9.28 s
Epoch 23/50 |loss: 0.149927| train set 3.159x speedup, test set 6.189x speedup, val set 0.730x speedup, step: 20, train time 9.00 s
Epoch 24/50 |loss: 0.142566| train set 2.953x speedup, test set 6.189x speedup, val set 0.779x speedup, step: 21, train time 9.09 s
Epoch 25/50 |loss: 0.149237| train set 3.120x speedup, test set 4.881x speedup, val set 0.925x speedup, step: 22, train time 8.99 s
Epoch 26/50 |loss: 0.148172| train set 2.868x speedup, test set 6.189x speedup, val set 0.900x speedup, step: 23, train time 9.00 s
Epoch 27/50 |loss: 0.141779| train set 3.224x speedup, test set 6.189x speedup, val set 0.926x speedup, step: 24, train time 9.41 s
Epoch 28/50 |loss: 0.135629| train set 3.418x speedup, test set 5.080x speedup, val set 0.901x speedup, step: 25, train time 9.20 s
Epoch 29/50 |loss: 0.138718| train set 3.125x speedup, test set 6.189x speedup, val set 0.901x speedup, step: 26, train time 9.38 s
Epoch 30/50 |loss: 0.133177| train set 3.009x speedup, test set 6.189x speedup, val set 0.901x speedup, step: 27, train time 9.10 s
Epoch 31/50 |loss: 0.137632| train set 3.143x speedup, test set 5.080x speedup, val set 1.006x speedup, step: 28, train time 9.28 s
Epoch 32/50 |loss: 0.124850| train set 3.298x speedup, test set 4.881x speedup, val set 1.006x speedup, step: 29, train time 9.23 s
Epoch 33/50 |loss: 0.129272| train set 3.302x speedup, test set 4.881x speedup, val set 0.901x speedup, step: 30, train time 9.01 s
Epoch 34/50 |loss: 0.128546| train set 3.430x speedup, test set 5.080x speedup, val set 0.925x speedup, step: 31, train time 9.10 s
Epoch 35/50 |loss: 0.120419| train set 3.367x speedup, test set 5.080x speedup, val set 0.977x speedup, step: 32, train time 9.21 s
Epoch 36/50 |loss: 0.131870| train set 3.369x speedup, test set 5.080x speedup, val set 0.674x speedup, step: 33, train time 9.31 s
Epoch 37/50 |loss: 0.122334| train set 3.065x speedup, test set 6.189x speedup, val set 0.977x speedup, step: 34, train time 9.30 s
Epoch 38/50 |loss: 0.124739| train set 3.059x speedup, test set 6.189x speedup, val set 0.743x speedup, step: 35, train time 9.19 s
Epoch 39/50 |loss: 0.117796| train set 3.385x speedup, test set 5.080x speedup, val set 0.975x speedup, step: 36, train time 9.27 s
Epoch 40/50 |loss: 0.121536| train set 3.465x speedup, test set 5.080x speedup, val set 1.004x speedup, step: 37, train time 9.40 s
Epoch 41/50 |loss: 0.114668| train set 3.264x speedup, test set 6.189x speedup, val set 0.926x speedup, step: 38, train time 9.30 s
Epoch 42/50 |loss: 0.114456| train set 3.452x speedup, test set 6.189x speedup, val set 0.793x speedup, step: 39, train time 9.42 s
Epoch 43/50 |loss: 0.114033| train set 3.421x speedup, test set 6.189x speedup, val set 1.006x speedup, step: 40, train time 9.10 s
Epoch 44/50 |loss: 0.114400| train set 3.386x speedup, test set 4.881x speedup, val set 0.952x speedup, step: 41, train time 9.30 s
Epoch 45/50 |loss: 0.109400| train set 3.265x speedup, test set 6.189x speedup, val set 1.006x speedup, step: 42, train time 9.40 s
Epoch 46/50 |loss: 0.108288| train set 3.432x speedup, test set 6.189x speedup, val set 1.006x speedup, step: 43, train time 9.20 s
Epoch 47/50 |loss: 0.105314| train set 3.316x speedup, test set 6.189x speedup, val set 0.977x speedup, step: 44, train time 9.29 s
Epoch 48/50 |loss: 0.110046| train set 3.463x speedup, test set 4.881x speedup, val set 0.812x speedup, step: 45, train time 9.09 s
Epoch 49/50 |loss: 0.108561| train set 3.489x speedup, test set 6.189x speedup, val set 0.950x speedup, step: 46, train time 9.13 s
Training per epoch cost 9.220 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
12, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
13, opt runtime 7.851s, model runtime 10.810s, pg runtime 13.622s, speedup 1.260x
14, opt runtime 7.442s, model runtime 7.442s, pg runtime 14.838s, speedup 1.994x
15, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
16, opt runtime 6.810s, model runtime 6.810s, pg runtime 13.796s, speedup 2.026x
17, opt runtime 6.460s, model runtime 6.460s, pg runtime 16.134s, speedup 2.498x
18, opt runtime 6.656s, model runtime 6.656s, pg runtime 15.260s, speedup 2.293x
19, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
20, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
21, opt runtime 6.789s, model runtime 7.122s, pg runtime 7.799s, speedup 1.095x
22, opt runtime 7.096s, model runtime 7.687s, pg runtime 7.096s, speedup 0.923x
23, opt runtime 7.063s, model runtime 7.440s, pg runtime 7.063s, speedup 0.949x
24, opt runtime 7.268s, model runtime 7.497s, pg runtime 7.268s, speedup 0.969x
25, opt runtime 6.854s, model runtime 7.512s, pg runtime 6.854s, speedup 0.912x
26, opt runtime 6.905s, model runtime 7.359s, pg runtime 6.905s, speedup 0.938x
27, opt runtime 6.663s, model runtime 7.445s, pg runtime 6.663s, speedup 0.895x
28, opt runtime 7.199s, model runtime 7.919s, pg runtime 7.619s, speedup 0.962x
29, opt runtime 7.066s, model runtime 8.012s, pg runtime 7.533s, speedup 0.940x
30, opt runtime 6.961s, model runtime 7.701s, pg runtime 6.961s, speedup 0.904x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 49, train speedup 3.489, test speedup 6.189, val speedup 0.950
best test speedup epoch: 4, train speedup 2.916, test speedup 6.950, val speedup 1.767
best validation speedup epoch: 4, train speedup 2.916, test speedup 6.950, val speedup 1.767
last model at epoch 49, train speedup 3.489, test speedup 6.189, val speedup 0.950
execution cost 0:08:13.958610
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (78, 49) (40, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:00.832169, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425844| train set 2.301x speedup, test set 6.690x speedup, val set 0.997x speedup, step: 1, train time 10.22 s
Epoch 1/50 |loss: 0.345254| train set 1.502x speedup, test set 7.244x speedup, val set 0.890x speedup, step: 2, train time 9.70 s
Epoch 2/50 |loss: 0.316831| train set 2.395x speedup, test set 4.730x speedup, val set 1.003x speedup, step: 3, train time 9.10 s
Epoch 3/50 |loss: 0.295883| train set 2.527x speedup, test set 4.940x speedup, val set 1.003x speedup, step: 4, train time 9.30 s
Epoch 4/50 |loss: 0.278026| train set 2.636x speedup, test set 6.023x speedup, val set 1.367x speedup, step: 1, train time 8.99 s
Epoch 5/50 |loss: 0.258592| train set 3.138x speedup, test set 4.940x speedup, val set 0.876x speedup, step: 2, train time 9.11 s
Epoch 6/50 |loss: 0.242885| train set 2.564x speedup, test set 4.940x speedup, val set 0.936x speedup, step: 3, train time 9.21 s
Epoch 7/50 |loss: 0.238546| train set 3.192x speedup, test set 5.035x speedup, val set 0.956x speedup, step: 4, train time 9.10 s
Epoch 8/50 |loss: 0.225860| train set 3.328x speedup, test set 5.981x speedup, val set 1.671x speedup, step: 5, train time 9.00 s
Epoch 9/50 |loss: 0.229121| train set 3.235x speedup, test set 4.940x speedup, val set 0.988x speedup, step: 6, train time 9.19 s
Epoch 10/50 |loss: 0.212264| train set 2.841x speedup, test set 5.182x speedup, val set 0.986x speedup, step: 7, train time 9.20 s
Epoch 11/50 |loss: 0.203546| train set 3.101x speedup, test set 5.213x speedup, val set 1.014x speedup, step: 8, train time 9.11 s
Epoch 12/50 |loss: 0.202996| train set 3.017x speedup, test set 5.080x speedup, val set 0.906x speedup, step: 9, train time 9.10 s
Epoch 13/50 |loss: 0.196442| train set 2.926x speedup, test set 5.110x speedup, val set 0.956x speedup, step: 10, train time 9.50 s
Epoch 14/50 |loss: 0.191496| train set 3.234x speedup, test set 5.213x speedup, val set 1.044x speedup, step: 11, train time 9.50 s
Epoch 15/50 |loss: 0.185482| train set 3.190x speedup, test set 5.081x speedup, val set 0.988x speedup, step: 12, train time 9.19 s
Epoch 16/50 |loss: 0.176399| train set 3.054x speedup, test set 5.213x speedup, val set 1.013x speedup, step: 13, train time 9.49 s
Epoch 17/50 |loss: 0.178935| train set 2.854x speedup, test set 5.182x speedup, val set 0.783x speedup, step: 14, train time 9.39 s
Epoch 18/50 |loss: 0.173254| train set 3.083x speedup, test set 5.110x speedup, val set 0.987x speedup, step: 15, train time 9.19 s
Epoch 19/50 |loss: 0.172691| train set 3.299x speedup, test set 5.110x speedup, val set 0.666x speedup, step: 16, train time 9.38 s
Epoch 20/50 |loss: 0.165476| train set 3.258x speedup, test set 5.213x speedup, val set 0.783x speedup, step: 17, train time 9.12 s
Epoch 21/50 |loss: 0.159203| train set 3.232x speedup, test set 5.213x speedup, val set 0.988x speedup, step: 18, train time 9.20 s
Epoch 22/50 |loss: 0.162874| train set 3.327x speedup, test set 5.110x speedup, val set 0.783x speedup, step: 19, train time 9.00 s
Epoch 23/50 |loss: 0.153783| train set 3.258x speedup, test set 5.110x speedup, val set 0.783x speedup, step: 20, train time 9.19 s
Epoch 24/50 |loss: 0.149009| train set 2.786x speedup, test set 5.110x speedup, val set 0.783x speedup, step: 21, train time 9.21 s
Epoch 25/50 |loss: 0.154531| train set 3.291x speedup, test set 5.110x speedup, val set 0.781x speedup, step: 22, train time 9.39 s
Epoch 26/50 |loss: 0.150480| train set 3.062x speedup, test set 5.110x speedup, val set 0.910x speedup, step: 23, train time 9.29 s
Epoch 27/50 |loss: 0.146063| train set 3.342x speedup, test set 5.110x speedup, val set 0.977x speedup, step: 24, train time 9.22 s
Epoch 28/50 |loss: 0.141918| train set 3.394x speedup, test set 5.213x speedup, val set 0.783x speedup, step: 25, train time 9.11 s
Epoch 29/50 |loss: 0.144490| train set 3.144x speedup, test set 5.080x speedup, val set 0.988x speedup, step: 26, train time 9.00 s
Epoch 30/50 |loss: 0.138943| train set 3.074x speedup, test set 5.110x speedup, val set 0.801x speedup, step: 27, train time 9.01 s
Epoch 31/50 |loss: 0.139857| train set 3.016x speedup, test set 5.110x speedup, val set 0.986x speedup, step: 28, train time 9.19 s
Epoch 32/50 |loss: 0.131638| train set 3.442x speedup, test set 5.110x speedup, val set 0.720x speedup, step: 29, train time 9.08 s
Epoch 33/50 |loss: 0.133926| train set 3.292x speedup, test set 5.110x speedup, val set 0.985x speedup, step: 30, train time 9.19 s
Epoch 34/50 |loss: 0.133678| train set 3.363x speedup, test set 5.080x speedup, val set 0.986x speedup, step: 31, train time 9.08 s
Epoch 35/50 |loss: 0.128890| train set 3.212x speedup, test set 5.110x speedup, val set 0.722x speedup, step: 32, train time 9.20 s
Epoch 36/50 |loss: 0.129523| train set 3.375x speedup, test set 5.110x speedup, val set 0.707x speedup, step: 33, train time 9.29 s
Epoch 37/50 |loss: 0.129227| train set 3.102x speedup, test set 5.110x speedup, val set 1.019x speedup, step: 34, train time 9.18 s
Epoch 38/50 |loss: 0.127495| train set 3.020x speedup, test set 5.080x speedup, val set 0.722x speedup, step: 35, train time 9.29 s
Epoch 39/50 |loss: 0.121312| train set 3.088x speedup, test set 5.110x speedup, val set 0.705x speedup, step: 36, train time 9.28 s
Epoch 40/50 |loss: 0.126667| train set 3.482x speedup, test set 5.213x speedup, val set 0.738x speedup, step: 37, train time 9.20 s
Epoch 41/50 |loss: 0.121650| train set 3.168x speedup, test set 5.110x speedup, val set 0.721x speedup, step: 38, train time 9.32 s
Epoch 42/50 |loss: 0.121192| train set 3.336x speedup, test set 5.110x speedup, val set 0.706x speedup, step: 39, train time 9.19 s
Epoch 43/50 |loss: 0.119133| train set 3.385x speedup, test set 5.110x speedup, val set 0.705x speedup, step: 40, train time 9.30 s
Epoch 44/50 |loss: 0.116847| train set 3.325x speedup, test set 5.110x speedup, val set 1.019x speedup, step: 41, train time 9.20 s
Epoch 45/50 |loss: 0.112527| train set 3.311x speedup, test set 5.213x speedup, val set 0.722x speedup, step: 42, train time 9.21 s
Epoch 46/50 |loss: 0.110450| train set 3.497x speedup, test set 5.110x speedup, val set 0.738x speedup, step: 43, train time 9.50 s
Epoch 47/50 |loss: 0.110990| train set 3.296x speedup, test set 5.213x speedup, val set 0.988x speedup, step: 44, train time 9.59 s
Epoch 48/50 |loss: 0.114069| train set 3.281x speedup, test set 5.213x speedup, val set 0.705x speedup, step: 45, train time 9.19 s
Epoch 49/50 |loss: 0.111314| train set 3.492x speedup, test set 5.110x speedup, val set 1.017x speedup, step: 46, train time 9.28 s
Training per epoch cost 9.249 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
22, opt runtime 7.096s, model runtime 10.329s, pg runtime 7.096s, speedup 0.687x
23, opt runtime 7.063s, model runtime 10.874s, pg runtime 7.063s, speedup 0.650x
24, opt runtime 7.268s, model runtime 10.668s, pg runtime 7.268s, speedup 0.681x
25, opt runtime 6.854s, model runtime 10.444s, pg runtime 6.854s, speedup 0.656x
26, opt runtime 6.905s, model runtime 11.276s, pg runtime 6.905s, speedup 0.612x
27, opt runtime 6.663s, model runtime 11.492s, pg runtime 6.663s, speedup 0.580x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 7.066s, model runtime 10.936s, pg runtime 7.533s, speedup 0.689x
30, opt runtime 6.961s, model runtime 10.855s, pg runtime 6.961s, speedup 0.641x
31, opt runtime 16.268s, model runtime 22.360s, pg runtime 432.766s, speedup 19.354x
32, opt runtime 15.120s, model runtime 21.640s, pg runtime 566.078s, speedup 26.159x
33, opt runtime 16.639s, model runtime 21.855s, pg runtime 462.544s, speedup 21.165x
34, opt runtime 16.280s, model runtime 23.740s, pg runtime 634.990s, speedup 26.748x
35, opt runtime 16.528s, model runtime 24.098s, pg runtime 620.762s, speedup 25.760x
36, opt runtime 18.690s, model runtime 23.967s, pg runtime 651.942s, speedup 27.202x
37, opt runtime 16.438s, model runtime 21.989s, pg runtime 546.887s, speedup 24.871x
38, opt runtime 16.138s, model runtime 22.393s, pg runtime 501.793s, speedup 22.409x
39, opt runtime 16.770s, model runtime 23.717s, pg runtime 594.754s, speedup 25.077x
40, opt runtime 16.305s, model runtime 21.490s, pg runtime 436.168s, speedup 20.296x
====================
best train speedup epoch: 46, train speedup 3.497, test speedup 5.110, val speedup 0.738
best test speedup epoch: 1, train speedup 1.502, test speedup 7.244, val speedup 0.890
best validation speedup epoch: 4, train speedup 2.636, test speedup 6.023, val speedup 1.367
last model at epoch 49, train speedup 3.492, test speedup 5.110, val speedup 1.017
execution cost 0:08:15.757267
==================================================
